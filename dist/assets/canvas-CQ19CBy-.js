const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-33WeMpxg.js","./style-IL42Afh-.js","./style-Lyk3of6h.css"])))=>i.map(i=>d[i]);
import"./style-IL42Afh-.js";function K0e(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}function k2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function X0e(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var n3={exports:{}},FC={};var U7;function Q0e(){if(U7)return FC;U7=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,r,a){var o=null;if(a!==void 0&&(o=""+a),r.key!==void 0&&(o=""+r.key),"key"in r){a={};for(var l in r)l!=="key"&&(a[l]=r[l])}else a=r;return r=a.ref,{$$typeof:n,type:s,key:o,ref:r!==void 0?r:null,props:a}}return FC.Fragment=e,FC.jsx=t,FC.jsxs=t,FC}var V7;function J0e(){return V7||(V7=1,n3.exports=Q0e()),n3.exports}var V=J0e(),s3={exports:{}},Ks={};var W7;function Z0e(){if(W7)return Ks;W7=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.for("react.activity"),h=Symbol.iterator;function p(H){return H===null||typeof H!="object"?null:(H=h&&H[h]||H["@@iterator"],typeof H=="function"?H:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,v={};function w(H,R,B){this.props=H,this.context=R,this.refs=v,this.updater=B||g}w.prototype.isReactComponent={},w.prototype.setState=function(H,R){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,R,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function x(){}x.prototype=w.prototype;function S(H,R,B){this.props=H,this.context=R,this.refs=v,this.updater=B||g}var C=S.prototype=new x;C.constructor=S,b(C,w.prototype),C.isPureReactComponent=!0;var M=Array.isArray;function k(){}var E={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function A(H,R,B){var W=B.ref;return{$$typeof:n,type:H,key:R,ref:W!==void 0?W:null,props:B}}function D(H,R){return A(H.type,R,H.props)}function L(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function P(H){var R={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(B){return R[B]})}var j=/\/+/g;function G(H,R){return typeof H=="object"&&H!==null&&H.key!=null?P(""+H.key):R.toString(36)}function Q(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(k,k):(H.status="pending",H.then(function(R){H.status==="pending"&&(H.status="fulfilled",H.value=R)},function(R){H.status==="pending"&&(H.status="rejected",H.reason=R)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function q(H,R,B,W,se){var ue=typeof H;(ue==="undefined"||ue==="boolean")&&(H=null);var ge=!1;if(H===null)ge=!0;else switch(ue){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(H.$$typeof){case n:case e:ge=!0;break;case f:return ge=H._init,q(ge(H._payload),R,B,W,se)}}if(ge)return se=se(H),ge=W===""?"."+G(H,0):W,M(se)?(B="",ge!=null&&(B=ge.replace(j,"$&/")+"/"),q(se,R,B,"",function(Me){return Me})):se!=null&&(L(se)&&(se=D(se,B+(se.key==null||H&&H.key===se.key?"":(""+se.key).replace(j,"$&/")+"/")+ge)),R.push(se)),1;ge=0;var Ce=W===""?".":W+":";if(M(H))for(var Se=0;Se<H.length;Se++)W=H[Se],ue=Ce+G(W,Se),ge+=q(W,R,B,ue,se);else if(Se=p(H),typeof Se=="function")for(H=Se.call(H),Se=0;!(W=H.next()).done;)W=W.value,ue=Ce+G(W,Se++),ge+=q(W,R,B,ue,se);else if(ue==="object"){if(typeof H.then=="function")return q(Q(H),R,B,W,se);throw R=String(H),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.")}return ge}function te(H,R,B){if(H==null)return H;var W=[],se=0;return q(H,W,"","",function(ue){return R.call(B,ue,se++)}),W}function Z(H){if(H._status===-1){var R=H._result;R=R(),R.then(function(B){(H._status===0||H._status===-1)&&(H._status=1,H._result=B)},function(B){(H._status===0||H._status===-1)&&(H._status=2,H._result=B)}),H._status===-1&&(H._status=0,H._result=R)}if(H._status===1)return H._result.default;throw H._result}var ne=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var R=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(R))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},le={map:te,forEach:function(H,R,B){te(H,function(){R.apply(this,arguments)},B)},count:function(H){var R=0;return te(H,function(){R++}),R},toArray:function(H){return te(H,function(R){return R})||[]},only:function(H){if(!L(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Ks.Activity=d,Ks.Children=le,Ks.Component=w,Ks.Fragment=t,Ks.Profiler=r,Ks.PureComponent=S,Ks.StrictMode=s,Ks.Suspense=c,Ks.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,Ks.__COMPILER_RUNTIME={__proto__:null,c:function(H){return E.H.useMemoCache(H)}},Ks.cache=function(H){return function(){return H.apply(null,arguments)}},Ks.cacheSignal=function(){return null},Ks.cloneElement=function(H,R,B){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var W=b({},H.props),se=H.key;if(R!=null)for(ue in R.key!==void 0&&(se=""+R.key),R)!I.call(R,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&R.ref===void 0||(W[ue]=R[ue]);var ue=arguments.length-2;if(ue===1)W.children=B;else if(1<ue){for(var ge=Array(ue),Ce=0;Ce<ue;Ce++)ge[Ce]=arguments[Ce+2];W.children=ge}return A(H.type,se,W)},Ks.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:a,_context:H},H},Ks.createElement=function(H,R,B){var W,se={},ue=null;if(R!=null)for(W in R.key!==void 0&&(ue=""+R.key),R)I.call(R,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(se[W]=R[W]);var ge=arguments.length-2;if(ge===1)se.children=B;else if(1<ge){for(var Ce=Array(ge),Se=0;Se<ge;Se++)Ce[Se]=arguments[Se+2];se.children=Ce}if(H&&H.defaultProps)for(W in ge=H.defaultProps,ge)se[W]===void 0&&(se[W]=ge[W]);return A(H,ue,se)},Ks.createRef=function(){return{current:null}},Ks.forwardRef=function(H){return{$$typeof:l,render:H}},Ks.isValidElement=L,Ks.lazy=function(H){return{$$typeof:f,_payload:{_status:-1,_result:H},_init:Z}},Ks.memo=function(H,R){return{$$typeof:u,type:H,compare:R===void 0?null:R}},Ks.startTransition=function(H){var R=E.T,B={};E.T=B;try{var W=H(),se=E.S;se!==null&&se(B,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(k,ne)}catch(ue){ne(ue)}finally{R!==null&&B.types!==null&&(R.types=B.types),E.T=R}},Ks.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},Ks.use=function(H){return E.H.use(H)},Ks.useActionState=function(H,R,B){return E.H.useActionState(H,R,B)},Ks.useCallback=function(H,R){return E.H.useCallback(H,R)},Ks.useContext=function(H){return E.H.useContext(H)},Ks.useDebugValue=function(){},Ks.useDeferredValue=function(H,R){return E.H.useDeferredValue(H,R)},Ks.useEffect=function(H,R){return E.H.useEffect(H,R)},Ks.useEffectEvent=function(H){return E.H.useEffectEvent(H)},Ks.useId=function(){return E.H.useId()},Ks.useImperativeHandle=function(H,R,B){return E.H.useImperativeHandle(H,R,B)},Ks.useInsertionEffect=function(H,R){return E.H.useInsertionEffect(H,R)},Ks.useLayoutEffect=function(H,R){return E.H.useLayoutEffect(H,R)},Ks.useMemo=function(H,R){return E.H.useMemo(H,R)},Ks.useOptimistic=function(H,R){return E.H.useOptimistic(H,R)},Ks.useReducer=function(H,R,B){return E.H.useReducer(H,R,B)},Ks.useRef=function(H){return E.H.useRef(H)},Ks.useState=function(H){return E.H.useState(H)},Ks.useSyncExternalStore=function(H,R,B){return E.H.useSyncExternalStore(H,R,B)},Ks.useTransition=function(){return E.H.useTransition()},Ks.version="19.2.3",Ks}var G7;function Q6(){return G7||(G7=1,s3.exports=Z0e()),s3.exports}var Ie=Q6();const Hr=k2(Ie);var r3={exports:{}},zC={},i3={exports:{}},a3={};var H7;function e1e(){return H7||(H7=1,(function(n){function e(q,te){var Z=q.length;q.push(te);e:for(;0<Z;){var ne=Z-1>>>1,le=q[ne];if(0<r(le,te))q[ne]=te,q[Z]=le,Z=ne;else break e}}function t(q){return q.length===0?null:q[0]}function s(q){if(q.length===0)return null;var te=q[0],Z=q.pop();if(Z!==te){q[0]=Z;e:for(var ne=0,le=q.length,H=le>>>1;ne<H;){var R=2*(ne+1)-1,B=q[R],W=R+1,se=q[W];if(0>r(B,Z))W<le&&0>r(se,B)?(q[ne]=se,q[W]=Z,ne=W):(q[ne]=B,q[R]=Z,ne=R);else if(W<le&&0>r(se,Z))q[ne]=se,q[W]=Z,ne=W;else break e}}return te}function r(q,te){var Z=q.sortIndex-te.sortIndex;return Z!==0?Z:q.id-te.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,d=null,h=3,p=!1,g=!1,b=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(q){for(var te=t(u);te!==null;){if(te.callback===null)s(u);else if(te.startTime<=q)s(u),te.sortIndex=te.expirationTime,e(c,te);else break;te=t(u)}}function M(q){if(b=!1,C(q),!g)if(t(c)!==null)g=!0,k||(k=!0,P());else{var te=t(u);te!==null&&Q(M,te.startTime-q)}}var k=!1,E=-1,I=5,A=-1;function D(){return v?!0:!(n.unstable_now()-A<I)}function L(){if(v=!1,k){var q=n.unstable_now();A=q;var te=!0;try{e:{g=!1,b&&(b=!1,x(E),E=-1),p=!0;var Z=h;try{t:{for(C(q),d=t(c);d!==null&&!(d.expirationTime>q&&D());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,h=d.priorityLevel;var le=ne(d.expirationTime<=q);if(q=n.unstable_now(),typeof le=="function"){d.callback=le,C(q),te=!0;break t}d===t(c)&&s(c),C(q)}else s(c);d=t(c)}if(d!==null)te=!0;else{var H=t(u);H!==null&&Q(M,H.startTime-q),te=!1}}break e}finally{d=null,h=Z,p=!1}te=void 0}}finally{te?P():k=!1}}}var P;if(typeof S=="function")P=function(){S(L)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,G=j.port2;j.port1.onmessage=L,P=function(){G.postMessage(null)}}else P=function(){w(L,0)};function Q(q,te){E=w(function(){q(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_next=function(q){switch(h){case 1:case 2:case 3:var te=3;break;default:te=h}var Z=h;h=te;try{return q()}finally{h=Z}},n.unstable_requestPaint=function(){v=!0},n.unstable_runWithPriority=function(q,te){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Z=h;h=q;try{return te()}finally{h=Z}},n.unstable_scheduleCallback=function(q,te,Z){var ne=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ne+Z:ne):Z=ne,q){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Z+le,q={id:f++,callback:te,priorityLevel:q,startTime:Z,expirationTime:le,sortIndex:-1},Z>ne?(q.sortIndex=Z,e(u,q),t(c)===null&&q===t(u)&&(b?(x(E),E=-1):b=!0,Q(M,Z-ne))):(q.sortIndex=le,e(c,q),g||p||(g=!0,k||(k=!0,P()))),q},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(q){var te=h;return function(){var Z=h;h=te;try{return q.apply(this,arguments)}finally{h=Z}}}})(a3)),a3}var q7;function t1e(){return q7||(q7=1,i3.exports=e1e()),i3.exports}var o3={exports:{}},ru={};var Y7;function n1e(){if(Y7)return ru;Y7=1;var n=Q6();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(c,u,f){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:d==null?null:""+d,children:c,containerInfo:u,implementation:f}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return ru.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ru.createPortal=function(c,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return a(c,u,null,f)},ru.flushSync=function(c){var u=o.T,f=s.p;try{if(o.T=null,s.p=2,c)return c()}finally{o.T=u,s.p=f,s.d.f()}},ru.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(c,u))},ru.prefetchDNS=function(c){typeof c=="string"&&s.d.D(c)},ru.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var f=u.as,d=l(f,u.crossOrigin),h=typeof u.integrity=="string"?u.integrity:void 0,p=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;f==="style"?s.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:p}):f==="script"&&s.d.X(c,{crossOrigin:d,integrity:h,fetchPriority:p,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},ru.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var f=l(u.as,u.crossOrigin);s.d.M(c,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(c)},ru.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var f=u.as,d=l(f,u.crossOrigin);s.d.L(c,f,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},ru.preloadModule=function(c,u){if(typeof c=="string")if(u){var f=l(u.as,u.crossOrigin);s.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(c)},ru.requestFormReset=function(c){s.d.r(c)},ru.unstable_batchedUpdates=function(c,u){return c(u)},ru.useFormState=function(c,u,f){return o.H.useFormState(c,u,f)},ru.useFormStatus=function(){return o.H.useHostTransitionStatus()},ru.version="19.2.3",ru}var K7;function s1e(){if(K7)return o3.exports;K7=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),o3.exports=n1e(),o3.exports}var X7;function r1e(){if(X7)return zC;X7=1;var n=t1e(),e=Q6(),t=s1e();function s(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)y+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function a(m){var y=m,_=m;if(m.alternate)for(;y.return;)y=y.return;else{m=y;do y=m,(y.flags&4098)!==0&&(_=y.return),m=y.return;while(m)}return y.tag===3?_:null}function o(m){if(m.tag===13){var y=m.memoizedState;if(y===null&&(m=m.alternate,m!==null&&(y=m.memoizedState)),y!==null)return y.dehydrated}return null}function l(m){if(m.tag===31){var y=m.memoizedState;if(y===null&&(m=m.alternate,m!==null&&(y=m.memoizedState)),y!==null)return y.dehydrated}return null}function c(m){if(a(m)!==m)throw Error(s(188))}function u(m){var y=m.alternate;if(!y){if(y=a(m),y===null)throw Error(s(188));return y!==m?null:m}for(var _=m,T=y;;){var O=_.return;if(O===null)break;var z=O.alternate;if(z===null){if(T=O.return,T!==null){_=T;continue}break}if(O.child===z.child){for(z=O.child;z;){if(z===_)return c(O),m;if(z===T)return c(O),y;z=z.sibling}throw Error(s(188))}if(_.return!==T.return)_=O,T=z;else{for(var ce=!1,ke=O.child;ke;){if(ke===_){ce=!0,_=O,T=z;break}if(ke===T){ce=!0,T=O,_=z;break}ke=ke.sibling}if(!ce){for(ke=z.child;ke;){if(ke===_){ce=!0,_=z,T=O;break}if(ke===T){ce=!0,T=z,_=O;break}ke=ke.sibling}if(!ce)throw Error(s(189))}}if(_.alternate!==T)throw Error(s(190))}if(_.tag!==3)throw Error(s(188));return _.stateNode.current===_?m:y}function f(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m;for(m=m.child;m!==null;){if(y=f(m),y!==null)return y;m=m.sibling}return null}var d=Object.assign,h=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function P(m){return m===null||typeof m!="object"?null:(m=L&&m[L]||m["@@iterator"],typeof m=="function"?m:null)}var j=Symbol.for("react.client.reference");function G(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===j?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case b:return"Fragment";case w:return"Profiler";case v:return"StrictMode";case M:return"Suspense";case k:return"SuspenseList";case A:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case g:return"Portal";case S:return m.displayName||"Context";case x:return(m._context.displayName||"Context")+".Consumer";case C:var y=m.render;return m=m.displayName,m||(m=y.displayName||y.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case E:return y=m.displayName||null,y!==null?y:G(m.type)||"Memo";case I:y=m._payload,m=m._init;try{return G(m(y))}catch{}}return null}var Q=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},ne=[],le=-1;function H(m){return{current:m}}function R(m){0>le||(m.current=ne[le],ne[le]=null,le--)}function B(m,y){le++,ne[le]=m.current,m.current=y}var W=H(null),se=H(null),ue=H(null),ge=H(null);function Ce(m,y){switch(B(ue,y),B(se,m),B(W,null),y.nodeType){case 9:case 11:m=(m=y.documentElement)&&(m=m.namespaceURI)?Ps(m):0;break;default:if(m=y.tagName,y=y.namespaceURI)y=Ps(y),m=ss(y,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}R(W),B(W,m)}function Se(){R(W),R(se),R(ue)}function Me(m){m.memoizedState!==null&&B(ge,m);var y=W.current,_=ss(y,m.type);y!==_&&(B(se,m),B(W,_))}function pe(m){se.current===m&&(R(W),R(se)),ge.current===m&&(R(ge),PC._currentValue=Z)}var fe,$e;function We(m){if(fe===void 0)try{throw Error()}catch(_){var y=_.stack.trim().match(/\n( *(at )?)/);fe=y&&y[1]||"",$e=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fe+m+$e}var de=!1;function Be(m,y){if(!m||de)return"";de=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(y){var tn=function(){throw Error()};if(Object.defineProperty(tn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(tn,[])}catch(Pt){var Lt=Pt}Reflect.construct(m,[],tn)}else{try{tn.call()}catch(Pt){Lt=Pt}m.call(tn.prototype)}}else{try{throw Error()}catch(Pt){Lt=Pt}(tn=m())&&typeof tn.catch=="function"&&tn.catch(function(){})}}catch(Pt){if(Pt&&Lt&&typeof Pt.stack=="string")return[Pt.stack,Lt.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var O=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");O&&O.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=T.DetermineComponentFrameRoot(),ce=z[0],ke=z[1];if(ce&&ke){var Qe=ce.split(`
`),kt=ke.split(`
`);for(O=T=0;T<Qe.length&&!Qe[T].includes("DetermineComponentFrameRoot");)T++;for(;O<kt.length&&!kt[O].includes("DetermineComponentFrameRoot");)O++;if(T===Qe.length||O===kt.length)for(T=Qe.length-1,O=kt.length-1;1<=T&&0<=O&&Qe[T]!==kt[O];)O--;for(;1<=T&&0<=O;T--,O--)if(Qe[T]!==kt[O]){if(T!==1||O!==1)do if(T--,O--,0>O||Qe[T]!==kt[O]){var Kt=`
`+Qe[T].replace(" at new "," at ");return m.displayName&&Kt.includes("<anonymous>")&&(Kt=Kt.replace("<anonymous>",m.displayName)),Kt}while(1<=T&&0<=O);break}}}finally{de=!1,Error.prepareStackTrace=_}return(_=m?m.displayName||m.name:"")?We(_):""}function st(m,y){switch(m.tag){case 26:case 27:case 5:return We(m.type);case 16:return We("Lazy");case 13:return m.child!==y&&y!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return Be(m.type,!1);case 11:return Be(m.type.render,!1);case 1:return Be(m.type,!0);case 31:return We("Activity");default:return""}}function He(m){try{var y="",_=null;do y+=st(m,_),_=m,m=m.return;while(m);return y}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}var Xe=Object.prototype.hasOwnProperty,Ke=n.unstable_scheduleCallback,Ze=n.unstable_cancelCallback,xt=n.unstable_shouldYield,dt=n.unstable_requestPaint,Ft=n.unstable_now,It=n.unstable_getCurrentPriorityLevel,Bt=n.unstable_ImmediatePriority,Gt=n.unstable_UserBlockingPriority,At=n.unstable_NormalPriority,ht=n.unstable_LowPriority,Qt=n.unstable_IdlePriority,Xt=n.log,us=n.unstable_setDisableYieldValue,yn=null,En=null;function Vn(m){if(typeof Xt=="function"&&us(m),En&&typeof En.setStrictMode=="function")try{En.setStrictMode(yn,m)}catch{}}var Nn=Math.clz32?Math.clz32:os,Dn=Math.log,gr=Math.LN2;function os(m){return m>>>=0,m===0?32:31-(Dn(m)/gr|0)|0}var ps=256,Ss=262144,Qn=4194304;function On(m){var y=m&42;if(y!==0)return y;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return m&261888;case 262144:case 524288:case 1048576:case 2097152:return m&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Mt(m,y,_){var T=m.pendingLanes;if(T===0)return 0;var O=0,z=m.suspendedLanes,ce=m.pingedLanes;m=m.warmLanes;var ke=T&134217727;return ke!==0?(T=ke&~z,T!==0?O=On(T):(ce&=ke,ce!==0?O=On(ce):_||(_=ke&~m,_!==0&&(O=On(_))))):(ke=T&~z,ke!==0?O=On(ke):ce!==0?O=On(ce):_||(_=T&~m,_!==0&&(O=On(_)))),O===0?0:y!==0&&y!==O&&(y&z)===0&&(z=O&-O,_=y&-y,z>=_||z===32&&(_&4194048)!==0)?y:O}function sn(m,y){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&y)===0}function Tn(m,y){switch(m){case 1:case 2:case 4:case 8:case 64:return y+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ai(){var m=Qn;return Qn<<=1,(Qn&62914560)===0&&(Qn=4194304),m}function ir(m){for(var y=[],_=0;31>_;_++)y.push(m);return y}function Fn(m,y){m.pendingLanes|=y,y!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function fs(m,y,_,T,O,z){var ce=m.pendingLanes;m.pendingLanes=_,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=_,m.entangledLanes&=_,m.errorRecoveryDisabledLanes&=_,m.shellSuspendCounter=0;var ke=m.entanglements,Qe=m.expirationTimes,kt=m.hiddenUpdates;for(_=ce&~_;0<_;){var Kt=31-Nn(_),tn=1<<Kt;ke[Kt]=0,Qe[Kt]=-1;var Lt=kt[Kt];if(Lt!==null)for(kt[Kt]=null,Kt=0;Kt<Lt.length;Kt++){var Pt=Lt[Kt];Pt!==null&&(Pt.lane&=-536870913)}_&=~tn}T!==0&&ro(m,T,0),z!==0&&O===0&&m.tag!==0&&(m.suspendedLanes|=z&~(ce&~y))}function ro(m,y,_){m.pendingLanes|=y,m.suspendedLanes&=~y;var T=31-Nn(y);m.entangledLanes|=y,m.entanglements[T]=m.entanglements[T]|1073741824|_&261930}function re(m,y){var _=m.entangledLanes|=y;for(m=m.entanglements;_;){var T=31-Nn(_),O=1<<T;O&y|m[T]&y&&(m[T]|=y),_&=~O}}function Pe(m,y){var _=y&-y;return _=(_&42)!==0?1:ve(_),(_&(m.suspendedLanes|y))!==0?0:_}function ve(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function Oe(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function ze(){var m=te.p;return m!==0?m:(m=window.event,m===void 0?32:P7(m.type))}function ut(m,y){var _=te.p;try{return te.p=m,y()}finally{te.p=_}}var Et=Math.random().toString(36).slice(2),rn="__reactFiber$"+Et,xn="__reactProps$"+Et,un="__reactContainer$"+Et,Gn="__reactEvents$"+Et,hn="__reactListeners$"+Et,vs="__reactHandles$"+Et,_s="__reactResources$"+Et,Vr="__reactMarker$"+Et;function Yr(m){delete m[rn],delete m[xn],delete m[Gn],delete m[hn],delete m[vs]}function Cr(m){var y=m[rn];if(y)return y;for(var _=m.parentNode;_;){if(y=_[un]||_[rn]){if(_=y.alternate,y.child!==null||_!==null&&_.child!==null)for(m=ho(m);m!==null;){if(_=m[rn])return _;m=ho(m)}return y}m=_,_=m.parentNode}return null}function Kr(m){if(m=m[rn]||m[un]){var y=m.tag;if(y===5||y===6||y===13||y===31||y===26||y===27||y===3)return m}return null}function sl(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m.stateNode;throw Error(s(33))}function Ni(m){var y=m[_s];return y||(y=m[_s]={hoistableStyles:new Map,hoistableScripts:new Map}),y}function Xr(m){m[Vr]=!0}var ka=new Set,oi={};function wa(m,y){li(m,y),li(m+"Capture",y)}function li(m,y){for(oi[m]=y,m=0;m<y.length;m++)ka.add(y[m])}var pi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yo={},rl={};function Gc(m){return Xe.call(rl,m)?!0:Xe.call(yo,m)?!1:pi.test(m)?rl[m]=!0:(yo[m]=!0,!1)}function va(m,y,_){if(Gc(y))if(_===null)m.removeAttribute(y);else{switch(typeof _){case"undefined":case"function":case"symbol":m.removeAttribute(y);return;case"boolean":var T=y.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){m.removeAttribute(y);return}}m.setAttribute(y,""+_)}}function bo(m,y,_){if(_===null)m.removeAttribute(y);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(y);return}m.setAttribute(y,""+_)}}function Wa(m,y,_,T){if(T===null)m.removeAttribute(_);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(_);return}m.setAttributeNS(y,_,""+T)}}function Us(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function Ga(m){var y=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function Zt(m,y,_){var T=Object.getOwnPropertyDescriptor(m.constructor.prototype,y);if(!m.hasOwnProperty(y)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var O=T.get,z=T.set;return Object.defineProperty(m,y,{configurable:!0,get:function(){return O.call(this)},set:function(ce){_=""+ce,z.call(this,ce)}}),Object.defineProperty(m,y,{enumerable:T.enumerable}),{getValue:function(){return _},setValue:function(ce){_=""+ce},stopTracking:function(){m._valueTracker=null,delete m[y]}}}}function cn(m){if(!m._valueTracker){var y=Ga(m)?"checked":"value";m._valueTracker=Zt(m,y,""+m[y])}}function In(m){if(!m)return!1;var y=m._valueTracker;if(!y)return!0;var _=y.getValue(),T="";return m&&(T=Ga(m)?m.checked?"true":"false":m.value),m=T,m!==_?(y.setValue(m),!0):!1}function Rs(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var xi=/[\n"\\]/g;function ci(m){return m.replace(xi,function(y){return"\\"+y.charCodeAt(0).toString(16)+" "})}function Gl(m,y,_,T,O,z,ce,ke){m.name="",ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?m.type=ce:m.removeAttribute("type"),y!=null?ce==="number"?(y===0&&m.value===""||m.value!=y)&&(m.value=""+Us(y)):m.value!==""+Us(y)&&(m.value=""+Us(y)):ce!=="submit"&&ce!=="reset"||m.removeAttribute("value"),y!=null?ft(m,ce,Us(y)):_!=null?ft(m,ce,Us(_)):T!=null&&m.removeAttribute("value"),O==null&&z!=null&&(m.defaultChecked=!!z),O!=null&&(m.checked=O&&typeof O!="function"&&typeof O!="symbol"),ke!=null&&typeof ke!="function"&&typeof ke!="symbol"&&typeof ke!="boolean"?m.name=""+Us(ke):m.removeAttribute("name")}function Of(m,y,_,T,O,z,ce,ke){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(m.type=z),y!=null||_!=null){if(!(z!=="submit"&&z!=="reset"||y!=null)){cn(m);return}_=_!=null?""+Us(_):"",y=y!=null?""+Us(y):_,ke||y===m.value||(m.value=y),m.defaultValue=y}T=T??O,T=typeof T!="function"&&typeof T!="symbol"&&!!T,m.checked=ke?m.checked:!!T,m.defaultChecked=!!T,ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"&&(m.name=ce),cn(m)}function ft(m,y,_){y==="number"&&Rs(m.ownerDocument)===m||m.defaultValue===""+_||(m.defaultValue=""+_)}function oe(m,y,_,T){if(m=m.options,y){y={};for(var O=0;O<_.length;O++)y["$"+_[O]]=!0;for(_=0;_<m.length;_++)O=y.hasOwnProperty("$"+m[_].value),m[_].selected!==O&&(m[_].selected=O),O&&T&&(m[_].defaultSelected=!0)}else{for(_=""+Us(_),y=null,O=0;O<m.length;O++){if(m[O].value===_){m[O].selected=!0,T&&(m[O].defaultSelected=!0);return}y!==null||m[O].disabled||(y=m[O])}y!==null&&(y.selected=!0)}}function Ne(m,y,_){if(y!=null&&(y=""+Us(y),y!==m.value&&(m.value=y),_==null)){m.defaultValue!==y&&(m.defaultValue=y);return}m.defaultValue=_!=null?""+Us(_):""}function Ue(m,y,_,T){if(y==null){if(T!=null){if(_!=null)throw Error(s(92));if(Q(T)){if(1<T.length)throw Error(s(93));T=T[0]}_=T}_==null&&(_=""),y=_}_=Us(y),m.defaultValue=_,T=m.textContent,T===_&&T!==""&&T!==null&&(m.value=T),cn(m)}function Ve(m,y){if(y){var _=m.firstChild;if(_&&_===m.lastChild&&_.nodeType===3){_.nodeValue=y;return}}m.textContent=y}var Ct=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rt(m,y,_){var T=y.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?T?m.setProperty(y,""):y==="float"?m.cssFloat="":m[y]="":T?m.setProperty(y,_):typeof _!="number"||_===0||Ct.has(y)?y==="float"?m.cssFloat=_:m[y]=(""+_).trim():m[y]=_+"px"}function wn(m,y,_){if(y!=null&&typeof y!="object")throw Error(s(62));if(m=m.style,_!=null){for(var T in _)!_.hasOwnProperty(T)||y!=null&&y.hasOwnProperty(T)||(T.indexOf("--")===0?m.setProperty(T,""):T==="float"?m.cssFloat="":m[T]="");for(var O in y)T=y[O],y.hasOwnProperty(O)&&_[O]!==T&&Rt(m,O,T)}else for(var z in y)y.hasOwnProperty(z)&&Rt(m,z,y[z])}function bn(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _n=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ls(m){return mn.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}function ds(){}var Ar=null;function Ci(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Sr=null,An=null;function Lr(m){var y=Kr(m);if(y&&(m=y.stateNode)){var _=m[xn]||null;e:switch(m=y.stateNode,y.type){case"input":if(Gl(m,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),y=_.name,_.type==="radio"&&y!=null){for(_=m;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+ci(""+y)+'"][type="radio"]'),y=0;y<_.length;y++){var T=_[y];if(T!==m&&T.form===m.form){var O=T[xn]||null;if(!O)throw Error(s(90));Gl(T,O.value,O.defaultValue,O.defaultValue,O.checked,O.defaultChecked,O.type,O.name)}}for(y=0;y<_.length;y++)T=_[y],T.form===m.form&&In(T)}break e;case"textarea":Ne(m,_.value,_.defaultValue);break e;case"select":y=_.value,y!=null&&oe(m,!!_.multiple,y,!1)}}}var wo=!1;function Ml(m,y,_){if(wo)return m(y,_);wo=!0;try{var T=m(y);return T}finally{if(wo=!1,(Sr!==null||An!==null)&&(ay(),Sr&&(y=Sr,m=An,An=Sr=null,Lr(y),m)))for(y=0;y<m.length;y++)Lr(m[y])}}function Fr(m,y){var _=m.stateNode;if(_===null)return null;var T=_[xn]||null;if(T===null)return null;_=T[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(m=m.type,T=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!T;break e;default:m=!1}if(m)return null;if(_&&typeof _!="function")throw Error(s(231,y,typeof _));return _}var Si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qr=!1;if(Si)try{var mi={};Object.defineProperty(mi,"passive",{get:function(){Qr=!0}}),window.addEventListener("test",mi,mi),window.removeEventListener("test",mi,mi)}catch{Qr=!1}var Wr=null,io=null,Ha=null;function Yi(){if(Ha)return Ha;var m,y=io,_=y.length,T,O="value"in Wr?Wr.value:Wr.textContent,z=O.length;for(m=0;m<_&&y[m]===O[m];m++);var ce=_-m;for(T=1;T<=ce&&y[_-T]===O[z-T];T++);return Ha=O.slice(m,1<T?1-T:void 0)}function aa(m){var y=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&y===13&&(m=13)):m=y,m===10&&(m=13),32<=m||m===13?m:0}function Di(){return!0}function Gr(){return!1}function Qs(m){function y(_,T,O,z,ce){this._reactName=_,this._targetInst=O,this.type=T,this.nativeEvent=z,this.target=ce,this.currentTarget=null;for(var ke in m)m.hasOwnProperty(ke)&&(_=m[ke],this[ke]=_?_(z):z[ke]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Di:Gr,this.isPropagationStopped=Gr,this}return d(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=Di)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=Di)},persist:function(){},isPersistent:Di}),y}var Nr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oi=Qs(Nr),il=d({},Nr,{view:0,detail:0}),Tl=Qs(il),Tu,Hc,qc,ef=d({},il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xs,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==qc&&(qc&&m.type==="mousemove"?(Tu=m.screenX-qc.screenX,Hc=m.screenY-qc.screenY):Hc=Tu=0,qc=m),Tu)},movementY:function(m){return"movementY"in m?m.movementY:Hc}}),Nd=Qs(ef),al=d({},ef,{dataTransfer:0}),Yc=Qs(al),Ch=d({},il,{relatedTarget:0}),Kc=Qs(Ch),Sh=d({},Nr,{animationName:0,elapsedTime:0,pseudoElement:0}),Y=Qs(Sh),me=d({},Nr,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),Fe=Qs(me),Je=d({},Nr,{data:0}),pt=Qs(Je),Ht={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qn(m){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(m):(m=zn[m])?!!y[m]:!1}function xs(){return qn}var ks=d({},il,{key:function(m){if(m.key){var y=Ht[m.key]||m.key;if(y!=="Unidentified")return y}return m.type==="keypress"?(m=aa(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?nn[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xs,charCode:function(m){return m.type==="keypress"?aa(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?aa(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),pr=Qs(ks),gi=d({},ef,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ki=Qs(gi),Jr=d({},il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xs}),Ea=Qs(Jr),zi=d({},Nr,{propertyName:0,elapsedTime:0,pseudoElement:0}),_a=Qs(zi),vc=d({},ef,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),ol=Qs(vc),Xc=d({},Nr,{newState:0,oldState:0}),Dd=Qs(Xc),Pf=[9,13,27,32],_c=Si&&"CompositionEvent"in window,Hl=null;Si&&"documentMode"in document&&(Hl=document.documentMode);var tf=Si&&"TextEvent"in window&&!Hl,xc=Si&&(!_c||Hl&&8<Hl&&11>=Hl),Xi=" ",kl=!1;function Cc(m,y){switch(m){case"keyup":return Pf.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $f(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var El=!1;function Ia(m,y){switch(m){case"compositionend":return $f(y);case"keypress":return y.which!==32?null:(kl=!0,Xi);case"textInput":return m=y.data,m===Xi&&kl?null:m;default:return null}}function ql(m,y){if(El)return m==="compositionend"||!_c&&Cc(m,y)?(m=Yi(),Ha=io=Wr=null,El=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return xc&&y.locale!=="ko"?null:y.data;default:return null}}var ku={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yl(m){var y=m&&m.nodeName&&m.nodeName.toLowerCase();return y==="input"?!!ku[m.type]:y==="textarea"}function zo(m,y,_,T){Sr?An?An.push(T):An=[T]:Sr=T,y=Zf(y,"onChange"),0<y.length&&(_=new Oi("onChange","change",null,_,T),m.push({event:_,listeners:y}))}var Kl=null,Sc=null;function Od(m){qE(m,0)}function Xl(m){var y=sl(m);if(In(y))return m}function Mc(m,y){if(m==="change")return y}var vo=!1;if(Si){var Aa;if(Si){var Pn="oninput"in document;if(!Pn){var Tc=document.createElement("div");Tc.setAttribute("oninput","return;"),Pn=typeof Tc.oninput=="function"}Aa=Pn}else Aa=!1;vo=Aa&&(!document.documentMode||9<document.documentMode)}function kc(){Kl&&(Kl.detachEvent("onpropertychange",Qc),Sc=Kl=null)}function Qc(m){if(m.propertyName==="value"&&Xl(Sc)){var y=[];zo(y,Sc,m,Ci(m)),Ml(Od,y)}}function Jc(m,y,_){m==="focusin"?(kc(),Kl=y,Sc=_,Kl.attachEvent("onpropertychange",Qc)):m==="focusout"&&kc()}function Dr(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return Xl(Sc)}function nf(m,y){if(m==="click")return Xl(y)}function ll(m,y){if(m==="input"||m==="change")return Xl(y)}function Ql(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var La=typeof Object.is=="function"?Object.is:Ql;function Jl(m,y){if(La(m,y))return!0;if(typeof m!="object"||m===null||typeof y!="object"||y===null)return!1;var _=Object.keys(m),T=Object.keys(y);if(_.length!==T.length)return!1;for(T=0;T<_.length;T++){var O=_[T];if(!Xe.call(y,O)||!La(m[O],y[O]))return!1}return!0}function Eu(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function sf(m,y){var _=Eu(m);m=0;for(var T;_;){if(_.nodeType===3){if(T=m+_.textContent.length,m<=y&&T>=y)return{node:_,offset:y-m};m=T}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=Eu(_)}}function Zl(m,y){return m&&y?m===y?!0:m&&m.nodeType===3?!1:y&&y.nodeType===3?Zl(m,y.parentNode):"contains"in m?m.contains(y):m.compareDocumentPosition?!!(m.compareDocumentPosition(y)&16):!1:!1}function Ec(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var y=Rs(m.document);y instanceof m.HTMLIFrameElement;){try{var _=typeof y.contentWindow.location.href=="string"}catch{_=!1}if(_)m=y.contentWindow;else break;y=Rs(m.document)}return y}function cl(m){var y=m&&m.nodeName&&m.nodeName.toLowerCase();return y&&(y==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||y==="textarea"||m.contentEditable==="true")}var Ic=Si&&"documentMode"in document&&11>=document.documentMode,_o=null,Ac=null,Na=null,ul=!1;function yr(m,y,_){var T=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;ul||_o==null||_o!==Rs(T)||(T=_o,"selectionStart"in T&&cl(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),Na&&Jl(Na,T)||(Na=T,T=Zf(Ac,"onSelect"),0<T.length&&(y=new Oi("onSelect","select",null,y,_),m.push({event:y,listeners:T}),y.target=_o)))}function nr(m,y){var _={};return _[m.toLowerCase()]=y.toLowerCase(),_["Webkit"+m]="webkit"+y,_["Moz"+m]="moz"+y,_}var F={animationend:nr("Animation","AnimationEnd"),animationiteration:nr("Animation","AnimationIteration"),animationstart:nr("Animation","AnimationStart"),transitionrun:nr("Transition","TransitionRun"),transitionstart:nr("Transition","TransitionStart"),transitioncancel:nr("Transition","TransitionCancel"),transitionend:nr("Transition","TransitionEnd")},ee={},he={};Si&&(he=document.createElement("div").style,"AnimationEvent"in window||(delete F.animationend.animation,delete F.animationiteration.animation,delete F.animationstart.animation),"TransitionEvent"in window||delete F.transitionend.transition);function be(m){if(ee[m])return ee[m];if(!F[m])return m;var y=F[m],_;for(_ in y)if(y.hasOwnProperty(_)&&_ in he)return ee[m]=y[_];return m}var Le=be("animationend"),rt=be("animationiteration"),$t=be("animationstart"),an=be("transitionrun"),vn=be("transitionstart"),Rn=be("transitioncancel"),Es=be("transitionend"),Js=new Map,sr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sr.push("scrollEnd");function zr(m,y){Js.set(m,y),wa(y,[m])}var Lc=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)},fl=[],jf=0,Bm=0;function Ep(){for(var m=jf,y=Bm=jf=0;y<m;){var _=fl[y];fl[y++]=null;var T=fl[y];fl[y++]=null;var O=fl[y];fl[y++]=null;var z=fl[y];if(fl[y++]=null,T!==null&&O!==null){var ce=T.pending;ce===null?O.next=O:(O.next=ce.next,ce.next=O),T.pending=O}z!==0&&Th(_,O,z)}}function Mh(m,y,_,T){fl[jf++]=m,fl[jf++]=y,fl[jf++]=_,fl[jf++]=T,Bm|=T,m.lanes|=T,m=m.alternate,m!==null&&(m.lanes|=T)}function Um(m,y,_,T){return Mh(m,y,_,T),Bo(m)}function rf(m,y){return Mh(m,null,null,y),Bo(m)}function Th(m,y,_){m.lanes|=_;var T=m.alternate;T!==null&&(T.lanes|=_);for(var O=!1,z=m.return;z!==null;)z.childLanes|=_,T=z.alternate,T!==null&&(T.childLanes|=_),z.tag===22&&(m=z.stateNode,m===null||m._visibility&1||(O=!0)),m=z,z=z.return;return m.tag===3?(z=m.stateNode,O&&y!==null&&(O=31-Nn(_),m=z.hiddenUpdates,T=m[O],T===null?m[O]=[y]:T.push(y),y.lane=_|536870912),z):null}function Bo(m){if(50<ry)throw ry=0,iy=null,Error(s(185));for(var y=m.return;y!==null;)m=y,y=m.return;return m.tag===3?m.stateNode:null}var xo={};function Ip(m,y,_,T){this.tag=m,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Uo(m,y,_,T){return new Ip(m,y,_,T)}function Vm(m){return m=m.prototype,!(!m||!m.isReactComponent)}function ec(m,y){var _=m.alternate;return _===null?(_=Uo(m.tag,y,m.key,m.mode),_.elementType=m.elementType,_.type=m.type,_.stateNode=m.stateNode,_.alternate=m,m.alternate=_):(_.pendingProps=y,_.type=m.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=m.flags&65011712,_.childLanes=m.childLanes,_.lanes=m.lanes,_.child=m.child,_.memoizedProps=m.memoizedProps,_.memoizedState=m.memoizedState,_.updateQueue=m.updateQueue,y=m.dependencies,_.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},_.sibling=m.sibling,_.index=m.index,_.ref=m.ref,_.refCleanup=m.refCleanup,_}function Ap(m,y){m.flags&=65011714;var _=m.alternate;return _===null?(m.childLanes=0,m.lanes=y,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=_.childLanes,m.lanes=_.lanes,m.child=_.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=_.memoizedProps,m.memoizedState=_.memoizedState,m.updateQueue=_.updateQueue,m.type=_.type,y=_.dependencies,m.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),m}function kh(m,y,_,T,O,z){var ce=0;if(T=m,typeof m=="function")Vm(m)&&(ce=1);else if(typeof m=="string")ce=j0e(m,_,W.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case A:return m=Uo(31,_,y,O),m.elementType=A,m.lanes=z,m;case b:return af(_.children,O,z,y);case v:ce=8,O|=24;break;case w:return m=Uo(12,_,y,O|2),m.elementType=w,m.lanes=z,m;case M:return m=Uo(13,_,y,O),m.elementType=M,m.lanes=z,m;case k:return m=Uo(19,_,y,O),m.elementType=k,m.lanes=z,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case S:ce=10;break e;case x:ce=9;break e;case C:ce=11;break e;case E:ce=14;break e;case I:ce=16,T=null;break e}ce=29,_=Error(s(130,m===null?"null":typeof m,"")),T=null}return y=Uo(ce,_,y,O),y.elementType=m,y.type=T,y.lanes=z,y}function af(m,y,_,T){return m=Uo(7,m,T,y),m.lanes=_,m}function Lp(m,y,_){return m=Uo(6,m,null,y),m.lanes=_,m}function Wm(m){var y=Uo(18,null,null,0);return y.stateNode=m,y}function Pd(m,y,_){return y=Uo(4,m.children!==null?m.children:[],m.key,y),y.lanes=_,y.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},y}var Gm=new WeakMap;function Nc(m,y){if(typeof m=="object"&&m!==null){var _=Gm.get(m);return _!==void 0?_:(y={value:m,source:y,stack:He(y)},Gm.set(m,y),y)}return{value:m,source:y,stack:He(y)}}var $d=[],jd=0,Hm=null,Eh=0,Dc=[],Oc=0,of=null,Pc=1,$c="";function Il(m,y){$d[jd++]=Eh,$d[jd++]=Hm,Hm=m,Eh=y}function $1(m,y,_){Dc[Oc++]=Pc,Dc[Oc++]=$c,Dc[Oc++]=of,of=m;var T=Pc;m=$c;var O=32-Nn(T)-1;T&=~(1<<O),_+=1;var z=32-Nn(y)+O;if(30<z){var ce=O-O%5;z=(T&(1<<ce)-1).toString(32),T>>=ce,O-=ce,Pc=1<<32-Nn(y)+O|_<<O|T,$c=z+m}else Pc=1<<z|_<<O|T,$c=m}function t0(m){m.return!==null&&(Il(m,1),$1(m,1,0))}function Np(m){for(;m===Hm;)Hm=$d[--jd],$d[jd]=null,Eh=$d[--jd],$d[jd]=null;for(;m===of;)of=Dc[--Oc],Dc[Oc]=null,$c=Dc[--Oc],Dc[Oc]=null,Pc=Dc[--Oc],Dc[Oc]=null}function j1(m,y){Dc[Oc++]=Pc,Dc[Oc++]=$c,Dc[Oc++]=of,Pc=y.id,$c=y.overflow,of=m}var Co=null,Mi=null,mr=!1,dl=null,Qi=!1,Zc=Error(s(519));function Rf(m){var y=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ih(Nc(y,m)),Zc}function qm(m){var y=m.stateNode,_=m.type,T=m.memoizedProps;switch(y[rn]=m,y[xn]=T,_){case"dialog":wr("cancel",y),wr("close",y);break;case"iframe":case"object":case"embed":wr("load",y);break;case"video":case"audio":for(_=0;_<fy.length;_++)wr(fy[_],y);break;case"source":wr("error",y);break;case"img":case"image":case"link":wr("error",y),wr("load",y);break;case"details":wr("toggle",y);break;case"input":wr("invalid",y),Of(y,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0);break;case"select":wr("invalid",y);break;case"textarea":wr("invalid",y),Ue(y,T.value,T.defaultValue,T.children)}_=T.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||y.textContent===""+_||T.suppressHydrationWarning===!0||Ee(y.textContent,_)?(T.popover!=null&&(wr("beforetoggle",y),wr("toggle",y)),T.onScroll!=null&&wr("scroll",y),T.onScrollEnd!=null&&wr("scrollend",y),T.onClick!=null&&(y.onclick=ds),y=!0):y=!1,y||Rf(m,!0)}function lf(m){for(Co=m.return;Co;)switch(Co.tag){case 5:case 31:case 13:Qi=!1;return;case 27:case 3:Qi=!0;return;default:Co=Co.return}}function So(m){if(m!==Co)return!1;if(!mr)return lf(m),mr=!0,!1;var y=m.tag,_;if((_=y!==3&&y!==27)&&((_=y===5)&&(_=m.type,_=!(_!=="form"&&_!=="button")||vr(m.type,m.memoizedProps)),_=!_),_&&Mi&&Rf(m),lf(m),y===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));Mi=Ui(m)}else if(y===31){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));Mi=Ui(m)}else y===27?(y=Mi,Ii(m.type)?(m=IC,IC=null,Mi=m):Mi=y):Mi=Co?nc(m.stateNode.nextSibling):null;return!0}function Ff(){Mi=Co=null,mr=!1}function n0(){var m=dl;return m!==null&&(Nl===null?Nl=m:Nl.push.apply(Nl,m),dl=null),m}function Ih(m){dl===null?dl=[m]:dl.push(m)}var Dp=H(null),zf=null,Iu=null;function cf(m,y,_){B(Dp,y._currentValue),y._currentValue=_}function jc(m){m._currentValue=Dp.current,R(Dp)}function Ah(m,y,_){for(;m!==null;){var T=m.alternate;if((m.childLanes&y)!==y?(m.childLanes|=y,T!==null&&(T.childLanes|=y)):T!==null&&(T.childLanes&y)!==y&&(T.childLanes|=y),m===_)break;m=m.return}}function Bf(m,y,_,T){var O=m.child;for(O!==null&&(O.return=m);O!==null;){var z=O.dependencies;if(z!==null){var ce=O.child;z=z.firstContext;e:for(;z!==null;){var ke=z;z=O;for(var Qe=0;Qe<y.length;Qe++)if(ke.context===y[Qe]){z.lanes|=_,ke=z.alternate,ke!==null&&(ke.lanes|=_),Ah(z.return,_,m),T||(ce=null);break e}z=ke.next}}else if(O.tag===18){if(ce=O.return,ce===null)throw Error(s(341));ce.lanes|=_,z=ce.alternate,z!==null&&(z.lanes|=_),Ah(ce,_,m),ce=null}else ce=O.child;if(ce!==null)ce.return=O;else for(ce=O;ce!==null;){if(ce===m){ce=null;break}if(O=ce.sibling,O!==null){O.return=ce.return,ce=O;break}ce=ce.return}O=ce}}function Uf(m,y,_,T){m=null;for(var O=y,z=!1;O!==null;){if(!z){if((O.flags&524288)!==0)z=!0;else if((O.flags&262144)!==0)break}if(O.tag===10){var ce=O.alternate;if(ce===null)throw Error(s(387));if(ce=ce.memoizedProps,ce!==null){var ke=O.type;La(O.pendingProps.value,ce.value)||(m!==null?m.push(ke):m=[ke])}}else if(O===ge.current){if(ce=O.alternate,ce===null)throw Error(s(387));ce.memoizedState.memoizedState!==O.memoizedState.memoizedState&&(m!==null?m.push(PC):m=[PC])}O=O.return}m!==null&&Bf(y,m,_,T),y.flags|=262144}function Ym(m){for(m=m.firstContext;m!==null;){if(!La(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function Vf(m){zf=m,Iu=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Mo(m){return R1(zf,m)}function Op(m,y){return zf===null&&Vf(m),R1(m,y)}function R1(m,y){var _=y._currentValue;if(y={context:y,memoizedValue:_,next:null},Iu===null){if(m===null)throw Error(s(308));Iu=y,m.dependencies={lanes:0,firstContext:y},m.flags|=524288}else Iu=Iu.next=y;return _}var yw=typeof AbortController<"u"?AbortController:function(){var m=[],y=this.signal={aborted:!1,addEventListener:function(_,T){m.push(T)}};this.abort=function(){y.aborted=!0,m.forEach(function(_){return _()})}},F1=n.unstable_scheduleCallback,bw=n.unstable_NormalPriority,xa={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rd(){return{controller:new yw,data:new Map,refCount:0}}function Pp(m){m.refCount--,m.refCount===0&&F1(bw,function(){m.controller.abort()})}var $p=null,jp=0,N=0,$=null;function J(m,y){if($p===null){var _=$p=[];jp=0,N=SC(),$={status:"pending",value:void 0,then:function(T){_.push(T)}}}return jp++,y.then(ie,ie),y}function ie(){if(--jp===0&&$p!==null){$!==null&&($.status="fulfilled");var m=$p;$p=null,N=0,$=null;for(var y=0;y<m.length;y++)(0,m[y])()}}function ye(m,y){var _=[],T={status:"pending",value:null,reason:null,then:function(O){_.push(O)}};return m.then(function(){T.status="fulfilled",T.value=y;for(var O=0;O<_.length;O++)(0,_[O])(y)},function(O){for(T.status="rejected",T.reason=O,O=0;O<_.length;O++)(0,_[O])(void 0)}),T}var _e=q.S;q.S=function(m,y){rC=Ft(),typeof y=="object"&&y!==null&&typeof y.then=="function"&&J(m,y),_e!==null&&_e(m,y)};var xe=H(null);function Ae(){var m=xe.current;return m!==null?m:$i.pooledCache}function De(m,y){y===null?B(xe,xe.current):B(xe,y.pool)}function Re(){var m=Ae();return m===null?null:{parent:xa._currentValue,pool:m}}var tt=Error(s(460)),St=Error(s(474)),je=Error(s(542)),ct={then:function(){}};function gt(m){return m=m.status,m==="fulfilled"||m==="rejected"}function Ut(m,y,_){switch(_=m[_],_===void 0?m.push(y):_!==y&&(y.then(ds,ds),y=_),y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,dn(m),m;default:if(typeof y.status=="string")y.then(ds,ds);else{if(m=$i,m!==null&&100<m.shellSuspendCounter)throw Error(s(482));m=y,m.status="pending",m.then(function(T){if(y.status==="pending"){var O=y;O.status="fulfilled",O.value=T}},function(T){if(y.status==="pending"){var O=y;O.status="rejected",O.reason=T}})}switch(y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,dn(m),m}throw zt=y,tt}}function _t(m){try{var y=m._init;return y(m._payload)}catch(_){throw _!==null&&typeof _=="object"&&typeof _.then=="function"?(zt=_,tt):_}}var zt=null;function Yt(){if(zt===null)throw Error(s(459));var m=zt;return zt=null,m}function dn(m){if(m===tt||m===je)throw Error(s(483))}var en=null,Yn=0;function jn(m){var y=Yn;return Yn+=1,en===null&&(en=[]),Ut(en,m,y)}function Ds(m,y){y=y.props.ref,m.ref=y!==void 0?y:null}function Wn(m,y){throw y.$$typeof===h?Error(s(525)):(m=Object.prototype.toString.call(y),Error(s(31,m==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":m)))}function ar(m){function y(mt,ot){if(m){var Tt=mt.deletions;Tt===null?(mt.deletions=[ot],mt.flags|=16):Tt.push(ot)}}function _(mt,ot){if(!m)return null;for(;ot!==null;)y(mt,ot),ot=ot.sibling;return null}function T(mt){for(var ot=new Map;mt!==null;)mt.key!==null?ot.set(mt.key,mt):ot.set(mt.index,mt),mt=mt.sibling;return ot}function O(mt,ot){return mt=ec(mt,ot),mt.index=0,mt.sibling=null,mt}function z(mt,ot,Tt){return mt.index=Tt,m?(Tt=mt.alternate,Tt!==null?(Tt=Tt.index,Tt<ot?(mt.flags|=67108866,ot):Tt):(mt.flags|=67108866,ot)):(mt.flags|=1048576,ot)}function ce(mt){return m&&mt.alternate===null&&(mt.flags|=67108866),mt}function ke(mt,ot,Tt,Jt){return ot===null||ot.tag!==6?(ot=Lp(Tt,mt.mode,Jt),ot.return=mt,ot):(ot=O(ot,Tt),ot.return=mt,ot)}function Qe(mt,ot,Tt,Jt){var Ts=Tt.type;return Ts===b?Kt(mt,ot,Tt.props.children,Jt,Tt.key):ot!==null&&(ot.elementType===Ts||typeof Ts=="object"&&Ts!==null&&Ts.$$typeof===I&&_t(Ts)===ot.type)?(ot=O(ot,Tt.props),Ds(ot,Tt),ot.return=mt,ot):(ot=kh(Tt.type,Tt.key,Tt.props,null,mt.mode,Jt),Ds(ot,Tt),ot.return=mt,ot)}function kt(mt,ot,Tt,Jt){return ot===null||ot.tag!==4||ot.stateNode.containerInfo!==Tt.containerInfo||ot.stateNode.implementation!==Tt.implementation?(ot=Pd(Tt,mt.mode,Jt),ot.return=mt,ot):(ot=O(ot,Tt.children||[]),ot.return=mt,ot)}function Kt(mt,ot,Tt,Jt,Ts){return ot===null||ot.tag!==7?(ot=af(Tt,mt.mode,Jt,Ts),ot.return=mt,ot):(ot=O(ot,Tt),ot.return=mt,ot)}function tn(mt,ot,Tt){if(typeof ot=="string"&&ot!==""||typeof ot=="number"||typeof ot=="bigint")return ot=Lp(""+ot,mt.mode,Tt),ot.return=mt,ot;if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case p:return Tt=kh(ot.type,ot.key,ot.props,null,mt.mode,Tt),Ds(Tt,ot),Tt.return=mt,Tt;case g:return ot=Pd(ot,mt.mode,Tt),ot.return=mt,ot;case I:return ot=_t(ot),tn(mt,ot,Tt)}if(Q(ot)||P(ot))return ot=af(ot,mt.mode,Tt,null),ot.return=mt,ot;if(typeof ot.then=="function")return tn(mt,jn(ot),Tt);if(ot.$$typeof===S)return tn(mt,Op(mt,ot),Tt);Wn(mt,ot)}return null}function Lt(mt,ot,Tt,Jt){var Ts=ot!==null?ot.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return Ts!==null?null:ke(mt,ot,""+Tt,Jt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case p:return Tt.key===Ts?Qe(mt,ot,Tt,Jt):null;case g:return Tt.key===Ts?kt(mt,ot,Tt,Jt):null;case I:return Tt=_t(Tt),Lt(mt,ot,Tt,Jt)}if(Q(Tt)||P(Tt))return Ts!==null?null:Kt(mt,ot,Tt,Jt,null);if(typeof Tt.then=="function")return Lt(mt,ot,jn(Tt),Jt);if(Tt.$$typeof===S)return Lt(mt,ot,Op(mt,Tt),Jt);Wn(mt,Tt)}return null}function Pt(mt,ot,Tt,Jt,Ts){if(typeof Jt=="string"&&Jt!==""||typeof Jt=="number"||typeof Jt=="bigint")return mt=mt.get(Tt)||null,ke(ot,mt,""+Jt,Ts);if(typeof Jt=="object"&&Jt!==null){switch(Jt.$$typeof){case p:return mt=mt.get(Jt.key===null?Tt:Jt.key)||null,Qe(ot,mt,Jt,Ts);case g:return mt=mt.get(Jt.key===null?Tt:Jt.key)||null,kt(ot,mt,Jt,Ts);case I:return Jt=_t(Jt),Pt(mt,ot,Tt,Jt,Ts)}if(Q(Jt)||P(Jt))return mt=mt.get(Tt)||null,Kt(ot,mt,Jt,Ts,null);if(typeof Jt.then=="function")return Pt(mt,ot,Tt,jn(Jt),Ts);if(Jt.$$typeof===S)return Pt(mt,ot,Tt,Op(ot,Jt),Ts);Wn(ot,Jt)}return null}function Jn(mt,ot,Tt,Jt){for(var Ts=null,wi=null,hs=ot,ur=ot=0,Br=null;hs!==null&&ur<Tt.length;ur++){hs.index>ur?(Br=hs,hs=null):Br=hs.sibling;var vi=Lt(mt,hs,Tt[ur],Jt);if(vi===null){hs===null&&(hs=Br);break}m&&hs&&vi.alternate===null&&y(mt,hs),ot=z(vi,ot,ur),wi===null?Ts=vi:wi.sibling=vi,wi=vi,hs=Br}if(ur===Tt.length)return _(mt,hs),mr&&Il(mt,ur),Ts;if(hs===null){for(;ur<Tt.length;ur++)hs=tn(mt,Tt[ur],Jt),hs!==null&&(ot=z(hs,ot,ur),wi===null?Ts=hs:wi.sibling=hs,wi=hs);return mr&&Il(mt,ur),Ts}for(hs=T(hs);ur<Tt.length;ur++)Br=Pt(hs,mt,ur,Tt[ur],Jt),Br!==null&&(m&&Br.alternate!==null&&hs.delete(Br.key===null?ur:Br.key),ot=z(Br,ot,ur),wi===null?Ts=Br:wi.sibling=Br,wi=Br);return m&&hs.forEach(function(I0){return y(mt,I0)}),mr&&Il(mt,ur),Ts}function Os(mt,ot,Tt,Jt){if(Tt==null)throw Error(s(151));for(var Ts=null,wi=null,hs=ot,ur=ot=0,Br=null,vi=Tt.next();hs!==null&&!vi.done;ur++,vi=Tt.next()){hs.index>ur?(Br=hs,hs=null):Br=hs.sibling;var I0=Lt(mt,hs,vi.value,Jt);if(I0===null){hs===null&&(hs=Br);break}m&&hs&&I0.alternate===null&&y(mt,hs),ot=z(I0,ot,ur),wi===null?Ts=I0:wi.sibling=I0,wi=I0,hs=Br}if(vi.done)return _(mt,hs),mr&&Il(mt,ur),Ts;if(hs===null){for(;!vi.done;ur++,vi=Tt.next())vi=tn(mt,vi.value,Jt),vi!==null&&(ot=z(vi,ot,ur),wi===null?Ts=vi:wi.sibling=vi,wi=vi);return mr&&Il(mt,ur),Ts}for(hs=T(hs);!vi.done;ur++,vi=Tt.next())vi=Pt(hs,mt,ur,vi.value,Jt),vi!==null&&(m&&vi.alternate!==null&&hs.delete(vi.key===null?ur:vi.key),ot=z(vi,ot,ur),wi===null?Ts=vi:wi.sibling=vi,wi=vi);return m&&hs.forEach(function(Y0e){return y(mt,Y0e)}),mr&&Il(mt,ur),Ts}function na(mt,ot,Tt,Jt){if(typeof Tt=="object"&&Tt!==null&&Tt.type===b&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case p:e:{for(var Ts=Tt.key;ot!==null;){if(ot.key===Ts){if(Ts=Tt.type,Ts===b){if(ot.tag===7){_(mt,ot.sibling),Jt=O(ot,Tt.props.children),Jt.return=mt,mt=Jt;break e}}else if(ot.elementType===Ts||typeof Ts=="object"&&Ts!==null&&Ts.$$typeof===I&&_t(Ts)===ot.type){_(mt,ot.sibling),Jt=O(ot,Tt.props),Ds(Jt,Tt),Jt.return=mt,mt=Jt;break e}_(mt,ot);break}else y(mt,ot);ot=ot.sibling}Tt.type===b?(Jt=af(Tt.props.children,mt.mode,Jt,Tt.key),Jt.return=mt,mt=Jt):(Jt=kh(Tt.type,Tt.key,Tt.props,null,mt.mode,Jt),Ds(Jt,Tt),Jt.return=mt,mt=Jt)}return ce(mt);case g:e:{for(Ts=Tt.key;ot!==null;){if(ot.key===Ts)if(ot.tag===4&&ot.stateNode.containerInfo===Tt.containerInfo&&ot.stateNode.implementation===Tt.implementation){_(mt,ot.sibling),Jt=O(ot,Tt.children||[]),Jt.return=mt,mt=Jt;break e}else{_(mt,ot);break}else y(mt,ot);ot=ot.sibling}Jt=Pd(Tt,mt.mode,Jt),Jt.return=mt,mt=Jt}return ce(mt);case I:return Tt=_t(Tt),na(mt,ot,Tt,Jt)}if(Q(Tt))return Jn(mt,ot,Tt,Jt);if(P(Tt)){if(Ts=P(Tt),typeof Ts!="function")throw Error(s(150));return Tt=Ts.call(Tt),Os(mt,ot,Tt,Jt)}if(typeof Tt.then=="function")return na(mt,ot,jn(Tt),Jt);if(Tt.$$typeof===S)return na(mt,ot,Op(mt,Tt),Jt);Wn(mt,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint"?(Tt=""+Tt,ot!==null&&ot.tag===6?(_(mt,ot.sibling),Jt=O(ot,Tt),Jt.return=mt,mt=Jt):(_(mt,ot),Jt=Lp(Tt,mt.mode,Jt),Jt.return=mt,mt=Jt),ce(mt)):_(mt,ot)}return function(mt,ot,Tt,Jt){try{Yn=0;var Ts=na(mt,ot,Tt,Jt);return en=null,Ts}catch(hs){if(hs===tt||hs===je)throw hs;var wi=Uo(29,hs,null,mt.mode);return wi.lanes=Jt,wi.return=mt,wi}}}var Pi=ar(!0),Fs=ar(!1),$n=!1;function Sn(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ji(m,y){m=m.updateQueue,y.updateQueue===m&&(y.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function Cs(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function Vs(m,y,_){var T=m.updateQueue;if(T===null)return null;if(T=T.shared,(ti&2)!==0){var O=T.pending;return O===null?y.next=y:(y.next=O.next,O.next=y),T.pending=y,y=Bo(m),Th(m,null,_),y}return Mh(m,T,y,_),Bo(m)}function Zr(m,y,_){if(y=y.updateQueue,y!==null&&(y=y.shared,(_&4194048)!==0)){var T=y.lanes;T&=m.pendingLanes,_|=T,y.lanes=_,re(m,_)}}function Da(m,y){var _=m.updateQueue,T=m.alternate;if(T!==null&&(T=T.updateQueue,_===T)){var O=null,z=null;if(_=_.firstBaseUpdate,_!==null){do{var ce={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};z===null?O=z=ce:z=z.next=ce,_=_.next}while(_!==null);z===null?O=z=y:z=z.next=y}else O=z=y;_={baseState:T.baseState,firstBaseUpdate:O,lastBaseUpdate:z,shared:T.shared,callbacks:T.callbacks},m.updateQueue=_;return}m=_.lastBaseUpdate,m===null?_.firstBaseUpdate=y:m.next=y,_.lastBaseUpdate=y}var To=!1;function Ti(){if(To){var m=$;if(m!==null)throw m}}function Ca(m,y,_,T){To=!1;var O=m.updateQueue;$n=!1;var z=O.firstBaseUpdate,ce=O.lastBaseUpdate,ke=O.shared.pending;if(ke!==null){O.shared.pending=null;var Qe=ke,kt=Qe.next;Qe.next=null,ce===null?z=kt:ce.next=kt,ce=Qe;var Kt=m.alternate;Kt!==null&&(Kt=Kt.updateQueue,ke=Kt.lastBaseUpdate,ke!==ce&&(ke===null?Kt.firstBaseUpdate=kt:ke.next=kt,Kt.lastBaseUpdate=Qe))}if(z!==null){var tn=O.baseState;ce=0,Kt=kt=Qe=null,ke=z;do{var Lt=ke.lane&-536870913,Pt=Lt!==ke.lane;if(Pt?(br&Lt)===Lt:(T&Lt)===Lt){Lt!==0&&Lt===N&&(To=!0),Kt!==null&&(Kt=Kt.next={lane:0,tag:ke.tag,payload:ke.payload,callback:null,next:null});e:{var Jn=m,Os=ke;Lt=y;var na=_;switch(Os.tag){case 1:if(Jn=Os.payload,typeof Jn=="function"){tn=Jn.call(na,tn,Lt);break e}tn=Jn;break e;case 3:Jn.flags=Jn.flags&-65537|128;case 0:if(Jn=Os.payload,Lt=typeof Jn=="function"?Jn.call(na,tn,Lt):Jn,Lt==null)break e;tn=d({},tn,Lt);break e;case 2:$n=!0}}Lt=ke.callback,Lt!==null&&(m.flags|=64,Pt&&(m.flags|=8192),Pt=O.callbacks,Pt===null?O.callbacks=[Lt]:Pt.push(Lt))}else Pt={lane:Lt,tag:ke.tag,payload:ke.payload,callback:ke.callback,next:null},Kt===null?(kt=Kt=Pt,Qe=tn):Kt=Kt.next=Pt,ce|=Lt;if(ke=ke.next,ke===null){if(ke=O.shared.pending,ke===null)break;Pt=ke,ke=Pt.next,Pt.next=null,O.lastBaseUpdate=Pt,O.shared.pending=null}}while(!0);Kt===null&&(Qe=tn),O.baseState=Qe,O.firstBaseUpdate=kt,O.lastBaseUpdate=Kt,z===null&&(O.shared.lanes=0),Qf|=ce,m.lanes=ce,m.memoizedState=tn}}function Vo(m,y){if(typeof m!="function")throw Error(s(191,m));m.call(y)}function Oa(m,y){var _=m.callbacks;if(_!==null)for(m.callbacks=null,m=0;m<_.length;m++)Vo(_[m],y)}var Ys=H(null),Or=H(0);function Zi(m,y){m=Xf,B(Or,m),B(Ys,y),Xf=m|y.baseLanes}function Mr(){B(Or,Xf),B(Ys,Ys.current)}function qa(){Xf=Or.current,R(Ys),R(Or)}var ea=H(null),Tr=null;function oa(m){var y=m.alternate;B(or,or.current&1),B(ea,m),Tr===null&&(y===null||Ys.current!==null||y.memoizedState!==null)&&(Tr=m)}function ei(m){B(or,or.current),B(ea,m),Tr===null&&(Tr=m)}function Sa(m){m.tag===22?(B(or,or.current),B(ea,m),Tr===null&&(Tr=m)):Pa()}function Pa(){B(or,or.current),B(ea,ea.current)}function yi(m){R(ea),Tr===m&&(Tr=null),R(or)}var or=H(0);function ko(m){for(var y=m;y!==null;){if(y.tag===13){var _=y.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||Zp(_)||em(_)))return y}else if(y.tag===19&&(y.memoizedProps.revealOrder==="forwards"||y.memoizedProps.revealOrder==="backwards"||y.memoizedProps.revealOrder==="unstable_legacy-backwards"||y.memoizedProps.revealOrder==="together")){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var la=0,ms=null,ys=null,kr=null,Al=!1,Rc=!1,hl=!1,Ma=0,Wf=0,Gf=null,Rp=0;function ki(){throw Error(s(321))}function s0(m,y){if(y===null)return!1;for(var _=0;_<y.length&&_<m.length;_++)if(!La(m[_],y[_]))return!1;return!0}function r0(m,y,_,T,O,z){return la=z,ms=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,q.H=m===null||m.memoizedState===null?Mx:kw,hl=!1,z=_(T,O),hl=!1,Rc&&(z=uf(y,_,T,O)),Fp(m),z}function Fp(m){q.H=tg;var y=ys!==null&&ys.next!==null;if(la=0,kr=ys=ms=null,Al=!1,Wf=0,Gf=null,y)throw Error(s(300));m===null||ao||(m=m.dependencies,m!==null&&Ym(m)&&(ao=!0))}function uf(m,y,_,T){ms=m;var O=0;do{if(Rc&&(Gf=null),Wf=0,Rc=!1,25<=O)throw Error(s(301));if(O+=1,kr=ys=null,m.updateQueue!=null){var z=m.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}q.H=Ew,z=y(_,T)}while(Rc);return z}function ww(){var m=q.H,y=m.useState()[0];return y=typeof y.then=="function"?Au(y):y,m=m.useState()[0],(ys!==null?ys.memoizedState:null)!==m&&(ms.flags|=1024),y}function Km(){var m=Ma!==0;return Ma=0,m}function i0(m,y,_){y.updateQueue=m.updateQueue,y.flags&=-2053,m.lanes&=~_}function Xm(m){if(Al){for(m=m.memoizedState;m!==null;){var y=m.queue;y!==null&&(y.pending=null),m=m.next}Al=!1}la=0,kr=ys=ms=null,Rc=!1,Wf=Ma=0,Gf=null}function Ya(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?ms.memoizedState=kr=m:kr=kr.next=m,kr}function ca(){if(ys===null){var m=ms.alternate;m=m!==null?m.memoizedState:null}else m=ys.next;var y=kr===null?ms.memoizedState:kr.next;if(y!==null)kr=y,ys=m;else{if(m===null)throw ms.alternate===null?Error(s(467)):Error(s(310));ys=m,m={memoizedState:ys.memoizedState,baseState:ys.baseState,baseQueue:ys.baseQueue,queue:ys.queue,next:null},kr===null?ms.memoizedState=kr=m:kr=kr.next=m}return kr}function zp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Au(m){var y=Wf;return Wf+=1,Gf===null&&(Gf=[]),m=Ut(Gf,m,y),y=ms,(kr===null?y.memoizedState:kr.next)===null&&(y=y.alternate,q.H=y===null||y.memoizedState===null?Mx:kw),m}function Lh(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Au(m);if(m.$$typeof===S)return Mo(m)}throw Error(s(438,String(m)))}function Fd(m){var y=null,_=ms.updateQueue;if(_!==null&&(y=_.memoCache),y==null){var T=ms.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(y={data:T.data.map(function(O){return O.slice()}),index:0})))}if(y==null&&(y={data:[],index:0}),_===null&&(_=zp(),ms.updateQueue=_),_.memoCache=y,_=y.data[y.index],_===void 0)for(_=y.data[y.index]=Array(m),T=0;T<m;T++)_[T]=D;return y.index++,_}function Lu(m,y){return typeof y=="function"?y(m):y}function Bp(m){var y=ca();return Nh(y,ys,m)}function Nh(m,y,_){var T=m.queue;if(T===null)throw Error(s(311));T.lastRenderedReducer=_;var O=m.baseQueue,z=T.pending;if(z!==null){if(O!==null){var ce=O.next;O.next=z.next,z.next=ce}y.baseQueue=O=z,T.pending=null}if(z=m.baseState,O===null)m.memoizedState=z;else{y=O.next;var ke=ce=null,Qe=null,kt=y,Kt=!1;do{var tn=kt.lane&-536870913;if(tn!==kt.lane?(br&tn)===tn:(la&tn)===tn){var Lt=kt.revertLane;if(Lt===0)Qe!==null&&(Qe=Qe.next={lane:0,revertLane:0,gesture:null,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null}),tn===N&&(Kt=!0);else if((la&Lt)===Lt){kt=kt.next,Lt===N&&(Kt=!0);continue}else tn={lane:0,revertLane:kt.revertLane,gesture:null,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null},Qe===null?(ke=Qe=tn,ce=z):Qe=Qe.next=tn,ms.lanes|=Lt,Qf|=Lt;tn=kt.action,hl&&_(z,tn),z=kt.hasEagerState?kt.eagerState:_(z,tn)}else Lt={lane:tn,revertLane:kt.revertLane,gesture:kt.gesture,action:kt.action,hasEagerState:kt.hasEagerState,eagerState:kt.eagerState,next:null},Qe===null?(ke=Qe=Lt,ce=z):Qe=Qe.next=Lt,ms.lanes|=tn,Qf|=tn;kt=kt.next}while(kt!==null&&kt!==y);if(Qe===null?ce=z:Qe.next=ke,!La(z,m.memoizedState)&&(ao=!0,Kt&&(_=$,_!==null)))throw _;m.memoizedState=z,m.baseState=ce,m.baseQueue=Qe,T.lastRenderedState=z}return O===null&&(T.lanes=0),[m.memoizedState,T.dispatch]}function Qm(m){var y=ca(),_=y.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=m;var T=_.dispatch,O=_.pending,z=y.memoizedState;if(O!==null){_.pending=null;var ce=O=O.next;do z=m(z,ce.action),ce=ce.next;while(ce!==O);La(z,y.memoizedState)||(ao=!0),y.memoizedState=z,y.baseQueue===null&&(y.baseState=z),_.lastRenderedState=z}return[z,T]}function Up(m,y,_){var T=ms,O=ca(),z=mr;if(z){if(_===void 0)throw Error(s(407));_=_()}else _=y();var ce=!La((ys||O).memoizedState,_);if(ce&&(O.memoizedState=_,ao=!0),O=O.queue,vw(o0.bind(null,T,O,m),[m]),O.getSnapshot!==y||ce||kr!==null&&kr.memoizedState.tag&1){if(T.flags|=2048,Bd(9,{destroy:void 0},a0.bind(null,T,O,_,y),null),$i===null)throw Error(s(349));z||(la&127)!==0||ff(T,y,_)}return _}function ff(m,y,_){m.flags|=16384,m={getSnapshot:y,value:_},y=ms.updateQueue,y===null?(y=zp(),ms.updateQueue=y,y.stores=[m]):(_=y.stores,_===null?y.stores=[m]:_.push(m))}function a0(m,y,_,T){y.value=_,y.getSnapshot=T,z1(y)&&Vp(m)}function o0(m,y,_){return _(function(){z1(y)&&Vp(m)})}function z1(m){var y=m.getSnapshot;m=m.value;try{var _=y();return!La(m,_)}catch{return!0}}function Vp(m){var y=rf(m,2);y!==null&&zc(y,m,2)}function Hf(m){var y=Ya();if(typeof m=="function"){var _=m;if(m=_(),hl){Vn(!0);try{_()}finally{Vn(!1)}}}return y.memoizedState=y.baseState=m,y.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lu,lastRenderedState:m},y}function B1(m,y,_,T){return m.baseState=_,Nh(m,ys,typeof T=="function"?T:Lu)}function U1(m,y,_,T,O){if(eg(m))throw Error(s(485));if(m=y.action,m!==null){var z={payload:O,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ce){z.listeners.push(ce)}};q.T!==null?_(!0):z.isTransition=!1,T(z),_=y.pending,_===null?(z.next=y.pending=z,V1(y,z)):(z.next=_.next,y.pending=_.next=z)}}function V1(m,y){var _=y.action,T=y.payload,O=m.state;if(y.isTransition){var z=q.T,ce={};q.T=ce;try{var ke=_(O,T),Qe=q.S;Qe!==null&&Qe(ce,ke),l0(m,y,ke)}catch(kt){zd(m,y,kt)}finally{z!==null&&ce.types!==null&&(z.types=ce.types),q.T=z}}else try{z=_(O,T),l0(m,y,z)}catch(kt){zd(m,y,kt)}}function l0(m,y,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(T){W1(m,y,T)},function(T){return zd(m,y,T)}):W1(m,y,_)}function W1(m,y,_){y.status="fulfilled",y.value=_,Jm(y),m.state=_,y=m.pending,y!==null&&(_=y.next,_===y?m.pending=null:(_=_.next,y.next=_,V1(m,_)))}function zd(m,y,_){var T=m.pending;if(m.pending=null,T!==null){T=T.next;do y.status="rejected",y.reason=_,Jm(y),y=y.next;while(y!==T)}m.action=null}function Jm(m){m=m.listeners;for(var y=0;y<m.length;y++)(0,m[y])()}function Wp(m,y){return y}function eu(m,y){if(mr){var _=$i.formState;if(_!==null){e:{var T=ms;if(mr){if(Mi){t:{for(var O=Mi,z=Qi;O.nodeType!==8;){if(!z){O=null;break t}if(O=nc(O.nextSibling),O===null){O=null;break t}}z=O.data,O=z==="F!"||z==="F"?O:null}if(O){Mi=nc(O.nextSibling),T=O.data==="F!";break e}}Rf(T)}T=!1}T&&(y=_[0])}}return _=Ya(),_.memoizedState=_.baseState=y,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wp,lastRenderedState:y},_.queue=T,_=xx.bind(null,ms,T),T.dispatch=_,T=Hf(!1),z=Tw.bind(null,ms,!1,T.queue),T=Ya(),O={state:y,dispatch:null,action:m,pending:null},T.queue=O,_=U1.bind(null,ms,O,z,_),O.dispatch=_,T.memoizedState=m,[y,_,!1]}function df(m){var y=ca();return hf(y,ys,m)}function hf(m,y,_){if(y=Nh(m,y,Wp)[0],m=Bp(Lu)[0],typeof y=="object"&&y!==null&&typeof y.then=="function")try{var T=Au(y)}catch(ce){throw ce===tt?je:ce}else T=y;y=ca();var O=y.queue,z=O.dispatch;return _!==y.memoizedState&&(ms.flags|=2048,Bd(9,{destroy:void 0},Gp.bind(null,O,_),null)),[T,z,m]}function Gp(m,y){m.action=y}function Zm(m){var y=ca(),_=ys;if(_!==null)return hf(y,_,m);ca(),y=y.memoizedState,_=ca();var T=_.queue.dispatch;return _.memoizedState=m,[y,T,!1]}function Bd(m,y,_,T){return m={tag:m,create:_,deps:T,inst:y,next:null},y=ms.updateQueue,y===null&&(y=zp(),ms.updateQueue=y),_=y.lastEffect,_===null?y.lastEffect=m.next=m:(T=_.next,_.next=m,m.next=T,y.lastEffect=m),m}function G1(){return ca().memoizedState}function Dh(m,y,_,T){var O=Ya();ms.flags|=m,O.memoizedState=Bd(1|y,{destroy:void 0},_,T===void 0?null:T)}function Ud(m,y,_,T){var O=ca();T=T===void 0?null:T;var z=O.memoizedState.inst;ys!==null&&T!==null&&s0(T,ys.memoizedState.deps)?O.memoizedState=Bd(y,z,_,T):(ms.flags|=m,O.memoizedState=Bd(1|y,z,_,T))}function cx(m,y){Dh(8390656,8,m,y)}function vw(m,y){Ud(2048,8,m,y)}function ux(m){ms.flags|=4;var y=ms.updateQueue;if(y===null)y=zp(),ms.updateQueue=y,y.events=[m];else{var _=y.events;_===null?y.events=[m]:_.push(m)}}function fx(m){var y=ca().memoizedState;return ux({ref:y,nextImpl:m}),function(){if((ti&2)!==0)throw Error(s(440));return y.impl.apply(void 0,arguments)}}function dx(m,y){return Ud(4,2,m,y)}function _w(m,y){return Ud(4,4,m,y)}function hx(m,y){if(typeof y=="function"){m=m();var _=y(m);return function(){typeof _=="function"?_():y(null)}}if(y!=null)return m=m(),y.current=m,function(){y.current=null}}function px(m,y,_){_=_!=null?_.concat([m]):null,Ud(4,4,hx.bind(null,y,m),_)}function H1(){}function mx(m,y){var _=ca();y=y===void 0?null:y;var T=_.memoizedState;return y!==null&&s0(y,T[1])?T[0]:(_.memoizedState=[m,y],m)}function gx(m,y){var _=ca();y=y===void 0?null:y;var T=_.memoizedState;if(y!==null&&s0(y,T[1]))return T[0];if(T=m(),hl){Vn(!0);try{m()}finally{Vn(!1)}}return _.memoizedState=[T,y],T}function xw(m,y,_){return _===void 0||(la&1073741824)!==0&&(br&261930)===0?m.memoizedState=y:(m.memoizedState=_,m=oC(),ms.lanes|=m,Qf|=m,_)}function yx(m,y,_,T){return La(_,y)?_:Ys.current!==null?(m=xw(m,_,T),La(m,y)||(ao=!0),m):(la&42)===0||(la&1073741824)!==0&&(br&261930)===0?(ao=!0,m.memoizedState=_):(m=oC(),ms.lanes|=m,Qf|=m,y)}function bx(m,y,_,T,O){var z=te.p;te.p=z!==0&&8>z?z:8;var ce=q.T,ke={};q.T=ke,Tw(m,!1,y,_);try{var Qe=O(),kt=q.S;if(kt!==null&&kt(ke,Qe),Qe!==null&&typeof Qe=="object"&&typeof Qe.then=="function"){var Kt=ye(Qe,T);c0(m,y,Kt,su(m))}else c0(m,y,T,su(m))}catch(tn){c0(m,y,{then:function(){},status:"rejected",reason:tn},su())}finally{te.p=z,ce!==null&&ke.types!==null&&(ce.types=ke.types),q.T=ce}}function CE(){}function Cw(m,y,_,T){if(m.tag!==5)throw Error(s(476));var O=wx(m).queue;bx(m,O,y,Z,_===null?CE:function(){return Sw(m),_(T)})}function wx(m){var y=m.memoizedState;if(y!==null)return y;y={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lu,lastRenderedState:Z},next:null};var _={};return y.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lu,lastRenderedState:_},next:null},m.memoizedState=y,m=m.alternate,m!==null&&(m.memoizedState=y),y}function Sw(m){var y=wx(m);y.next===null&&(y=m.alternate.memoizedState),c0(m,y.next.queue,{},su())}function Mw(){return Mo(PC)}function vx(){return ca().memoizedState}function _x(){return ca().memoizedState}function SE(m){for(var y=m.return;y!==null;){switch(y.tag){case 24:case 3:var _=su();m=Cs(_);var T=Vs(y,m,_);T!==null&&(zc(T,y,_),Zr(T,y,_)),y={cache:Rd()},m.payload=y;return}y=y.return}}function ME(m,y,_){var T=su();_={lane:T,revertLane:0,gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},eg(m)?Cx(y,_):(_=Um(m,y,_,T),_!==null&&(zc(_,m,T),Sx(_,y,T)))}function xx(m,y,_){var T=su();c0(m,y,_,T)}function c0(m,y,_,T){var O={lane:T,revertLane:0,gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null};if(eg(m))Cx(y,O);else{var z=m.alternate;if(m.lanes===0&&(z===null||z.lanes===0)&&(z=y.lastRenderedReducer,z!==null))try{var ce=y.lastRenderedState,ke=z(ce,_);if(O.hasEagerState=!0,O.eagerState=ke,La(ke,ce))return Mh(m,y,O,0),$i===null&&Ep(),!1}catch{}if(_=Um(m,y,O,T),_!==null)return zc(_,m,T),Sx(_,y,T),!0}return!1}function Tw(m,y,_,T){if(T={lane:2,revertLane:SC(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},eg(m)){if(y)throw Error(s(479))}else y=Um(m,_,T,2),y!==null&&zc(y,m,2)}function eg(m){var y=m.alternate;return m===ms||y!==null&&y===ms}function Cx(m,y){Rc=Al=!0;var _=m.pending;_===null?y.next=y:(y.next=_.next,_.next=y),m.pending=y}function Sx(m,y,_){if((_&4194048)!==0){var T=y.lanes;T&=m.pendingLanes,_|=T,y.lanes=_,re(m,_)}}var tg={readContext:Mo,use:Lh,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useLayoutEffect:ki,useInsertionEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useSyncExternalStore:ki,useId:ki,useHostTransitionStatus:ki,useFormState:ki,useActionState:ki,useOptimistic:ki,useMemoCache:ki,useCacheRefresh:ki};tg.useEffectEvent=ki;var Mx={readContext:Mo,use:Lh,useCallback:function(m,y){return Ya().memoizedState=[m,y===void 0?null:y],m},useContext:Mo,useEffect:cx,useImperativeHandle:function(m,y,_){_=_!=null?_.concat([m]):null,Dh(4194308,4,hx.bind(null,y,m),_)},useLayoutEffect:function(m,y){return Dh(4194308,4,m,y)},useInsertionEffect:function(m,y){Dh(4,2,m,y)},useMemo:function(m,y){var _=Ya();y=y===void 0?null:y;var T=m();if(hl){Vn(!0);try{m()}finally{Vn(!1)}}return _.memoizedState=[T,y],T},useReducer:function(m,y,_){var T=Ya();if(_!==void 0){var O=_(y);if(hl){Vn(!0);try{_(y)}finally{Vn(!1)}}}else O=y;return T.memoizedState=T.baseState=O,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:O},T.queue=m,m=m.dispatch=ME.bind(null,ms,m),[T.memoizedState,m]},useRef:function(m){var y=Ya();return m={current:m},y.memoizedState=m},useState:function(m){m=Hf(m);var y=m.queue,_=xx.bind(null,ms,y);return y.dispatch=_,[m.memoizedState,_]},useDebugValue:H1,useDeferredValue:function(m,y){var _=Ya();return xw(_,m,y)},useTransition:function(){var m=Hf(!1);return m=bx.bind(null,ms,m.queue,!0,!1),Ya().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,y,_){var T=ms,O=Ya();if(mr){if(_===void 0)throw Error(s(407));_=_()}else{if(_=y(),$i===null)throw Error(s(349));(br&127)!==0||ff(T,y,_)}O.memoizedState=_;var z={value:_,getSnapshot:y};return O.queue=z,cx(o0.bind(null,T,z,m),[m]),T.flags|=2048,Bd(9,{destroy:void 0},a0.bind(null,T,z,_,y),null),_},useId:function(){var m=Ya(),y=$i.identifierPrefix;if(mr){var _=$c,T=Pc;_=(T&~(1<<32-Nn(T)-1)).toString(32)+_,y="_"+y+"R_"+_,_=Ma++,0<_&&(y+="H"+_.toString(32)),y+="_"}else _=Rp++,y="_"+y+"r_"+_.toString(32)+"_";return m.memoizedState=y},useHostTransitionStatus:Mw,useFormState:eu,useActionState:eu,useOptimistic:function(m){var y=Ya();y.memoizedState=y.baseState=m;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return y.queue=_,y=Tw.bind(null,ms,!0,_),_.dispatch=y,[m,y]},useMemoCache:Fd,useCacheRefresh:function(){return Ya().memoizedState=SE.bind(null,ms)},useEffectEvent:function(m){var y=Ya(),_={impl:m};return y.memoizedState=_,function(){if((ti&2)!==0)throw Error(s(440));return _.impl.apply(void 0,arguments)}}},kw={readContext:Mo,use:Lh,useCallback:mx,useContext:Mo,useEffect:vw,useImperativeHandle:px,useInsertionEffect:dx,useLayoutEffect:_w,useMemo:gx,useReducer:Bp,useRef:G1,useState:function(){return Bp(Lu)},useDebugValue:H1,useDeferredValue:function(m,y){var _=ca();return yx(_,ys.memoizedState,m,y)},useTransition:function(){var m=Bp(Lu)[0],y=ca().memoizedState;return[typeof m=="boolean"?m:Au(m),y]},useSyncExternalStore:Up,useId:vx,useHostTransitionStatus:Mw,useFormState:df,useActionState:df,useOptimistic:function(m,y){var _=ca();return B1(_,ys,m,y)},useMemoCache:Fd,useCacheRefresh:_x};kw.useEffectEvent=fx;var Ew={readContext:Mo,use:Lh,useCallback:mx,useContext:Mo,useEffect:vw,useImperativeHandle:px,useInsertionEffect:dx,useLayoutEffect:_w,useMemo:gx,useReducer:Qm,useRef:G1,useState:function(){return Qm(Lu)},useDebugValue:H1,useDeferredValue:function(m,y){var _=ca();return ys===null?xw(_,m,y):yx(_,ys.memoizedState,m,y)},useTransition:function(){var m=Qm(Lu)[0],y=ca().memoizedState;return[typeof m=="boolean"?m:Au(m),y]},useSyncExternalStore:Up,useId:vx,useHostTransitionStatus:Mw,useFormState:Zm,useActionState:Zm,useOptimistic:function(m,y){var _=ca();return ys!==null?B1(_,ys,m,y):(_.baseState=m,[m,_.queue.dispatch])},useMemoCache:Fd,useCacheRefresh:_x};Ew.useEffectEvent=fx;function Iw(m,y,_,T){y=m.memoizedState,_=_(T,y),_=_==null?y:d({},y,_),m.memoizedState=_,m.lanes===0&&(m.updateQueue.baseState=_)}var Aw={enqueueSetState:function(m,y,_){m=m._reactInternals;var T=su(),O=Cs(T);O.payload=y,_!=null&&(O.callback=_),y=Vs(m,O,T),y!==null&&(zc(y,m,T),Zr(y,m,T))},enqueueReplaceState:function(m,y,_){m=m._reactInternals;var T=su(),O=Cs(T);O.tag=1,O.payload=y,_!=null&&(O.callback=_),y=Vs(m,O,T),y!==null&&(zc(y,m,T),Zr(y,m,T))},enqueueForceUpdate:function(m,y){m=m._reactInternals;var _=su(),T=Cs(_);T.tag=2,y!=null&&(T.callback=y),y=Vs(m,T,_),y!==null&&(zc(y,m,_),Zr(y,m,_))}};function Oh(m,y,_,T,O,z,ce){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(T,z,ce):y.prototype&&y.prototype.isPureReactComponent?!Jl(_,T)||!Jl(O,z):!0}function Tx(m,y,_,T){m=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(_,T),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(_,T),y.state!==m&&Aw.enqueueReplaceState(y,y.state,null)}function Hp(m,y){var _=y;if("ref"in y){_={};for(var T in y)T!=="ref"&&(_[T]=y[T])}if(m=m.defaultProps){_===y&&(_=d({},_));for(var O in m)_[O]===void 0&&(_[O]=m[O])}return _}function kx(m){Lc(m)}function Ex(m){console.error(m)}function Ix(m){Lc(m)}function q1(m,y){try{var _=m.onUncaughtError;_(y.value,{componentStack:y.stack})}catch(T){setTimeout(function(){throw T})}}function Lw(m,y,_){try{var T=m.onCaughtError;T(_.value,{componentStack:_.stack,errorBoundary:y.tag===1?y.stateNode:null})}catch(O){setTimeout(function(){throw O})}}function Nw(m,y,_){return _=Cs(_),_.tag=3,_.payload={element:null},_.callback=function(){q1(m,y)},_}function Ax(m){return m=Cs(m),m.tag=3,m}function Lx(m,y,_,T){var O=_.type.getDerivedStateFromError;if(typeof O=="function"){var z=T.value;m.payload=function(){return O(z)},m.callback=function(){Lw(y,_,T)}}var ce=_.stateNode;ce!==null&&typeof ce.componentDidCatch=="function"&&(m.callback=function(){Lw(y,_,T),typeof O!="function"&&(Jf===null?Jf=new Set([this]):Jf.add(this));var ke=T.stack;this.componentDidCatch(T.value,{componentStack:ke!==null?ke:""})})}function TE(m,y,_,T,O){if(_.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(y=_.alternate,y!==null&&Uf(y,_,O,!0),_=ea.current,_!==null){switch(_.tag){case 31:case 13:return Tr===null?oy():_.alternate===null&&$a===0&&($a=3),_.flags&=-257,_.flags|=65536,_.lanes=O,T===ct?_.flags|=16384:(y=_.updateQueue,y===null?_.updateQueue=new Set([T]):y.add(T),tv(m,T,O)),!1;case 22:return _.flags|=65536,T===ct?_.flags|=16384:(y=_.updateQueue,y===null?(y={transitions:null,markerInstances:null,retryQueue:new Set([T])},_.updateQueue=y):(_=y.retryQueue,_===null?y.retryQueue=new Set([T]):_.add(T)),tv(m,T,O)),!1}throw Error(s(435,_.tag))}return tv(m,T,O),oy(),!1}if(mr)return y=ea.current,y!==null?((y.flags&65536)===0&&(y.flags|=256),y.flags|=65536,y.lanes=O,T!==Zc&&(m=Error(s(422),{cause:T}),Ih(Nc(m,_)))):(T!==Zc&&(y=Error(s(423),{cause:T}),Ih(Nc(y,_))),m=m.current.alternate,m.flags|=65536,O&=-O,m.lanes|=O,T=Nc(T,_),O=Nw(m.stateNode,T,O),Da(m,O),$a!==4&&($a=2)),!1;var z=Error(s(520),{cause:T});if(z=Nc(z,_),_0===null?_0=[z]:_0.push(z),$a!==4&&($a=2),y===null)return!0;T=Nc(T,_),_=y;do{switch(_.tag){case 3:return _.flags|=65536,m=O&-O,_.lanes|=m,m=Nw(_.stateNode,T,m),Da(_,m),!1;case 1:if(y=_.type,z=_.stateNode,(_.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Jf===null||!Jf.has(z))))return _.flags|=65536,O&=-O,_.lanes|=O,O=Ax(O),Lx(O,m,_,T),Da(_,O),!1}_=_.return}while(_!==null);return!1}var u0=Error(s(461)),ao=!1;function pl(m,y,_,T){y.child=m===null?Fs(y,null,_,T):Pi(y,m.child,_,T)}function Nx(m,y,_,T,O){_=_.render;var z=y.ref;if("ref"in T){var ce={};for(var ke in T)ke!=="ref"&&(ce[ke]=T[ke])}else ce=T;return Vf(y),T=r0(m,y,_,ce,z,O),ke=Km(),m!==null&&!ao?(i0(m,y,O),Vd(m,y,O)):(mr&&ke&&t0(y),y.flags|=1,pl(m,y,T,O),y.child)}function f0(m,y,_,T,O){if(m===null){var z=_.type;return typeof z=="function"&&!Vm(z)&&z.defaultProps===void 0&&_.compare===null?(y.tag=15,y.type=z,Dx(m,y,z,T,O)):(m=kh(_.type,null,T,y,y.mode,O),m.ref=y.ref,m.return=y,y.child=m)}if(z=m.child,!jw(m,O)){var ce=z.memoizedProps;if(_=_.compare,_=_!==null?_:Jl,_(ce,T)&&m.ref===y.ref)return Vd(m,y,O)}return y.flags|=1,m=ec(z,T),m.ref=y.ref,m.return=y,y.child=m}function Dx(m,y,_,T,O){if(m!==null){var z=m.memoizedProps;if(Jl(z,T)&&m.ref===y.ref)if(ao=!1,y.pendingProps=T=z,jw(m,O))(m.flags&131072)!==0&&(ao=!0);else return y.lanes=m.lanes,Vd(m,y,O)}return jx(m,y,_,T,O)}function Ox(m,y,_,T){var O=T.children,z=m!==null?m.memoizedState:null;if(m===null&&y.stateNode===null&&(y.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((y.flags&128)!==0){if(z=z!==null?z.baseLanes|_:_,m!==null){for(T=y.child=m.child,O=0;T!==null;)O=O|T.lanes|T.childLanes,T=T.sibling;T=O&~z}else T=0,y.child=null;return Px(m,y,z,_,T)}if((_&536870912)!==0)y.memoizedState={baseLanes:0,cachePool:null},m!==null&&De(y,z!==null?z.cachePool:null),z!==null?Zi(y,z):Mr(),Sa(y);else return T=y.lanes=536870912,Px(m,y,z!==null?z.baseLanes|_:_,_,T)}else z!==null?(De(y,z.cachePool),Zi(y,z),Pa(),y.memoizedState=null):(m!==null&&De(y,null),Mr(),Pa());return pl(m,y,O,_),y.child}function d0(m,y){return m!==null&&m.tag===22||y.stateNode!==null||(y.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.sibling}function Px(m,y,_,T,O){var z=Ae();return z=z===null?null:{parent:xa._currentValue,pool:z},y.memoizedState={baseLanes:_,cachePool:z},m!==null&&De(y,null),Mr(),Sa(y),m!==null&&Uf(m,y,T,!0),y.childLanes=O,null}function ng(m,y){return y=K1({mode:y.mode,children:y.children},m.mode),y.ref=m.ref,m.child=y,y.return=m,y}function $x(m,y,_){return Pi(y,m.child,null,_),m=ng(y,y.pendingProps),m.flags|=2,yi(y),y.memoizedState=null,m}function kE(m,y,_){var T=y.pendingProps,O=(y.flags&128)!==0;if(y.flags&=-129,m===null){if(mr){if(T.mode==="hidden")return m=ng(y,T),y.lanes=536870912,d0(null,m);if(ei(y),(m=Mi)?(m=gf(m,Qi),m=m!==null&&m.data==="&"?m:null,m!==null&&(y.memoizedState={dehydrated:m,treeContext:of!==null?{id:Pc,overflow:$c}:null,retryLane:536870912,hydrationErrors:null},_=Wm(m),_.return=y,y.child=_,Co=y,Mi=null)):m=null,m===null)throw Rf(y);return y.lanes=536870912,null}return ng(y,T)}var z=m.memoizedState;if(z!==null){var ce=z.dehydrated;if(ei(y),O)if(y.flags&256)y.flags&=-257,y=$x(m,y,_);else if(y.memoizedState!==null)y.child=m.child,y.flags|=128,y=null;else throw Error(s(558));else if(ao||Uf(m,y,_,!1),O=(_&m.childLanes)!==0,ao||O){if(T=$i,T!==null&&(ce=Pe(T,_),ce!==0&&ce!==z.retryLane))throw z.retryLane=ce,rf(m,ce),zc(T,m,ce),u0;oy(),y=$x(m,y,_)}else m=z.treeContext,Mi=nc(ce.nextSibling),Co=y,mr=!0,dl=null,Qi=!1,m!==null&&j1(y,m),y=ng(y,T),y.flags|=4096;return y}return m=ec(m.child,{mode:T.mode,children:T.children}),m.ref=y.ref,y.child=m,m.return=y,m}function Y1(m,y){var _=y.ref;if(_===null)m!==null&&m.ref!==null&&(y.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(s(284));(m===null||m.ref!==_)&&(y.flags|=4194816)}}function jx(m,y,_,T,O){return Vf(y),_=r0(m,y,_,T,void 0,O),T=Km(),m!==null&&!ao?(i0(m,y,O),Vd(m,y,O)):(mr&&T&&t0(y),y.flags|=1,pl(m,y,_,O),y.child)}function Rx(m,y,_,T,O,z){return Vf(y),y.updateQueue=null,_=uf(y,T,_,O),Fp(m),T=Km(),m!==null&&!ao?(i0(m,y,z),Vd(m,y,z)):(mr&&T&&t0(y),y.flags|=1,pl(m,y,_,z),y.child)}function Fx(m,y,_,T,O){if(Vf(y),y.stateNode===null){var z=xo,ce=_.contextType;typeof ce=="object"&&ce!==null&&(z=Mo(ce)),z=new _(T,z),y.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=Aw,y.stateNode=z,z._reactInternals=y,z=y.stateNode,z.props=T,z.state=y.memoizedState,z.refs={},Sn(y),ce=_.contextType,z.context=typeof ce=="object"&&ce!==null?Mo(ce):xo,z.state=y.memoizedState,ce=_.getDerivedStateFromProps,typeof ce=="function"&&(Iw(y,_,ce,T),z.state=y.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(ce=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),ce!==z.state&&Aw.enqueueReplaceState(z,z.state,null),Ca(y,T,z,O),Ti(),z.state=y.memoizedState),typeof z.componentDidMount=="function"&&(y.flags|=4194308),T=!0}else if(m===null){z=y.stateNode;var ke=y.memoizedProps,Qe=Hp(_,ke);z.props=Qe;var kt=z.context,Kt=_.contextType;ce=xo,typeof Kt=="object"&&Kt!==null&&(ce=Mo(Kt));var tn=_.getDerivedStateFromProps;Kt=typeof tn=="function"||typeof z.getSnapshotBeforeUpdate=="function",ke=y.pendingProps!==ke,Kt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ke||kt!==ce)&&Tx(y,z,T,ce),$n=!1;var Lt=y.memoizedState;z.state=Lt,Ca(y,T,z,O),Ti(),kt=y.memoizedState,ke||Lt!==kt||$n?(typeof tn=="function"&&(Iw(y,_,tn,T),kt=y.memoizedState),(Qe=$n||Oh(y,_,Qe,T,Lt,kt,ce))?(Kt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(y.flags|=4194308)):(typeof z.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=T,y.memoizedState=kt),z.props=T,z.state=kt,z.context=ce,T=Qe):(typeof z.componentDidMount=="function"&&(y.flags|=4194308),T=!1)}else{z=y.stateNode,Ji(m,y),ce=y.memoizedProps,Kt=Hp(_,ce),z.props=Kt,tn=y.pendingProps,Lt=z.context,kt=_.contextType,Qe=xo,typeof kt=="object"&&kt!==null&&(Qe=Mo(kt)),ke=_.getDerivedStateFromProps,(kt=typeof ke=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ce!==tn||Lt!==Qe)&&Tx(y,z,T,Qe),$n=!1,Lt=y.memoizedState,z.state=Lt,Ca(y,T,z,O),Ti();var Pt=y.memoizedState;ce!==tn||Lt!==Pt||$n||m!==null&&m.dependencies!==null&&Ym(m.dependencies)?(typeof ke=="function"&&(Iw(y,_,ke,T),Pt=y.memoizedState),(Kt=$n||Oh(y,_,Kt,T,Lt,Pt,Qe)||m!==null&&m.dependencies!==null&&Ym(m.dependencies))?(kt||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(T,Pt,Qe),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(T,Pt,Qe)),typeof z.componentDidUpdate=="function"&&(y.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof z.componentDidUpdate!="function"||ce===m.memoizedProps&&Lt===m.memoizedState||(y.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ce===m.memoizedProps&&Lt===m.memoizedState||(y.flags|=1024),y.memoizedProps=T,y.memoizedState=Pt),z.props=T,z.state=Pt,z.context=Qe,T=Kt):(typeof z.componentDidUpdate!="function"||ce===m.memoizedProps&&Lt===m.memoizedState||(y.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ce===m.memoizedProps&&Lt===m.memoizedState||(y.flags|=1024),T=!1)}return z=T,Y1(m,y),T=(y.flags&128)!==0,z||T?(z=y.stateNode,_=T&&typeof _.getDerivedStateFromError!="function"?null:z.render(),y.flags|=1,m!==null&&T?(y.child=Pi(y,m.child,null,O),y.child=Pi(y,null,_,O)):pl(m,y,_,O),y.memoizedState=z.state,m=y.child):m=Vd(m,y,O),m}function zx(m,y,_,T){return Ff(),y.flags|=256,pl(m,y,_,T),y.child}var qp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dw(m){return{baseLanes:m,cachePool:Re()}}function Ow(m,y,_){return m=m!==null?m.childLanes&~_:0,y&&(m|=nu),m}function Bx(m,y,_){var T=y.pendingProps,O=!1,z=(y.flags&128)!==0,ce;if((ce=z)||(ce=m!==null&&m.memoizedState===null?!1:(or.current&2)!==0),ce&&(O=!0,y.flags&=-129),ce=(y.flags&32)!==0,y.flags&=-33,m===null){if(mr){if(O?oa(y):Pa(),(m=Mi)?(m=gf(m,Qi),m=m!==null&&m.data!=="&"?m:null,m!==null&&(y.memoizedState={dehydrated:m,treeContext:of!==null?{id:Pc,overflow:$c}:null,retryLane:536870912,hydrationErrors:null},_=Wm(m),_.return=y,y.child=_,Co=y,Mi=null)):m=null,m===null)throw Rf(y);return em(m)?y.lanes=32:y.lanes=536870912,null}var ke=T.children;return T=T.fallback,O?(Pa(),O=y.mode,ke=K1({mode:"hidden",children:ke},O),T=af(T,O,_,null),ke.return=y,T.return=y,ke.sibling=T,y.child=ke,T=y.child,T.memoizedState=Dw(_),T.childLanes=Ow(m,ce,_),y.memoizedState=qp,d0(null,T)):(oa(y),Pw(y,ke))}var Qe=m.memoizedState;if(Qe!==null&&(ke=Qe.dehydrated,ke!==null)){if(z)y.flags&256?(oa(y),y.flags&=-257,y=$w(m,y,_)):y.memoizedState!==null?(Pa(),y.child=m.child,y.flags|=128,y=null):(Pa(),ke=T.fallback,O=y.mode,T=K1({mode:"visible",children:T.children},O),ke=af(ke,O,_,null),ke.flags|=2,T.return=y,ke.return=y,T.sibling=ke,y.child=T,Pi(y,m.child,null,_),T=y.child,T.memoizedState=Dw(_),T.childLanes=Ow(m,ce,_),y.memoizedState=qp,y=d0(null,T));else if(oa(y),em(ke)){if(ce=ke.nextSibling&&ke.nextSibling.dataset,ce)var kt=ce.dgst;ce=kt,T=Error(s(419)),T.stack="",T.digest=ce,Ih({value:T,source:null,stack:null}),y=$w(m,y,_)}else if(ao||Uf(m,y,_,!1),ce=(_&m.childLanes)!==0,ao||ce){if(ce=$i,ce!==null&&(T=Pe(ce,_),T!==0&&T!==Qe.retryLane))throw Qe.retryLane=T,rf(m,T),zc(ce,m,T),u0;Zp(ke)||oy(),y=$w(m,y,_)}else Zp(ke)?(y.flags|=192,y.child=m.child,y=null):(m=Qe.treeContext,Mi=nc(ke.nextSibling),Co=y,mr=!0,dl=null,Qi=!1,m!==null&&j1(y,m),y=Pw(y,T.children),y.flags|=4096);return y}return O?(Pa(),ke=T.fallback,O=y.mode,Qe=m.child,kt=Qe.sibling,T=ec(Qe,{mode:"hidden",children:T.children}),T.subtreeFlags=Qe.subtreeFlags&65011712,kt!==null?ke=ec(kt,ke):(ke=af(ke,O,_,null),ke.flags|=2),ke.return=y,T.return=y,T.sibling=ke,y.child=T,d0(null,T),T=y.child,ke=m.child.memoizedState,ke===null?ke=Dw(_):(O=ke.cachePool,O!==null?(Qe=xa._currentValue,O=O.parent!==Qe?{parent:Qe,pool:Qe}:O):O=Re(),ke={baseLanes:ke.baseLanes|_,cachePool:O}),T.memoizedState=ke,T.childLanes=Ow(m,ce,_),y.memoizedState=qp,d0(m.child,T)):(oa(y),_=m.child,m=_.sibling,_=ec(_,{mode:"visible",children:T.children}),_.return=y,_.sibling=null,m!==null&&(ce=y.deletions,ce===null?(y.deletions=[m],y.flags|=16):ce.push(m)),y.child=_,y.memoizedState=null,_)}function Pw(m,y){return y=K1({mode:"visible",children:y},m.mode),y.return=m,m.child=y}function K1(m,y){return m=Uo(22,m,null,y),m.lanes=0,m}function $w(m,y,_){return Pi(y,m.child,null,_),m=Pw(y,y.pendingProps.children),m.flags|=2,y.memoizedState=null,m}function Ux(m,y,_){m.lanes|=y;var T=m.alternate;T!==null&&(T.lanes|=y),Ah(m.return,y,_)}function h0(m,y,_,T,O,z){var ce=m.memoizedState;ce===null?m.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:T,tail:_,tailMode:O,treeForkCount:z}:(ce.isBackwards=y,ce.rendering=null,ce.renderingStartTime=0,ce.last=T,ce.tail=_,ce.tailMode=O,ce.treeForkCount=z)}function EE(m,y,_){var T=y.pendingProps,O=T.revealOrder,z=T.tail;T=T.children;var ce=or.current,ke=(ce&2)!==0;if(ke?(ce=ce&1|2,y.flags|=128):ce&=1,B(or,ce),pl(m,y,T,_),T=mr?Eh:0,!ke&&m!==null&&(m.flags&128)!==0)e:for(m=y.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&Ux(m,_,y);else if(m.tag===19)Ux(m,_,y);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===y)break e;for(;m.sibling===null;){if(m.return===null||m.return===y)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}switch(O){case"forwards":for(_=y.child,O=null;_!==null;)m=_.alternate,m!==null&&ko(m)===null&&(O=_),_=_.sibling;_=O,_===null?(O=y.child,y.child=null):(O=_.sibling,_.sibling=null),h0(y,!1,O,_,z,T);break;case"backwards":case"unstable_legacy-backwards":for(_=null,O=y.child,y.child=null;O!==null;){if(m=O.alternate,m!==null&&ko(m)===null){y.child=O;break}m=O.sibling,O.sibling=_,_=O,O=m}h0(y,!0,_,null,z,T);break;case"together":h0(y,!1,null,null,void 0,T);break;default:y.memoizedState=null}return y.child}function Vd(m,y,_){if(m!==null&&(y.dependencies=m.dependencies),Qf|=y.lanes,(_&y.childLanes)===0)if(m!==null){if(Uf(m,y,_,!1),(_&y.childLanes)===0)return null}else return null;if(m!==null&&y.child!==m.child)throw Error(s(153));if(y.child!==null){for(m=y.child,_=ec(m,m.pendingProps),y.child=_,_.return=y;m.sibling!==null;)m=m.sibling,_=_.sibling=ec(m,m.pendingProps),_.return=y;_.sibling=null}return y.child}function jw(m,y){return(m.lanes&y)!==0?!0:(m=m.dependencies,!!(m!==null&&Ym(m)))}function IE(m,y,_){switch(y.tag){case 3:Ce(y,y.stateNode.containerInfo),cf(y,xa,m.memoizedState.cache),Ff();break;case 27:case 5:Me(y);break;case 4:Ce(y,y.stateNode.containerInfo);break;case 10:cf(y,y.type,y.memoizedProps.value);break;case 31:if(y.memoizedState!==null)return y.flags|=128,ei(y),null;break;case 13:var T=y.memoizedState;if(T!==null)return T.dehydrated!==null?(oa(y),y.flags|=128,null):(_&y.child.childLanes)!==0?Bx(m,y,_):(oa(y),m=Vd(m,y,_),m!==null?m.sibling:null);oa(y);break;case 19:var O=(m.flags&128)!==0;if(T=(_&y.childLanes)!==0,T||(Uf(m,y,_,!1),T=(_&y.childLanes)!==0),O){if(T)return EE(m,y,_);y.flags|=128}if(O=y.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),B(or,or.current),T)break;return null;case 22:return y.lanes=0,Ox(m,y,_,y.pendingProps);case 24:cf(y,xa,m.memoizedState.cache)}return Vd(m,y,_)}function Vx(m,y,_){if(m!==null)if(m.memoizedProps!==y.pendingProps)ao=!0;else{if(!jw(m,_)&&(y.flags&128)===0)return ao=!1,IE(m,y,_);ao=(m.flags&131072)!==0}else ao=!1,mr&&(y.flags&1048576)!==0&&$1(y,Eh,y.index);switch(y.lanes=0,y.tag){case 16:e:{var T=y.pendingProps;if(m=_t(y.elementType),y.type=m,typeof m=="function")Vm(m)?(T=Hp(m,T),y.tag=1,y=Fx(null,y,m,T,_)):(y.tag=0,y=jx(null,y,m,T,_));else{if(m!=null){var O=m.$$typeof;if(O===C){y.tag=11,y=Nx(null,y,m,T,_);break e}else if(O===E){y.tag=14,y=f0(null,y,m,T,_);break e}}throw y=G(m)||m,Error(s(306,y,""))}}return y;case 0:return jx(m,y,y.type,y.pendingProps,_);case 1:return T=y.type,O=Hp(T,y.pendingProps),Fx(m,y,T,O,_);case 3:e:{if(Ce(y,y.stateNode.containerInfo),m===null)throw Error(s(387));T=y.pendingProps;var z=y.memoizedState;O=z.element,Ji(m,y),Ca(y,T,null,_);var ce=y.memoizedState;if(T=ce.cache,cf(y,xa,T),T!==z.cache&&Bf(y,[xa],_,!0),Ti(),T=ce.element,z.isDehydrated)if(z={element:T,isDehydrated:!1,cache:ce.cache},y.updateQueue.baseState=z,y.memoizedState=z,y.flags&256){y=zx(m,y,T,_);break e}else if(T!==O){O=Nc(Error(s(424)),y),Ih(O),y=zx(m,y,T,_);break e}else for(m=y.stateNode.containerInfo,m.nodeType===9?m=m.body:m=m.nodeName==="HTML"?m.ownerDocument.body:m,Mi=nc(m.firstChild),Co=y,mr=!0,dl=null,Qi=!0,_=Fs(y,null,T,_),y.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Ff(),T===O){y=Vd(m,y,_);break e}pl(m,y,T,_)}y=y.child}return y;case 26:return Y1(m,y),m===null?(_=nm(y.type,null,y.pendingProps,null))?y.memoizedState=_:mr||(_=y.type,m=y.pendingProps,T=Ms(ue.current).createElement(_),T[rn]=y,T[xn]=m,yt(T,_,m),Xr(T),y.stateNode=T):y.memoizedState=nm(y.type,m.memoizedProps,y.pendingProps,m.memoizedState),null;case 27:return Me(y),m===null&&mr&&(T=y.stateNode=Fh(y.type,y.pendingProps,ue.current),Co=y,Qi=!0,O=Mi,Ii(y.type)?(IC=O,Mi=nc(T.firstChild)):Mi=O),pl(m,y,y.pendingProps.children,_),Y1(m,y),m===null&&(y.flags|=4194304),y.child;case 5:return m===null&&mr&&((O=T=Mi)&&(T=cg(T,y.type,y.pendingProps,Qi),T!==null?(y.stateNode=T,Co=y,Mi=nc(T.firstChild),Qi=!1,O=!0):O=!1),O||Rf(y)),Me(y),O=y.type,z=y.pendingProps,ce=m!==null?m.memoizedProps:null,T=z.children,vr(O,z)?T=null:ce!==null&&vr(O,ce)&&(y.flags|=32),y.memoizedState!==null&&(O=r0(m,y,ww,null,null,_),PC._currentValue=O),Y1(m,y),pl(m,y,T,_),y.child;case 6:return m===null&&mr&&((m=_=Mi)&&(_=Bc(_,y.pendingProps,Qi),_!==null?(y.stateNode=_,Co=y,Mi=null,m=!0):m=!1),m||Rf(y)),null;case 13:return Bx(m,y,_);case 4:return Ce(y,y.stateNode.containerInfo),T=y.pendingProps,m===null?y.child=Pi(y,null,T,_):pl(m,y,T,_),y.child;case 11:return Nx(m,y,y.type,y.pendingProps,_);case 7:return pl(m,y,y.pendingProps,_),y.child;case 8:return pl(m,y,y.pendingProps.children,_),y.child;case 12:return pl(m,y,y.pendingProps.children,_),y.child;case 10:return T=y.pendingProps,cf(y,y.type,T.value),pl(m,y,T.children,_),y.child;case 9:return O=y.type._context,T=y.pendingProps.children,Vf(y),O=Mo(O),T=T(O),y.flags|=1,pl(m,y,T,_),y.child;case 14:return f0(m,y,y.type,y.pendingProps,_);case 15:return Dx(m,y,y.type,y.pendingProps,_);case 19:return EE(m,y,_);case 31:return kE(m,y,_);case 22:return Ox(m,y,_,y.pendingProps);case 24:return Vf(y),T=Mo(xa),m===null?(O=Ae(),O===null&&(O=$i,z=Rd(),O.pooledCache=z,z.refCount++,z!==null&&(O.pooledCacheLanes|=_),O=z),y.memoizedState={parent:T,cache:O},Sn(y),cf(y,xa,O)):((m.lanes&_)!==0&&(Ji(m,y),Ca(y,null,null,_),Ti()),O=m.memoizedState,z=y.memoizedState,O.parent!==T?(O={parent:T,cache:T},y.memoizedState=O,y.lanes===0&&(y.memoizedState=y.updateQueue.baseState=O),cf(y,xa,T)):(T=z.cache,cf(y,xa,T),T!==O.cache&&Bf(y,[xa],_,!0))),pl(m,y,y.pendingProps.children,_),y.child;case 29:throw y.pendingProps}throw Error(s(156,y.tag))}function qf(m){m.flags|=4}function Rw(m,y,_,T,O){if((y=(m.mode&32)!==0)&&(y=!1),y){if(m.flags|=16777216,(O&335544128)===O)if(m.stateNode.complete)m.flags|=8192;else if(fC())m.flags|=8192;else throw zt=ct,St}else m.flags&=-16777217}function Wx(m,y){if(y.type!=="stylesheet"||(y.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!E7(y))if(fC())m.flags|=8192;else throw zt=ct,St}function p0(m,y){y!==null&&(m.flags|=4),m.flags&16384&&(y=m.tag!==22?ai():536870912,m.lanes|=y,ag|=y)}function m0(m,y){if(!mr)switch(m.tailMode){case"hidden":y=m.tail;for(var _=null;y!==null;)y.alternate!==null&&(_=y),y=y.sibling;_===null?m.tail=null:_.sibling=null;break;case"collapsed":_=m.tail;for(var T=null;_!==null;)_.alternate!==null&&(T=_),_=_.sibling;T===null?y||m.tail===null?m.tail=null:m.tail.sibling=null:T.sibling=null}}function ta(m){var y=m.alternate!==null&&m.alternate.child===m.child,_=0,T=0;if(y)for(var O=m.child;O!==null;)_|=O.lanes|O.childLanes,T|=O.subtreeFlags&65011712,T|=O.flags&65011712,O.return=m,O=O.sibling;else for(O=m.child;O!==null;)_|=O.lanes|O.childLanes,T|=O.subtreeFlags,T|=O.flags,O.return=m,O=O.sibling;return m.subtreeFlags|=T,m.childLanes=_,y}function Gx(m,y,_){var T=y.pendingProps;switch(Np(y),y.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ta(y),null;case 1:return ta(y),null;case 3:return _=y.stateNode,T=null,m!==null&&(T=m.memoizedState.cache),y.memoizedState.cache!==T&&(y.flags|=2048),jc(xa),Se(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(m===null||m.child===null)&&(So(y)?qf(y):m===null||m.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,n0())),ta(y),null;case 26:var O=y.type,z=y.memoizedState;return m===null?(qf(y),z!==null?(ta(y),Wx(y,z)):(ta(y),Rw(y,O,null,T,_))):z?z!==m.memoizedState?(qf(y),ta(y),Wx(y,z)):(ta(y),y.flags&=-16777217):(m=m.memoizedProps,m!==T&&qf(y),ta(y),Rw(y,O,m,T,_)),null;case 27:if(pe(y),_=ue.current,O=y.type,m!==null&&y.stateNode!=null)m.memoizedProps!==T&&qf(y);else{if(!T){if(y.stateNode===null)throw Error(s(166));return ta(y),null}m=W.current,So(y)?qm(y):(m=Fh(O,T,_),y.stateNode=m,qf(y))}return ta(y),null;case 5:if(pe(y),O=y.type,m!==null&&y.stateNode!=null)m.memoizedProps!==T&&qf(y);else{if(!T){if(y.stateNode===null)throw Error(s(166));return ta(y),null}if(z=W.current,So(y))qm(y);else{var ce=Ms(ue.current);switch(z){case 1:z=ce.createElementNS("http://www.w3.org/2000/svg",O);break;case 2:z=ce.createElementNS("http://www.w3.org/1998/Math/MathML",O);break;default:switch(O){case"svg":z=ce.createElementNS("http://www.w3.org/2000/svg",O);break;case"math":z=ce.createElementNS("http://www.w3.org/1998/Math/MathML",O);break;case"script":z=ce.createElement("div"),z.innerHTML="<script><\/script>",z=z.removeChild(z.firstChild);break;case"select":z=typeof T.is=="string"?ce.createElement("select",{is:T.is}):ce.createElement("select"),T.multiple?z.multiple=!0:T.size&&(z.size=T.size);break;default:z=typeof T.is=="string"?ce.createElement(O,{is:T.is}):ce.createElement(O)}}z[rn]=y,z[xn]=T;e:for(ce=y.child;ce!==null;){if(ce.tag===5||ce.tag===6)z.appendChild(ce.stateNode);else if(ce.tag!==4&&ce.tag!==27&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===y)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===y)break e;ce=ce.return}ce.sibling.return=ce.return,ce=ce.sibling}y.stateNode=z;e:switch(yt(z,O,T),O){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}T&&qf(y)}}return ta(y),Rw(y,y.type,m===null?null:m.memoizedProps,y.pendingProps,_),null;case 6:if(m&&y.stateNode!=null)m.memoizedProps!==T&&qf(y);else{if(typeof T!="string"&&y.stateNode===null)throw Error(s(166));if(m=ue.current,So(y)){if(m=y.stateNode,_=y.memoizedProps,T=null,O=Co,O!==null)switch(O.tag){case 27:case 5:T=O.memoizedProps}m[rn]=y,m=!!(m.nodeValue===_||T!==null&&T.suppressHydrationWarning===!0||Ee(m.nodeValue,_)),m||Rf(y,!0)}else m=Ms(m).createTextNode(T),m[rn]=y,y.stateNode=m}return ta(y),null;case 31:if(_=y.memoizedState,m===null||m.memoizedState!==null){if(T=So(y),_!==null){if(m===null){if(!T)throw Error(s(318));if(m=y.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(557));m[rn]=y}else Ff(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;ta(y),m=!1}else _=n0(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=_),m=!0;if(!m)return y.flags&256?(yi(y),y):(yi(y),null);if((y.flags&128)!==0)throw Error(s(558))}return ta(y),null;case 13:if(T=y.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(O=So(y),T!==null&&T.dehydrated!==null){if(m===null){if(!O)throw Error(s(318));if(O=y.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(s(317));O[rn]=y}else Ff(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;ta(y),O=!1}else O=n0(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=O),O=!0;if(!O)return y.flags&256?(yi(y),y):(yi(y),null)}return yi(y),(y.flags&128)!==0?(y.lanes=_,y):(_=T!==null,m=m!==null&&m.memoizedState!==null,_&&(T=y.child,O=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(O=T.alternate.memoizedState.cachePool.pool),z=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(z=T.memoizedState.cachePool.pool),z!==O&&(T.flags|=2048)),_!==m&&_&&(y.child.flags|=8192),p0(y,y.updateQueue),ta(y),null);case 4:return Se(),m===null&&rv(y.stateNode.containerInfo),ta(y),null;case 10:return jc(y.type),ta(y),null;case 19:if(R(or),T=y.memoizedState,T===null)return ta(y),null;if(O=(y.flags&128)!==0,z=T.rendering,z===null)if(O)m0(T,!1);else{if($a!==0||m!==null&&(m.flags&128)!==0)for(m=y.child;m!==null;){if(z=ko(m),z!==null){for(y.flags|=128,m0(T,!1),m=z.updateQueue,y.updateQueue=m,p0(y,m),y.subtreeFlags=0,m=_,_=y.child;_!==null;)Ap(_,m),_=_.sibling;return B(or,or.current&1|2),mr&&Il(y,T.treeForkCount),y.child}m=m.sibling}T.tail!==null&&Ft()>ny&&(y.flags|=128,O=!0,m0(T,!1),y.lanes=4194304)}else{if(!O)if(m=ko(z),m!==null){if(y.flags|=128,O=!0,m=m.updateQueue,y.updateQueue=m,p0(y,m),m0(T,!0),T.tail===null&&T.tailMode==="hidden"&&!z.alternate&&!mr)return ta(y),null}else 2*Ft()-T.renderingStartTime>ny&&_!==536870912&&(y.flags|=128,O=!0,m0(T,!1),y.lanes=4194304);T.isBackwards?(z.sibling=y.child,y.child=z):(m=T.last,m!==null?m.sibling=z:y.child=z,T.last=z)}return T.tail!==null?(m=T.tail,T.rendering=m,T.tail=m.sibling,T.renderingStartTime=Ft(),m.sibling=null,_=or.current,B(or,O?_&1|2:_&1),mr&&Il(y,T.treeForkCount),m):(ta(y),null);case 22:case 23:return yi(y),qa(),T=y.memoizedState!==null,m!==null?m.memoizedState!==null!==T&&(y.flags|=8192):T&&(y.flags|=8192),T?(_&536870912)!==0&&(y.flags&128)===0&&(ta(y),y.subtreeFlags&6&&(y.flags|=8192)):ta(y),_=y.updateQueue,_!==null&&p0(y,_.retryQueue),_=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(_=m.memoizedState.cachePool.pool),T=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(T=y.memoizedState.cachePool.pool),T!==_&&(y.flags|=2048),m!==null&&R(xe),null;case 24:return _=null,m!==null&&(_=m.memoizedState.cache),y.memoizedState.cache!==_&&(y.flags|=2048),jc(xa),ta(y),null;case 25:return null;case 30:return null}throw Error(s(156,y.tag))}function AE(m,y){switch(Np(y),y.tag){case 1:return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 3:return jc(xa),Se(),m=y.flags,(m&65536)!==0&&(m&128)===0?(y.flags=m&-65537|128,y):null;case 26:case 27:case 5:return pe(y),null;case 31:if(y.memoizedState!==null){if(yi(y),y.alternate===null)throw Error(s(340));Ff()}return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 13:if(yi(y),m=y.memoizedState,m!==null&&m.dehydrated!==null){if(y.alternate===null)throw Error(s(340));Ff()}return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 19:return R(or),null;case 4:return Se(),null;case 10:return jc(y.type),null;case 22:case 23:return yi(y),qa(),m!==null&&R(xe),m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 24:return jc(xa),null;case 25:return null;default:return null}}function Hx(m,y){switch(Np(y),y.tag){case 3:jc(xa),Se();break;case 26:case 27:case 5:pe(y);break;case 4:Se();break;case 31:y.memoizedState!==null&&yi(y);break;case 13:yi(y);break;case 19:R(or);break;case 10:jc(y.type);break;case 22:case 23:yi(y),qa(),m!==null&&R(xe);break;case 24:jc(xa)}}function sg(m,y){try{var _=y.updateQueue,T=_!==null?_.lastEffect:null;if(T!==null){var O=T.next;_=O;do{if((_.tag&m)===m){T=void 0;var z=_.create,ce=_.inst;T=z(),ce.destroy=T}_=_.next}while(_!==O)}}catch(ke){Ei(y,y.return,ke)}}function Ph(m,y,_){try{var T=y.updateQueue,O=T!==null?T.lastEffect:null;if(O!==null){var z=O.next;T=z;do{if((T.tag&m)===m){var ce=T.inst,ke=ce.destroy;if(ke!==void 0){ce.destroy=void 0,O=y;var Qe=_,kt=ke;try{kt()}catch(Kt){Ei(O,Qe,Kt)}}}T=T.next}while(T!==z)}}catch(Kt){Ei(y,y.return,Kt)}}function qx(m){var y=m.updateQueue;if(y!==null){var _=m.stateNode;try{Oa(y,_)}catch(T){Ei(m,m.return,T)}}}function Fw(m,y,_){_.props=Hp(m.type,m.memoizedProps),_.state=m.memoizedState;try{_.componentWillUnmount()}catch(T){Ei(m,y,T)}}function g0(m,y){try{var _=m.ref;if(_!==null){switch(m.tag){case 26:case 27:case 5:var T=m.stateNode;break;case 30:T=m.stateNode;break;default:T=m.stateNode}typeof _=="function"?m.refCleanup=_(T):_.current=T}}catch(O){Ei(m,y,O)}}function Yf(m,y){var _=m.ref,T=m.refCleanup;if(_!==null)if(typeof T=="function")try{T()}catch(O){Ei(m,y,O)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(O){Ei(m,y,O)}else _.current=null}function zw(m){var y=m.type,_=m.memoizedProps,T=m.stateNode;try{e:switch(y){case"button":case"input":case"select":case"textarea":_.autoFocus&&T.focus();break e;case"img":_.src?T.src=_.src:_.srcSet&&(T.srcset=_.srcSet)}}catch(O){Ei(m,m.return,O)}}function Bw(m,y,_){try{var T=m.stateNode;Vt(T,m.type,_,y),T[xn]=y}catch(O){Ei(m,m.return,O)}}function Yx(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Ii(m.type)||m.tag===4}function X1(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||Yx(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Ii(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function Uw(m,y,_){var T=m.tag;if(T===5||T===6)m=m.stateNode,y?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(m,y):(y=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,y.appendChild(m),_=_._reactRootContainer,_!=null||y.onclick!==null||(y.onclick=ds));else if(T!==4&&(T===27&&Ii(m.type)&&(_=m.stateNode,y=null),m=m.child,m!==null))for(Uw(m,y,_),m=m.sibling;m!==null;)Uw(m,y,_),m=m.sibling}function Q1(m,y,_){var T=m.tag;if(T===5||T===6)m=m.stateNode,y?_.insertBefore(m,y):_.appendChild(m);else if(T!==4&&(T===27&&Ii(m.type)&&(_=m.stateNode),m=m.child,m!==null))for(Q1(m,y,_),m=m.sibling;m!==null;)Q1(m,y,_),m=m.sibling}function J1(m){var y=m.stateNode,_=m.memoizedProps;try{for(var T=m.type,O=y.attributes;O.length;)y.removeAttributeNode(O[0]);yt(y,T,_),y[rn]=m,y[xn]=_}catch(z){Ei(m,m.return,z)}}var Wd=!1,oo=!1,Vw=!1,Kx=typeof WeakSet=="function"?WeakSet:Set,Eo=null;function Ww(m,y){if(m=m.containerInfo,Ln=tI,m=Ec(m),cl(m)){if("selectionStart"in m)var _={start:m.selectionStart,end:m.selectionEnd};else e:{_=(_=m.ownerDocument)&&_.defaultView||window;var T=_.getSelection&&_.getSelection();if(T&&T.rangeCount!==0){_=T.anchorNode;var O=T.anchorOffset,z=T.focusNode;T=T.focusOffset;try{_.nodeType,z.nodeType}catch{_=null;break e}var ce=0,ke=-1,Qe=-1,kt=0,Kt=0,tn=m,Lt=null;t:for(;;){for(var Pt;tn!==_||O!==0&&tn.nodeType!==3||(ke=ce+O),tn!==z||T!==0&&tn.nodeType!==3||(Qe=ce+T),tn.nodeType===3&&(ce+=tn.nodeValue.length),(Pt=tn.firstChild)!==null;)Lt=tn,tn=Pt;for(;;){if(tn===m)break t;if(Lt===_&&++kt===O&&(ke=ce),Lt===z&&++Kt===T&&(Qe=ce),(Pt=tn.nextSibling)!==null)break;tn=Lt,Lt=tn.parentNode}tn=Pt}_=ke===-1||Qe===-1?null:{start:ke,end:Qe}}else _=null}_=_||{start:0,end:0}}else _=null;for(Is={focusedElem:m,selectionRange:_},tI=!1,Eo=y;Eo!==null;)if(y=Eo,m=y.child,(y.subtreeFlags&1028)!==0&&m!==null)m.return=y,Eo=m;else for(;Eo!==null;){switch(y=Eo,z=y.alternate,m=y.flags,y.tag){case 0:if((m&4)!==0&&(m=y.updateQueue,m=m!==null?m.events:null,m!==null))for(_=0;_<m.length;_++)O=m[_],O.ref.impl=O.nextImpl;break;case 11:case 15:break;case 1:if((m&1024)!==0&&z!==null){m=void 0,_=y,O=z.memoizedProps,z=z.memoizedState,T=_.stateNode;try{var Jn=Hp(_.type,O);m=T.getSnapshotBeforeUpdate(Jn,z),T.__reactInternalSnapshotBeforeUpdate=m}catch(Os){Ei(_,_.return,Os)}}break;case 3:if((m&1024)!==0){if(m=y.stateNode.containerInfo,_=m.nodeType,_===9)fo(m);else if(_===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":fo(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(s(163))}if(m=y.sibling,m!==null){m.return=y.return,Eo=m;break}Eo=y.return}}function LE(m,y,_){var T=_.flags;switch(_.tag){case 0:case 11:case 15:Hd(m,_),T&4&&sg(5,_);break;case 1:if(Hd(m,_),T&4)if(m=_.stateNode,y===null)try{m.componentDidMount()}catch(ce){Ei(_,_.return,ce)}else{var O=Hp(_.type,y.memoizedProps);y=y.memoizedState;try{m.componentDidUpdate(O,y,m.__reactInternalSnapshotBeforeUpdate)}catch(ce){Ei(_,_.return,ce)}}T&64&&qx(_),T&512&&g0(_,_.return);break;case 3:if(Hd(m,_),T&64&&(m=_.updateQueue,m!==null)){if(y=null,_.child!==null)switch(_.child.tag){case 27:case 5:y=_.child.stateNode;break;case 1:y=_.child.stateNode}try{Oa(m,y)}catch(ce){Ei(_,_.return,ce)}}break;case 27:y===null&&T&4&&J1(_);case 26:case 5:Hd(m,_),y===null&&T&4&&zw(_),T&512&&g0(_,_.return);break;case 12:Hd(m,_);break;case 31:Hd(m,_),T&4&&Gw(m,_);break;case 13:Hd(m,_),T&4&&Jx(m,_),T&64&&(m=_.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(_=DP.bind(null,_),iv(m,_))));break;case 22:if(T=_.memoizedState!==null||Wd,!T){y=y!==null&&y.memoizedState!==null||oo,O=Wd;var z=oo;Wd=T,(oo=y)&&!z?pf(m,_,(_.subtreeFlags&8772)!==0):Hd(m,_),Wd=O,oo=z}break;case 30:break;default:Hd(m,_)}}function Xx(m){var y=m.alternate;y!==null&&(m.alternate=null,Xx(y)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(y=m.stateNode,y!==null&&Yr(y)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var ua=null,tc=!1;function Gd(m,y,_){for(_=_.child;_!==null;)Qx(m,y,_),_=_.sibling}function Qx(m,y,_){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(yn,_)}catch{}switch(_.tag){case 26:oo||Yf(_,y),Gd(m,y,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:oo||Yf(_,y);var T=ua,O=tc;Ii(_.type)&&(ua=_.stateNode,tc=!1),Gd(m,y,_),ed(_.stateNode),ua=T,tc=O;break;case 5:oo||Yf(_,y);case 6:if(T=ua,O=tc,ua=null,Gd(m,y,_),ua=T,tc=O,ua!==null)if(tc)try{(ua.nodeType===9?ua.body:ua.nodeName==="HTML"?ua.ownerDocument.body:ua).removeChild(_.stateNode)}catch(z){Ei(_,y,z)}else try{ua.removeChild(_.stateNode)}catch(z){Ei(_,y,z)}break;case 18:ua!==null&&(tc?(m=ua,qs(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,_.stateNode),lv(m)):qs(ua,_.stateNode));break;case 4:T=ua,O=tc,ua=_.stateNode.containerInfo,tc=!0,Gd(m,y,_),ua=T,tc=O;break;case 0:case 11:case 14:case 15:Ph(2,_,y),oo||Ph(4,_,y),Gd(m,y,_);break;case 1:oo||(Yf(_,y),T=_.stateNode,typeof T.componentWillUnmount=="function"&&Fw(_,y,T)),Gd(m,y,_);break;case 21:Gd(m,y,_);break;case 22:oo=(T=oo)||_.memoizedState!==null,Gd(m,y,_),oo=T;break;default:Gd(m,y,_)}}function Gw(m,y){if(y.memoizedState===null&&(m=y.alternate,m!==null&&(m=m.memoizedState,m!==null))){m=m.dehydrated;try{lv(m)}catch(_){Ei(y,y.return,_)}}}function Jx(m,y){if(y.memoizedState===null&&(m=y.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{lv(m)}catch(_){Ei(y,y.return,_)}}function NE(m){switch(m.tag){case 31:case 13:case 19:var y=m.stateNode;return y===null&&(y=m.stateNode=new Kx),y;case 22:return m=m.stateNode,y=m._retryCache,y===null&&(y=m._retryCache=new Kx),y;default:throw Error(s(435,m.tag))}}function y0(m,y){var _=NE(m);y.forEach(function(T){if(!_.has(T)){_.add(T);var O=OP.bind(null,m,T);T.then(O,O)}})}function tu(m,y){var _=y.deletions;if(_!==null)for(var T=0;T<_.length;T++){var O=_[T],z=m,ce=y,ke=ce;e:for(;ke!==null;){switch(ke.tag){case 27:if(Ii(ke.type)){ua=ke.stateNode,tc=!1;break e}break;case 5:ua=ke.stateNode,tc=!1;break e;case 3:case 4:ua=ke.stateNode.containerInfo,tc=!0;break e}ke=ke.return}if(ua===null)throw Error(s(160));Qx(z,ce,O),ua=null,tc=!1,z=O.alternate,z!==null&&(z.return=null),O.return=null}if(y.subtreeFlags&13886)for(y=y.child;y!==null;)Hw(y,m),y=y.sibling}var Kf=null;function Hw(m,y){var _=m.alternate,T=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:tu(y,m),Ll(m),T&4&&(Ph(3,m,m.return),sg(3,m),Ph(5,m,m.return));break;case 1:tu(y,m),Ll(m),T&512&&(oo||_===null||Yf(_,_.return)),T&64&&Wd&&(m=m.updateQueue,m!==null&&(T=m.callbacks,T!==null&&(_=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=_===null?T:_.concat(T))));break;case 26:var O=Kf;if(tu(y,m),Ll(m),T&512&&(oo||_===null||Yf(_,_.return)),T&4){var z=_!==null?_.memoizedState:null;if(T=m.memoizedState,_===null)if(T===null)if(m.stateNode===null){e:{T=m.type,_=m.memoizedProps,O=O.ownerDocument||O;t:switch(T){case"title":z=O.getElementsByTagName("title")[0],(!z||z[Vr]||z[rn]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=O.createElement(T),O.head.insertBefore(z,O.querySelector("head > title"))),yt(z,T,_),z[rn]=m,Xr(z),T=z;break e;case"link":var ce=T7("link","href",O).get(T+(_.href||""));if(ce){for(var ke=0;ke<ce.length;ke++)if(z=ce[ke],z.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&z.getAttribute("rel")===(_.rel==null?null:_.rel)&&z.getAttribute("title")===(_.title==null?null:_.title)&&z.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){ce.splice(ke,1);break t}}z=O.createElement(T),yt(z,T,_),O.head.appendChild(z);break;case"meta":if(ce=T7("meta","content",O).get(T+(_.content||""))){for(ke=0;ke<ce.length;ke++)if(z=ce[ke],z.getAttribute("content")===(_.content==null?null:""+_.content)&&z.getAttribute("name")===(_.name==null?null:_.name)&&z.getAttribute("property")===(_.property==null?null:_.property)&&z.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&z.getAttribute("charset")===(_.charSet==null?null:_.charSet)){ce.splice(ke,1);break t}}z=O.createElement(T),yt(z,T,_),O.head.appendChild(z);break;default:throw Error(s(468,T))}z[rn]=m,Xr(z),T=z}m.stateNode=T}else k7(O,m.type,m.stateNode);else m.stateNode=M7(O,T,m.memoizedProps);else z!==T?(z===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):z.count--,T===null?k7(O,m.type,m.stateNode):M7(O,T,m.memoizedProps)):T===null&&m.stateNode!==null&&Bw(m,m.memoizedProps,_.memoizedProps)}break;case 27:tu(y,m),Ll(m),T&512&&(oo||_===null||Yf(_,_.return)),_!==null&&T&4&&Bw(m,m.memoizedProps,_.memoizedProps);break;case 5:if(tu(y,m),Ll(m),T&512&&(oo||_===null||Yf(_,_.return)),m.flags&32){O=m.stateNode;try{Ve(O,"")}catch(Jn){Ei(m,m.return,Jn)}}T&4&&m.stateNode!=null&&(O=m.memoizedProps,Bw(m,O,_!==null?_.memoizedProps:O)),T&1024&&(Vw=!0);break;case 6:if(tu(y,m),Ll(m),T&4){if(m.stateNode===null)throw Error(s(162));T=m.memoizedProps,_=m.stateNode;try{_.nodeValue=T}catch(Jn){Ei(m,m.return,Jn)}}break;case 3:if(QE=null,O=Kf,Kf=S0(y.containerInfo),tu(y,m),Kf=O,Ll(m),T&4&&_!==null&&_.memoizedState.isDehydrated)try{lv(y.containerInfo)}catch(Jn){Ei(m,m.return,Jn)}Vw&&(Vw=!1,Zx(m));break;case 4:T=Kf,Kf=S0(m.stateNode.containerInfo),tu(y,m),Ll(m),Kf=T;break;case 12:tu(y,m),Ll(m);break;case 31:tu(y,m),Ll(m),T&4&&(T=m.updateQueue,T!==null&&(m.updateQueue=null,y0(m,T)));break;case 13:tu(y,m),Ll(m),m.child.flags&8192&&m.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(ty=Ft()),T&4&&(T=m.updateQueue,T!==null&&(m.updateQueue=null,y0(m,T)));break;case 22:O=m.memoizedState!==null;var Qe=_!==null&&_.memoizedState!==null,kt=Wd,Kt=oo;if(Wd=kt||O,oo=Kt||Qe,tu(y,m),oo=Kt,Wd=kt,Ll(m),T&8192)e:for(y=m.stateNode,y._visibility=O?y._visibility&-2:y._visibility|1,O&&(_===null||Qe||Wd||oo||Yp(m)),_=null,y=m;;){if(y.tag===5||y.tag===26){if(_===null){Qe=_=y;try{if(z=Qe.stateNode,O)ce=z.style,typeof ce.setProperty=="function"?ce.setProperty("display","none","important"):ce.display="none";else{ke=Qe.stateNode;var tn=Qe.memoizedProps.style,Lt=tn!=null&&tn.hasOwnProperty("display")?tn.display:null;ke.style.display=Lt==null||typeof Lt=="boolean"?"":(""+Lt).trim()}}catch(Jn){Ei(Qe,Qe.return,Jn)}}}else if(y.tag===6){if(_===null){Qe=y;try{Qe.stateNode.nodeValue=O?"":Qe.memoizedProps}catch(Jn){Ei(Qe,Qe.return,Jn)}}}else if(y.tag===18){if(_===null){Qe=y;try{var Pt=Qe.stateNode;O?da(Pt,!0):da(Qe.stateNode,!1)}catch(Jn){Ei(Qe,Qe.return,Jn)}}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===m)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break e;for(;y.sibling===null;){if(y.return===null||y.return===m)break e;_===y&&(_=null),y=y.return}_===y&&(_=null),y.sibling.return=y.return,y=y.sibling}T&4&&(T=m.updateQueue,T!==null&&(_=T.retryQueue,_!==null&&(T.retryQueue=null,y0(m,_))));break;case 19:tu(y,m),Ll(m),T&4&&(T=m.updateQueue,T!==null&&(m.updateQueue=null,y0(m,T)));break;case 30:break;case 21:break;default:tu(y,m),Ll(m)}}function Ll(m){var y=m.flags;if(y&2){try{for(var _,T=m.return;T!==null;){if(Yx(T)){_=T;break}T=T.return}if(_==null)throw Error(s(160));switch(_.tag){case 27:var O=_.stateNode,z=X1(m);Q1(m,z,O);break;case 5:var ce=_.stateNode;_.flags&32&&(Ve(ce,""),_.flags&=-33);var ke=X1(m);Q1(m,ke,ce);break;case 3:case 4:var Qe=_.stateNode.containerInfo,kt=X1(m);Uw(m,kt,Qe);break;default:throw Error(s(161))}}catch(Kt){Ei(m,m.return,Kt)}m.flags&=-3}y&4096&&(m.flags&=-4097)}function Zx(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var y=m;Zx(y),y.tag===5&&y.flags&1024&&y.stateNode.reset(),m=m.sibling}}function Hd(m,y){if(y.subtreeFlags&8772)for(y=y.child;y!==null;)LE(m,y.alternate,y),y=y.sibling}function Yp(m){for(m=m.child;m!==null;){var y=m;switch(y.tag){case 0:case 11:case 14:case 15:Ph(4,y,y.return),Yp(y);break;case 1:Yf(y,y.return);var _=y.stateNode;typeof _.componentWillUnmount=="function"&&Fw(y,y.return,_),Yp(y);break;case 27:ed(y.stateNode);case 26:case 5:Yf(y,y.return),Yp(y);break;case 22:y.memoizedState===null&&Yp(y);break;case 30:Yp(y);break;default:Yp(y)}m=m.sibling}}function pf(m,y,_){for(_=_&&(y.subtreeFlags&8772)!==0,y=y.child;y!==null;){var T=y.alternate,O=m,z=y,ce=z.flags;switch(z.tag){case 0:case 11:case 15:pf(O,z,_),sg(4,z);break;case 1:if(pf(O,z,_),T=z,O=T.stateNode,typeof O.componentDidMount=="function")try{O.componentDidMount()}catch(kt){Ei(T,T.return,kt)}if(T=z,O=T.updateQueue,O!==null){var ke=T.stateNode;try{var Qe=O.shared.hiddenCallbacks;if(Qe!==null)for(O.shared.hiddenCallbacks=null,O=0;O<Qe.length;O++)Vo(Qe[O],ke)}catch(kt){Ei(T,T.return,kt)}}_&&ce&64&&qx(z),g0(z,z.return);break;case 27:J1(z);case 26:case 5:pf(O,z,_),_&&T===null&&ce&4&&zw(z),g0(z,z.return);break;case 12:pf(O,z,_);break;case 31:pf(O,z,_),_&&ce&4&&Gw(O,z);break;case 13:pf(O,z,_),_&&ce&4&&Jx(O,z);break;case 22:z.memoizedState===null&&pf(O,z,_),g0(z,z.return);break;case 30:break;default:pf(O,z,_)}y=y.sibling}}function qw(m,y){var _=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(_=m.memoizedState.cachePool.pool),m=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(m=y.memoizedState.cachePool.pool),m!==_&&(m!=null&&m.refCount++,_!=null&&Pp(_))}function Yw(m,y){m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&Pp(m))}function mf(m,y,_,T){if(y.subtreeFlags&10256)for(y=y.child;y!==null;)Z1(m,y,_,T),y=y.sibling}function Z1(m,y,_,T){var O=y.flags;switch(y.tag){case 0:case 11:case 15:mf(m,y,_,T),O&2048&&sg(9,y);break;case 1:mf(m,y,_,T);break;case 3:mf(m,y,_,T),O&2048&&(m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&Pp(m)));break;case 12:if(O&2048){mf(m,y,_,T),m=y.stateNode;try{var z=y.memoizedProps,ce=z.id,ke=z.onPostCommit;typeof ke=="function"&&ke(ce,y.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Qe){Ei(y,y.return,Qe)}}else mf(m,y,_,T);break;case 31:mf(m,y,_,T);break;case 13:mf(m,y,_,T);break;case 23:break;case 22:z=y.stateNode,ce=y.alternate,y.memoizedState!==null?z._visibility&2?mf(m,y,_,T):b0(m,y):z._visibility&2?mf(m,y,_,T):(z._visibility|=2,rg(m,y,_,T,(y.subtreeFlags&10256)!==0||!1)),O&2048&&qw(ce,y);break;case 24:mf(m,y,_,T),O&2048&&Yw(y.alternate,y);break;default:mf(m,y,_,T)}}function rg(m,y,_,T,O){for(O=O&&((y.subtreeFlags&10256)!==0||!1),y=y.child;y!==null;){var z=m,ce=y,ke=_,Qe=T,kt=ce.flags;switch(ce.tag){case 0:case 11:case 15:rg(z,ce,ke,Qe,O),sg(8,ce);break;case 23:break;case 22:var Kt=ce.stateNode;ce.memoizedState!==null?Kt._visibility&2?rg(z,ce,ke,Qe,O):b0(z,ce):(Kt._visibility|=2,rg(z,ce,ke,Qe,O)),O&&kt&2048&&qw(ce.alternate,ce);break;case 24:rg(z,ce,ke,Qe,O),O&&kt&2048&&Yw(ce.alternate,ce);break;default:rg(z,ce,ke,Qe,O)}y=y.sibling}}function b0(m,y){if(y.subtreeFlags&10256)for(y=y.child;y!==null;){var _=m,T=y,O=T.flags;switch(T.tag){case 22:b0(_,T),O&2048&&qw(T.alternate,T);break;case 24:b0(_,T),O&2048&&Yw(T.alternate,T);break;default:b0(_,T)}y=y.sibling}}var w0=8192;function $h(m,y,_){if(m.subtreeFlags&w0)for(m=m.child;m!==null;)eC(m,y,_),m=m.sibling}function eC(m,y,_){switch(m.tag){case 26:$h(m,y,_),m.flags&w0&&m.memoizedState!==null&&R0e(_,Kf,m.memoizedState,m.memoizedProps);break;case 5:$h(m,y,_);break;case 3:case 4:var T=Kf;Kf=S0(m.stateNode.containerInfo),$h(m,y,_),Kf=T;break;case 22:m.memoizedState===null&&(T=m.alternate,T!==null&&T.memoizedState!==null?(T=w0,w0=16777216,$h(m,y,_),w0=T):$h(m,y,_));break;default:$h(m,y,_)}}function tC(m){var y=m.alternate;if(y!==null&&(m=y.child,m!==null)){y.child=null;do y=m.sibling,m.sibling=null,m=y;while(m!==null)}}function v0(m){var y=m.deletions;if((m.flags&16)!==0){if(y!==null)for(var _=0;_<y.length;_++){var T=y[_];Eo=T,sC(T,m)}tC(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)nC(m),m=m.sibling}function nC(m){switch(m.tag){case 0:case 11:case 15:v0(m),m.flags&2048&&Ph(9,m,m.return);break;case 3:v0(m);break;case 12:v0(m);break;case 22:var y=m.stateNode;m.memoizedState!==null&&y._visibility&2&&(m.return===null||m.return.tag!==13)?(y._visibility&=-3,ey(m)):v0(m);break;default:v0(m)}}function ey(m){var y=m.deletions;if((m.flags&16)!==0){if(y!==null)for(var _=0;_<y.length;_++){var T=y[_];Eo=T,sC(T,m)}tC(m)}for(m=m.child;m!==null;){switch(y=m,y.tag){case 0:case 11:case 15:Ph(8,y,y.return),ey(y);break;case 22:_=y.stateNode,_._visibility&2&&(_._visibility&=-3,ey(y));break;default:ey(y)}m=m.sibling}}function sC(m,y){for(;Eo!==null;){var _=Eo;switch(_.tag){case 0:case 11:case 15:Ph(8,_,y);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var T=_.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:Pp(_.memoizedState.cache)}if(T=_.child,T!==null)T.return=_,Eo=T;else e:for(_=m;Eo!==null;){T=Eo;var O=T.sibling,z=T.return;if(Xx(T),T===_){Eo=null;break e}if(O!==null){O.return=z,Eo=O;break e}Eo=z}}}var DE={getCacheForType:function(m){var y=Mo(xa),_=y.data.get(m);return _===void 0&&(_=m(),y.data.set(m,_)),_},cacheSignal:function(){return Mo(xa).controller.signal}},OE=typeof WeakMap=="function"?WeakMap:Map,ti=0,$i=null,lr=null,br=0,bi=0,Fc=null,jh=!1,ig=!1,Kw=!1,Xf=0,$a=0,Qf=0,Kp=0,Xw=0,nu=0,ag=0,_0=null,Nl=null,Qw=!1,ty=0,rC=0,ny=1/0,sy=null,Jf=null,Io=0,Rh=null,og=null,rr=0,iC=0,aC=null,PE=null,ry=0,iy=null;function su(){return(ti&2)!==0&&br!==0?br&-br:q.T!==null?SC():ze()}function oC(){if(nu===0)if((br&536870912)===0||mr){var m=Ss;Ss<<=1,(Ss&3932160)===0&&(Ss=262144),nu=m}else nu=536870912;return m=ea.current,m!==null&&(m.flags|=32),nu}function zc(m,y,_){(m===$i&&(bi===2||bi===9)||m.cancelPendingCommit!==null)&&(Qp(m,0),Xp(m,br,nu,!1)),Fn(m,_),((ti&2)===0||m!==$i)&&(m===$i&&((ti&2)===0&&(Kp|=_),$a===4&&Xp(m,br,nu,!1)),qd(m))}function lC(m,y,_){if((ti&6)!==0)throw Error(s(327));var T=!_&&(y&127)===0&&(y&m.expiredLanes)===0||sn(m,y),O=T?jE(m,y):ev(m,y,!0),z=T;do{if(O===0){ig&&!T&&Xp(m,y,0,!1);break}else{if(_=m.current.alternate,z&&!cC(_)){O=ev(m,y,!1),z=!1;continue}if(O===2){if(z=y,m.errorRecoveryDisabledLanes&z)var ce=0;else ce=m.pendingLanes&-536870913,ce=ce!==0?ce:ce&536870912?536870912:0;if(ce!==0){y=ce;e:{var ke=m;O=_0;var Qe=ke.current.memoizedState.isDehydrated;if(Qe&&(Qp(ke,ce).flags|=256),ce=ev(ke,ce,!1),ce!==2){if(Kw&&!Qe){ke.errorRecoveryDisabledLanes|=z,Kp|=z,O=4;break e}z=Nl,Nl=O,z!==null&&(Nl===null?Nl=z:Nl.push.apply(Nl,z))}O=ce}if(z=!1,O!==2)continue}}if(O===1){Qp(m,0),Xp(m,y,0,!0);break}e:{switch(T=m,z=O,z){case 0:case 1:throw Error(s(345));case 4:if((y&4194048)!==y)break;case 6:Xp(T,y,nu,!jh);break e;case 2:Nl=null;break;case 3:case 5:break;default:throw Error(s(329))}if((y&62914560)===y&&(O=ty+300-Ft(),10<O)){if(Xp(T,y,nu,!jh),Mt(T,0,!0)!==0)break e;rr=y,T.timeoutHandle=cr(Jw.bind(null,T,_,Nl,sy,Qw,y,nu,Kp,ag,jh,z,"Throttled",-0,0),O);break e}Jw(T,_,Nl,sy,Qw,y,nu,Kp,ag,jh,z,null,-0,0)}}break}while(!0);qd(m)}function Jw(m,y,_,T,O,z,ce,ke,Qe,kt,Kt,tn,Lt,Pt){if(m.timeoutHandle=-1,tn=y.subtreeFlags,tn&8192||(tn&16785408)===16785408){tn={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ds},eC(y,z,tn);var Jn=(z&62914560)===z?ty-Ft():(z&4194048)===z?rC-Ft():0;if(Jn=F0e(tn,Jn),Jn!==null){rr=z,m.cancelPendingCommit=Jn(gC.bind(null,m,y,z,_,T,O,ce,ke,Qe,Kt,tn,null,Lt,Pt)),Xp(m,z,ce,!kt);return}}gC(m,y,z,_,T,O,ce,ke,Qe)}function cC(m){for(var y=m;;){var _=y.tag;if((_===0||_===11||_===15)&&y.flags&16384&&(_=y.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var T=0;T<_.length;T++){var O=_[T],z=O.getSnapshot;O=O.value;try{if(!La(z(),O))return!1}catch{return!1}}if(_=y.child,y.subtreeFlags&16384&&_!==null)_.return=y,y=_;else{if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function Xp(m,y,_,T){y&=~Xw,y&=~Kp,m.suspendedLanes|=y,m.pingedLanes&=~y,T&&(m.warmLanes|=y),T=m.expirationTimes;for(var O=y;0<O;){var z=31-Nn(O),ce=1<<z;T[z]=-1,O&=~ce}_!==0&&ro(m,_,y)}function ay(){return(ti&6)===0?(uy(0),!1):!0}function Zw(){if(lr!==null){if(bi===0)var m=lr.return;else m=lr,Iu=zf=null,Xm(m),en=null,Yn=0,m=lr;for(;m!==null;)Hx(m.alternate,m),m=m.return;lr=null}}function Qp(m,y){var _=m.timeoutHandle;_!==-1&&(m.timeoutHandle=-1,ni(_)),_=m.cancelPendingCommit,_!==null&&(m.cancelPendingCommit=null,_()),rr=0,Zw(),$i=m,lr=_=ec(m.current,null),br=y,bi=0,Fc=null,jh=!1,ig=sn(m,y),Kw=!1,ag=nu=Xw=Kp=Qf=$a=0,Nl=_0=null,Qw=!1,(y&8)!==0&&(y|=y&32);var T=m.entangledLanes;if(T!==0)for(m=m.entanglements,T&=y;0<T;){var O=31-Nn(T),z=1<<O;y|=m[O],T&=~z}return Xf=y,Ep(),_}function uC(m,y){ms=null,q.H=tg,y===tt||y===je?(y=Yt(),bi=3):y===St?(y=Yt(),bi=4):bi=y===u0?8:y!==null&&typeof y=="object"&&typeof y.then=="function"?6:1,Fc=y,lr===null&&($a=1,q1(m,Nc(y,m.current)))}function fC(){var m=ea.current;return m===null?!0:(br&4194048)===br?Tr===null:(br&62914560)===br||(br&536870912)!==0?m===Tr:!1}function $E(){var m=q.H;return q.H=tg,m===null?tg:m}function dC(){var m=q.A;return q.A=DE,m}function oy(){$a=4,jh||(br&4194048)!==br&&ea.current!==null||(ig=!0),(Qf&134217727)===0&&(Kp&134217727)===0||$i===null||Xp($i,br,nu,!1)}function ev(m,y,_){var T=ti;ti|=2;var O=$E(),z=dC();($i!==m||br!==y)&&(sy=null,Qp(m,y)),y=!1;var ce=$a;e:do try{if(bi!==0&&lr!==null){var ke=lr,Qe=Fc;switch(bi){case 8:Zw(),ce=6;break e;case 3:case 2:case 9:case 6:ea.current===null&&(y=!0);var kt=bi;if(bi=0,Fc=null,lg(m,ke,Qe,kt),_&&ig){ce=0;break e}break;default:kt=bi,bi=0,Fc=null,lg(m,ke,Qe,kt)}}x0(),ce=$a;break}catch(Kt){uC(m,Kt)}while(!0);return y&&m.shellSuspendCounter++,Iu=zf=null,ti=T,q.H=O,q.A=z,lr===null&&($i=null,br=0,Ep()),ce}function x0(){for(;lr!==null;)hC(lr)}function jE(m,y){var _=ti;ti|=2;var T=$E(),O=dC();$i!==m||br!==y?(sy=null,ny=Ft()+500,Qp(m,y)):ig=sn(m,y);e:do try{if(bi!==0&&lr!==null){y=lr;var z=Fc;t:switch(bi){case 1:bi=0,Fc=null,lg(m,y,z,1);break;case 2:case 9:if(gt(z)){bi=0,Fc=null,pC(y);break}y=function(){bi!==2&&bi!==9||$i!==m||(bi=7),qd(m)},z.then(y,y);break e;case 3:bi=7;break e;case 4:bi=5;break e;case 7:gt(z)?(bi=0,Fc=null,pC(y)):(bi=0,Fc=null,lg(m,y,z,7));break;case 5:var ce=null;switch(lr.tag){case 26:ce=lr.memoizedState;case 5:case 27:var ke=lr;if(ce?E7(ce):ke.stateNode.complete){bi=0,Fc=null;var Qe=ke.sibling;if(Qe!==null)lr=Qe;else{var kt=ke.return;kt!==null?(lr=kt,ly(kt)):lr=null}break t}}bi=0,Fc=null,lg(m,y,z,5);break;case 6:bi=0,Fc=null,lg(m,y,z,6);break;case 8:Zw(),$a=6;break e;default:throw Error(s(462))}}RE();break}catch(Kt){uC(m,Kt)}while(!0);return Iu=zf=null,q.H=T,q.A=O,ti=_,lr!==null?0:($i=null,br=0,Ep(),$a)}function RE(){for(;lr!==null&&!xt();)hC(lr)}function hC(m){var y=Vx(m.alternate,m,Xf);m.memoizedProps=m.pendingProps,y===null?ly(m):lr=y}function pC(m){var y=m,_=y.alternate;switch(y.tag){case 15:case 0:y=Rx(_,y,y.pendingProps,y.type,void 0,br);break;case 11:y=Rx(_,y,y.pendingProps,y.type.render,y.ref,br);break;case 5:Xm(y);default:Hx(_,y),y=lr=Ap(y,Xf),y=Vx(_,y,Xf)}m.memoizedProps=m.pendingProps,y===null?ly(m):lr=y}function lg(m,y,_,T){Iu=zf=null,Xm(y),en=null,Yn=0;var O=y.return;try{if(TE(m,O,y,_,br)){$a=1,q1(m,Nc(_,m.current)),lr=null;return}}catch(z){if(O!==null)throw lr=O,z;$a=1,q1(m,Nc(_,m.current)),lr=null;return}y.flags&32768?(mr||T===1?m=!0:ig||(br&536870912)!==0?m=!1:(jh=m=!0,(T===2||T===9||T===3||T===6)&&(T=ea.current,T!==null&&T.tag===13&&(T.flags|=16384))),mC(y,m)):ly(y)}function ly(m){var y=m;do{if((y.flags&32768)!==0){mC(y,jh);return}m=y.return;var _=Gx(y.alternate,y,Xf);if(_!==null){lr=_;return}if(y=y.sibling,y!==null){lr=y;return}lr=y=m}while(y!==null);$a===0&&($a=5)}function mC(m,y){do{var _=AE(m.alternate,m);if(_!==null){_.flags&=32767,lr=_;return}if(_=m.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!y&&(m=m.sibling,m!==null)){lr=m;return}lr=m=_}while(m!==null);$a=6,lr=null}function gC(m,y,_,T,O,z,ce,ke,Qe){m.cancelPendingCommit=null;do cy();while(Io!==0);if((ti&6)!==0)throw Error(s(327));if(y!==null){if(y===m.current)throw Error(s(177));if(z=y.lanes|y.childLanes,z|=Bm,fs(m,_,z,ce,ke,Qe),m===$i&&(lr=$i=null,br=0),og=y,Rh=m,rr=_,iC=z,aC=O,PE=T,(y.subtreeFlags&10256)!==0||(y.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,PP(At,function(){return vC(),null})):(m.callbackNode=null,m.callbackPriority=0),T=(y.flags&13878)!==0,(y.subtreeFlags&13878)!==0||T){T=q.T,q.T=null,O=te.p,te.p=2,ce=ti,ti|=4;try{Ww(m,y,_)}finally{ti=ce,te.p=O,q.T=T}}Io=1,FE(),yC(),bC()}}function FE(){if(Io===1){Io=0;var m=Rh,y=og,_=(y.flags&13878)!==0;if((y.subtreeFlags&13878)!==0||_){_=q.T,q.T=null;var T=te.p;te.p=2;var O=ti;ti|=4;try{Hw(y,m);var z=Is,ce=Ec(m.containerInfo),ke=z.focusedElem,Qe=z.selectionRange;if(ce!==ke&&ke&&ke.ownerDocument&&Zl(ke.ownerDocument.documentElement,ke)){if(Qe!==null&&cl(ke)){var kt=Qe.start,Kt=Qe.end;if(Kt===void 0&&(Kt=kt),"selectionStart"in ke)ke.selectionStart=kt,ke.selectionEnd=Math.min(Kt,ke.value.length);else{var tn=ke.ownerDocument||document,Lt=tn&&tn.defaultView||window;if(Lt.getSelection){var Pt=Lt.getSelection(),Jn=ke.textContent.length,Os=Math.min(Qe.start,Jn),na=Qe.end===void 0?Os:Math.min(Qe.end,Jn);!Pt.extend&&Os>na&&(ce=na,na=Os,Os=ce);var mt=sf(ke,Os),ot=sf(ke,na);if(mt&&ot&&(Pt.rangeCount!==1||Pt.anchorNode!==mt.node||Pt.anchorOffset!==mt.offset||Pt.focusNode!==ot.node||Pt.focusOffset!==ot.offset)){var Tt=tn.createRange();Tt.setStart(mt.node,mt.offset),Pt.removeAllRanges(),Os>na?(Pt.addRange(Tt),Pt.extend(ot.node,ot.offset)):(Tt.setEnd(ot.node,ot.offset),Pt.addRange(Tt))}}}}for(tn=[],Pt=ke;Pt=Pt.parentNode;)Pt.nodeType===1&&tn.push({element:Pt,left:Pt.scrollLeft,top:Pt.scrollTop});for(typeof ke.focus=="function"&&ke.focus(),ke=0;ke<tn.length;ke++){var Jt=tn[ke];Jt.element.scrollLeft=Jt.left,Jt.element.scrollTop=Jt.top}}tI=!!Ln,Is=Ln=null}finally{ti=O,te.p=T,q.T=_}}m.current=y,Io=2}}function yC(){if(Io===2){Io=0;var m=Rh,y=og,_=(y.flags&8772)!==0;if((y.subtreeFlags&8772)!==0||_){_=q.T,q.T=null;var T=te.p;te.p=2;var O=ti;ti|=4;try{LE(m,y.alternate,y)}finally{ti=O,te.p=T,q.T=_}}Io=3}}function bC(){if(Io===4||Io===3){Io=0,dt();var m=Rh,y=og,_=rr,T=PE;(y.subtreeFlags&10256)!==0||(y.flags&10256)!==0?Io=5:(Io=0,og=Rh=null,wC(m,m.pendingLanes));var O=m.pendingLanes;if(O===0&&(Jf=null),Oe(_),y=y.stateNode,En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(yn,y,void 0,(y.current.flags&128)===128)}catch{}if(T!==null){y=q.T,O=te.p,te.p=2,q.T=null;try{for(var z=m.onRecoverableError,ce=0;ce<T.length;ce++){var ke=T[ce];z(ke.value,{componentStack:ke.stack})}}finally{q.T=y,te.p=O}}(rr&3)!==0&&cy(),qd(m),O=m.pendingLanes,(_&261930)!==0&&(O&42)!==0?m===iy?ry++:(ry=0,iy=m):ry=0,uy(0)}}function wC(m,y){(m.pooledCacheLanes&=y)===0&&(y=m.pooledCache,y!=null&&(m.pooledCache=null,Pp(y)))}function cy(){return FE(),yC(),bC(),vC()}function vC(){if(Io!==5)return!1;var m=Rh,y=iC;iC=0;var _=Oe(rr),T=q.T,O=te.p;try{te.p=32>_?32:_,q.T=null,_=aC,aC=null;var z=Rh,ce=rr;if(Io=0,og=Rh=null,rr=0,(ti&6)!==0)throw Error(s(331));var ke=ti;if(ti|=4,nC(z.current),Z1(z,z.current,ce,_),ti=ke,uy(0,!1),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(yn,z)}catch{}return!0}finally{te.p=O,q.T=T,wC(m,y)}}function _C(m,y,_){y=Nc(_,y),y=Nw(m.stateNode,y,2),m=Vs(m,y,2),m!==null&&(Fn(m,2),qd(m))}function Ei(m,y,_){if(m.tag===3)_C(m,m,_);else for(;y!==null;){if(y.tag===3){_C(y,m,_);break}else if(y.tag===1){var T=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(Jf===null||!Jf.has(T))){m=Nc(_,m),_=Ax(2),T=Vs(y,_,2),T!==null&&(Lx(_,T,y,m),Fn(T,2),qd(T));break}}y=y.return}}function tv(m,y,_){var T=m.pingCache;if(T===null){T=m.pingCache=new OE;var O=new Set;T.set(y,O)}else O=T.get(y),O===void 0&&(O=new Set,T.set(y,O));O.has(_)||(Kw=!0,O.add(_),m=NP.bind(null,m,y,_),y.then(m,m))}function NP(m,y,_){var T=m.pingCache;T!==null&&T.delete(y),m.pingedLanes|=m.suspendedLanes&_,m.warmLanes&=~_,$i===m&&(br&_)===_&&($a===4||$a===3&&(br&62914560)===br&&300>Ft()-ty?(ti&2)===0&&Qp(m,0):Xw|=_,ag===br&&(ag=0)),qd(m)}function zE(m,y){y===0&&(y=ai()),m=rf(m,y),m!==null&&(Fn(m,y),qd(m))}function DP(m){var y=m.memoizedState,_=0;y!==null&&(_=y.retryLane),zE(m,_)}function OP(m,y){var _=0;switch(m.tag){case 31:case 13:var T=m.stateNode,O=m.memoizedState;O!==null&&(_=O.retryLane);break;case 19:T=m.stateNode;break;case 22:T=m.stateNode._retryCache;break;default:throw Error(s(314))}T!==null&&T.delete(y),zE(m,_)}function PP(m,y){return Ke(m,y)}var nv=null,C0=null,xC=!1,sv=!1,CC=!1,Jp=0;function qd(m){m!==C0&&m.next===null&&(C0===null?nv=C0=m:C0=C0.next=m),sv=!0,xC||(xC=!0,jP())}function uy(m,y){if(!CC&&sv){CC=!0;do for(var _=!1,T=nv;T!==null;){if(m!==0){var O=T.pendingLanes;if(O===0)var z=0;else{var ce=T.suspendedLanes,ke=T.pingedLanes;z=(1<<31-Nn(42|m)+1)-1,z&=O&~(ce&~ke),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(_=!0,WE(T,z))}else z=br,z=Mt(T,T===$i?z:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(z&3)===0||sn(T,z)||(_=!0,WE(T,z));T=T.next}while(_);CC=!1}}function $P(){BE()}function BE(){sv=xC=!1;var m=0;Jp!==0&&is()&&(m=Jp);for(var y=Ft(),_=null,T=nv;T!==null;){var O=T.next,z=UE(T,y);z===0?(T.next=null,_===null?nv=O:_.next=O,O===null&&(C0=_)):(_=T,(m!==0||(z&3)!==0)&&(sv=!0)),T=O}Io!==0&&Io!==5||uy(m),Jp!==0&&(Jp=0)}function UE(m,y){for(var _=m.suspendedLanes,T=m.pingedLanes,O=m.expirationTimes,z=m.pendingLanes&-62914561;0<z;){var ce=31-Nn(z),ke=1<<ce,Qe=O[ce];Qe===-1?((ke&_)===0||(ke&T)!==0)&&(O[ce]=Tn(ke,y)):Qe<=y&&(m.expiredLanes|=ke),z&=~ke}if(y=$i,_=br,_=Mt(m,m===y?_:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),T=m.callbackNode,_===0||m===y&&(bi===2||bi===9)||m.cancelPendingCommit!==null)return T!==null&&T!==null&&Ze(T),m.callbackNode=null,m.callbackPriority=0;if((_&3)===0||sn(m,_)){if(y=_&-_,y===m.callbackPriority)return y;switch(T!==null&&Ze(T),Oe(_)){case 2:case 8:_=Gt;break;case 32:_=At;break;case 268435456:_=Qt;break;default:_=At}return T=VE.bind(null,m),_=Ke(_,T),m.callbackPriority=y,m.callbackNode=_,y}return T!==null&&T!==null&&Ze(T),m.callbackPriority=2,m.callbackNode=null,2}function VE(m,y){if(Io!==0&&Io!==5)return m.callbackNode=null,m.callbackPriority=0,null;var _=m.callbackNode;if(cy()&&m.callbackNode!==_)return null;var T=br;return T=Mt(m,m===$i?T:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),T===0?null:(lC(m,T,y),UE(m,Ft()),m.callbackNode!=null&&m.callbackNode===_?VE.bind(null,m):null)}function WE(m,y){if(cy())return null;lC(m,y,!0)}function jP(){fa(function(){(ti&6)!==0?Ke(Bt,$P):BE()})}function SC(){if(Jp===0){var m=N;m===0&&(m=ps,ps<<=1,(ps&261888)===0&&(ps=256)),Jp=m}return Jp}function GE(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:ls(""+m)}function HE(m,y){var _=y.ownerDocument.createElement("input");return _.name=y.name,_.value=y.value,m.id&&_.setAttribute("form",m.id),y.parentNode.insertBefore(_,y),m=new FormData(m),_.parentNode.removeChild(_),m}function RP(m,y,_,T,O){if(y==="submit"&&_&&_.stateNode===O){var z=GE((O[xn]||null).action),ce=T.submitter;ce&&(y=(y=ce[xn]||null)?GE(y.formAction):ce.getAttribute("formAction"),y!==null&&(z=y,ce=null));var ke=new Oi("action","action",null,T,O);m.push({event:ke,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(Jp!==0){var Qe=ce?HE(O,ce):new FormData(O);Cw(_,{pending:!0,data:Qe,method:O.method,action:z},null,Qe)}}else typeof z=="function"&&(ke.preventDefault(),Qe=ce?HE(O,ce):new FormData(O),Cw(_,{pending:!0,data:Qe,method:O.method,action:z},z,Qe))},currentTarget:O}]})}}for(var MC=0;MC<sr.length;MC++){var TC=sr[MC],FP=TC.toLowerCase(),zP=TC[0].toUpperCase()+TC.slice(1);zr(FP,"on"+zP)}zr(Le,"onAnimationEnd"),zr(rt,"onAnimationIteration"),zr($t,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(an,"onTransitionRun"),zr(vn,"onTransitionStart"),zr(Rn,"onTransitionCancel"),zr(Es,"onTransitionEnd"),li("onMouseEnter",["mouseout","mouseover"]),li("onMouseLeave",["mouseout","mouseover"]),li("onPointerEnter",["pointerout","pointerover"]),li("onPointerLeave",["pointerout","pointerover"]),wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),wa("onBeforeInput",["compositionend","keypress","textInput","paste"]),wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BP=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fy));function qE(m,y){y=(y&4)!==0;for(var _=0;_<m.length;_++){var T=m[_],O=T.event;T=T.listeners;e:{var z=void 0;if(y)for(var ce=T.length-1;0<=ce;ce--){var ke=T[ce],Qe=ke.instance,kt=ke.currentTarget;if(ke=ke.listener,Qe!==z&&O.isPropagationStopped())break e;z=ke,O.currentTarget=kt;try{z(O)}catch(Kt){Lc(Kt)}O.currentTarget=null,z=Qe}else for(ce=0;ce<T.length;ce++){if(ke=T[ce],Qe=ke.instance,kt=ke.currentTarget,ke=ke.listener,Qe!==z&&O.isPropagationStopped())break e;z=ke,O.currentTarget=kt;try{z(O)}catch(Kt){Lc(Kt)}O.currentTarget=null,z=Qe}}}}function wr(m,y){var _=y[Gn];_===void 0&&(_=y[Gn]=new Set);var T=m+"__bubble";_.has(T)||(lo(y,m,2,!1),_.add(T))}function kC(m,y,_){var T=0;y&&(T|=4),lo(_,m,T,y)}var Ls="_reactListening"+Math.random().toString(36).slice(2);function rv(m){if(!m[Ls]){m[Ls]=!0,ka.forEach(function(_){_!=="selectionchange"&&(BP.has(_)||kC(_,!1,m),kC(_,!0,m))});var y=m.nodeType===9?m:m.ownerDocument;y===null||y[Ls]||(y[Ls]=!0,kC("selectionchange",!1,y))}}function lo(m,y,_,T){switch(P7(y)){case 2:var O=U0e;break;case 8:O=V0e;break;default:O=QP}_=O.bind(null,y,_,m),O=void 0,!Qr||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(O=!0),T?O!==void 0?m.addEventListener(y,_,{capture:!0,passive:O}):m.addEventListener(y,_,!0):O!==void 0?m.addEventListener(y,_,{passive:O}):m.addEventListener(y,_,!1)}function co(m,y,_,T,O){var z=T;if((y&1)===0&&(y&2)===0&&T!==null)e:for(;;){if(T===null)return;var ce=T.tag;if(ce===3||ce===4){var ke=T.stateNode.containerInfo;if(ke===O)break;if(ce===4)for(ce=T.return;ce!==null;){var Qe=ce.tag;if((Qe===3||Qe===4)&&ce.stateNode.containerInfo===O)return;ce=ce.return}for(;ke!==null;){if(ce=Cr(ke),ce===null)return;if(Qe=ce.tag,Qe===5||Qe===6||Qe===26||Qe===27){T=z=ce;continue e}ke=ke.parentNode}}T=T.return}Ml(function(){var kt=z,Kt=Ci(_),tn=[];e:{var Lt=Js.get(m);if(Lt!==void 0){var Pt=Oi,Jn=m;switch(m){case"keypress":if(aa(_)===0)break e;case"keydown":case"keyup":Pt=pr;break;case"focusin":Jn="focus",Pt=Kc;break;case"focusout":Jn="blur",Pt=Kc;break;case"beforeblur":case"afterblur":Pt=Kc;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pt=Nd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pt=Yc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pt=Ea;break;case Le:case rt:case $t:Pt=Y;break;case Es:Pt=_a;break;case"scroll":case"scrollend":Pt=Tl;break;case"wheel":Pt=ol;break;case"copy":case"cut":case"paste":Pt=Fe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pt=Ki;break;case"toggle":case"beforetoggle":Pt=Dd}var Os=(y&4)!==0,na=!Os&&(m==="scroll"||m==="scrollend"),mt=Os?Lt!==null?Lt+"Capture":null:Lt;Os=[];for(var ot=kt,Tt;ot!==null;){var Jt=ot;if(Tt=Jt.stateNode,Jt=Jt.tag,Jt!==5&&Jt!==26&&Jt!==27||Tt===null||mt===null||(Jt=Fr(ot,mt),Jt!=null&&Os.push(uo(ot,Jt,Tt))),na)break;ot=ot.return}0<Os.length&&(Lt=new Pt(Lt,Jn,null,_,Kt),tn.push({event:Lt,listeners:Os}))}}if((y&7)===0){e:{if(Lt=m==="mouseover"||m==="pointerover",Pt=m==="mouseout"||m==="pointerout",Lt&&_!==Ar&&(Jn=_.relatedTarget||_.fromElement)&&(Cr(Jn)||Jn[un]))break e;if((Pt||Lt)&&(Lt=Kt.window===Kt?Kt:(Lt=Kt.ownerDocument)?Lt.defaultView||Lt.parentWindow:window,Pt?(Jn=_.relatedTarget||_.toElement,Pt=kt,Jn=Jn?Cr(Jn):null,Jn!==null&&(na=a(Jn),Os=Jn.tag,Jn!==na||Os!==5&&Os!==27&&Os!==6)&&(Jn=null)):(Pt=null,Jn=kt),Pt!==Jn)){if(Os=Nd,Jt="onMouseLeave",mt="onMouseEnter",ot="mouse",(m==="pointerout"||m==="pointerover")&&(Os=Ki,Jt="onPointerLeave",mt="onPointerEnter",ot="pointer"),na=Pt==null?Lt:sl(Pt),Tt=Jn==null?Lt:sl(Jn),Lt=new Os(Jt,ot+"leave",Pt,_,Kt),Lt.target=na,Lt.relatedTarget=Tt,Jt=null,Cr(Kt)===kt&&(Os=new Os(mt,ot+"enter",Jn,_,Kt),Os.target=Tt,Os.relatedTarget=na,Jt=Os),na=Jt,Pt&&Jn)t:{for(Os=UP,mt=Pt,ot=Jn,Tt=0,Jt=mt;Jt;Jt=Os(Jt))Tt++;Jt=0;for(var Ts=ot;Ts;Ts=Os(Ts))Jt++;for(;0<Tt-Jt;)mt=Os(mt),Tt--;for(;0<Jt-Tt;)ot=Os(ot),Jt--;for(;Tt--;){if(mt===ot||ot!==null&&mt===ot.alternate){Os=mt;break t}mt=Os(mt),ot=Os(ot)}Os=null}else Os=null;Pt!==null&&EC(tn,Lt,Pt,Os,!1),Jn!==null&&na!==null&&EC(tn,na,Jn,Os,!0)}}e:{if(Lt=kt?sl(kt):window,Pt=Lt.nodeName&&Lt.nodeName.toLowerCase(),Pt==="select"||Pt==="input"&&Lt.type==="file")var wi=Mc;else if(Yl(Lt))if(vo)wi=ll;else{wi=Dr;var hs=Jc}else Pt=Lt.nodeName,!Pt||Pt.toLowerCase()!=="input"||Lt.type!=="checkbox"&&Lt.type!=="radio"?kt&&bn(kt.elementType)&&(wi=Mc):wi=nf;if(wi&&(wi=wi(m,kt))){zo(tn,wi,_,Kt);break e}hs&&hs(m,Lt,kt),m==="focusout"&&kt&&Lt.type==="number"&&kt.memoizedProps.value!=null&&ft(Lt,"number",Lt.value)}switch(hs=kt?sl(kt):window,m){case"focusin":(Yl(hs)||hs.contentEditable==="true")&&(_o=hs,Ac=kt,Na=null);break;case"focusout":Na=Ac=_o=null;break;case"mousedown":ul=!0;break;case"contextmenu":case"mouseup":case"dragend":ul=!1,yr(tn,_,Kt);break;case"selectionchange":if(Ic)break;case"keydown":case"keyup":yr(tn,_,Kt)}var ur;if(_c)e:{switch(m){case"compositionstart":var Br="onCompositionStart";break e;case"compositionend":Br="onCompositionEnd";break e;case"compositionupdate":Br="onCompositionUpdate";break e}Br=void 0}else El?Cc(m,_)&&(Br="onCompositionEnd"):m==="keydown"&&_.keyCode===229&&(Br="onCompositionStart");Br&&(xc&&_.locale!=="ko"&&(El||Br!=="onCompositionStart"?Br==="onCompositionEnd"&&El&&(ur=Yi()):(Wr=Kt,io="value"in Wr?Wr.value:Wr.textContent,El=!0)),hs=Zf(kt,Br),0<hs.length&&(Br=new pt(Br,m,null,_,Kt),tn.push({event:Br,listeners:hs}),ur?Br.data=ur:(ur=$f(_),ur!==null&&(Br.data=ur)))),(ur=tf?Ia(m,_):ql(m,_))&&(Br=Zf(kt,"onBeforeInput"),0<Br.length&&(hs=new pt("onBeforeInput","beforeinput",null,_,Kt),tn.push({event:hs,listeners:Br}),hs.data=ur)),RP(tn,m,kt,_,Kt)}qE(tn,y)})}function uo(m,y,_){return{instance:m,listener:y,currentTarget:_}}function Zf(m,y){for(var _=y+"Capture",T=[];m!==null;){var O=m,z=O.stateNode;if(O=O.tag,O!==5&&O!==26&&O!==27||z===null||(O=Fr(m,_),O!=null&&T.unshift(uo(m,O,z)),O=Fr(m,y),O!=null&&T.push(uo(m,O,z))),m.tag===3)return T;m=m.return}return[]}function UP(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function EC(m,y,_,T,O){for(var z=y._reactName,ce=[];_!==null&&_!==T;){var ke=_,Qe=ke.alternate,kt=ke.stateNode;if(ke=ke.tag,Qe!==null&&Qe===T)break;ke!==5&&ke!==26&&ke!==27||kt===null||(Qe=kt,O?(kt=Fr(_,z),kt!=null&&ce.unshift(uo(_,kt,Qe))):O||(kt=Fr(_,z),kt!=null&&ce.push(uo(_,kt,Qe)))),_=_.return}ce.length!==0&&m.push({event:y,listeners:ce})}var YE=/\r\n?/g,K=/\u0000|\uFFFD/g;function X(m){return(typeof m=="string"?m:""+m).replace(YE,`
`).replace(K,"")}function Ee(m,y){return y=X(y),X(m)===y}function qe(m,y,_,T,O,z){switch(_){case"children":typeof T=="string"?y==="body"||y==="textarea"&&T===""||Ve(m,T):(typeof T=="number"||typeof T=="bigint")&&y!=="body"&&Ve(m,""+T);break;case"className":bo(m,"class",T);break;case"tabIndex":bo(m,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":bo(m,_,T);break;case"style":wn(m,T,z);break;case"data":if(y!=="object"){bo(m,"data",T);break}case"src":case"href":if(T===""&&(y!=="a"||_!=="href")){m.removeAttribute(_);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){m.removeAttribute(_);break}T=ls(""+T),m.setAttribute(_,T);break;case"action":case"formAction":if(typeof T=="function"){m.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(_==="formAction"?(y!=="input"&&qe(m,y,"name",O.name,O,null),qe(m,y,"formEncType",O.formEncType,O,null),qe(m,y,"formMethod",O.formMethod,O,null),qe(m,y,"formTarget",O.formTarget,O,null)):(qe(m,y,"encType",O.encType,O,null),qe(m,y,"method",O.method,O,null),qe(m,y,"target",O.target,O,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){m.removeAttribute(_);break}T=ls(""+T),m.setAttribute(_,T);break;case"onClick":T!=null&&(m.onclick=ds);break;case"onScroll":T!=null&&wr("scroll",m);break;case"onScrollEnd":T!=null&&wr("scrollend",m);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(s(61));if(_=T.__html,_!=null){if(O.children!=null)throw Error(s(60));m.innerHTML=_}}break;case"multiple":m.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":m.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){m.removeAttribute("xlink:href");break}_=ls(""+T),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?m.setAttribute(_,""+T):m.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?m.setAttribute(_,""):m.removeAttribute(_);break;case"capture":case"download":T===!0?m.setAttribute(_,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?m.setAttribute(_,T):m.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?m.setAttribute(_,T):m.removeAttribute(_);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?m.removeAttribute(_):m.setAttribute(_,T);break;case"popover":wr("beforetoggle",m),wr("toggle",m),va(m,"popover",T);break;case"xlinkActuate":Wa(m,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":Wa(m,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":Wa(m,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":Wa(m,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":Wa(m,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":Wa(m,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":Wa(m,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":Wa(m,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":Wa(m,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":va(m,"is",T);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=_n.get(_)||_,va(m,_,T))}}function vt(m,y,_,T,O,z){switch(_){case"style":wn(m,T,z);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(s(61));if(_=T.__html,_!=null){if(O.children!=null)throw Error(s(60));m.innerHTML=_}}break;case"children":typeof T=="string"?Ve(m,T):(typeof T=="number"||typeof T=="bigint")&&Ve(m,""+T);break;case"onScroll":T!=null&&wr("scroll",m);break;case"onScrollEnd":T!=null&&wr("scrollend",m);break;case"onClick":T!=null&&(m.onclick=ds);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!oi.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(O=_.endsWith("Capture"),y=_.slice(2,O?_.length-7:void 0),z=m[xn]||null,z=z!=null?z[_]:null,typeof z=="function"&&m.removeEventListener(y,z,O),typeof T=="function")){typeof z!="function"&&z!==null&&(_ in m?m[_]=null:m.hasAttribute(_)&&m.removeAttribute(_)),m.addEventListener(y,T,O);break e}_ in m?m[_]=T:T===!0?m.setAttribute(_,""):va(m,_,T)}}}function yt(m,y,_){switch(y){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wr("error",m),wr("load",m);var T=!1,O=!1,z;for(z in _)if(_.hasOwnProperty(z)){var ce=_[z];if(ce!=null)switch(z){case"src":T=!0;break;case"srcSet":O=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,y));default:qe(m,y,z,ce,_,null)}}O&&qe(m,y,"srcSet",_.srcSet,_,null),T&&qe(m,y,"src",_.src,_,null);return;case"input":wr("invalid",m);var ke=z=ce=O=null,Qe=null,kt=null;for(T in _)if(_.hasOwnProperty(T)){var Kt=_[T];if(Kt!=null)switch(T){case"name":O=Kt;break;case"type":ce=Kt;break;case"checked":Qe=Kt;break;case"defaultChecked":kt=Kt;break;case"value":z=Kt;break;case"defaultValue":ke=Kt;break;case"children":case"dangerouslySetInnerHTML":if(Kt!=null)throw Error(s(137,y));break;default:qe(m,y,T,Kt,_,null)}}Of(m,z,ke,Qe,kt,ce,O,!1);return;case"select":wr("invalid",m),T=ce=z=null;for(O in _)if(_.hasOwnProperty(O)&&(ke=_[O],ke!=null))switch(O){case"value":z=ke;break;case"defaultValue":ce=ke;break;case"multiple":T=ke;default:qe(m,y,O,ke,_,null)}y=z,_=ce,m.multiple=!!T,y!=null?oe(m,!!T,y,!1):_!=null&&oe(m,!!T,_,!0);return;case"textarea":wr("invalid",m),z=O=T=null;for(ce in _)if(_.hasOwnProperty(ce)&&(ke=_[ce],ke!=null))switch(ce){case"value":T=ke;break;case"defaultValue":O=ke;break;case"children":z=ke;break;case"dangerouslySetInnerHTML":if(ke!=null)throw Error(s(91));break;default:qe(m,y,ce,ke,_,null)}Ue(m,T,O,z);return;case"option":for(Qe in _)_.hasOwnProperty(Qe)&&(T=_[Qe],T!=null)&&(Qe==="selected"?m.selected=T&&typeof T!="function"&&typeof T!="symbol":qe(m,y,Qe,T,_,null));return;case"dialog":wr("beforetoggle",m),wr("toggle",m),wr("cancel",m),wr("close",m);break;case"iframe":case"object":wr("load",m);break;case"video":case"audio":for(T=0;T<fy.length;T++)wr(fy[T],m);break;case"image":wr("error",m),wr("load",m);break;case"details":wr("toggle",m);break;case"embed":case"source":case"link":wr("error",m),wr("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(kt in _)if(_.hasOwnProperty(kt)&&(T=_[kt],T!=null))switch(kt){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,y));default:qe(m,y,kt,T,_,null)}return;default:if(bn(y)){for(Kt in _)_.hasOwnProperty(Kt)&&(T=_[Kt],T!==void 0&&vt(m,y,Kt,T,_,void 0));return}}for(ke in _)_.hasOwnProperty(ke)&&(T=_[ke],T!=null&&qe(m,y,ke,T,_,null))}function Vt(m,y,_,T){switch(y){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var O=null,z=null,ce=null,ke=null,Qe=null,kt=null,Kt=null;for(Pt in _){var tn=_[Pt];if(_.hasOwnProperty(Pt)&&tn!=null)switch(Pt){case"checked":break;case"value":break;case"defaultValue":Qe=tn;default:T.hasOwnProperty(Pt)||qe(m,y,Pt,null,T,tn)}}for(var Lt in T){var Pt=T[Lt];if(tn=_[Lt],T.hasOwnProperty(Lt)&&(Pt!=null||tn!=null))switch(Lt){case"type":z=Pt;break;case"name":O=Pt;break;case"checked":kt=Pt;break;case"defaultChecked":Kt=Pt;break;case"value":ce=Pt;break;case"defaultValue":ke=Pt;break;case"children":case"dangerouslySetInnerHTML":if(Pt!=null)throw Error(s(137,y));break;default:Pt!==tn&&qe(m,y,Lt,Pt,T,tn)}}Gl(m,ce,ke,Qe,kt,Kt,z,O);return;case"select":Pt=ce=ke=Lt=null;for(z in _)if(Qe=_[z],_.hasOwnProperty(z)&&Qe!=null)switch(z){case"value":break;case"multiple":Pt=Qe;default:T.hasOwnProperty(z)||qe(m,y,z,null,T,Qe)}for(O in T)if(z=T[O],Qe=_[O],T.hasOwnProperty(O)&&(z!=null||Qe!=null))switch(O){case"value":Lt=z;break;case"defaultValue":ke=z;break;case"multiple":ce=z;default:z!==Qe&&qe(m,y,O,z,T,Qe)}y=ke,_=ce,T=Pt,Lt!=null?oe(m,!!_,Lt,!1):!!T!=!!_&&(y!=null?oe(m,!!_,y,!0):oe(m,!!_,_?[]:"",!1));return;case"textarea":Pt=Lt=null;for(ke in _)if(O=_[ke],_.hasOwnProperty(ke)&&O!=null&&!T.hasOwnProperty(ke))switch(ke){case"value":break;case"children":break;default:qe(m,y,ke,null,T,O)}for(ce in T)if(O=T[ce],z=_[ce],T.hasOwnProperty(ce)&&(O!=null||z!=null))switch(ce){case"value":Lt=O;break;case"defaultValue":Pt=O;break;case"children":break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(s(91));break;default:O!==z&&qe(m,y,ce,O,T,z)}Ne(m,Lt,Pt);return;case"option":for(var Jn in _)Lt=_[Jn],_.hasOwnProperty(Jn)&&Lt!=null&&!T.hasOwnProperty(Jn)&&(Jn==="selected"?m.selected=!1:qe(m,y,Jn,null,T,Lt));for(Qe in T)Lt=T[Qe],Pt=_[Qe],T.hasOwnProperty(Qe)&&Lt!==Pt&&(Lt!=null||Pt!=null)&&(Qe==="selected"?m.selected=Lt&&typeof Lt!="function"&&typeof Lt!="symbol":qe(m,y,Qe,Lt,T,Pt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Os in _)Lt=_[Os],_.hasOwnProperty(Os)&&Lt!=null&&!T.hasOwnProperty(Os)&&qe(m,y,Os,null,T,Lt);for(kt in T)if(Lt=T[kt],Pt=_[kt],T.hasOwnProperty(kt)&&Lt!==Pt&&(Lt!=null||Pt!=null))switch(kt){case"children":case"dangerouslySetInnerHTML":if(Lt!=null)throw Error(s(137,y));break;default:qe(m,y,kt,Lt,T,Pt)}return;default:if(bn(y)){for(var na in _)Lt=_[na],_.hasOwnProperty(na)&&Lt!==void 0&&!T.hasOwnProperty(na)&&vt(m,y,na,void 0,T,Lt);for(Kt in T)Lt=T[Kt],Pt=_[Kt],!T.hasOwnProperty(Kt)||Lt===Pt||Lt===void 0&&Pt===void 0||vt(m,y,Kt,Lt,T,Pt);return}}for(var mt in _)Lt=_[mt],_.hasOwnProperty(mt)&&Lt!=null&&!T.hasOwnProperty(mt)&&qe(m,y,mt,null,T,Lt);for(tn in T)Lt=T[tn],Pt=_[tn],!T.hasOwnProperty(tn)||Lt===Pt||Lt==null&&Pt==null||qe(m,y,tn,Lt,T,Pt)}function on(m){switch(m){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function gn(){if(typeof performance.getEntriesByType=="function"){for(var m=0,y=0,_=performance.getEntriesByType("resource"),T=0;T<_.length;T++){var O=_[T],z=O.transferSize,ce=O.initiatorType,ke=O.duration;if(z&&ke&&on(ce)){for(ce=0,ke=O.responseEnd,T+=1;T<_.length;T++){var Qe=_[T],kt=Qe.startTime;if(kt>ke)break;var Kt=Qe.transferSize,tn=Qe.initiatorType;Kt&&on(tn)&&(Qe=Qe.responseEnd,ce+=Kt*(Qe<ke?1:(ke-kt)/(Qe-kt)))}if(--T,y+=8*(z+ce)/(O.duration/1e3),m++,10<m)break}}if(0<m)return y/m/1e6}return navigator.connection&&(m=navigator.connection.downlink,typeof m=="number")?m:5}var Ln=null,Is=null;function Ms(m){return m.nodeType===9?m:m.ownerDocument}function Ps(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ss(m,y){if(m===0)switch(y){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&y==="foreignObject"?0:m}function vr(m,y){return m==="textarea"||m==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.children=="bigint"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var rs=null;function is(){var m=window.event;return m&&m.type==="popstate"?m===rs?!1:(rs=m,!0):(rs=null,!1)}var cr=typeof setTimeout=="function"?setTimeout:void 0,ni=typeof clearTimeout=="function"?clearTimeout:void 0,Bi=typeof Promise=="function"?Promise:void 0,fa=typeof queueMicrotask=="function"?queueMicrotask:typeof Bi<"u"?function(m){return Bi.resolve(null).then(m).catch(ja)}:cr;function ja(m){setTimeout(function(){throw m})}function Ii(m){return m==="head"}function qs(m,y){var _=y,T=0;do{var O=_.nextSibling;if(m.removeChild(_),O&&O.nodeType===8)if(_=O.data,_==="/$"||_==="/&"){if(T===0){m.removeChild(O),lv(y);return}T--}else if(_==="$"||_==="$?"||_==="$~"||_==="$!"||_==="&")T++;else if(_==="html")ed(m.ownerDocument.documentElement);else if(_==="head"){_=m.ownerDocument.head,ed(_);for(var z=_.firstChild;z;){var ce=z.nextSibling,ke=z.nodeName;z[Vr]||ke==="SCRIPT"||ke==="STYLE"||ke==="LINK"&&z.rel.toLowerCase()==="stylesheet"||_.removeChild(z),z=ce}}else _==="body"&&ed(m.ownerDocument.body);_=O}while(_);lv(y)}function da(m,y){var _=m;m=0;do{var T=_.nextSibling;if(_.nodeType===1?y?(_._stashedDisplay=_.style.display,_.style.display="none"):(_.style.display=_._stashedDisplay||"",_.getAttribute("style")===""&&_.removeAttribute("style")):_.nodeType===3&&(y?(_._stashedText=_.nodeValue,_.nodeValue=""):_.nodeValue=_._stashedText||""),T&&T.nodeType===8)if(_=T.data,_==="/$"){if(m===0)break;m--}else _!=="$"&&_!=="$?"&&_!=="$~"&&_!=="$!"||m++;_=T}while(_)}function fo(m){var y=m.firstChild;for(y&&y.nodeType===10&&(y=y.nextSibling);y;){var _=y;switch(y=y.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":fo(_),Yr(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}m.removeChild(_)}}function cg(m,y,_,T){for(;m.nodeType===1;){var O=_;if(m.nodeName.toLowerCase()!==y.toLowerCase()){if(!T&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(T){if(!m[Vr])switch(y){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(z=m.getAttribute("rel"),z==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(z!==O.rel||m.getAttribute("href")!==(O.href==null||O.href===""?null:O.href)||m.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin)||m.getAttribute("title")!==(O.title==null?null:O.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(z=m.getAttribute("src"),(z!==(O.src==null?null:O.src)||m.getAttribute("type")!==(O.type==null?null:O.type)||m.getAttribute("crossorigin")!==(O.crossOrigin==null?null:O.crossOrigin))&&z&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(y==="input"&&m.type==="hidden"){var z=O.name==null?null:""+O.name;if(O.type==="hidden"&&m.getAttribute("name")===z)return m}else return m;if(m=nc(m.nextSibling),m===null)break}return null}function Bc(m,y,_){if(y==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!_||(m=nc(m.nextSibling),m===null))return null;return m}function gf(m,y){for(;m.nodeType!==8;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!y||(m=nc(m.nextSibling),m===null))return null;return m}function Zp(m){return m.data==="$?"||m.data==="$~"}function em(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState!=="loading"}function iv(m,y){var _=m.ownerDocument;if(m.data==="$~")m._reactRetry=y;else if(m.data!=="$?"||_.readyState!=="loading")y();else{var T=function(){y(),_.removeEventListener("DOMContentLoaded",T)};_.addEventListener("DOMContentLoaded",T),m._reactRetry=T}}function nc(m){for(;m!=null;m=m.nextSibling){var y=m.nodeType;if(y===1||y===3)break;if(y===8){if(y=m.data,y==="$"||y==="$!"||y==="$?"||y==="$~"||y==="&"||y==="F!"||y==="F")break;if(y==="/$"||y==="/&")return null}}return m}var IC=null;function Ui(m){m=m.nextSibling;for(var y=0;m;){if(m.nodeType===8){var _=m.data;if(_==="/$"||_==="/&"){if(y===0)return nc(m.nextSibling);y--}else _!=="$"&&_!=="$!"&&_!=="$?"&&_!=="$~"&&_!=="&"||y++}m=m.nextSibling}return null}function ho(m){m=m.previousSibling;for(var y=0;m;){if(m.nodeType===8){var _=m.data;if(_==="$"||_==="$!"||_==="$?"||_==="$~"||_==="&"){if(y===0)return m;y--}else _!=="/$"&&_!=="/&"||y++}m=m.previousSibling}return null}function Fh(m,y,_){switch(y=Ms(_),m){case"html":if(m=y.documentElement,!m)throw Error(s(452));return m;case"head":if(m=y.head,!m)throw Error(s(453));return m;case"body":if(m=y.body,!m)throw Error(s(454));return m;default:throw Error(s(451))}}function ed(m){for(var y=m.attributes;y.length;)m.removeAttributeNode(y[0]);Yr(m)}var Dl=new Map,dy=new Set;function S0(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var td=te.d;te.d={f:AC,r:VP,D:LC,C:KE,L:NC,m:av,X:GP,S:WP,M:HP};function AC(){var m=td.f(),y=ay();return m||y}function VP(m){var y=Kr(m);y!==null&&y.tag===5&&y.type==="form"?Sw(y):td.r(m)}var tm=typeof document>"u"?null:document;function hy(m,y,_){var T=tm;if(T&&typeof y=="string"&&y){var O=ci(y);O='link[rel="'+m+'"][href="'+O+'"]',typeof _=="string"&&(O+='[crossorigin="'+_+'"]'),dy.has(O)||(dy.add(O),m={rel:m,crossOrigin:_,href:y},T.querySelector(O)===null&&(y=T.createElement("link"),yt(y,"link",m),Xr(y),T.head.appendChild(y)))}}function LC(m){td.D(m),hy("dns-prefetch",m,null)}function KE(m,y){td.C(m,y),hy("preconnect",m,y)}function NC(m,y,_){td.L(m,y,_);var T=tm;if(T&&m&&y){var O='link[rel="preload"][as="'+ci(y)+'"]';y==="image"&&_&&_.imageSrcSet?(O+='[imagesrcset="'+ci(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(O+='[imagesizes="'+ci(_.imageSizes)+'"]')):O+='[href="'+ci(m)+'"]';var z=O;switch(y){case"style":z=sc(m);break;case"script":z=ov(m)}Dl.has(z)||(m=d({rel:"preload",href:y==="image"&&_&&_.imageSrcSet?void 0:m,as:y},_),Dl.set(z,m),T.querySelector(O)!==null||y==="style"&&T.querySelector(DC(z))||y==="script"&&T.querySelector(OC(z))||(y=T.createElement("link"),yt(y,"link",m),Xr(y),T.head.appendChild(y)))}}function av(m,y){td.m(m,y);var _=tm;if(_&&m){var T=y&&typeof y.as=="string"?y.as:"script",O='link[rel="modulepreload"][as="'+ci(T)+'"][href="'+ci(m)+'"]',z=O;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=ov(m)}if(!Dl.has(z)&&(m=d({rel:"modulepreload",href:m},y),Dl.set(z,m),_.querySelector(O)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(OC(z)))return}T=_.createElement("link"),yt(T,"link",m),Xr(T),_.head.appendChild(T)}}}function WP(m,y,_){td.S(m,y,_);var T=tm;if(T&&m){var O=Ni(T).hoistableStyles,z=sc(m);y=y||"default";var ce=O.get(z);if(!ce){var ke={loading:0,preload:null};if(ce=T.querySelector(DC(z)))ke.loading=5;else{m=d({rel:"stylesheet",href:m,"data-precedence":y},_),(_=Dl.get(z))&&qP(m,_);var Qe=ce=T.createElement("link");Xr(Qe),yt(Qe,"link",m),Qe._p=new Promise(function(kt,Kt){Qe.onload=kt,Qe.onerror=Kt}),Qe.addEventListener("load",function(){ke.loading|=1}),Qe.addEventListener("error",function(){ke.loading|=2}),ke.loading|=4,XE(ce,y,T)}ce={type:"stylesheet",instance:ce,count:1,state:ke},O.set(z,ce)}}}function GP(m,y){td.X(m,y);var _=tm;if(_&&m){var T=Ni(_).hoistableScripts,O=ov(m),z=T.get(O);z||(z=_.querySelector(OC(O)),z||(m=d({src:m,async:!0},y),(y=Dl.get(O))&&YP(m,y),z=_.createElement("script"),Xr(z),yt(z,"link",m),_.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},T.set(O,z))}}function HP(m,y){td.M(m,y);var _=tm;if(_&&m){var T=Ni(_).hoistableScripts,O=ov(m),z=T.get(O);z||(z=_.querySelector(OC(O)),z||(m=d({src:m,async:!0,type:"module"},y),(y=Dl.get(O))&&YP(m,y),z=_.createElement("script"),Xr(z),yt(z,"link",m),_.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},T.set(O,z))}}function nm(m,y,_,T){var O=(O=ue.current)?S0(O):null;if(!O)throw Error(s(446));switch(m){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(y=sc(_.href),_=Ni(O).hoistableStyles,T=_.get(y),T||(T={type:"style",instance:null,count:0,state:null},_.set(y,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){m=sc(_.href);var z=Ni(O).hoistableStyles,ce=z.get(m);if(ce||(O=O.ownerDocument||O,ce={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(m,ce),(z=O.querySelector(DC(m)))&&!z._p&&(ce.instance=z,ce.state.loading=5),Dl.has(m)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},Dl.set(m,_),z||$0e(O,m,_,ce.state))),y&&T===null)throw Error(s(528,""));return ce}if(y&&T!==null)throw Error(s(529,""));return null;case"script":return y=_.async,_=_.src,typeof _=="string"&&y&&typeof y!="function"&&typeof y!="symbol"?(y=ov(_),_=Ni(O).hoistableScripts,T=_.get(y),T||(T={type:"script",instance:null,count:0,state:null},_.set(y,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,m))}}function sc(m){return'href="'+ci(m)+'"'}function DC(m){return'link[rel="stylesheet"]['+m+"]"}function S7(m){return d({},m,{"data-precedence":m.precedence,precedence:null})}function $0e(m,y,_,T){m.querySelector('link[rel="preload"][as="style"]['+y+"]")?T.loading=1:(y=m.createElement("link"),T.preload=y,y.addEventListener("load",function(){return T.loading|=1}),y.addEventListener("error",function(){return T.loading|=2}),yt(y,"link",_),Xr(y),m.head.appendChild(y))}function ov(m){return'[src="'+ci(m)+'"]'}function OC(m){return"script[async]"+m}function M7(m,y,_){if(y.count++,y.instance===null)switch(y.type){case"style":var T=m.querySelector('style[data-href~="'+ci(_.href)+'"]');if(T)return y.instance=T,Xr(T),T;var O=d({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return T=(m.ownerDocument||m).createElement("style"),Xr(T),yt(T,"style",O),XE(T,_.precedence,m),y.instance=T;case"stylesheet":O=sc(_.href);var z=m.querySelector(DC(O));if(z)return y.state.loading|=4,y.instance=z,Xr(z),z;T=S7(_),(O=Dl.get(O))&&qP(T,O),z=(m.ownerDocument||m).createElement("link"),Xr(z);var ce=z;return ce._p=new Promise(function(ke,Qe){ce.onload=ke,ce.onerror=Qe}),yt(z,"link",T),y.state.loading|=4,XE(z,_.precedence,m),y.instance=z;case"script":return z=ov(_.src),(O=m.querySelector(OC(z)))?(y.instance=O,Xr(O),O):(T=_,(O=Dl.get(z))&&(T=d({},_),YP(T,O)),m=m.ownerDocument||m,O=m.createElement("script"),Xr(O),yt(O,"link",T),m.head.appendChild(O),y.instance=O);case"void":return null;default:throw Error(s(443,y.type))}else y.type==="stylesheet"&&(y.state.loading&4)===0&&(T=y.instance,y.state.loading|=4,XE(T,_.precedence,m));return y.instance}function XE(m,y,_){for(var T=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),O=T.length?T[T.length-1]:null,z=O,ce=0;ce<T.length;ce++){var ke=T[ce];if(ke.dataset.precedence===y)z=ke;else if(z!==O)break}z?z.parentNode.insertBefore(m,z.nextSibling):(y=_.nodeType===9?_.head:_,y.insertBefore(m,y.firstChild))}function qP(m,y){m.crossOrigin==null&&(m.crossOrigin=y.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=y.referrerPolicy),m.title==null&&(m.title=y.title)}function YP(m,y){m.crossOrigin==null&&(m.crossOrigin=y.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=y.referrerPolicy),m.integrity==null&&(m.integrity=y.integrity)}var QE=null;function T7(m,y,_){if(QE===null){var T=new Map,O=QE=new Map;O.set(_,T)}else O=QE,T=O.get(_),T||(T=new Map,O.set(_,T));if(T.has(m))return T;for(T.set(m,null),_=_.getElementsByTagName(m),O=0;O<_.length;O++){var z=_[O];if(!(z[Vr]||z[rn]||m==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var ce=z.getAttribute(y)||"";ce=m+ce;var ke=T.get(ce);ke?ke.push(z):T.set(ce,[z])}}return T}function k7(m,y,_){m=m.ownerDocument||m,m.head.insertBefore(_,y==="title"?m.querySelector("head > title"):null)}function j0e(m,y,_){if(_===1||y.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof y.precedence!="string"||typeof y.href!="string"||y.href==="")break;return!0;case"link":if(typeof y.rel!="string"||typeof y.href!="string"||y.href===""||y.onLoad||y.onError)break;return y.rel==="stylesheet"?(m=y.disabled,typeof y.precedence=="string"&&m==null):!0;case"script":if(y.async&&typeof y.async!="function"&&typeof y.async!="symbol"&&!y.onLoad&&!y.onError&&y.src&&typeof y.src=="string")return!0}return!1}function E7(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}function R0e(m,y,_,T){if(_.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&(_.state.loading&4)===0){if(_.instance===null){var O=sc(T.href),z=y.querySelector(DC(O));if(z){y=z._p,y!==null&&typeof y=="object"&&typeof y.then=="function"&&(m.count++,m=JE.bind(m),y.then(m,m)),_.state.loading|=4,_.instance=z,Xr(z);return}z=y.ownerDocument||y,T=S7(T),(O=Dl.get(O))&&qP(T,O),z=z.createElement("link"),Xr(z);var ce=z;ce._p=new Promise(function(ke,Qe){ce.onload=ke,ce.onerror=Qe}),yt(z,"link",T),_.instance=z}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(_,y),(y=_.state.preload)&&(_.state.loading&3)===0&&(m.count++,_=JE.bind(m),y.addEventListener("load",_),y.addEventListener("error",_))}}var KP=0;function F0e(m,y){return m.stylesheets&&m.count===0&&eI(m,m.stylesheets),0<m.count||0<m.imgCount?function(_){var T=setTimeout(function(){if(m.stylesheets&&eI(m,m.stylesheets),m.unsuspend){var z=m.unsuspend;m.unsuspend=null,z()}},6e4+y);0<m.imgBytes&&KP===0&&(KP=62500*gn());var O=setTimeout(function(){if(m.waitingForImages=!1,m.count===0&&(m.stylesheets&&eI(m,m.stylesheets),m.unsuspend)){var z=m.unsuspend;m.unsuspend=null,z()}},(m.imgBytes>KP?50:800)+y);return m.unsuspend=_,function(){m.unsuspend=null,clearTimeout(T),clearTimeout(O)}}:null}function JE(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)eI(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var ZE=null;function eI(m,y){m.stylesheets=null,m.unsuspend!==null&&(m.count++,ZE=new Map,y.forEach(z0e,m),ZE=null,JE.call(m))}function z0e(m,y){if(!(y.state.loading&4)){var _=ZE.get(m);if(_)var T=_.get(null);else{_=new Map,ZE.set(m,_);for(var O=m.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<O.length;z++){var ce=O[z];(ce.nodeName==="LINK"||ce.getAttribute("media")!=="not all")&&(_.set(ce.dataset.precedence,ce),T=ce)}T&&_.set(null,T)}O=y.instance,ce=O.getAttribute("data-precedence"),z=_.get(ce)||T,z===T&&_.set(null,O),_.set(ce,O),this.count++,T=JE.bind(this),O.addEventListener("load",T),O.addEventListener("error",T),z?z.parentNode.insertBefore(O,z.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(O,m.firstChild)),y.state.loading|=4}}var PC={$$typeof:S,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function B0e(m,y,_,T,O,z,ce,ke,Qe){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ir(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ir(0),this.hiddenUpdates=ir(null),this.identifierPrefix=T,this.onUncaughtError=O,this.onCaughtError=z,this.onRecoverableError=ce,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Qe,this.incompleteTransitions=new Map}function I7(m,y,_,T,O,z,ce,ke,Qe,kt,Kt,tn){return m=new B0e(m,y,_,ce,Qe,kt,Kt,tn,ke),y=1,z===!0&&(y|=24),z=Uo(3,null,null,y),m.current=z,z.stateNode=m,y=Rd(),y.refCount++,m.pooledCache=y,y.refCount++,z.memoizedState={element:T,isDehydrated:_,cache:y},Sn(z),m}function A7(m){return m?(m=xo,m):xo}function L7(m,y,_,T,O,z){O=A7(O),T.context===null?T.context=O:T.pendingContext=O,T=Cs(y),T.payload={element:_},z=z===void 0?null:z,z!==null&&(T.callback=z),_=Vs(m,T,y),_!==null&&(zc(_,m,y),Zr(_,m,y))}function N7(m,y){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var _=m.retryLane;m.retryLane=_!==0&&_<y?_:y}}function XP(m,y){N7(m,y),(m=m.alternate)&&N7(m,y)}function D7(m){if(m.tag===13||m.tag===31){var y=rf(m,67108864);y!==null&&zc(y,m,67108864),XP(m,67108864)}}function O7(m){if(m.tag===13||m.tag===31){var y=su();y=ve(y);var _=rf(m,y);_!==null&&zc(_,m,y),XP(m,y)}}var tI=!0;function U0e(m,y,_,T){var O=q.T;q.T=null;var z=te.p;try{te.p=2,QP(m,y,_,T)}finally{te.p=z,q.T=O}}function V0e(m,y,_,T){var O=q.T;q.T=null;var z=te.p;try{te.p=8,QP(m,y,_,T)}finally{te.p=z,q.T=O}}function QP(m,y,_,T){if(tI){var O=JP(T);if(O===null)co(m,y,T,nI,_),$7(m,T);else if(G0e(O,m,y,_,T))T.stopPropagation();else if($7(m,T),y&4&&-1<W0e.indexOf(m)){for(;O!==null;){var z=Kr(O);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var ce=On(z.pendingLanes);if(ce!==0){var ke=z;for(ke.pendingLanes|=2,ke.entangledLanes|=2;ce;){var Qe=1<<31-Nn(ce);ke.entanglements[1]|=Qe,ce&=~Qe}qd(z),(ti&6)===0&&(ny=Ft()+500,uy(0))}}break;case 31:case 13:ke=rf(z,2),ke!==null&&zc(ke,z,2),ay(),XP(z,2)}if(z=JP(T),z===null&&co(m,y,T,nI,_),z===O)break;O=z}O!==null&&T.stopPropagation()}else co(m,y,T,null,_)}}function JP(m){return m=Ci(m),ZP(m)}var nI=null;function ZP(m){if(nI=null,m=Cr(m),m!==null){var y=a(m);if(y===null)m=null;else{var _=y.tag;if(_===13){if(m=o(y),m!==null)return m;m=null}else if(_===31){if(m=l(y),m!==null)return m;m=null}else if(_===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;m=null}else y!==m&&(m=null)}}return nI=m,null}function P7(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(It()){case Bt:return 2;case Gt:return 8;case At:case ht:return 32;case Qt:return 268435456;default:return 32}default:return 32}}var e3=!1,M0=null,T0=null,k0=null,$C=new Map,jC=new Map,E0=[],W0e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $7(m,y){switch(m){case"focusin":case"focusout":M0=null;break;case"dragenter":case"dragleave":T0=null;break;case"mouseover":case"mouseout":k0=null;break;case"pointerover":case"pointerout":$C.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":jC.delete(y.pointerId)}}function RC(m,y,_,T,O,z){return m===null||m.nativeEvent!==z?(m={blockedOn:y,domEventName:_,eventSystemFlags:T,nativeEvent:z,targetContainers:[O]},y!==null&&(y=Kr(y),y!==null&&D7(y)),m):(m.eventSystemFlags|=T,y=m.targetContainers,O!==null&&y.indexOf(O)===-1&&y.push(O),m)}function G0e(m,y,_,T,O){switch(y){case"focusin":return M0=RC(M0,m,y,_,T,O),!0;case"dragenter":return T0=RC(T0,m,y,_,T,O),!0;case"mouseover":return k0=RC(k0,m,y,_,T,O),!0;case"pointerover":var z=O.pointerId;return $C.set(z,RC($C.get(z)||null,m,y,_,T,O)),!0;case"gotpointercapture":return z=O.pointerId,jC.set(z,RC(jC.get(z)||null,m,y,_,T,O)),!0}return!1}function j7(m){var y=Cr(m.target);if(y!==null){var _=a(y);if(_!==null){if(y=_.tag,y===13){if(y=o(_),y!==null){m.blockedOn=y,ut(m.priority,function(){O7(_)});return}}else if(y===31){if(y=l(_),y!==null){m.blockedOn=y,ut(m.priority,function(){O7(_)});return}}else if(y===3&&_.stateNode.current.memoizedState.isDehydrated){m.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}m.blockedOn=null}function sI(m){if(m.blockedOn!==null)return!1;for(var y=m.targetContainers;0<y.length;){var _=JP(m.nativeEvent);if(_===null){_=m.nativeEvent;var T=new _.constructor(_.type,_);Ar=T,_.target.dispatchEvent(T),Ar=null}else return y=Kr(_),y!==null&&D7(y),m.blockedOn=_,!1;y.shift()}return!0}function R7(m,y,_){sI(m)&&_.delete(y)}function H0e(){e3=!1,M0!==null&&sI(M0)&&(M0=null),T0!==null&&sI(T0)&&(T0=null),k0!==null&&sI(k0)&&(k0=null),$C.forEach(R7),jC.forEach(R7)}function rI(m,y){m.blockedOn===y&&(m.blockedOn=null,e3||(e3=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,H0e)))}var iI=null;function F7(m){iI!==m&&(iI=m,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){iI===m&&(iI=null);for(var y=0;y<m.length;y+=3){var _=m[y],T=m[y+1],O=m[y+2];if(typeof T!="function"){if(ZP(T||_)===null)continue;break}var z=Kr(_);z!==null&&(m.splice(y,3),y-=3,Cw(z,{pending:!0,data:O,method:_.method,action:T},T,O))}}))}function lv(m){function y(Qe){return rI(Qe,m)}M0!==null&&rI(M0,m),T0!==null&&rI(T0,m),k0!==null&&rI(k0,m),$C.forEach(y),jC.forEach(y);for(var _=0;_<E0.length;_++){var T=E0[_];T.blockedOn===m&&(T.blockedOn=null)}for(;0<E0.length&&(_=E0[0],_.blockedOn===null);)j7(_),_.blockedOn===null&&E0.shift();if(_=(m.ownerDocument||m).$$reactFormReplay,_!=null)for(T=0;T<_.length;T+=3){var O=_[T],z=_[T+1],ce=O[xn]||null;if(typeof z=="function")ce||F7(_);else if(ce){var ke=null;if(z&&z.hasAttribute("formAction")){if(O=z,ce=z[xn]||null)ke=ce.formAction;else if(ZP(O)!==null)continue}else ke=ce.action;typeof ke=="function"?_[T+1]=ke:(_.splice(T,3),T-=3),F7(_)}}}function z7(){function m(z){z.canIntercept&&z.info==="react-transition"&&z.intercept({handler:function(){return new Promise(function(ce){return O=ce})},focusReset:"manual",scroll:"manual"})}function y(){O!==null&&(O(),O=null),T||setTimeout(_,20)}function _(){if(!T&&!navigation.transition){var z=navigation.currentEntry;z&&z.url!=null&&navigation.navigate(z.url,{state:z.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var T=!1,O=null;return navigation.addEventListener("navigate",m),navigation.addEventListener("navigatesuccess",y),navigation.addEventListener("navigateerror",y),setTimeout(_,100),function(){T=!0,navigation.removeEventListener("navigate",m),navigation.removeEventListener("navigatesuccess",y),navigation.removeEventListener("navigateerror",y),O!==null&&(O(),O=null)}}}function t3(m){this._internalRoot=m}aI.prototype.render=t3.prototype.render=function(m){var y=this._internalRoot;if(y===null)throw Error(s(409));var _=y.current,T=su();L7(_,T,m,y,null,null)},aI.prototype.unmount=t3.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var y=m.containerInfo;L7(m.current,2,null,m,null,null),ay(),y[un]=null}};function aI(m){this._internalRoot=m}aI.prototype.unstable_scheduleHydration=function(m){if(m){var y=ze();m={blockedOn:null,target:m,priority:y};for(var _=0;_<E0.length&&y!==0&&y<E0[_].priority;_++);E0.splice(_,0,m),_===0&&j7(m)}};var B7=e.version;if(B7!=="19.2.3")throw Error(s(527,B7,"19.2.3"));te.findDOMNode=function(m){var y=m._reactInternals;if(y===void 0)throw typeof m.render=="function"?Error(s(188)):(m=Object.keys(m).join(","),Error(s(268,m)));return m=u(y),m=m!==null?f(m):null,m=m===null?null:m.stateNode,m};var q0e={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oI=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oI.isDisabled&&oI.supportsFiber)try{yn=oI.inject(q0e),En=oI}catch{}}return zC.createRoot=function(m,y){if(!r(m))throw Error(s(299));var _=!1,T="",O=kx,z=Ex,ce=Ix;return y!=null&&(y.unstable_strictMode===!0&&(_=!0),y.identifierPrefix!==void 0&&(T=y.identifierPrefix),y.onUncaughtError!==void 0&&(O=y.onUncaughtError),y.onCaughtError!==void 0&&(z=y.onCaughtError),y.onRecoverableError!==void 0&&(ce=y.onRecoverableError)),y=I7(m,1,!1,null,null,_,T,null,O,z,ce,z7),m[un]=y.current,rv(m),new t3(y)},zC.hydrateRoot=function(m,y,_){if(!r(m))throw Error(s(299));var T=!1,O="",z=kx,ce=Ex,ke=Ix,Qe=null;return _!=null&&(_.unstable_strictMode===!0&&(T=!0),_.identifierPrefix!==void 0&&(O=_.identifierPrefix),_.onUncaughtError!==void 0&&(z=_.onUncaughtError),_.onCaughtError!==void 0&&(ce=_.onCaughtError),_.onRecoverableError!==void 0&&(ke=_.onRecoverableError),_.formState!==void 0&&(Qe=_.formState)),y=I7(m,1,!0,y,_??null,T,O,Qe,z,ce,ke,z7),y.context=A7(null),_=y.current,T=su(),T=ve(T),O=Cs(T),O.callback=null,Vs(_,O,T),_=T,y.current.lanes=_,Fn(y,_),qd(y),m[un]=y.current,rv(m),new aI(y)},zC.version="19.2.3",zC}var Q7;function i1e(){if(Q7)return r3.exports;Q7=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),r3.exports=r1e(),r3.exports}var a1e=i1e();const o1e=k2(a1e);function it(n,e,t){return(e=(function(s){var r=(function(a,o){if(typeof a!="object"||!a)return a;var l=a[Symbol.toPrimitive];if(l!==void 0){var c=l.call(a,o);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)})(s,"string");return typeof r=="symbol"?r:r+""})(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J7(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),t.push.apply(t,s)}return t}function lt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?J7(Object(t),!0).forEach((function(s){it(n,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):J7(Object(t)).forEach((function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))}))}return n}function Va(n,e){if(n==null)return{};var t,s,r=(function(o,l){if(o==null)return{};var c={};for(var u in o)if({}.hasOwnProperty.call(o,u)){if(l.indexOf(u)>=0)continue;c[u]=o[u]}return c})(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(s=0;s<a.length;s++)t=a[s],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function jm(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}let Z7=class{constructor(){it(this,"browserShadowBlurConstant",1),it(this,"DPI",96),it(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),it(this,"perfLimitSizeTotal",2097152),it(this,"maxCacheSideLimit",4096),it(this,"minCacheSideLimit",256),it(this,"disableStyleCopyPaste",!1),it(this,"enableGLFiltering",!0),it(this,"textureSize",4096),it(this,"forceGLPutImageData",!1),it(this,"cachesBoundsOfCurve",!1),it(this,"fontPaths",{}),it(this,"NUM_FRACTION_DIGITS",4)}};const fi=new class extends Z7{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=lt(lt({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((n=>{delete this.fontPaths[n]}))}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new Z7,t=n?.reduce(((s,r)=>(s[r]=e[r],s)),{})||e;this.configure(t)}},Lg=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return console[n]("fabric",...t)};let ym=class extends Error{constructor(e,t){super("fabric: ".concat(e),t)}},J6=class extends ym{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},l1e=class{},c1e=class extends l1e{testPrecision(e,t){const s="precision ".concat(t,` float;
void main(){}`),r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,s),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((s=>this.testPrecision(t,s))),t.getExtension("WEBGL_lose_context").loseContext(),Lg("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}};const u1e={};let eV;const Im=()=>eV||(eV={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new c1e,dispose(){},copyPasteData:u1e}),E2=()=>Im().document,I2=()=>Im().window,Dee=()=>{var n;return Math.max((n=fi.devicePixelRatio)!==null&&n!==void 0?n:I2().devicePixelRatio,1)},sM=new class{constructor(){it(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:s}=n;e=e.toLowerCase();const r=this.charWidthsCache;r.has(e)||r.set(e,new Map);const a=r.get(e),o="".concat(t.toLowerCase(),"_").concat((s+"").toLowerCase());return a.has(o)||a.set(o,new Map),a.get(o)}clearFontCache(n){n?this.charWidthsCache.delete((n||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(n){const{perfLimitSizeTotal:e}=fi,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},Tj="6.9.1";function Xy(){}const o1=Math.PI/2,Ng=2*Math.PI,Z6=Math.PI/180,Vu=Object.freeze([1,0,0,1,0,0]),eF=16,A0=.4477152502,Zs="center",Ri="left",Sf="top",kj="bottom",Ho="right",zu="none",tF=/\r?\n/,Oee="moving",g4="scaling",Pee="rotating",nF="rotate",$ee="skewing",CM="resizing",f1e="modifyPoly",d1e="modifyPath",VL="changed",y4="scale",Wu="scaleX",vd="scaleY",A2="skewX",L2="skewY",vl="fill",Bu="stroke",WL="modified",cv="json",l3="svg",Hn=new class{constructor(){this[cv]=new Map,this[l3]=new Map}has(n){return this[cv].has(n)}getClass(n){const e=this[cv].get(n);if(!e)throw new ym("No class registered for ".concat(n));return e}setClass(n,e){e?this[cv].set(e,n):(this[cv].set(n.type,n),this[cv].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[l3].get(n)}setSVGClass(n,e){this[l3].set(e??n.type.toLowerCase(),n)}},GL=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach((e=>e.abort())),n}cancelByCanvas(n){if(!n)return[];const e=this.filter((t=>{var s;return t.target===n||typeof t.target=="object"&&((s=t.target)===null||s===void 0?void 0:s.canvas)===n}));return e.forEach((t=>t.abort())),e}cancelByTarget(n){if(!n)return[];const e=this.filter((t=>t.target===n));return e.forEach((t=>t.abort())),e}};let h1e=class{constructor(){it(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach((s=>{let[r,a]=s;this.on(r,a)})),()=>this.off(e);if(t){const s=e;return this.__eventListeners[s]||(this.__eventListeners[s]=[]),this.__eventListeners[s].push(t),()=>this.off(s,t)}return()=>!1}once(e,t){if(typeof e=="object"){const s=[];return Object.entries(e).forEach((r=>{let[a,o]=r;s.push(this.once(a,o))})),()=>s.forEach((r=>r()))}if(t){const s=this.on(e,(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t.call(this,...a),s()}));return s}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const s=this.__eventListeners[e],r=s.indexOf(t);r>-1&&s.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const s in this.__eventListeners)this._removeEventListener(s);else typeof e=="object"?Object.entries(e).forEach((s=>{let[r,a]=s;this._removeEventListener(r,a)})):this._removeEventListener(e,t)}fire(e,t){var s;if(!this.__eventListeners)return;const r=(s=this.__eventListeners[e])===null||s===void 0?void 0:s.concat();if(r)for(let a=0;a<r.length;a++)r[a].call(this,t||{})}};const Oy=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},hp=n=>{if(n===0)return 1;switch(Math.abs(n)/o1){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},pp=n=>{if(n===0)return 0;const e=n/o1,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};let Dt=class Ou{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Ou(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Ou(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Ou(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Ou(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Ou(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Ou(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Ou(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Ou(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Ou(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,s=this.y-e.y;return Math.sqrt(t*t+s*s)}midPointFrom(e){return this.lerp(e)}min(e){return new Ou(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Ou(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,s=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=s}clone(){return new Ou(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sF;const s=pp(e),r=hp(e),a=this.subtract(t);return new Ou(a.x*r-a.y*s,a.x*s+a.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ou(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}};const sF=new Dt(0,0),nL=n=>!!n&&Array.isArray(n._objects);function jee(n){class e extends n{constructor(){super(...arguments),it(this,"_objects",[])}_onObjectAdded(s){}_onObjectRemoved(s){}_onStackOrderChanged(s){}add(){for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];const o=this._objects.push(...r);return r.forEach((l=>this._onObjectAdded(l))),o}insertAt(s){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return this._objects.splice(s,0,...a),a.forEach((l=>this._onObjectAdded(l))),this._objects.length}remove(){const s=this._objects,r=[];for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return o.forEach((c=>{const u=s.indexOf(c);u!==-1&&(s.splice(u,1),r.push(c),this._onObjectRemoved(c))})),r}forEachObject(s){this.getObjects().forEach(((r,a,o)=>s(r,a,o)))}getObjects(){for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return r.length===0?[...this._objects]:this._objects.filter((o=>o.isType(...r)))}item(s){return this._objects[s]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(s,r){return!!this._objects.includes(s)||!!r&&this._objects.some((a=>a instanceof e&&a.contains(s,!0)))}complexity(){return this._objects.reduce(((s,r)=>s+=r.complexity?r.complexity():0),0)}sendObjectToBack(s){return!(!s||s===this._objects[0])&&(Oy(this._objects,s),this._objects.unshift(s),this._onStackOrderChanged(s),!0)}bringObjectToFront(s){return!(!s||s===this._objects[this._objects.length-1])&&(Oy(this._objects,s),this._objects.push(s),this._onStackOrderChanged(s),!0)}sendObjectBackwards(s,r){if(!s)return!1;const a=this._objects.indexOf(s);if(a!==0){const o=this.findNewLowerIndex(s,a,r);return Oy(this._objects,s),this._objects.splice(o,0,s),this._onStackOrderChanged(s),!0}return!1}bringObjectForward(s,r){if(!s)return!1;const a=this._objects.indexOf(s);if(a!==this._objects.length-1){const o=this.findNewUpperIndex(s,a,r);return Oy(this._objects,s),this._objects.splice(o,0,s),this._onStackOrderChanged(s),!0}return!1}moveObjectTo(s,r){return s!==this._objects[r]&&(Oy(this._objects,s),this._objects.splice(r,0,s),this._onStackOrderChanged(s),!0)}findNewLowerIndex(s,r,a){let o;if(a){o=r;for(let l=r-1;l>=0;--l)if(s.isOverlapping(this._objects[l])){o=l;break}}else o=r-1;return o}findNewUpperIndex(s,r,a){let o;if(a){o=r;for(let l=r+1;l<this._objects.length;++l)if(s.isOverlapping(this._objects[l])){o=l;break}}else o=r+1;return o}collectObjects(s){let{left:r,top:a,width:o,height:l}=s,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const u=[],f=new Dt(r,a),d=f.add(new Dt(o,l));for(let h=this._objects.length-1;h>=0;h--){const p=this._objects[h];p.selectable&&p.visible&&(c&&p.intersectsWithRect(f,d)||p.isContainedWithinRect(f,d)||c&&p.containsPoint(f)||c&&p.containsPoint(d))&&u.push(p)}return u}}return e}let Ree=class extends h1e{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}};function rM(n){return I2().requestAnimationFrame(n)}function Fee(n){return I2().cancelAnimationFrame(n)}let p1e=0;const l1=()=>p1e++,Am=()=>{const n=E2().createElement("canvas");if(!n||n.getContext===void 0)throw new ym("Failed to create `canvas` element");return n},zee=()=>E2().createElement("img"),_d=n=>{const e=Am();return e.width=n.width,e.height=n.height,e},rF=(n,e,t)=>n.toDataURL("image/".concat(e),t),iF=(n,e,t)=>new Promise(((s,r)=>{n.toBlob(s,"image/".concat(e),t)})),Do=n=>n*Z6,Lm=n=>n/Z6,Bee=n=>n.every(((e,t)=>e===Vu[t])),du=(n,e,t)=>new Dt(n).transform(e,t),Cf=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:s,y:r}=new Dt(n[4],n[5]).transform(t,!0);return t[4]=-s,t[5]=-r,t},Qo=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],b4=(n,e)=>n.reduceRight(((t,s)=>s&&t?Qo(s,t,e):s||t),void 0)||Vu.concat(),Uee=n=>{let[e,t]=n;return Math.atan2(t,e)},lb=n=>{const e=Uee(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),s=Math.sqrt(t),r=(n[0]*n[3]-n[2]*n[1])/s,a=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:Lm(e),scaleX:s,scaleY:r,skewX:Lm(a),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},N2=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Rb(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=Do(n),r=hp(s),a=pp(s);return[r,a,-a,r,e?e-(r*e-a*t):0,t?t-(a*e+r*t):0]}const w4=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},Vee=n=>Math.tan(Do(n)),aF=n=>[1,0,Vee(n),1,0,0],oF=n=>[1,Vee(n),0,1,0,0],pT=n=>{let{scaleX:e=1,scaleY:t=1,flipX:s=!1,flipY:r=!1,skewX:a=0,skewY:o=0}=n,l=w4(s?-e:e,r?-t:t);return a&&(l=Qo(l,aF(a),!0)),o&&(l=Qo(l,oF(o),!0)),l},Wee=n=>{const{translateX:e=0,translateY:t=0,angle:s=0}=n;let r=N2(e,t);s&&(r=Qo(r,Rb({angle:s})));const a=pT(n);return Bee(a)||(r=Qo(r,a)),r},iM=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(s,r){if(e&&e.aborted)return r(new J6("loadImage"));const a=zee();let o;e&&(o=function(c){a.src="",r(c)},e.addEventListener("abort",o,{once:!0}));const l=function(){a.onload=a.onerror=null,o&&e?.removeEventListener("abort",o),s(a)};n?(a.onload=l,a.onerror=function(){o&&e?.removeEventListener("abort",o),r(new ym("Error loading ".concat(a.src)))},t&&(a.crossOrigin=t),a.src=n):l()}))},t2=function(n){let{signal:e,reviver:t=Xy}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((s,r)=>{const a=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(n.map((o=>Hn.getClass(o.type).fromObject(o,{signal:e}).then((l=>(t(o,l),a.push(l),l)))))).then(s).catch((o=>{a.forEach((l=>{l.dispose&&l.dispose()})),r(o)})).finally((()=>{e&&e.removeEventListener("abort",r)}))}))},mT=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((t,s)=>{const r=[];e&&e.addEventListener("abort",s,{once:!0});const a=Object.values(n).map((l=>l&&l.type&&Hn.has(l.type)?t2([l],{signal:e}).then((c=>{let[u]=c;return r.push(u),u})):l)),o=Object.keys(n);Promise.all(a).then((l=>l.reduce(((c,u,f)=>(c[o[f]]=u,c)),{}))).then(t).catch((l=>{r.forEach((c=>{c.dispose&&c.dispose()})),s(l)})).finally((()=>{e&&e.removeEventListener("abort",s)}))}))},Fb=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((e,t)=>(t in n&&(e[t]=n[t]),e)),{})},lF=(n,e)=>Object.keys(n).reduce(((t,s)=>(e(n[s],s,n)&&(t[s]=n[s]),t)),{}),ga=(n,e)=>parseFloat(Number(n).toFixed(e)),n2=n=>"matrix("+n.map((e=>ga(e,fi.NUM_FRACTION_DIGITS))).join(" ")+")",ah=n=>!!n&&n.toLive!==void 0,tV=n=>!!n&&typeof n.toObject=="function",nV=n=>!!n&&n.offsetX!==void 0&&"source"in n,Py=n=>!!n&&"multiSelectionStacking"in n;function Gee(n){const e=n&&np(n);let t=0,s=0;if(!n||!e)return{left:t,top:s};let r=n;const a=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;r&&(r.parentNode||r.host)&&(r=r.parentNode||r.host,r===e?(t=o.scrollLeft||a.scrollLeft||0,s=o.scrollTop||a.scrollTop||0):(t+=r.scrollLeft||0,s+=r.scrollTop||0),r.nodeType!==1||r.style.position!=="fixed"););return{left:t,top:s}}const np=n=>n.ownerDocument||null,Hee=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},qee=function(n,e,t){let{width:s,height:r}=t,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=s,n.height=r,a>1&&(n.setAttribute("width",(s*a).toString()),n.setAttribute("height",(r*a).toString()),e.scale(a,a))},Ej=(n,e)=>{let{width:t,height:s}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),s&&(n.style.height=typeof s=="number"?"".concat(s,"px"):s)};function sV(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=zu,n}let Yee=class{constructor(e){it(this,"_originalCanvasStyle",void 0),it(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(s=e)&&s.getContext!==void 0?e:e&&E2().getElementById(e)||Am();var s;if(t.hasAttribute("data-fabric"))throw new ym("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:s}=e;const{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width","".concat(t)),r.setAttribute("height","".concat(s)),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:s,ctx:r}=this.lower;qee(s,r,e,t)}setCSSDimensions(e){Ej(this.lower.el,e)}calcOffset(){return(function(e){var t;const s=e&&np(e),r={left:0,top:0};if(!s)return r;const a=((t=Hee(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};r.left+=parseInt(a.borderLeftWidth,10)||0,r.top+=parseInt(a.borderTopWidth,10)||0,r.left+=parseInt(a.paddingLeft,10)||0,r.top+=parseInt(a.paddingTop,10)||0;let o={left:0,top:0};const l=s.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const c=Gee(e);return{left:o.left+c.left-(l.clientLeft||0)+r.left,top:o.top+c.top-(l.clientTop||0)+r.top}})(this.lower.el)}dispose(){Im().dispose(this.lower.el),delete this.lower}};const m1e={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Vu]},g1e=["objects"];let cF=class Kee extends jee(Ree){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Kee.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new Yee(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];const a=super.insertAt(e,...s);return s.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),a}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Lg("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Dee():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:s=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const r=lt({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}s||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const s=e,r=[...this.viewportTransform],a=du(e,Cf(r));r[0]=t,r[3]=t;const o=du(a,r);r[4]+=s.x-o.x,r[5]+=s.y-o.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new Dt(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new Dt(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=rM((()=>this.renderAndReset())))}calcViewportBoundaries(){const e=this.width,t=this.height,s=Cf(this.viewportTransform),r=du({x:0,y:0},s),a=du({x:e,y:t},s),o=r.min(a),l=r.max(a);return this.vptCoords={tl:o,tr:new Dt(l.x,o.y),bl:new Dt(o.x,l.y),br:l}}cancelRequestedRender(){this.nextRenderHandle&&(Fee(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const s=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const s=this.viewportTransform;e.save(),e.transform(...s),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let s=0,r=t.length;s<r;++s)t[s]&&t[s].render(e)}_renderBackgroundOrOverlay(e,t){const s=this["".concat(t,"Color")],r=this["".concat(t,"Image")],a=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!s&&!r)return;const l=ah(s);if(s){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=l?s.toLive(e):s,o&&e.transform(...a),l){e.transform(1,0,0,1,s.offsetX||0,s.offsetY||0);const c=s.gradientTransform||s.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(r){e.save();const{skipOffscreen:c}=this;this.skipOffscreen=o,o&&e.transform(...a),r.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Dt(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Dt(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Dt(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Dt(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Dt(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return du(this.getCenterPoint(),Cf(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Zs,Zs),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const s=this.clipPath,r=s&&!s.excludeFromExport?this._toObject(s,e,t):null;return lt(lt(lt({version:Tj},Fb(this,t)),{},{objects:this._objects.filter((a=>!a.excludeFromExport)).map((a=>this._toObject(a,e,t)))},this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,s){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);const a=e[t](s);return this.includeDefaultValues||(e.includeDefaultValues=!!r),a}__serializeBgOverlay(e,t){const s={},r=this.backgroundImage,a=this.overlayImage,o=this.backgroundColor,l=this.overlayColor;return ah(o)?o.excludeFromExport||(s.background=o.toObject(t)):o&&(s.background=o),ah(l)?l.excludeFromExport||(s.overlay=l.toObject(t)):l&&(s.overlay=l),r&&!r.excludeFromExport&&(s.backgroundImage=this._toObject(r,e,t)),a&&!a.excludeFromExport&&(s.overlayImage=this._toObject(a,e,t)),s}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const s=[];return this._setSVGPreamble(s,e),this._setSVGHeader(s,e),this.clipPath&&s.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(s,"background"),this._setSVGBgOverlayImage(s,"backgroundImage",t),this._setSVGObjects(s,t),this.clipPath&&s.push(`</g>
`),this._setSVGBgOverlayColor(s,"overlay"),this._setSVGBgOverlayImage(s,"overlayImage",t),s.push("</svg>"),s.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const s=t.width||"".concat(this.width),r=t.height||"".concat(this.height),a=fi.NUM_FRACTION_DIGITS,o=t.viewBox;let l;if(o)l='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const c=this.viewportTransform;l='viewBox="'.concat(ga(-c[4]/c[0],a)," ").concat(ga(-c[5]/c[3],a)," ").concat(ga(this.width/c[0],a)," ").concat(ga(this.height/c[3],a),'" ')}else l='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',s,'" ','height="',r,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Tj,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(l1()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((e=>{const t=this["".concat(e,"Color")];if(ah(t)){const s=this["".concat(e,"Vpt")],r=this.viewportTransform,a={isType:()=>!1,width:this.width/(s?r[0]:1),height:this.height/(s?r[3]:1)};return t.toSVG(a,{additionalTransform:s?n2(r):""})}})).join("")}createSVGFontFacesMarkup(){const e=[],t={},s=fi.fontPaths;this._objects.forEach((function a(o){e.push(o),nL(o)&&o._objects.forEach(a)})),e.forEach((a=>{if(!(o=a)||typeof o._renderText!="function")return;var o;const{styles:l,fontFamily:c}=a;!t[c]&&s[c]&&(t[c]=!0,l&&Object.values(l).forEach((u=>{Object.values(u).forEach((f=>{let{fontFamily:d=""}=f;!t[d]&&s[d]&&(t[d]=!0)}))})))}));const r=Object.keys(t).map((a=>`		@font-face {
			font-family: '`.concat(a,`';
			src: url('`).concat(s[a],`');
		}
`))).join("");return r?`	<style type="text/css"><![CDATA[
`.concat(r,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject((s=>{s.excludeFromExport||this._setSVGObject(e,s,t)}))}_setSVGObject(e,t,s){e.push(t.toSVG(s))}_setSVGBgOverlayImage(e,t,s){const r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(s))}_setSVGBgOverlayColor(e,t){const s=this["".concat(t,"Color")];if(s)if(ah(s)){const r=s.repeat||"",a=this.width,o=this.height,l=this["".concat(t,"Vpt")]?n2(Cf(this.viewportTransform)):"";e.push('<rect transform="'.concat(l," translate(").concat(a/2,",").concat(o/2,')" x="').concat(s.offsetX-a/2,'" y="').concat(s.offsetY-o/2,'" width="').concat(r!=="repeat-y"&&r!=="no-repeat"||!nV(s)?a:s.source.width,'" height="').concat(r!=="repeat-x"&&r!=="no-repeat"||!nV(s)?o:s.source.height,'" fill="url(#SVGID_').concat(s.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',s,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:s}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new ym("`json` is undefined"));const r=typeof e=="string"?JSON.parse(e):e,{objects:a=[]}=r,o=Va(r,g1e),{backgroundImage:l,background:c,overlayImage:u,overlay:f,clipPath:d}=o,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([t2(a,{reviver:t,signal:s}),mT({backgroundImage:l,backgroundColor:c,overlayImage:u,overlayColor:f,clipPath:d},{signal:s})]).then((p=>{let[g,b]=p;return this.clear(),this.add(...g),this.set(o),this.set(b),this.renderOnAddRemove=h,this}))}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=_d(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:s=1,multiplier:r=1,enableRetinaScaling:a=!1}=e,o=r*(a?this.getRetinaScaling():1);return rF(this.toCanvasElement(o,e),t,s)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:s=1,multiplier:r=1,enableRetinaScaling:a=!1}=e,o=r*(a?this.getRetinaScaling():1);return iF(this.toCanvasElement(o,e),t,s)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:s,left:r,top:a,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=(t||this.width)*e,c=(s||this.height)*e,u=this.getZoom(),f=this.width,d=this.height,h=this.skipControlsDrawing,p=u*e,g=this.viewportTransform,b=[p,0,0,p,(g[4]-(r||0))*e,(g[5]-(a||0))*e],v=this.enableRetinaScaling,w=_d({width:l,height:c}),x=o?this._objects.filter((S=>o(S))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=b,this.width=l,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),x),this.viewportTransform=g,this.width=f,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=v,this.skipControlsDrawing=h,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),GL.cancelByCanvas(this),this.disposed=!0,new Promise(((e,t)=>{const s=()=>{this.destroy(),e(!0)};s.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=s:s()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((e=>e.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};it(cF,"ownDefaults",m1e);const y1e=["touchstart","touchmove","touchend"],Xee=n=>{const e=Gee(n.target),t=(function(s){const r=s.changedTouches;return r&&r[0]?r[0]:s})(n);return new Dt(t.clientX+e.left,t.clientY+e.top)},HL=n=>y1e.includes(n.type)||n.pointerType==="touch",rV=n=>{n.preventDefault(),n.stopPropagation()},_m=n=>{let e=0,t=0,s=0,r=0;for(let a=0,o=n.length;a<o;a++){const{x:l,y:c}=n[a];(l>s||!a)&&(s=l),(l<e||!a)&&(e=l),(c>r||!a)&&(r=c),(c<t||!a)&&(t=c)}return{left:e,top:t,width:s-e,height:r-t}},b1e=["translateX","translateY","scaleX","scaleY"],Qee=(n,e)=>s2(n,Qo(e,n.calcOwnMatrix())),s2=(n,e)=>{const t=lb(e),{translateX:s,translateY:r,scaleX:a,scaleY:o}=t,l=Va(t,b1e),c=new Dt(s,r);n.flipX=!1,n.flipY=!1,Object.assign(n,l),n.set({scaleX:a,scaleY:o}),n.setPositionByOrigin(c,Zs,Zs)},Jee=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},uF=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),v4=(n,e,t)=>{const s=n/2,r=e/2,a=[new Dt(-s,-r),new Dt(s,-r),new Dt(-s,r),new Dt(s,r)].map((l=>l.transform(t))),o=_m(a);return new Dt(o.width,o.height)},gT=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vu;return Qo(Cf(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vu),n)},Qy=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vu,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vu;return n.transform(gT(e,t))},Zee=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vu,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vu;return n.transform(gT(e,t),!0)},Ij=(n,e,t)=>{const s=gT(e,t);return s2(n,Qo(s,n.calcOwnMatrix())),s},ete=(n,e)=>{var t;const{transform:{target:s}}=e;(t=s.canvas)===null||t===void 0||t.fire("object:".concat(n),lt(lt({},e),{},{target:s})),s.fire(n,e)},w1e={left:-.5,top:-.5,center:0,bottom:.5,right:.5},ml=n=>typeof n=="string"?w1e[n]:n-.5,qL="not-allowed";function tte(n){return ml(n.originX)===ml(Zs)&&ml(n.originY)===ml(Zs)}function iV(n){return .5-ml(n)}const ap=(n,e)=>n[e],nte=(n,e,t,s)=>({e:n,transform:e,pointer:new Dt(t,s)});function ste(n,e){const t=n.getTotalAngle()+Lm(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function fF(n,e,t,s,r){var a;let{target:o,corner:l}=n;const c=o.controls[l],u=((a=o.canvas)===null||a===void 0?void 0:a.getZoom())||1,f=o.padding/u,d=(function(h,p,g,b){const v=h.getRelativeCenterPoint(),w=g!==void 0&&b!==void 0?h.translateToGivenOrigin(v,Zs,Zs,g,b):new Dt(h.left,h.top);return(h.angle?p.rotate(-Do(h.angle),v):p).subtract(w)})(o,new Dt(s,r),e,t);return d.x>=f&&(d.x-=f),d.x<=-f&&(d.x+=f),d.y>=f&&(d.y-=f),d.y<=f&&(d.y+=f),d.x-=c.offsetX,d.y-=c.offsetY,d}const v1e=(n,e,t,s)=>{const{target:r,offsetX:a,offsetY:o}=e,l=t-a,c=s-o,u=!ap(r,"lockMovementX")&&r.left!==l,f=!ap(r,"lockMovementY")&&r.top!==c;return u&&r.set(Ri,l),f&&r.set(Sf,c),(u||f)&&ete(Oee,nte(n,e,t,s)),u||f},YL=n=>n.replace(/\s+/g," "),aV={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},c3=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),oV=(n,e,t,s)=>{n/=255,e/=255,t/=255;const r=Math.max(n,e,t),a=Math.min(n,e,t);let o,l;const c=(r+a)/2;if(r===a)o=l=0;else{const u=r-a;switch(l=c>.5?u/(2-r-a):u/(r+a),r){case n:o=(e-t)/u+(e<t?6:0);break;case e:o=(t-n)/u+2;break;case t:o=(n-e)/u+4}o/=6}return[Math.round(360*o),Math.round(100*l),Math.round(100*c),s]},lV=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},lI=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),cV=n=>{let[e,t,s,r=1]=n;const a=Math.round(.3*e+.59*t+.11*s);return[a,a,a,r]};let kf=class cu{constructor(e){if(it(this,"isUnrecognised",!1),e)if(e instanceof cu)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,s,r,a=1]=e;this.setSource([t,s,r,a])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in aV&&(e=aV[e]),e==="transparent"?[255,255,255,0]:cu.sourceFromHex(e)||cu.sourceFromRgb(e)||cu.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,s]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(s,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,s]=oV(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(s,"%)")}toHsla(){const[e,t,s,r]=oV(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(s,"%,").concat(r,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,s,r]=this.getSource();return"".concat(lI(e)).concat(lI(t)).concat(lI(s)).concat(lI(Math.round(255*r)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(cV(this.getSource())),this}toBlackWhite(e){const[t,,,s]=cV(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,s]),this}overlayWith(e){e instanceof cu||(e=new cu(e));const t=this.getSource(),s=e.getSource(),[r,a,o]=t.map(((l,c)=>Math.round(.5*l+.5*s[c])));return this.setSource([r,a,o,t[3]]),this}static fromRgb(e){return cu.fromRgba(e)}static fromRgba(e){return new cu(cu.sourceFromRgb(e))}static sourceFromRgb(e){const t=YL(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){const[s,r,a]=t.slice(1,4).map((o=>{const l=parseFloat(o);return o.endsWith("%")?Math.round(2.55*l):l}));return[s,r,a,lV(t[4])]}}static fromHsl(e){return cu.fromHsla(e)}static fromHsla(e){return new cu(cu.sourceFromHsl(e))}static sourceFromHsl(e){const t=YL(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;const s=(cu.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,a=parseFloat(t[3])/100;let o,l,c;if(r===0)o=l=c=a;else{const u=a<=.5?a*(r+1):a+r-a*r,f=2*a-u;o=c3(f,u,s+1/3),l=c3(f,u,s),c=c3(f,u,s-1/3)}return[Math.round(255*o),Math.round(255*l),Math.round(255*c),lV(t[4])]}static fromHex(e){return new cu(cu.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let s;s=t.length<=4?t.split("").map((c=>c+c)):t.match(/.{2}/g);const[r,a,o,l=255]=s.map((c=>parseInt(c,16)));return[r,a,o,l/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),s=parseFloat(t);return t.includes("rad")?Lm(s):t.includes("turn")?360*s:s}};const $u=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eF;const t=/\D{0,2}$/.exec(n),s=parseFloat(n),r=fi.DPI;switch(t?.[0]){case"mm":return s*r/25.4;case"cm":return s*r/2.54;case"in":return s*r;case"pt":return s*r/72;case"pc":return s*r/72*12;case"em":return s*e;default:return s}},dF=n=>{const[e,t]=n.trim().split(" "),[s,r]=(a=e)&&a!==zu?[a.slice(1,4),a.slice(5,8)]:a===zu?[a,a]:["Mid","Mid"];var a;return{meetOrSlice:t||"meet",alignX:s,alignY:r}},SM=function(n,e){let t,s,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const a=new kf(e),o=a.getAlpha();t=a.toRgb(),o!==1&&(s=o.toString())}else t="none";return r?"".concat(n,": ").concat(t,"; ").concat(s?"".concat(n,"-opacity: ").concat(s,"; "):""):"".concat(n,'="').concat(t,'" ').concat(s?"".concat(n,'-opacity="').concat(s,'" '):"")};let rte=class{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",s=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):zu,a=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",u=this.opacity!==void 0?this.opacity:"1",f=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),h=SM(vl,this.fill);return[SM(Bu,this.stroke),"stroke-width: ",s,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",c,"; ",h,"fill-rule: ",t,"; ","opacity: ",u,";",d,f].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const s=e?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'.concat(n2(s));return"".concat(r).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:s=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=e.indexOf("COMMON_PARTS");return e[a]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:s,withShadow:r,additionalTransform:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),l=r?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",f=c&&c.absolutePositioned,d=this.stroke,h=this.fill,p=this.shadow,g=[],b=e.indexOf("COMMON_PARTS");let v;c&&(c.clipPathId="CLIPPATH_".concat(l1()),v='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(s),`</clipPath>
`)),f&&g.push("<g ",l,this.getSvgCommons(),` >
`),g.push("<g ",this.getSvgTransform(!1),f?"":l+this.getSvgCommons(),` >
`);const w=[o,u,t?"":this.addPaintOrder()," ",a?'transform="'.concat(a,'" '):""].join("");return e[b]=w,ah(h)&&g.push(h.toSVG(this)),ah(d)&&g.push(d.toSVG(this)),p&&g.push(p.toSVG(this)),c&&g.push(v),g.push(e.join("")),g.push(`</g>
`),f&&g.push(`</g>
`),s?s(g.join("")):g.join("")}addPaintOrder(){return this.paintFirst!==vl?' paint-order="'.concat(this.paintFirst,'" '):""}};function _4(n){return new RegExp("^("+n.join("|")+")\\b","i")}const cb="textDecorationThickness",ite=["fontSize","fontWeight","fontFamily","fontStyle"],ate=["underline","overline","linethrough"],ote=[...ite,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],lte=[...ote,...ate,"textBackgroundColor","direction",cb],_1e=[...ite,...ate,Bu,"strokeWidth",vl,"deltaY","textBackgroundColor",cb],x1e={_reNewline:tF,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Ri,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Ri,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[cb]:66.667},gm="justify",KL="justify-left",aM="justify-right",oM="justify-center";var uV,fV,dV;const rp=String.raw(uV||(uV=jm(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),u3=String.raw(fV||(fV=jm(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),Aj="http://www.w3.org/2000/svg",C1e=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+rp+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+rp+"))?\\s+(.*)"),S1e={cx:Ri,x:Ri,r:"radius",cy:Sf,y:Sf,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":cb},f3="font-size",d3="clip-path",M1e=_4(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),T1e=_4(["symbol","image","marker","pattern","view","svg"]),hV=_4(["symbol","g","a","svg","clipPath","defs"]),pV=new RegExp(String.raw(dV||(dV=jm(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),rp,u3,rp,u3,rp,u3,rp)),k1e=new Dt(1,0),cte=new Dt,hF=(n,e)=>n.rotate(e),XL=(n,e)=>new Dt(e).subtract(n),QL=n=>n.distanceFrom(cte),JL=(n,e)=>Math.atan2(Fv(n,e),fte(n,e)),ute=n=>JL(k1e,n),x4=n=>n.eq(cte)?n:n.scalarDivide(QL(n)),pF=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return x4(new Dt(-n.y,n.x).scalarMultiply(e?1:-1))},Fv=(n,e)=>n.x*e.y-n.y*e.x,fte=(n,e)=>n.x*e.x+n.y*e.y,Lj=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const s=Fv(e,t),r=Fv(e,n),a=Fv(t,n);return s>=0?r>=0&&a<=0:!(r<=0&&a>=0)},mV="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",gV=new RegExp("(?:\\s|^)"+mV+mV+"("+rp+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");let zv=class sL{constructor(e){const t=typeof e=="string"?sL.parseShadow(e):e;Object.assign(this,sL.ownDefaults,t),this.id=l1()}static parseShadow(e){const t=e.trim(),[,s=0,r=0,a=0]=(gV.exec(t)||[]).map((o=>parseFloat(o)||0));return{color:(t.replace(gV,"")||"rgb(0,0,0)").trim(),offsetX:s,offsetY:r,blur:a}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=hF(new Dt(this.offsetX,this.offsetY),Do(-e.angle)),s=new kf(this.color);let r=40,a=40;return e.width&&e.height&&(r=100*ga((Math.abs(t.x)+this.blur)/e.width,fi.NUM_FRACTION_DIGITS)+20,a=100*ga((Math.abs(t.y)+this.blur)/e.height,fi.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(a,'%" height="').concat(100+2*a,'%" x="-').concat(r,'%" width="').concat(100+2*r,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(ga(this.blur?this.blur/2:0,fi.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(ga(t.x,fi.NUM_FRACTION_DIGITS),'" dy="').concat(ga(t.y,fi.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(s.toRgb(),'" flood-opacity="').concat(s.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=sL.ownDefaults;return this.includeDefaultValues?e:lF(e,((s,r)=>s!==t[r]))}static async fromObject(e){return new this(e)}};it(zv,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),it(zv,"type","shadow"),Hn.setClass(zv,"shadow");const ub=(n,e,t)=>Math.max(n,Math.min(e,t)),E1e=[Sf,Ri,Wu,vd,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",A2,L2],Bg=[vl,Bu,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],I1e={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Ri,originY:Sf,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:vl,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},h3=(n,e,t,s)=>(n<Math.abs(e)?(n=e,s=t/4):s=e===0&&n===0?t/Ng*Math.asin(1):t/Ng*Math.asin(e/n),{a:n,c:e,p:t,s}),yV=(n,e,t,s,r)=>n*Math.pow(2,10*(s-=1))*Math.sin((s*r-e)*Ng/t),dte=(n,e,t,s)=>-t*Math.cos(n/s*o1)+t+e,Nj=(n,e,t,s)=>(n/=s)<1/2.75?t*(7.5625*n*n)+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e,bV=(n,e,t,s)=>t-Nj(s-n,0,t,s)+e;var A1e=Object.freeze({__proto__:null,defaultEasing:dte,easeInBack:function(n,e,t,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(n/=s)*n*((r+1)*n-r)+e},easeInBounce:bV,easeInCirc:(n,e,t,s)=>-t*(Math.sqrt(1-(n/=s)*n)-1)+e,easeInCubic:(n,e,t,s)=>t*(n/s)**3+e,easeInElastic:(n,e,t,s)=>{const r=t;let a=0;if(n===0)return e;if((n/=s)===1)return e+t;a||(a=.3*s);const{a:o,s:l,p:c}=h3(r,t,a,1.70158);return-yV(o,l,c,n,s)+e},easeInExpo:(n,e,t,s)=>n===0?e:t*2**(10*(n/s-1))+e,easeInOutBack:function(n,e,t,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(n/=s/2)<1?t/2*(n*n*((1+(r*=1.525))*n-r))+e:t/2*((n-=2)*n*((1+(r*=1.525))*n+r)+2)+e},easeInOutBounce:(n,e,t,s)=>n<s/2?.5*bV(2*n,0,t,s)+e:.5*Nj(2*n-s,0,t,s)+.5*t+e,easeInOutCirc:(n,e,t,s)=>(n/=s/2)<1?-t/2*(Math.sqrt(1-n**2)-1)+e:t/2*(Math.sqrt(1-(n-=2)*n)+1)+e,easeInOutCubic:(n,e,t,s)=>(n/=s/2)<1?t/2*n**3+e:t/2*((n-2)**3+2)+e,easeInOutElastic:(n,e,t,s)=>{const r=t;let a=0;if(n===0)return e;if((n/=s/2)===2)return e+t;a||(a=s*(.3*1.5));const{a:o,s:l,p:c,c:u}=h3(r,t,a,1.70158);return n<1?-.5*yV(o,l,c,n,s)+e:o*Math.pow(2,-10*(n-=1))*Math.sin((n*s-l)*Ng/c)*.5+u+e},easeInOutExpo:(n,e,t,s)=>n===0?e:n===s?e+t:(n/=s/2)<1?t/2*2**(10*(n-1))+e:t/2*-(2**(-10*--n)+2)+e,easeInOutQuad:(n,e,t,s)=>(n/=s/2)<1?t/2*n**2+e:-t/2*(--n*(n-2)-1)+e,easeInOutQuart:(n,e,t,s)=>(n/=s/2)<1?t/2*n**4+e:-t/2*((n-=2)*n**3-2)+e,easeInOutQuint:(n,e,t,s)=>(n/=s/2)<1?t/2*n**5+e:t/2*((n-2)**5+2)+e,easeInOutSine:(n,e,t,s)=>-t/2*(Math.cos(Math.PI*n/s)-1)+e,easeInQuad:(n,e,t,s)=>t*(n/=s)*n+e,easeInQuart:(n,e,t,s)=>t*(n/=s)*n**3+e,easeInQuint:(n,e,t,s)=>t*(n/s)**5+e,easeInSine:(n,e,t,s)=>-t*Math.cos(n/s*o1)+t+e,easeOutBack:function(n,e,t,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((n=n/s-1)*n*((r+1)*n+r)+1)+e},easeOutBounce:Nj,easeOutCirc:(n,e,t,s)=>t*Math.sqrt(1-(n=n/s-1)*n)+e,easeOutCubic:(n,e,t,s)=>t*((n/s-1)**3+1)+e,easeOutElastic:(n,e,t,s)=>{const r=t;let a=0;if(n===0)return e;if((n/=s)===1)return e+t;a||(a=.3*s);const{a:o,s:l,p:c,c:u}=h3(r,t,a,1.70158);return o*2**(-10*n)*Math.sin((n*s-l)*Ng/c)+u+e},easeOutExpo:(n,e,t,s)=>n===s?e+t:t*-(2**(-10*n/s)+1)+e,easeOutQuad:(n,e,t,s)=>-t*(n/=s)*(n-2)+e,easeOutQuart:(n,e,t,s)=>-t*((n=n/s-1)*n**3-1)+e,easeOutQuint:(n,e,t,s)=>t*((n/s-1)**5+1)+e,easeOutSine:(n,e,t,s)=>t*Math.sin(n/s*o1)+e});const L1e=()=>!1;let mF=class{constructor(e){let{startValue:t,byValue:s,duration:r=500,delay:a=0,easing:o=dte,onStart:l=Xy,onChange:c=Xy,onComplete:u=Xy,abort:f=L1e,target:d}=e;it(this,"_state","pending"),it(this,"durationProgress",0),it(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=a,this.easing=o,this._onStart=l,this._onChange=c,this._onComplete=u,this._abort=f,this.target=d,this.startValue=t,this.byValue=s,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>rM(e)),this.delay):rM(e)}tick(e){const t=(e||+new Date)-this.startTime,s=Math.min(t,this.duration);this.durationProgress=s/this.duration;const{value:r,valueProgress:a}=this.calculate(s);this.value=Object.freeze(r),this.valueProgress=a,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),rM(this.tick)))}register(){GL.push(this)}unregister(){GL.remove(this)}abort(){this._state="aborted",this.unregister()}};const N1e=["startValue","endValue"];let D1e=class extends mF{constructor(e){let{startValue:t=0,endValue:s=100}=e;super(lt(lt({},Va(e,N1e)),{},{startValue:t,byValue:s-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}};const O1e=["startValue","endValue"];let P1e=class extends mF{constructor(e){let{startValue:t=[0],endValue:s=[100]}=e;super(lt(lt({},Va(e,O1e)),{},{startValue:t,byValue:s.map(((r,a)=>r-t[a]))}))}calculate(e){const t=this.startValue.map(((s,r)=>this.easing(e,s,this.byValue[r],this.duration,r)));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}};const $1e=["startValue","endValue","easing","onChange","onComplete","abort"],j1e=(n,e,t,s)=>e+t*(1-Math.cos(n/s*o1)),p3=n=>n&&((e,t,s)=>n(new kf(e).toRgba(),t,s));let R1e=class extends mF{constructor(e){let{startValue:t,endValue:s,easing:r=j1e,onChange:a,onComplete:o,abort:l}=e,c=Va(e,$1e);const u=new kf(t).getSource(),f=new kf(s).getSource();super(lt(lt({},c),{},{startValue:u,byValue:f.map(((d,h)=>d-u[h])),easing:r,onChange:p3(a),onComplete:p3(o),abort:p3(l)}))}calculate(e){const[t,s,r,a]=this.startValue.map(((l,c)=>this.easing(e,l,this.byValue[c],this.duration,c))),o=[...[t,s,r].map(Math.round),ub(0,a,1)];return{value:o,valueProgress:o.map(((l,c)=>this.byValue[c]!==0?Math.abs((l-this.startValue[c])/this.byValue[c]):0)).find((l=>l!==0))||0}}};function gF(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new P1e(n):new D1e(n);return e.start(),e}function hte(n){const e=new R1e(n);return e.start(),e}let lM=class rc{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some((t=>t.eq(e)))}append(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.points=this.points.concat(t.filter((r=>!this.includes(r)))),this}static isPointContained(e,t,s){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(s))return e.eq(t);if(t.x===s.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,s.y)&&e.y<=Math.max(t.y,s.y));if(t.y===s.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,s.x)&&e.x<=Math.max(t.x,s.x));{const a=XL(t,s),o=XL(t,e).divide(a);return r?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const s=new Dt(e).setX(Math.min(e.x-1,...t.map((a=>a.x))));let r=0;for(let a=0;a<t.length;a++){const o=this.intersectSegmentSegment(t[a],t[(a+1)%t.length],e,s);if(o.includes(e))return!0;r+=+(o.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,s,r){let a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const l=t.x-e.x,c=t.y-e.y,u=r.x-s.x,f=r.y-s.y,d=e.x-s.x,h=e.y-s.y,p=u*h-f*d,g=l*h-c*d,b=f*l-u*c;if(b!==0){const v=p/b,w=g/b;return(a||0<=v&&v<=1)&&(o||0<=w&&w<=1)?new rc("Intersection").append(new Dt(e.x+v*l,e.y+v*c)):new rc}if(p===0||g===0){const v=a||o||rc.isPointContained(e,s,r)||rc.isPointContained(t,s,r)||rc.isPointContained(s,e,t)||rc.isPointContained(r,e,t);return new rc(v?"Coincident":void 0)}return new rc("Parallel")}static intersectSegmentLine(e,t,s,r){return rc.intersectLineLine(e,t,s,r,!1,!0)}static intersectSegmentSegment(e,t,s,r){return rc.intersectLineLine(e,t,s,r,!1,!1)}static intersectLinePolygon(e,t,s){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const a=new rc,o=s.length;for(let l,c,u,f=0;f<o;f++){if(l=s[f],c=s[(f+1)%o],u=rc.intersectLineLine(e,t,l,c,r,!1),u.status==="Coincident")return u;a.append(...u.points)}return a.points.length>0&&(a.status="Intersection"),a}static intersectSegmentPolygon(e,t,s){return rc.intersectLinePolygon(e,t,s,!1)}static intersectPolygonPolygon(e,t){const s=new rc,r=e.length,a=[];for(let o=0;o<r;o++){const l=e[o],c=e[(o+1)%r],u=rc.intersectSegmentPolygon(l,c,t);u.status==="Coincident"?(a.push(u),s.append(l,c)):s.append(...u.points)}return a.length>0&&a.length===e.length?new rc("Coincident"):(s.points.length>0&&(s.status="Intersection"),s)}static intersectPolygonRectangle(e,t,s){const r=t.min(s),a=t.max(s),o=new Dt(a.x,r.y),l=new Dt(r.x,a.y);return rc.intersectPolygonPolygon(e,[r,o,a,l])}},F1e=class extends Ree{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?du(e,this.group.calcTransformMatrix()):e}setXY(e,t,s){this.group&&(e=du(e,Cf(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,s)}getRelativeXY(){return new Dt(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,s)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:s,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),a=[e,t,s,r];if(this.group){const o=this.group.calcTransformMatrix();return a.map((l=>du(l,o)))}return a}intersectsWithRect(e,t){return lM.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=lM.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every((t=>e.containsPoint(t)))}isContainedWithinRect(e,t){const{left:s,top:r,width:a,height:o}=this.getBoundingRect();return s>=e.x&&s+a<=t.x&&r>=e.y&&r+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return lM.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some((s=>s.x<=t.x&&s.x>=e.x&&s.y<=t.y&&s.y>=e.y))||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every((s=>(s.x>=t.x||s.x<=e.x)&&(s.y>=t.y||s.y<=e.y)))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return _m(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Wu,e),this._set(vd,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Lm(Uee(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Vu.concat()}calcACoords(){const e=Rb({angle:this.angle}),{x:t,y:s}=this.getRelativeCenterPoint(),r=N2(t,s),a=Qo(r,e),o=this._getTransformedDimensions(),l=o.x/2,c=o.y/2;return{tl:du({x:-l,y:-c},a),tr:du({x:l,y:-c},a),bl:du({x:-l,y:c},a),br:du({x:l,y:c},a)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,ml(this.originX),ml(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const s=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every(((a,o)=>a===s[o]))?r.value:(this.group&&(t=Qo(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:s,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const s=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:s.x,translateY:s.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},a=Wee(r);return this.ownMatrixCache={key:e,value:a},a}_getNonTransformedDimensions(){return new Dt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=lt({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),s=t.strokeWidth;let r=s,a=0;this.strokeUniform&&(r=0,a=s);const o=t.width+r,l=t.height+r;let c;return c=t.skewX===0&&t.skewY===0?new Dt(o*t.scaleX,l*t.scaleY):v4(o,l,pT(t)),c.scalarAdd(a)}translateToGivenOrigin(e,t,s,r,a){let o=e.x,l=e.y;const c=ml(r)-ml(t),u=ml(a)-ml(s);if(c||u){const f=this._getTransformedDimensions();o+=c*f.x,l+=u*f.y}return new Dt(o,l)}translateToCenterPoint(e,t,s){if(t===Zs&&s===Zs)return e;const r=this.translateToGivenOrigin(e,t,s,Zs,Zs);return this.angle?r.rotate(Do(this.angle),e):r}translateToOriginPoint(e,t,s){const r=this.translateToGivenOrigin(e,Zs,Zs,t,s);return this.angle?r.rotate(Do(this.angle),e):r}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?du(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Dt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,s){const r=this.translateToCenterPoint(e,t,s),a=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:a.x,top:a.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Ri,Sf)}};const z1e=["type"],B1e=["extraParam"];let mg=class rL extends F1e{static getDefaults(){return rL.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Lg("warn","Setting type has no effect",e)}constructor(e){super(),it(this,"_cacheContext",null),Object.assign(this,rL.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Am(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,s=e.height,r=fi.maxCacheSideLimit,a=fi.minCacheSideLimit;if(t<=r&&s<=r&&t*s<=fi.perfLimitSizeTotal)return t<a&&(e.width=a),s<a&&(e.height=a),e;const o=t/s,[l,c]=sM.limitDimsByArea(o),u=ub(a,l,r),f=ub(a,c,r);return t>u&&(e.zoomX/=t/u,e.width=u,e.capped=!0),s>f&&(e.zoomY/=s/f,e.height=f,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),s=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:Math.ceil(s+2),height:Math.ceil(r+2),zoomX:e.x,zoomY:e.y,x:s,y:r}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:s,height:r,zoomX:a,zoomY:o,x:l,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),u=s!==e.width||r!==e.height,f=this.zoomX!==a||this.zoomY!==o;if(!e||!t)return!1;if(u||f){s!==e.width||r!==e.height?(e.width=s,e.height=r):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const d=l/2,h=c/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-h)+h,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(a,o),this.zoomX=a,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,s=this.calcTransformMatrix(!t);e.transform(s[0],s[1],s[2],s[3],s[4],s[5])}getObjectScaling(){if(!this.group)return new Dt(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=lb(this.calcTransformMatrix());return new Dt(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),s=this.getCanvasRetinaScaling();return e.scalarMultiply(t*s)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Wu&&e!==vd||(t=this._constrainScale(t)),e===Wu&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof zv||(t=new zv(t));const s=this[e]!==t;return this[e]=t,s&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||s&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:s,cacheTranslationX:r,cacheTranslationY:a}=this,{width:o,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:s,cacheTranslationX:r,cacheTranslationY:a,width:o,height:l,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Bu&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,s){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(s,0,0),e.restore()}drawObject(e,t,s){const r=this.fill,a=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,s),this.fill=r,this.stroke=a}createClipPathLayer(e,t){const s=_d(t),r=s.getContext("2d");if(r.translate(t.cacheTranslationX,t.cacheTranslationY),r.scale(t.zoomX,t.zoomY),e._cacheCanvas=s,t.parentClipPaths.forEach((a=>{a.transform(r)})),t.parentClipPaths.push(e),e.absolutePositioned){const a=Cf(this.calcTransformMatrix());r.transform(a[0],a[1],a[2],a[3],a[4],a[5])}return e.transform(r),e.drawObject(r,!0,t),s}_drawClipPath(e,t,s){if(!t)return;t._transformDone=!0;const r=this.createClipPathLayer(t,s);this.drawClipPathOnCache(e,t,r)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,s=this._cacheContext;return!(!t||!s||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&s&&!e&&(s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,t.width,t.height),s.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const s=t.stroke;s&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,ah(s)?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?this._applyPatternForTransformedGradient(e,s):(e.strokeStyle=s.toLive(e),this._applyPatternGradientTransform(e,s)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:s}=t;s&&(ah(s)?(e.fillStyle=s.toLive(e),this._applyPatternGradientTransform(e,s)):e.fillStyle=s)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,s=this.canvas,r=this.getCanvasRetinaScaling(),[a,,,o]=s?.viewportTransform||Vu,l=a*r,c=o*r,u=t.nonScaling?new Dt(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*fi.browserShadowBlurConstant*(l+c)*(u.x+u.y)/4,e.shadowOffsetX=t.offsetX*l*u.x,e.shadowOffsetY=t.offsetY*c*u.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!ah(t))return{offsetX:0,offsetY:0};const s=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,a=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,a):e.transform(1,0,0,1,r,a),s&&e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),{offsetX:r,offsetY:a}}_renderPaintInOrder(e){this.paintFirst===Bu?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var s;const r=this._limitCacheSize(this._getCacheCanvasDimensions()),a=this.getCanvasRetinaScaling(),o=r.x/this.scaleX/a,l=r.y/this.scaleY/a,c=_d({width:Math.ceil(o),height:Math.ceil(l)}),u=c.getContext("2d");u&&(u.beginPath(),u.moveTo(0,0),u.lineTo(o,0),u.lineTo(o,l),u.lineTo(0,l),u.closePath(),u.translate(o/2,l/2),u.scale(r.zoomX/this.scaleX/a,r.zoomY/this.scaleY/a),this._applyPatternGradientTransform(u,t),u.fillStyle=t.toLive(e),u.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(a*this.scaleX/r.zoomX,a*this.scaleY/r.zoomY),e.strokeStyle=(s=u.createPattern(c,"no-repeat"))!==null&&s!==void 0?s:"")}_findCenterFromElement(){return new Dt(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(Hn.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=uF(this),s=this.group,r=this.shadow,a=Math.abs,o=e.enableRetinaScaling?Dee():1,l=(e.multiplier||1)*o,c=e.canvasProvider||(x=>new cF(x,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&Jee(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&Ij(this,this.getViewportTransform()),this.setCoords();const u=Am(),f=this.getBoundingRect(),d=this.shadow,h=new Dt;if(d){const x=d.blur,S=d.nonScaling?new Dt(1,1):this.getObjectScaling();h.x=2*Math.round(a(d.offsetX)+x)*a(S.x),h.y=2*Math.round(a(d.offsetY)+x)*a(S.y)}const p=f.width+h.x,g=f.height+h.y;u.width=Math.ceil(p),u.height=Math.ceil(g);const b=c(u);e.format==="jpeg"&&(b.backgroundColor="#fff"),this.setPositionByOrigin(new Dt(b.width/2,b.height/2),Zs,Zs);const v=this.canvas;b._objects=[this],this.set("canvas",b),this.setCoords();const w=b.toCanvasElement(l||1,e);return this.set("canvas",v),this.shadow=r,s&&(this.group=s),this.set(t),this.setCoords(),b._objects=[],b.destroy(),w}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rF(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return iF(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:s,originY:r}=this;if(t){const{x:a,y:o}=this.getRelativeCenterPoint();this.originX=Zs,this.originY=Zs,this.left=a,this.top=o}if(this.set("angle",e),t){const{x:a,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),s,r);this.left=a,this.top=o,this.originX=s,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){GL.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Im().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce(((s,r)=>{let[a,o]=r;return s[a]=this._animate(a,o,t),s}),{})}_animate(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.split("."),a=this.constructor.colorProperties.includes(r[r.length-1]),{abort:o,startValue:l,onChange:c,onComplete:u}=s,f=lt(lt({},s),{},{target:this,startValue:l??r.reduce(((d,h)=>d[h]),this),endValue:t,abort:o?.bind(this),onChange:(d,h,p)=>{r.reduce(((g,b,v)=>(v===r.length-1&&(g[b]=d),g[b])),this),c&&c(d,h,p)},onComplete:(d,h,p)=>{this.setCoords(),u&&u(d,h,p)}});return a?hte(f):gF(f)}isDescendantOf(e){const{parent:t,group:s}=this;return t===e||s===e||!!t&&t.isDescendantOf(e)||!!s&&s!==t&&s.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),s=e.getAncestors();if(t.length===0&&s.length>0&&this===s[s.length-1])return{fork:[],otherFork:[e,...s.slice(0,s.length-1)],common:[this]};for(let r,a=0;a<t.length;a++){if(r=t[a],r===e)return{fork:[this,...t.slice(0,a)],otherFork:[],common:t.slice(a)};for(let o=0;o<s.length;o++){if(this===s[o])return{fork:[],otherFork:[e,...s.slice(0,o)],common:[this,...t]};if(r===s[o])return{fork:[this,...t.slice(0,a)],otherFork:[e,...s.slice(0,o)],common:t.slice(a)}}}return{fork:[this,...t],otherFork:[e,...s],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const s=t.common[0]||this.canvas;if(!s)return;const r=t.fork.pop(),a=t.otherFork.pop(),o=s._objects.indexOf(r),l=s._objects.indexOf(a);return o>-1&&o>l}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(rL.customProperties,this.constructor.customProperties||[]);let t;const s=fi.NUM_FRACTION_DIGITS,{clipPath:r,fill:a,stroke:o,shadow:l,strokeDashArray:c,left:u,top:f,originX:d,originY:h,width:p,height:g,strokeWidth:b,strokeLineCap:v,strokeDashOffset:w,strokeLineJoin:x,strokeUniform:S,strokeMiterLimit:C,scaleX:M,scaleY:k,angle:E,flipX:I,flipY:A,opacity:D,visible:L,backgroundColor:P,fillRule:j,paintFirst:G,globalCompositeOperation:Q,skewX:q,skewY:te}=this;r&&!r.excludeFromExport&&(t=r.toObject(e.concat("inverted","absolutePositioned")));const Z=le=>ga(le,s),ne=lt(lt({},Fb(this,e)),{},{type:this.constructor.type,version:Tj,originX:d,originY:h,left:Z(u),top:Z(f),width:Z(p),height:Z(g),fill:tV(a)?a.toObject():a,stroke:tV(o)?o.toObject():o,strokeWidth:Z(b),strokeDashArray:c&&c.concat(),strokeLineCap:v,strokeDashOffset:w,strokeLineJoin:x,strokeUniform:S,strokeMiterLimit:Z(C),scaleX:Z(M),scaleY:Z(k),angle:Z(E),flipX:I,flipY:A,opacity:Z(D),shadow:l&&l.toObject(),visible:L,backgroundColor:P,fillRule:j,paintFirst:G,globalCompositeOperation:Q,skewX:Z(q),skewY:Z(te)},t?{clipPath:t}:null);return this.includeDefaultValues?ne:this._removeDefaultValues(ne)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),s=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return lF(e,((r,a)=>{if(a===Ri||a===Sf||a==="type")return!0;const o=s[a];return r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&r.length===0&&o.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=Va(e,z1e),s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=s,a=Va(s,B1e);return mT(t,a).then((o=>r?(delete o[r],new this(t[r],o)):new this(o)))}static fromObject(e,t){return this._fromObject(e,t)}};it(mg,"stateProperties",E1e),it(mg,"cacheProperties",Bg),it(mg,"ownDefaults",I1e),it(mg,"type","FabricObject"),it(mg,"colorProperties",[vl,Bu,"backgroundColor"]),it(mg,"customProperties",[]),Hn.setClass(mg),Hn.setClass(mg,"object");const D2=(n,e,t)=>(s,r,a,o)=>{const l=e(s,r,a,o);return l&&ete(n,lt(lt({},nte(s,r,a,o)),t)),l};function O2(n){return(e,t,s,r)=>{const{target:a,originX:o,originY:l}=t,c=a.getRelativeCenterPoint(),u=a.translateToOriginPoint(c,o,l),f=n(e,t,s,r);return a.setPositionByOrigin(u,t.originX,t.originY),f}}const wV=D2(CM,O2(((n,e,t,s)=>{const r=fF(e,e.originX,e.originY,t,s);if(ml(e.originX)===ml(Zs)||ml(e.originX)===ml(Ho)&&r.x<0||ml(e.originX)===ml(Ri)&&r.x>0){const{target:a}=e,o=a.strokeWidth/(a.strokeUniform?a.scaleX:1),l=tte(e)?2:1,c=a.width,u=Math.abs(r.x*l/a.scaleX)-o;return a.set("width",Math.max(u,1)),c!==a.width}return!1})));function U1e(n,e,t,s,r){s=s||{};const a=this.sizeX||s.cornerSize||r.cornerSize,o=this.sizeY||s.cornerSize||r.cornerSize,l=s.transparentCorners!==void 0?s.transparentCorners:r.transparentCorners,c=l?Bu:vl,u=!l&&(s.cornerStrokeColor||r.cornerStrokeColor);let f,d=e,h=t;n.save(),n.fillStyle=s.cornerColor||r.cornerColor||"",n.strokeStyle=s.cornerStrokeColor||r.cornerStrokeColor||"",a>o?(f=a,n.scale(1,o/a),h=t*a/o):o>a?(f=o,n.scale(a/o,1),d=e*o/a):f=a,n.beginPath(),n.arc(d,h,f/2,0,Ng,!1),n[c](),u&&n.stroke(),n.restore()}function V1e(n,e,t,s,r){s=s||{};const a=this.sizeX||s.cornerSize||r.cornerSize,o=this.sizeY||s.cornerSize||r.cornerSize,l=s.transparentCorners!==void 0?s.transparentCorners:r.transparentCorners,c=l?Bu:vl,u=!l&&(s.cornerStrokeColor||r.cornerStrokeColor),f=a/2,d=o/2;n.save(),n.fillStyle=s.cornerColor||r.cornerColor||"",n.strokeStyle=s.cornerStrokeColor||r.cornerStrokeColor||"",n.translate(e,t);const h=r.getTotalAngle();n.rotate(Do(h)),n["".concat(c,"Rect")](-f,-d,a,o),u&&n.strokeRect(-f,-d,a,o),n.restore()}class Ol{constructor(e){it(this,"visible",!0),it(this,"actionName",y4),it(this,"angle",0),it(this,"x",0),it(this,"y",0),it(this,"offsetX",0),it(this,"offsetY",0),it(this,"sizeX",0),it(this,"sizeY",0),it(this,"touchSizeX",0),it(this,"touchSizeY",0),it(this,"cursorStyle","crosshair"),it(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,s,r){var a;let{tl:o,tr:l,br:c,bl:u}=r;return((a=t.canvas)===null||a===void 0?void 0:a.getActiveObject())===t&&t.isControlVisible(e)&&lM.isPointInPolygon(s,[o,l,c,u])}getActionHandler(e,t,s){return this.actionHandler}getMouseDownHandler(e,t,s){return this.mouseDownHandler}getMouseUpHandler(e,t,s){return this.mouseUpHandler}cursorStyleHandler(e,t,s){return t.cursorStyle}getActionName(e,t,s){return t.actionName}getVisibility(e,t){var s,r;return(s=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&s!==void 0?s:this.visible}setVisibility(e,t,s){this.visible=e}positionHandler(e,t,s,r){return new Dt(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,s,r,a,o){const l=b4([N2(s,r),Rb({angle:e}),w4((a?this.touchSizeX:this.sizeX)||t,(a?this.touchSizeY:this.sizeY)||t)]);return{tl:new Dt(-.5,-.5).transform(l),tr:new Dt(.5,-.5).transform(l),br:new Dt(.5,.5).transform(l),bl:new Dt(-.5,.5).transform(l)}}render(e,t,s,r,a){((r=r||{}).cornerStyle||a.cornerStyle)==="circle"?U1e.call(this,e,t,s,r,a):V1e.call(this,e,t,s,r,a)}}const W1e=(n,e,t)=>t.lockRotation?qL:e.cursorStyle,G1e=D2(Pee,O2(((n,e,t,s)=>{let{target:r,ex:a,ey:o,theta:l,originX:c,originY:u}=e;const f=r.translateToOriginPoint(r.getRelativeCenterPoint(),c,u);if(ap(r,"lockRotation"))return!1;const d=Math.atan2(o-f.y,a-f.x),h=Math.atan2(s-f.y,t-f.x);let p=Lm(h-d+l);if(r.snapAngle&&r.snapAngle>0){const b=r.snapAngle,v=r.snapThreshold||b,w=Math.ceil(p/b)*b,x=Math.floor(p/b)*b;Math.abs(p-x)<v?p=x:Math.abs(p-w)<v&&(p=w)}p<0&&(p=360+p),p%=360;const g=r.angle!==p;return r.angle=p,g})));function pte(n,e){const t=e.canvas,s=n[t.uniScaleKey];return t.uniformScaling&&!s||!t.uniformScaling&&s}function mte(n,e,t){const s=ap(n,"lockScalingX"),r=ap(n,"lockScalingY");if(s&&r||!e&&(s||r)&&t||s&&e==="x"||r&&e==="y")return!0;const{width:a,height:o,strokeWidth:l}=n;return a===0&&l===0&&e!=="y"||o===0&&l===0&&e!=="x"}const H1e=["e","se","s","sw","w","nw","n","ne","e"],_S=(n,e,t)=>{const s=pte(n,t);if(mte(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",s))return qL;const r=ste(t,e);return"".concat(H1e[r],"-resize")};function yF(n,e,t,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const a=e.target,o=r.by,l=pte(n,a);let c,u,f,d,h,p;if(mte(a,o,l))return!1;if(e.gestureScale)u=e.scaleX*e.gestureScale,f=e.scaleY*e.gestureScale;else{if(c=fF(e,e.originX,e.originY,t,s),h=o!=="y"?Math.sign(c.x||e.signX||1):1,p=o!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=p),ap(a,"lockScalingFlip")&&(e.signX!==h||e.signY!==p))return!1;if(d=a._getTransformedDimensions(),l&&!o){const v=Math.abs(c.x)+Math.abs(c.y),{original:w}=e,x=v/(Math.abs(d.x*w.scaleX/a.scaleX)+Math.abs(d.y*w.scaleY/a.scaleY));u=w.scaleX*x,f=w.scaleY*x}else u=Math.abs(c.x*a.scaleX/d.x),f=Math.abs(c.y*a.scaleY/d.y);tte(e)&&(u*=2,f*=2),e.signX!==h&&o!=="y"&&(e.originX=iV(e.originX),u*=-1,e.signX=h),e.signY!==p&&o!=="x"&&(e.originY=iV(e.originY),f*=-1,e.signY=p)}const g=a.scaleX,b=a.scaleY;return o?(o==="x"&&a.set(Wu,u),o==="y"&&a.set(vd,f)):(!ap(a,"lockScalingX")&&a.set(Wu,u),!ap(a,"lockScalingY")&&a.set(vd,f)),g!==a.scaleX||b!==a.scaleY}const cI=D2(g4,O2(((n,e,t,s)=>yF(n,e,t,s)))),q1e=D2(g4,O2(((n,e,t,s)=>yF(n,e,t,s,{by:"x"})))),Y1e=D2(g4,O2(((n,e,t,s)=>yF(n,e,t,s,{by:"y"})))),K1e=["target","ex","ey","skewingSide"],m3={x:{counterAxis:"y",scale:Wu,skew:A2,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:vd,skew:L2,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},X1e=["ns","nesw","ew","nwse"],Q1e=(n,e,t)=>{if(e.x!==0&&ap(t,"lockSkewingY")||e.y!==0&&ap(t,"lockSkewingX"))return qL;const s=ste(t,e)%4;return"".concat(X1e[s],"-resize")};function gte(n,e,t,s,r){const{target:a}=t,{counterAxis:o,origin:l,lockSkewing:c,skew:u,flip:f}=m3[n];if(ap(a,c))return!1;const{origin:d,flip:h}=m3[o],p=ml(t[d])*(a[h]?-1:1),g=-Math.sign(p)*(a[f]?-1:1),b=.5*-((a[u]===0&&fF(t,Zs,Zs,s,r)[n]>0||a[u]>0?1:-1)*g)+.5;return D2($ee,O2(((w,x,S,C)=>(function(M,k,E){let{target:I,ex:A,ey:D,skewingSide:L}=k,P=Va(k,K1e);const{skew:j}=m3[M],G=E.subtract(new Dt(A,D)).divide(new Dt(I.scaleX,I.scaleY))[M],Q=I[j],q=P[j],te=Math.tan(Do(q)),Z=M==="y"?I._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:I._getTransformedDimensions({scaleX:1,scaleY:1}).y,ne=2*G*L/Math.max(Z,1)+te,le=Lm(Math.atan(ne));I.set(j,le);const H=Q!==I[j];if(H&&M==="y"){const{skewX:R,scaleX:B}=I,W=I._getTransformedDimensions({skewY:Q}),se=I._getTransformedDimensions(),ue=R!==0?W.x/se.x:1;ue!==1&&I.set(Wu,ue*B)}return H})(n,x,new Dt(S,C)))))(e,lt(lt({},t),{},{[l]:b,skewingSide:g}),s,r)}const J1e=(n,e,t,s)=>gte("x",n,e,t,s),Z1e=(n,e,t,s)=>gte("y",n,e,t,s);function C4(n,e){return n[e.canvas.altActionKey]}const uI=(n,e,t)=>{const s=C4(n,t);return e.x===0?s?A2:vd:e.y===0?s?L2:Wu:""},Nv=(n,e,t)=>C4(n,t)?Q1e(0,e,t):_S(n,e,t),vV=(n,e,t,s)=>C4(n,e.target)?Z1e(n,e,t,s):q1e(n,e,t,s),_V=(n,e,t,s)=>C4(n,e.target)?J1e(n,e,t,s):Y1e(n,e,t,s),yte=()=>({ml:new Ol({x:-.5,y:0,cursorStyleHandler:Nv,actionHandler:vV,getActionName:uI}),mr:new Ol({x:.5,y:0,cursorStyleHandler:Nv,actionHandler:vV,getActionName:uI}),mb:new Ol({x:0,y:.5,cursorStyleHandler:Nv,actionHandler:_V,getActionName:uI}),mt:new Ol({x:0,y:-.5,cursorStyleHandler:Nv,actionHandler:_V,getActionName:uI}),tl:new Ol({x:-.5,y:-.5,cursorStyleHandler:_S,actionHandler:cI}),tr:new Ol({x:.5,y:-.5,cursorStyleHandler:_S,actionHandler:cI}),bl:new Ol({x:-.5,y:.5,cursorStyleHandler:_S,actionHandler:cI}),br:new Ol({x:.5,y:.5,cursorStyleHandler:_S,actionHandler:cI}),mtr:new Ol({x:0,y:-.5,actionHandler:G1e,cursorStyleHandler:W1e,offsetY:-40,withConnection:!0,actionName:nF})}),eye=()=>({mr:new Ol({x:.5,y:0,actionHandler:wV,cursorStyleHandler:Nv,actionName:CM}),ml:new Ol({x:-.5,y:0,actionHandler:wV,cursorStyleHandler:Nv,actionName:CM})}),tye=()=>lt(lt({},yte()),eye());let bte=class Dj extends mg{static getDefaults(){return lt(lt({},super.getDefaults()),Dj.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),Dj.ownDefaults),this.setOptions(e)}static createControls(){return{controls:yte()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,s=t.target,r=t.action;if(this===s&&r&&r.startsWith(y4))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const s=Object.entries(this.oCoords);for(let r=s.length-1;r>=0;r--){const[a,o]=s[r],l=this.controls[a];if(l.shouldActivate(a,this,e,t?o.touchCorner:o.corner))return this.__corner=a,{key:a,control:l,coord:this.oCoords[a]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),s=N2(t.x,t.y),r=Rb({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),a=Qo(s,r),o=Qo(e,a),l=Qo(o,[1/e[0],0,0,1/e[3],0,0]),c=this.group?lb(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));const u=this._calculateCurrentDimensions(c),f={};return this.forEachControl(((d,h)=>{const p=d.positionHandler(u,l,this,d);f[h]=Object.assign(p,this._calcCornerCoords(d,p))})),f}_calcCornerCoords(e,t){const s=this.getTotalAngle();return{corner:e.calcCornerCoords(s,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(s,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),s=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(Do(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-s.x/2,-s.y/2,s.x,s.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=lt({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},s);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:s,hasControls:r}=this,a=lt({hasBorders:s,hasControls:r},t),o=this.getViewportTransform(),l=a.hasBorders,c=a.hasControls,u=Qo(o,this.calcTransformMatrix()),f=lb(u);e.save(),e.translate(f.translateX,f.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(f.angle-=180),e.rotate(Do(this.group?f.angle:this.angle)),l&&this.drawBorders(e,f,t),c&&this.drawControls(e,t),e.restore()}drawBorders(e,t,s){let r;if(s&&s.forActiveSelection||this.group){const a=v4(this.width,this.height,pT(t)),o=this.isStrokeAccountedForInDimensions()?sF:(this.strokeUniform?new Dt().scalarAdd(this.canvas?this.canvas.getZoom():1):new Dt(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=a.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,s)}drawControlsConnectingLines(e,t){let s=!1;e.beginPath(),this.forEachControl(((r,a)=>{r.withConnection&&r.getVisibility(this,a)&&(s=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))})),s&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const s=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:a,cornerColor:o}=this,l=lt({cornerStrokeColor:r,cornerDashArray:a,cornerColor:o},t);e.setTransform(s,0,0,s,0,0),e.strokeStyle=e.fillStyle=l.cornerColor,this.transparentCorners||(e.strokeStyle=l.cornerStrokeColor),this._setLineDash(e,l.cornerDashArray),this.forEachControl(((c,u)=>{if(c.getVisibility(this,u)){const f=this.oCoords[u];c.render(e,f.x,f.y,l,this)}})),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach((t=>{let[s,r]=t;return this.setControlVisible(s,r)}))}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const s=this.canvas.viewportTransform;t.save(),t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this.transform(t);const r=this.width+4,a=this.height+4;return t.clearRect(-r/2,-a/2,r,a),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function wte(n,e){return e.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((s=>{s!=="constructor"&&Object.defineProperty(n.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s)||Object.create(null))}))})),n}it(bte,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class wu extends bte{}wte(wu,[rte]),Hn.setClass(wu),Hn.setClass(wu,"object");const vte=(n,e,t,s)=>{const r=2*(s=Math.round(s))+1,{data:a}=n.getImageData(e-s,t-s,r,r);for(let o=3;o<a.length;o+=4)if(a[o]>0)return!1;return!0};class _te{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Dt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Dt(1/this.options.scaleX,1/this.options.scaleY):new Dt(1,1)}createSideVector(e,t){const s=XL(e,t);return this.options.strokeUniform?s.multiply(this.scale):s}projectOrthogonally(e,t,s){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,s)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new Dt(e);return t.y+=t.x*Math.tan(Do(this.options.skewY)),t.x+=t.y*Math.tan(Do(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const nye=new Dt;let xte=class iL extends _te{static getOrthogonalRotationFactor(e,t){const s=t?JL(e,t):ute(e);return Math.abs(s)<o1?-1:1}constructor(e,t,s,r){super(r),it(this,"AB",void 0),it(this,"AC",void 0),it(this,"alpha",void 0),it(this,"bisector",void 0),this.A=new Dt(e),this.B=new Dt(t),this.C=new Dt(s),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=JL(this.AB,this.AC),this.bisector=x4(hF(this.AB.eq(nye)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t),a=pF(r),o=iL.getOrthogonalRotationFactor(a,this.bisector);return this.scaleUnitVector(a,s*o)}projectBevel(){const e=[];return(this.alpha%Ng==0?[this.B]:[this.B,this.C]).forEach((t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))})),e}projectMiter(){const e=[],t=Math.abs(this.alpha),s=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*s),a=this.options.strokeUniform?QL(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return QL(r)/this.strokeProjectionMagnitude<=a&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const s=[],r=new Dt(iL.getOrthogonalRotationFactor(this.bisector),iL.getOrthogonalRotationFactor(new Dt(this.bisector.y,this.bisector.x)));return[new Dt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new Dt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach((a=>{Lj(a,e,t)&&s.push(this.A.add(a))})),s}projectRoundWithSkew(e,t){const s=[],{skewX:r,skewY:a,scaleX:o,scaleY:l,strokeUniform:c}=this.options,u=new Dt(Math.tan(Do(r)),Math.tan(Do(a))),f=this.strokeProjectionMagnitude,d=c?f/l/Math.sqrt(1/l**2+1/o**2*u.y**2):f/Math.sqrt(1+u.y**2),h=new Dt(Math.sqrt(Math.max(f**2-d**2,0)),d),p=c?f/Math.sqrt(1+u.x**2*(1/l)**2/(1/o+1/o*u.x*u.y)**2):f/Math.sqrt(1+u.x**2/(1+u.x*u.y)**2),g=new Dt(p,Math.sqrt(Math.max(f**2-p**2,0)));return[g,g.scalarMultiply(-1),h,h.scalarMultiply(-1)].map((b=>this.applySkew(c?b.multiply(this.strokeUniformScalar):b))).forEach((b=>{Lj(b,e,t)&&s.push(this.applySkew(this.A).add(b))})),s}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Ng==0,s=this.applySkew(this.A),r=e[t?0:2].subtract(s),a=e[t?1:0].subtract(s),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=Fv(r,o)>0,c=l?r:a,u=l?a:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,u)):e.push(...this.projectRoundNoSkew(c,u)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector})))}},xV=class extends _te{constructor(e,t,s){super(s),this.A=new Dt(e),this.T=new Dt(t)}calcOrthogonalProjection(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t);return this.scaleUnitVector(pF(r),s)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new Dt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new xte(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new Dt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),s=this.scaleUnitVector(x4(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(s);e.push(r.add(t),r.subtract(t))}return e.map((t=>this.applySkew(t)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e})))}};const Cte=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const s=[];if(n.length===0)return s;const r=n.reduce(((a,o)=>(a[a.length-1].eq(o)||a.push(new Dt(o)),a)),[new Dt(n[0])]);if(r.length===1)t=!0;else if(!t){const a=r[0],o=((l,c)=>{for(let u=l.length-1;u>=0;u--)if(c(l[u],u,l))return u;return-1})(r,(l=>!l.eq(a)));r.splice(o+1)}return r.forEach(((a,o,l)=>{let c,u;o===0?(u=l[1],c=t?a:l[l.length-1]):o===l.length-1?(c=l[o-1],u=t?a:l[0]):(c=l[o-1],u=l[o+1]),t&&l.length===1?s.push(...new xV(a,a,e).project()):!t||o!==0&&o!==l.length-1?s.push(...new xte(a,c,u,e).project()):s.push(...new xV(a,o===0?u:c,e).project())})),s},bF=n=>{const e={};return Object.keys(n).forEach((t=>{e[t]={},Object.keys(n[t]).forEach((s=>{e[t][s]=lt({},n[t][s])}))})),e},Ste=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let BC;const S4=n=>{if(BC||BC||(BC="Intl"in I2()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),BC){const e=BC.segment(n);return Array.from(e).map((t=>{let{segment:s}=t;return s}))}return sye(n)},sye=n=>{const e=[];for(let t,s=0;s<n.length;s++)(t=rye(n,s))!==!1&&e.push(t);return e},rye=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const r=n.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const s=n.charCodeAt(e-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1};var iye=Object.freeze({__proto__:null,capitalize:function(n){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(n.charAt(0).toUpperCase()).concat(e?n.slice(1):n.slice(1).toLowerCase())},escapeXml:Ste,graphemeSplit:S4});const M4=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textDecorationThickness!==e.textDecorationThickness||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},Mte=(n,e)=>{const t=e.split(`
`),s=[];let r=-1,a={};n=bF(n);for(let o=0;o<t.length;o++){const l=S4(t[o]);if(n[o])for(let c=0;c<l.length;c++){r++;const u=n[o][c];u&&Object.keys(u).length>0&&(M4(a,u,!0)?s.push({start:r,end:r+1,style:u}):s[s.length-1].end++),a=u||{}}else r+=l.length,a={}}return s},Tte=(n,e)=>{if(!Array.isArray(n))return bF(n);const t=e.split(tF),s={};let r=-1,a=0;for(let o=0;o<t.length;o++){const l=S4(t[o]);for(let c=0;c<l.length;c++)r++,n[a]&&n[a].start<=r&&r<n[a].end&&(s[o]=s[o]||{},s[o][c]=lt({},n[a].style),r===n[a].end-1&&a++)}return s},x1=["display","transform",vl,"fill-opacity","fill-rule","opacity",Bu,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function CV(n,e){const t=n.nodeName,s=n.getAttribute("class"),r=n.getAttribute("id"),a="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),r&&e.length&&(o=new RegExp("#"+r+a,"i"),e=e.replace(o,"")),s&&e.length){const l=s.split(" ");for(let c=l.length;c--;)o=new RegExp("\\."+l[c]+a,"i"),e=e.replace(o,"")}return e.length===0}function aye(n,e){let t=!0;const s=CV(n,e.pop());return s&&e.length&&(t=(function(r,a){let o,l=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&a.length;)l&&(o=a.pop()),l=CV(r=r.parentElement,o);return a.length===0})(n,e)),s&&t&&e.length===0}const oye=n=>{var e;return(e=S1e[n])!==null&&e!==void 0?e:n},lye=new RegExp("(".concat(rp,")"),"gi"),cye=n=>YL(n.replace(lye," $1 ").replace(/,/gi," "));var SV,MV,TV,kV,EV,IV,AV;const ju="(".concat(rp,")"),uye=String.raw(SV||(SV=jm(["(skewX)(",")"],["(skewX)\\(","\\)"])),ju),fye=String.raw(MV||(MV=jm(["(skewY)(",")"],["(skewY)\\(","\\)"])),ju),dye=String.raw(TV||(TV=jm(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),ju,ju,ju),hye=String.raw(kV||(kV=jm(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),ju,ju),pye=String.raw(EV||(EV=jm(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),ju,ju),mye=String.raw(IV||(IV=jm(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),ju,ju,ju,ju,ju,ju),wF="(?:".concat(mye,"|").concat(pye,"|").concat(dye,"|").concat(hye,"|").concat(uye,"|").concat(fye,")"),gye="(?:".concat(wF,"*)"),yye=String.raw(AV||(AV=jm(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),gye),bye=new RegExp(yye),wye=new RegExp(wF),vye=new RegExp(wF,"g");function ZL(n){const e=[];if(!(n=cye(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!bye.test(n))return[...Vu];for(const t of n.matchAll(vye)){const s=wye.exec(t[0]);if(!s)continue;let r=Vu;const a=s.filter((g=>!!g)),[,o,...l]=a,[c,u,f,d,h,p]=l.map((g=>parseFloat(g)));switch(o){case"translate":r=N2(c,u);break;case nF:r=Rb({angle:c},{x:u,y:f});break;case y4:r=w4(c,u);break;case A2:r=aF(c);break;case L2:r=oF(c);break;case"matrix":r=[c,u,f,d,h,p]}e.push(r)}return b4(e)}function _ye(n,e,t,s){const r=Array.isArray(e);let a,o=e;if(n!==vl&&n!==Bu||e!==zu){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")o=e===zu?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=t&&t.transformMatrix?Qo(t.transformMatrix,ZL(e)):ZL(e);else if(n==="visible")o=e!==zu&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(n==="textAnchor")o=e==="start"?Ri:e==="end"?Ho:Zs;else if(n==="charSpacing"||n===cb)a=$u(e,s)/s*1e3;else if(n==="paintFirst"){const l=e.indexOf(vl),c=e.indexOf(Bu);o=vl,(l>-1&&c>-1&&c<l||l===-1&&c>-1)&&(o=Bu)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";a=r?e.map($u):$u(e,s)}}else o="";return!r&&isNaN(a)?o:a}function xye(n,e){const t=n.match(C1e);if(!t)return;const s=t[1],r=t[3],a=t[4],o=t[5],l=t[6];s&&(e.fontStyle=s),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),a&&(e.fontSize=$u(a)),l&&(e.fontFamily=l),o&&(e.lineHeight=o==="normal"?1:o)}function Oj(n,e){n.replace(/;\s*$/,"").split(";").forEach((t=>{if(!t)return;const[s,r]=t.split(":");e[s.trim().toLowerCase()]=r.trim()}))}function Cye(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?Oj(t,e):(function(s,r){Object.entries(s).forEach((a=>{let[o,l]=a;l!==void 0&&(r[o.toLowerCase()]=l)}))})(t,e)),e}const Sye={stroke:"strokeOpacity",fill:"fillOpacity"};function Ug(n,e,t){if(!n)return{};let s,r={},a=eF;n.parentNode&&hV.test(n.parentNode.nodeName)&&(r=Ug(n.parentElement,e,t),r.fontSize&&(s=a=$u(r.fontSize)));const o=lt(lt(lt({},e.reduce(((u,f)=>{const d=n.getAttribute(f);return d&&(u[f]=d),u}),{})),(function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(const h in f)aye(u,h.split(" "))&&(d=lt(lt({},d),f[h]));return d})(n,t)),Cye(n));o[d3]&&n.setAttribute(d3,o[d3]),o[f3]&&(s=$u(o[f3],a),o[f3]="".concat(s));const l={};for(const u in o){const f=oye(u),d=_ye(f,o[u],r,s);l[f]=d}l&&l.font&&xye(l.font,l);const c=lt(lt({},r),l);return hV.test(n.nodeName)?c:(function(u){const f=wu.getDefaults();return Object.entries(Sye).forEach((d=>{let[h,p]=d;if(u[p]===void 0||u[h]==="")return;if(u[h]===void 0){if(!f[h])return;u[h]=f[h]}if(u[h].indexOf("url(")===0)return;const g=new kf(u[h]);u[h]=g.setAlpha(ga(g.getAlpha()*u[p],2)).toRgba()})),u})(c)}const Mye=["left","top","width","height","visible"],kte=["rx","ry"];let dm=class Pj extends wu{static getDefaults(){return lt(lt({},super.getDefaults()),Pj.ownDefaults)}constructor(e){super(),Object.assign(this,Pj.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:s}=this,r=-t/2,a=-s/2,o=this.rx?Math.min(this.rx,t/2):0,l=this.ry?Math.min(this.ry,s/2):0,c=o!==0||l!==0;e.beginPath(),e.moveTo(r+o,a),e.lineTo(r+t-o,a),c&&e.bezierCurveTo(r+t-A0*o,a,r+t,a+A0*l,r+t,a+l),e.lineTo(r+t,a+s-l),c&&e.bezierCurveTo(r+t,a+s-A0*l,r+t-A0*o,a+s,r+t-o,a+s),e.lineTo(r+o,a+s),c&&e.bezierCurveTo(r+A0*o,a+s,r,a+s-A0*l,r,a+s-l),e.lineTo(r,a+l),c&&e.bezierCurveTo(r,a+A0*l,r+A0*o,a,r+o,a),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...kte,...e])}_toSVG(){const{width:e,height:t,rx:s,ry:r}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(s,'" ry="').concat(r,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,s){const r=Ug(e,this.ATTRIBUTE_NAMES,s),{left:a=0,top:o=0,width:l=0,height:c=0,visible:u=!0}=r,f=Va(r,Mye);return new this(lt(lt(lt({},t),f),{},{left:a,top:o,width:l,height:c,visible:!!(u&&l&&c)}))}};it(dm,"type","Rect"),it(dm,"cacheProperties",[...Bg,...kte]),it(dm,"ownDefaults",{rx:0,ry:0}),it(dm,"ATTRIBUTE_NAMES",[...x1,"x","y","rx","ry","width","height"]),Hn.setClass(dm),Hn.setSVGClass(dm);const kg="initialization",eN="added",vF="removed",tN="imperative",Ete=(n,e)=>{const{strokeUniform:t,strokeWidth:s,width:r,height:a,group:o}=e,l=o&&o!==n?gT(o.calcTransformMatrix(),n.calcTransformMatrix()):null,c=l?e.getRelativeCenterPoint().transform(l):e.getRelativeCenterPoint(),u=!e.isStrokeAccountedForInDimensions(),f=t&&u?Zee(new Dt(s,s),void 0,n.calcTransformMatrix()):sF,d=!t&&u?s:0,h=v4(r+d,a+d,b4([l,e.calcOwnMatrix()],!0)).add(f).scalarDivide(2);return[c.subtract(h),c.add(h)]};let T4=class{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:s,strategy:r}=e;return t===kg||t===tN||!!s&&r!==s}shouldLayoutClipPath(e){let{type:t,target:{clipPath:s}}=e;return t!==kg&&s&&!s.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:s,target:r}=t;if(s===tN&&t.overrides)return t.overrides;if(e.length===0)return;const{left:a,top:o,width:l,height:c}=_m(e.map((d=>Ete(r,d))).reduce(((d,h)=>d.concat(h)),[])),u=new Dt(l,c),f=new Dt(a,o).add(u.scalarDivide(2));if(s===kg){const d=this.getInitialSize(t,{size:u,center:f});return{center:f,relativeCorrection:new Dt(0,0),size:d}}return{center:f.transform(r.calcOwnMatrix()),size:u}}};it(T4,"type","strategy");let $j=class extends T4{shouldPerformLayout(e){return!0}};it($j,"type","fit-content"),Hn.setClass($j);const Tye=["strategy"],kye=["target","strategy","bubbles","prevStrategy"],Ite="layoutManager";let MM=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new $j;it(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=lt(lt({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const s=this.getLayoutResult(t);s&&this.commitLayout(t,s),this.onAfterLayout(t,s),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:s}=t;return[WL,Oee,CM,Pee,g4,$ee,VL,f1e,d1e].map((r=>e.on(r,(a=>this.performLayout(r===WL?{type:"object_modified",trigger:r,e:a,target:s}:{type:"object_modifying",trigger:r,e:a,target:s})))))}subscribe(e,t){this.unsubscribe(e,t);const s=this.attachHandlers(e,t);this._subscriptions.set(e,s)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach((s=>s())),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach((t=>this.unsubscribe(t,e)))}subscribeTargets(e){e.targets.forEach((t=>this.subscribe(t,e)))}onBeforeLayout(e){const{target:t,type:s}=e,{canvas:r}=t;if(s===kg||s===eN?this.subscribeTargets(e):s===vF&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),s===tN&&e.deep){const a=Va(e,Tye);t.forEachObject((o=>o.layoutManager&&o.layoutManager.performLayout(lt(lt({},a),{},{bubbles:!1,target:o}))))}}getLayoutResult(e){const{target:t,strategy:s,type:r}=e,a=s.calcLayoutResult(e,t.getObjects());if(!a)return;const o=r===kg?new Dt:t.getRelativeCenterPoint(),{center:l,correction:c=new Dt,relativeCorrection:u=new Dt}=a,f=o.subtract(l).add(c).transform(r===kg?Vu:Cf(t.calcOwnMatrix()),!0).add(u);return{result:a,prevCenter:o,nextCenter:l,offset:f}}commitLayout(e,t){const{target:s}=e,{result:{size:r},nextCenter:a}=t;var o,l;s.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===kg?s.set({left:(o=e.x)!==null&&o!==void 0?o:a.x+r.x*ml(s.originX),top:(l=e.y)!==null&&l!==void 0?l:a.y+r.y*ml(s.originY)}):(s.setPositionByOrigin(a,Zs,Zs),s.setCoords(),s.set("dirty",!0))}layoutObjects(e,t){const{target:s}=e;s.forEachObject((r=>{r.group===s&&this.layoutObject(e,t,r)})),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,s.clipPath)}layoutObject(e,t,s){let{offset:r}=t;s.set({left:s.left+r.x,top:s.top+r.y})}onAfterLayout(e,t){const{target:s,strategy:r,bubbles:a,prevStrategy:o}=e,l=Va(e,kye),{canvas:c}=s;s.fire("layout:after",{context:e,result:t}),c&&c.fire("object:layout:after",{context:e,result:t,target:s});const u=s.parent;a&&u!=null&&u.layoutManager&&((l.path||(l.path=[])).push(s),u.layoutManager.performLayout(lt(lt({},l),{},{target:u}))),s.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach((t=>t.forEach((s=>s())))),e.clear()}toObject(){return{type:Ite,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};Hn.setClass(MM,Ite);const Eye=["type","objects","layoutManager"];let Iye=class extends MM{performLayout(){}},xm=class jj extends jee(wu){static getDefaults(){return lt(lt({},super.getDefaults()),jj.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),it(this,"_activeObjects",[]),it(this,"__objectSelectionTracker",void 0),it(this,"__objectSelectionDisposer",void 0),Object.assign(this,jj.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var s;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((r=>{this.enterGroup(r,!1)})),this.layoutManager=(s=t.layoutManager)!==null&&s!==void 0?s:new MM,this.layoutManager.performLayout({type:kg,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Lg("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Lg("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter(((t,s,r)=>this.canEnterGroup(t)&&r.indexOf(t)===s))}add(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];const r=this._filterObjectsBeforeEnteringGroup(t),a=super.add(...r);return this._onAfterObjectsChange(eN,r),a}insertAt(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];const a=this._filterObjectsBeforeEnteringGroup(s),o=super.insertAt(e,...a);return this._onAfterObjectsChange(eN,a),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(vF,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const s=this[e];return super._set(e,t),e==="canvas"&&s!==t&&(this._objects||[]).forEach((r=>{r._set(e,t)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:s}=t;const r=this._activeObjects;if(e)r.push(s),this._set("dirty",!0);else if(r.length>0){const a=r.indexOf(s);a>-1&&(r.splice(a,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&s2(e,Qo(Cf(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const s=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();s&&(s===e||e.isDescendantOf(s))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(s2(e,Qo(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const s=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;s>-1&&this._activeObjects.splice(s,1)}shouldCache(){const e=wu.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,s){this._renderBackground(e);for(let a=0;a<this._objects.length;a++){var r;const o=this._objects[a];(r=this.canvas)!==null&&r!==void 0&&r.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Cf(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,s)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((e=>e.setCoords()))}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(lt({target:this,type:tN},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const s=this.includeDefaultValues;return this._objects.filter((function(r){return!r.excludeFromExport})).map((function(r){const a=r.includeDefaultValues;r.includeDefaultValues=s;const o=r[e||"toObject"](t);return r.includeDefaultValues=a,o}))}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return lt(lt(lt({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((e=>{this._watchObject(!1,e),e.dispose()})),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=dm.prototype._toSVG.call(this),s=t.indexOf("COMMON_PARTS");t[s]='for="group" ';const r=t.join("");return e?e(r):r}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],s=this._createSVGBgRect(e);s&&t.push("		",s);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],s=this._createSVGBgRect(e);s&&t.push("	",s);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:s,objects:r=[],layoutManager:a}=e,o=Va(e,Eye);return Promise.all([t2(r,t),mT(o,t)]).then((l=>{let[c,u]=l;const f=new this(c,lt(lt(lt({},o),u),{},{layoutManager:new Iye}));if(a){const d=Hn.getClass(a.type),h=Hn.getClass(a.strategy);f.layoutManager=new d(new h)}else f.layoutManager=new MM;return f.layoutManager.subscribeTargets({type:kg,target:f,targets:f.getObjects()}),f.setCoords(),f}))}};it(xm,"type","Group"),it(xm,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),Hn.setClass(xm);const Ate=(n,e)=>Math.min(e.width/n.width,e.height/n.height),Lte=(n,e)=>Math.max(e.width/n.width,e.height/n.height),Rj="\\s*,?\\s*",UC="".concat(Rj,"(").concat(rp,")"),Aye="".concat(UC).concat(UC).concat(UC).concat(Rj,"([01])").concat(Rj,"([01])").concat(UC).concat(UC),Lye={m:"l",M:"L"},Nye=(n,e,t,s,r,a,o,l,c,u,f)=>{const d=hp(n),h=pp(n),p=hp(e),g=pp(e),b=t*r*p-s*a*g+o,v=s*r*p+t*a*g+l;return["C",u+c*(-t*r*h-s*a*d),f+c*(-s*r*h+t*a*d),b+c*(t*r*g+s*a*p),v+c*(s*r*g-t*a*p),b,v]},LV=(n,e,t,s)=>{const r=Math.atan2(e,n),a=Math.atan2(s,t);return a>=r?a-r:2*Math.PI-(r-a)};function Fj(n,e,t,s,r,a,o,l){let c;if(fi.cachesBoundsOfCurve&&(c=[...arguments].join(),sM.boundsOfCurveCache[c]))return sM.boundsOfCurveCache[c];const u=Math.sqrt,f=Math.abs,d=[],h=[[0,0],[0,0]];let p=6*n-12*t+6*r,g=-3*n+9*t-9*r+3*o,b=3*t-3*n;for(let C=0;C<2;++C){if(C>0&&(p=6*e-12*s+6*a,g=-3*e+9*s-9*a+3*l,b=3*s-3*e),f(g)<1e-12){if(f(p)<1e-12)continue;const A=-b/p;0<A&&A<1&&d.push(A);continue}const M=p*p-4*b*g;if(M<0)continue;const k=u(M),E=(-p+k)/(2*g);0<E&&E<1&&d.push(E);const I=(-p-k)/(2*g);0<I&&I<1&&d.push(I)}let v=d.length;const w=v,x=Dte(n,e,t,s,r,a,o,l);for(;v--;){const{x:C,y:M}=x(d[v]);h[0][v]=C,h[1][v]=M}h[0][w]=n,h[1][w]=e,h[0][w+1]=o,h[1][w+1]=l;const S=[new Dt(Math.min(...h[0]),Math.min(...h[1])),new Dt(Math.max(...h[0]),Math.max(...h[1]))];return fi.cachesBoundsOfCurve&&(sM.boundsOfCurveCache[c]=S),S}const Dye=(n,e,t)=>{let[s,r,a,o,l,c,u,f]=t;const d=((h,p,g,b,v,w,x)=>{if(g===0||b===0)return[];let S=0,C=0,M=0;const k=Math.PI,E=x*Z6,I=pp(E),A=hp(E),D=.5*(-A*h-I*p),L=.5*(-A*p+I*h),P=g**2,j=b**2,G=L**2,Q=D**2,q=P*j-P*G-j*Q;let te=Math.abs(g),Z=Math.abs(b);if(q<0){const Me=Math.sqrt(1-q/(P*j));te*=Me,Z*=Me}else M=(v===w?-1:1)*Math.sqrt(q/(P*G+j*Q));const ne=M*te*L/Z,le=-M*Z*D/te,H=A*ne-I*le+.5*h,R=I*ne+A*le+.5*p;let B=LV(1,0,(D-ne)/te,(L-le)/Z),W=LV((D-ne)/te,(L-le)/Z,(-D-ne)/te,(-L-le)/Z);w===0&&W>0?W-=2*k:w===1&&W<0&&(W+=2*k);const se=Math.ceil(Math.abs(W/k*2)),ue=[],ge=W/se,Ce=8/3*Math.sin(ge/4)*Math.sin(ge/4)/Math.sin(ge/2);let Se=B+ge;for(let Me=0;Me<se;Me++)ue[Me]=Nye(B,Se,A,I,te,Z,H,R,Ce,S,C),S=ue[Me][5],C=ue[Me][6],B=Se,Se+=ge;return ue})(u-n,f-e,r,a,l,c,o);for(let h=0,p=d.length;h<p;h++)d[h][1]+=n,d[h][2]+=e,d[h][3]+=n,d[h][4]+=e,d[h][5]+=n,d[h][6]+=e;return d},Nte=n=>{let e=0,t=0,s=0,r=0;const a=[];let o,l=0,c=0;for(const u of n){const f=[...u];let d;switch(f[0]){case"l":f[1]+=e,f[2]+=t;case"L":e=f[1],t=f[2],d=["L",e,t];break;case"h":f[1]+=e;case"H":e=f[1],d=["L",e,t];break;case"v":f[1]+=t;case"V":t=f[1],d=["L",e,t];break;case"m":f[1]+=e,f[2]+=t;case"M":e=f[1],t=f[2],s=f[1],r=f[2],d=["M",e,t];break;case"c":f[1]+=e,f[2]+=t,f[3]+=e,f[4]+=t,f[5]+=e,f[6]+=t;case"C":l=f[3],c=f[4],e=f[5],t=f[6],d=["C",f[1],f[2],l,c,e,t];break;case"s":f[1]+=e,f[2]+=t,f[3]+=e,f[4]+=t;case"S":o==="C"?(l=2*e-l,c=2*t-c):(l=e,c=t),e=f[3],t=f[4],d=["C",l,c,f[1],f[2],e,t],l=d[3],c=d[4];break;case"q":f[1]+=e,f[2]+=t,f[3]+=e,f[4]+=t;case"Q":l=f[1],c=f[2],e=f[3],t=f[4],d=["Q",l,c,e,t];break;case"t":f[1]+=e,f[2]+=t;case"T":o==="Q"?(l=2*e-l,c=2*t-c):(l=e,c=t),e=f[1],t=f[2],d=["Q",l,c,e,t];break;case"a":f[6]+=e,f[7]+=t;case"A":Dye(e,t,f).forEach((h=>a.push(h))),e=f[6],t=f[7];break;case"z":case"Z":e=s,t=r,d=["Z"]}d?(a.push(d),o=d[0]):o=""}return a},nN=(n,e,t,s)=>Math.sqrt((t-n)**2+(s-e)**2),Dte=(n,e,t,s,r,a,o,l)=>c=>{const u=c**3,f=(p=>3*p**2*(1-p))(c),d=(p=>3*p*(1-p)**2)(c),h=(p=>(1-p)**3)(c);return new Dt(o*u+r*f+t*d+n*h,l*u+a*f+s*d+e*h)},Ote=n=>n**2,Pte=n=>2*n*(1-n),$te=n=>(1-n)**2,Oye=(n,e,t,s,r,a,o,l)=>c=>{const u=Ote(c),f=Pte(c),d=$te(c),h=3*(d*(t-n)+f*(r-t)+u*(o-r)),p=3*(d*(s-e)+f*(a-s)+u*(l-a));return Math.atan2(p,h)},Pye=(n,e,t,s,r,a)=>o=>{const l=Ote(o),c=Pte(o),u=$te(o);return new Dt(r*l+t*c+n*u,a*l+s*c+e*u)},$ye=(n,e,t,s,r,a)=>o=>{const l=1-o,c=2*(l*(t-n)+o*(r-t)),u=2*(l*(s-e)+o*(a-s));return Math.atan2(u,c)},NV=(n,e,t)=>{let s=new Dt(e,t),r=0;for(let a=1;a<=100;a+=1){const o=n(a/100);r+=nN(s.x,s.y,o.x,o.y),s=o}return r},jye=(n,e)=>{let t,s=0,r=0,a={x:n.x,y:n.y},o=lt({},a),l=.01,c=0;const u=n.iterator,f=n.angleFinder;for(;r<e&&l>1e-4;)o=u(s),c=s,t=nN(a.x,a.y,o.x,o.y),t+r>e?(s-=l,l/=2):(a=o,s+=l,r+=t);return lt(lt({},o),{},{angle:f(c)})},_F=n=>{let e,t,s=0,r=0,a=0,o=0,l=0;const c=[];for(const u of n){const f={x:r,y:a,command:u[0],length:0};switch(u[0]){case"M":t=f,t.x=o=r=u[1],t.y=l=a=u[2];break;case"L":t=f,t.length=nN(r,a,u[1],u[2]),r=u[1],a=u[2];break;case"C":e=Dte(r,a,u[1],u[2],u[3],u[4],u[5],u[6]),t=f,t.iterator=e,t.angleFinder=Oye(r,a,u[1],u[2],u[3],u[4],u[5],u[6]),t.length=NV(e,r,a),r=u[5],a=u[6];break;case"Q":e=Pye(r,a,u[1],u[2],u[3],u[4]),t=f,t.iterator=e,t.angleFinder=$ye(r,a,u[1],u[2],u[3],u[4]),t.length=NV(e,r,a),r=u[3],a=u[4];break;case"Z":t=f,t.destX=o,t.destY=l,t.length=nN(r,a,o,l),r=o,a=l}s+=t.length,c.push(t)}return c.push({length:s,x:r,y:a}),c},jte=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_F(n),s=0;for(;e-t[s].length>0&&s<t.length-2;)e-=t[s].length,s++;const r=t[s],a=e/r.length,o=n[s];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return lt(lt({},new Dt(r.x,r.y).lerp(new Dt(r.destX,r.destY),a)),{},{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return lt(lt({},new Dt(r.x,r.y).lerp(new Dt(o[1],o[2]),a)),{},{angle:Math.atan2(o[2]-r.y,o[1]-r.x)});case"C":case"Q":return jye(r,e)}},Rye=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),DV=new RegExp(Aye,"g"),Fye=new RegExp(rp,"gi"),zye={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Rte=n=>{var e;const t=[],s=(e=n.match(Rye))!==null&&e!==void 0?e:[];for(const r of s){const a=r[0];if(a==="z"||a==="Z"){t.push([a]);continue}const o=zye[a.toLowerCase()];let l=[];if(a==="a"||a==="A"){DV.lastIndex=0;for(let c=null;c=DV.exec(r);)l.push(...c.slice(1))}else l=r.match(Fye)||[];for(let c=0;c<l.length;c+=o){const u=new Array(o),f=Lye[a];u[0]=c>0&&f?f:a;for(let d=0;d<o;d++)u[d+1]=parseFloat(l[c+d]);t.push(u)}}return t},Fte=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new Dt(n[0]),s=new Dt(n[1]),r=1,a=0;const o=[],l=n.length,c=l>2;let u;for(c&&(r=n[2].x<s.x?-1:n[2].x===s.x?0:1,a=n[2].y<s.y?-1:n[2].y===s.y?0:1),o.push(["M",t.x-r*e,t.y-a*e]),u=1;u<l;u++){if(!t.eq(s)){const f=t.midPointFrom(s);o.push(["Q",t.x,t.y,f.x,f.y])}t=n[u],u+1<n.length&&(s=n[u+1])}return c&&(r=t.x>n[u-2].x?1:t.x===n[u-2].x?0:-1,a=t.y>n[u-2].y?1:t.y===n[u-2].y?0:-1),o.push(["L",t.x+r*e,t.y+a*e]),o},xF=(n,e)=>n.map((t=>t.map(((s,r)=>r===0||e===void 0?s:ga(s,e))).join(" "))).join(" ");function sN(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach((s=>{let[r,a]=s;return t.setProperty(r,a)})))}const Bye=(n,e)=>Math.floor(Math.random()*(e-n+1))+n;function zte(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||Xy,s=new(I2()).XMLHttpRequest,r=e.signal,a=function(){s.abort()},o=function(){r&&r.removeEventListener("abort",a),s.onerror=s.ontimeout=Xy};if(r&&r.aborted)throw new J6("request");return r&&r.addEventListener("abort",a,{once:!0}),s.onreadystatechange=function(){s.readyState===4&&(o(),t(s),s.onreadystatechange=Xy)},s.onerror=s.ontimeout=o,s.open("get",n,!0),s.send(),s}const aL=(n,e)=>{let t=n._findCenterFromElement();n.transformMatrix&&((s=>{if(s.transformMatrix){const{scaleX:r,scaleY:a,angle:o,skewX:l}=lb(s.transformMatrix);s.flipX=!1,s.flipY=!1,s.set(Wu,r),s.set(vd,a),s.angle=o,s.skewX=l,s.skewY=0}})(n),t=t.transform(n.transformMatrix)),delete n.transformMatrix,e&&(n.scaleX*=e.scaleX,n.scaleY*=e.scaleY,n.cropX=e.cropX,n.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,n.width=e.width,n.height=e.height),n.setPositionByOrigin(t,Zs,Zs)};var Qa=Object.freeze({__proto__:null,addTransformToObject:Qee,animate:gF,animateColor:hte,applyTransformToObject:s2,calcAngleBetweenVectors:JL,calcDimensionsMatrix:pT,calcPlaneChangeMatrix:gT,calcVectorRotation:ute,cancelAnimFrame:Fee,capValue:ub,composeMatrix:Wee,copyCanvasElement:n=>{var e;const t=_d(n);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(n,0,0),t},cos:hp,createCanvasElement:Am,createImage:zee,createRotateMatrix:Rb,createScaleMatrix:w4,createSkewXMatrix:aF,createSkewYMatrix:oF,createTranslateMatrix:N2,createVector:XL,crossProduct:Fv,degreesToRadians:Do,dotProduct:fte,ease:A1e,enlivenObjectEnlivables:mT,enlivenObjects:t2,findScaleToCover:Lte,findScaleToFit:Ate,getBoundsOfCurve:Fj,getOrthonormalVector:pF,getPathSegmentsInfo:_F,getPointOnPath:jte,getPointer:Xee,getRandomInt:Bye,getRegularPolygonPath:(n,e)=>{const t=2*Math.PI/n;let s=-o1;n%2==0&&(s+=t/2);const r=new Array(n+1);for(let a=0;a<n;a++){const o=a*t+s,{x:l,y:c}=new Dt(hp(o),pp(o)).scalarMultiply(e);r[a]=[a===0?"M":"L",l,c]}return r[n]=["Z"],r},getSmoothPathFromPoints:Fte,getSvgAttributes:n=>{const e=["instantiated_by_use","style","id","class"];switch(n){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:x4,groupSVGElements:(n,e)=>n&&n.length===1?n[0]:new xm(n,e),hasStyleChanged:M4,invertTransform:Cf,isBetweenVectors:Lj,isIdentityMatrix:Bee,isTouchEvent:HL,isTransparent:vte,joinPath:xF,loadImage:iM,magnitude:QL,makeBoundingBoxFromPoints:_m,makePathSimpler:Nte,matrixToSVG:n2,mergeClipPaths:(n,e)=>{var t;let s=n,r=e;s.inverted&&!r.inverted&&(s=e,r=n),Ij(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),s.calcTransformMatrix());const a=s.inverted&&r.inverted;return a&&(s.inverted=r.inverted=!1),new xm([s],{clipPath:r,inverted:a})},multiplyTransformMatrices:Qo,multiplyTransformMatrixArray:b4,parsePath:Rte,parsePreserveAspectRatioAttribute:dF,parseUnit:$u,pick:Fb,projectStrokeOnPoints:Cte,qrDecompose:lb,radiansToDegrees:Lm,removeFromArray:Oy,removeTransformFromObject:(n,e)=>{const t=Cf(e),s=Qo(t,n.calcOwnMatrix());s2(n,s)},removeTransformMatrixForSvgParsing:aL,request:zte,requestAnimFrame:rM,resetObjectTransform:Jee,rotatePoint:(n,e,t)=>n.rotate(t,e),rotateVector:hF,saveObjectTransform:uF,sendObjectToPlane:Ij,sendPointToPlane:Qy,sendVectorToPlane:Zee,setStyle:sN,sin:pp,sizeAfterTransform:v4,string:iye,stylesFromArray:Tte,stylesToArray:Mte,toBlob:iF,toDataURL:rF,toFixed:ga,transformPath:(n,e,t)=>(t&&(e=Qo(e,[1,0,0,1,-t.x,-t.y])),n.map((s=>{const r=[...s];for(let a=1;a<s.length-1;a+=2){const{x:o,y:l}=du({x:s[a],y:s[a+1]},e);r[a]=o,r[a+1]=l}return r}))),transformPoint:du});class Uye extends Yee{constructor(e){let{allowTouchScrolling:t=!1,containerClass:s=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),it(this,"upper",void 0),it(this,"container",void 0);const{el:r}=this.lower,a=this.createUpperCanvas();this.upper={el:a,ctx:a.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(a,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(s),r.parentNode&&r.parentNode.replaceChild(o,r),o.append(r,a),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=Am();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=E2().createElement("div");return e.setAttribute("data-fabric","wrapper"),sN(e,{position:"relative"}),sV(e),e}applyCanvasStyle(e,t){const{styles:s,allowTouchScrolling:r}=t;sN(e,lt(lt({},s),{},{"touch-action":r?"manipulation":zu})),sV(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:s,ctx:r}=this.upper;qee(s,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),Ej(this.upper.el,e),Ej(this.container,e)}cleanupDOM(e){const t=this.container,{el:s}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(s),t.parentNode&&t.parentNode.replaceChild(s,t)}dispose(){super.dispose(),Im().dispose(this.upper.el),delete this.upper,delete this.container}}class k4 extends cF{constructor(){super(...arguments),it(this,"targets",[]),it(this,"_hoveredTargets",[]),it(this,"_currentTransform",null),it(this,"_groupSelector",null),it(this,"contextTopDirty",!1)}static getDefaults(){return lt(lt({},super.getDefaults()),k4.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new Uye(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter((t=>!t.group&&t!==e)).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),s=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=s,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,s){const r=this.targetFindTolerance,a=this.pixelFindContext;this.clearContext(a),a.save(),a.translate(-t+r,-s+r),a.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(a),e.selectionBackgroundColor=o,a.restore();const l=Math.round(r*this.getRetinaScaling());return vte(a,l,l,l)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find((s=>!!s&&e[s]===!0)):e[t])}_shouldClearSelection(e,t){const s=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&s.length>1&&s.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,s){if(!e)return;let r;return t===y4||t===Wu||t===vd||t===CM?r=this.centeredScaling||e.centeredScaling:t===nF&&(r=this.centeredRotation||e.centeredRotation),r?!s:s}_getOriginFromCorner(e,t){const s={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?s.x=Ho:["mr","tr","br"].includes(t)&&(s.x=Ri),["tl","mt","tr"].includes(t)?s.y=kj:["bl","mb","br"].includes(t)&&(s.y=Sf)),s}_setupCurrentTransform(e,t,s){var r;const a=t.group?Qy(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:l}=t.getActiveControl()||{},c=s&&l?(r=l.getActionHandler(e,t,l))===null||r===void 0?void 0:r.bind(l):v1e,u=((p,g,b,v)=>{if(!g||!p)return"drag";const w=v.controls[g];return w.getActionName(b,w,v)})(s,o,e,t),f=e[this.centeredKey],d=this._shouldCenterTransform(t,u,f)?{x:Zs,y:Zs}:this._getOriginFromCorner(t,o),h={target:t,action:u,actionHandler:c,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:a.x-t.left,offsetY:a.y-t.top,originX:d.x,originY:d.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:Do(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:f,original:lt(lt({},uF(t)),{},{originX:d.x,originY:d.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:s,deltaX:r,deltaY:a}=this._groupSelector,o=new Dt(t,s).transform(this.viewportTransform),l=new Dt(t+r,s+a).transform(this.viewportTransform),c=this.selectionLineWidth/2;let u=Math.min(o.x,l.x),f=Math.min(o.y,l.y),d=Math.max(o.x,l.x),h=Math.max(o.y,l.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(u,f,d-u,h-f)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,u+=c,f+=c,d-=c,h-=c,wu.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(u,f,d-u,h-f))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),s=this._activeObject,r=this.getActiveObjects();if(this.targets=[],s&&r.length>=1){if(s.findControl(t,HL(e))||r.length>1&&this.searchPossibleTargets([s],t))return s;if(s===this.searchPossibleTargets([s],t)){if(this.preserveObjectStacking){const a=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==s?(this.targets=a,s):o}return s}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let s=e.getCoords();const r=this.getZoom(),a=e.padding/r;if(a){const[o,l,c,u]=s,f=Math.atan2(l.y-o.y,l.x-o.x),d=hp(f)*a,h=pp(f)*a,p=d+h,g=d-h;s=[new Dt(o.x-g,o.y-p),new Dt(l.x+p,l.y-g),new Dt(c.x+g,c.y+p),new Dt(u.x-p,u.y+g)]}return lM.isPointInPolygon(t,s)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,Qy(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let s=e.length;for(;s--;){const r=e[s];if(this._checkTarget(r,t)){if(nL(r)&&r.subTargetCheck){const a=this._searchPossibleTargets(r._objects,t);a&&this.targets.push(a)}return r}}}searchPossibleTargets(e,t){const s=this._searchPossibleTargets(e,t);if(s&&nL(s)&&s.interactive&&this.targets[0]){const r=this.targets;for(let a=r.length-1;a>0;a--){const o=r[a];if(!nL(o)||!o.interactive)return o}return r[0]}return s}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=this.upperCanvasEl,r=s.getBoundingClientRect();let a=Xee(e),o=r.width||0,l=r.height||0;o&&l||(Sf in r&&kj in r&&(l=Math.abs(r.top-r.bottom)),Ho in r&&Ri in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,t||(a=Qy(a,void 0,this.viewportTransform));const c=this.getRetinaScaling();c!==1&&(a.x/=c,a.y/=c);const u=o===0||l===0?new Dt(1,1):new Dt(s.width/o,s.height/l);return a.multiply(u)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Am(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Py(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let s=!1,r=!1;const a=this.getActiveObjects(),o=[],l=[];e.forEach((c=>{a.includes(c)||(s=!0,c.fire("deselected",{e:t,target:c}),l.push(c))})),a.forEach((c=>{e.includes(c)||(s=!0,c.fire("selected",{e:t,target:c}),o.push(c))})),e.length>0&&a.length>0?(r=!0,s&&this.fire("selection:updated",{e:t,selected:o,deselected:l})):a.length>0?(r=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:l})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){const s=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(s,t),r}_setActiveObject(e,t){const s=this._activeObject;return s!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Py(e)&&s!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const s=this._activeObject;return!!s&&!s.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===s&&this.endCurrentTransform(e),Py(s)&&s===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),s=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[s]});const r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,s=t.target,r={e,target:s,transform:t,action:t.action};s._scaling&&(s._scaling=!1),s.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),s.fire(WL,r))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Py(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,s){const r=this._realizeGroupTransformOnObject(e),a=super._toObject(e,t,s);return e.set(r),a}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Py(t)&&this._activeObject===t){const s=Fb(e,["angle","flipX","flipY",Ri,Wu,vd,A2,L2,Sf]);return Qee(e,t.calcOwnMatrix()),s}return{}}_setSVGObject(e,t,s){const r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,s),t.set(r)}}it(k4,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Vye{constructor(e){it(this,"targets",[]),it(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},s=e.upperCanvasEl;s.addEventListener("click",t),this.__disposer=()=>s.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach((e=>{e.isEditing&&e.exitEditing()}))}add(e){this.targets.push(e)}remove(e){this.unregister(e),Oy(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Wye=["target","oldTarget","fireCanvas","e"],nd={passive:!1},uv=(n,e)=>{const t=n.getViewportPoint(e),s=n.getScenePoint(e);return{viewportPoint:t,scenePoint:s,pointer:t,absolutePointer:s}},L0=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return n.addEventListener(...t)},Yd=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return n.removeEventListener(...t)},Gye={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};let zj=class extends k4{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),it(this,"_isClick",void 0),it(this,"textEditingManager",new Vye(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((t=>{this[t]=this[t].bind(this)})),this.addOrRemove(L0,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const s=this.upperCanvasEl,r=this._getEventPrefix();e(Hee(s),"resize",this._onResize),e(s,r+"down",this._onMouseDown),e(s,"".concat(r,"move"),this._onMouseMove,nd),e(s,"".concat(r,"out"),this._onMouseOut),e(s,"".concat(r,"enter"),this._onMouseEnter),e(s,"wheel",this._onMouseWheel,{passive:!1}),e(s,"contextmenu",this._onContextMenu),e(s,"click",this._onClick),e(s,"dblclick",this._onClick),e(s,"dragstart",this._onDragStart),e(s,"dragend",this._onDragEnd),e(s,"dragover",this._onDragOver),e(s,"dragenter",this._onDragEnter),e(s,"dragleave",this._onDragLeave),e(s,"drop",this._onDrop),this.enablePointerEvents||e(s,"touchstart",this._onTouchStart,nd)}removeListeners(){this.addOrRemove(Yd,"remove");const e=this._getEventPrefix(),t=np(this.upperCanvasEl);Yd(t,"".concat(e,"up"),this._onMouseUp),Yd(t,"touchend",this._onTouchEnd,nd),Yd(t,"".concat(e,"move"),this._onMouseMove,nd),Yd(t,"touchmove",this._onMouseMove,nd),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,s=lt({e},uv(this,e));this.fire("mouse:out",lt(lt({},s),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",lt({},s)),this._hoveredTargets.forEach((r=>{this.fire("mouse:out",lt(lt({},s),{},{target:r})),r&&r.fire("mouseout",lt({},s))})),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",lt({e},uv(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const s={e,target:t};return this.fire("dragstart",s),t.fire("dragstart",s),void L0(this.upperCanvasEl,"drag",this._onDragProgress)}rV(e)}_renderDragEffects(e,t,s){let r=!1;const a=this._dropTarget;a&&a!==t&&a!==s&&(a.clearContextTop(),r=!0),t?.clearContextTop(),s!==t&&s?.clearContextTop();const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),r=!0),s&&(o.save(),s.transform(o),s.renderDropTargetEffect(e),o.restore(),r=!0),o.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==zu,s=t?this._activeObject:void 0,r={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:s};Yd(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",r),this._dragSource&&this._dragSource.fire("dragend",r),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:s,targets:r}=this.findDragTargets(e),a=this._dragSource,o={e,target:s,subTargets:r,dragSource:a,canDrop:!1,dropTarget:void 0};let l;this.fire(t,o),this._fireEnterLeaveEvents(s,o),s&&(s.canDrop(e)&&(l=s),s.fire(t,o));for(let c=0;c<r.length;c++){const u=r[c];u.canDrop(e)&&(l=u),u.fire(t,o)}this._renderDragEffects(e,a,l),this._dropTarget=l}_onDragEnter(e){const{target:t,targets:s}=this.findDragTargets(e),r={e,target:t,subTargets:s,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(t,r)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:s}=this.findDragTargets(e),r=this._basicEventHandler("drop:before",lt({e,target:t,subTargets:s,dragSource:this._dragSource},uv(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){const t=this.findTarget(e),s=this.targets||[],r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:s});return this.stopContextMenu&&rV(e),this._basicEventHandler("contextmenu",r),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const s=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||s&&this._target===s)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const r=this.upperCanvasEl,a=this._getEventPrefix(),o=np(r);L0(o,"touchend",this._onTouchEnd,nd),t&&L0(o,"touchmove",this._onMouseMove,nd),Yd(r,"".concat(a,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,s=this._getEventPrefix();Yd(t,"".concat(s,"move"),this._onMouseMove,nd);const r=np(t);L0(r,"".concat(s,"up"),this._onMouseUp),L0(r,"".concat(s,"move"),this._onMouseMove,nd)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),s=np(this.upperCanvasEl);Yd(s,"touchend",this._onTouchEnd,nd),Yd(s,"touchmove",this._onMouseMove,nd),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{L0(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,s=this._getEventPrefix();if(this._isMainEvent(e)){const r=np(this.upperCanvasEl);Yd(r,"".concat(s,"up"),this._onMouseUp),Yd(r,"".concat(s,"move"),this._onMouseMove,nd),L0(t,"".concat(s,"move"),this._onMouseMove,nd)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const s=this._currentTransform,r=this._isClick,a=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let l,c,u=!1;if(s&&(this._finalizeCurrentTransform(e),u=s.actionPerformed),!r){const f=a===this._activeObject;this.handleSelection(e),u||(u=this._shouldRender(a)||!f&&a===this._activeObject)}if(a){const f=a.findControl(this.getViewportPoint(e),HL(e)),{key:d,control:h}=f||{};if(c=d,a.selectable&&a!==this._activeObject&&a.activeOn==="up")this.setActiveObject(a,e),u=!0;else if(h){const p=h.getMouseUpHandler(e,a,h);p&&(l=this.getScenePoint(e),p.call(h,e,s,l.x,l.y))}a.isMoving=!1}if(s&&(s.target!==a||s.corner!==c)){const f=s.target&&s.target.controls[s.corner],d=f&&f.getMouseUpHandler(e,s.target,f);l=l||this.getScenePoint(e),d&&d.call(f,e,s,l.x,l.y)}this._setCursorFromEvent(e,a),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,a&&(a.__corner=void 0),u?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:s,subTargets:r=[]}=t;this.fire(e,t),s&&s.fire(e,t);for(let a=0;a<r.length;a++)r[a]!==s&&r[a].fire(e,t);return t}_handleEvent(e,t,s){const r=this._target,a=this.targets||[],o=lt(lt(lt({e,target:r,subTargets:a},uv(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?s:{});this.fire("mouse:".concat(t),o),r&&r.fire("mouse".concat(t),o);for(let l=0;l<a.length;l++)a[l]!==r&&a[l].fire("mouse".concat(t),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,s=!!t&&t===this._activeObject;const{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down",{alreadySelected:s}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let a=this._shouldRender(t),o=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,o=!0,a=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const l=this.getScenePoint(e);this._groupSelector={x:l.x,y:l.y,deltaY:0,deltaX:0}}if(s=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const l=t.findControl(this.getViewportPoint(e),HL(e));if(t===this._activeObject&&(l||!o)){this._setupCurrentTransform(e,t,s);const c=l?l.control:void 0,u=this.getScenePoint(e),f=c&&c.getMouseDownHandler(e,t,c);f&&f.call(c,e,this._currentTransform,u.x,u.y)}}a&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:s}),a&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=Qy(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const s=this.getScenePoint(e);t.deltaX=s.x-t.x,t.deltaY=s.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const s=this.findTarget(e);this._setCursorFromEvent(e,s),this._fireOverOutEvents(e,s)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const s=this._hoveredTarget,r=this._hoveredTargets,a=this.targets,o=Math.max(r.length,a.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:s,fireCanvas:!0});for(let l=0;l<o;l++)a[l]===t||r[l]&&r[l]===s||this.fireSyntheticInOutEvents("mouse",{e,target:a[l],oldTarget:r[l]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const s=this._draggedoverTarget,r=this._hoveredTargets,a=this.targets,o=Math.max(r.length,a.length);this.fireSyntheticInOutEvents("drag",lt(lt({},t),{},{target:e,oldTarget:s,fireCanvas:!0}));for(let l=0;l<o;l++)this.fireSyntheticInOutEvents("drag",lt(lt({},t),{},{target:a[l],oldTarget:r[l]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:s,oldTarget:r,fireCanvas:a,e:o}=t,l=Va(t,Wye);const{targetIn:c,targetOut:u,canvasIn:f,canvasOut:d}=Gye[e],h=r!==s;if(r&&h){const p=lt(lt({},l),{},{e:o,target:r,nextTarget:s},uv(this,o));a&&this.fire(d,p),r.fire(u,p)}if(s&&h){const p=lt(lt({},l),{},{e:o,target:s,previousTarget:r},uv(this,o));a&&this.fire(f,p),s.fire(c,p)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),s=this._currentTransform,r=s.target,a=r.group?Qy(t,void 0,r.group.calcTransformMatrix()):t;s.shiftKey=e.shiftKey,s.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,s,a),s.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,s){const{action:r,actionHandler:a,target:o}=t,l=!!a&&a(e,t,s.x,s.y);l&&o.setCoords(),r==="drag"&&l&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||l}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let s=t.hoverCursor||this.hoverCursor;const r=Py(this._activeObject)?this._activeObject:null,a=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(a){const o=a.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map((o=>{s=o.hoverCursor||s})),this.setCursor(s)}handleMultiSelection(e,t){const s=this._activeObject,r=Py(s);if(s&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(s!==t||r)&&(r||!t.isDescendantOf(s)&&!s.isDescendantOf(t))&&!t.onSelect({e})&&!s.getActiveControl()){if(r){const a=s.getObjects();if(t===s){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(a,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===s?(s.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],s.size()===1&&this._setActiveObject(s.item(0),e)):(s.multiSelectAdd(t),this._hoveredTarget=s,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(a,e)}else{s.isEditing&&s.exitEditing();const a=new(Hn.getClass("ActiveSelection"))([],{canvas:this});a.multiSelectAdd(s,t),this._hoveredTarget=a,this._setActiveObject(a,e),this._fireSelectionEvents([s],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:s,deltaX:r,deltaY:a}=this._groupSelector,o=new Dt(t,s),l=o.add(new Dt(r,a)),c=o.min(l),u=o.max(l).subtract(c),f=this.collectObjects({left:c.x,top:c.y,width:u.x,height:u.y},{includeIntersecting:!this.selectionFullyContained}),d=o.eq(l)?f[0]?[f[0]]:[]:f.length>1?f.filter((h=>!h.onSelect({e}))).reverse():f;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){const h=Hn.getClass("ActiveSelection");this.setActiveObject(new h(d,{canvas:this}),e)}return this._groupSelector=null,!0}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;const{upper:s}=this.elements;s.ctx=void 0;const r=super.toCanvasElement(e,t);return s.ctx=s.el.getContext("2d"),r}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}};const Bte={x1:0,y1:0,x2:0,y2:0},Hye=lt(lt({},Bte),{},{r1:0,r2:0}),Dv=(n,e)=>isNaN(n)&&typeof e=="number"?e:n;function Ute(n){return n&&/%$/.test(n)&&Number.isFinite(parseFloat(n))}function Vte(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(Ute(n)?100:1):NaN;return ub(0,Dv(t,e),1)}const qye=/\s*;\s*/,Yye=/\s*:\s*/;function Kye(n,e){let t,s;const r=n.getAttribute("style");if(r){const o=r.split(qye);o[o.length-1]===""&&o.pop();for(let l=o.length;l--;){const[c,u]=o[l].split(Yye).map((f=>f.trim()));c==="stop-color"?t=u:c==="stop-opacity"&&(s=u)}}const a=new kf(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:Vte(n.getAttribute("offset"),0),color:a.toRgb(),opacity:Dv(parseFloat(s||n.getAttribute("stop-opacity")||""),1)*a.getAlpha()*e}}function Xye(n,e){const t=[],s=n.getElementsByTagName("stop"),r=Vte(e,1);for(let a=s.length;a--;)t.push(Kye(s[a],r));return t}function Wte(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function Gte(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function zh(n,e){return n.getAttribute(e)}function Qye(n,e){return(function(t,s){let r,{width:a,height:o,gradientUnits:l}=s;return Object.entries(t).reduce(((c,u)=>{let[f,d]=u;if(d==="Infinity")r=1;else if(d==="-Infinity")r=0;else{const h=typeof d=="string";r=h?parseFloat(d):d,h&&Ute(d)&&(r*=.01,l==="pixels"&&(f!=="x1"&&f!=="x2"&&f!=="r2"||(r*=a),f!=="y1"&&f!=="y2"||(r*=o)))}return c[f]=r,c}),{})})(Wte(n)==="linear"?(function(t){return{x1:zh(t,"x1")||0,y1:zh(t,"y1")||0,x2:zh(t,"x2")||"100%",y2:zh(t,"y2")||0}})(n):(function(t){return{x1:zh(t,"fx")||zh(t,"cx")||"50%",y1:zh(t,"fy")||zh(t,"cy")||"50%",r1:0,x2:zh(t,"cx")||"50%",y2:zh(t,"cy")||"50%",r2:zh(t,"r")||"50%"}})(n),lt(lt({},e),{},{gradientUnits:Gte(n)}))}class Ov{constructor(e){const{type:t="linear",gradientUnits:s="pixels",coords:r={},colorStops:a=[],offsetX:o=0,offsetY:l=0,gradientTransform:c,id:u}=e||{};Object.assign(this,{type:t,gradientUnits:s,coords:lt(lt({},t==="radial"?Hye:Bte),r),colorStops:a,offsetX:o,offsetY:l,gradientTransform:c,id:u?"".concat(u,"_").concat(l1()):l1()})}addColorStop(e){for(const t in e){const s=new kf(e[t]);this.colorStops.push({offset:parseFloat(t),color:s.toRgb(),opacity:s.getAlpha()})}return this}toObject(e){return lt(lt({},Fb(this,e)),{},{type:this.type,coords:lt({},this.coords),colorStops:this.colorStops.map((t=>lt({},t))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[],r=this.gradientTransform?this.gradientTransform.concat():Vu.concat(),a=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map((d=>lt({},d))).sort(((d,h)=>d.offset-h.offset));let l=-this.offsetX,c=-this.offsetY;var u;a==="objectBoundingBox"?(l/=e.width,c/=e.height):(l+=e.width/2,c+=e.height/2),(u=e)&&typeof u._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=e.pathOffset.x,c-=e.pathOffset.y),r[4]-=l,r[5]-=c;const f=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(a,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(n2(r),'"'),""].join(" ");if(this.type==="linear"){const{x1:d,y1:h,x2:p,y2:g}=this.coords;s.push("<linearGradient ",f,' x1="',d,'" y1="',h,'" x2="',p,'" y2="',g,`">
`)}else if(this.type==="radial"){const{x1:d,y1:h,x2:p,y2:g,r1:b,r2:v}=this.coords,w=b>v;s.push("<radialGradient ",f,' cx="',w?d:p,'" cy="',w?h:g,'" r="',w?b:v,'" fx="',w?p:d,'" fy="',w?g:h,`">
`),w&&(o.reverse(),o.forEach((S=>{S.offset=1-S.offset})));const x=Math.min(b,v);if(x>0){const S=x/Math.max(b,v);o.forEach((C=>{C.offset+=S*(1-C.offset)}))}}return o.forEach((d=>{let{color:h,offset:p,opacity:g}=d;s.push("<stop ",'offset="',100*p+"%",'" style="stop-color:',h,g!==void 0?";stop-opacity: "+g:";",`"/>
`)})),s.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),s.join("")}toLive(e){const{x1:t,y1:s,x2:r,y2:a,r1:o,r2:l}=this.coords,c=this.type==="linear"?e.createLinearGradient(t,s,r,a):e.createRadialGradient(t,s,o,r,a,l);return this.colorStops.forEach((u=>{let{color:f,opacity:d,offset:h}=u;c.addColorStop(h,d!==void 0?new kf(f).setAlpha(d).toRgba():f)})),c}static async fromObject(e){const{colorStops:t,gradientTransform:s}=e;return new this(lt(lt({},e),{},{colorStops:t?t.map((r=>lt({},r))):void 0,gradientTransform:s?[...s]:void 0}))}static fromElement(e,t,s){const r=Gte(e),a=t._findCenterFromElement();return new this(lt({id:e.getAttribute("id")||void 0,type:Wte(e),coords:Qye(e,{width:s.viewBoxWidth||s.width,height:s.viewBoxHeight||s.height}),colorStops:Xye(e,s.opacity),gradientUnits:r,gradientTransform:ZL(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-a.x,offsetY:t.height/2-a.y}:{offsetX:0,offsetY:0}))}}it(Ov,"type","Gradient"),Hn.setClass(Ov,"gradient"),Hn.setClass(Ov,"linear"),Hn.setClass(Ov,"radial");const Jye=["type","source","patternTransform"];let oL=class{get type(){return"pattern"}set type(e){Lg("warn","Setting type has no effect",e)}constructor(e){it(this,"repeat","repeat"),it(this,"offsetX",0),it(this,"offsetY",0),it(this,"crossOrigin",""),this.id=l1(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:s}=this;return lt(lt({},Fb(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:s,offsetX:ga(this.offsetX,fi.NUM_FRACTION_DIGITS),offsetY:ga(this.offsetY,fi.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:s}=e;const{source:r,repeat:a,id:o}=this,l=Dv(this.offsetX/t,0),c=Dv(this.offsetY/s,0),u=a==="repeat-y"||a==="no-repeat"?1+Math.abs(l||0):Dv(r.width/t,0),f=a==="repeat-x"||a==="no-repeat"?1+Math.abs(c||0):Dv(r.height/s,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(l,'" y="').concat(c,'" width="').concat(u,'" height="').concat(f,'">'),'<image x="0" y="0" width="'.concat(r.width,'" height="').concat(r.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:s,source:r,patternTransform:a}=e,o=Va(e,Jye);const l=await iM(r,lt(lt({},t),{},{crossOrigin:o.crossOrigin}));return new this(lt(lt({},o),{},{patternTransform:a&&a.slice(0),source:l}))}};it(oL,"type","Pattern"),Hn.setClass(oL),Hn.setClass(oL,"pattern");let Zye=class{constructor(e){it(this,"color","rgb(0, 0, 0)"),it(this,"width",1),it(this,"shadow",null),it(this,"strokeLineCap","round"),it(this,"strokeLineJoin","round"),it(this,"strokeMiterLimit",10),it(this,"strokeDashArray",null),it(this,"limitedToCanvasSize",!1),this.canvas=e}_setBrushStyles(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])}_saveAndTransform(e){const t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}needsFullRender(){return new kf(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const e=this.canvas,t=this.shadow,s=e.contextTop,r=e.getZoom()*e.getRetinaScaling();s.shadowColor=t.color,s.shadowBlur=t.blur*r,s.shadowOffsetX=t.offsetX*r,s.shadowOffsetY=t.offsetY*r}_resetShadow(){const e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}_isOutSideCanvas(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}};const ebe=["path","left","top"],tbe=["d"];let Cg=class Hte extends wu{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:s,left:r,top:a}=t,o=Va(t,ebe);super(),Object.assign(this,Hte.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof r=="number"&&this.set(Ri,r),typeof a=="number"&&this.set(Sf,a)}_setPath(e,t){this.path=Nte(Array.isArray(e)?e:Rte(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Dt(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,s=-this.pathOffset.y;e.beginPath();for(const r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+s);break;case"M":e.moveTo(r[1]+t,r[2]+s);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+s,r[3]+t,r[4]+s,r[5]+t,r[6]+s);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+s,r[3]+t,r[4]+s);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return lt(lt({},super.toObject(e)),{},{path:this.path.map((t=>t.slice()))})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=xF(this.path,fi.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=fi.NUM_FRACTION_DIGITS;return" translate(".concat(ga(-this.pathOffset.x,e),", ").concat(ga(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:s,pathOffset:r}=this._calcDimensions();this.set({width:t,height:s,pathOffset:r}),e&&this.setPositionByOrigin(r,Zs,Zs)}_calcBoundsFromPath(){const e=[];let t=0,s=0,r=0,a=0;for(const o of this.path)switch(o[0]){case"L":r=o[1],a=o[2],e.push({x:t,y:s},{x:r,y:a});break;case"M":r=o[1],a=o[2],t=r,s=a;break;case"C":e.push(...Fj(r,a,o[1],o[2],o[3],o[4],o[5],o[6])),r=o[5],a=o[6];break;case"Q":e.push(...Fj(r,a,o[1],o[2],o[1],o[2],o[3],o[4])),r=o[3],a=o[4];break;case"Z":r=t,a=s}return _m(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return lt(lt({},e),{},{pathOffset:new Dt(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,s){const r=Ug(e,this.ATTRIBUTE_NAMES,s),{d:a}=r;return new this(a,lt(lt(lt({},Va(r,tbe)),t),{},{left:void 0,top:void 0}))}};it(Cg,"type","Path"),it(Cg,"cacheProperties",[...Bg,"path","fillRule"]),it(Cg,"ATTRIBUTE_NAMES",[...x1,"d"]),Hn.setClass(Cg),Hn.setSVGClass(Cg);let nbe=class Bj extends Zye{constructor(e){super(e),it(this,"decimate",.4),it(this,"drawStraightLine",!1),it(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(e,t,s){const r=t.midPointFrom(s);return e.quadraticCurveTo(t.x,t.y,r.x,r.y),r}onMouseDown(e,t){let{e:s}=t;this.canvas._isMainEvent(s)&&(this.drawStraightLine=!!this.straightLineKey&&s[this.straightLineKey],this._prepareForDrawing(e),this._addPoint(e),this._render())}onMouseMove(e,t){let{e:s}=t;if(this.canvas._isMainEvent(s)&&(this.drawStraightLine=!!this.straightLineKey&&s[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(e))&&this._addPoint(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const r=this._points,a=r.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=Bj.drawSegment(o,r[a-2],r[a-1]),o.stroke(),o.restore()}}onMouseUp(e){let{e:t}=e;return!this.canvas._isMainEvent(t)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(e){this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)}_addPoint(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,t=this._points[0],s=this._points[1];if(this._saveAndTransform(e),e.beginPath(),this._points.length===2&&t.x===s.x&&t.y===s.y){const r=this.width/1e3;t.x-=r,s.x+=r}e.moveTo(t.x,t.y);for(let r=1;r<this._points.length;r++)Bj.drawSegment(e,t,s),t=this._points[r],s=this._points[r+1];e.lineTo(t.x,t.y),e.stroke(),e.restore()}convertPointsToSVGPath(e){const t=this.width/1e3;return Fte(e,t)}createPath(e){const t=new Cg(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new zv(this.shadow)),t}decimatePoints(e,t){if(e.length<=2)return e;let s,r=e[0];const a=this.canvas.getZoom(),o=Math.pow(t/a,2),l=e.length-1,c=[r];for(let u=1;u<l-1;u++)s=Math.pow(r.x-e[u].x,2)+Math.pow(r.y-e[u].y,2),s>=o&&(r=e[u],c.push(r));return c.push(e[l]),c}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const e=this.convertPointsToSVGPath(this._points);if((function(s){return xF(s)==="M 0 0 Q 0 0 0 0 L 0 0"})(e))return void this.canvas.requestRenderAll();const t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}};const sbe=["left","top","radius"],qte=["radius","startAngle","endAngle","counterClockwise"];let Ty=class Uj extends wu{static getDefaults(){return lt(lt({},super.getDefaults()),Uj.ownDefaults)}constructor(e){super(),Object.assign(this,Uj.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Do(this.startAngle),Do(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Wu)}getRadiusY(){return this.get("radius")*this.get(vd)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...qte,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,s=Do(this.startAngle),r=Do(this.endAngle),a=hp(s)*t,o=pp(s)*t,l=hp(r)*t,c=pp(r)*t,u=e>180?1:0,f=this.counterClockwise?0:1;return['<path d="M '.concat(a," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(u," ").concat(f," ").concat(l," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,s){const r=Ug(e,this.ATTRIBUTE_NAMES,s),{left:a=0,top:o=0,radius:l=0}=r;return new this(lt(lt({},Va(r,sbe)),{},{radius:l,left:a-l,top:o-l}))}static fromObject(e){return super._fromObject(e)}};it(Ty,"type","Circle"),it(Ty,"cacheProperties",[...Bg,...qte]),it(Ty,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),it(Ty,"ATTRIBUTE_NAMES",["cx","cy","r",...x1]),Hn.setClass(Ty),Hn.setSVGClass(Ty);const rbe=["x1","y1","x2","y2"],ibe=["x1","y1","x2","y2"],Vj=["x1","x2","y1","y2"];let W0=class Yte extends wu{constructor(){let[e,t,s,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Yte.ownDefaults),this.setOptions(a),this.x1=e,this.x2=s,this.y1=t,this.y2=r,this._setWidthHeight();const{left:o,top:l}=a;typeof o=="number"&&this.set(Ri,o),typeof l=="number"&&this.set(Sf,l)}_setWidthHeight(){const{x1:e,y1:t,x2:s,y2:r}=this;this.width=Math.abs(s-e),this.height=Math.abs(r-t);const{left:a,top:o,width:l,height:c}=_m([{x:e,y:t},{x:s,y:r}]),u=new Dt(a+l/2,o+c/2);this.setPositionByOrigin(u,Zs,Zs)}_set(e,t){return super._set(e,t),Vj.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const s=e.strokeStyle;var r;ah(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=s}_findCenterFromElement(){return new Dt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return lt(lt({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:s,y2:r,width:a,height:o}=this,l=e<=t?-1:1,c=s<=r?-1:1;return{x1:l*a/2,x2:l*-a/2,y1:c*o/2,y2:c*-o/2}}_toSVG(){const{x1:e,x2:t,y1:s,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(s,'" x2="').concat(t,'" y2="').concat(r,`" />
`)]}static async fromElement(e,t,s){const r=Ug(e,this.ATTRIBUTE_NAMES,s),{x1:a=0,y1:o=0,x2:l=0,y2:c=0}=r;return new this([a,o,l,c],Va(r,rbe))}static fromObject(e){let{x1:t,y1:s,x2:r,y2:a}=e,o=Va(e,ibe);return this._fromObject(lt(lt({},o),{},{points:[t,s,r,a]}),{extraParam:"points"})}};it(W0,"type","Line"),it(W0,"cacheProperties",[...Bg,...Vj]),it(W0,"ATTRIBUTE_NAMES",x1.concat(Vj)),Hn.setClass(W0),Hn.setSVGClass(W0);let xS=class Wj extends wu{static getDefaults(){return lt(lt({},super.getDefaults()),Wj.ownDefaults)}constructor(e){super(),Object.assign(this,Wj.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,s=this.height/2;e.beginPath(),e.moveTo(-t,s),e.lineTo(0,-s),e.lineTo(t,s),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}};it(xS,"type","Triangle"),it(xS,"ownDefaults",{width:100,height:100}),Hn.setClass(xS),Hn.setSVGClass(xS);const Kte=["rx","ry"];let fv=class Gj extends wu{static getDefaults(){return lt(lt({},super.getDefaults()),Gj.ownDefaults)}constructor(e){super(),Object.assign(this,Gj.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Wu)}getRy(){return this.get("ry")*this.get(vd)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Kte,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Ng,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,s){const r=Ug(e,this.ATTRIBUTE_NAMES,s);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)}};function abe(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let s=0;s<e.length;s+=2)t.push({x:parseFloat(e[s]),y:parseFloat(e[s+1])});return t}it(fv,"type","Ellipse"),it(fv,"cacheProperties",[...Bg,...Kte]),it(fv,"ownDefaults",{rx:0,ry:0}),it(fv,"ATTRIBUTE_NAMES",[...x1,"cx","cy","rx","ry"]),Hn.setClass(fv),Hn.setSVGClass(fv);const obe=["left","top"],Xte={exactBoundingBox:!1};let z0=class Hj extends wu{static getDefaults(){return lt(lt({},super.getDefaults()),Hj.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),it(this,"strokeDiff",void 0),Object.assign(this,Hj.ownDefaults),this.setOptions(t),this.points=e;const{left:s,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof s=="number"&&this.set(Ri,s),typeof r=="number"&&this.set(Sf,r)}isOpen(){return!0}_projectStrokeOnPoints(e){return Cte(this.points,e,this.isOpen())}_calcDimensions(e){e=lt({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map((u=>u.projectedPoint)):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Dt,strokeOffset:new Dt,strokeDiff:new Dt};const s=_m(t),r=pT(lt(lt({},e),{},{scaleX:1,scaleY:1})),a=_m(this.points.map((u=>du(u,r,!0)))),o=new Dt(this.scaleX,this.scaleY);let l=s.left+s.width/2,c=s.top+s.height/2;return this.exactBoundingBox&&(l-=c*Math.tan(Do(this.skewX)),c-=l*Math.tan(Do(this.skewY))),lt(lt({},s),{},{pathOffset:new Dt(l,c),strokeOffset:new Dt(a.left,a.top).subtract(new Dt(s.left,s.top)).multiply(o),strokeDiff:new Dt(s.width,s.height).subtract(new Dt(a.width,a.height)).multiply(o)})}_findCenterFromElement(){const e=_m(this.points);return new Dt(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:s,width:r,height:a,pathOffset:o,strokeOffset:l,strokeDiff:c}=this._calcDimensions();this.set({width:r,height:a,pathOffset:o,strokeOffset:l,strokeDiff:c}),e&&this.setPositionByOrigin(new Dt(t+r/2,s+a/2),Zs,Zs)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Dt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some((l=>this.strokeUniform||this.constructor.layoutProperties.includes(l)))){var t,s;const{width:l,height:c}=this._calcDimensions(e);o=new Dt((t=e.width)!==null&&t!==void 0?t:l,(s=e.height)!==null&&s!==void 0?s:c)}else{var r,a;o=new Dt((r=e.width)!==null&&r!==void 0?r:this.width,(a=e.height)!==null&&a!==void 0?a:this.height)}return o.multiply(new Dt(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const s=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&s&&((e===Wu||e===vd)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return lt(lt({},super.toObject(e)),{},{points:this.points.map((t=>{let{x:s,y:r}=t;return{x:s,y:r}}))})}_toSVG(){const e=[],t=this.pathOffset.x,s=this.pathOffset.y,r=fi.NUM_FRACTION_DIGITS;for(let a=0,o=this.points.length;a<o;a++)e.push(ga(this.points[a].x-t,r),",",ga(this.points[a].y-s,r)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,s=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-s,this.points[0].y-r);for(let a=0;a<t;a++){const o=this.points[a];e.lineTo(o.x-s,o.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,s){return new this(abe(e.getAttribute("points")),lt(lt({},Va(Ug(e,this.ATTRIBUTE_NAMES,s),obe)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}};it(z0,"ownDefaults",Xte),it(z0,"type","Polyline"),it(z0,"layoutProperties",[A2,L2,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),it(z0,"cacheProperties",[...Bg,"points"]),it(z0,"ATTRIBUTE_NAMES",[...x1]),Hn.setClass(z0),Hn.setSVGClass(z0);let Pu=class extends z0{isOpen(){return!1}};it(Pu,"ownDefaults",Xte),it(Pu,"type","Polygon"),Hn.setClass(Pu),Hn.setSVGClass(Pu);class Qte extends wu{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const s in t)for(const r in t[s])for(const a in t[s][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const s=t===void 0?this.styles:{0:this.styles[t]};for(const r in s)for(const a in s[r])if(s[r][a][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let s,r,a=0,o=!0,l=0;for(const c in t){s=0;for(const u in t[c]){const f=t[c][u]||{};a++,f[e]!==void 0?(r?f[e]!==r&&(o=!1):r=f[e],f[e]===this[e]&&delete f[e]):o=!1,Object.keys(f).length!==0?s++:delete t[c][u]}s===0&&delete t[c]}for(let c=0;c<this._textLines.length;c++)l+=this._textLines[c].length;o&&a===l&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let s,r,a;for(r in t){for(a in s=t[r],s)delete s[a][e],Object.keys(s[a]).length===0&&delete s[a];Object.keys(s).length===0&&delete t[r]}}_extendStyles(e,t){const{lineIndex:s,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(s)||this._setLineStyle(s);const a=lF(lt(lt({},this._getStyleDeclaration(s,r)),t),(o=>o!==void 0));this._setStyleDeclaration(s,r,a)}getSelectionStyles(e,t,s){const r=[];for(let a=e;a<(t||e);a++)r.push(this.getStyleAtPosition(a,s));return r}getStyleAtPosition(e,t){const{lineIndex:s,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(s,r):this._getStyleDeclaration(s,r)}setSelectionStyles(e,t,s){for(let r=t;r<(s||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var s;const r=this.styles&&this.styles[e];return r&&(s=r[t])!==null&&s!==void 0?s:{}}getCompleteStyleDeclaration(e,t){return lt(lt({},Fb(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,s){this.styles[e][t]=s}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}it(Qte,"_styleProperties",_1e);const lbe=/  +/g,cbe=/"/g;function g3(n,e,t,s,r){return"		".concat((function(a,o){let{left:l,top:c,width:u,height:f}=o,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fi.NUM_FRACTION_DIGITS;const h=SM(vl,a,!1),[p,g,b,v]=[l,c,u,f].map((w=>ga(w,d)));return"<rect ".concat(h,' x="').concat(p,'" y="').concat(g,'" width="').concat(b,'" height="').concat(v,'"></rect>')})(n,{left:e,top:t,width:s,height:r}),`
`)}const ube=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let y3,om=class CS extends Qte{static getDefaults(){return lt(lt({},super.getDefaults()),CS.ownDefaults)}constructor(e,t){super(),it(this,"__charBounds",[]),Object.assign(this,CS.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=_F(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(gm)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,s,r,a,o,l;for(let c=0,u=this._textLines.length;c<u;c++)if((this.textAlign===gm||c!==u-1&&!this.isEndOfWrapping(c))&&(r=0,a=this._textLines[c],t=this.getLineWidth(c),t<this.width&&(l=this.textLines[c].match(this._reSpacesAndTabs)))){s=l.length,e=(this.width-t)/s;for(let f=0;f<=a.length;f++)o=this.__charBounds[c][f],this._reSpaceAndTab.test(a[f])?(o.width+=e,o.kernedWidth+=e,o.left+=r,r+=e):o.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const s=t?this._unwrappedTextLines:this._textLines;let r;for(r=0;r<s.length;r++){if(e<=s[r].length)return{lineIndex:r,charIndex:e};e-=s[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:s[r-1].length<e?s[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Bu?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,s){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Zs:e.textBaseline="middle";break;case"ascender":e.textBaseline=Sf;break;case"descender":e.textBaseline=kj}e.font=this._getFontDeclaration(t,s)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,s=this._textLines.length;t<s;t++){const r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,s,r,a,o){this._renderChars(e,t,s,r,a,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,s=this._getLeftOffset();let r=this._getTopOffset();for(let a=0,o=this._textLines.length;a<o;a++){const l=this.getHeightOfLine(a);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",a)){r+=l;continue}const c=this._textLines[a].length,u=this._getLineLeftOffset(a);let f,d,h=0,p=0,g=this.getValueOfPropertyAt(a,0,"textBackgroundColor");const b=this.getHeightOfLineImpl(a);for(let v=0;v<c;v++){const w=this.__charBounds[a][v];d=this.getValueOfPropertyAt(a,v,"textBackgroundColor"),this.path?(e.save(),e.translate(w.renderLeft,w.renderTop),e.rotate(w.angle),e.fillStyle=d,d&&e.fillRect(-w.width/2,-b*(1-this._fontSizeFraction),w.width,b),e.restore()):d!==g?(f=s+u+p,this.direction==="rtl"&&(f=this.width-f-h),e.fillStyle=g,g&&e.fillRect(f,r,h,b),p=w.left,h=w.width,g=d):h+=w.kernedWidth}d&&!this.path&&(f=s+u+p,this.direction==="rtl"&&(f=this.width-f-h),e.fillStyle=d,e.fillRect(f,r,h,b)),r+=l}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,s,r){const a=sM.getFontCache(t),o=this._getFontDeclaration(t),l=s?s+e:e,c=s&&o===this._getFontDeclaration(r),u=t.fontSize/this.CACHE_FONT_SIZE;let f,d,h,p;if(s&&a.has(s)&&(h=a.get(s)),a.has(e)&&(p=f=a.get(e)),c&&a.has(l)&&(d=a.get(l),p=d-h),f===void 0||h===void 0||d===void 0){const g=(function(){return y3||(y3=_d({width:0,height:0}).getContext("2d")),y3})();this._setTextStyles(g,t,!0),f===void 0&&(p=f=g.measureText(e).width,a.set(e,f)),h===void 0&&c&&s&&(h=g.measureText(s).width,a.set(s,h)),c&&d===void 0&&(d=g.measureText(l).width,a.set(l,d),p=d-h)}return{width:f*u,kernedWidth:p*u}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,s,r=0;const a=this.pathSide===Ho,o=this.path,l=this._textLines[e],c=l.length,u=new Array(c);this.__charBounds[e]=u;for(let f=0;f<c;f++){const d=l[f];s=this._getGraphemeBox(d,e,f,t),u[f]=s,r+=s.kernedWidth,t=d}if(u[c]={left:s?s.left+s.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let f=0;const d=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Ri:f=a?d-r:0;break;case Zs:f=(d-r)/2;break;case Ho:f=a?0:d-r}f+=this.pathStartOffset*(a?-1:1);for(let h=a?c-1:0;a?h>=0:h<c;a?h--:h++)s=u[h],f>d?f%=d:f<0&&(f+=d),this._setGraphemeOnPath(f,s),f+=s.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){const s=e+t.kernedWidth/2,r=this.path,a=jte(r.path,s,r.segmentsInfo);t.renderLeft=a.x-r.pathOffset.x,t.renderTop=a.y-r.pathOffset.y,t.angle=a.angle+(this.pathSide===Ho?Math.PI:0)}_getGraphemeBox(e,t,s,r,a){const o=this.getCompleteStyleDeclaration(t,s),l=r?this.getCompleteStyleDeclaration(t,s-1):{},c=this._measureChar(e,o,r,l);let u,f=c.kernedWidth,d=c.width;this.charSpacing!==0&&(u=this._getWidthOfCharSpacing(),d+=u,f+=u);const h={width:d,left:0,height:o.fontSize,kernedWidth:f,deltaY:o.deltaY};if(s>0&&!a){const p=this.__charBounds[t][s-1];h.left=p.left+p.width+c.kernedWidth-c.width}return h}getHeightOfLineImpl(e){const t=this.__lineHeights;if(t[e])return t[e];let s=this.getHeightOfChar(e,0);for(let r=1,a=this._textLines[e].length;r<a;r++)s=Math.max(this.getHeightOfChar(e,r),s);return t[e]=s*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,s=this._textLines.length;t<s;t++)e+=t===s-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let s=0;const r=this._getLeftOffset(),a=this._getTopOffset();for(let o=0,l=this._textLines.length;o<l;o++)this._renderTextLine(t,e,this._textLines[o],r+this._getLineLeftOffset(o),a+s+this.getHeightOfLineImpl(o),o),s+=this.getHeightOfLine(o);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(vl))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,s,r,a,o){const l=this.textAlign.includes(gm),c=this.path,u=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!c,f=this.direction==="ltr",d=this.direction==="ltr"?1:-1,h=t.direction;let p,g,b,v,w,x="",S=0;if(t.save(),h!==this.direction&&(t.canvas.setAttribute("dir",f?"ltr":"rtl"),t.direction=f?"ltr":"rtl",t.textAlign=f?Ri:Ho),a-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,u)return this._renderChar(e,t,o,0,s.join(""),r,a),void t.restore();for(let C=0,M=s.length-1;C<=M;C++)v=C===M||this.charSpacing||c,x+=s[C],b=this.__charBounds[o][C],S===0?(r+=d*(b.kernedWidth-b.width),S+=b.width):S+=b.kernedWidth,l&&!v&&this._reSpaceAndTab.test(s[C])&&(v=!0),v||(p=p||this.getCompleteStyleDeclaration(o,C),g=this.getCompleteStyleDeclaration(o,C+1),v=M4(p,g,!1)),v&&(c?(t.save(),t.translate(b.renderLeft,b.renderTop),t.rotate(b.angle),this._renderChar(e,t,o,C,x,-S/2,0),t.restore()):(w=r,this._renderChar(e,t,o,C,x,w,a)),x="",p=g,r+=d*S,S=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,s=this.height+this.strokeWidth,r=_d({width:t,height:s}),a=r.getContext("2d");return r.width=t,r.height=s,a.beginPath(),a.moveTo(0,0),a.lineTo(t,0),a.lineTo(t,s),a.lineTo(0,s),a.closePath(),a.translate(t/2,s/2),a.fillStyle=e.toLive(a),this._applyPatternGradientTransform(a,e),a.fill(),a.createPattern(r,"no-repeat")}handleFiller(e,t,s){let r,a;return ah(s)?s.gradientUnits==="percentage"||s.gradientTransform||s.patternTransform?(r=-this.width/2,a=-this.height/2,e.translate(r,a),e[t]=this._applyPatternGradientTransformText(s),{offsetX:r,offsetY:a}):(e[t]=s.toLive(e),this._applyPatternGradientTransform(e,s)):(e[t]=s,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:s,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",s)}_setFillStyles(e,t){let{fill:s}=t;return this.handleFiller(e,"fillStyle",s)}_renderChar(e,t,s,r,a,o,l){const c=this._getStyleDeclaration(s,r),u=this.getCompleteStyleDeclaration(s,r),f=e==="fillText"&&u.fill,d=e==="strokeText"&&u.stroke&&u.strokeWidth;if(d||f){if(t.save(),t.font=this._getFontDeclaration(u),c.textBackgroundColor&&this._removeShadow(t),c.deltaY&&(l+=c.deltaY),f){const h=this._setFillStyles(t,u);t.fillText(a,o-h.offsetX,l-h.offsetY)}if(d){const h=this._setStrokeStyles(t,u);t.strokeText(a,o-h.offsetX,l-h.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,s){const r=this.get2DCursorLocation(e,!0),a=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),l={fontSize:a*s.size,deltaY:o+a*s.baseline};this.setSelectionStyles(l,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),s=this.width-t,r=this.textAlign,a=this.direction,o=this.isEndOfWrapping(e);let l=0;return r===gm||r===oM&&!o||r===aM&&!o||r===KL&&!o?0:(r===Zs&&(l=s/2),r===Ho&&(l=s),r===oM&&(l=s/2),r===aM&&(l=s),a==="rtl"&&(r===Ho||r===gm||r===aM?l=0:r===Ri||r===KL?l=-s:r!==Zs&&r!==oM||(l=-s/2)),l)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,s){var r;return(r=this._getStyleDeclaration(e,t)[s])!==null&&r!==void 0?r:this[s]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let s=this._getTopOffset();const r=this._getLeftOffset(),a=this.path,o=this._getWidthOfCharSpacing(),l=t==="linethrough"?.5:t==="overline"?1:0,c=this.offsets[t];for(let u=0,f=this._textLines.length;u<f;u++){const d=this.getHeightOfLine(u);if(!this[t]&&!this.styleHas(t,u)){s+=d;continue}const h=this._textLines[u],p=d/this.lineHeight,g=this._getLineLeftOffset(u);let b=0,v=0,w=this.getValueOfPropertyAt(u,0,t),x=this.getValueOfPropertyAt(u,0,vl),S=this.getValueOfPropertyAt(u,0,cb),C=w,M=x,k=S;const E=s+p*(1-this._fontSizeFraction);let I=this.getHeightOfChar(u,0),A=this.getValueOfPropertyAt(u,0,"deltaY");for(let P=0,j=h.length;P<j;P++){const G=this.__charBounds[u][P];C=this.getValueOfPropertyAt(u,P,t),M=this.getValueOfPropertyAt(u,P,vl),k=this.getValueOfPropertyAt(u,P,cb);const Q=this.getHeightOfChar(u,P),q=this.getValueOfPropertyAt(u,P,"deltaY");if(a&&C&&M){const te=this.fontSize*k/1e3;e.save(),e.fillStyle=x,e.translate(G.renderLeft,G.renderTop),e.rotate(G.angle),e.fillRect(-G.kernedWidth/2,c*Q+q-l*te,G.kernedWidth,te),e.restore()}else if((C!==w||M!==x||Q!==I||k!==S||q!==A)&&v>0){const te=this.fontSize*S/1e3;let Z=r+g+b;this.direction==="rtl"&&(Z=this.width-Z-v),w&&x&&S&&(e.fillStyle=x,e.fillRect(Z,E+c*I+A-l*te,v,te)),b=G.left,v=G.width,w=C,S=k,x=M,I=Q,A=q}else v+=G.kernedWidth}let D=r+g+b;this.direction==="rtl"&&(D=this.width-D-v),e.fillStyle=M;const L=this.fontSize*k/1e3;C&&M&&k&&e.fillRect(D,E+c*I+A-l*L,v-o,L),s+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:s=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||CS.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,s,"".concat(a?this.CACHE_FONT_SIZE:r,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return S4(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),s=new Array(t.length),r=[`
`];let a=[];for(let o=0;o<t.length;o++)s[o]=this.graphemeSplit(t[o]),a=a.concat(s[o],r);return a.pop(),{_unwrappedLines:s,lines:t,graphemeText:a,graphemeLines:s}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return lt(lt({},super.toObject([...lte,...e])),{},{styles:Mte(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:s}=this.constructor;super.set(e,t);let r=!1,a=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),r=r||s.includes(o),a=a||o==="path";else r=s.includes(e),a=e==="path";return a&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,s){const r=Ug(e,CS.ATTRIBUTE_NAMES,s),a=lt(lt({},t),r),{textAnchor:o=Ri,textDecoration:l="",dx:c=0,dy:u=0,top:f=0,left:d=0,fontSize:h=eF,strokeWidth:p=1}=a,g=Va(a,ube),b=new this(YL(e.textContent||"").trim(),lt({left:d+c,top:f+u,underline:l.includes("underline"),overline:l.includes("overline"),linethrough:l.includes("line-through"),strokeWidth:0,fontSize:h},g)),v=b.getScaledHeight()/b.height,w=((b.height+b.strokeWidth)*b.lineHeight-b.height)*v,x=b.getScaledHeight()+w;let S=0;return o===Zs&&(S=b.getScaledWidth()/2),o===Ho&&(S=b.getScaledWidth()),b.set({left:b.left-S,top:b.top-(x-b.fontSize*(.07+b._fontSizeFraction))/b.lineHeight,strokeWidth:p}),b}static fromObject(e){return this._fromObject(lt(lt({},e),{},{styles:Tte(e.styles||{},e.text)}),{extraParam:"text"})}};it(om,"textLayoutProperties",ote),it(om,"cacheProperties",[...Bg,...lte]),it(om,"ownDefaults",x1e),it(om,"type","Text"),it(om,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),it(om,"ATTRIBUTE_NAMES",x1.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),wte(om,[class extends rte{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:n,withShadow:!0,additionalTransform:n2(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const s=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(cbe,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",s?'text-decoration="'.concat(s,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],s=[];let r,a=n;this.backgroundColor&&s.push(...g3(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,l=this._textLines.length;o<l;o++)r=this._getLineLeftOffset(o),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(s,o,e+r,a),this._setSVGTextLineText(t,o,e+r,a),a+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:s}}_createTextCharSpan(n,e,t,s,r){const a=fi.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(lbe)),l=o?'style="'.concat(o,'"'):"",c=e.deltaY,u=c?' dy="'.concat(ga(c,a),'" '):"",{angle:f,renderLeft:d,renderTop:h,width:p}=r;let g="";if(d!==void 0){const b=p/2;f&&(g=' rotate="'.concat(ga(Lm(f),a),'"'));const v=Rb({angle:Lm(f)});v[4]=d,v[5]=h;const w=new Dt(-b,0).transform(v);t=w.x,s=w.y}return'<tspan x="'.concat(ga(t,a),'" y="').concat(ga(s,a),'" ').concat(u).concat(g).concat(l,">").concat(Ste(n),"</tspan>")}_setSVGTextLineText(n,e,t,s){const r=this.getHeightOfLine(e),a=this.textAlign.includes(gm),o=this._textLines[e];let l,c,u,f,d,h="",p=0;s+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let g=0,b=o.length-1;g<=b;g++)d=g===b||this.charSpacing||this.path,h+=o[g],u=this.__charBounds[e][g],p===0?(t+=u.kernedWidth-u.width,p+=u.width):p+=u.kernedWidth,a&&!d&&this._reSpaceAndTab.test(o[g])&&(d=!0),d||(l=l||this.getCompleteStyleDeclaration(e,g),c=this.getCompleteStyleDeclaration(e,g+1),d=M4(l,c,!0)),d&&(f=this._getStyleDeclaration(e,g),n.push(this._createTextCharSpan(h,f,t,s,u)),h="",l=c,this.direction==="rtl"?t-=p:t+=p,p=0)}_setSVGTextLineBg(n,e,t,s){const r=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight;let o,l=0,c=0,u=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let f=0;f<r.length;f++){const{left:d,width:h,kernedWidth:p}=this.__charBounds[e][f];o=this.getValueOfPropertyAt(e,f,"textBackgroundColor"),o!==u?(u&&n.push(...g3(u,t+c,s,l,a)),c=d,l=h,u=o):l+=p}o&&n.push(...g3(u,t+c,s,l,a))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const s=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*s/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," text-decoration-thickness: ").concat(ga(this.textDecorationThickness*this.getObjectScaling().y/10,fi.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:s,stroke:r,fill:a,fontSize:o,fontStyle:l,fontWeight:c,deltaY:u,textDecorationThickness:f,linethrough:d,overline:h,underline:p}=n,g=this.getSvgTextDecoration({underline:p??this.underline,overline:h??this.overline,linethrough:d??this.linethrough}),b=f||this.textDecorationThickness;return[r?SM(Bu,r):"",s?"stroke-width: ".concat(s,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",l?"font-style: ".concat(l,"; "):"",c?"font-weight: ".concat(c,"; "):"",g?"text-decoration: ".concat(g,"; text-decoration-thickness: ").concat(ga(b*this.getObjectScaling().y/10,fi.NUM_FRACTION_DIGITS),"%; "):"",a?SM(vl,a):"",u?"baseline-shift: ".concat(-u,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter((e=>n[e.replace("-","")])).join(" ")}}]),Hn.setClass(om),Hn.setSVGClass(om);class fbe{constructor(e){it(this,"target",void 0),it(this,"__mouseDownInPlace",!1),it(this,"__dragStartFired",!1),it(this,"__isDraggingOver",!1),it(this,"__dragStartSelection",void 0),it(this,"__dragImageDisposer",void 0),it(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach((s=>s())),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,s=t.getSelectionStartFromPointer(e);return t.isEditing&&s>=t.selectionStart&&s<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var s;let{selectionStart:r,selectionEnd:a}=t;const o=this.target,l=o.canvas,c=new Dt(o.flipX?-1:1,o.flipY?-1:1),u=o._getCursorBoundaries(r),f=new Dt(u.left+u.leftOffset,u.top+u.topOffset).multiply(c).transform(o.calcTransformMatrix()),d=l.getScenePoint(e).subtract(f),h=o.getCanvasRetinaScaling(),p=o.getBoundingRect(),g=f.subtract(new Dt(p.left,p.top)),b=l.viewportTransform,v=g.add(d).transform(b,!0),w=o.backgroundColor,x=bF(o.styles);o.backgroundColor="";const S={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(S,0,r),o.setSelectionStyles(S,a,o.text.length),o.dirty=!0;const C=o.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=w,o.styles=x,o.dirty=!0,sN(C,{position:"fixed",left:"".concat(-C.width,"px"),border:zu,width:"".concat(C.width/h,"px"),height:"".concat(C.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{C.remove()},np(e.target||this.target.hiddenTextarea).body.appendChild(C),(s=e.dataTransfer)===null||s===void 0||s.setDragImage(C,v.x,v.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,s=this.isActive();if(s&&e.dataTransfer){const r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},a=t._text.slice(r.selectionStart,r.selectionEnd).join(""),o=lt({text:t.text,value:a},r);e.dataTransfer.setData("text/plain",a),e.dataTransfer.setData("application/fabric",JSON.stringify({value:a,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),s}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),s=this.__dragStartSelection;return t<s.selectionStart||t>s.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const s=this.targetCanDrop(t);!this.__isDraggingOver&&s&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,s=this.targetCanDrop(t);!this.__isDraggingOver&&s?this.__isDraggingOver=!0:this.__isDraggingOver&&!s&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:s}=e,r=s.defaultPrevented;this.__isDraggingOver=!1,s.preventDefault();let a=(t=s.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(a&&!r){const o=this.target,l=o.canvas;let c=o.getSelectionStartFromPointer(s);const{styles:u}=s.dataTransfer.types.includes("application/fabric")?JSON.parse(s.dataTransfer.getData("application/fabric")):{},f=a[Math.max(0,a.length-1)],d=0;if(this.__dragStartSelection){const h=this.__dragStartSelection.selectionStart,p=this.__dragStartSelection.selectionEnd;c>h&&c<=p?c=h:c>p&&(c-=p-h),o.removeChars(h,p),delete this.__dragStartSelection}o._reNewline.test(f)&&(o._reNewline.test(o._text[c])||c===o._text.length)&&(a=a.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(a,u,c),l.setActiveObject(o),o.enterEditing(s),o.selectionStart=Math.min(c+d,o._text.length),o.selectionEnd=Math.min(o.selectionStart+a.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(VL,{index:c+d,action:"drop"}),l.fire("text:changed",{target:o}),l.contextTopDirty=!0,l.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var s;const r=this.target,a=this.target.canvas,{selectionStart:o,selectionEnd:l}=this.__dragStartSelection,c=((s=t.dataTransfer)===null||s===void 0?void 0:s.dropEffect)||zu;c===zu?(r.selectionStart=o,r.selectionEnd=l,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),c==="move"&&(r.removeChars(o,l),r.selectionStart=r.selectionEnd=o,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire(VL,{index:o,action:"dragend"}),a.fire("text:changed",{target:r}),a.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const OV=/[ \n\.,;!\?\-]/;class dbe extends om{constructor(){super(...arguments),it(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:s,delay:r,onComplete:a}=e;return gF({startValue:this._currentCursorOpacity,endValue:t,duration:s,delay:r,onComplete:a,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach((t=>{t&&!t.isDone()&&(e=!0,t.abort())})),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((e=>!e||e.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,s=e-1;if(this._reSpace.test(this._text[s]))for(;this._reSpace.test(this._text[s]);)t++,s--;for(;/\S/.test(this._text[s])&&s>-1;)t++,s--;return e-t}findWordBoundaryRight(e){let t=0,s=e;if(this._reSpace.test(this._text[s]))for(;this._reSpace.test(this._text[s]);)t++,s++;for(;/\S/.test(this._text[s])&&s<this._text.length;)t++,s++;return e+t}findLineBoundaryLeft(e){let t=0,s=e-1;for(;!/\n/.test(this._text[s])&&s>-1;)t++,s--;return e-t}findLineBoundaryRight(e){let t=0,s=e;for(;!/\n/.test(this._text[s])&&s<this._text.length;)t++,s++;return e+t}searchWordBoundary(e,t){const s=this._text;let r=e>0&&this._reSpace.test(s[e])&&(t===-1||!tF.test(s[e-1]))?e-1:e,a=s[r];for(;r>0&&r<s.length&&!OV.test(a);)r+=t,a=s[r];return t===-1&&OV.test(a)&&r++,r}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const s=this.searchWordBoundary(e,-1),r=Math.max(s,this.searchWordBoundary(e,1));this.selectionStart=s,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const s=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);this.selectionStart=s,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;np(t).activeElement!==t&&t.focus();const s=this.getSelectionStartFromPointer(e),r=this.selectionStart,a=this.selectionEnd;(s===this.__selectionStartOnMouseDown&&r!==a||r!==s&&a!==s)&&(s>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=s):(this.selectionStart=s,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===a||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,s){const r=s.slice(0,e),a=this.graphemeSplit(r).length;if(e===t)return{selectionStart:a,selectionEnd:a};const o=s.slice(e,t);return{selectionStart:a,selectionEnd:a+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,s){const r=s.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+s.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),s=this.get2DCursorLocation(e),r=s.lineIndex,a=s.charIndex,o=this.getValueOfPropertyAt(r,a,"fontSize")*this.lineHeight,l=t.leftOffset,c=this.getCanvasRetinaScaling(),u=this.canvas.upperCanvasEl,f=u.width/c,d=u.height/c,h=f-o,p=d-o,g=new Dt(t.left+l,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Dt(u.clientWidth/f,u.clientHeight/d));return g.x<0&&(g.x=0),g.x>h&&(g.x=h),g.y<0&&(g.y=0),g.y>p&&(g.y=p),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(WL),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:s,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:a,charIndex:o}=this.get2DCursorLocation(t,!0);if(s!==a){if(this.styles[s])for(let l=r;l<this._unwrappedTextLines[s].length;l++)delete this.styles[s][l];if(this.styles[a])for(let l=o;l<this._unwrappedTextLines[a].length;l++){const c=this.styles[a][l];c&&(this.styles[s]||(this.styles[s]={}),this.styles[s][r+l-o]=c)}for(let l=s+1;l<=a;l++)delete this.styles[l];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){const l=this.styles[s],c=o-r;for(let u=r;u<o;u++)delete l[u];for(const u in this.styles[s]){const f=parseInt(u,10);f>=o&&(l[f-c]=l[u],delete l[u])}}}shiftLineStyles(e,t){const s=Object.assign({},this.styles);for(const r in this.styles){const a=parseInt(r,10);a>e&&(this.styles[a+t]=s[a],s[a-t]||delete this.styles[a])}}insertNewlineStyleObject(e,t,s,r){const a={},o=this._unwrappedTextLines[e].length,l=o===t;let c=!1;s||(s=1),this.shiftLineStyles(e,s);const u=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const d in this.styles[e]){const h=parseInt(d,10);h>=t&&(c=!0,a[h-t]=this.styles[e][d],l&&t===0||delete this.styles[e][d])}let f=!1;for(c&&!l&&(this.styles[e+s]=a,f=!0),(f||o>t)&&s--;s>0;)r&&r[s-1]?this.styles[e+s]={0:lt({},r[s-1])}:u?this.styles[e+s]={0:lt({},u)}:delete this.styles[e+s],s--;this._forceClearCache=!0}insertCharStyleObject(e,t,s,r){this.styles||(this.styles={});const a=this.styles[e],o=a?lt({},a):{};s||(s=1);for(const c in o){const u=parseInt(c,10);u>=t&&(a[u+s]=o[u],o[u-s]||delete a[u])}if(this._forceClearCache=!0,r){for(;s--;)Object.keys(r[s]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+s]=lt({},r[s]));return}if(!a)return;const l=a[t?t-1:1];for(;l&&s--;)this.styles[e][t+s]=lt({},l)}insertNewStyleBlock(e,t,s){const r=this.get2DCursorLocation(t,!0),a=[0];let o,l=0;for(let c=0;c<e.length;c++)e[c]===`
`?(l++,a[l]=0):a[l]++;for(a[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,a[0],s),s=s&&s.slice(a[0]+1)),l&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+a[0],l),o=1;o<l;o++)a[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,a[o],s):s&&this.styles[r.lineIndex+o]&&s[0]&&(this.styles[r.lineIndex+o][0]=s[0]),s=s&&s.slice(a[o]+1);a[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,a[o],s)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,s){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;r>s&&this.removeStyleFromTo(s,r);const a=this.graphemeSplit(e);this.insertNewStyleBlock(a,s,t),this._text=[...this._text.slice(0,s),...a,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,s){s<=e?(t===e?this._selectionDirection=Ri:this._selectionDirection===Ho&&(this._selectionDirection=Ri,this.selectionEnd=e),this.selectionStart=s):s>e&&s<t?this._selectionDirection===Ho?this.selectionEnd=s:this.selectionStart=s:(t===e?this._selectionDirection=Ho:this._selectionDirection===Ri&&(this._selectionDirection=Ho,this.selectionStart=t),this.selectionEnd=s)}}class hbe extends dbe{initHiddenTextarea(){const e=this.canvas&&np(this.canvas.getElement())||E2(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map((o=>{let[l,c]=o;return t.setAttribute(l,c)}));const{top:s,left:r,fontSize:a}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(s,"; left: ").concat(r,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(a,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((o=>{let[l,c]=o;return t.addEventListener(l,this[c].bind(this))})),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:s,selectionStart:r,selectionEnd:a}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(VL),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const l=this._splitTextIntoLines(s).graphemeText,c=this._text.length,u=l.length,f=this.selectionStart,d=this.selectionEnd,h=f!==d;let p,g,b,v,w=u-c;const x=this.fromStringToGraphemeSelection(r,a,s),S=f>x.selectionStart;h?(g=this._text.slice(f,d),w+=d-f):u<c&&(g=S?this._text.slice(d+w,d):this._text.slice(f,f-w));const C=l.slice(x.selectionEnd-w,x.selectionEnd);if(g&&g.length&&(C.length&&(p=this.getSelectionStyles(f,f+1,!1),p=C.map((()=>p[0]))),h?(b=f,v=d):S?(b=d-g.length,v=d):(b=d,v=d+g.length),this.removeStyleFromTo(b,v)),C.length){const{copyPasteData:M}=Im();t&&C.join("")===M.copiedText&&!fi.disableStyleCopyPaste&&(p=M.copiedTextStyle),this.insertNewStyleBlock(C,f,p)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:s,selectionEnd:r}=t;this.compositionStart=s,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Im();e.copiedText=this.getSelectedText(),fi.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let s,r=this._getLineLeftOffset(e);return t>0&&(s=this.__charBounds[e][t-1],r+=s.left+s.width),r}getDownCursorOffset(e,t){const s=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(s),a=r.lineIndex;if(a===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-s;const o=r.charIndex,l=this._getWidthBeforeCursor(a,o),c=this._getIndexOnLine(a+1,l);return this._textLines[a].slice(o).length+c+1+this.missingNewlineOffset(a)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const s=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(s),a=r.lineIndex;if(a===0||e.metaKey||e.keyCode===33)return-s;const o=r.charIndex,l=this._getWidthBeforeCursor(a,o),c=this._getIndexOnLine(a-1,l),u=this._textLines[a].slice(0,o),f=this.missingNewlineOffset(a-1);return-this._textLines[a-1].length+c-u.length+(1-f)}_getIndexOnLine(e,t){const s=this._textLines[e];let r,a,o=this._getLineLeftOffset(e),l=0;for(let c=0,u=s.length;c<u;c++)if(r=this.__charBounds[e][c].width,o+=r,o>t){a=!0;const f=o-r,d=o,h=Math.abs(f-t);l=Math.abs(d-t)<h?c:c-1;break}return a||(l=s.length-1),l}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const s=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Ho);if(t.shiftKey?this.moveCursorWithShift(s):this.moveCursorWithoutShift(s),s!==0){const r=this.text.length;this.selectionStart=ub(0,this.selectionStart,r),this.selectionEnd=ub(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Ri?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,s){let r;if(e.altKey)r=this["findWordBoundary".concat(s)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=s==="Left"?-1:1,!0;r=this["findLineBoundary".concat(s)](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Ri,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Ho&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Ri,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const s="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[s](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Ri&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Ho,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Ho,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const PV=n=>!!n.button;class pbe extends hbe{constructor(){super(...arguments),it(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new fbe(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:s}=e;this.canvas&&this.editable&&!PV(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),s&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=s||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:s}=e;const r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const a=this.canvas._activeObject;if(a&&a!==this)return}!this.editable||this.group&&!this.group.interactive||s&&s.actionPerformed||PV(t)||r||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),s=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(s,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Cf(this.calcTransformMatrix())).add(new Dt(-this._getLeftOffset(),-this._getTopOffset()));let s=0,r=0,a=0;for(let u=0;u<this._textLines.length&&s<=t.y;u++)s+=this.getHeightOfLine(u),a=u,u>0&&(r+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));let o=Math.abs(this._getLineLeftOffset(a));const l=this._textLines[a].length,c=this.__charBounds[a];for(let u=0;u<l;u++){const f=o+c[u].kernedWidth;if(t.x<=f){Math.abs(t.x-f)<=Math.abs(t.x-o)&&r++;break}o=f,r++}return Math.min(this.flipX?l-r:r,this._text.length)}}const fI="moveCursorUp",dI="moveCursorDown",hI="moveCursorLeft",pI="moveCursorRight",mI="exitEditing",$V=(n,e)=>{const t=e.getRetinaScaling();n.setTransform(t,0,0,t,0,0);const s=e.viewportTransform;n.transform(s[0],s[1],s[2],s[3],s[4],s[5])},mbe=lt({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:mI,27:mI,33:fI,34:dI,35:pI,36:hI,37:hI,38:fI,39:pI,40:dI},keysMapRtl:{9:mI,27:mI,33:fI,34:dI,35:hI,36:pI,37:pI,38:fI,39:hI,40:dI},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class lh extends pbe{static getDefaults(){return lt(lt({},super.getDefaults()),lh.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,lt(lt({},lh.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof zj&&this.canvas.textEditingManager.remove(this),t instanceof zj&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,s=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,s)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,s)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const s=super.toCanvasElement(e);return this.isEditing=t,s}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),s=this.findAncestorsWithClipPath(),r=s.length>0;let a,o=e;if(r){a=_d(e.canvas),o=a.getContext("2d"),$V(o,this.canvas);const l=this.calcTransformMatrix();o.transform(l[0],l[1],l[2],l[3],l[4],l[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,t):this.renderCursor(o,t),r)for(const l of s){const c=l.clipPath,u=_d(e.canvas),f=u.getContext("2d");if($V(f,this.canvas),!c.absolutePositioned){const d=l.calcTransformMatrix();f.transform(d[0],d[1],d[2],d[3],d[4],d[5])}c.transform(f),c.drawObject(f,!0,{}),this.drawClipPathOnCache(o,c,u)}r&&(e.setTransform(1,0,0,1,0,0),e.drawImage(a,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const s=this._getLeftOffset(),r=this._getTopOffset(),a=this._getCursorBoundariesOffsets(e,t);return{left:s,top:r,leftOffset:a.left,topOffset:a.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,s=0;const{charIndex:r,lineIndex:a}=this.get2DCursorLocation(e);for(let u=0;u<a;u++)t+=this.getHeightOfLine(u);const o=this._getLineLeftOffset(a),l=this.__charBounds[a][r];l&&(s=l.left),this.charSpacing!==0&&r===this._textLines[a].length&&(s-=this._getWidthOfCharSpacing());const c={top:t,left:o+(s>0?s:0)};return this.direction==="rtl"&&(this.textAlign===Ho||this.textAlign===gm||this.textAlign===aM?c.left*=-1:this.textAlign===Ri||this.textAlign===KL?c.left=o-(s>0?s:0):this.textAlign!==Zs&&this.textAlign!==oM||(c.left=o-(s>0?s:0))),c}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const s=this.get2DCursorLocation(e),r=s.lineIndex,a=s.charIndex>0?s.charIndex-1:0,o=this.getValueOfPropertyAt(r,a,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/l,u=this.getValueOfPropertyAt(r,a,"deltaY"),f=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(r,a,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-c/2,top:f+t.top+u,width:c,height:o}}_renderCursor(e,t,s){const{color:r,opacity:a,left:o,top:l,width:c,height:u}=this.getCursorRenderingData(s,t);e.fillStyle=r,e.globalAlpha=a,e.fillRect(o,l,c,u)}renderSelection(e,t){const s={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,s,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,s){const r=t.selectionStart,a=t.selectionEnd,o=this.textAlign.includes(gm),l=this.get2DCursorLocation(r),c=this.get2DCursorLocation(a),u=l.lineIndex,f=c.lineIndex,d=l.charIndex<0?0:l.charIndex,h=c.charIndex<0?0:c.charIndex;for(let p=u;p<=f;p++){const g=this._getLineLeftOffset(p)||0;let b=this.getHeightOfLine(p),v=0,w=0,x=0;if(p===u&&(w=this.__charBounds[u][d].left),p>=u&&p<f)x=o&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===f)if(h===0)x=this.__charBounds[f][h].left;else{const E=this._getWidthOfCharSpacing();x=this.__charBounds[f][h-1].left+this.__charBounds[f][h-1].width-E}v=b,(this.lineHeight<1||p===f&&this.lineHeight>1)&&(b/=this.lineHeight);let S=s.left+g+w,C=b,M=0;const k=x-w;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",C=1,M=b):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Ho||this.textAlign===gm||this.textAlign===aM?S=this.width-S-k:this.textAlign===Ri||this.textAlign===KL?S=s.left+g-x:this.textAlign!==Zs&&this.textAlign!==oM||(S=s.left+g-x)),e.fillRect(S,s.top+s.topOffset+M,k,C),s.topOffset+=v}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,vl)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}it(lh,"ownDefaults",mbe),it(lh,"type","IText"),Hn.setClass(lh),Hn.setClass(lh,"i-text");class Wy extends lh{static getDefaults(){return lt(lt({},super.getDefaults()),Wy.ownDefaults)}constructor(e,t){super(e,lt(lt({},Wy.ownDefaults),t))}static createControls(){return{controls:tye()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(gm)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,s=0,r=0;const a={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[r]===`
`&&o>0?(s=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&o>0&&(s++,r++),a[o]={line:t,offset:s},r+=e.graphemeLines[o].length,s+=e.graphemeLines[o].length;return a}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const s=this._styleMap[t];s&&(t=s.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,s=0,r=e+1,a=!1;const o=this._styleMap[e],l=this._styleMap[e+1];o&&(e=o.line,s=o.offset),l&&(r=l.line,a=r===e,t=l.offset);const c=e===void 0?this.styles:{line:this.styles[e]};for(const u in c)for(const f in c[u]){const d=parseInt(f,10);if(d>=s&&(!a||d<t))for(const h in c[u][f])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const s=this._styleMap[e];if(!s)return{};e=s.line,t=s.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,s){const r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,s)}_deleteStyleDeclaration(e,t){const s=this._styleMap[e];super._deleteStyleDeclaration(s.line,s.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const s=this.getGraphemeDataForRender(e),r=[];for(let a=0;a<s.wordsData.length;a++)r.push(...this._wrapLine(a,t,s));return this.isWrapping=!1,r}getGraphemeDataForRender(e){const t=this.splitByGrapheme,s=t?"":" ";let r=0;return{wordsData:e.map(((a,o)=>{let l=0;const c=t?this.graphemeSplit(a):this.wordSplit(a);return c.length===0?[{word:[],width:0}]:c.map((u=>{const f=t?[u]:this.graphemeSplit(u),d=this._measureWord(f,o,l);return r=Math.max(d,r),l+=f.length+s.length,{word:f,width:d}}))})),largestWordWidth:r}}_measureWord(e,t){let s,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=0;for(let o=0,l=e.length;o<l;o++)a+=this._getGraphemeBox(e[o],t,o+r,s,!0).kernedWidth,s=e[o];return a}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,s){let{largestWordWidth:r,wordsData:a}=s,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const l=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,u=[],f=c?"":" ";let d=0,h=[],p=0,g=0,b=!0;t-=o;const v=Math.max(t,r,this.dynamicMinWidth),w=a[e];let x;for(p=0,x=0;x<w.length;x++){const{word:S,width:C}=w[x];p+=S.length,d+=g+C-l,d>v&&!b?(u.push(h),h=[],d=C,b=!0):d+=l,b||c||h.push(f),h=h.concat(S),g=c?0:this._measureWord([f],e,p),p++,b=!1}return x&&u.push(h),r+o>this.dynamicMinWidth&&(this.dynamicMinWidth=r-l+o),u}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),s=this._wrapText(t.lines,this.width),r=new Array(s.length);for(let a=0;a<s.length;a++)r[a]=s[a].join("");return t.lines=r,t.graphemeLines=s,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const s=parseInt(t,10);if(this._textLines[s]){const r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}it(Wy,"type","Textbox"),it(Wy,"textLayoutProperties",[...lh.textLayoutProperties,"width"]),it(Wy,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),Hn.setClass(Wy);class jV extends T4{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:s}=e,{clipPath:r,group:a}=s;if(!r||!this.shouldPerformLayout(e))return;const{width:o,height:l}=_m(Ete(s,r)),c=new Dt(o,l);if(r.absolutePositioned)return{center:Qy(r.getRelativeCenterPoint(),void 0,a?a.calcTransformMatrix():void 0),size:c};{const u=r.getRelativeCenterPoint().transform(s.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:f=new Dt,correction:d=new Dt}=this.calcBoundingBox(t,e)||{};return{center:f.add(u),correction:d.subtract(u),size:c}}return{center:s.getRelativeCenterPoint().add(u),size:c}}}}it(jV,"type","clip-path"),Hn.setClass(jV);class RV extends T4{getInitialSize(e,t){let{target:s}=e,{size:r}=t;return new Dt(s.width||r.x,s.height||r.y)}}it(RV,"type","fixed"),Hn.setClass(RV);class gbe extends MM{subscribeTargets(e){const t=e.target;e.targets.reduce(((s,r)=>(r.parent&&s.add(r.parent),s)),new Set).forEach((s=>{s.layoutManager.subscribeTargets({target:s,targets:[t]})}))}unsubscribeTargets(e){const t=e.target,s=t.getObjects();e.targets.reduce(((r,a)=>(a.parent&&r.add(a.parent),r)),new Set).forEach((r=>{!s.some((a=>a.parent===r))&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})}))}}class ip extends xm{static getDefaults(){return lt(lt({},super.getDefaults()),ip.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,ip.ownDefaults),this.setOptions(t);const{left:s,top:r,layoutManager:a}=t;this.groupInit(e,{left:s,top:r,layoutManager:a??new gbe})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach((r=>{const a=this._objects.findIndex((l=>l.isInFrontOf(r))),o=a===-1?this.size():a;this.insertAt(o,r)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(Lg("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const s=new Set;t.forEach((r=>{const{parent:a}=r;a&&s.add(a)})),e===vF?s.forEach((r=>{r._onAfterObjectsChange(eN,t)})):s.forEach((r=>{r._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,s){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const r=lt(lt({hasControls:!1},s),{},{forActiveSelection:!0});for(let a=0;a<this._objects.length;a++)this._objects[a]._renderControls(e,r);super._renderControls(e,t),e.restore()}}it(ip,"type","ActiveSelection"),it(ip,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),Hn.setClass(ip),Hn.setClass(ip,"activeSelection");class ybe{constructor(){it(this,"resources",{})}applyFilters(e,t,s,r,a){const o=a.getContext("2d");if(!o)return;o.drawImage(t,0,0,s,r);const l={sourceWidth:s,sourceHeight:r,imageData:o.getImageData(0,0,s,r),originalEl:t,originalImageData:o.getImageData(0,0,s,r),canvasEl:a,ctx:o,filterBackend:this};e.forEach((u=>{u.applyTo(l)}));const{imageData:c}=l;return c.width===s&&c.height===r||(a.width=c.width,a.height=c.height),o.putImageData(c,0,0),l}}let Jte=class{constructor(){let{tileSize:e=fi.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};it(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),it(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const s=_d({width:e,height:t}),r=s.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=s,this.gl=r)}applyFilters(e,t,s,r,a,o){const l=this.gl,c=a.getContext("2d");if(!l||!c)return;let u;o&&(u=this.getCachedTexture(o,t));const f={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:s,sourceHeight:r,destinationWidth:s,destinationHeight:r,context:l,sourceTexture:this.createTexture(l,s,r,u?void 0:t),targetTexture:this.createTexture(l,s,r),originalTexture:u||this.createTexture(l,s,r,u?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},d=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,d),e.forEach((h=>{h&&h.applyTo(f)})),(function(h){const p=h.targetCanvas,g=p.width,b=p.height,v=h.destinationWidth,w=h.destinationHeight;g===v&&b===w||(p.width=v,p.height=w)})(f),this.copyGLTo2D(l,f),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(f.sourceTexture),l.deleteTexture(f.targetTexture),l.deleteFramebuffer(d),c.setTransform(1,0,0,1,0,0),f}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,s,r,a){const{NEAREST:o,TEXTURE_2D:l,RGBA:c,UNSIGNED_BYTE:u,CLAMP_TO_EDGE:f,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:p,TEXTURE_WRAP_T:g}=e,b=e.createTexture();return e.bindTexture(l,b),e.texParameteri(l,d,a||o),e.texParameteri(l,h,a||o),e.texParameteri(l,p,f),e.texParameteri(l,g,f),r?e.texImage2D(l,0,c,c,u,r):e.texImage2D(l,0,c,t,s,0,c,u,null),b}getCachedTexture(e,t,s){const{textureCache:r}=this;if(r[e])return r[e];{const a=this.createTexture(this.gl,t.width,t.height,t,s);return a&&(r[e]=a),a}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const s=e.canvas,r=t.targetCanvas,a=r.getContext("2d");if(!a)return;a.translate(0,r.height),a.scale(1,-1);const o=s.height-r.height;a.drawImage(s,0,o,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){const s=t.targetCanvas.getContext("2d"),r=t.destinationWidth,a=t.destinationHeight,o=r*a*4;if(!s)return;const l=new Uint8Array(this.imageBuffer,0,o),c=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,r,a,e.RGBA,e.UNSIGNED_BYTE,l);const u=new ImageData(c,r,a);s.putImageData(u,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const s=e.getExtension("WEBGL_debug_renderer_info");if(s){const r=e.getParameter(s.UNMASKED_RENDERER_WEBGL),a=e.getParameter(s.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),a&&(t.vendor=a.toLowerCase())}return this.gpuInfo=t,t}},b3;function bbe(){const{WebGLProbe:n}=Im();return n.queryWebGL(Am()),fi.enableGLFiltering&&n.isSupported(fi.textureSize)?new Jte({tileSize:fi.textureSize}):new ybe}function w3(){return!b3&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(b3=bbe()),b3}const wbe=["filters","resizeFilter","src","crossOrigin","type"],Zte=["cropX","cropY"];let ih=class lL extends wu{static getDefaults(){return lt(lt({},super.getDefaults()),lL.ownDefaults)}constructor(e,t){super(),it(this,"_lastScaleX",1),it(this,"_lastScaleY",1),it(this,"_filterScalingX",1),it(this,"_filterScalingY",1),this.filters=[],Object.assign(this,lL.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(l1()),this.setElement(typeof e=="string"?(this.canvas&&np(this.canvas.getElement())||E2()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(s),(t=e.classList)===null||t===void 0||t.add(lL.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=w3(!1);t instanceof Jte&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((e=>{const t=this[e];t&&Im().dispose(t),this[e]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,s=this.height/2;e.beginPath(),e.moveTo(-t,-s),e.lineTo(t,-s),e.lineTo(t,s),e.lineTo(-t,s),e.lineTo(-t,-s),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach((s=>{s&&t.push(s.toObject())})),lt(lt({},super.toObject([...Zte,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,s=-this.width/2,r=-this.height/2;let a=[],o=[],l="",c="";if(!t)return[];if(this.hasCrop()){const u=l1();a.push('<clipPath id="imageCrop_'+u+`">
`,'	<rect x="'+s+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+u+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(s-this.cropX,'" y="').concat(r-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(c).concat(l,`></image>
`)),this.stroke||this.strokeDashArray){const u=this.fill;this.fill=null,o=['	<rect x="'.concat(s,'" y="').concat(r,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=u}return a=this.paintFirst!==vl?a.concat(o,e):a.concat(e,o),a}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return iM(e,{crossOrigin:t,signal:s}).then((r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,s=this.getTotalObjectScaling(),r=s.x,a=s.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&a>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=a);const l=_d(o),{width:c,height:u}=o;this._element=l,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=a,w3().applyFilters([e],o,c,u,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter((a=>a&&!a.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,s=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){const a=_d({width:s,height:r});this._element=a,this._filteredEl=a}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,s,r),this._lastScaleX=1,this._lastScaleY=1);w3().applyFilters(e,this._originalElement,s,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const s=this._filterScalingX,r=this._filterScalingY,a=this.width,o=this.height,l=Math.max(this.cropX,0),c=Math.max(this.cropY,0),u=t.naturalWidth||t.width,f=t.naturalHeight||t.height,d=l*s,h=c*r,p=Math.min(a*s,u-d),g=Math.min(o*r,f-h),b=-a/2,v=-o/2,w=Math.min(a,u/s-l),x=Math.min(o,f/r-c);t&&e.drawImage(t,d,h,p,g,b,v,w,x)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=this.getOriginalSize();this.width=e||s.width,this.height=t||s.height}parsePreserveAspectRatioAttribute(){const e=dF(this.preserveAspectRatio||""),t=this.width,s=this.height,r={width:t,height:s};let a,o=this._element.width,l=this._element.height,c=1,u=1,f=0,d=0,h=0,p=0;return!e||e.alignX===zu&&e.alignY===zu?(c=t/o,u=s/l):(e.meetOrSlice==="meet"&&(c=u=Ate(this._element,r),a=(t-o*c)/2,e.alignX==="Min"&&(f=-a),e.alignX==="Max"&&(f=a),a=(s-l*u)/2,e.alignY==="Min"&&(d=-a),e.alignY==="Max"&&(d=a)),e.meetOrSlice==="slice"&&(c=u=Lte(this._element,r),a=o-t/c,e.alignX==="Mid"&&(h=a/2),e.alignX==="Max"&&(h=a),a=l-s/u,e.alignY==="Mid"&&(p=a/2),e.alignY==="Max"&&(p=a),o=t/c,l=s/u)),{width:o,height:l,scaleX:c,scaleY:u,offsetLeft:f,offsetTop:d,cropX:h,cropY:p}}static fromObject(e,t){let{filters:s,resizeFilter:r,src:a,crossOrigin:o,type:l}=e,c=Va(e,wbe);return Promise.all([iM(a,lt(lt({},t),{},{crossOrigin:o})),s&&t2(s,t),r&&t2([r],t),mT(c,t)]).then((u=>{let[f,d=[],[h]=[],p={}]=u;return new this(f,lt(lt({},c),{},{src:a,filters:d,resizeFilter:h},p))}))}static fromURL(e){let{crossOrigin:t=null,signal:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return iM(e,{crossOrigin:t,signal:s}).then((a=>new this(a,r)))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;const r=Ug(e,this.ATTRIBUTE_NAMES,s);return this.fromURL(r["xlink:href"]||r.href,t,r).catch((a=>(Lg("log","Unable to parse Image",a),null)))}};function v3(n){if(!T1e.test(n.nodeName))return{};const e=n.getAttribute("viewBox");let t,s,r=1,a=1,o=0,l=0;const c=n.getAttribute("width"),u=n.getAttribute("height"),f=n.getAttribute("x")||0,d=n.getAttribute("y")||0,h=!(e&&pV.test(e)),p=!c||!u||c==="100%"||u==="100%";let g="",b=0,v=0;if(h&&(f||d)&&n.parentNode&&n.parentNode.nodeName!=="#document"&&(g=" translate("+$u(f||"0")+" "+$u(d||"0")+") ",t=(n.getAttribute("transform")||"")+g,n.setAttribute("transform",t),n.removeAttribute("x"),n.removeAttribute("y")),h&&p)return{width:0,height:0};const w={width:0,height:0};if(h)return w.width=$u(c),w.height=$u(u),w;const x=e.match(pV);o=-parseFloat(x[1]),l=-parseFloat(x[2]);const S=parseFloat(x[3]),C=parseFloat(x[4]);w.minX=o,w.minY=l,w.viewBoxWidth=S,w.viewBoxHeight=C,p?(w.width=S,w.height=C):(w.width=$u(c),w.height=$u(u),r=w.width/S,a=w.height/C);const M=dF(n.getAttribute("preserveAspectRatio")||"");if(M.alignX!==zu&&(M.meetOrSlice==="meet"&&(a=r=r>a?a:r),M.meetOrSlice==="slice"&&(a=r=r>a?r:a),b=w.width-S*r,v=w.height-C*r,M.alignX==="Mid"&&(b/=2),M.alignY==="Mid"&&(v/=2),M.alignX==="Min"&&(b=0),M.alignY==="Min"&&(v=0)),r===1&&a===1&&o===0&&l===0&&f===0&&d===0)return w;if((f||d)&&n.parentNode.nodeName!=="#document"&&(g=" translate("+$u(f||"0")+" "+$u(d||"0")+") "),t=g+" matrix("+r+" 0 0 "+a+" "+(o*r+b)+" "+(l*a+v)+") ",n.nodeName==="svg"){for(s=n.ownerDocument.createElementNS(Aj,"g");n.firstChild;)s.appendChild(n.firstChild);n.appendChild(s)}else s=n,s.removeAttribute("x"),s.removeAttribute("y"),t=s.getAttribute("transform")+t;return s.setAttribute("transform",t),w}it(ih,"type","Image"),it(ih,"cacheProperties",[...Bg,...Zte]),it(ih,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),it(ih,"CSS_CANVAS","canvas-img"),it(ih,"ATTRIBUTE_NAMES",[...x1,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),Hn.setClass(ih),Hn.setSVGClass(ih);const rN=n=>n.tagName.replace("svg:",""),vbe=_4(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function ene(n,e){let t,s,r,a,o=[];for(r=0,a=e.length;r<a;r++)t=e[r],s=n.getElementsByTagNameNS("http://www.w3.org/2000/svg",t),o=o.concat(Array.from(s));return o}const _be=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],_3="xlink:href";function tne(n,e){var t;const s=((t=e.getAttribute(_3))===null||t===void 0?void 0:t.slice(1))||"",r=n.getElementById(s);if(r&&r.getAttribute(_3)&&tne(n,r),r&&(_be.forEach((a=>{const o=r.getAttribute(a);!e.hasAttribute(a)&&o&&e.setAttribute(a,o)})),!e.children.length)){const a=r.cloneNode(!0);for(;a.firstChild;)e.appendChild(a.firstChild)}e.removeAttribute(_3)}const xbe=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"];function Cbe(n){const e=n.getElementsByTagName("style"),t={};for(let s=0;s<e.length;s++){const r=(e[s].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");r.trim()!==""&&r.split("}").filter(((a,o,l)=>l.length>1&&a.trim())).forEach((a=>{if((a.match(/{/g)||[]).length>1&&a.trim().startsWith("@"))return;const o=a.split("{"),l={},c=o[1].trim().split(";").filter((function(u){return u.trim()}));for(let u=0;u<c.length;u++){const f=c[u].split(":"),d=f[0].trim(),h=f[1].trim();l[d]=h}(a=o[0].trim()).split(",").forEach((u=>{(u=u.replace(/^svg/i,"").trim())!==""&&(t[u]=lt(lt({},t[u]||{}),l))}))}))}return t}const FV=n=>Hn.getSVGClass(rN(n).toLowerCase());let Sbe=class{constructor(e,t,s,r,a){this.elements=e,this.options=t,this.reviver=s,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r,this.clipPaths=a,this.gradientDefs=(function(o){const l=ene(o,xbe),c={};let u=l.length;for(;u--;){const f=l[u];f.getAttribute("xlink:href")&&tne(o,f);const d=f.getAttribute("id");d&&(c[d]=f)}return c})(r),this.cssRules=Cbe(r)}parse(){return Promise.all(this.elements.map((e=>this.createObject(e))))}async createObject(e){const t=FV(e);if(t){const s=await t.fromElement(e,this.options,this.cssRules);return this.resolveGradient(s,e,vl),this.resolveGradient(s,e,Bu),s instanceof ih&&s._originalElement?aL(s,s.parsePreserveAspectRatioAttribute()):aL(s),await this.resolveClipPath(s,e),this.reviver&&this.reviver(e,s),s}return null}extractPropertyDefinition(e,t,s){const r=e[t],a=this.regexUrl;if(!a.test(r))return;a.lastIndex=0;const o=a.exec(r)[1];return a.lastIndex=0,s[o]}resolveGradient(e,t,s){const r=this.extractPropertyDefinition(e,s,this.gradientDefs);if(r){const a=t.getAttribute(s+"-opacity"),o=Ov.fromElement(r,e,lt(lt({},this.options),{},{opacity:a}));e.set(s,o)}}async resolveClipPath(e,t,s){const r=this.extractPropertyDefinition(e,"clipPath",this.clipPaths);if(r){const a=Cf(e.calcTransformMatrix()),o=r[0].parentElement;let l=t;for(;!s&&l.parentElement&&l.getAttribute("clip-path")!==e.clipPath;)l=l.parentElement;l.parentElement.appendChild(o);const c=ZL("".concat(l.getAttribute("transform")||""," ").concat(o.getAttribute("originalTransform")||""));o.setAttribute("transform","matrix(".concat(c.join(","),")"));const u=await Promise.all(r.map((x=>FV(x).fromElement(x,this.options,this.cssRules).then((S=>(aL(S),S.fillRule=S.clipRule,delete S.clipRule,S)))))),f=u.length===1?u[0]:new xm(u),d=Qo(a,f.calcTransformMatrix());f.clipPath&&await this.resolveClipPath(f,l,o.getAttribute("clip-path")?l:void 0);const{scaleX:h,scaleY:p,angle:g,skewX:b,translateX:v,translateY:w}=lb(d);f.set({flipX:!1,flipY:!1}),f.set({scaleX:h,scaleY:p,angle:g,skewX:b,skewY:0}),f.setPositionByOrigin(new Dt(v,w),Zs,Zs),e.clipPath=f}else delete e.clipPath}};const zV=n=>M1e.test(rN(n)),qj=()=>({objects:[],elements:[],options:{},allElements:[]});async function nne(n,e){let{crossOrigin:t,signal:s}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(s&&s.aborted)return Lg("log",new J6("parseSVGDocument")),qj();const r=n.documentElement;(function(f){const d=ene(f,["use","svg:use"]),h=["x","y","xlink:href","href","transform"];for(const p of d){const g=p.attributes,b={};for(const A of g)A.value&&(b[A.name]=A.value);const v=(b["xlink:href"]||b.href||"").slice(1);if(v==="")return;const w=f.getElementById(v);if(w===null)return;let x=w.cloneNode(!0);const S=x.attributes,C={};for(const A of S)A.value&&(C[A.name]=A.value);const{x:M=0,y:k=0,transform:E=""}=b,I="".concat(E," ").concat(C.transform||""," translate(").concat(M,", ").concat(k,")");if(v3(x),/^svg$/i.test(x.nodeName)){const A=x.ownerDocument.createElementNS(Aj,"g");Object.entries(C).forEach((D=>{let[L,P]=D;return A.setAttributeNS(Aj,L,P)})),A.append(...x.childNodes),x=A}for(const A of g){if(!A)continue;const{name:D,value:L}=A;if(!h.includes(D))if(D==="style"){const P={};Oj(L,P),Object.entries(C).forEach((G=>{let[Q,q]=G;P[Q]=q})),Oj(C.style||"",P);const j=Object.entries(P).map((G=>G.join(":"))).join(";");x.setAttribute(D,j)}else!C[D]&&x.setAttribute(D,L)}x.setAttribute("transform",I),x.setAttribute("instantiated_by_use","1"),x.removeAttribute("id"),p.parentNode.replaceChild(x,p)}})(n);const a=Array.from(r.getElementsByTagName("*")),o=lt(lt({},v3(r)),{},{crossOrigin:t,signal:s}),l=a.filter((f=>(v3(f),zV(f)&&!(function(d){let h=d;for(;h&&(h=h.parentElement);)if(h&&h.nodeName&&vbe.test(rN(h))&&!h.getAttribute("instantiated_by_use"))return!0;return!1})(f))));if(!l||l&&!l.length)return lt(lt({},qj()),{},{options:o,allElements:a});const c={};return a.filter((f=>rN(f)==="clipPath")).forEach((f=>{f.setAttribute("originalTransform",f.getAttribute("transform")||"");const d=f.getAttribute("id");c[d]=Array.from(f.getElementsByTagName("*")).filter((h=>zV(h)))})),{objects:await new Sbe(l,o,e,n,c).parse(),elements:l,options:o,allElements:a}}function sne(n,e,t){return nne(new(I2()).DOMParser().parseFromString(n.trim(),"text/xml"),e,t)}function Mbe(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(((s,r)=>{zte(n.replace(/^\n\s*/,"").trim(),{onComplete:a=>{const o=a.responseXML;o&&s(o),r()},signal:t.signal})})).then((s=>nne(s,e,t))).catch((()=>qj()))}const E4=n=>n.webgl!==void 0,CF="precision highp float",Tbe=`
    `.concat(CF,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),kbe=["type"],Ebe=["type"],Ibe=new RegExp(CF,"g");let Cl=class{get type(){return this.constructor.type}constructor(){let e=Va(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},kbe);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Tbe}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:r="highp"}}=Im();r!=="highp"&&(t=t.replace(Ibe,CF.replace("highp",r)));const a=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),l=e.createProgram();if(!a||!o||!l)throw new ym("Vertex, fragment shader or program creation error");if(e.shaderSource(a,s),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new ym("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new ym("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(l,a),e.attachShader(l,o),e.linkProgram(l),!e.getProgramParameter(l,e.LINK_STATUS))throw new ym('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(l)));const c=this.getUniformLocations(e,l)||{};return c.uStepW=e.getUniformLocation(l,"uStepW"),c.uStepH=e.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(e,l),uniformLocations:c}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const s=this.constructor.uniformLocations,r={};for(let a=0;a<s.length;a++)r[s[a]]=e.getUniformLocation(t,s[a]);return r}sendAttributeData(e,t,s){const r=t.aPosition,a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const s=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===s&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,s,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){E4(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,s=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(s.program),this.sendAttributeData(t,s.attributeLocations,e.aPosition),t.uniform1f(s.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(s.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,s.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,s){e.activeTexture(s),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:s}=e,r=_d({width:t,height:s});e.helpLayer=r}}toObject(){const e=Object.keys(this.constructor.defaults||{});return lt({type:this.type},e.reduce(((t,s)=>(t[s]=this[s],t)),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(Va(e,Ebe))}};it(Cl,"type","BaseFilter"),it(Cl,"uniformLocations",[]);const Abe={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};let SS=class extends Cl{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(Abe[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const s=new kf(this.color).getSource(),r=this.alpha,a=s[0]*r,o=s[1]*r,l=s[2]*r,c=1-r;for(let u=0;u<t.length;u+=4){const f=t[u],d=t[u+1],h=t[u+2];let p,g,b;switch(this.mode){case"multiply":p=f*a/255,g=d*o/255,b=h*l/255;break;case"screen":p=255-(255-f)*(255-a)/255,g=255-(255-d)*(255-o)/255,b=255-(255-h)*(255-l)/255;break;case"add":p=f+a,g=d+o,b=h+l;break;case"difference":p=Math.abs(f-a),g=Math.abs(d-o),b=Math.abs(h-l);break;case"subtract":p=f-a,g=d-o,b=h-l;break;case"darken":p=Math.min(f,a),g=Math.min(d,o),b=Math.min(h,l);break;case"lighten":p=Math.max(f,a),g=Math.max(d,o),b=Math.max(h,l);break;case"overlay":p=a<128?2*f*a/255:255-2*(255-f)*(255-a)/255,g=o<128?2*d*o/255:255-2*(255-d)*(255-o)/255,b=l<128?2*h*l/255:255-2*(255-h)*(255-l)/255;break;case"exclusion":p=a+f-2*a*f/255,g=o+d-2*o*d/255,b=l+h-2*l*h/255;break;case"tint":p=a+f*c,g=o+d*c,b=l+h*c}t[u]=p,t[u+1]=g,t[u+2]=b}}sendUniformData(e,t){const s=new kf(this.color).getSource();s[0]=this.alpha*s[0]/255,s[1]=this.alpha*s[1]/255,s[2]=this.alpha*s[2]/255,s[3]=this.alpha,e.uniform4fv(t.uColor,s)}};it(SS,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),it(SS,"type","BlendColor"),it(SS,"uniformLocations",["uColor"]),Hn.setClass(SS);const Lbe={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},Nbe=["type","image"];let MS=class extends Cl{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Lbe[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,s=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,s,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:s}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/s,1]}applyTo2d(e){let{imageData:{data:t,width:s,height:r},filterBackend:{resources:a}}=e;const o=this.image;a.blendImage||(a.blendImage=Am());const l=a.blendImage,c=l.getContext("2d");l.width!==s||l.height!==r?(l.width=s,l.height=r):c.clearRect(0,0,s,r),c.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),c.drawImage(o.getElement(),0,0,s,r);const u=c.getImageData(0,0,s,r).data;for(let f=0;f<t.length;f+=4){const d=t[f],h=t[f+1],p=t[f+2],g=t[f+3],b=u[f],v=u[f+1],w=u[f+2],x=u[f+3];switch(this.mode){case"multiply":t[f]=d*b/255,t[f+1]=h*v/255,t[f+2]=p*w/255,t[f+3]=g*x/255;break;case"mask":t[f+3]=x}}}sendUniformData(e,t){const s=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,s)}toObject(){return lt(lt({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:s,image:r}=e,a=Va(e,Nbe);return ih.fromObject(r,t).then((o=>new this(lt(lt({},a),{},{image:o}))))}};it(MS,"type","BlendImage"),it(MS,"defaults",{mode:"multiply",alpha:1}),it(MS,"uniformLocations",["uTransformMatrix","uImage"]),Hn.setClass(MS);let TS=class extends Cl{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){E4(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:s,height:r}}=e;this.aspectRatio=s/r,this.horizontal=!0;let a=this.getBlurValue()*s;const o=new Uint8ClampedArray(t),l=15,c=4*s;for(let u=0;u<t.length;u+=4){let f=0,d=0,h=0,p=0,g=0;const b=u-u%c,v=b+c;for(let w=-14;w<l;w++){const x=w/l,S=4*Math.floor(a*x),C=1-Math.abs(x);let M=u+S;M<b?M=b:M>v&&(M=v);const k=t[M+3]*C;f+=t[M]*k,d+=t[M+1]*k,h+=t[M+2]*k,p+=k,g+=C}o[u]=f/p,o[u+1]=d/p,o[u+2]=h/p,o[u+3]=p/g}this.horizontal=!1,a=this.getBlurValue()*r;for(let u=0;u<o.length;u+=4){let f=0,d=0,h=0,p=0,g=0;const b=u%c,v=o.length-c+b;for(let w=-14;w<l;w++){const x=w/l,S=Math.floor(a*x)*c,C=1-Math.abs(x);let M=u+S;M<b?M=b:M>v&&(M=v);const k=o[M+3]*C;f+=o[M]*k,d+=o[M+1]*k,h+=o[M+2]*k,p+=k,g+=C}t[u]=f/p,t[u+1]=d/p,t[u+2]=h/p,t[u+3]=p/g}}sendUniformData(e,t){const s=this.chooseRightDelta();e.uniform2fv(t.uDelta,s)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:s}=this;return t?s>1&&(e=1/s):s<1&&(e=s),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}};it(TS,"type","Blur"),it(TS,"defaults",{blur:0}),it(TS,"uniformLocations",["uDelta"]),Hn.setClass(TS);let kS=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]+=s,t[r+1]+=s,t[r+2]+=s}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}};it(kS,"type","Brightness"),it(kS,"defaults",{brightness:0}),it(kS,"uniformLocations",["uBrightness"]),Hn.setClass(kS);const rne={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};let Gy=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,s=this.matrix,r=this.colorsOnly;for(let a=0;a<t.length;a+=4){const o=t[a],l=t[a+1],c=t[a+2];if(t[a]=o*s[0]+l*s[1]+c*s[2]+255*s[4],t[a+1]=o*s[5]+l*s[6]+c*s[7]+255*s[9],t[a+2]=o*s[10]+l*s[11]+c*s[12]+255*s[14],!r){const u=t[a+3];t[a]+=u*s[3],t[a+1]+=u*s[8],t[a+2]+=u*s[13],t[a+3]=o*s[15]+l*s[16]+c*s[17]+u*s[18]+255*s[19]}}}sendUniformData(e,t){const s=this.matrix,r=[s[0],s[1],s[2],s[3],s[5],s[6],s[7],s[8],s[10],s[11],s[12],s[13],s[15],s[16],s[17],s[18]],a=[s[4],s[9],s[14],s[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,a)}toObject(){return lt(lt({},super.toObject()),{},{matrix:[...this.matrix]})}};function zb(n,e){var t;const s=(it(t=class extends Gy{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),it(t,"defaults",{colorsOnly:!1,matrix:e}),t);return Hn.setClass(s,n),s}it(Gy,"type","ColorMatrix"),it(Gy,"defaults",rne),it(Gy,"uniformLocations",["uColorMatrix","uConstants"]),Hn.setClass(Gy);const Dbe=zb("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),Obe=zb("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),Pbe=zb("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),$be=zb("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),jbe=zb("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),Rbe=zb("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),Fbe=zb("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);let Yj=class extends Cl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){E4(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach((t=>{t.applyTo(e)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((e=>e.toObject()))}}isNeutralState(){return!this.subFilters.some((e=>!e.isNeutralState()))}static fromObject(e,t){return Promise.all((e.subFilters||[]).map((s=>Hn.getClass(s.type).fromObject(s,t)))).then((s=>new this({subFilters:s})))}};it(Yj,"type","Composed"),Hn.setClass(Yj);let ES=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const s=Math.floor(255*this.contrast),r=259*(s+255)/(255*(259-s));for(let a=0;a<t.length;a+=4)t[a]=r*(t[a]-128)+128,t[a+1]=r*(t[a+1]-128)+128,t[a+2]=r*(t[a+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}};it(ES,"type","Contrast"),it(ES,"defaults",{contrast:0}),it(ES,"uniformLocations",["uContrast"]),Hn.setClass(ES);const zbe={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};let IS=class extends Cl{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return zbe[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,s=t.data,r=this.matrix,a=Math.round(Math.sqrt(r.length)),o=Math.floor(a/2),l=t.width,c=t.height,u=e.ctx.createImageData(l,c),f=u.data,d=this.opaque?1:0;let h,p,g,b,v,w,x,S,C,M,k,E,I;for(k=0;k<c;k++)for(M=0;M<l;M++){for(v=4*(k*l+M),h=0,p=0,g=0,b=0,I=0;I<a;I++)for(E=0;E<a;E++)x=k+I-o,w=M+E-o,x<0||x>=c||w<0||w>=l||(S=4*(x*l+w),C=r[I*a+E],h+=s[S]*C,p+=s[S+1]*C,g+=s[S+2]*C,d||(b+=s[S+3]*C));f[v]=h,f[v+1]=p,f[v+2]=g,f[v+3]=d?s[v+3]:b}e.imageData=u}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return lt(lt({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}};it(IS,"type","Convolute"),it(IS,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),it(IS,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),Hn.setClass(IS);const ine="Gamma";let AS=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const s=this.gamma,r=1/s[0],a=1/s[1],o=1/s[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const l=this.rgbValues;for(let c=0;c<256;c++)l.r[c]=255*Math.pow(c/255,r),l.g[c]=255*Math.pow(c/255,a),l.b[c]=255*Math.pow(c/255,o);for(let c=0;c<t.length;c+=4)t[c]=l.r[t[c]],t[c+1]=l.g[t[c+1]],t[c+2]=l.b[t[c+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:ine,gamma:this.gamma.concat()}}};it(AS,"type",ine),it(AS,"defaults",{gamma:[1,1,1]}),it(AS,"uniformLocations",["uGamma"]),Hn.setClass(AS);const Bbe={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};let LS=class extends Cl{applyTo2d(e){let{imageData:{data:t}}=e;for(let s,r=0;r<t.length;r+=4){const a=t[r],o=t[r+1],l=t[r+2];switch(this.mode){case"average":s=(a+o+l)/3;break;case"lightness":s=(Math.min(a,o,l)+Math.max(a,o,l))/2;break;case"luminosity":s=.21*a+.72*o+.07*l}t[r+2]=t[r+1]=t[r]=s}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Bbe[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}};it(LS,"type","Grayscale"),it(LS,"defaults",{mode:"average"}),it(LS,"uniformLocations",["uMode"]),Hn.setClass(LS);const Ube=lt(lt({},rne),{},{rotation:0});let cL=class extends Gy{calculateMatrix(){const e=this.rotation*Math.PI,t=hp(e),s=pp(e),r=1/3,a=Math.sqrt(r)*s,o=1-t;this.matrix=[t+o/3,r*o-a,r*o+a,0,0,r*o+a,t+r*o,r*o-a,0,0,r*o-a,r*o+a,t+r*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}};it(cL,"type","HueRotation"),it(cL,"defaults",Ube),Hn.setClass(cL);let NS=class extends Cl{applyTo2d(e){let{imageData:{data:t}}=e;for(let s=0;s<t.length;s+=4)t[s]=255-t[s],t[s+1]=255-t[s+1],t[s+2]=255-t[s+2],this.alpha&&(t[s+3]=255-t[s+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}};it(NS,"type","Invert"),it(NS,"defaults",{alpha:!1,invert:!0}),it(NS,"uniformLocations",["uInvert","uAlpha"]),Hn.setClass(NS);let DS=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=this.noise;for(let r=0;r<t.length;r+=4){const a=(.5-Math.random())*s;t[r]+=a,t[r+1]+=a,t[r+2]+=a}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}};it(DS,"type","Noise"),it(DS,"defaults",{noise:0}),it(DS,"uniformLocations",["uNoise","uSeed"]),Hn.setClass(DS);let OS=class extends Cl{applyTo2d(e){let{imageData:{data:t,width:s,height:r}}=e;for(let a=0;a<r;a+=this.blocksize)for(let o=0;o<s;o+=this.blocksize){const l=4*a*s+4*o,c=t[l],u=t[l+1],f=t[l+2],d=t[l+3];for(let h=a;h<Math.min(a+this.blocksize,r);h++)for(let p=o;p<Math.min(o+this.blocksize,s);p++){const g=4*h*s+4*p;t[g]=c,t[g+1]=u,t[g+2]=f,t[g+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}};it(OS,"type","Pixelate"),it(OS,"defaults",{blocksize:4}),it(OS,"uniformLocations",["uBlocksize"]),Hn.setClass(OS);let PS=class extends Cl{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=255*this.distance,r=new kf(this.color).getSource(),a=[r[0]-s,r[1]-s,r[2]-s],o=[r[0]+s,r[1]+s,r[2]+s];for(let l=0;l<t.length;l+=4){const c=t[l],u=t[l+1],f=t[l+2];c>a[0]&&u>a[1]&&f>a[2]&&c<o[0]&&u<o[1]&&f<o[2]&&(t[l+3]=0)}}sendUniformData(e,t){const s=new kf(this.color).getSource(),r=this.distance,a=[0+s[0]/255-r,0+s[1]/255-r,0+s[2]/255-r,1],o=[s[0]/255+r,s[1]/255+r,s[2]/255+r,1];e.uniform4fv(t.uLow,a),e.uniform4fv(t.uHigh,o)}};it(PS,"type","RemoveColor"),it(PS,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),it(PS,"uniformLocations",["uLow","uHigh"]),Hn.setClass(PS);let $S=class extends Cl{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,s=this.getFilterWindow(),r=new Array(s);for(let a=1;a<=s;a++)r[a-1]=e(a*t);return r}generateShader(e){const t=new Array(e);for(let s=1;s<=e;s++)t[s-1]="".concat(s,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map(((s,r)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(s,") * uTaps[").concat(r,"] + texture2D(uTexture, vTexCoord - ").concat(s,") * uTaps[").concat(r,`];
              sum += 2.0 * uTaps[`).concat(r,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){E4(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const s=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(s)/s}}applyTo2d(e){const t=e.imageData,s=this.scaleX,r=this.scaleY;this.rcpScaleX=1/s,this.rcpScaleY=1/r;const a=t.width,o=t.height,l=Math.round(a*s),c=Math.round(o*r);let u;u=this.resizeType==="sliceHack"?this.sliceByTwo(e,a,o,l,c):this.resizeType==="hermite"?this.hermiteFastResize(e,a,o,l,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,a,o,l,c):this.resizeType==="lanczos"?this.lanczosResize(e,a,o,l,c):new ImageData(l,c),e.imageData=u}sliceByTwo(e,t,s,r,a){const o=e.imageData,l=.5;let c=!1,u=!1,f=t*l,d=s*l;const h=e.filterBackend.resources;let p=0,g=0;const b=t;let v=0;h.sliceByTwo||(h.sliceByTwo=Am());const w=h.sliceByTwo;(w.width<1.5*t||w.height<s)&&(w.width=1.5*t,w.height=s);const x=w.getContext("2d");for(x.clearRect(0,0,1.5*t,s),x.putImageData(o,0,0),r=Math.floor(r),a=Math.floor(a);!c||!u;)t=f,s=d,r<Math.floor(f*l)?f=Math.floor(f*l):(f=r,c=!0),a<Math.floor(d*l)?d=Math.floor(d*l):(d=a,u=!0),x.drawImage(w,p,g,t,s,b,v,f,d),p=b,g=v,v+=d;return x.getImageData(p,g,r,a)}lanczosResize(e,t,s,r,a){const o=e.imageData.data,l=e.ctx.createImageData(r,a),c=l.data,u=this.lanczosCreate(this.lanczosLobes),f=this.rcpScaleX,d=this.rcpScaleY,h=2/this.rcpScaleX,p=2/this.rcpScaleY,g=Math.ceil(f*this.lanczosLobes/2),b=Math.ceil(d*this.lanczosLobes/2),v={},w={x:0,y:0},x={x:0,y:0};return(function S(C){let M,k,E,I,A,D,L,P,j,G,Q;for(w.x=(C+.5)*f,x.x=Math.floor(w.x),M=0;M<a;M++){for(w.y=(M+.5)*d,x.y=Math.floor(w.y),A=0,D=0,L=0,P=0,j=0,k=x.x-g;k<=x.x+g;k++)if(!(k<0||k>=t)){G=Math.floor(1e3*Math.abs(k-w.x)),v[G]||(v[G]={});for(let q=x.y-b;q<=x.y+b;q++)q<0||q>=s||(Q=Math.floor(1e3*Math.abs(q-w.y)),v[G][Q]||(v[G][Q]=u(Math.sqrt(Math.pow(G*h,2)+Math.pow(Q*p,2))/1e3)),E=v[G][Q],E>0&&(I=4*(q*t+k),A+=E,D+=E*o[I],L+=E*o[I+1],P+=E*o[I+2],j+=E*o[I+3]))}I=4*(M*r+C),c[I]=D/A,c[I+1]=L/A,c[I+2]=P/A,c[I+3]=j/A}return++C<r?S(C):l})(0)}bilinearFiltering(e,t,s,r,a){let o,l,c,u,f,d,h,p,g,b,v,w,x,S=0;const C=this.rcpScaleX,M=this.rcpScaleY,k=4*(t-1),E=e.imageData.data,I=e.ctx.createImageData(r,a),A=I.data;for(h=0;h<a;h++)for(p=0;p<r;p++)for(f=Math.floor(C*p),d=Math.floor(M*h),g=C*p-f,b=M*h-d,x=4*(d*t+f),v=0;v<4;v++)o=E[x+v],l=E[x+4+v],c=E[x+k+v],u=E[x+k+4+v],w=o*(1-g)*(1-b)+l*g*(1-b)+c*b*(1-g)+u*g*b,A[S++]=w;return I}hermiteFastResize(e,t,s,r,a){const o=this.rcpScaleX,l=this.rcpScaleY,c=Math.ceil(o/2),u=Math.ceil(l/2),f=e.imageData.data,d=e.ctx.createImageData(r,a),h=d.data;for(let p=0;p<a;p++)for(let g=0;g<r;g++){const b=4*(g+p*r);let v=0,w=0,x=0,S=0,C=0,M=0,k=0;const E=(p+.5)*l;for(let I=Math.floor(p*l);I<(p+1)*l;I++){const A=Math.abs(E-(I+.5))/u,D=(g+.5)*o,L=A*A;for(let P=Math.floor(g*o);P<(g+1)*o;P++){let j=Math.abs(D-(P+.5))/c;const G=Math.sqrt(L+j*j);G>1&&G<-1||(v=2*G*G*G-3*G*G+1,v>0&&(j=4*(P+I*t),k+=v*f[j+3],x+=v,f[j+3]<255&&(v=v*f[j+3]/250),S+=v*f[j],C+=v*f[j+1],M+=v*f[j+2],w+=v))}}h[b]=S/w,h[b+1]=C/w,h[b+2]=M/w,h[b+3]=k/x}return d}};it($S,"type","Resize"),it($S,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),it($S,"uniformLocations",["uDelta","uTaps"]),Hn.setClass($S);let jS=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=-this.saturation;for(let r=0;r<t.length;r+=4){const a=t[r],o=t[r+1],l=t[r+2],c=Math.max(a,o,l);t[r]+=c!==a?(c-a)*s:0,t[r+1]+=c!==o?(c-o)*s:0,t[r+2]+=c!==l?(c-l)*s:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}};it(jS,"type","Saturation"),it(jS,"defaults",{saturation:0}),it(jS,"uniformLocations",["uSaturation"]),Hn.setClass(jS);let RS=class extends Cl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const s=-this.vibrance;for(let r=0;r<t.length;r+=4){const a=t[r],o=t[r+1],l=t[r+2],c=Math.max(a,o,l),u=(a+o+l)/3,f=2*Math.abs(c-u)/255*s;t[r]+=c!==a?(c-a)*f:0,t[r+1]+=c!==o?(c-o)*f:0,t[r+2]+=c!==l?(c-l)*f:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}};it(RS,"type","Vibrance"),it(RS,"defaults",{vibrance:0}),it(RS,"uniformLocations",["uVibrance"]),Hn.setClass(RS);var Vbe=Object.freeze({__proto__:null,BaseFilter:Cl,BlackWhite:Fbe,BlendColor:SS,BlendImage:MS,Blur:TS,Brightness:kS,Brownie:Dbe,ColorMatrix:Gy,Composed:Yj,Contrast:ES,Convolute:IS,Gamma:AS,Grayscale:LS,HueRotation:cL,Invert:NS,Kodachrome:Pbe,Noise:DS,Pixelate:OS,Polaroid:jbe,RemoveColor:PS,Resize:$S,Saturation:jS,Sepia:Rbe,Technicolor:$be,Vibrance:RS,Vintage:Obe});const Wbe="modulepreload",Gbe=function(n,e){return new URL(n,e).href},BV={},x3=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let u=function(f){return Promise.all(f.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");r=u(t.map(f=>{if(f=Gbe(f,s),f in BV)return;BV[f]=!0;const d=f.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(s)for(let g=o.length-1;g>=0;g--){const b=o[g];if(b.href===f&&(!d||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Wbe,d||(p.as="script"),p.crossOrigin="",p.href=f,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((g,b)=>{p.addEventListener("load",g),p.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Wi(n){"@babel/helpers - typeof";return Wi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wi(n)}var mp=Uint8Array,fd=Uint16Array,SF=Int32Array,MF=new mp([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),TF=new mp([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),UV=new mp([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ane=function(n,e){for(var t=new fd(31),s=0;s<31;++s)t[s]=e+=1<<n[s-1];for(var r=new SF(t[30]),s=1;s<30;++s)for(var a=t[s];a<t[s+1];++a)r[a]=a-t[s]<<5|s;return{b:t,r}},one=ane(MF,2),Hbe=one.b,Kj=one.r;Hbe[28]=258,Kj[258]=28;var qbe=ane(TF,0),VV=qbe.r,Xj=new fd(32768);for(var Fa=0;Fa<32768;++Fa){var N0=(Fa&43690)>>1|(Fa&21845)<<1;N0=(N0&52428)>>2|(N0&13107)<<2,N0=(N0&61680)>>4|(N0&3855)<<4,Xj[Fa]=((N0&65280)>>8|(N0&255)<<8)>>1}var cM=(function(n,e,t){for(var s=n.length,r=0,a=new fd(e);r<s;++r)n[r]&&++a[n[r]-1];var o=new fd(e);for(r=1;r<e;++r)o[r]=o[r-1]+a[r-1]<<1;var l;if(t){l=new fd(1<<e);var c=15-e;for(r=0;r<s;++r)if(n[r])for(var u=r<<4|n[r],f=e-n[r],d=o[n[r]-1]++<<f,h=d|(1<<f)-1;d<=h;++d)l[Xj[d]>>c]=u}else for(l=new fd(s),r=0;r<s;++r)n[r]&&(l[r]=Xj[o[n[r]-1]++]>>15-n[r]);return l}),fb=new mp(288);for(var Fa=0;Fa<144;++Fa)fb[Fa]=8;for(var Fa=144;Fa<256;++Fa)fb[Fa]=9;for(var Fa=256;Fa<280;++Fa)fb[Fa]=7;for(var Fa=280;Fa<288;++Fa)fb[Fa]=8;var iN=new mp(32);for(var Fa=0;Fa<32;++Fa)iN[Fa]=5;var Ybe=cM(fb,9,0),Kbe=cM(iN,5,0),lne=function(n){return(n+7)/8|0},Xbe=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new mp(n.subarray(e,t))},ug=function(n,e,t){t<<=e&7;var s=e/8|0;n[s]|=t,n[s+1]|=t>>8},VC=function(n,e,t){t<<=e&7;var s=e/8|0;n[s]|=t,n[s+1]|=t>>8,n[s+2]|=t>>16},C3=function(n,e){for(var t=[],s=0;s<n.length;++s)n[s]&&t.push({s,f:n[s]});var r=t.length,a=t.slice();if(!r)return{t:une,l:0};if(r==1){var o=new mp(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(M,k){return M.f-k.f}),t.push({s:-1,f:25001});var l=t[0],c=t[1],u=0,f=1,d=2;for(t[0]={s:-1,f:l.f+c.f,l,r:c};f!=r-1;)l=t[t[u].f<t[d].f?u++:d++],c=t[u!=f&&t[u].f<t[d].f?u++:d++],t[f++]={s:-1,f:l.f+c.f,l,r:c};for(var h=a[0].s,s=1;s<r;++s)a[s].s>h&&(h=a[s].s);var p=new fd(h+1),g=Qj(t[f-1],p,0);if(g>e){var s=0,b=0,v=g-e,w=1<<v;for(a.sort(function(k,E){return p[E.s]-p[k.s]||k.f-E.f});s<r;++s){var x=a[s].s;if(p[x]>e)b+=w-(1<<g-p[x]),p[x]=e;else break}for(b>>=v;b>0;){var S=a[s].s;p[S]<e?b-=1<<e-p[S]++-1:++s}for(;s>=0&&b;--s){var C=a[s].s;p[C]==e&&(--p[C],++b)}g=e}return{t:new mp(p),l:g}},Qj=function(n,e,t){return n.s==-1?Math.max(Qj(n.l,e,t+1),Qj(n.r,e,t+1)):e[n.s]=t},WV=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new fd(++e),s=0,r=n[0],a=1,o=function(c){t[s++]=c},l=1;l<=e;++l)if(n[l]==r&&l!=e)++a;else{if(!r&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(r),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(r);a=1,r=n[l]}return{c:t.subarray(0,s),n:e}},WC=function(n,e){for(var t=0,s=0;s<e.length;++s)t+=n[s]*e[s];return t},cne=function(n,e,t){var s=t.length,r=lne(e+2);n[r]=s&255,n[r+1]=s>>8,n[r+2]=n[r]^255,n[r+3]=n[r+1]^255;for(var a=0;a<s;++a)n[r+a+4]=t[a];return(r+4+s)*8},GV=function(n,e,t,s,r,a,o,l,c,u,f){ug(e,f++,t),++r[256];for(var d=C3(r,15),h=d.t,p=d.l,g=C3(a,15),b=g.t,v=g.l,w=WV(h),x=w.c,S=w.n,C=WV(b),M=C.c,k=C.n,E=new fd(19),I=0;I<x.length;++I)++E[x[I]&31];for(var I=0;I<M.length;++I)++E[M[I]&31];for(var A=C3(E,7),D=A.t,L=A.l,P=19;P>4&&!D[UV[P-1]];--P);var j=u+5<<3,G=WC(r,fb)+WC(a,iN)+o,Q=WC(r,h)+WC(a,b)+o+14+3*P+WC(E,D)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&j<=G&&j<=Q)return cne(e,f,n.subarray(c,c+u));var q,te,Z,ne;if(ug(e,f,1+(Q<G)),f+=2,Q<G){q=cM(h,p,0),te=h,Z=cM(b,v,0),ne=b;var le=cM(D,L,0);ug(e,f,S-257),ug(e,f+5,k-1),ug(e,f+10,P-4),f+=14;for(var I=0;I<P;++I)ug(e,f+3*I,D[UV[I]]);f+=3*P;for(var H=[x,M],R=0;R<2;++R)for(var B=H[R],I=0;I<B.length;++I){var W=B[I]&31;ug(e,f,le[W]),f+=D[W],W>15&&(ug(e,f,B[I]>>5&127),f+=B[I]>>12)}}else q=Ybe,te=fb,Z=Kbe,ne=iN;for(var I=0;I<l;++I){var se=s[I];if(se>255){var W=se>>18&31;VC(e,f,q[W+257]),f+=te[W+257],W>7&&(ug(e,f,se>>23&31),f+=MF[W]);var ue=se&31;VC(e,f,Z[ue]),f+=ne[ue],ue>3&&(VC(e,f,se>>5&8191),f+=TF[ue])}else VC(e,f,q[se]),f+=te[se]}return VC(e,f,q[256]),f+te[256]},Qbe=new SF([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),une=new mp(0),Jbe=function(n,e,t,s,r,a){var o=a.z||n.length,l=new mp(s+o+5*(1+Math.ceil(o/7e3))+r),c=l.subarray(s,l.length-r),u=a.l,f=(a.r||0)&7;if(e){f&&(c[0]=a.r>>3);for(var d=Qbe[e-1],h=d>>13,p=d&8191,g=(1<<t)-1,b=a.p||new fd(32768),v=a.h||new fd(g+1),w=Math.ceil(t/3),x=2*w,S=function(We){return(n[We]^n[We+1]<<w^n[We+2]<<x)&g},C=new SF(25e3),M=new fd(288),k=new fd(32),E=0,I=0,A=a.i||0,D=0,L=a.w||0,P=0;A+2<o;++A){var j=S(A),G=A&32767,Q=v[j];if(b[G]=Q,v[j]=G,L<=A){var q=o-A;if((E>7e3||D>24576)&&(q>423||!u)){f=GV(n,c,0,C,M,k,I,D,P,A-P,f),D=E=I=0,P=A;for(var te=0;te<286;++te)M[te]=0;for(var te=0;te<30;++te)k[te]=0}var Z=2,ne=0,le=p,H=G-Q&32767;if(q>2&&j==S(A-H))for(var R=Math.min(h,q)-1,B=Math.min(32767,A),W=Math.min(258,q);H<=B&&--le&&G!=Q;){if(n[A+Z]==n[A+Z-H]){for(var se=0;se<W&&n[A+se]==n[A+se-H];++se);if(se>Z){if(Z=se,ne=H,se>R)break;for(var ue=Math.min(H,se-2),ge=0,te=0;te<ue;++te){var Ce=A-H+te&32767,Se=b[Ce],Me=Ce-Se&32767;Me>ge&&(ge=Me,Q=Ce)}}}G=Q,Q=b[G],H+=G-Q&32767}if(ne){C[D++]=268435456|Kj[Z]<<18|VV[ne];var pe=Kj[Z]&31,fe=VV[ne]&31;I+=MF[pe]+TF[fe],++M[257+pe],++k[fe],L=A+Z,++E}else C[D++]=n[A],++M[n[A]]}}for(A=Math.max(A,L);A<o;++A)C[D++]=n[A],++M[n[A]];f=GV(n,c,u,C,M,k,I,D,P,A-P,f),u||(a.r=f&7|c[f/8|0]<<3,f-=7,a.h=v,a.p=b,a.i=A,a.w=L)}else{for(var A=a.w||0;A<o+u;A+=65535){var $e=A+65535;$e>=o&&(c[f/8|0]=u,$e=o),f=cne(c,f+1,n.subarray(A,$e))}a.i=o}return Xbe(l,0,s+lne(f)+r)},fne=function(){var n=1,e=0;return{p:function(t){for(var s=n,r=e,a=t.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)r+=s+=t[o];s=(s&65535)+15*(s>>16),r=(r&65535)+15*(r>>16)}n=s,e=r},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},Zbe=function(n,e,t,s,r){if(!r&&(r={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new mp(a.length+n.length);o.set(a),o.set(n,a.length),n=o,r.w=a.length}return Jbe(n,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,s,r)},dne=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},ewe=function(n,e){var t=e.level,s=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=s<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var r=fne();r.p(e.dictionary),dne(n,2,r.d())}};function Jj(n,e){e||(e={});var t=fne();t.p(n);var s=Zbe(n,e,e.dictionary?6:2,4);return ewe(s,e),dne(s,s.length-4,t.d()),s}var twe=typeof TextDecoder<"u"&&new TextDecoder,nwe=0;try{twe.decode(une,{stream:!0}),nwe=1}catch{}function swe(n){if(Array.isArray(n))return n}function rwe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var s,r,a,o,l=[],c=!0,u=!1;try{if(a=(t=t.call(n)).next,e!==0)for(;!(c=(s=a.call(t)).done)&&(l.push(s.value),l.length!==e);c=!0);}catch(f){u=!0,r=f}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return l}}function HV(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=Array(e);t<e;t++)s[t]=n[t];return s}function iwe(n,e){if(n){if(typeof n=="string")return HV(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?HV(n,e):void 0}}function awe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qV(n,e){return swe(n)||rwe(n,e)||iwe(n,e)||awe()}function YV(n,e="utf8"){return new TextDecoder(e).decode(n)}const owe=new TextEncoder;function lwe(n){return owe.encode(n)}const cwe=1024*8,uwe=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),S3={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class kF{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=cwe,t={}){let s=!1;typeof e=="number"?e=new ArrayBuffer(e):(s=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,a=e.byteLength-r;let o=r;(ArrayBuffer.isView(e)||e instanceof kF)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+r),e=e.buffer),s?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const s=(this.offset+e)*2,r=new Uint8Array(s);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const s=S3[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,a=this.buffer.slice(r,r+s);if(this.littleEndian===uwe&&t!=="uint8"&&t!=="int8"){const l=new Uint8Array(this.buffer.slice(r,r+s));l.reverse();const c=new S3[t](l.buffer);return this.offset+=s,c.reverse(),c}const o=new S3[t](a);return this.offset+=s,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let s=0;s<e;s++)t+=this.readChar();return t}readUtf8(e=1){return YV(this.readBytes(e))}decodeText(e=1,t="utf8"){return YV(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(lwe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function P2(n){let e=n.length;for(;--e>=0;)n[e]=0}const fwe=3,dwe=258,hne=29,hwe=256,pwe=hwe+1+hne,pne=30,mwe=512,gwe=new Array((pwe+2)*2);P2(gwe);const ywe=new Array(pne*2);P2(ywe);const bwe=new Array(mwe);P2(bwe);const wwe=new Array(dwe-fwe+1);P2(wwe);const vwe=new Array(hne);P2(vwe);const _we=new Array(pne);P2(_we);const xwe=(n,e,t,s)=>{let r=n&65535|0,a=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+e[s++]|0,a=a+r|0;while(--o);r%=65521,a%=65521}return r|a<<16|0};var Zj=xwe;const Cwe=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},Swe=new Uint32Array(Cwe()),Mwe=(n,e,t,s)=>{const r=Swe,a=s+t;n^=-1;for(let o=s;o<a;o++)n=n>>>8^r[(n^e[o])&255];return n^-1};var sm=Mwe,eR={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},mne={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Twe=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var kwe=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const s in t)Twe(t,s)&&(n[s]=t[s])}}return n},Ewe=n=>{let e=0;for(let s=0,r=n.length;s<r;s++)e+=n[s].length;const t=new Uint8Array(e);for(let s=0,r=0,a=n.length;s<a;s++){let o=n[s];t.set(o,r),r+=o.length}return t},gne={assign:kwe,flattenChunks:Ewe};let yne=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{yne=!1}const TM=new Uint8Array(256);for(let n=0;n<256;n++)TM[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;TM[254]=TM[254]=1;var Iwe=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,s,r,a,o=n.length,l=0;for(r=0;r<o;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(s=n.charCodeAt(r+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),r++)),l+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(l),a=0,r=0;a<l;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(s=n.charCodeAt(r+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),r++)),t<128?e[a++]=t:t<2048?(e[a++]=192|t>>>6,e[a++]=128|t&63):t<65536?(e[a++]=224|t>>>12,e[a++]=128|t>>>6&63,e[a++]=128|t&63):(e[a++]=240|t>>>18,e[a++]=128|t>>>12&63,e[a++]=128|t>>>6&63,e[a++]=128|t&63);return e};const Awe=(n,e)=>{if(e<65534&&n.subarray&&yne)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let s=0;s<e;s++)t+=String.fromCharCode(n[s]);return t};var Lwe=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let s,r;const a=new Array(t*2);for(r=0,s=0;s<t;){let o=n[s++];if(o<128){a[r++]=o;continue}let l=TM[o];if(l>4){a[r++]=65533,s+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&s<t;)o=o<<6|n[s++]&63,l--;if(l>1){a[r++]=65533;continue}o<65536?a[r++]=o:(o-=65536,a[r++]=55296|o>>10&1023,a[r++]=56320|o&1023)}return Awe(a,r)},Nwe=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+TM[n[t]]>e?t:e},tR={string2buf:Iwe,buf2string:Lwe,utf8border:Nwe};function Dwe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Owe=Dwe;const gI=16209,Pwe=16191;var $we=function(e,t){let s,r,a,o,l,c,u,f,d,h,p,g,b,v,w,x,S,C,M,k,E,I,A,D;const L=e.state;s=e.next_in,A=e.input,r=s+(e.avail_in-5),a=e.next_out,D=e.output,o=a-(t-e.avail_out),l=a+(e.avail_out-257),c=L.dmax,u=L.wsize,f=L.whave,d=L.wnext,h=L.window,p=L.hold,g=L.bits,b=L.lencode,v=L.distcode,w=(1<<L.lenbits)-1,x=(1<<L.distbits)-1;e:do{g<15&&(p+=A[s++]<<g,g+=8,p+=A[s++]<<g,g+=8),S=b[p&w];t:for(;;){if(C=S>>>24,p>>>=C,g-=C,C=S>>>16&255,C===0)D[a++]=S&65535;else if(C&16){M=S&65535,C&=15,C&&(g<C&&(p+=A[s++]<<g,g+=8),M+=p&(1<<C)-1,p>>>=C,g-=C),g<15&&(p+=A[s++]<<g,g+=8,p+=A[s++]<<g,g+=8),S=v[p&x];n:for(;;){if(C=S>>>24,p>>>=C,g-=C,C=S>>>16&255,C&16){if(k=S&65535,C&=15,g<C&&(p+=A[s++]<<g,g+=8,g<C&&(p+=A[s++]<<g,g+=8)),k+=p&(1<<C)-1,k>c){e.msg="invalid distance too far back",L.mode=gI;break e}if(p>>>=C,g-=C,C=a-o,k>C){if(C=k-C,C>f&&L.sane){e.msg="invalid distance too far back",L.mode=gI;break e}if(E=0,I=h,d===0){if(E+=u-C,C<M){M-=C;do D[a++]=h[E++];while(--C);E=a-k,I=D}}else if(d<C){if(E+=u+d-C,C-=d,C<M){M-=C;do D[a++]=h[E++];while(--C);if(E=0,d<M){C=d,M-=C;do D[a++]=h[E++];while(--C);E=a-k,I=D}}}else if(E+=d-C,C<M){M-=C;do D[a++]=h[E++];while(--C);E=a-k,I=D}for(;M>2;)D[a++]=I[E++],D[a++]=I[E++],D[a++]=I[E++],M-=3;M&&(D[a++]=I[E++],M>1&&(D[a++]=I[E++]))}else{E=a-k;do D[a++]=D[E++],D[a++]=D[E++],D[a++]=D[E++],M-=3;while(M>2);M&&(D[a++]=D[E++],M>1&&(D[a++]=D[E++]))}}else if((C&64)===0){S=v[(S&65535)+(p&(1<<C)-1)];continue n}else{e.msg="invalid distance code",L.mode=gI;break e}break}}else if((C&64)===0){S=b[(S&65535)+(p&(1<<C)-1)];continue t}else if(C&32){L.mode=Pwe;break e}else{e.msg="invalid literal/length code",L.mode=gI;break e}break}}while(s<r&&a<l);M=g>>3,s-=M,g-=M<<3,p&=(1<<g)-1,e.next_in=s,e.next_out=a,e.avail_in=s<r?5+(r-s):5-(s-r),e.avail_out=a<l?257+(l-a):257-(a-l),L.hold=p,L.bits=g};const dv=15,KV=852,XV=592,QV=0,M3=1,JV=2,jwe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Rwe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Fwe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),zwe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Bwe=(n,e,t,s,r,a,o,l)=>{const c=l.bits;let u=0,f=0,d=0,h=0,p=0,g=0,b=0,v=0,w=0,x=0,S,C,M,k,E,I=null,A;const D=new Uint16Array(dv+1),L=new Uint16Array(dv+1);let P=null,j,G,Q;for(u=0;u<=dv;u++)D[u]=0;for(f=0;f<s;f++)D[e[t+f]]++;for(p=c,h=dv;h>=1&&D[h]===0;h--);if(p>h&&(p=h),h===0)return r[a++]=1<<24|64<<16|0,r[a++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<h&&D[d]===0;d++);for(p<d&&(p=d),v=1,u=1;u<=dv;u++)if(v<<=1,v-=D[u],v<0)return-1;if(v>0&&(n===QV||h!==1))return-1;for(L[1]=0,u=1;u<dv;u++)L[u+1]=L[u]+D[u];for(f=0;f<s;f++)e[t+f]!==0&&(o[L[e[t+f]]++]=f);if(n===QV?(I=P=o,A=20):n===M3?(I=jwe,P=Rwe,A=257):(I=Fwe,P=zwe,A=0),x=0,f=0,u=d,E=a,g=p,b=0,M=-1,w=1<<p,k=w-1,n===M3&&w>KV||n===JV&&w>XV)return 1;for(;;){j=u-b,o[f]+1<A?(G=0,Q=o[f]):o[f]>=A?(G=P[o[f]-A],Q=I[o[f]-A]):(G=96,Q=0),S=1<<u-b,C=1<<g,d=C;do C-=S,r[E+(x>>b)+C]=j<<24|G<<16|Q|0;while(C!==0);for(S=1<<u-1;x&S;)S>>=1;if(S!==0?(x&=S-1,x+=S):x=0,f++,--D[u]===0){if(u===h)break;u=e[t+o[f]]}if(u>p&&(x&k)!==M){for(b===0&&(b=p),E+=d,g=u-b,v=1<<g;g+b<h&&(v-=D[g+b],!(v<=0));)g++,v<<=1;if(w+=1<<g,n===M3&&w>KV||n===JV&&w>XV)return 1;M=x&k,r[M]=p<<24|g<<16|E-a|0}}return x!==0&&(r[E+x]=u-b<<24|64<<16|0),l.bits=p,0};var uM=Bwe;const Uwe=0,bne=1,wne=2,{Z_FINISH:ZV,Z_BLOCK:Vwe,Z_TREES:yI,Z_OK:db,Z_STREAM_END:Wwe,Z_NEED_DICT:Gwe,Z_STREAM_ERROR:ph,Z_DATA_ERROR:vne,Z_MEM_ERROR:_ne,Z_BUF_ERROR:Hwe,Z_DEFLATED:eW}=mne,I4=16180,tW=16181,nW=16182,sW=16183,rW=16184,iW=16185,aW=16186,oW=16187,lW=16188,cW=16189,aN=16190,fg=16191,T3=16192,uW=16193,k3=16194,fW=16195,dW=16196,hW=16197,pW=16198,bI=16199,wI=16200,mW=16201,gW=16202,yW=16203,bW=16204,wW=16205,E3=16206,vW=16207,_W=16208,Ka=16209,xne=16210,Cne=16211,qwe=852,Ywe=592,Kwe=15,Xwe=Kwe,xW=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function Qwe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bb=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<I4||e.mode>Cne?1:0},Sne=n=>{if(Bb(n))return ph;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=I4,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(qwe),e.distcode=e.distdyn=new Int32Array(Ywe),e.sane=1,e.back=-1,db},Mne=n=>{if(Bb(n))return ph;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,Sne(n)},Tne=(n,e)=>{let t;if(Bb(n))return ph;const s=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ph:(s.window!==null&&s.wbits!==e&&(s.window=null),s.wrap=t,s.wbits=e,Mne(n))},kne=(n,e)=>{if(!n)return ph;const t=new Qwe;n.state=t,t.strm=n,t.window=null,t.mode=I4;const s=Tne(n,e);return s!==db&&(n.state=null),s},Jwe=n=>kne(n,Xwe);let CW=!0,I3,A3;const Zwe=n=>{if(CW){I3=new Int32Array(512),A3=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(uM(bne,n.lens,0,288,I3,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;uM(wne,n.lens,0,32,A3,0,n.work,{bits:5}),CW=!1}n.lencode=I3,n.lenbits=9,n.distcode=A3,n.distbits=5},Ene=(n,e,t,s)=>{let r;const a=n.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),s>=a.wsize?(a.window.set(e.subarray(t-a.wsize,t),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>s&&(r=s),a.window.set(e.subarray(t-s,t-s+r),a.wnext),s-=r,s?(a.window.set(e.subarray(t-s,t),0),a.wnext=s,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0},eve=(n,e)=>{let t,s,r,a,o,l,c,u,f,d,h,p,g,b,v=0,w,x,S,C,M,k,E,I;const A=new Uint8Array(4);let D,L;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bb(n)||!n.output||!n.input&&n.avail_in!==0)return ph;t=n.state,t.mode===fg&&(t.mode=T3),o=n.next_out,r=n.output,c=n.avail_out,a=n.next_in,s=n.input,l=n.avail_in,u=t.hold,f=t.bits,d=l,h=c,I=db;e:for(;;)switch(t.mode){case I4:if(t.wrap===0){t.mode=T3;break}for(;f<16;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(t.wrap&2&&u===35615){t.wbits===0&&(t.wbits=15),t.check=0,A[0]=u&255,A[1]=u>>>8&255,t.check=sm(t.check,A,2,0),u=0,f=0,t.mode=tW;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){n.msg="incorrect header check",t.mode=Ka;break}if((u&15)!==eW){n.msg="unknown compression method",t.mode=Ka;break}if(u>>>=4,f-=4,E=(u&15)+8,t.wbits===0&&(t.wbits=E),E>15||E>t.wbits){n.msg="invalid window size",t.mode=Ka;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=u&512?cW:fg,u=0,f=0;break;case tW:for(;f<16;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(t.flags=u,(t.flags&255)!==eW){n.msg="unknown compression method",t.mode=Ka;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Ka;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,t.check=sm(t.check,A,2,0)),u=0,f=0,t.mode=nW;case nW:for(;f<32;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}t.head&&(t.head.time=u),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,A[2]=u>>>16&255,A[3]=u>>>24&255,t.check=sm(t.check,A,4,0)),u=0,f=0,t.mode=sW;case sW:for(;f<16;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,t.check=sm(t.check,A,2,0)),u=0,f=0,t.mode=rW;case rW:if(t.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,t.check=sm(t.check,A,2,0)),u=0,f=0}else t.head&&(t.head.extra=null);t.mode=iW;case iW:if(t.flags&1024&&(p=t.length,p>l&&(p=l),p&&(t.head&&(E=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(s.subarray(a,a+p),E)),t.flags&512&&t.wrap&4&&(t.check=sm(t.check,s,p,a)),l-=p,a+=p,t.length-=p),t.length))break e;t.length=0,t.mode=aW;case aW:if(t.flags&2048){if(l===0)break e;p=0;do E=s[a+p++],t.head&&E&&t.length<65536&&(t.head.name+=String.fromCharCode(E));while(E&&p<l);if(t.flags&512&&t.wrap&4&&(t.check=sm(t.check,s,p,a)),l-=p,a+=p,E)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=oW;case oW:if(t.flags&4096){if(l===0)break e;p=0;do E=s[a+p++],t.head&&E&&t.length<65536&&(t.head.comment+=String.fromCharCode(E));while(E&&p<l);if(t.flags&512&&t.wrap&4&&(t.check=sm(t.check,s,p,a)),l-=p,a+=p,E)break e}else t.head&&(t.head.comment=null);t.mode=lW;case lW:if(t.flags&512){for(;f<16;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(t.wrap&4&&u!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Ka;break}u=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=fg;break;case cW:for(;f<32;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}n.adler=t.check=xW(u),u=0,f=0,t.mode=aN;case aN:if(t.havedict===0)return n.next_out=o,n.avail_out=c,n.next_in=a,n.avail_in=l,t.hold=u,t.bits=f,Gwe;n.adler=t.check=1,t.mode=fg;case fg:if(e===Vwe||e===yI)break e;case T3:if(t.last){u>>>=f&7,f-=f&7,t.mode=E3;break}for(;f<3;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}switch(t.last=u&1,u>>>=1,f-=1,u&3){case 0:t.mode=uW;break;case 1:if(Zwe(t),t.mode=bI,e===yI){u>>>=2,f-=2;break e}break;case 2:t.mode=dW;break;case 3:n.msg="invalid block type",t.mode=Ka}u>>>=2,f-=2;break;case uW:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Ka;break}if(t.length=u&65535,u=0,f=0,t.mode=k3,e===yI)break e;case k3:t.mode=fW;case fW:if(p=t.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;r.set(s.subarray(a,a+p),o),l-=p,a+=p,c-=p,o+=p,t.length-=p;break}t.mode=fg;break;case dW:for(;f<14;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(t.nlen=(u&31)+257,u>>>=5,f-=5,t.ndist=(u&31)+1,u>>>=5,f-=5,t.ncode=(u&15)+4,u>>>=4,f-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Ka;break}t.have=0,t.mode=hW;case hW:for(;t.have<t.ncode;){for(;f<3;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}t.lens[P[t.have++]]=u&7,u>>>=3,f-=3}for(;t.have<19;)t.lens[P[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,D={bits:t.lenbits},I=uM(Uwe,t.lens,0,19,t.lencode,0,t.work,D),t.lenbits=D.bits,I){n.msg="invalid code lengths set",t.mode=Ka;break}t.have=0,t.mode=pW;case pW:for(;t.have<t.nlen+t.ndist;){for(;v=t.lencode[u&(1<<t.lenbits)-1],w=v>>>24,x=v>>>16&255,S=v&65535,!(w<=f);){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(S<16)u>>>=w,f-=w,t.lens[t.have++]=S;else{if(S===16){for(L=w+2;f<L;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(u>>>=w,f-=w,t.have===0){n.msg="invalid bit length repeat",t.mode=Ka;break}E=t.lens[t.have-1],p=3+(u&3),u>>>=2,f-=2}else if(S===17){for(L=w+3;f<L;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}u>>>=w,f-=w,E=0,p=3+(u&7),u>>>=3,f-=3}else{for(L=w+7;f<L;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}u>>>=w,f-=w,E=0,p=11+(u&127),u>>>=7,f-=7}if(t.have+p>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Ka;break}for(;p--;)t.lens[t.have++]=E}}if(t.mode===Ka)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Ka;break}if(t.lenbits=9,D={bits:t.lenbits},I=uM(bne,t.lens,0,t.nlen,t.lencode,0,t.work,D),t.lenbits=D.bits,I){n.msg="invalid literal/lengths set",t.mode=Ka;break}if(t.distbits=6,t.distcode=t.distdyn,D={bits:t.distbits},I=uM(wne,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,D),t.distbits=D.bits,I){n.msg="invalid distances set",t.mode=Ka;break}if(t.mode=bI,e===yI)break e;case bI:t.mode=wI;case wI:if(l>=6&&c>=258){n.next_out=o,n.avail_out=c,n.next_in=a,n.avail_in=l,t.hold=u,t.bits=f,$we(n,h),o=n.next_out,r=n.output,c=n.avail_out,a=n.next_in,s=n.input,l=n.avail_in,u=t.hold,f=t.bits,t.mode===fg&&(t.back=-1);break}for(t.back=0;v=t.lencode[u&(1<<t.lenbits)-1],w=v>>>24,x=v>>>16&255,S=v&65535,!(w<=f);){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(x&&(x&240)===0){for(C=w,M=x,k=S;v=t.lencode[k+((u&(1<<C+M)-1)>>C)],w=v>>>24,x=v>>>16&255,S=v&65535,!(C+w<=f);){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}u>>>=C,f-=C,t.back+=C}if(u>>>=w,f-=w,t.back+=w,t.length=S,x===0){t.mode=wW;break}if(x&32){t.back=-1,t.mode=fg;break}if(x&64){n.msg="invalid literal/length code",t.mode=Ka;break}t.extra=x&15,t.mode=mW;case mW:if(t.extra){for(L=t.extra;f<L;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=gW;case gW:for(;v=t.distcode[u&(1<<t.distbits)-1],w=v>>>24,x=v>>>16&255,S=v&65535,!(w<=f);){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if((x&240)===0){for(C=w,M=x,k=S;v=t.distcode[k+((u&(1<<C+M)-1)>>C)],w=v>>>24,x=v>>>16&255,S=v&65535,!(C+w<=f);){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}u>>>=C,f-=C,t.back+=C}if(u>>>=w,f-=w,t.back+=w,x&64){n.msg="invalid distance code",t.mode=Ka;break}t.offset=S,t.extra=x&15,t.mode=yW;case yW:if(t.extra){for(L=t.extra;f<L;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Ka;break}t.mode=bW;case bW:if(c===0)break e;if(p=h-c,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Ka;break}p>t.wnext?(p-=t.wnext,g=t.wsize-p):g=t.wnext-p,p>t.length&&(p=t.length),b=t.window}else b=r,g=o-t.offset,p=t.length;p>c&&(p=c),c-=p,t.length-=p;do r[o++]=b[g++];while(--p);t.length===0&&(t.mode=wI);break;case wW:if(c===0)break e;r[o++]=t.length,c--,t.mode=wI;break;case E3:if(t.wrap){for(;f<32;){if(l===0)break e;l--,u|=s[a++]<<f,f+=8}if(h-=c,n.total_out+=h,t.total+=h,t.wrap&4&&h&&(n.adler=t.check=t.flags?sm(t.check,r,h,o-h):Zj(t.check,r,h,o-h)),h=c,t.wrap&4&&(t.flags?u:xW(u))!==t.check){n.msg="incorrect data check",t.mode=Ka;break}u=0,f=0}t.mode=vW;case vW:if(t.wrap&&t.flags){for(;f<32;){if(l===0)break e;l--,u+=s[a++]<<f,f+=8}if(t.wrap&4&&u!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Ka;break}u=0,f=0}t.mode=_W;case _W:I=Wwe;break e;case Ka:I=vne;break e;case xne:return _ne;case Cne:default:return ph}return n.next_out=o,n.avail_out=c,n.next_in=a,n.avail_in=l,t.hold=u,t.bits=f,(t.wsize||h!==n.avail_out&&t.mode<Ka&&(t.mode<E3||e!==ZV))&&Ene(n,n.output,n.next_out,h-n.avail_out),d-=n.avail_in,h-=n.avail_out,n.total_in+=d,n.total_out+=h,t.total+=h,t.wrap&4&&h&&(n.adler=t.check=t.flags?sm(t.check,r,h,n.next_out-h):Zj(t.check,r,h,n.next_out-h)),n.data_type=t.bits+(t.last?64:0)+(t.mode===fg?128:0)+(t.mode===bI||t.mode===k3?256:0),(d===0&&h===0||e===ZV)&&I===db&&(I=Hwe),I},tve=n=>{if(Bb(n))return ph;let e=n.state;return e.window&&(e.window=null),n.state=null,db},nve=(n,e)=>{if(Bb(n))return ph;const t=n.state;return(t.wrap&2)===0?ph:(t.head=e,e.done=!1,db)},sve=(n,e)=>{const t=e.length;let s,r,a;return Bb(n)||(s=n.state,s.wrap!==0&&s.mode!==aN)?ph:s.mode===aN&&(r=1,r=Zj(r,e,t,0),r!==s.check)?vne:(a=Ene(n,e,t,t),a?(s.mode=xne,_ne):(s.havedict=1,db))};var rve=Mne,ive=Tne,ave=Sne,ove=Jwe,lve=kne,cve=eve,uve=tve,fve=nve,dve=sve,hve="pako inflate (from Nodeca project)",bg={inflateReset:rve,inflateReset2:ive,inflateResetKeep:ave,inflateInit:ove,inflateInit2:lve,inflate:cve,inflateEnd:uve,inflateGetHeader:fve,inflateSetDictionary:dve,inflateInfo:hve};function pve(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var mve=pve;const Ine=Object.prototype.toString,{Z_NO_FLUSH:gve,Z_FINISH:yve,Z_OK:kM,Z_STREAM_END:L3,Z_NEED_DICT:N3,Z_STREAM_ERROR:bve,Z_DATA_ERROR:SW,Z_MEM_ERROR:wve}=mne;function yT(n){this.options=gne.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Owe,this.strm.avail_out=0;let t=bg.inflateInit2(this.strm,e.windowBits);if(t!==kM)throw new Error(eR[t]);if(this.header=new mve,bg.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=tR.string2buf(e.dictionary):Ine.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=bg.inflateSetDictionary(this.strm,e.dictionary),t!==kM)))throw new Error(eR[t])}yT.prototype.push=function(n,e){const t=this.strm,s=this.options.chunkSize,r=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?yve:gve,Ine.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),a=bg.inflate(t,o),a===N3&&r&&(a=bg.inflateSetDictionary(t,r),a===kM?a=bg.inflate(t,o):a===SW&&(a=N3));t.avail_in>0&&a===L3&&t.state.wrap>0&&n[t.next_in]!==0;)bg.inflateReset(t),a=bg.inflate(t,o);switch(a){case bve:case SW:case N3:case wve:return this.onEnd(a),this.ended=!0,!1}if(l=t.avail_out,t.next_out&&(t.avail_out===0||a===L3))if(this.options.to==="string"){let c=tR.utf8border(t.output,t.next_out),u=t.next_out-c,f=tR.buf2string(t.output,c);t.next_out=u,t.avail_out=s-u,u&&t.output.set(t.output.subarray(c,c+u),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(a===kM&&l===0)){if(a===L3)return a=bg.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};yT.prototype.onData=function(n){this.chunks.push(n)};yT.prototype.onEnd=function(n){n===kM&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gne.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function vve(n,e){const t=new yT(e);if(t.push(n),t.err)throw t.msg||eR[t.err];return t.result}var _ve=yT,xve=vve,Cve={Inflate:_ve,inflate:xve};const{Inflate:Sve,inflate:Mve}=Cve;var MW=Sve,Tve=Mve;const Ane=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;Ane[n]=e}const TW=4294967295;function kve(n,e,t){let s=n;for(let r=0;r<t;r++)s=Ane[(s^e[r])&255]^s>>>8;return s}function Eve(n,e){return(kve(TW,n,e)^TW)>>>0}function kW(n,e,t){const s=n.readUint32(),r=Eve(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(r!==s)throw new Error(`CRC mismatch for chunk ${t}. Expected ${s}, found ${r}`)}function Lne(n,e,t){for(let s=0;s<t;s++)e[s]=n[s]}function Nne(n,e,t,s){let r=0;for(;r<s;r++)e[r]=n[r];for(;r<t;r++)e[r]=n[r]+e[r-s]&255}function Dne(n,e,t,s){let r=0;if(t.length===0)for(;r<s;r++)e[r]=n[r];else for(;r<s;r++)e[r]=n[r]+t[r]&255}function One(n,e,t,s,r){let a=0;if(t.length===0){for(;a<r;a++)e[a]=n[a];for(;a<s;a++)e[a]=n[a]+(e[a-r]>>1)&255}else{for(;a<r;a++)e[a]=n[a]+(t[a]>>1)&255;for(;a<s;a++)e[a]=n[a]+(e[a-r]+t[a]>>1)&255}}function Pne(n,e,t,s,r){let a=0;if(t.length===0){for(;a<r;a++)e[a]=n[a];for(;a<s;a++)e[a]=n[a]+e[a-r]&255}else{for(;a<r;a++)e[a]=n[a]+t[a]&255;for(;a<s;a++)e[a]=n[a]+Ive(e[a-r],t[a],t[a-r])&255}}function Ive(n,e,t){const s=n+e-t,r=Math.abs(s-n),a=Math.abs(s-e),o=Math.abs(s-t);return r<=a&&r<=o?n:a<=o?e:t}function Ave(n,e,t,s,r,a){switch(n){case 0:Lne(e,t,r);break;case 1:Nne(e,t,r,a);break;case 2:Dne(e,t,s,r);break;case 3:One(e,t,s,r,a);break;case 4:Pne(e,t,s,r,a);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Lve=new Uint16Array([255]),Nve=new Uint8Array(Lve.buffer),Dve=Nve[0]===255;function Ove(n){const{data:e,width:t,height:s,channels:r,depth:a}=n,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*r,c=new Uint8Array(s*t*l);let u=0;for(let f=0;f<7;f++){const d=o[f],h=Math.ceil((t-d.x)/d.xStep),p=Math.ceil((s-d.y)/d.yStep);if(h<=0||p<=0)continue;const g=h*l,b=new Uint8Array(g);for(let v=0;v<p;v++){const w=e[u++],x=e.subarray(u,u+g);u+=g;const S=new Uint8Array(g);Ave(w,x,S,b,g,l),b.set(S);for(let C=0;C<h;C++){const M=d.x+C*d.xStep,k=d.y+v*d.yStep;if(!(M>=t||k>=s))for(let E=0;E<l;E++)c[(k*t+M)*l+E]=S[C*l+E]}}}if(a===16){const f=new Uint16Array(c.buffer);if(Dve)for(let d=0;d<f.length;d++)f[d]=Pve(f[d]);return f}else return c}function Pve(n){return(n&255)<<8|n>>8&255}const $ve=new Uint16Array([255]),jve=new Uint8Array($ve.buffer),Rve=jve[0]===255,Fve=new Uint8Array(0);function EW(n){const{data:e,width:t,height:s,channels:r,depth:a}=n,o=Math.ceil(a/8)*r,l=Math.ceil(a/8*r*t),c=new Uint8Array(s*l);let u=Fve,f=0,d,h;for(let p=0;p<s;p++){switch(d=e.subarray(f+1,f+1+l),h=c.subarray(p*l,(p+1)*l),e[f]){case 0:Lne(d,h,l);break;case 1:Nne(d,h,l,o);break;case 2:Dne(d,h,u,l);break;case 3:One(d,h,u,l,o);break;case 4:Pne(d,h,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=h,f+=l+1}if(a===16){const p=new Uint16Array(c.buffer);if(Rve)for(let g=0;g<p.length;g++)p[g]=zve(p[g]);return p}else return c}function zve(n){return(n&255)<<8|n>>8&255}const uL=Uint8Array.of(137,80,78,71,13,10,26,10);function IW(n){if(!Bve(n.readBytes(uL.length)))throw new Error("wrong PNG signature")}function Bve(n){if(n.length<uL.length)return!1;for(let e=0;e<uL.length;e++)if(n[e]!==uL[e])return!1;return!0}const Uve="tEXt",Vve=0,$ne=new TextDecoder("latin1");function Wve(n){if(Hve(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Gve=/^[\u0000-\u00FF]*$/;function Hve(n){if(!Gve.test(n))throw new Error("invalid latin1 text")}function qve(n,e,t){const s=jne(e);n[s]=Yve(e,t-s.length-1)}function jne(n){for(n.mark();n.readByte()!==Vve;);const e=n.offset;n.reset();const t=$ne.decode(n.readBytes(e-n.offset-1));return n.skip(1),Wve(t),t}function Yve(n,e){return $ne.decode(n.readBytes(e))}const sd={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},D3={UNKNOWN:-1,DEFLATE:0},AW={UNKNOWN:-1,ADAPTIVE:0},O3={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},vI={NONE:0,BACKGROUND:1,PREVIOUS:2},P3={SOURCE:0,OVER:1};class Kve extends kF{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:s=!1}=t;this._checkCrc=s,this._inflator=new MW,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=D3.UNKNOWN,this._filterMethod=AW.UNKNOWN,this._interlaceMethod=O3.UNKNOWN,this._colorType=sd.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(IW(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(IW(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const s=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Uve:qve(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?kW(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const s=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=s+e;break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?kW(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=Xve(this.readUint8());const t=this.readUint8();this._colorType=t;let s;switch(t){case sd.GREYSCALE:s=1;break;case sd.TRUECOLOUR:s=3;break;case sd.INDEXED_COLOUR:s=1;break;case sd.GREYSCALE_ALPHA:s=2;break;case sd.TRUECOLOUR_ALPHA:s=4;break;case sd.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==D3.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const s=[];this._palette=s;for(let r=0;r<t;r++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,s=this.offset+this.byteOffset;if(s+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,s,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case sd.GREYSCALE:case sd.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case sd.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const s=this.readByte();this._palette[t].push(s)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case sd.UNKNOWN:case sd.GREYSCALE_ALPHA:case sd.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=jne(this),s=this.readUint8();if(s!==D3.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:Tve(r)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),s=this.readByte();this._png.resolution={x:e,y:t,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(e);if(s){if(s.data=EW({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)t.data=s.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(s,r,t),this.addFrameDataToCanvas(t,s)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,s){switch(e.disposeOp){case vI.NONE:break;case vI.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let a=0;a<this._png.width;a++){const o=(r*e.width+a)*this._png.channels;for(let l=0;l<this._png.channels;l++)s.data[o+l]=0}break;case vI.PREVIOUS:s.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const s=1<<this._png.depth,r=(a,o)=>{const l=((a+t.yOffset)*this._png.width+t.xOffset+o)*this._png.channels,c=(a*t.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(t.blendOp){case P3.SOURCE:for(let a=0;a<t.height;a++)for(let o=0;o<t.width;o++){const{index:l,frameIndex:c}=r(a,o);for(let u=0;u<this._png.channels;u++)e.data[l+u]=t.data[c+u]}break;case P3.OVER:for(let a=0;a<t.height;a++)for(let o=0;o<t.width;o++){const{index:l,frameIndex:c}=r(a,o);for(let u=0;u<this._png.channels;u++){const f=t.data[c+this._png.channels-1]/s,d=u%(this._png.channels-1)===0?1:t.data[c+u],h=Math.floor(f*d+(1-f)*e.data[l+u]);e.data[l+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==AW.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===O3.NO_INTERLACE)this._png.data=EW({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===O3.ADAM7)this._png.data=Ove({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:vI.NONE,blendOp:P3.SOURCE,data:e}),this._inflator=new MW,this._writingDataChunks=!1}}function Xve(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var LW;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(LW||(LW={}));function Qve(n,e){return new Kve(n,e).decode()}var zs=(function(){return typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:this})();function $3(){zs.console&&typeof zs.console.log=="function"&&zs.console.log.apply(zs.console,arguments)}var ha={log:$3,warn:function(n){zs.console&&(typeof zs.console.warn=="function"?zs.console.warn.apply(zs.console,arguments):$3.call(null,arguments))},error:function(n){zs.console&&(typeof zs.console.error=="function"?zs.console.error.apply(zs.console,arguments):$3(n))}};function j3(n,e,t){var s=new XMLHttpRequest;s.open("GET",n),s.responseType="blob",s.onload=function(){ky(s.response,e,t)},s.onerror=function(){ha.error("could not download file")},s.send()}function NW(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function _I(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var ky=zs.saveAs||((typeof window>"u"?"undefined":Wi(window))!=="object"||window!==zs?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var s=zs.URL||zs.webkitURL,r=document.createElement("a");e=e||n.name||"download",r.download=e,r.rel="noopener",typeof n=="string"?(r.href=n,r.origin!==location.origin?NW(r.href)?j3(n,e,t):_I(r,r.target="_blank"):_I(r)):(r.href=s.createObjectURL(n),setTimeout(function(){s.revokeObjectURL(r.href)},4e4),setTimeout(function(){_I(r)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(NW(n))j3(n,e,t);else{var s=document.createElement("a");s.href=n,s.target="_blank",setTimeout(function(){_I(s)})}else navigator.msSaveOrOpenBlob((function(r,a){return a===void 0?a={autoBom:!1}:Wi(a)!=="object"&&(ha.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(n,t),e)}:function(n,e,t,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof n=="string")return j3(n,e,t);var r=n.type==="application/octet-stream",a=/constructor/i.test(zs.HTMLElement)||zs.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||r&&a)&&(typeof FileReader>"u"?"undefined":Wi(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=f:location=f,s=null},l.readAsDataURL(n)}else{var c=zs.URL||zs.webkitURL,u=c.createObjectURL(n);s?s.location=u:location.href=u,s=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});function Rne(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],s=0;s<t.length;s++){var r=t[s].re,a=t[s].process,o=r.exec(n);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var fL=zs.atob.bind(zs),DW=zs.btoa.bind(zs);function R3(n,e){var t=n[0],s=n[1],r=n[2],a=n[3];t=iu(t,s,r,a,e[0],7,-680876936),a=iu(a,t,s,r,e[1],12,-389564586),r=iu(r,a,t,s,e[2],17,606105819),s=iu(s,r,a,t,e[3],22,-1044525330),t=iu(t,s,r,a,e[4],7,-176418897),a=iu(a,t,s,r,e[5],12,1200080426),r=iu(r,a,t,s,e[6],17,-1473231341),s=iu(s,r,a,t,e[7],22,-45705983),t=iu(t,s,r,a,e[8],7,1770035416),a=iu(a,t,s,r,e[9],12,-1958414417),r=iu(r,a,t,s,e[10],17,-42063),s=iu(s,r,a,t,e[11],22,-1990404162),t=iu(t,s,r,a,e[12],7,1804603682),a=iu(a,t,s,r,e[13],12,-40341101),r=iu(r,a,t,s,e[14],17,-1502002290),t=au(t,s=iu(s,r,a,t,e[15],22,1236535329),r,a,e[1],5,-165796510),a=au(a,t,s,r,e[6],9,-1069501632),r=au(r,a,t,s,e[11],14,643717713),s=au(s,r,a,t,e[0],20,-373897302),t=au(t,s,r,a,e[5],5,-701558691),a=au(a,t,s,r,e[10],9,38016083),r=au(r,a,t,s,e[15],14,-660478335),s=au(s,r,a,t,e[4],20,-405537848),t=au(t,s,r,a,e[9],5,568446438),a=au(a,t,s,r,e[14],9,-1019803690),r=au(r,a,t,s,e[3],14,-187363961),s=au(s,r,a,t,e[8],20,1163531501),t=au(t,s,r,a,e[13],5,-1444681467),a=au(a,t,s,r,e[2],9,-51403784),r=au(r,a,t,s,e[7],14,1735328473),t=ou(t,s=au(s,r,a,t,e[12],20,-1926607734),r,a,e[5],4,-378558),a=ou(a,t,s,r,e[8],11,-2022574463),r=ou(r,a,t,s,e[11],16,1839030562),s=ou(s,r,a,t,e[14],23,-35309556),t=ou(t,s,r,a,e[1],4,-1530992060),a=ou(a,t,s,r,e[4],11,1272893353),r=ou(r,a,t,s,e[7],16,-155497632),s=ou(s,r,a,t,e[10],23,-1094730640),t=ou(t,s,r,a,e[13],4,681279174),a=ou(a,t,s,r,e[0],11,-358537222),r=ou(r,a,t,s,e[3],16,-722521979),s=ou(s,r,a,t,e[6],23,76029189),t=ou(t,s,r,a,e[9],4,-640364487),a=ou(a,t,s,r,e[12],11,-421815835),r=ou(r,a,t,s,e[15],16,530742520),t=lu(t,s=ou(s,r,a,t,e[2],23,-995338651),r,a,e[0],6,-198630844),a=lu(a,t,s,r,e[7],10,1126891415),r=lu(r,a,t,s,e[14],15,-1416354905),s=lu(s,r,a,t,e[5],21,-57434055),t=lu(t,s,r,a,e[12],6,1700485571),a=lu(a,t,s,r,e[3],10,-1894986606),r=lu(r,a,t,s,e[10],15,-1051523),s=lu(s,r,a,t,e[1],21,-2054922799),t=lu(t,s,r,a,e[8],6,1873313359),a=lu(a,t,s,r,e[15],10,-30611744),r=lu(r,a,t,s,e[6],15,-1560198380),s=lu(s,r,a,t,e[13],21,1309151649),t=lu(t,s,r,a,e[4],6,-145523070),a=lu(a,t,s,r,e[11],10,-1120210379),r=lu(r,a,t,s,e[2],15,718787259),s=lu(s,r,a,t,e[9],21,-343485551),n[0]=G0(t,n[0]),n[1]=G0(s,n[1]),n[2]=G0(r,n[2]),n[3]=G0(a,n[3])}function A4(n,e,t,s,r,a){return e=G0(G0(e,n),G0(s,a)),G0(e<<r|e>>>32-r,t)}function iu(n,e,t,s,r,a,o){return A4(e&t|~e&s,n,e,r,a,o)}function au(n,e,t,s,r,a,o){return A4(e&s|t&~s,n,e,r,a,o)}function ou(n,e,t,s,r,a,o){return A4(e^t^s,n,e,r,a,o)}function lu(n,e,t,s,r,a,o){return A4(t^(e|~s),n,e,r,a,o)}function Fne(n){var e,t=n.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)R3(s,Jve(n.substring(e-64,e)));n=n.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)r[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(R3(s,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,R3(s,r),s}function Jve(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var OW="0123456789abcdef".split("");function Zve(n){for(var e="",t=0;t<4;t++)e+=OW[n>>8*t+4&15]+OW[n>>8*t&15];return e}function e2e(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function nR(n){return Fne(n).map(e2e).join("")}var t2e=(function(n){for(var e=0;e<n.length;e++)n[e]=Zve(n[e]);return n.join("")})(Fne("hello"))!="5d41402abc4b2a76b9719d911017c592";function G0(n,e){if(t2e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}function sR(n,e){var t,s,r,a;if(n!==t){for(var o=(r=n,a=1+(256/n.length|0),new Array(a+1).join(r)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+o.charCodeAt(c))%256,l[c]=l[u],l[u]=f}t=n,s=l}else l=s;var d=e.length,h=0,p=0,g="";for(c=0;c<d;c++)p=(p+(f=l[h=(h+1)%256]))%256,l[h]=l[p],l[p]=f,o=l[(l[h]+l[p])%256],g+=String.fromCharCode(e.charCodeAt(c)^o);return g}var PW={print:4,modify:8,copy:16,"annot-forms":32};function Mv(n,e,t,s){this.v=1,this.r=2;var r=192;n.forEach(function(l){if(PW.perm!==void 0)throw new Error("Invalid permission: "+l);r+=PW[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^r)),this.encryptionKey=nR(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=sR(this.encryptionKey,this.padding)}function Tv(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,s=0;s<t;s++){var r=n.charCodeAt(s);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):n[s]}return e}function $W(n){if(Wi(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,s,r){if(r=r||!1,typeof t!="string"||typeof s!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var a=Math.random().toString(35);return e[t][a]=[s,!!r],a},this.unsubscribe=function(t){for(var s in e)if(e[s][t])return delete e[s][t],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var s=Array.prototype.slice.call(arguments,1),r=[];for(var a in e[t]){var o=e[t][a];try{o[0].apply(n,s)}catch(l){zs.console&&ha.error("jsPDF PubSub Error",l.message,l)}o[1]&&r.push(a)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function oN(n){if(!(this instanceof oN))return new oN(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function zne(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function $y(n,e,t,s,r){if(!(this instanceof $y))return new $y(n,e,t,s,r);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,zne.call(this,s,r)}function Pv(n,e,t,s,r){if(!(this instanceof Pv))return new Pv(n,e,t,s,r);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,zne.call(this,s,r)}function bs(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],r=arguments[2],a=arguments[3],o=[],l=1,c=16,u="S",f=null;Wi(n=n||{})==="object"&&(t=n.orientation,s=n.unit||s,r=n.format||r,a=n.compress||n.compressPdf||a,(f=n.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(c=n.floatPrecision),u=n.defaultPathOperation||"S"),o=n.filters||(a===!0?["FlateEncode"]:o),s=s||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=$W;var g="1.3",b=p.__private__.getPdfVersion=function(){return g};p.__private__.setPdfVersion=function(Y){g=Y};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return v};var w=p.__private__.getPageFormat=function(Y){return v[Y]};r=r||"a4";var x="compat",S="advanced",C=x;function M(){this.saveGraphicsState(),de(new Fn(Qt,0,0,-Qt,0,Kc()*Qt).toString()+" cm"),this.setFontSize(this.getFontSize()/Qt),u="n",C=S}function k(){this.restoreGraphicsState(),u="S",C=x}var E=p.__private__.combineFontStyleAndFontWeight=function(Y,me){if(Y=="bold"&&me=="normal"||Y=="bold"&&me==400||Y=="normal"&&me=="italic"||Y=="bold"&&me=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return me&&(Y=me==400||me==="normal"?Y==="italic"?"italic":"normal":me!=700&&me!=="bold"||Y!=="normal"?(me==700?"bold":me)+""+Y:"bold"),Y};p.advancedAPI=function(Y){var me=C===x;return me&&M.call(this),typeof Y!="function"||(Y(this),me&&k.call(this)),this},p.compatAPI=function(Y){var me=C===S;return me&&k.call(this),typeof Y!="function"||(Y(this),me&&M.call(this)),this},p.isAdvancedAPI=function(){return C===S};var I,A=function(Y){if(C!==S)throw new Error(Y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},D=p.roundToPrecision=p.__private__.roundToPrecision=function(Y,me){var Fe=e||me;if(isNaN(Y)||isNaN(Fe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return Y.toFixed(Fe).replace(/0+$/,"")};I=p.hpf=p.__private__.hpf=typeof c=="number"?function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.hpf");return D(Y,c)}:c==="smart"?function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.hpf");return D(Y,Y>-1&&Y<1?16:5)}:function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.hpf");return D(Y,16)};var L=p.f2=p.__private__.f2=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.f2");return D(Y,2)},P=p.__private__.f3=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.f3");return D(Y,3)},j=p.scale=p.__private__.scale=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.scale");return C===x?Y*Qt:C===S?Y:void 0},G=function(Y){return j((function(me){return C===x?Kc()-me:C===S?me:void 0})(Y))};p.__private__.setPrecision=p.setPrecision=function(Y){typeof parseInt(Y,10)=="number"&&(e=parseInt(Y,10))};var Q,q="00000000000000000000000000000000",te=p.__private__.getFileId=function(){return q},Z=p.__private__.setFileId=function(Y){return q=Y!==void 0&&/^[a-fA-F0-9]{32}$/.test(Y)?Y.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(xi=new Mv(f.userPermissions,f.userPassword,f.ownerPassword,q)),q};p.setFileId=function(Y){return Z(Y),this},p.getFileId=function(){return te()};var ne=p.__private__.convertDateToPDFDate=function(Y){var me=Y.getTimezoneOffset(),Fe=me<0?"+":"-",Je=Math.floor(Math.abs(me/60)),pt=Math.abs(me%60),Ht=[Fe,W(Je),"'",W(pt),"'"].join("");return["D:",Y.getFullYear(),W(Y.getMonth()+1),W(Y.getDate()),W(Y.getHours()),W(Y.getMinutes()),W(Y.getSeconds()),Ht].join("")},le=p.__private__.convertPDFDateToDate=function(Y){var me=parseInt(Y.substr(2,4),10),Fe=parseInt(Y.substr(6,2),10)-1,Je=parseInt(Y.substr(8,2),10),pt=parseInt(Y.substr(10,2),10),Ht=parseInt(Y.substr(12,2),10),nn=parseInt(Y.substr(14,2),10);return new Date(me,Fe,Je,pt,Ht,nn,0)},H=p.__private__.setCreationDate=function(Y){var me;if(Y===void 0&&(Y=new Date),Y instanceof Date)me=ne(Y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(Y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");me=Y}return Q=me},R=p.__private__.getCreationDate=function(Y){var me=Q;return Y==="jsDate"&&(me=le(Q)),me};p.setCreationDate=function(Y){return H(Y),this},p.getCreationDate=function(Y){return R(Y)};var B,W=p.__private__.padd2=function(Y){return("0"+parseInt(Y)).slice(-2)},se=p.__private__.padd2Hex=function(Y){return("00"+(Y=Y.toString())).substr(Y.length)},ue=0,ge=[],Ce=[],Se=0,Me=[],pe=[],fe=!1,$e=Ce;p.__private__.setCustomOutputDestination=function(Y){fe=!0,$e=Y};var We=function(Y){fe||($e=Y)};p.__private__.resetCustomOutputDestination=function(){fe=!1,$e=Ce};var de=p.__private__.out=function(Y){return Y=Y.toString(),Se+=Y.length+1,$e.push(Y),$e},Be=p.__private__.write=function(Y){return de(arguments.length===1?Y.toString():Array.prototype.join.call(arguments," "))},st=p.__private__.getArrayBuffer=function(Y){for(var me=Y.length,Fe=new ArrayBuffer(me),Je=new Uint8Array(Fe);me--;)Je[me]=Y.charCodeAt(me);return Fe},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return He};var Xe=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(Y){return Xe=C===S?Y/Qt:Y,this};var Ke,Ze=p.__private__.getFontSize=p.getFontSize=function(){return C===x?Xe:Xe*Qt},xt=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(Y){return xt=Y,this},p.__private__.getR2L=p.getR2L=function(){return xt};var dt,Ft=p.__private__.setZoomMode=function(Y){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(Y))Ke=Y;else if(isNaN(Y)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(Y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+Y+'" is not recognized.');Ke=Y}else Ke=parseInt(Y,10)};p.__private__.getZoomMode=function(){return Ke};var It,Bt=p.__private__.setPageMode=function(Y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(Y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+Y+'" is not recognized.');dt=Y};p.__private__.getPageMode=function(){return dt};var Gt=p.__private__.setLayoutMode=function(Y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(Y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+Y+'" is not recognized.');It=Y};p.__private__.getLayoutMode=function(){return It},p.__private__.setDisplayMode=p.setDisplayMode=function(Y,me,Fe){return Ft(Y),Gt(me),Bt(Fe),this};var At={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(Y){if(Object.keys(At).indexOf(Y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return At[Y]},p.__private__.getDocumentProperties=function(){return At},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(Y){for(var me in At)At.hasOwnProperty(me)&&Y[me]&&(At[me]=Y[me]);return this},p.__private__.setDocumentProperty=function(Y,me){if(Object.keys(At).indexOf(Y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return At[Y]=me};var ht,Qt,Xt,us,yn,En={},Vn={},Nn=[],Dn={},gr={},os={},ps={},Ss=null,Qn=0,On=[],Mt=new $W(p),sn=n.hotfixes||[],Tn={},ai={},ir=[],Fn=function Y(me,Fe,Je,pt,Ht,nn){if(!(this instanceof Y))return new Y(me,Fe,Je,pt,Ht,nn);isNaN(me)&&(me=1),isNaN(Fe)&&(Fe=0),isNaN(Je)&&(Je=0),isNaN(pt)&&(pt=1),isNaN(Ht)&&(Ht=0),isNaN(nn)&&(nn=0),this._matrix=[me,Fe,Je,pt,Ht,nn]};Object.defineProperty(Fn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(Y){this._matrix[0]=Y}}),Object.defineProperty(Fn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(Y){this._matrix[1]=Y}}),Object.defineProperty(Fn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(Y){this._matrix[2]=Y}}),Object.defineProperty(Fn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(Y){this._matrix[3]=Y}}),Object.defineProperty(Fn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(Y){this._matrix[4]=Y}}),Object.defineProperty(Fn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(Y){this._matrix[5]=Y}}),Object.defineProperty(Fn.prototype,"a",{get:function(){return this._matrix[0]},set:function(Y){this._matrix[0]=Y}}),Object.defineProperty(Fn.prototype,"b",{get:function(){return this._matrix[1]},set:function(Y){this._matrix[1]=Y}}),Object.defineProperty(Fn.prototype,"c",{get:function(){return this._matrix[2]},set:function(Y){this._matrix[2]=Y}}),Object.defineProperty(Fn.prototype,"d",{get:function(){return this._matrix[3]},set:function(Y){this._matrix[3]=Y}}),Object.defineProperty(Fn.prototype,"e",{get:function(){return this._matrix[4]},set:function(Y){this._matrix[4]=Y}}),Object.defineProperty(Fn.prototype,"f",{get:function(){return this._matrix[5]},set:function(Y){this._matrix[5]=Y}}),Object.defineProperty(Fn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Fn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Fn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Fn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Fn.prototype.join=function(Y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(Y)},Fn.prototype.multiply=function(Y){var me=Y.sx*this.sx+Y.shy*this.shx,Fe=Y.sx*this.shy+Y.shy*this.sy,Je=Y.shx*this.sx+Y.sy*this.shx,pt=Y.shx*this.shy+Y.sy*this.sy,Ht=Y.tx*this.sx+Y.ty*this.shx+this.tx,nn=Y.tx*this.shy+Y.ty*this.sy+this.ty;return new Fn(me,Fe,Je,pt,Ht,nn)},Fn.prototype.decompose=function(){var Y=this.sx,me=this.shy,Fe=this.shx,Je=this.sy,pt=this.tx,Ht=this.ty,nn=Math.sqrt(Y*Y+me*me),zn=(Y/=nn)*Fe+(me/=nn)*Je;Fe-=Y*zn,Je-=me*zn;var qn=Math.sqrt(Fe*Fe+Je*Je);return zn/=qn,Y*(Je/=qn)<me*(Fe/=qn)&&(Y=-Y,me=-me,zn=-zn,nn=-nn),{scale:new Fn(nn,0,0,qn,0,0),translate:new Fn(1,0,0,1,pt,Ht),rotate:new Fn(Y,me,-me,Y,0,0),skew:new Fn(1,0,zn,1,0,0)}},Fn.prototype.toString=function(Y){return this.join(" ")},Fn.prototype.inversed=function(){var Y=this.sx,me=this.shy,Fe=this.shx,Je=this.sy,pt=this.tx,Ht=this.ty,nn=1/(Y*Je-me*Fe),zn=Je*nn,qn=-me*nn,xs=-Fe*nn,ks=Y*nn;return new Fn(zn,qn,xs,ks,-zn*pt-xs*Ht,-qn*pt-ks*Ht)},Fn.prototype.applyToPoint=function(Y){var me=Y.x*this.sx+Y.y*this.shx+this.tx,Fe=Y.x*this.shy+Y.y*this.sy+this.ty;return new Oi(me,Fe)},Fn.prototype.applyToRectangle=function(Y){var me=this.applyToPoint(Y),Fe=this.applyToPoint(new Oi(Y.x+Y.w,Y.y+Y.h));return new il(me.x,me.y,Fe.x-me.x,Fe.y-me.y)},Fn.prototype.clone=function(){var Y=this.sx,me=this.shy,Fe=this.shx,Je=this.sy,pt=this.tx,Ht=this.ty;return new Fn(Y,me,Fe,Je,pt,Ht)},p.Matrix=Fn;var fs=p.matrixMult=function(Y,me){return me.multiply(Y)},ro=new Fn(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=ro;var re=function(Y,me){if(!gr[Y]){var Fe=(me instanceof $y?"Sh":"P")+(Object.keys(Dn).length+1).toString(10);me.id=Fe,gr[Y]=Fe,Dn[Fe]=me,Mt.publish("addPattern",me)}};p.ShadingPattern=$y,p.TilingPattern=Pv,p.addShadingPattern=function(Y,me){return A("addShadingPattern()"),re(Y,me),this},p.beginTilingPattern=function(Y){A("beginTilingPattern()"),Tu(Y.boundingBox[0],Y.boundingBox[1],Y.boundingBox[2]-Y.boundingBox[0],Y.boundingBox[3]-Y.boundingBox[1],Y.matrix)},p.endTilingPattern=function(Y,me){A("endTilingPattern()"),me.stream=pe[B].join(`
`),re(Y,me),Mt.publish("endTilingPattern",me),ir.pop().restore()};var Pe,ve=p.__private__.newObject=function(){var Y=Oe();return ze(Y,!0),Y},Oe=p.__private__.newObjectDeferred=function(){return ue++,ge[ue]=function(){return Se},ue},ze=function(Y,me){return me=typeof me=="boolean"&&me,ge[Y]=Se,me&&de(Y+" 0 obj"),Y},ut=p.__private__.newAdditionalObject=function(){var Y={objId:Oe(),content:""};return Me.push(Y),Y},Et=Oe(),rn=Oe(),xn=p.__private__.decodeColorString=function(Y){var me=Y.split(" ");if(me.length!==2||me[1]!=="g"&&me[1]!=="G")me.length!==5||me[4]!=="k"&&me[4]!=="K"||(me=[(1-me[0])*(1-me[3]),(1-me[1])*(1-me[3]),(1-me[2])*(1-me[3]),"r"]);else{var Fe=parseFloat(me[0]);me=[Fe,Fe,Fe,"r"]}for(var Je="#",pt=0;pt<3;pt++)Je+=("0"+Math.floor(255*parseFloat(me[pt])).toString(16)).slice(-2);return Je},un=p.__private__.encodeColorString=function(Y){var me;typeof Y=="string"&&(Y={ch1:Y});var Fe=Y.ch1,Je=Y.ch2,pt=Y.ch3,Ht=Y.ch4,nn=Y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Fe=="string"&&Fe.charAt(0)!=="#"){var zn=new Rne(Fe);if(zn.ok)Fe=zn.toHex();else if(!/^\d*\.?\d*$/.test(Fe))throw new Error('Invalid color "'+Fe+'" passed to jsPDF.encodeColorString.')}if(typeof Fe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Fe)&&(Fe="#"+Fe[1]+Fe[1]+Fe[2]+Fe[2]+Fe[3]+Fe[3]),typeof Fe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Fe)){var qn=parseInt(Fe.substr(1),16);Fe=qn>>16&255,Je=qn>>8&255,pt=255&qn}if(Je===void 0||Ht===void 0&&Fe===Je&&Je===pt)me=typeof Fe=="string"?Fe+" "+nn[0]:Y.precision===2?L(Fe/255)+" "+nn[0]:P(Fe/255)+" "+nn[0];else if(Ht===void 0||Wi(Ht)==="object"){if(Ht&&!isNaN(Ht.a)&&Ht.a===0)return["1.","1.","1.",nn[1]].join(" ");me=typeof Fe=="string"?[Fe,Je,pt,nn[1]].join(" "):Y.precision===2?[L(Fe/255),L(Je/255),L(pt/255),nn[1]].join(" "):[P(Fe/255),P(Je/255),P(pt/255),nn[1]].join(" ")}else me=typeof Fe=="string"?[Fe,Je,pt,Ht,nn[2]].join(" "):Y.precision===2?[L(Fe),L(Je),L(pt),L(Ht),nn[2]].join(" "):[P(Fe),P(Je),P(pt),P(Ht),nn[2]].join(" ");return me},Gn=p.__private__.getFilters=function(){return o},hn=p.__private__.putStream=function(Y){var me=(Y=Y||{}).data||"",Fe=Y.filters||Gn(),Je=Y.alreadyAppliedFilters||[],pt=Y.addLength1||!1,Ht=me.length,nn=Y.objectId,zn=function(Ea){return Ea};if(f!==null&&nn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(zn=xi.encryptor(nn,0));var qn={};Fe===!0&&(Fe=["FlateEncode"]);var xs=Y.additionalKeyValues||[],ks=(qn=bs.API.processDataByFilters!==void 0?bs.API.processDataByFilters(me,Fe):{data:me,reverseChain:[]}).reverseChain+(Array.isArray(Je)?Je.join(" "):Je.toString());if(qn.data.length!==0&&(xs.push({key:"Length",value:qn.data.length}),pt===!0&&xs.push({key:"Length1",value:Ht})),ks.length!=0)if(ks.split("/").length-1==1)xs.push({key:"Filter",value:ks});else{xs.push({key:"Filter",value:"["+ks+"]"});for(var pr=0;pr<xs.length;pr+=1)if(xs[pr].key==="DecodeParms"){for(var gi=[],Ki=0;Ki<qn.reverseChain.split("/").length-1;Ki+=1)gi.push("null");gi.push(xs[pr].value),xs[pr].value="["+gi.join(" ")+"]"}}de("<<");for(var Jr=0;Jr<xs.length;Jr++)de("/"+xs[Jr].key+" "+xs[Jr].value);de(">>"),qn.data.length!==0&&(de("stream"),de(zn(qn.data)),de("endstream"))},vs=p.__private__.putPage=function(Y){var me=Y.number,Fe=Y.data,Je=Y.objId,pt=Y.contentsObjId;ze(Je,!0),de("<</Type /Page"),de("/Parent "+Y.rootDictionaryObjId+" 0 R"),de("/Resources "+Y.resourceDictionaryObjId+" 0 R"),de("/MediaBox ["+parseFloat(I(Y.mediaBox.bottomLeftX))+" "+parseFloat(I(Y.mediaBox.bottomLeftY))+" "+I(Y.mediaBox.topRightX)+" "+I(Y.mediaBox.topRightY)+"]"),Y.cropBox!==null&&de("/CropBox ["+I(Y.cropBox.bottomLeftX)+" "+I(Y.cropBox.bottomLeftY)+" "+I(Y.cropBox.topRightX)+" "+I(Y.cropBox.topRightY)+"]"),Y.bleedBox!==null&&de("/BleedBox ["+I(Y.bleedBox.bottomLeftX)+" "+I(Y.bleedBox.bottomLeftY)+" "+I(Y.bleedBox.topRightX)+" "+I(Y.bleedBox.topRightY)+"]"),Y.trimBox!==null&&de("/TrimBox ["+I(Y.trimBox.bottomLeftX)+" "+I(Y.trimBox.bottomLeftY)+" "+I(Y.trimBox.topRightX)+" "+I(Y.trimBox.topRightY)+"]"),Y.artBox!==null&&de("/ArtBox ["+I(Y.artBox.bottomLeftX)+" "+I(Y.artBox.bottomLeftY)+" "+I(Y.artBox.topRightX)+" "+I(Y.artBox.topRightY)+"]"),typeof Y.userUnit=="number"&&Y.userUnit!==1&&de("/UserUnit "+Y.userUnit),Mt.publish("putPage",{objId:Je,pageContext:On[me],pageNumber:me,page:Fe}),de("/Contents "+pt+" 0 R"),de(">>"),de("endobj");var Ht=Fe.join(`
`);return C===S&&(Ht+=`
Q`),ze(pt,!0),hn({data:Ht,filters:Gn(),objectId:pt}),de("endobj"),Je},_s=p.__private__.putPages=function(){var Y,me,Fe=[];for(Y=1;Y<=Qn;Y++)On[Y].objId=Oe(),On[Y].contentsObjId=Oe();for(Y=1;Y<=Qn;Y++)Fe.push(vs({number:Y,data:pe[Y],objId:On[Y].objId,contentsObjId:On[Y].contentsObjId,mediaBox:On[Y].mediaBox,cropBox:On[Y].cropBox,bleedBox:On[Y].bleedBox,trimBox:On[Y].trimBox,artBox:On[Y].artBox,userUnit:On[Y].userUnit,rootDictionaryObjId:Et,resourceDictionaryObjId:rn}));ze(Et,!0),de("<</Type /Pages");var Je="/Kids [";for(me=0;me<Qn;me++)Je+=Fe[me]+" 0 R ";de(Je+"]"),de("/Count "+Qn),de(">>"),de("endobj"),Mt.publish("postPutPages")},Vr=function(Y){Mt.publish("putFont",{font:Y,out:de,newObject:ve,putStream:hn}),Y.isAlreadyPutted!==!0&&(Y.objectNumber=ve(),de("<<"),de("/Type /Font"),de("/BaseFont /"+Tv(Y.postScriptName)),de("/Subtype /Type1"),typeof Y.encoding=="string"&&de("/Encoding /"+Y.encoding),de("/FirstChar 32"),de("/LastChar 255"),de(">>"),de("endobj"))},Yr=function(Y){Y.objectNumber=ve();var me=[];me.push({key:"Type",value:"/XObject"}),me.push({key:"Subtype",value:"/Form"}),me.push({key:"BBox",value:"["+[I(Y.x),I(Y.y),I(Y.x+Y.width),I(Y.y+Y.height)].join(" ")+"]"}),me.push({key:"Matrix",value:"["+Y.matrix.toString()+"]"});var Fe=Y.pages[1].join(`
`);hn({data:Fe,additionalKeyValues:me,objectId:Y.objectNumber}),de("endobj")},Cr=function(Y,me){me||(me=21);var Fe=ve(),Je=(function(nn,zn){var qn,xs=[],ks=1/(zn-1);for(qn=0;qn<1;qn+=ks)xs.push(qn);if(xs.push(1),nn[0].offset!=0){var pr={offset:0,color:nn[0].color};nn.unshift(pr)}if(nn[nn.length-1].offset!=1){var gi={offset:1,color:nn[nn.length-1].color};nn.push(gi)}for(var Ki="",Jr=0,Ea=0;Ea<xs.length;Ea++){for(qn=xs[Ea];qn>nn[Jr+1].offset;)Jr++;var zi=nn[Jr].offset,_a=(qn-zi)/(nn[Jr+1].offset-zi),vc=nn[Jr].color,ol=nn[Jr+1].color;Ki+=se(Math.round((1-_a)*vc[0]+_a*ol[0]).toString(16))+se(Math.round((1-_a)*vc[1]+_a*ol[1]).toString(16))+se(Math.round((1-_a)*vc[2]+_a*ol[2]).toString(16))}return Ki.trim()})(Y.colors,me),pt=[];pt.push({key:"FunctionType",value:"0"}),pt.push({key:"Domain",value:"[0.0 1.0]"}),pt.push({key:"Size",value:"["+me+"]"}),pt.push({key:"BitsPerSample",value:"8"}),pt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),pt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),hn({data:Je,additionalKeyValues:pt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Fe}),de("endobj"),Y.objectNumber=ve(),de("<< /ShadingType "+Y.type),de("/ColorSpace /DeviceRGB");var Ht="/Coords ["+I(parseFloat(Y.coords[0]))+" "+I(parseFloat(Y.coords[1]))+" ";Y.type===2?Ht+=I(parseFloat(Y.coords[2]))+" "+I(parseFloat(Y.coords[3])):Ht+=I(parseFloat(Y.coords[2]))+" "+I(parseFloat(Y.coords[3]))+" "+I(parseFloat(Y.coords[4]))+" "+I(parseFloat(Y.coords[5])),de(Ht+="]"),Y.matrix&&de("/Matrix ["+Y.matrix.toString()+"]"),de("/Function "+Fe+" 0 R"),de("/Extend [true true]"),de(">>"),de("endobj")},Kr=function(Y,me){var Fe=Oe(),Je=ve();me.push({resourcesOid:Fe,objectOid:Je}),Y.objectNumber=Je;var pt=[];pt.push({key:"Type",value:"/Pattern"}),pt.push({key:"PatternType",value:"1"}),pt.push({key:"PaintType",value:"1"}),pt.push({key:"TilingType",value:"1"}),pt.push({key:"BBox",value:"["+Y.boundingBox.map(I).join(" ")+"]"}),pt.push({key:"XStep",value:I(Y.xStep)}),pt.push({key:"YStep",value:I(Y.yStep)}),pt.push({key:"Resources",value:Fe+" 0 R"}),Y.matrix&&pt.push({key:"Matrix",value:"["+Y.matrix.toString()+"]"}),hn({data:Y.stream,additionalKeyValues:pt,objectId:Y.objectNumber}),de("endobj")},sl=function(Y){for(var me in Y.objectNumber=ve(),de("<<"),Y)switch(me){case"opacity":de("/ca "+L(Y[me]));break;case"stroke-opacity":de("/CA "+L(Y[me]))}de(">>"),de("endobj")},Ni=function(Y){ze(Y.resourcesOid,!0),de("<<"),de("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var me in de("/Font <<"),En)En.hasOwnProperty(me)&&(d===!1||d===!0&&h.hasOwnProperty(me))&&de("/"+me+" "+En[me].objectNumber+" 0 R");de(">>")})(),(function(){if(Object.keys(Dn).length>0){for(var me in de("/Shading <<"),Dn)Dn.hasOwnProperty(me)&&Dn[me]instanceof $y&&Dn[me].objectNumber>=0&&de("/"+me+" "+Dn[me].objectNumber+" 0 R");Mt.publish("putShadingPatternDict"),de(">>")}})(),(function(me){if(Object.keys(Dn).length>0){for(var Fe in de("/Pattern <<"),Dn)Dn.hasOwnProperty(Fe)&&Dn[Fe]instanceof p.TilingPattern&&Dn[Fe].objectNumber>=0&&Dn[Fe].objectNumber<me&&de("/"+Fe+" "+Dn[Fe].objectNumber+" 0 R");Mt.publish("putTilingPatternDict"),de(">>")}})(Y.objectOid),(function(){if(Object.keys(os).length>0){var me;for(me in de("/ExtGState <<"),os)os.hasOwnProperty(me)&&os[me].objectNumber>=0&&de("/"+me+" "+os[me].objectNumber+" 0 R");Mt.publish("putGStateDict"),de(">>")}})(),(function(){for(var me in de("/XObject <<"),Tn)Tn.hasOwnProperty(me)&&Tn[me].objectNumber>=0&&de("/"+me+" "+Tn[me].objectNumber+" 0 R");Mt.publish("putXobjectDict"),de(">>")})(),de(">>"),de("endobj")},Xr=function(Y){Vn[Y.fontName]=Vn[Y.fontName]||{},Vn[Y.fontName][Y.fontStyle]=Y.id},ka=function(Y,me,Fe,Je,pt){var Ht={id:"F"+(Object.keys(En).length+1).toString(10),postScriptName:Y,fontName:me,fontStyle:Fe,encoding:Je,isStandardFont:pt||!1,metadata:{}};return Mt.publish("addFont",{font:Ht,instance:this}),En[Ht.id]=Ht,Xr(Ht),Ht.id},oi=p.__private__.pdfEscape=p.pdfEscape=function(Y,me){return(function(Fe,Je){var pt,Ht,nn,zn,qn,xs,ks,pr,gi;if(nn=(Je=Je||{}).sourceEncoding||"Unicode",qn=Je.outputEncoding,(Je.autoencode||qn)&&En[ht].metadata&&En[ht].metadata[nn]&&En[ht].metadata[nn].encoding&&(zn=En[ht].metadata[nn].encoding,!qn&&En[ht].encoding&&(qn=En[ht].encoding),!qn&&zn.codePages&&(qn=zn.codePages[0]),typeof qn=="string"&&(qn=zn[qn]),qn)){for(ks=!1,xs=[],pt=0,Ht=Fe.length;pt<Ht;pt++)(pr=qn[Fe.charCodeAt(pt)])?xs.push(String.fromCharCode(pr)):xs.push(Fe[pt]),xs[pt].charCodeAt(0)>>8&&(ks=!0);Fe=xs.join("")}for(pt=Fe.length;ks===void 0&&pt!==0;)Fe.charCodeAt(pt-1)>>8&&(ks=!0),pt--;if(!ks)return Fe;for(xs=Je.noBOM?[]:[254,255],pt=0,Ht=Fe.length;pt<Ht;pt++){if((gi=(pr=Fe.charCodeAt(pt))>>8)>>8)throw new Error("Character at position "+pt+" of string '"+Fe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");xs.push(gi),xs.push(pr-(gi<<8))}return String.fromCharCode.apply(void 0,xs)})(Y,me).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wa=p.__private__.beginPage=function(Y){pe[++Qn]=[],On[Qn]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(Y[0]),topRightY:Number(Y[1])}},yo(Qn),We(pe[B])},li=function(Y,me){var Fe,Je,pt;switch(t=me||t,typeof Y=="string"&&(Fe=w(Y.toLowerCase()),Array.isArray(Fe)&&(Je=Fe[0],pt=Fe[1])),Array.isArray(Y)&&(Je=Y[0]*Qt,pt=Y[1]*Qt),isNaN(Je)&&(Je=r[0],pt=r[1]),(Je>14400||pt>14400)&&(ha.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Je=Math.min(14400,Je),pt=Math.min(14400,pt)),r=[Je,pt],t.substr(0,1)){case"l":pt>Je&&(r=[pt,Je]);break;case"p":Je>pt&&(r=[pt,Je])}wa(r),An(Ci),de(Wr),Gr!==0&&de(Gr+" J"),Qs!==0&&de(Qs+" j"),Mt.publish("addPage",{pageNumber:Qn})},pi=function(Y){Y>0&&Y<=Qn&&(pe.splice(Y,1),On.splice(Y,1),Qn--,B>Qn&&(B=Qn),this.setPage(B))},yo=function(Y){Y>0&&Y<=Qn&&(B=Y)},rl=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return pe.length-1},Gc=function(Y,me,Fe){var Je,pt=void 0;return Fe=Fe||{},Y=Y!==void 0?Y:En[ht].fontName,me=me!==void 0?me:En[ht].fontStyle,Je=Y.toLowerCase(),Vn[Je]!==void 0&&Vn[Je][me]!==void 0?pt=Vn[Je][me]:Vn[Y]!==void 0&&Vn[Y][me]!==void 0?pt=Vn[Y][me]:Fe.disableWarning===!1&&ha.warn("Unable to look up font label for font '"+Y+"', '"+me+"'. Refer to getFontList() for available fonts."),pt||Fe.noFallback||(pt=Vn.times[me])==null&&(pt=Vn.times.normal),pt},va=p.__private__.putInfo=function(){var Y=ve(),me=function(Je){return Je};for(var Fe in f!==null&&(me=xi.encryptor(Y,0)),de("<<"),de("/Producer ("+oi(me("jsPDF "+bs.version))+")"),At)At.hasOwnProperty(Fe)&&At[Fe]&&de("/"+Fe.substr(0,1).toUpperCase()+Fe.substr(1)+" ("+oi(me(At[Fe]))+")");de("/CreationDate ("+oi(me(Q))+")"),de(">>"),de("endobj")},bo=p.__private__.putCatalog=function(Y){var me=(Y=Y||{}).rootDictionaryObjId||Et;switch(ve(),de("<<"),de("/Type /Catalog"),de("/Pages "+me+" 0 R"),Ke||(Ke="fullwidth"),Ke){case"fullwidth":de("/OpenAction [3 0 R /FitH null]");break;case"fullheight":de("/OpenAction [3 0 R /FitV null]");break;case"fullpage":de("/OpenAction [3 0 R /Fit]");break;case"original":de("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Fe=""+Ke;Fe.substr(Fe.length-1)==="%"&&(Ke=parseInt(Ke)/100),typeof Ke=="number"&&de("/OpenAction [3 0 R /XYZ null null "+L(Ke)+"]")}switch(It||(It="continuous"),It){case"continuous":de("/PageLayout /OneColumn");break;case"single":de("/PageLayout /SinglePage");break;case"two":case"twoleft":de("/PageLayout /TwoColumnLeft");break;case"tworight":de("/PageLayout /TwoColumnRight")}dt&&de("/PageMode /"+dt),Mt.publish("putCatalog"),de(">>"),de("endobj")},Wa=p.__private__.putTrailer=function(){de("trailer"),de("<<"),de("/Size "+(ue+1)),de("/Root "+ue+" 0 R"),de("/Info "+(ue-1)+" 0 R"),f!==null&&de("/Encrypt "+xi.oid+" 0 R"),de("/ID [ <"+q+"> <"+q+"> ]"),de(">>")},Us=p.__private__.putHeader=function(){de("%PDF-"+g),de("%")},Ga=p.__private__.putXRef=function(){var Y="0000000000";de("xref"),de("0 "+(ue+1)),de("0000000000 65535 f ");for(var me=1;me<=ue;me++)typeof ge[me]=="function"?de((Y+ge[me]()).slice(-10)+" 00000 n "):ge[me]!==void 0?de((Y+ge[me]).slice(-10)+" 00000 n "):de("0000000000 00000 n ")},Zt=p.__private__.buildDocument=function(){var Y;ue=0,Se=0,Ce=[],ge=[],Me=[],Et=Oe(),rn=Oe(),We(Ce),Mt.publish("buildDocument"),Us(),_s(),(function(){Mt.publish("putAdditionalObjects");for(var Fe=0;Fe<Me.length;Fe++){var Je=Me[Fe];ze(Je.objId,!0),de(Je.content),de("endobj")}Mt.publish("postPutAdditionalObjects")})(),Y=[],(function(){for(var Fe in En)En.hasOwnProperty(Fe)&&(d===!1||d===!0&&h.hasOwnProperty(Fe))&&Vr(En[Fe])})(),(function(){var Fe;for(Fe in os)os.hasOwnProperty(Fe)&&sl(os[Fe])})(),(function(){for(var Fe in Tn)Tn.hasOwnProperty(Fe)&&Yr(Tn[Fe])})(),(function(Fe){var Je;for(Je in Dn)Dn.hasOwnProperty(Je)&&(Dn[Je]instanceof $y?Cr(Dn[Je]):Dn[Je]instanceof Pv&&Kr(Dn[Je],Fe))})(Y),Mt.publish("putResources"),Y.forEach(Ni),Ni({resourcesOid:rn,objectOid:Number.MAX_SAFE_INTEGER}),Mt.publish("postPutResources"),f!==null&&(xi.oid=ve(),de("<<"),de("/Filter /Standard"),de("/V "+xi.v),de("/R "+xi.r),de("/U <"+xi.toHexString(xi.U)+">"),de("/O <"+xi.toHexString(xi.O)+">"),de("/P "+xi.P),de(">>"),de("endobj")),va(),bo();var me=Se;return Ga(),Wa(),de("startxref"),de(""+me),de("%%EOF"),We(pe[B]),Ce.join(`
`)},cn=p.__private__.getBlob=function(Y){return new Blob([st(Y)],{type:"application/pdf"})},In=p.output=p.__private__.output=(Pe=function(Y,me){switch(typeof(me=me||{})=="string"?me={filename:me}:me.filename=me.filename||"generated.pdf",Y){case void 0:return Zt();case"save":p.save(me.filename);break;case"arraybuffer":return st(Zt());case"blob":return cn(Zt());case"bloburi":case"bloburl":if(zs.URL!==void 0&&typeof zs.URL.createObjectURL=="function")return zs.URL&&zs.URL.createObjectURL(cn(Zt()))||void 0;ha.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Fe="",Je=Zt();try{Fe=DW(Je)}catch{Fe=DW(unescape(encodeURIComponent(Je)))}return"data:application/pdf;filename="+me.filename+";base64,"+Fe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zs)==="[object Window]"){var pt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ht=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';me.pdfObjectUrl&&(pt=me.pdfObjectUrl,Ht="");var nn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+pt+'"'+Ht+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(me)+");<\/script></body></html>",zn=zs.open();return zn!==null&&zn.document.write(nn),zn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zs)==="[object Window]"){var qn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(me.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+me.filename+'" width="500px" height="400px" /></body></html>',xs=zs.open();if(xs!==null){xs.document.write(qn);var ks=this;xs.document.documentElement.querySelector("#pdfViewer").onload=function(){xs.document.title=me.filename,xs.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ks.output("bloburl"))}}return xs}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zs)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var pr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",me)+'"></iframe></body></html>',gi=zs.open();if(gi!==null&&(gi.document.write(pr),gi.document.title=me.filename),gi||typeof safari>"u")return gi;break;case"datauri":case"dataurl":return zs.document.location.href=this.output("datauristring",me);default:return null}},Pe.foo=function(){try{return Pe.apply(this,arguments)}catch(Fe){var Y=Fe.stack||"";~Y.indexOf(" at ")&&(Y=Y.split(" at ")[1]);var me="Error in function "+Y.split(`
`)[0].split("<")[0]+": "+Fe.message;if(!zs.console)throw new Error(me);zs.console.error(me,Fe),zs.alert&&alert(me)}},Pe.foo.bar=Pe,Pe.foo),Rs=function(Y){return Array.isArray(sn)===!0&&sn.indexOf(Y)>-1};switch(s){case"pt":Qt=1;break;case"mm":Qt=72/25.4;break;case"cm":Qt=72/2.54;break;case"in":Qt=72;break;case"px":Qt=Rs("px_scaling")==1?.75:96/72;break;case"pc":case"em":Qt=12;break;case"ex":Qt=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);Qt=s}var xi=null;H(),Z();var ci=p.__private__.getPageInfo=p.getPageInfo=function(Y){if(isNaN(Y)||Y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:On[Y].objId,pageNumber:Y,pageContext:On[Y]}},Gl=p.__private__.getPageInfoByObjId=function(Y){if(isNaN(Y)||Y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var me in On)if(On[me].objId===Y)break;return ci(me)},Of=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:On[B].objId,pageNumber:B,pageContext:On[B]}};p.addPage=function(){return li.apply(this,arguments),this},p.setPage=function(){return yo.apply(this,arguments),We.call(this,pe[B]),this},p.insertPage=function(Y){return this.addPage(),this.movePage(B,Y),this},p.movePage=function(Y,me){var Fe,Je;if(Y>me){Fe=pe[Y],Je=On[Y];for(var pt=Y;pt>me;pt--)pe[pt]=pe[pt-1],On[pt]=On[pt-1];pe[me]=Fe,On[me]=Je,this.setPage(me)}else if(Y<me){Fe=pe[Y],Je=On[Y];for(var Ht=Y;Ht<me;Ht++)pe[Ht]=pe[Ht+1],On[Ht]=On[Ht+1];pe[me]=Fe,On[me]=Je,this.setPage(me)}return this},p.deletePage=function(){return pi.apply(this,arguments),this},p.__private__.text=p.text=function(Y,me,Fe,Je,pt){var Ht,nn,zn,qn,xs,ks,pr,gi,Ki,Jr=(Je=Je||{}).scope||this;if(typeof Y=="number"&&typeof me=="number"&&(typeof Fe=="string"||Array.isArray(Fe))){var Ea=Fe;Fe=me,me=Y,Y=Ea}if(arguments[3]instanceof Fn==0?(zn=arguments[4],qn=arguments[5],Wi(pr=arguments[3])==="object"&&pr!==null||(typeof zn=="string"&&(qn=zn,zn=null),typeof pr=="string"&&(qn=pr,pr=null),typeof pr=="number"&&(zn=pr,pr=null),Je={flags:pr,angle:zn,align:qn})):(A("The transform parameter of text() with a Matrix value"),Ki=pt),isNaN(me)||isNaN(Fe)||Y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(Y.length===0)return Jr;var zi,_a="",vc=typeof Je.lineHeightFactor=="number"?Je.lineHeightFactor:Ar,ol=Jr.internal.scaleFactor;function Xc(yr){return yr=yr.split("	").join(Array(Je.TabLen||9).join(" ")),oi(yr,pr)}function Dd(yr){for(var nr,F=yr.concat(),ee=[],he=F.length;he--;)typeof(nr=F.shift())=="string"?ee.push(nr):Array.isArray(yr)&&(nr.length===1||nr[1]===void 0&&nr[2]===void 0)?ee.push(nr[0]):ee.push([nr[0],nr[1],nr[2]]);return ee}function Pf(yr,nr){var F;if(typeof yr=="string")F=nr(yr)[0];else if(Array.isArray(yr)){for(var ee,he,be=yr.concat(),Le=[],rt=be.length;rt--;)typeof(ee=be.shift())=="string"?Le.push(nr(ee)[0]):Array.isArray(ee)&&typeof ee[0]=="string"&&(he=nr(ee[0],ee[1],ee[2]),Le.push([he[0],he[1],he[2]]));F=Le}return F}var _c=!1,Hl=!0;if(typeof Y=="string")_c=!0;else if(Array.isArray(Y)){var tf=Y.concat();nn=[];for(var xc,Xi=tf.length;Xi--;)(typeof(xc=tf.shift())!="string"||Array.isArray(xc)&&typeof xc[0]!="string")&&(Hl=!1);_c=Hl}if(_c===!1)throw new Error('Type of text must be string or Array. "'+Y+'" is not recognized.');typeof Y=="string"&&(Y=Y.match(/[\r?\n]/)?Y.split(/\r\n|\r|\n/g):[Y]);var kl=Xe/Jr.internal.scaleFactor,Cc=kl*(vc-1);switch(Je.baseline){case"bottom":Fe-=Cc;break;case"top":Fe+=kl-Cc;break;case"hanging":Fe+=kl-2*Cc;break;case"middle":Fe+=kl/2-Cc}if((ks=Je.maxWidth||0)>0&&(typeof Y=="string"?Y=Jr.splitTextToSize(Y,ks):Object.prototype.toString.call(Y)==="[object Array]"&&(Y=Y.reduce(function(yr,nr){return yr.concat(Jr.splitTextToSize(nr,ks))},[]))),Ht={text:Y,x:me,y:Fe,options:Je,mutex:{pdfEscape:oi,activeFontKey:ht,fonts:En,activeFontSize:Xe}},Mt.publish("preProcessText",Ht),Y=Ht.text,zn=(Je=Ht.options).angle,Ki instanceof Fn==0&&zn&&typeof zn=="number"){zn*=Math.PI/180,Je.rotationDirection===0&&(zn=-zn),C===S&&(zn=-zn);var $f=Math.cos(zn),El=Math.sin(zn);Ki=new Fn($f,El,-El,$f,0,0)}else zn&&zn instanceof Fn&&(Ki=zn);C!==S||Ki||(Ki=ro),(xs=Je.charSpace||aa)!==void 0&&(_a+=I(j(xs))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gi=Je.horizontalScale)!==void 0&&(_a+=I(100*gi)+` Tz
`),Je.lang;var Ia=-1,ql=Je.renderingMode!==void 0?Je.renderingMode:Je.stroke,ku=Jr.internal.getCurrentPageInfo().pageContext;switch(ql){case 0:case!1:case"fill":Ia=0;break;case 1:case!0:case"stroke":Ia=1;break;case 2:case"fillThenStroke":Ia=2;break;case 3:case"invisible":Ia=3;break;case 4:case"fillAndAddForClipping":Ia=4;break;case 5:case"strokeAndAddPathForClipping":Ia=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ia=6;break;case 7:case"addToPathForClipping":Ia=7}var Yl=ku.usedRenderingMode!==void 0?ku.usedRenderingMode:-1;Ia!==-1?_a+=Ia+` Tr
`:Yl!==-1&&(_a+=`0 Tr
`),Ia!==-1&&(ku.usedRenderingMode=Ia),qn=Je.align||"left";var zo,Kl=Xe*vc,Sc=Jr.internal.pageSize.getWidth(),Od=En[ht];xs=Je.charSpace||aa,ks=Je.maxWidth||0,pr=Object.assign({autoencode:!0,noBOM:!0},Je.flags);var Xl=[],Mc=function(yr){return Jr.getStringUnitWidth(yr,{font:Od,charSpace:xs,fontSize:Xe,doKerning:!1})*Xe/ol};if(Object.prototype.toString.call(Y)==="[object Array]"){var vo;nn=Dd(Y),qn!=="left"&&(zo=nn.map(Mc));var Aa,Pn=0;if(qn==="right"){me-=zo[0],Y=[],Xi=nn.length;for(var Tc=0;Tc<Xi;Tc++)Tc===0?(Aa=Fr(me),vo=Si(Fe)):(Aa=j(Pn-zo[Tc]),vo=-Kl),Y.push([nn[Tc],Aa,vo]),Pn=zo[Tc]}else if(qn==="center"){me-=zo[0]/2,Y=[],Xi=nn.length;for(var kc=0;kc<Xi;kc++)kc===0?(Aa=Fr(me),vo=Si(Fe)):(Aa=j((Pn-zo[kc])/2),vo=-Kl),Y.push([nn[kc],Aa,vo]),Pn=zo[kc]}else if(qn==="left"){Y=[],Xi=nn.length;for(var Qc=0;Qc<Xi;Qc++)Y.push(nn[Qc])}else if(qn==="justify"&&Od.encoding==="Identity-H"){Y=[],Xi=nn.length,ks=ks!==0?ks:Sc;for(var Jc=0,Dr=0;Dr<Xi;Dr++)if(vo=Dr===0?Si(Fe):-Kl,Aa=Dr===0?Fr(me):Jc,Dr<Xi-1){var nf=j((ks-zo[Dr])/(nn[Dr].split(" ").length-1)),ll=nn[Dr].split(" ");Y.push([ll[0]+" ",Aa,vo]),Jc=0;for(var Ql=1;Ql<ll.length;Ql++){var La=(Mc(ll[Ql-1]+" "+ll[Ql])-Mc(ll[Ql]))*ol+nf;Ql==ll.length-1?Y.push([ll[Ql],La,0]):Y.push([ll[Ql]+" ",La,0]),Jc-=La}}else Y.push([nn[Dr],Aa,vo]);Y.push(["",Jc,0])}else{if(qn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(Y=[],Xi=nn.length,ks=ks!==0?ks:Sc,Dr=0;Dr<Xi;Dr++){vo=Dr===0?Si(Fe):-Kl,Aa=Dr===0?Fr(me):0;var Jl=nn[Dr].split(" ").length-1,Eu=Jl>0?(ks-zo[Dr])/Jl:0;Dr<Xi-1?Xl.push(I(j(Eu))):Xl.push(0),Y.push([nn[Dr],Aa,vo])}}}(typeof Je.R2L=="boolean"?Je.R2L:xt)===!0&&(Y=Pf(Y,function(yr,nr,F){return[yr.split("").reverse().join(""),nr,F]})),Ht={text:Y,x:me,y:Fe,options:Je,mutex:{pdfEscape:oi,activeFontKey:ht,fonts:En,activeFontSize:Xe}},Mt.publish("postProcessText",Ht),Y=Ht.text,zi=Ht.mutex.isHex||!1;var sf=En[ht].encoding;sf!=="WinAnsiEncoding"&&sf!=="StandardEncoding"||(Y=Pf(Y,function(yr,nr,F){return[Xc(yr),nr,F]})),nn=Dd(Y),Y=[];for(var Zl,Ec,cl,Ic=Array.isArray(nn[0])?1:0,_o="",Ac=function(yr,nr,F){var ee="";return F instanceof Fn?(F=typeof Je.angle=="number"?fs(F,new Fn(1,0,0,1,yr,nr)):fs(new Fn(1,0,0,1,yr,nr),F),C===S&&(F=fs(new Fn(1,0,0,-1,0,0),F)),ee=F.join(" ")+` Tm
`):ee=I(yr)+" "+I(nr)+` Td
`,ee},Na=0;Na<nn.length;Na++){switch(_o="",Ic){case 1:cl=(zi?"<":"(")+nn[Na][0]+(zi?">":")"),Zl=parseFloat(nn[Na][1]),Ec=parseFloat(nn[Na][2]);break;case 0:cl=(zi?"<":"(")+nn[Na]+(zi?">":")"),Zl=Fr(me),Ec=Si(Fe)}Xl!==void 0&&Xl[Na]!==void 0&&(_o=Xl[Na]+` Tw
`),Na===0?Y.push(_o+Ac(Zl,Ec,Ki)+cl):Ic===0?Y.push(_o+cl):Ic===1&&Y.push(_o+Ac(Zl,Ec,Ki)+cl)}Y=Ic===0?Y.join(` Tj
T* `):Y.join(` Tj
`),Y+=` Tj
`;var ul=`BT
/`;return ul+=ht+" "+Xe+` Tf
`,ul+=I(Xe*vc)+` TL
`,ul+=Ha+`
`,ul+=_a,ul+=Y,de(ul+="ET"),h[ht]=!0,Jr};var ft=p.__private__.clip=p.clip=function(Y){return de(Y==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return ft("evenodd")},p.__private__.discardPath=p.discardPath=function(){return de("n"),this};var oe=p.__private__.isValidStyle=function(Y){var me=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(Y)!==-1&&(me=!0),me};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(Y){return oe(Y)&&(u=Y),this};var Ne=p.__private__.getStyle=p.getStyle=function(Y){var me=u;switch(Y){case"D":case"S":me="S";break;case"F":me="f";break;case"FD":case"DF":me="B";break;case"f":case"f*":case"B":case"B*":me=Y}return me},Ue=p.close=function(){return de("h"),this};p.stroke=function(){return de("S"),this},p.fill=function(Y){return Ve("f",Y),this},p.fillEvenOdd=function(Y){return Ve("f*",Y),this},p.fillStroke=function(Y){return Ve("B",Y),this},p.fillStrokeEvenOdd=function(Y){return Ve("B*",Y),this};var Ve=function(Y,me){Wi(me)==="object"?wn(me,Y):de(Y)},Ct=function(Y){Y===null||C===S&&Y===void 0||(Y=Ne(Y),de(Y))};function Rt(Y,me,Fe,Je,pt){var Ht=new Pv(me||this.boundingBox,Fe||this.xStep,Je||this.yStep,this.gState,pt||this.matrix);Ht.stream=this.stream;var nn=Y+"$$"+this.cloneIndex+++"$$";return re(nn,Ht),Ht}var wn=function(Y,me){var Fe=gr[Y.key],Je=Dn[Fe];if(Je instanceof $y)de("q"),de(bn(me)),Je.gState&&p.setGState(Je.gState),de(Y.matrix.toString()+" cm"),de("/"+Fe+" sh"),de("Q");else if(Je instanceof Pv){var pt=new Fn(1,0,0,-1,0,Kc());Y.matrix&&(pt=pt.multiply(Y.matrix||ro),Fe=Rt.call(Je,Y.key,Y.boundingBox,Y.xStep,Y.yStep,pt).id),de("q"),de("/Pattern cs"),de("/"+Fe+" scn"),Je.gState&&p.setGState(Je.gState),de(me),de("Q")}},bn=function(Y){switch(Y){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},_n=p.moveTo=function(Y,me){return de(I(j(Y))+" "+I(G(me))+" m"),this},mn=p.lineTo=function(Y,me){return de(I(j(Y))+" "+I(G(me))+" l"),this},ls=p.curveTo=function(Y,me,Fe,Je,pt,Ht){return de([I(j(Y)),I(G(me)),I(j(Fe)),I(G(Je)),I(j(pt)),I(G(Ht)),"c"].join(" ")),this};p.__private__.line=p.line=function(Y,me,Fe,Je,pt){if(isNaN(Y)||isNaN(me)||isNaN(Fe)||isNaN(Je)||!oe(pt))throw new Error("Invalid arguments passed to jsPDF.line");return C===x?this.lines([[Fe-Y,Je-me]],Y,me,[1,1],pt||"S"):this.lines([[Fe-Y,Je-me]],Y,me,[1,1]).stroke()},p.__private__.lines=p.lines=function(Y,me,Fe,Je,pt,Ht){var nn,zn,qn,xs,ks,pr,gi,Ki,Jr,Ea,zi,_a;if(typeof Y=="number"&&(_a=Fe,Fe=me,me=Y,Y=_a),Je=Je||[1,1],Ht=Ht||!1,isNaN(me)||isNaN(Fe)||!Array.isArray(Y)||!Array.isArray(Je)||!oe(pt)||typeof Ht!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_n(me,Fe),nn=Je[0],zn=Je[1],xs=Y.length,Ea=me,zi=Fe,qn=0;qn<xs;qn++)(ks=Y[qn]).length===2?(Ea=ks[0]*nn+Ea,zi=ks[1]*zn+zi,mn(Ea,zi)):(pr=ks[0]*nn+Ea,gi=ks[1]*zn+zi,Ki=ks[2]*nn+Ea,Jr=ks[3]*zn+zi,Ea=ks[4]*nn+Ea,zi=ks[5]*zn+zi,ls(pr,gi,Ki,Jr,Ea,zi));return Ht&&Ue(),Ct(pt),this},p.path=function(Y){for(var me=0;me<Y.length;me++){var Fe=Y[me],Je=Fe.c;switch(Fe.op){case"m":_n(Je[0],Je[1]);break;case"l":mn(Je[0],Je[1]);break;case"c":ls.apply(this,Je);break;case"h":Ue()}}return this},p.__private__.rect=p.rect=function(Y,me,Fe,Je,pt){if(isNaN(Y)||isNaN(me)||isNaN(Fe)||isNaN(Je)||!oe(pt))throw new Error("Invalid arguments passed to jsPDF.rect");return C===x&&(Je=-Je),de([I(j(Y)),I(G(me)),I(j(Fe)),I(j(Je)),"re"].join(" ")),Ct(pt),this},p.__private__.triangle=p.triangle=function(Y,me,Fe,Je,pt,Ht,nn){if(isNaN(Y)||isNaN(me)||isNaN(Fe)||isNaN(Je)||isNaN(pt)||isNaN(Ht)||!oe(nn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Fe-Y,Je-me],[pt-Fe,Ht-Je],[Y-pt,me-Ht]],Y,me,[1,1],nn,!0),this},p.__private__.roundedRect=p.roundedRect=function(Y,me,Fe,Je,pt,Ht,nn){if(isNaN(Y)||isNaN(me)||isNaN(Fe)||isNaN(Je)||isNaN(pt)||isNaN(Ht)||!oe(nn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var zn=4/3*(Math.SQRT2-1);return pt=Math.min(pt,.5*Fe),Ht=Math.min(Ht,.5*Je),this.lines([[Fe-2*pt,0],[pt*zn,0,pt,Ht-Ht*zn,pt,Ht],[0,Je-2*Ht],[0,Ht*zn,-pt*zn,Ht,-pt,Ht],[2*pt-Fe,0],[-pt*zn,0,-pt,-Ht*zn,-pt,-Ht],[0,2*Ht-Je],[0,-Ht*zn,pt*zn,-Ht,pt,-Ht]],Y+pt,me,[1,1],nn,!0),this},p.__private__.ellipse=p.ellipse=function(Y,me,Fe,Je,pt){if(isNaN(Y)||isNaN(me)||isNaN(Fe)||isNaN(Je)||!oe(pt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ht=4/3*(Math.SQRT2-1)*Fe,nn=4/3*(Math.SQRT2-1)*Je;return _n(Y+Fe,me),ls(Y+Fe,me-nn,Y+Ht,me-Je,Y,me-Je),ls(Y-Ht,me-Je,Y-Fe,me-nn,Y-Fe,me),ls(Y-Fe,me+nn,Y-Ht,me+Je,Y,me+Je),ls(Y+Ht,me+Je,Y+Fe,me+nn,Y+Fe,me),Ct(pt),this},p.__private__.circle=p.circle=function(Y,me,Fe,Je){if(isNaN(Y)||isNaN(me)||isNaN(Fe)||!oe(Je))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(Y,me,Fe,Fe,Je)},p.setFont=function(Y,me,Fe){return Fe&&(me=E(me,Fe)),ht=Gc(Y,me,{disableWarning:!1}),this};var ds=p.__private__.getFont=p.getFont=function(){return En[Gc.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var Y,me,Fe={};for(Y in Vn)if(Vn.hasOwnProperty(Y))for(me in Fe[Y]=[],Vn[Y])Vn[Y].hasOwnProperty(me)&&Fe[Y].push(me);return Fe},p.addFont=function(Y,me,Fe,Je,pt){var Ht=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ht.indexOf(arguments[3])!==-1?pt=arguments[3]:arguments[3]&&Ht.indexOf(arguments[3])==-1&&(Fe=E(Fe,Je)),ka.call(this,Y,me,Fe,pt=pt||"Identity-H")};var Ar,Ci=n.lineWidth||.200025,Sr=p.__private__.getLineWidth=p.getLineWidth=function(){return Ci},An=p.__private__.setLineWidth=p.setLineWidth=function(Y){return Ci=Y,de(I(j(Y))+" w"),this};p.__private__.setLineDash=bs.API.setLineDash=bs.API.setLineDashPattern=function(Y,me){if(Y=Y||[],me=me||0,isNaN(me)||!Array.isArray(Y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return Y=Y.map(function(Fe){return I(j(Fe))}).join(" "),me=I(j(me)),de("["+Y+"] "+me+" d"),this};var Lr=p.__private__.getLineHeight=p.getLineHeight=function(){return Xe*Ar};p.__private__.getLineHeight=p.getLineHeight=function(){return Xe*Ar};var wo=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(Y){return typeof(Y=Y||1.15)=="number"&&(Ar=Y),this},Ml=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Ar};wo(n.lineHeight);var Fr=p.__private__.getHorizontalCoordinate=function(Y){return j(Y)},Si=p.__private__.getVerticalCoordinate=function(Y){return C===S?Y:On[B].mediaBox.topRightY-On[B].mediaBox.bottomLeftY-j(Y)},Qr=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(Y){return I(Fr(Y))},mi=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(Y){return I(Si(Y))},Wr=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return xn(Wr)},p.__private__.setStrokeColor=p.setDrawColor=function(Y,me,Fe,Je){return Wr=un({ch1:Y,ch2:me,ch3:Fe,ch4:Je,pdfColorType:"draw",precision:2}),de(Wr),this};var io=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return xn(io)},p.__private__.setFillColor=p.setFillColor=function(Y,me,Fe,Je){return io=un({ch1:Y,ch2:me,ch3:Fe,ch4:Je,pdfColorType:"fill",precision:2}),de(io),this};var Ha=n.textColor||"0 g",Yi=p.__private__.getTextColor=p.getTextColor=function(){return xn(Ha)};p.__private__.setTextColor=p.setTextColor=function(Y,me,Fe,Je){return Ha=un({ch1:Y,ch2:me,ch3:Fe,ch4:Je,pdfColorType:"text",precision:3}),this};var aa=n.charSpace,Di=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(aa||0)};p.__private__.setCharSpace=p.setCharSpace=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return aa=Y,this};var Gr=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(Y){var me=p.CapJoinStyles[Y];if(me===void 0)throw new Error("Line cap style of '"+Y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gr=me,de(me+" J"),this};var Qs=0;p.__private__.setLineJoin=p.setLineJoin=function(Y){var me=p.CapJoinStyles[Y];if(me===void 0)throw new Error("Line join style of '"+Y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qs=me,de(me+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(Y){if(Y=Y||0,isNaN(Y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return de(I(j(Y))+" M"),this},p.GState=oN,p.setGState=function(Y){(Y=typeof Y=="string"?os[ps[Y]]:Nr(null,Y)).equals(Ss)||(de("/"+Y.id+" gs"),Ss=Y)};var Nr=function(Y,me){if(!Y||!ps[Y]){var Fe=!1;for(var Je in os)if(os.hasOwnProperty(Je)&&os[Je].equals(me)){Fe=!0;break}if(Fe)me=os[Je];else{var pt="GS"+(Object.keys(os).length+1).toString(10);os[pt]=me,me.id=pt}return Y&&(ps[Y]=me.id),Mt.publish("addGState",me),me}};p.addGState=function(Y,me){return Nr(Y,me),this},p.saveGraphicsState=function(){return de("q"),Nn.push({key:ht,size:Xe,color:Ha}),this},p.restoreGraphicsState=function(){de("Q");var Y=Nn.pop();return ht=Y.key,Xe=Y.size,Ha=Y.color,Ss=null,this},p.setCurrentTransformationMatrix=function(Y){return de(Y.toString()+" cm"),this},p.comment=function(Y){return de("#"+Y),this};var Oi=function(Y,me){var Fe=Y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Fe},set:function(Ht){isNaN(Ht)||(Fe=parseFloat(Ht))}});var Je=me||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Je},set:function(Ht){isNaN(Ht)||(Je=parseFloat(Ht))}});var pt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return pt},set:function(Ht){pt=Ht.toString()}}),this},il=function(Y,me,Fe,Je){Oi.call(this,Y,me),this.type="rect";var pt=Fe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return pt},set:function(nn){isNaN(nn)||(pt=parseFloat(nn))}});var Ht=Je||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ht},set:function(nn){isNaN(nn)||(Ht=parseFloat(nn))}}),this},Tl=function(){this.page=Qn,this.currentPage=B,this.pages=pe.slice(0),this.pagesContext=On.slice(0),this.x=Xt,this.y=us,this.matrix=yn,this.width=qc(B),this.height=Nd(B),this.outputDestination=$e,this.id="",this.objectNumber=-1};Tl.prototype.restore=function(){Qn=this.page,B=this.currentPage,On=this.pagesContext,pe=this.pages,Xt=this.x,us=this.y,yn=this.matrix,ef(B,this.width),al(B,this.height),$e=this.outputDestination};var Tu=function(Y,me,Fe,Je,pt){ir.push(new Tl),Qn=B=0,pe=[],Xt=Y,us=me,yn=pt,wa([Fe,Je])};for(var Hc in p.beginFormObject=function(Y,me,Fe,Je,pt){return Tu(Y,me,Fe,Je,pt),this},p.endFormObject=function(Y){return(function(me){if(ai[me])ir.pop().restore();else{var Fe=new Tl,Je="Xo"+(Object.keys(Tn).length+1).toString(10);Fe.id=Je,ai[me]=Je,Tn[Je]=Fe,Mt.publish("addFormObject",Fe),ir.pop().restore()}})(Y),this},p.doFormObject=function(Y,me){var Fe=Tn[ai[Y]];return de("q"),de(me.toString()+" cm"),de("/"+Fe.id+" Do"),de("Q"),this},p.getFormObject=function(Y){var me=Tn[ai[Y]];return{x:me.x,y:me.y,width:me.width,height:me.height,matrix:me.matrix}},p.save=function(Y,me){return Y=Y||"generated.pdf",(me=me||{}).returnPromise=me.returnPromise||!1,me.returnPromise===!1?(ky(cn(Zt()),Y),typeof ky.unload=="function"&&zs.setTimeout&&setTimeout(ky.unload,911),this):new Promise(function(Fe,Je){try{var pt=ky(cn(Zt()),Y);typeof ky.unload=="function"&&zs.setTimeout&&setTimeout(ky.unload,911),Fe(pt)}catch(Ht){Je(Ht.message)}})},bs.API)bs.API.hasOwnProperty(Hc)&&(Hc==="events"&&bs.API.events.length?(function(Y,me){var Fe,Je,pt;for(pt=me.length-1;pt!==-1;pt--)Fe=me[pt][0],Je=me[pt][1],Y.subscribe.apply(Y,[Fe].concat(typeof Je=="function"?[Je]:Je))})(Mt,bs.API.events):p[Hc]=bs.API[Hc]);function qc(Y){return On[Y].mediaBox.topRightX-On[Y].mediaBox.bottomLeftX}function ef(Y,me){On[Y].mediaBox.topRightX=me+On[Y].mediaBox.bottomLeftX}function Nd(Y){return On[Y].mediaBox.topRightY-On[Y].mediaBox.bottomLeftY}function al(Y,me){On[Y].mediaBox.topRightY=me+On[Y].mediaBox.bottomLeftY}var Yc=p.getPageWidth=function(Y){return qc(Y=Y||B)/Qt},Ch=p.setPageWidth=function(Y,me){ef(Y,me*Qt)},Kc=p.getPageHeight=function(Y){return Nd(Y=Y||B)/Qt},Sh=p.setPageHeight=function(Y,me){al(Y,me*Qt)};return p.internal={pdfEscape:oi,getStyle:Ne,getFont:ds,getFontSize:Ze,getCharSpace:Di,getTextColor:Yi,getLineHeight:Lr,getLineHeightFactor:Ml,getLineWidth:Sr,write:Be,getHorizontalCoordinate:Fr,getVerticalCoordinate:Si,getCoordinateString:Qr,getVerticalCoordinateString:mi,collections:{},newObject:ve,newAdditionalObject:ut,newObjectDeferred:Oe,newObjectDeferredBegin:ze,getFilters:Gn,putStream:hn,events:Mt,scaleFactor:Qt,pageSize:{getWidth:function(){return Yc(B)},setWidth:function(Y){Ch(B,Y)},getHeight:function(){return Kc(B)},setHeight:function(Y){Sh(B,Y)}},encryptionOptions:f,encryption:xi,getEncryptor:function(Y){return f!==null?xi.encryptor(Y,0):function(me){return me}},output:In,getNumberOfPages:rl,get pages(){return pe},out:de,f2:L,f3:P,getPageInfo:ci,getPageInfoByObjId:Gl,getCurrentPageInfo:Of,getPDFVersion:b,Point:Oi,Rectangle:il,Matrix:Fn,hasHotfix:Rs},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Yc(B)},set:function(Y){Ch(B,Y)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Kc(B)},set:function(Y){Sh(B,Y)},enumerable:!0,configurable:!0}),(function(Y){for(var me=0,Fe=He.length;me<Fe;me++){var Je=ka.call(this,Y[me][0],Y[me][1],Y[me][2],He[me][3],!0);d===!1&&(h[Je]=!0);var pt=Y[me][0].split("-");Xr({id:Je,fontName:pt[0],fontStyle:pt[1]||""})}Mt.publish("addFonts",{fonts:En,dictionary:Vn})}).call(p,He),ht="F1",li(r,t),Mt.publish("initialized"),p}Mv.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},Mv.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Mv.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},Mv.prototype.processOwnerPassword=function(n,e){return sR(nR(e).substr(0,5),n)},Mv.prototype.encryptor=function(n,e){var t=nR(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return sR(t,s)}},oN.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Wi(n)!==Wi(this))return!1;var s=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;s++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&s--;return s===0},bs.API={events:[]},bs.version="3.0.4";var Lo=bs.API,EF=1,Ub=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hv=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Xs=function(n){return n.toFixed(2)},D0=function(n){return n.toFixed(5)};Lo.__acroform__={};var Nf=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},jW=function(n){return n*EF},lm=function(n){var e=new Une,t=ts.internal.getHeight(n)||0,s=ts.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Xs(s)),Number(Xs(t))],e},n2e=Lo.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},s2e=Lo.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},r2e=Lo.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},qo=Lo.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return r2e(n,e-1)},Yo=Lo.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return n2e(n,e-1)},Ko=Lo.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return s2e(n,e-1)},i2e=Lo.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,r=n[0],a=n[1],o=n[2],l=n[3],c={};return c.lowerLeft_X=t(r)||0,c.lowerLeft_Y=s(a+l)||0,c.upperRight_X=t(r+o)||0,c.upperRight_Y=s(a)||0,[Number(Xs(c.lowerLeft_X)),Number(Xs(c.lowerLeft_Y)),Number(Xs(c.upperRight_X)),Number(Xs(c.upperRight_Y))]},a2e=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,s=rR(n,t),r=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+r+" "+Xs(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=lm(n);return a.scope=n.scope,a.stream=e.join(`
`),a}},rR=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,s={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=n.multiline?r.map(function(L){return L.split(`
`)}):r.map(function(L){return[L]});var a=t,o=ts.internal.getHeight(n)||0;o=o<0?-o:o;var l=ts.internal.getWidth(n)||0;l=l<0?-l:l;var c=function(L,P,j){if(L+1<r.length){var G=P+" "+r[L+1][0];return xI(G,n,j).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var u,f,d=xI("3",n,a).height,h=n.multiline?o-a:(o-d)/2,p=h+=2,g=0,b=0,v=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+xI(e,n,a=12).width+", FieldWidth:"+l+`
`;break}for(var w="",x=0,S=0;S<r.length;S++)if(r.hasOwnProperty(S)){var C=!1;if(r[S].length!==1&&v!==r[S].length-1){if((d+2)*(x+2)+2>o)continue e;w+=r[S][v],C=!0,b=S,S--}else{w=(w+=r[S][v]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var M=parseInt(S),k=c(M,w,a),E=S>=r.length-1;if(k&&!E){w+=" ",v=0;continue}if(k||E){if(E)b=M;else if(n.multiline&&(d+2)*(x+2)+2>o)continue e}else{if(!n.multiline||(d+2)*(x+2)+2>o)continue e;b=M}}for(var I="",A=g;A<=b;A++){var D=r[A];if(n.multiline){if(A===b){I+=D[v]+" ",v=(v+1)%D.length;continue}if(A===g){I+=D[D.length-1]+" ";continue}}I+=D[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,f=xI(I,n,a).width,n.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}e+=Xs(u)+" "+Xs(p)+` Td
`,e+="("+Ub(I)+`) Tj
`,e+=-Xs(u)+` 0 Td
`,p=-(a+2),f=0,g=C?b:b+1,x++,w=""}break}return s.text=e,s.fontSize=a,s},xI=function(n,e,t){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(n,{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},o2e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},l2e=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(s){return s.type===t.type&&s.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},c2e=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(_p.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(o2e)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");EF=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new Vne,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in s)if(s.hasOwnProperty(r)){var a=s[r];a.objId=void 0,a.hasAnnotation&&l2e(a,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(s,r){var a=!s;for(var o in s||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(o)){var l=s[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=i2e(l.Rect,r)),r.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ts.createDefaultAppearanceStream(l),Wi(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=a2e(l);c.push({key:"AP",value:"<</N "+f+">>"}),r.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var d="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var p=l.appearanceStreamContent[h];if(d+="/"+h+" ",d+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var g=p[o];typeof g=="function"&&(g=g.call(r,l)),d+="/"+o+" "+g+" ",r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g)}}else typeof(g=p)=="function"&&(g=g.call(r,l)),d+="/"+o+" "+g,r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}r.internal.putStream({additionalKeyValues:c,objectId:l.objId}),r.internal.out("endobj")}a&&(function(b,v){for(var w in b)if(b.hasOwnProperty(w)){var x=w,S=b[w];v.internal.newObjectDeferredBegin(S.objId,!0),Wi(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete b[x]}})(r.internal.acroformPlugin.xForms,r)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},Bne=Lo.__acroform__.arrayToPdfArray=function(n,e,t){var s=function(o){return o};if(Array.isArray(n)){for(var r="[",a=0;a<n.length;a++)switch(a!==0&&(r+=" "),Wi(n[a])){case"boolean":case"number":case"object":r+=n[a].toString();break;case"string":n[a].substr(0,1)!=="/"?(e!==void 0&&t&&(s=t.internal.getEncryptor(e)),r+="("+Ub(s(n[a].toString()))+")"):r+=n[a].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},F3=function(n,e,t){var s=function(r){return r};return e!==void 0&&t&&(s=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Ub(s(n))+")"},bm=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};bm.prototype.toString=function(){return this.objId+" 0 R"},bm.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},bm.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var s=e[t],r=this[s];r&&(Array.isArray(r)?n.push({key:s,value:Bne(r,this.objId,this.scope)}):r instanceof bm?(r.scope=this.scope,n.push({key:s,value:r.objId+" 0 R"})):typeof r!="function"&&n.push({key:s,value:r}))}return n};var Une=function(){bm.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};Nf(Une,bm);var Vne=function(){bm.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(s){return s};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Ub(t(n))+")"}},set:function(t){n=t}})};Nf(Vne,bm);var _p=function n(){bm.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!qo(e,3)},set:function(w){w?this.F=Yo(e,3):this.F=Ko(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(w){s=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(w){s[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(w){s[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(w){s[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(w){s[3]=w}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof lN)return;a="FieldObject"+n.FieldNum++}var w=function(x){return x};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Ub(w(a))+")"},set:function(w){a=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(w){a=w}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(w){c=w}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/EF:u},set:function(w){u=w}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(w){f=w}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof lN||this instanceof Jy))return F3(d,this.objId,this.scope)},set:function(w){w=w.toString(),d=w}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ac==0?F3(h,this.objId,this.scope):h},set:function(w){w=w.toString(),h=this instanceof ac==0?w.substr(0,1)==="("?hv(w.substr(1,w.length-2)):hv(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ac==1?hv(h.substr(1,h.length-1)):h},set:function(w){w=w.toString(),h=this instanceof ac==1?"/"+w:w}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ac==0?F3(p,this.objId,this.scope):p},set:function(w){w=w.toString(),p=this instanceof ac==0?w.substr(0,1)==="("?hv(w.substr(1,w.length-2)):hv(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ac==1?hv(p.substr(1,p.length-1)):p},set:function(w){w=w.toString(),p=this instanceof ac==1?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(w){w=!!w,b=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(w){g=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,1)},set:function(w){w?this.Ff=Yo(this.Ff,1):this.Ff=Ko(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,2)},set:function(w){w?this.Ff=Yo(this.Ff,2):this.Ff=Ko(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,3)},set:function(w){w?this.Ff=Yo(this.Ff,3):this.Ff=Ko(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');v=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(v){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};Nf(_p,bm);var Bv=function(){_p.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Bne(e,this.objId,this.scope)},set:function(t){var s,r;r=[],typeof(s=t)=="string"&&(r=(function(a,o,l){l||(l=1);for(var c,u=[];c=o.exec(a);)u.push(c[l]);return u})(s,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,s){for(s=s||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,18)},set:function(t){t?this.Ff=Yo(this.Ff,18):this.Ff=Ko(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Yo(this.Ff,19):this.Ff=Ko(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,20)},set:function(t){t?(this.Ff=Yo(this.Ff,20),e.sort()):this.Ff=Ko(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,22)},set:function(t){t?this.Ff=Yo(this.Ff,22):this.Ff=Ko(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,23)},set:function(t){t?this.Ff=Yo(this.Ff,23):this.Ff=Ko(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,27)},set:function(t){t?this.Ff=Yo(this.Ff,27):this.Ff=Ko(this.Ff,27)}}),this.hasAppearanceStream=!1};Nf(Bv,_p);var Uv=function(){Bv.call(this),this.fontName="helvetica",this.combo=!1};Nf(Uv,Bv);var Vv=function(){Uv.call(this),this.combo=!0};Nf(Vv,Uv);var dL=function(){Vv.call(this),this.edit=!0};Nf(dL,Vv);var ac=function(){_p.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,15)},set:function(t){t?this.Ff=Yo(this.Ff,15):this.Ff=Ko(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,16)},set:function(t){t?this.Ff=Yo(this.Ff,16):this.Ff=Ko(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,17)},set:function(t){t?this.Ff=Yo(this.Ff,17):this.Ff=Ko(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,26)},set:function(t){t?this.Ff=Yo(this.Ff,26):this.Ff=Ko(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(a){return a};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,r=[];for(s in r.push("<<"),e)r.push("/"+s+" ("+Ub(t(e[s]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){Wi(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};Nf(ac,_p);var hL=function(){ac.call(this),this.pushButton=!0};Nf(hL,ac);var Wv=function(){ac.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};Nf(Wv,ac);var lN=function(){var n,e;_p.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(l){return l};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),s)o.push("/"+a+" ("+Ub(r(s[a]))+")");return o.push(">>"),o.join(`
`)},set:function(r){Wi(r)==="object"&&(s=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(r){typeof r=="string"&&(s.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ts.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Nf(lN,_p),Wv.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Wv.prototype.createOption=function(n){var e=new lN;return e.Parent=this,e.optionName=n,this.Kids.push(e),u2e.call(this.scope,e),e};var pL=function(){ac.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ts.CheckBox.createAppearanceStream()};Nf(pL,ac);var Jy=function(){_p.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,13)},set:function(e){e?this.Ff=Yo(this.Ff,13):this.Ff=Ko(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,21)},set:function(e){e?this.Ff=Yo(this.Ff,21):this.Ff=Ko(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,23)},set:function(e){e?this.Ff=Yo(this.Ff,23):this.Ff=Ko(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,24)},set:function(e){e?this.Ff=Yo(this.Ff,24):this.Ff=Ko(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,25)},set:function(e){e?this.Ff=Yo(this.Ff,25):this.Ff=Ko(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,26)},set:function(e){e?this.Ff=Yo(this.Ff,26):this.Ff=Ko(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Nf(Jy,_p);var mL=function(){Jy.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!qo(this.Ff,14)},set:function(n){n?this.Ff=Yo(this.Ff,14):this.Ff=Ko(this.Ff,14)}}),this.password=!0};Nf(mL,Jy);var ts={CheckBox:{createAppearanceStream:function(){return{N:{On:ts.CheckBox.YesNormal},D:{On:ts.CheckBox.YesPushDown,Off:ts.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=lm(n);e.scope=n.scope;var t=[],s=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),a=rR(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+Xs(ts.internal.getWidth(n))+" "+Xs(ts.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+s+" "+Xs(a.fontSize)+" Tf "+r),t.push("BT"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=lm(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),r=[],a=ts.internal.getHeight(n),o=ts.internal.getWidth(n),l=rR(n,n.caption);return r.push("1 g"),r.push("0 0 "+Xs(o)+" "+Xs(a)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Xs(o-1)+" "+Xs(a-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+Xs(l.fontSize)+" Tf "+s),r.push(l.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=lm(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Xs(ts.internal.getWidth(n))+" "+Xs(ts.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:ts.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=ts.RadioButton.Circle.YesNormal,e.D[n]=ts.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=lm(n);e.scope=n.scope;var t=[],s=ts.internal.getWidth(n)<=ts.internal.getHeight(n)?ts.internal.getWidth(n)/4:ts.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var r=ts.internal.Bezier_C,a=Number((s*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+D0(ts.internal.getWidth(n)/2)+" "+D0(ts.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),t.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),t.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),t.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=lm(n);e.scope=n.scope;var t=[],s=ts.internal.getWidth(n)<=ts.internal.getHeight(n)?ts.internal.getWidth(n)/4:ts.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var r=Number((2*s).toFixed(5)),a=Number((r*ts.internal.Bezier_C).toFixed(5)),o=Number((s*ts.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+D0(ts.internal.getWidth(n)/2)+" "+D0(ts.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),t.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),t.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),t.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+D0(ts.internal.getWidth(n)/2)+" "+D0(ts.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=lm(n);e.scope=n.scope;var t=[],s=ts.internal.getWidth(n)<=ts.internal.getHeight(n)?ts.internal.getWidth(n)/4:ts.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var r=Number((2*s).toFixed(5)),a=Number((r*ts.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+D0(ts.internal.getWidth(n)/2)+" "+D0(ts.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),t.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),t.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),t.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:ts.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=ts.RadioButton.Cross.YesNormal,e.D[n]=ts.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=lm(n);e.scope=n.scope;var t=[],s=ts.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+Xs(ts.internal.getWidth(n)-2)+" "+Xs(ts.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(Xs(s.x1.x)+" "+Xs(s.x1.y)+" m"),t.push(Xs(s.x2.x)+" "+Xs(s.x2.y)+" l"),t.push(Xs(s.x4.x)+" "+Xs(s.x4.y)+" m"),t.push(Xs(s.x3.x)+" "+Xs(s.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=lm(n);e.scope=n.scope;var t=ts.internal.calculateCross(n),s=[];return s.push("0.749023 g"),s.push("0 0 "+Xs(ts.internal.getWidth(n))+" "+Xs(ts.internal.getHeight(n))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+Xs(ts.internal.getWidth(n)-2)+" "+Xs(ts.internal.getHeight(n)-2)+" re"),s.push("W"),s.push("n"),s.push(Xs(t.x1.x)+" "+Xs(t.x1.y)+" m"),s.push(Xs(t.x2.x)+" "+Xs(t.x2.y)+" l"),s.push(Xs(t.x4.x)+" "+Xs(t.x4.y)+" m"),s.push(Xs(t.x3.x)+" "+Xs(t.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(n){var e=lm(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Xs(ts.internal.getWidth(n))+" "+Xs(ts.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};ts.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=ts.internal.getWidth(n),t=ts.internal.getHeight(n),s=Math.min(e,t);return{x1:{x:(e-s)/2,y:(t-s)/2+s},x2:{x:(e-s)/2+s,y:(t-s)/2},x3:{x:(e-s)/2,y:(t-s)/2},x4:{x:(e-s)/2+s,y:(t-s)/2+s}}}},ts.internal.getWidth=function(n){var e=0;return Wi(n)==="object"&&(e=jW(n.Rect[2])),e},ts.internal.getHeight=function(n){var e=0;return Wi(n)==="object"&&(e=jW(n.Rect[3])),e};var u2e=Lo.addField=function(n){if(c2e(this,n),!(n instanceof _p))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Lo.AcroFormChoiceField=Bv,Lo.AcroFormListBox=Uv,Lo.AcroFormComboBox=Vv,Lo.AcroFormEditBox=dL,Lo.AcroFormButton=ac,Lo.AcroFormPushButton=hL,Lo.AcroFormRadioButton=Wv,Lo.AcroFormCheckBox=pL,Lo.AcroFormTextField=Jy,Lo.AcroFormPasswordField=mL,Lo.AcroFormAppearance=ts,Lo.AcroForm={ChoiceField:Bv,ListBox:Uv,ComboBox:Vv,EditBox:dL,Button:ac,PushButton:hL,RadioButton:Wv,CheckBox:pL,TextField:Jy,PasswordField:mL,Appearance:ts},bs.AcroForm={ChoiceField:Bv,ListBox:Uv,ComboBox:Vv,EditBox:dL,Button:ac,PushButton:hL,RadioButton:Wv,CheckBox:pL,TextField:Jy,PasswordField:mL,Appearance:ts};bs.AcroForm;function Wne(n){return n.reduce(function(e,t,s){return e[t]=s,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(L,P){var j,G,Q,q,te,Z=t;if((P=P||t)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(k(L))for(te in s)for(Q=s[te],j=0;j<Q.length;j+=1){for(q=!0,G=0;G<Q[j].length;G+=1)if(Q[j][G]!==void 0&&Q[j][G]!==L[G]){q=!1;break}if(q===!0){Z=te;break}}else for(te in s)for(Q=s[te],j=0;j<Q.length;j+=1){for(q=!0,G=0;G<Q[j].length;G+=1)if(Q[j][G]!==void 0&&Q[j][G]!==L.charCodeAt(G)){q=!1;break}if(q===!0){Z=te;break}}return Z===t&&P!==t&&(Z=P),Z},a=function L(P){for(var j=this.internal.write,G=this.internal.putStream,Q=(0,this.internal.getFilters)();Q.indexOf("FlateEncode")!==-1;)Q.splice(Q.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:P.width}),q.push({key:"Height",value:P.height}),P.colorSpace===w.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===w.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var te="",Z=0,ne=P.transparency.length;Z<ne;Z++)te+=P.transparency[Z]+" "+P.transparency[Z]+" ";q.push({key:"Mask",value:"["+te+"]"})}P.sMask!==void 0&&q.push({key:"SMask",value:P.objectId+1+" 0 R"});var le=P.filter!==void 0?["/"+P.filter]:void 0;if(G({data:P.data,additionalKeyValues:q,alreadyAppliedFilters:le,objectId:P.objectId}),j("endobj"),"sMask"in P&&P.sMask!==void 0){var H,R=(H=P.sMaskBitsPerComponent)!==null&&H!==void 0?H:P.bitsPerComponent,B={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:R,data:P.sMask};"filter"in P&&(B.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(R," /Columns ").concat(P.width),B.filter=P.filter),L.call(this,B)}if(P.colorSpace===w.INDEXED){var W=this.internal.newObject();G({data:I(new Uint8Array(P.palette)),objectId:W}),j("endobj")}},o=function(){var L=this.internal.collections[e+"images"];for(var P in L)a.call(this,L[P])},l=function(){var L,P=this.internal.collections[e+"images"],j=this.internal.write;for(var G in P)j("/I"+(L=P[G]).index,L.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var L=this.internal.collections[e+"images"];return c.call(this),L},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(L){return typeof n["process"+L.toUpperCase()]=="function"},h=function(L){return Wi(L)==="object"&&L.nodeType===1},p=function(L,P){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var j=""+L.getAttribute("src");if(j.indexOf("data:image/")===0)return fL(unescape(j).split("base64,").pop());var G=n.loadFile(j,!0);if(G!==void 0)return G}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var Q;switch(P){case"PNG":Q="image/png";break;case"WEBP":Q="image/webp";break;default:Q="image/jpeg"}return fL(L.toDataURL(Q,1).split("base64,").pop())}},g=function(L){var P=this.internal.collections[e+"images"];if(P){for(var j in P)if(L===P[j].alias)return P[j]}},b=function(L,P,j){return L||P||(L=-96,P=-96),L<0&&(L=-1*j.width*72/L/this.internal.scaleFactor),P<0&&(P=-1*j.height*72/P/this.internal.scaleFactor),L===0&&(L=P*j.width/j.height),P===0&&(P=L*j.height/j.width),[L,P]},v=function(L,P,j,G,Q,q){var te=b.call(this,j,G,Q),Z=this.internal.getCoordinateString,ne=this.internal.getVerticalCoordinateString,le=u.call(this);if(j=te[0],G=te[1],le[Q.index]=Q,q){q*=Math.PI/180;var H=Math.cos(q),R=Math.sin(q),B=function(se){return se.toFixed(4)},W=[B(H),B(R),B(-1*R),B(H),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,Z(L),ne(P+G),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([Z(j),"0","0",Z(G),"0","0","cm"].join(" "))):this.internal.write([Z(j),"0","0",Z(G),Z(L),ne(P+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Q.index+" Do"),this.internal.write("Q")},w=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=n.__addimage__.sHashCode=function(L){var P,j,G=0;if(typeof L=="string")for(j=L.length,P=0;P<j;P++)G=(G<<5)-G+L.charCodeAt(P),G|=0;else if(k(L))for(j=L.byteLength/2,P=0;P<j;P++)G=(G<<5)-G+L[P],G|=0;return G},C=n.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var P=!0;return L.length===0&&(P=!1),L.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(P=!1),P},M=n.__addimage__.extractImageFromDataUrl=function(L){if(L==null||!(L=L.trim()).startsWith("data:"))return null;var P=L.indexOf(",");return P<0?null:L.substring(0,P).trim().endsWith("base64")?L.substring(P+1):null};n.__addimage__.isArrayBuffer=function(L){return L instanceof ArrayBuffer};var k=n.__addimage__.isArrayBufferView=function(L){return L instanceof Int8Array||L instanceof Uint8Array||L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array},E=n.__addimage__.binaryStringToUint8Array=function(L){for(var P=L.length,j=new Uint8Array(P),G=0;G<P;G++)j[G]=L.charCodeAt(G);return j},I=n.__addimage__.arrayBufferToBinaryString=function(L){for(var P="",j=k(L)?L:new Uint8Array(L),G=0;G<j.length;G+=8192)P+=String.fromCharCode.apply(null,j.subarray(G,G+8192));return P};n.addImage=function(){var L,P,j,G,Q,q,te,Z,ne;if(typeof arguments[1]=="number"?(P=t,j=arguments[1],G=arguments[2],Q=arguments[3],q=arguments[4],te=arguments[5],Z=arguments[6],ne=arguments[7]):(P=arguments[1],j=arguments[2],G=arguments[3],Q=arguments[4],q=arguments[5],te=arguments[6],Z=arguments[7],ne=arguments[8]),Wi(L=arguments[0])==="object"&&!h(L)&&"imageData"in L){var le=L;L=le.imageData,P=le.format||P||t,j=le.x||j||0,G=le.y||G||0,Q=le.w||le.width||Q,q=le.h||le.height||q,te=le.alias||te,Z=le.compression||Z,ne=le.rotation||le.angle||ne}var H=this.internal.getFilters();if(Z===void 0&&H.indexOf("FlateEncode")!==-1&&(Z="SLOW"),isNaN(j)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var R=A.call(this,L,P,te,Z);return v.call(this,j,G,Q,q,R,ne),this};var A=function(L,P,j,G){var Q,q,te;if(typeof L=="string"&&r(L)===t){L=unescape(L);var Z=D(L,!1);(Z!==""||(Z=n.loadFile(L,!0))!==void 0)&&(L=Z)}if(h(L)&&(L=p(L,P)),P=r(L,P),!d(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((te=j)==null||te.length===0)&&(j=(function(ne){return typeof ne=="string"||k(ne)?S(ne):k(ne.data)?S(ne.data):null})(L)),(Q=g.call(this,j))||(L instanceof Uint8Array||P==="RGBA"||(q=L,L=E(L)),Q=this["process"+P.toUpperCase()](L,f.call(this),j,(function(ne){return ne&&typeof ne=="string"&&(ne=ne.toUpperCase()),ne in n.image_compression?ne:x.NONE})(G),q)),!Q)throw new Error("An unknown error occurred whilst processing the image.");return Q},D=n.__addimage__.convertBase64ToBinaryString=function(L,P){P=typeof P!="boolean"||P;var j,G="";if(typeof L=="string"){var Q;j=(Q=M(L))!==null&&Q!==void 0?Q:L;try{G=fL(j)}catch(q){if(P)throw C(j)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};n.getImageProperties=function(L){var P,j,G="";if(h(L)&&(L=p(L)),typeof L=="string"&&r(L)===t&&((G=D(L,!1))===""&&(G=n.loadFile(L)||""),L=G),j=r(L),!d(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(L instanceof Uint8Array||(L=E(L)),!(P=this["process"+j.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=j,P}})(bs.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};bs.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var s,r,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),u=t.pageContext.annotations,f=!1,d=0;d<u.length&&!f;d++)switch((s=u[d]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var h=0;h<u.length;h++){s=u[h];var p=this.internal.pdfEscape,g=this.internal.getEncryptor(t.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(b.objId),x=s.title||"Note";a="<</Type /Annot /Subtype /Text "+(r="/Rect ["+o(s.bounds.x)+" "+l(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w)+" "+l(s.bounds.y)+"] ")+"/Contents ("+p(w(s.contents))+")",a+=" /Popup "+v.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+p(w(x))+") >>",b.content=a;var S=b.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+o(s.bounds.x+30)+" "+l(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w+30)+" "+l(s.bounds.y)+"] ")+" /Parent "+S,s.open&&(a+=" /Open true"),a+=" >>",v.content=a,this.internal.write(b.objId,"0 R",v.objId,"0 R");break;case"freetext":r="/Rect ["+o(s.bounds.x)+" "+l(s.bounds.y)+" "+o(s.bounds.x+s.bounds.w)+" "+l(s.bounds.y+s.bounds.h)+"] ";var C=s.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+p(g(s.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(s.options.name){var M=this.annotations._nameMap[s.options.name];s.options.pageNumber=M.page,s.options.top=M.y}else s.options.top||(s.options.top=0);if(r="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",a="",s.options.url)a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+p(g(s.options.url))+") >>";else if(s.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,a+=" /FitV "+s.options.left+"]";break;default:var k=l(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),a+=" /XYZ "+s.options.left+" "+k+" "+s.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var s=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":s.pageContext.annotations.push(t)}},n.link=function(t,s,r,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(t),y:u(s),w:c(t+r),h:u(s+a)},options:o,type:"link"})},n.textWithLink=function(t,s,r,a){var o,l,c=this.getTextWidth(t),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var f=this.splitTextToSize(t,l).length;o=Math.ceil(u*f)}else l=c,o=u;return this.text(t,s,r,a),r+=.2*u,a.align==="center"&&(s-=c/2),a.align==="right"&&(s-=c),this.link(s,r-u,l,o,a),c},n.getTextWidth=function(t){var s=this.internal.getFontSize();return this.getStringUnitWidth(t)*s/this.internal.scaleFactor}})(bs.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];n.__arabicParser__={};var a=n.__arabicParser__.isInArabicSubstitutionA=function(b){return e[b.charCodeAt(0)]!==void 0},o=n.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},l=n.__arabicParser__.isArabicEndLetter=function(b){return o(b)&&a(b)&&e[b.charCodeAt(0)].length<=2},c=n.__arabicParser__.isArabicAlfLetter=function(b){return o(b)&&r.indexOf(b.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return o(b)&&a(b)&&e[b.charCodeAt(0)].length>=1};var u=n.__arabicParser__.arabicLetterHasFinalForm=function(b){return o(b)&&a(b)&&e[b.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(b){return o(b)&&a(b)&&e[b.charCodeAt(0)].length>=3};var f=n.__arabicParser__.arabicLetterHasMedialForm=function(b){return o(b)&&a(b)&&e[b.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(b){var v=0,w=t,x="",S=0;for(v=0;v<b.length;v+=1)w[b.charCodeAt(v)]!==void 0?(S++,typeof(w=w[b.charCodeAt(v)])=="number"&&(x+=String.fromCharCode(w),w=t,S=0),v===b.length-1&&(w=t,x+=b.charAt(v-(S-1)),v-=S-1,S=0)):(w=t,x+=b.charAt(v-S),v-=S,S=0);return x};n.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&s[b.charCodeAt(0)]!==void 0};var h=n.__arabicParser__.getCorrectForm=function(b,v,w){return o(b)?a(b)===!1?-1:!u(b)||!o(v)&&!o(w)||!o(w)&&l(v)||l(b)&&!o(v)||l(b)&&c(v)||l(b)&&l(v)?0:f(b)&&o(v)&&!l(v)&&o(w)&&u(w)?3:l(b)||!o(w)?1:2:-1},p=function(b){var v=0,w=0,x=0,S="",C="",M="",k=(b=b||"").split("\\s+"),E=[];for(v=0;v<k.length;v+=1){for(E.push(""),w=0;w<k[v].length;w+=1)S=k[v][w],C=k[v][w-1],M=k[v][w+1],o(S)?(x=h(S,C,M),E[v]+=x!==-1?String.fromCharCode(e[S.charCodeAt(0)][x]):S):E[v]+=S;E[v]=d(E[v])}return E.join(" ")},g=n.__arabicParser__.processArabic=n.processArabic=function(){var b,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(v)){var x=0;for(w=[],x=0;x<v.length;x+=1)Array.isArray(v[x])?w.push([p(v[x][0]),v[x][1],v[x][2]]):w.push([p(v[x])]);b=w}else b=p(v);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};n.events.push(["preProcessText",g])})(bs.API),bs.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(l){t=l}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,s){var r;if((t=t||"2d")!=="2d")return null;for(r in s)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=s[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(bs.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(b){c=b}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(b){f=b}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(b){d=b}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(b){g=b}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(c){return s.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},n.getTextDimensions=function(c,u){s.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),d=u.font||this.getFont(),h=u.scaleFactor||this.internal.scaleFactor,p=0,g=0,b=0,v=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var w=u.maxWidth;w>0?typeof c=="string"?c=this.splitTextToSize(c,w):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(S,C){return S.concat(v.splitTextToSize(C,w))},[])):c=Array.isArray(c)?c:[c];for(var x=0;x<c.length;x++)p<(b=this.getStringUnitWidth(c[x],{font:d})*f)&&(p=b);return p!==0&&(g=c.length),{w:p/=h,h:Math.max((g*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/h,0)}},n.cellAddPage=function(){s.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=n.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),s.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,p&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};n.table=function(c,u,f,d,h){if(s.call(this),!f)throw new Error("No data for PDF table.");var p,g,b,v,w=[],x=[],S=[],C={},M={},k=[],E=[],I=(h=h||{}).autoSize||!1,A=h.printHeaders!==!1,D=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,L=h.margins||Object.assign({width:this.getPageWidth()},e),P=typeof h.padding=="number"?h.padding:3,j=h.headerBackgroundColor||"#c8c8c8",G=h.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=D,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=j,this.internal.__cell__.headerTextColor=G,this.setFontSize(D),d==null)x=w=Object.keys(f[0]),S=w.map(function(){return"left"});else if(Array.isArray(d)&&Wi(d[0])==="object")for(w=d.map(function(le){return le.name}),x=d.map(function(le){return le.prompt||le.name||""}),S=d.map(function(le){return le.align||"left"}),p=0;p<d.length;p+=1)M[d[p].name]=.7499990551181103*d[p].width;else Array.isArray(d)&&typeof d[0]=="string"&&(x=w=d,S=w.map(function(){return"left"}));if(I||Array.isArray(d)&&typeof d[0]=="string")for(p=0;p<w.length;p+=1){for(C[v=w[p]]=f.map(function(le){return le[v]}),this.setFont(void 0,"bold"),k.push(this.getTextDimensions(x[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=C[v],this.setFont(void 0,"normal"),b=0;b<g.length;b+=1)k.push(this.getTextDimensions(g[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);M[v]=Math.max.apply(null,k)+P+P,k=[]}if(A){var Q={};for(p=0;p<w.length;p+=1)Q[w[p]]={},Q[w[p]].text=x[p],Q[w[p]].align=S[p];var q=l.call(this,Q,M);E=w.map(function(le){return new a(c,u,M[le],q,Q[le].text,void 0,Q[le].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var te=d.reduce(function(le,H){return le[H.name]=H.align,le},{});for(p=0;p<f.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:f[p]},this);var Z=l.call(this,f[p],M);for(b=0;b<w.length;b+=1){var ne=f[p][w[b]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:b,data:ne},this),o.call(this,new a(c,u,M[w[b]],Z,ne,p+2,te[w[b]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(p){var g=c[p];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,u[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*d/h+f+f},this).reduce(function(p,g){return Math.max(p,g)},0)};n.setTableHeaderRow=function(c){s.call(this),this.internal.__cell__.tableHeaderRow=c},n.printHeaderRow=function(c,u){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,h.push(f)),f.lineNumber=c;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(g)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),t=!1}})(bs.API);var Gne={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Hne=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],iR=Wne(Hne),qne=[100,200,300,400,500,600,700,800,900],f2e=Wne(qne);function z3(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(a){return Gne[a=a||"normal"]?a:"normal"})(n.style),s=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(n.weight),r=(function(a){return typeof iR[a=a||"normal"]=="number"?a:"normal"})(n.stretch);return{family:e,style:t,weight:s,stretch:r,src:n.src||[],ref:n.ref||{name:e,style:[r,t,s].join(" ")}}}function RW(n,e,t,s){var r;for(r=t;r>=0&&r<e.length;r+=s)if(n[e[r]])return n[e[r]];for(r=t;r>=0&&r<e.length;r-=s)if(n[e[r]])return n[e[r]]}var d2e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},FW={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function zW(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function BW(n){return n.trimLeft()}function h2e(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function p2e(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var CI,UW,VW,pv,SI,WW,GW,HW,B3=["times"];function qW(n,e,t,s,r){var a=4,o=KW;switch(r){case bs.API.image_compression.FAST:a=1,o=YW;break;case bs.API.image_compression.MEDIUM:a=6,o=XW;break;case bs.API.image_compression.SLOW:a=9,o=QW}n=(function(c,u,f,d){for(var h,p=c.length/u,g=new Uint8Array(c.length+p),b=[m2e,YW,KW,XW,QW],v=0;v<p;v+=1){var w=v*u,x=c.subarray(w,w+u);if(d)g.set(d(x,f,h),w+v);else{for(var S=b.length,C=[],M=0;M<S;M+=1)C[M]=b[M](x,f,h);var k=y2e(C.concat());g.set(C[k],w+v)}h=x}return g})(n,e,Math.ceil(t*s/8),o);var l=Jj(n,{level:a});return bs.API.__addimage__.arrayBufferToBinaryString(l)}function m2e(n){var e=Array.apply([],n);return e.unshift(0),e}function YW(n,e){var t=n.length,s=[];s[0]=1;for(var r=0;r<t;r+=1){var a=n[r-e]||0;s[r+1]=n[r]-a+256&255}return s}function KW(n,e,t){var s=n.length,r=[];r[0]=2;for(var a=0;a<s;a+=1){var o=t&&t[a]||0;r[a+1]=n[a]-o+256&255}return r}function XW(n,e,t){var s=n.length,r=[];r[0]=3;for(var a=0;a<s;a+=1){var o=n[a-e]||0,l=t&&t[a]||0;r[a+1]=n[a]+256-(o+l>>>1)&255}return r}function QW(n,e,t){var s=n.length,r=[];r[0]=4;for(var a=0;a<s;a+=1){var o=g2e(n[a-e]||0,t&&t[a]||0,t&&t[a-e]||0);r[a+1]=n[a]-o+256&255}return r}function g2e(n,e,t){if(n===e&&e===t)return n;var s=Math.abs(e-t),r=Math.abs(n-t),a=Math.abs(n+e-t-t);return s<=r&&s<=a?n:r<=a?e:t}function y2e(n){var e=n.map(function(t){return t.reduce(function(s,r){return s+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function U3(n,e,t){var s=e*t,r=Math.floor(s/8),a=16-(s-8*r+t),o=(1<<t)-1;return Yne(n,r)>>a&o}function JW(n,e,t,s){var r=t*s,a=Math.floor(r/8),o=16-(r-8*a+s),l=(1<<s)-1,c=(e&l)<<o;(function(u,f,d){if(f+1<u.byteLength)u.setUint16(f,d,!1);else{var h=d>>8&255;u.setUint8(f,h)}})(n,a,Yne(n,a)&~(l<<o)&65535|c)}function Yne(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function b2e(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,s=n[e++]|n[e++]<<8,r=n[e++],a=r>>7,o=1<<1+(7&r);n[e++],n[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var u=!0,f=[],d=0,h=null,p=0,g=null;for(this.width=t,this.height=s;u&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,g=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var b=n[e++];d=n[e++]|n[e++]<<8,h=n[e++],1&b||(h=null),p=b>>2&7,e++;break;case 254:for(;;){if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var v=n[e++]|n[e++]<<8,w=n[e++]|n[e++]<<8,x=n[e++]|n[e++]<<8,S=n[e++]|n[e++]<<8,C=n[e++],M=C>>6&1,k=1<<1+(7&C),E=l,I=c,A=!1;C>>7&&(A=!0,E=e,I=k,e+=3*k);var D=e;for(e++;;){var L;if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}f.push({x:v,y:w,width:x,height:S,has_local_palette:A,palette_offset:E,palette_size:I,data_offset:D,data_length:e-D,transparent_index:h,interlaced:!!M,delay:d,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return g},this.frameInfo=function(P){if(P<0||P>=f.length)throw new Error("Frame index out of range.");return f[P]},this.decodeAndBlitFrameBGRA=function(P,j){var G=this.frameInfo(P),Q=G.width*G.height,q=new Uint8Array(Q);ZW(n,G.data_offset,q,Q);var te=G.palette_offset,Z=G.transparent_index;Z===null&&(Z=256);var ne=G.width,le=t-ne,H=ne,R=4*(G.y*t+G.x),B=4*((G.y+G.height)*t+G.x),W=R,se=4*le;G.interlaced===!0&&(se+=4*t*7);for(var ue=8,ge=0,Ce=q.length;ge<Ce;++ge){var Se=q[ge];if(H===0&&(H=ne,(W+=se)>=B&&(se=4*le+4*t*(ue-1),W=R+(ne+le)*(ue<<1),ue>>=1)),Se===Z)W+=4;else{var Me=n[te+3*Se],pe=n[te+3*Se+1],fe=n[te+3*Se+2];j[W++]=fe,j[W++]=pe,j[W++]=Me,j[W++]=255}--H}},this.decodeAndBlitFrameRGBA=function(P,j){var G=this.frameInfo(P),Q=G.width*G.height,q=new Uint8Array(Q);ZW(n,G.data_offset,q,Q);var te=G.palette_offset,Z=G.transparent_index;Z===null&&(Z=256);var ne=G.width,le=t-ne,H=ne,R=4*(G.y*t+G.x),B=4*((G.y+G.height)*t+G.x),W=R,se=4*le;G.interlaced===!0&&(se+=4*t*7);for(var ue=8,ge=0,Ce=q.length;ge<Ce;++ge){var Se=q[ge];if(H===0&&(H=ne,(W+=se)>=B&&(se=4*le+4*t*(ue-1),W=R+(ne+le)*(ue<<1),ue>>=1)),Se===Z)W+=4;else{var Me=n[te+3*Se],pe=n[te+3*Se+1],fe=n[te+3*Se+2];j[W++]=Me,j[W++]=pe,j[W++]=fe,j[W++]=255}--H}}}function ZW(n,e,t,s){for(var r=n[e++],a=1<<r,o=a+1,l=o+1,c=r+1,u=(1<<c)-1,f=0,d=0,h=0,p=n[e++],g=new Int32Array(4096),b=null;;){for(;f<16&&p!==0;)d|=n[e++]<<f,f+=8,p===1?p=n[e++]:--p;if(f<c)break;var v=d&u;if(d>>=c,f-=c,v!==a){if(v===o)break;for(var w=v<l?v:b,x=0,S=w;S>a;)S=g[S]>>8,++x;var C=S;if(h+x+(w!==v?1:0)>s)return void ha.log("Warning, gif stream longer than expected.");t[h++]=C;var M=h+=x;for(w!==v&&(t[h++]=C),S=w;x--;)S=g[S],t[--M]=255&S,S>>=8;b!==null&&l<4096&&(g[l++]=b<<8|C,l>=u+1&&c<12&&(++c,u=u<<1|1)),b=v}else l=o+1,u=(1<<(c=r+1))-1,b=null}return h!==s&&ha.log("Warning, gif stream shorter than expected."),t}function V3(n){var e,t,s,r,a,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),d=new Array(65535),h=new Array(65535),p=new Array(64),g=new Array(64),b=[],v=0,w=7,x=new Array(64),S=new Array(64),C=new Array(64),M=new Array(256),k=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(R,B){for(var W=0,se=0,ue=new Array,ge=1;ge<=16;ge++){for(var Ce=1;Ce<=R[ge];Ce++)ue[B[se]]=[],ue[B[se]][0]=W,ue[B[se]][1]=ge,se++,W++;W*=2}return ue}function te(R){for(var B=R[0],W=R[1]-1;W>=0;)B&1<<W&&(v|=1<<w),W--,--w<0&&(v==255?(Z(255),Z(0)):Z(v),w=7,v=0)}function Z(R){b.push(R)}function ne(R){Z(R>>8&255),Z(255&R)}function le(R,B,W,se,ue){for(var ge,Ce=ue[0],Se=ue[240],Me=(function(Xe,Ke){var Ze,xt,dt,Ft,It,Bt,Gt,At,ht,Qt,Xt=0;for(ht=0;ht<8;++ht){Ze=Xe[Xt],xt=Xe[Xt+1],dt=Xe[Xt+2],Ft=Xe[Xt+3],It=Xe[Xt+4],Bt=Xe[Xt+5],Gt=Xe[Xt+6];var us=Ze+(At=Xe[Xt+7]),yn=Ze-At,En=xt+Gt,Vn=xt-Gt,Nn=dt+Bt,Dn=dt-Bt,gr=Ft+It,os=Ft-It,ps=us+gr,Ss=us-gr,Qn=En+Nn,On=En-Nn;Xe[Xt]=ps+Qn,Xe[Xt+4]=ps-Qn;var Mt=.707106781*(On+Ss);Xe[Xt+2]=Ss+Mt,Xe[Xt+6]=Ss-Mt;var sn=.382683433*((ps=os+Dn)-(On=Vn+yn)),Tn=.5411961*ps+sn,ai=1.306562965*On+sn,ir=.707106781*(Qn=Dn+Vn),Fn=yn+ir,fs=yn-ir;Xe[Xt+5]=fs+Tn,Xe[Xt+3]=fs-Tn,Xe[Xt+1]=Fn+ai,Xe[Xt+7]=Fn-ai,Xt+=8}for(Xt=0,ht=0;ht<8;++ht){Ze=Xe[Xt],xt=Xe[Xt+8],dt=Xe[Xt+16],Ft=Xe[Xt+24],It=Xe[Xt+32],Bt=Xe[Xt+40],Gt=Xe[Xt+48];var ro=Ze+(At=Xe[Xt+56]),re=Ze-At,Pe=xt+Gt,ve=xt-Gt,Oe=dt+Bt,ze=dt-Bt,ut=Ft+It,Et=Ft-It,rn=ro+ut,xn=ro-ut,un=Pe+Oe,Gn=Pe-Oe;Xe[Xt]=rn+un,Xe[Xt+32]=rn-un;var hn=.707106781*(Gn+xn);Xe[Xt+16]=xn+hn,Xe[Xt+48]=xn-hn;var vs=.382683433*((rn=Et+ze)-(Gn=ve+re)),_s=.5411961*rn+vs,Vr=1.306562965*Gn+vs,Yr=.707106781*(un=ze+ve),Cr=re+Yr,Kr=re-Yr;Xe[Xt+40]=Kr+_s,Xe[Xt+24]=Kr-_s,Xe[Xt+8]=Cr+Vr,Xe[Xt+56]=Cr-Vr,Xt++}for(ht=0;ht<64;++ht)Qt=Xe[ht]*Ke[ht],p[ht]=Qt>0?Qt+.5|0:Qt-.5|0;return p})(R,B),pe=0;pe<64;++pe)g[E[pe]]=Me[pe];var fe=g[0]-W;W=g[0],fe==0?te(se[0]):(te(se[h[ge=32767+fe]]),te(d[ge]));for(var $e=63;$e>0&&g[$e]==0;)$e--;if($e==0)return te(Ce),W;for(var We,de=1;de<=$e;){for(var Be=de;g[de]==0&&de<=$e;)++de;var st=de-Be;if(st>=16){We=st>>4;for(var He=1;He<=We;++He)te(Se);st&=15}ge=32767+g[de],te(ue[(st<<4)+h[ge]]),te(d[ge]),de++}return $e!=63&&te(Ce),W}function H(R){R=Math.min(Math.max(R,1),100),a!=R&&((function(B){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var ue=o((W[se]*B+50)/100);ue=Math.min(Math.max(ue,1),255),l[E[se]]=ue}for(var ge=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ce=0;Ce<64;Ce++){var Se=o((ge[Ce]*B+50)/100);Se=Math.min(Math.max(Se,1),255),c[E[Ce]]=Se}for(var Me=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],pe=0,fe=0;fe<8;fe++)for(var $e=0;$e<8;$e++)u[pe]=1/(l[E[pe]]*Me[fe]*Me[$e]*8),f[pe]=1/(c[E[pe]]*Me[fe]*Me[$e]*8),pe++})(R<50?Math.floor(5e3/R):Math.floor(200-2*R)),a=R)}this.encode=function(R,B){B&&H(B),b=new Array,v=0,w=7,ne(65496),ne(65504),ne(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),ne(1),ne(1),Z(0),Z(0),(function(){ne(65499),ne(132),Z(0);for(var xt=0;xt<64;xt++)Z(l[xt]);Z(1);for(var dt=0;dt<64;dt++)Z(c[dt])})(),(function(xt,dt){ne(65472),ne(17),Z(8),ne(dt),ne(xt),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)})(R.width,R.height),(function(){ne(65476),ne(418),Z(0);for(var xt=0;xt<16;xt++)Z(I[xt+1]);for(var dt=0;dt<=11;dt++)Z(A[dt]);Z(16);for(var Ft=0;Ft<16;Ft++)Z(D[Ft+1]);for(var It=0;It<=161;It++)Z(L[It]);Z(1);for(var Bt=0;Bt<16;Bt++)Z(P[Bt+1]);for(var Gt=0;Gt<=11;Gt++)Z(j[Gt]);Z(17);for(var At=0;At<16;At++)Z(G[At+1]);for(var ht=0;ht<=161;ht++)Z(Q[ht])})(),ne(65498),ne(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0);var W=0,se=0,ue=0;v=0,w=7,this.encode.displayName="_encode_";for(var ge,Ce,Se,Me,pe,fe,$e,We,de,Be=R.data,st=R.width,He=R.height,Xe=4*st,Ke=0;Ke<He;){for(ge=0;ge<Xe;){for(pe=Xe*Ke+ge,$e=-1,We=0,de=0;de<64;de++)fe=pe+(We=de>>3)*Xe+($e=4*(7&de)),Ke+We>=He&&(fe-=Xe*(Ke+1+We-He)),ge+$e>=Xe&&(fe-=ge+$e-Xe+4),Ce=Be[fe++],Se=Be[fe++],Me=Be[fe++],x[de]=(k[Ce]+k[Se+256|0]+k[Me+512|0]>>16)-128,S[de]=(k[Ce+768|0]+k[Se+1024|0]+k[Me+1280|0]>>16)-128,C[de]=(k[Ce+1280|0]+k[Se+1536|0]+k[Me+1792|0]>>16)-128;W=le(x,u,W,e,s),se=le(S,f,se,t,r),ue=le(C,f,ue,t,r),ge+=32}Ke+=8}if(w>=0){var Ze=[];Ze[1]=w+1,Ze[0]=(1<<w+1)-1,te(Ze)}return ne(65497),new Uint8Array(b)},n=n||50,(function(){for(var R=String.fromCharCode,B=0;B<256;B++)M[B]=R(B)})(),e=q(I,A),t=q(P,j),s=q(D,L),r=q(G,Q),(function(){for(var R=1,B=2,W=1;W<=15;W++){for(var se=R;se<B;se++)h[32767+se]=W,d[32767+se]=[],d[32767+se][1]=W,d[32767+se][0]=se;for(var ue=-(B-1);ue<=-R;ue++)h[32767+ue]=W,d[32767+ue]=[],d[32767+ue][1]=W,d[32767+ue][0]=B-1+ue;R<<=1,B<<=1}})(),(function(){for(var R=0;R<256;R++)k[R]=19595*R,k[R+256|0]=38470*R,k[R+512|0]=7471*R+32768,k[R+768|0]=-11059*R,k[R+1024|0]=-21709*R,k[R+1280|0]=32768*R+8421375,k[R+1536|0]=-27439*R,k[R+1792|0]=-5329*R})(),H(n)}function Bh(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function eG(n){function e(A){if(!A)throw Error("assert :P")}function t(A,D,L){for(var P=0;4>P;P++)if(A[D+P]!=L.charCodeAt(P))return!0;return!1}function s(A,D,L,P,j){for(var G=0;G<j;G++)A[D+G]=L[P+G]}function r(A,D,L,P){for(var j=0;j<P;j++)A[D+j]=L}function a(A){return new Int32Array(A)}function o(A,D){for(var L=[],P=0;P<A;P++)L.push(new D);return L}function l(A,D){var L=[];return(function P(j,G,Q){for(var q=Q[G],te=0;te<q&&(j.push(Q.length>G+1?[]:new D),!(Q.length<G+1));te++)P(j[te],G+1,Q)})(L,0,A),L}var c=function(){var A=this;function D(N,$){for(var J=1<<$-1>>>0;N&J;)J>>>=1;return J?(N&J-1)+J:N}function L(N,$,J,ie,ye){e(!(ie%J));do N[$+(ie-=J)]=ye;while(0<ie)}function P(N,$,J,ie,ye){if(e(2328>=ye),512>=ye)var _e=a(512);else if((_e=a(ye))==null)return 0;return(function(xe,Ae,De,Re,tt,St){var je,ct,gt=Ae,Ut=1<<De,_t=a(16),zt=a(16);for(e(tt!=0),e(Re!=null),e(xe!=null),e(0<De),ct=0;ct<tt;++ct){if(15<Re[ct])return 0;++_t[Re[ct]]}if(_t[0]==tt)return 0;for(zt[1]=0,je=1;15>je;++je){if(_t[je]>1<<je)return 0;zt[je+1]=zt[je]+_t[je]}for(ct=0;ct<tt;++ct)je=Re[ct],0<Re[ct]&&(St[zt[je]++]=ct);if(zt[15]==1)return(Re=new j).g=0,Re.value=St[0],L(xe,gt,1,Ut,Re),Ut;var Yt,dn=-1,en=Ut-1,Yn=0,jn=1,Ds=1,Wn=1<<De;for(ct=0,je=1,tt=2;je<=De;++je,tt<<=1){if(jn+=Ds<<=1,0>(Ds-=_t[je]))return 0;for(;0<_t[je];--_t[je])(Re=new j).g=je,Re.value=St[ct++],L(xe,gt+Yn,tt,Wn,Re),Yn=D(Yn,je)}for(je=De+1,tt=2;15>=je;++je,tt<<=1){if(jn+=Ds<<=1,0>(Ds-=_t[je]))return 0;for(;0<_t[je];--_t[je]){if(Re=new j,(Yn&en)!=dn){for(gt+=Wn,Yt=1<<(dn=je)-De;15>dn&&!(0>=(Yt-=_t[dn]));)++dn,Yt<<=1;Ut+=Wn=1<<(Yt=dn-De),xe[Ae+(dn=Yn&en)].g=Yt+De,xe[Ae+dn].value=gt-Ae-dn}Re.g=je-De,Re.value=St[ct++],L(xe,gt+(Yn>>De),tt,Wn,Re),Yn=D(Yn,je)}}return jn!=2*zt[15]-1?0:Ut})(N,$,J,ie,ye,_e)}function j(){this.value=this.g=0}function G(){this.value=this.g=0}function Q(){this.G=o(5,j),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Mc,G)}function q(N,$,J,ie){e(N!=null),e($!=null),e(2147483648>ie),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=$,N.pa=J,N.Jd=$,N.Yc=J+ie,N.Zc=4<=ie?J+ie-4+1:J,Ce(N)}function te(N,$){for(var J=0;0<$--;)J|=Me(N,128)<<$;return J}function Z(N,$){var J=te(N,$);return Se(N)?-J:J}function ne(N,$,J,ie){var ye,_e=0;for(e(N!=null),e($!=null),e(4294967288>ie),N.Sb=ie,N.Ra=0,N.u=0,N.h=0,4<ie&&(ie=4),ye=0;ye<ie;++ye)_e+=$[J+ye]<<8*ye;N.Ra=_e,N.bb=ie,N.oa=$,N.pa=J}function le(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<Pn-8>>>0,++N.bb,N.u-=8;se(N)&&(N.h=1,N.u=0)}function H(N,$){if(e(0<=$),!N.h&&$<=Aa){var J=W(N)&vo[$];return N.u+=$,le(N),J}return N.h=1,N.u=0}function R(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function B(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(N){return N.Ra>>>(N.u&Pn-1)>>>0}function se(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>Pn}function ue(N,$){N.u=$,N.h=se(N)}function ge(N){N.u>=Tc&&(e(N.u>=Tc),le(N))}function Ce(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function Se(N){return te(N,1)}function Me(N,$){var J=N.Ca;0>N.b&&Ce(N);var ie=N.b,ye=J*$>>>8,_e=(N.I>>>ie>ye)+0;for(_e?(J-=ye,N.I-=ye+1<<ie>>>0):J=ye+1,ie=J,ye=0;256<=ie;)ye+=8,ie>>=8;return ie=7^ye+kc[ie],N.b-=ie,N.Ca=(J<<ie)-1,_e}function pe(N,$,J){N[$+0]=J>>24&255,N[$+1]=J>>16&255,N[$+2]=J>>8&255,N[$+3]=255&J}function fe(N,$){return N[$+0]|N[$+1]<<8}function $e(N,$){return fe(N,$)|N[$+2]<<16}function We(N,$){return fe(N,$)|fe(N,$+2)<<16}function de(N,$){var J=1<<$;return e(N!=null),e(0<$),N.X=a(J),N.X==null?0:(N.Mb=32-$,N.Xa=$,1)}function Be(N,$){e(N!=null),e($!=null),e(N.Xa==$.Xa),s($.X,0,N.X,0,1<<$.Xa)}function st(){this.X=[],this.Xa=this.Mb=0}function He(N,$,J,ie){e(J!=null),e(ie!=null);var ye=J[0],_e=ie[0];return ye==0&&(ye=(N*_e+$/2)/$),_e==0&&(_e=($*ye+N/2)/N),0>=ye||0>=_e?0:(J[0]=ye,ie[0]=_e,1)}function Xe(N,$){return N+(1<<$)-1>>>$}function Ke(N,$){return((4278255360&N)+(4278255360&$)>>>0&4278255360)+((16711935&N)+(16711935&$)>>>0&16711935)>>>0}function Ze(N,$){A[$]=function(J,ie,ye,_e,xe,Ae,De){var Re;for(Re=0;Re<xe;++Re){var tt=A[N](Ae[De+Re-1],ye,_e+Re);Ae[De+Re]=Ke(J[ie+Re],tt)}}}function xt(){this.ud=this.hd=this.jd=0}function dt(N,$){return((4278124286&(N^$))>>>1)+(N&$)>>>0}function Ft(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function It(N,$){return Ft(N+(N-$+.5>>1))}function Bt(N,$,J){return Math.abs($-J)-Math.abs(N-J)}function Gt(N,$,J,ie,ye,_e,xe){for(ie=_e[xe-1],J=0;J<ye;++J)_e[xe+J]=ie=Ke(N[$+J],ie)}function At(N,$,J,ie,ye){var _e;for(_e=0;_e<J;++_e){var xe=N[$+_e],Ae=xe>>8&255,De=16711935&(De=(De=16711935&xe)+((Ae<<16)+Ae));ie[ye+_e]=(4278255360&xe)+De>>>0}}function ht(N,$){$.jd=255&N,$.hd=N>>8&255,$.ud=N>>16&255}function Qt(N,$,J,ie,ye,_e){var xe;for(xe=0;xe<ie;++xe){var Ae=$[J+xe],De=Ae>>>8,Re=Ae,tt=255&(tt=(tt=Ae>>>16)+((N.jd<<24>>24)*(De<<24>>24)>>>5));Re=255&(Re=(Re+=(N.hd<<24>>24)*(De<<24>>24)>>>5)+((N.ud<<24>>24)*(tt<<24>>24)>>>5)),ye[_e+xe]=(4278255360&Ae)+(tt<<16)+Re}}function Xt(N,$,J,ie,ye){A[$]=function(_e,xe,Ae,De,Re,tt,St,je,ct){for(De=St;De<je;++De)for(St=0;St<ct;++St)Re[tt++]=ye(Ae[ie(_e[xe++])])},A[N]=function(_e,xe,Ae,De,Re,tt,St){var je=8>>_e.b,ct=_e.Ea,gt=_e.K[0],Ut=_e.w;if(8>je)for(_e=(1<<_e.b)-1,Ut=(1<<je)-1;xe<Ae;++xe){var _t,zt=0;for(_t=0;_t<ct;++_t)_t&_e||(zt=ie(De[Re++])),tt[St++]=ye(gt[zt&Ut]),zt>>=je}else A["VP8LMapColor"+J](De,Re,gt,Ut,tt,St,xe,Ae,ct)}}function us(N,$,J,ie,ye){for(J=$+J;$<J;){var _e=N[$++];ie[ye++]=_e>>16&255,ie[ye++]=_e>>8&255,ie[ye++]=255&_e}}function yn(N,$,J,ie,ye){for(J=$+J;$<J;){var _e=N[$++];ie[ye++]=_e>>16&255,ie[ye++]=_e>>8&255,ie[ye++]=255&_e,ie[ye++]=_e>>24&255}}function En(N,$,J,ie,ye){for(J=$+J;$<J;){var _e=(xe=N[$++])>>16&240|xe>>12&15,xe=240&xe|xe>>28&15;ie[ye++]=_e,ie[ye++]=xe}}function Vn(N,$,J,ie,ye){for(J=$+J;$<J;){var _e=(xe=N[$++])>>16&248|xe>>13&7,xe=xe>>5&224|xe>>3&31;ie[ye++]=_e,ie[ye++]=xe}}function Nn(N,$,J,ie,ye){for(J=$+J;$<J;){var _e=N[$++];ie[ye++]=255&_e,ie[ye++]=_e>>8&255,ie[ye++]=_e>>16&255}}function Dn(N,$,J,ie,ye,_e){if(_e==0)for(J=$+J;$<J;)pe(ie,((_e=N[$++])[0]>>24|_e[1]>>8&65280|_e[2]<<8&16711680|_e[3]<<24)>>>0),ye+=32;else s(ie,ye,N,$,J)}function gr(N,$){A[$][0]=A[N+"0"],A[$][1]=A[N+"1"],A[$][2]=A[N+"2"],A[$][3]=A[N+"3"],A[$][4]=A[N+"4"],A[$][5]=A[N+"5"],A[$][6]=A[N+"6"],A[$][7]=A[N+"7"],A[$][8]=A[N+"8"],A[$][9]=A[N+"9"],A[$][10]=A[N+"10"],A[$][11]=A[N+"11"],A[$][12]=A[N+"12"],A[$][13]=A[N+"13"],A[$][14]=A[N+"0"],A[$][15]=A[N+"0"]}function os(N){return N==Lp||N==Wm||N==Pd||N==Gm}function ps(){this.eb=[],this.size=this.A=this.fb=0}function Ss(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Qn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ps,this.f.kb=new Ss,this.sd=null}function On(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function sn(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Tn(N,$){var J=N.T,ie=$.ba.f.RGBA,ye=ie.eb,_e=ie.fb+N.ka*ie.A,xe=So[$.ba.S],Ae=N.y,De=N.O,Re=N.f,tt=N.N,St=N.ea,je=N.W,ct=$.cc,gt=$.dc,Ut=$.Mc,_t=$.Nc,zt=N.ka,Yt=N.ka+N.T,dn=N.U,en=dn+1>>1;for(zt==0?xe(Ae,De,null,null,Re,tt,St,je,Re,tt,St,je,ye,_e,null,null,dn):(xe($.ec,$.fc,Ae,De,ct,gt,Ut,_t,Re,tt,St,je,ye,_e-ie.A,ye,_e,dn),++J);zt+2<Yt;zt+=2)ct=Re,gt=tt,Ut=St,_t=je,tt+=N.Rc,je+=N.Rc,_e+=2*ie.A,xe(Ae,(De+=2*N.fa)-N.fa,Ae,De,ct,gt,Ut,_t,Re,tt,St,je,ye,_e-ie.A,ye,_e,dn);return De+=N.fa,N.j+Yt<N.o?(s($.ec,$.fc,Ae,De,dn),s($.cc,$.dc,Re,tt,en),s($.Mc,$.Nc,St,je,en),J--):1&Yt||xe(Ae,De,null,null,Re,tt,St,je,Re,tt,St,je,ye,_e+ie.A,null,null,dn),J}function ai(N,$,J){var ie=N.F,ye=[N.J];if(ie!=null){var _e=N.U,xe=$.ba.S,Ae=xe==Ap||xe==Pd;$=$.ba.f.RGBA;var De=[0],Re=N.ka;De[0]=N.T,N.Kb&&(Re==0?--De[0]:(--Re,ye[0]-=N.width),N.j+N.ka+N.T==N.o&&(De[0]=N.o-N.j-Re));var tt=$.eb;Re=$.fb+Re*$.A,N=Lc(ie,ye[0],N.width,_e,De,tt,Re+(Ae?0:3),$.A),e(J==De),N&&os(xe)&&sr(tt,Re,Ae,_e,De,$.A)}return 0}function ir(N){var $=N.ma,J=$.ba.S,ie=11>J,ye=J==Uo||J==ec||J==Ap||J==kh||J==12||os(J);if($.memory=null,$.Ib=null,$.Jb=null,$.Nd=null,!Sc($.Oa,N,ye?11:12))return 0;if(ye&&os(J)&&Dd(),N.da)alert("todo:use_scaling");else{if(ie){if($.Ib=sn,N.Kb){if(J=N.U+1>>1,$.memory=a(N.U+2*J),$.memory==null)return 0;$.ec=$.memory,$.fc=0,$.cc=$.ec,$.dc=$.fc+N.U,$.Mc=$.cc,$.Nc=$.dc+J,$.Ib=Tn,Dd()}}else alert("todo:EmitYUV");ye&&($.Jb=ai,ie&&ol())}if(ie&&!Vf){for(N=0;256>N;++N)Mo[N]=89858*(N-128)+Ah>>jc,yw[N]=-22014*(N-128)+Ah,R1[N]=-45773*(N-128),Op[N]=113618*(N-128)+Ah>>jc;for(N=Bf;N<Uf;++N)$=76283*(N-16)+Ah>>jc,F1[N-Bf]=va($,255),bw[N-Bf]=va($+8>>4,15);Vf=1}return 1}function Fn(N){var $=N.ma,J=N.U,ie=N.T;return e(!(1&N.ka)),0>=J||0>=ie?0:(J=$.Ib(N,$),$.Jb!=null&&$.Jb(N,$,J),$.Dc+=J,1)}function fs(N){N.ma.memory=null}function ro(N,$,J,ie){return H(N,8)!=47?0:($[0]=H(N,14)+1,J[0]=H(N,14)+1,ie[0]=H(N,1),H(N,3)!=0?0:!N.h)}function re(N,$){if(4>N)return N+1;var J=N-2>>1;return(2+(1&N)<<J)+H($,J)+1}function Pe(N,$){return 120<$?$-120:1<=(J=((J=Dc[$-1])>>4)*N+(8-(15&J)))?J:1;var J}function ve(N,$,J){var ie=W(J),ye=N[$+=255&ie].g-8;return 0<ye&&(ue(J,J.u+8),ie=W(J),$+=N[$].value,$+=ie&(1<<ye)-1),ue(J,J.u+N[$].g),N[$].value}function Oe(N,$,J){return J.g+=N.g,J.value+=N.value<<$>>>0,e(8>=J.g),N.g}function ze(N,$,J){var ie=N.xc;return e(($=ie==0?0:N.vc[N.md*(J>>ie)+($>>ie)])<N.Wb),N.Ya[$]}function ut(N,$,J,ie){var ye=N.ab,_e=N.c*$,xe=N.C;$=xe+$;var Ae=J,De=ie;for(ie=N.Ta,J=N.Ua;0<ye--;){var Re=N.gc[ye],tt=xe,St=$,je=Ae,ct=De,gt=(De=ie,Ae=J,Re.Ea);switch(e(tt<St),e(St<=Re.nc),Re.hc){case 2:Dr(je,ct,(St-tt)*gt,De,Ae);break;case 0:var Ut=tt,_t=St,zt=De,Yt=Ae,dn=(Wn=Re).Ea;Ut==0&&(Qc(je,ct,null,null,1,zt,Yt),Gt(je,ct+1,0,0,dn-1,zt,Yt+1),ct+=dn,Yt+=dn,++Ut);for(var en=1<<Wn.b,Yn=en-1,jn=Xe(dn,Wn.b),Ds=Wn.K,Wn=Wn.w+(Ut>>Wn.b)*jn;Ut<_t;){var ar=Ds,Pi=Wn,Fs=1;for(Jc(je,ct,zt,Yt-dn,1,zt,Yt);Fs<dn;){var $n=(Fs&~Yn)+en;$n>dn&&($n=dn),(0,Jl[ar[Pi++]>>8&15])(je,ct+ +Fs,zt,Yt+Fs-dn,$n-Fs,zt,Yt+Fs),Fs=$n}ct+=dn,Yt+=dn,++Ut&Yn||(Wn+=jn)}St!=Re.nc&&s(De,Ae-gt,De,Ae+(St-tt-1)*gt,gt);break;case 1:for(gt=je,_t=ct,dn=(je=Re.Ea)-(Yt=je&~(zt=(ct=1<<Re.b)-1)),Ut=Xe(je,Re.b),en=Re.K,Re=Re.w+(tt>>Re.b)*Ut;tt<St;){for(Yn=en,jn=Re,Ds=new xt,Wn=_t+Yt,ar=_t+je;_t<Wn;)ht(Yn[jn++],Ds),Eu(Ds,gt,_t,ct,De,Ae),_t+=ct,Ae+=ct;_t<ar&&(ht(Yn[jn++],Ds),Eu(Ds,gt,_t,dn,De,Ae),_t+=dn,Ae+=dn),++tt&zt||(Re+=Ut)}break;case 3:if(je==De&&ct==Ae&&0<Re.b){for(_t=De,je=gt=Ae+(St-tt)*gt-(Yt=(St-tt)*Xe(Re.Ea,Re.b)),ct=De,zt=Ae,Ut=[],Yt=(dn=Yt)-1;0<=Yt;--Yt)Ut[Yt]=ct[zt+Yt];for(Yt=dn-1;0<=Yt;--Yt)_t[je+Yt]=Ut[Yt];nf(Re,tt,St,De,gt,De,Ae)}else nf(Re,tt,St,je,ct,De,Ae)}Ae=ie,De=J}De!=J&&s(ie,J,Ae,De,_e)}function Et(N,$){var J=N.V,ie=N.Ba+N.c*N.C,ye=$-N.C;if(e($<=N.l.o),e(16>=ye),0<ye){var _e=N.l,xe=N.Ta,Ae=N.Ua,De=_e.width;if(ut(N,ye,J,ie),ye=Ae=[Ae],e((J=N.C)<(ie=$)),e(_e.v<_e.va),ie>_e.o&&(ie=_e.o),J<_e.j){var Re=_e.j-J;J=_e.j,ye[0]+=Re*De}if(J>=ie?J=0:(ye[0]+=4*_e.v,_e.ka=J-_e.j,_e.U=_e.va-_e.v,_e.T=ie-J,J=1),J){if(Ae=Ae[0],11>(J=N.ca).S){var tt=J.f.RGBA,St=(ie=J.S,ye=_e.U,_e=_e.T,Re=tt.eb,tt.A),je=_e;for(tt=tt.fb+N.Ma*tt.A;0<je--;){var ct=xe,gt=Ae,Ut=ye,_t=Re,zt=tt;switch(ie){case Ip:sf(ct,gt,Ut,_t,zt);break;case Uo:Zl(ct,gt,Ut,_t,zt);break;case Lp:Zl(ct,gt,Ut,_t,zt),sr(_t,zt,0,Ut,1,0);break;case Vm:Ic(ct,gt,Ut,_t,zt);break;case ec:Dn(ct,gt,Ut,_t,zt,1);break;case Wm:Dn(ct,gt,Ut,_t,zt,1),sr(_t,zt,0,Ut,1,0);break;case Ap:Dn(ct,gt,Ut,_t,zt,0);break;case Pd:Dn(ct,gt,Ut,_t,zt,0),sr(_t,zt,1,Ut,1,0);break;case kh:Ec(ct,gt,Ut,_t,zt);break;case Gm:Ec(ct,gt,Ut,_t,zt),zr(_t,zt,Ut,1,0);break;case af:cl(ct,gt,Ut,_t,zt);break;default:e(0)}Ae+=De,tt+=St}N.Ma+=_e}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=J.height)}}N.C=$,e(N.C<=N.i)}function rn(N){var $;if(0<N.ua)return 0;for($=0;$<N.Wb;++$){var J=N.Ya[$].G,ie=N.Ya[$].H;if(0<J[1][ie[1]+0].g||0<J[2][ie[2]+0].g||0<J[3][ie[3]+0].g)return 0}return 1}function xn(N,$,J,ie,ye,_e){if(N.Z!=0){var xe=N.qd,Ae=N.rd;for(e(lf[N.Z]!=null);$<J;++$)lf[N.Z](xe,Ae,ie,ye,ie,ye,_e),xe=ie,Ae=ye,ye+=_e;N.qd=xe,N.rd=Ae}}function un(N,$){var J=N.l.ma,ie=J.Z==0||J.Z==1?N.l.j:N.C;if(ie=N.C<ie?ie:N.C,e($<=N.l.o),$>ie){var ye=N.l.width,_e=J.ca,xe=J.tb+ye*ie,Ae=N.V,De=N.Ba+N.c*ie,Re=N.gc;e(N.ab==1),e(Re[0].hc==3),Ql(Re[0],ie,$,Ae,De,_e,xe),xn(J,ie,$,_e,xe,ye)}N.C=N.Ma=$}function Gn(N,$,J,ie,ye,_e,xe){var Ae=N.$/ie,De=N.$%ie,Re=N.m,tt=N.s,St=J+N.$,je=St;ye=J+ie*ye;var ct=J+ie*_e,gt=280+tt.ua,Ut=N.Pb?Ae:16777216,_t=0<tt.ua?tt.Wa:null,zt=tt.wc,Yt=St<ct?ze(tt,De,Ae):null;e(N.C<_e),e(ct<=ye);var dn=!1;e:for(;;){for(;dn||St<ct;){var en=0;if(Ae>=Ut){var Yn=St-J;e((Ut=N).Pb),Ut.wd=Ut.m,Ut.xd=Yn,0<Ut.s.ua&&Be(Ut.s.Wa,Ut.s.vb),Ut=Ae+of}if(De&zt||(Yt=ze(tt,De,Ae)),e(Yt!=null),Yt.Qb&&($[St]=Yt.qb,dn=!0),!dn)if(ge(Re),Yt.jc){en=Re,Yn=$;var jn=St,Ds=Yt.pd[W(en)&Mc-1];e(Yt.jc),256>Ds.g?(ue(en,en.u+Ds.g),Yn[jn]=Ds.value,en=0):(ue(en,en.u+Ds.g-256),e(256<=Ds.value),en=Ds.value),en==0&&(dn=!0)}else en=ve(Yt.G[0],Yt.H[0],Re);if(Re.h)break;if(dn||256>en){if(!dn)if(Yt.nd)$[St]=(Yt.qb|en<<8)>>>0;else{if(ge(Re),dn=ve(Yt.G[1],Yt.H[1],Re),ge(Re),Yn=ve(Yt.G[2],Yt.H[2],Re),jn=ve(Yt.G[3],Yt.H[3],Re),Re.h)break;$[St]=(jn<<24|dn<<16|en<<8|Yn)>>>0}if(dn=!1,++St,++De>=ie&&(De=0,++Ae,xe!=null&&Ae<=_e&&!(Ae%16)&&xe(N,Ae),_t!=null))for(;je<St;)en=$[je++],_t.X[(506832829*en&4294967295)>>>_t.Mb]=en}else if(280>en){if(en=re(en-256,Re),Yn=ve(Yt.G[4],Yt.H[4],Re),ge(Re),Yn=Pe(ie,Yn=re(Yn,Re)),Re.h)break;if(St-J<Yn||ye-St<en)break e;for(jn=0;jn<en;++jn)$[St+jn]=$[St+jn-Yn];for(St+=en,De+=en;De>=ie;)De-=ie,++Ae,xe!=null&&Ae<=_e&&!(Ae%16)&&xe(N,Ae);if(e(St<=ye),De&zt&&(Yt=ze(tt,De,Ae)),_t!=null)for(;je<St;)en=$[je++],_t.X[(506832829*en&4294967295)>>>_t.Mb]=en}else{if(!(en<gt))break e;for(dn=en-280,e(_t!=null);je<St;)en=$[je++],_t.X[(506832829*en&4294967295)>>>_t.Mb]=en;en=St,e(!(dn>>>(Yn=_t).Xa)),$[en]=Yn.X[dn],dn=!0}dn||e(Re.h==se(Re))}if(N.Pb&&Re.h&&St<ye)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&Be(N.s.vb,N.s.Wa);else{if(Re.h)break e;xe?.(N,Ae>_e?_e:Ae),N.a=0,N.$=St-J}return 1}return N.a=3,0}function hn(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var $=N.Wa;$!=null&&($.X=null),N.vb=null,e(N!=null)}function vs(){var N=new xs;return N==null?null:(N.a=0,N.xb=qm,gr("Predictor","VP8LPredictors"),gr("Predictor","VP8LPredictors_C"),gr("PredictorAdd","VP8LPredictorsAdd"),gr("PredictorAdd","VP8LPredictorsAdd_C"),Dr=At,Eu=Qt,sf=us,Zl=yn,Ec=En,cl=Vn,Ic=Nn,A.VP8LMapColor32b=ll,A.VP8LMapColor8b=La,N)}function _s(N,$,J,ie,ye){var _e=1,xe=[N],Ae=[$],De=ie.m,Re=ie.s,tt=null,St=0;e:for(;;){if(J)for(;_e&&H(De,1);){var je=xe,ct=Ae,gt=ie,Ut=1,_t=gt.m,zt=gt.gc[gt.ab],Yt=H(_t,2);if(gt.Oc&1<<Yt)_e=0;else{switch(gt.Oc|=1<<Yt,zt.hc=Yt,zt.Ea=je[0],zt.nc=ct[0],zt.K=[null],++gt.ab,e(4>=gt.ab),Yt){case 0:case 1:zt.b=H(_t,3)+2,Ut=_s(Xe(zt.Ea,zt.b),Xe(zt.nc,zt.b),0,gt,zt.K),zt.K=zt.K[0];break;case 3:var dn,en=H(_t,8)+1,Yn=16<en?0:4<en?1:2<en?2:3;if(je[0]=Xe(zt.Ea,Yn),zt.b=Yn,dn=Ut=_s(en,1,0,gt,zt.K)){var jn,Ds=en,Wn=zt,ar=1<<(8>>Wn.b),Pi=a(ar);if(Pi==null)dn=0;else{var Fs=Wn.K[0],$n=Wn.w;for(Pi[0]=Wn.K[0][0],jn=1;jn<1*Ds;++jn)Pi[jn]=Ke(Fs[$n+jn],Pi[jn-1]);for(;jn<4*ar;++jn)Pi[jn]=0;Wn.K[0]=null,Wn.K[0]=Pi,dn=1}}Ut=dn;break;case 2:break;default:e(0)}_e=Ut}}if(xe=xe[0],Ae=Ae[0],_e&&H(De,1)&&!(_e=1<=(St=H(De,4))&&11>=St)){ie.a=3;break e}var Sn;if(Sn=_e)t:{var Ji,Cs,Vs,Zr=ie,Da=xe,To=Ae,Ti=St,Ca=J,Vo=Zr.m,Oa=Zr.s,Ys=[null],Or=1,Zi=0,Mr=Oc[Ti];n:for(;;){if(Ca&&H(Vo,1)){var qa=H(Vo,3)+2,ea=Xe(Da,qa),Tr=Xe(To,qa),oa=ea*Tr;if(!_s(ea,Tr,0,Zr,Ys))break n;for(Ys=Ys[0],Oa.xc=qa,Ji=0;Ji<oa;++Ji){var ei=Ys[Ji]>>8&65535;Ys[Ji]=ei,ei>=Or&&(Or=ei+1)}}if(Vo.h)break n;for(Cs=0;5>Cs;++Cs){var Sa=jd[Cs];!Cs&&0<Ti&&(Sa+=1<<Ti),Zi<Sa&&(Zi=Sa)}var Pa=o(Or*Mr,j),yi=Or,or=o(yi,Q);if(or==null)var ko=null;else e(65536>=yi),ko=or;var la=a(Zi);if(ko==null||la==null||Pa==null){Zr.a=1;break n}var ms=Pa;for(Ji=Vs=0;Ji<Or;++Ji){var ys=ko[Ji],kr=ys.G,Al=ys.H,Rc=0,hl=1,Ma=0;for(Cs=0;5>Cs;++Cs){Sa=jd[Cs],kr[Cs]=ms,Al[Cs]=Vs,!Cs&&0<Ti&&(Sa+=1<<Ti);r:{var Wf,Gf=Sa,Rp=Zr,ki=la,s0=ms,r0=Vs,Fp=0,uf=Rp.m,ww=H(uf,1);if(r(ki,0,0,Gf),ww){var Km=H(uf,1)+1,i0=H(uf,1),Xm=H(uf,i0==0?1:8);ki[Xm]=1,Km==2&&(ki[Xm=H(uf,8)]=1);var Ya=1}else{var ca=a(19),zp=H(uf,4)+4;if(19<zp){Rp.a=3;var Au=0;break r}for(Wf=0;Wf<zp;++Wf)ca[Eh[Wf]]=H(uf,3);var Lh=void 0,Fd=void 0,Lu=Rp,Bp=ca,Nh=Gf,Qm=ki,Up=0,ff=Lu.m,a0=8,o0=o(128,j);s:for(;P(o0,0,7,Bp,19);){if(H(ff,1)){var z1=2+2*H(ff,3);if((Lh=2+H(ff,z1))>Nh)break s}else Lh=Nh;for(Fd=0;Fd<Nh&&Lh--;){ge(ff);var Vp=o0[0+(127&W(ff))];ue(ff,ff.u+Vp.g);var Hf=Vp.value;if(16>Hf)Qm[Fd++]=Hf,Hf!=0&&(a0=Hf);else{var B1=Hf==16,U1=Hf-16,V1=$d[U1],l0=H(ff,Nc[U1])+V1;if(Fd+l0>Nh)break s;for(var W1=B1?a0:0;0<l0--;)Qm[Fd++]=W1}}Up=1;break s}Up||(Lu.a=3),Ya=Up}(Ya=Ya&&!uf.h)&&(Fp=P(s0,r0,8,ki,Gf)),Ya&&Fp!=0?Au=Fp:(Rp.a=3,Au=0)}if(Au==0)break n;if(hl&&Hm[Cs]==1&&(hl=ms[Vs].g==0),Rc+=ms[Vs].g,Vs+=Au,3>=Cs){var zd,Jm=la[0];for(zd=1;zd<Sa;++zd)la[zd]>Jm&&(Jm=la[zd]);Ma+=Jm}}if(ys.nd=hl,ys.Qb=0,hl&&(ys.qb=(kr[3][Al[3]+0].value<<24|kr[1][Al[1]+0].value<<16|kr[2][Al[2]+0].value)>>>0,Rc==0&&256>kr[0][Al[0]+0].value&&(ys.Qb=1,ys.qb+=kr[0][Al[0]+0].value<<8)),ys.jc=!ys.Qb&&6>Ma,ys.jc){var Wp,eu=ys;for(Wp=0;Wp<Mc;++Wp){var df=Wp,hf=eu.pd[df],Gp=eu.G[0][eu.H[0]+df];256<=Gp.value?(hf.g=Gp.g+256,hf.value=Gp.value):(hf.g=0,hf.value=0,df>>=Oe(Gp,8,hf),df>>=Oe(eu.G[1][eu.H[1]+df],16,hf),df>>=Oe(eu.G[2][eu.H[2]+df],0,hf),Oe(eu.G[3][eu.H[3]+df],24,hf))}}}Oa.vc=Ys,Oa.Wb=Or,Oa.Ya=ko,Oa.yc=Pa,Sn=1;break t}Sn=0}if(!(_e=Sn)){ie.a=3;break e}if(0<St){if(Re.ua=1<<St,!de(Re.Wa,St)){ie.a=1,_e=0;break e}}else Re.ua=0;var Zm=ie,Bd=xe,G1=Ae,Dh=Zm.s,Ud=Dh.xc;if(Zm.c=Bd,Zm.i=G1,Dh.md=Xe(Bd,Ud),Dh.wc=Ud==0?-1:(1<<Ud)-1,J){ie.xb=Rf;break e}if((tt=a(xe*Ae))==null){ie.a=1,_e=0;break e}_e=(_e=Gn(ie,tt,0,xe,Ae,Ae,null))&&!De.h;break e}return _e?(ye!=null?ye[0]=tt:(e(tt==null),e(J)),ie.$=0,J||hn(Re)):hn(Re),_e}function Vr(N,$){var J=N.c*N.i,ie=J+$+16*$;return e(N.c<=$),N.V=a(ie),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+J+$,1)}function Yr(N,$){var J=N.C,ie=$-J,ye=N.V,_e=N.Ba+N.c*J;for(e($<=N.l.o);0<ie;){var xe=16<ie?16:ie,Ae=N.l.ma,De=N.l.width,Re=De*xe,tt=Ae.ca,St=Ae.tb+De*J,je=N.Ta,ct=N.Ua;ut(N,xe,ye,_e),fl(je,ct,tt,St,Re),xn(Ae,J,J+xe,tt,St,De),ie-=xe,ye+=xe*N.c,J+=xe}e(J==$),N.C=N.Ma=$}function Cr(){this.ub=this.yd=this.td=this.Rb=0}function Kr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function sl(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Ni(){this.Yb=(function(){var N=[];return(function $(J,ie,ye){for(var _e=ye[ie],xe=0;xe<_e&&(J.push(ye.length>ie+1?[]:0),!(ye.length<ie+1));xe++)$(J[xe],ie+1,ye)})(N,0,[3,11]),N})()}function Xr(){this.jb=a(3),this.Wc=l([4,8],Ni),this.Xc=l([4,17],Ni)}function ka(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function oi(){this.ld=this.La=this.dd=this.tc=0}function wa(){this.Na=this.la=0}function li(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function pi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function yo(){this.uc=this.M=this.Nb=0,this.wa=Array(new oi),this.Y=0,this.ya=Array(new pi),this.aa=0,this.l=new bo}function rl(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Gc(){this.cb=this.a=0,this.sc="",this.m=new R,this.Od=new Cr,this.Kc=new Kr,this.ed=new ka,this.Qa=new sl,this.Ic=this.$c=this.Aa=0,this.D=new yo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,R),this.ia=0,this.pb=o(4,li),this.Pa=new Xr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new rl),this.Hd=0,this.rb=Array(new wa),this.sb=0,this.wa=Array(new oi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new pi),this.L=this.aa=0,this.gd=l([4,2],oi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function va(N,$){return 0>N?0:N>$?$:N}function bo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wa(){var N=new Gc;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,Il||(Il=cn)),N}function Us(N,$,J){return N.a==0&&(N.a=$,N.sc=J,N.cb=0),0}function Ga(N,$,J){return 3<=J&&N[$+0]==157&&N[$+1]==1&&N[$+2]==42}function Zt(N,$){if(N==null)return 0;if(N.a=0,N.sc="OK",$==null)return Us(N,2,"null VP8Io passed to VP8GetHeaders()");var J=$.data,ie=$.w,ye=$.ha;if(4>ye)return Us(N,7,"Truncated header.");var _e=J[ie+0]|J[ie+1]<<8|J[ie+2]<<16,xe=N.Od;if(xe.Rb=!(1&_e),xe.td=_e>>1&7,xe.yd=_e>>4&1,xe.ub=_e>>5,3<xe.td)return Us(N,3,"Incorrect keyframe parameters.");if(!xe.yd)return Us(N,4,"Frame not displayable.");ie+=3,ye-=3;var Ae=N.Kc;if(xe.Rb){if(7>ye)return Us(N,7,"cannot parse picture header");if(!Ga(J,ie,ye))return Us(N,3,"Bad code word");Ae.c=16383&(J[ie+4]<<8|J[ie+3]),Ae.Td=J[ie+4]>>6,Ae.i=16383&(J[ie+6]<<8|J[ie+5]),Ae.Ud=J[ie+6]>>6,ie+=7,ye-=7,N.za=Ae.c+15>>4,N.Ub=Ae.i+15>>4,$.width=Ae.c,$.height=Ae.i,$.Da=0,$.j=0,$.v=0,$.va=$.width,$.o=$.height,$.da=0,$.ib=$.width,$.hb=$.height,$.U=$.width,$.T=$.height,r((_e=N.Pa).jb,0,255,_e.jb.length),e((_e=N.Qa)!=null),_e.Cb=0,_e.Bb=0,_e.Fb=1,r(_e.Zb,0,0,_e.Zb.length),r(_e.Lb,0,0,_e.Lb)}if(xe.ub>ye)return Us(N,7,"bad partition length");q(_e=N.m,J,ie,xe.ub),ie+=xe.ub,ye-=xe.ub,xe.Rb&&(Ae.Ld=Se(_e),Ae.Kd=Se(_e)),Ae=N.Qa;var De,Re=N.Pa;if(e(_e!=null),e(Ae!=null),Ae.Cb=Se(_e),Ae.Cb){if(Ae.Bb=Se(_e),Se(_e)){for(Ae.Fb=Se(_e),De=0;4>De;++De)Ae.Zb[De]=Se(_e)?Z(_e,7):0;for(De=0;4>De;++De)Ae.Lb[De]=Se(_e)?Z(_e,6):0}if(Ae.Bb)for(De=0;3>De;++De)Re.jb[De]=Se(_e)?te(_e,8):255}else Ae.Bb=0;if(_e.Ka)return Us(N,3,"cannot parse segment header");if((Ae=N.ed).zd=Se(_e),Ae.Tb=te(_e,6),Ae.wb=te(_e,3),Ae.Pc=Se(_e),Ae.Pc&&Se(_e)){for(Re=0;4>Re;++Re)Se(_e)&&(Ae.vd[Re]=Z(_e,6));for(Re=0;4>Re;++Re)Se(_e)&&(Ae.od[Re]=Z(_e,6))}if(N.L=Ae.Tb==0?0:Ae.zd?1:2,_e.Ka)return Us(N,3,"cannot parse filter header");var tt=ye;if(ye=De=ie,ie=De+tt,Ae=tt,N.Xb=(1<<te(N.m,2))-1,tt<3*(Re=N.Xb))J=7;else{for(De+=3*Re,Ae-=3*Re,tt=0;tt<Re;++tt){var St=J[ye+0]|J[ye+1]<<8|J[ye+2]<<16;St>Ae&&(St=Ae),q(N.Jc[+tt],J,De,St),De+=St,Ae-=St,ye+=3}q(N.Jc[+Re],J,De,Ae),J=De<ie?0:5}if(J!=0)return Us(N,J,"cannot parse partitions");for(J=te(De=N.m,7),ye=Se(De)?Z(De,4):0,ie=Se(De)?Z(De,4):0,Ae=Se(De)?Z(De,4):0,Re=Se(De)?Z(De,4):0,De=Se(De)?Z(De,4):0,tt=N.Qa,St=0;4>St;++St){if(tt.Cb){var je=tt.Zb[St];tt.Fb||(je+=J)}else{if(0<St){N.pb[St]=N.pb[0];continue}je=J}var ct=N.pb[St];ct.Sc[0]=Pc[va(je+ye,127)],ct.Sc[1]=$c[va(je+0,127)],ct.Eb[0]=2*Pc[va(je+ie,127)],ct.Eb[1]=101581*$c[va(je+Ae,127)]>>16,8>ct.Eb[1]&&(ct.Eb[1]=8),ct.Qc[0]=Pc[va(je+Re,117)],ct.Qc[1]=$c[va(je+De,127)],ct.lc=je+De}if(!xe.Rb)return Us(N,4,"Not a key frame.");for(Se(_e),xe=N.Pa,J=0;4>J;++J){for(ye=0;8>ye;++ye)for(ie=0;3>ie;++ie)for(Ae=0;11>Ae;++Ae)Re=Me(_e,Mi[J][ye][ie][Ae])?te(_e,8):j1[J][ye][ie][Ae],xe.Wc[J][ye].Yb[ie][Ae]=Re;for(ye=0;17>ye;++ye)xe.Xc[J][ye]=xe.Wc[J][mr[ye]]}return N.kc=Se(_e),N.kc&&(N.Bd=te(_e,8)),N.cb=1}function cn(N,$,J,ie,ye,_e,xe){var Ae=$[ye].Yb[J];for(J=0;16>ye;++ye){if(!Me(N,Ae[J+0]))return ye;for(;!Me(N,Ae[J+1]);)if(Ae=$[++ye].Yb[0],J=0,ye==16)return 16;var De=$[ye+1].Yb;if(Me(N,Ae[J+2])){var Re=N,tt=0;if(Me(Re,(je=Ae)[(St=J)+3]))if(Me(Re,je[St+6])){for(Ae=0,St=2*(tt=Me(Re,je[St+8]))+(je=Me(Re,je[St+9+tt])),tt=0,je=$1[St];je[Ae];++Ae)tt+=tt+Me(Re,je[Ae]);tt+=3+(8<<St)}else Me(Re,je[St+7])?(tt=7+2*Me(Re,165),tt+=Me(Re,145)):tt=5+Me(Re,159);else tt=Me(Re,je[St+4])?3+Me(Re,je[St+5]):2;Ae=De[2]}else tt=1,Ae=De[1];De=xe+t0[ye],0>(Re=N).b&&Ce(Re);var St,je=Re.b,ct=(St=Re.Ca>>1)-(Re.I>>je)>>31;--Re.b,Re.Ca+=ct,Re.Ca|=1,Re.I-=(St+1&ct)<<je,_e[De]=((tt^ct)-ct)*ie[(0<ye)+0]}return 16}function In(N){var $=N.rb[N.sb-1];$.la=0,$.Na=0,r(N.zc,0,0,N.zc.length),N.ja=0}function Rs(N,$,J,ie,ye){ye=N[$+J+32*ie]+(ye>>3),N[$+J+32*ie]=-256&ye?0>ye?0:255:ye}function xi(N,$,J,ie,ye,_e){Rs(N,$,0,J,ie+ye),Rs(N,$,1,J,ie+_e),Rs(N,$,2,J,ie-_e),Rs(N,$,3,J,ie-ye)}function ci(N){return(20091*N>>16)+N}function Gl(N,$,J,ie){var ye,_e=0,xe=a(16);for(ye=0;4>ye;++ye){var Ae=N[$+0]+N[$+8],De=N[$+0]-N[$+8],Re=(35468*N[$+4]>>16)-ci(N[$+12]),tt=ci(N[$+4])+(35468*N[$+12]>>16);xe[_e+0]=Ae+tt,xe[_e+1]=De+Re,xe[_e+2]=De-Re,xe[_e+3]=Ae-tt,_e+=4,$++}for(ye=_e=0;4>ye;++ye)Ae=(N=xe[_e+0]+4)+xe[_e+8],De=N-xe[_e+8],Re=(35468*xe[_e+4]>>16)-ci(xe[_e+12]),Rs(J,ie,0,0,Ae+(tt=ci(xe[_e+4])+(35468*xe[_e+12]>>16))),Rs(J,ie,1,0,De+Re),Rs(J,ie,2,0,De-Re),Rs(J,ie,3,0,Ae-tt),_e++,ie+=32}function Of(N,$,J,ie){var ye=N[$+0]+4,_e=35468*N[$+4]>>16,xe=ci(N[$+4]),Ae=35468*N[$+1]>>16;xi(J,ie,0,ye+xe,N=ci(N[$+1]),Ae),xi(J,ie,1,ye+_e,N,Ae),xi(J,ie,2,ye-_e,N,Ae),xi(J,ie,3,ye-xe,N,Ae)}function ft(N,$,J,ie,ye){Gl(N,$,J,ie),ye&&Gl(N,$+16,J,ie+4)}function oe(N,$,J,ie){Ac(N,$+0,J,ie,1),Ac(N,$+32,J,ie+128,1)}function Ne(N,$,J,ie){var ye;for(N=N[$+0]+4,ye=0;4>ye;++ye)for($=0;4>$;++$)Rs(J,ie,$,ye,N)}function Ue(N,$,J,ie){N[$+0]&&yr(N,$+0,J,ie),N[$+16]&&yr(N,$+16,J,ie+4),N[$+32]&&yr(N,$+32,J,ie+128),N[$+48]&&yr(N,$+48,J,ie+128+4)}function Ve(N,$,J,ie){var ye,_e=a(16);for(ye=0;4>ye;++ye){var xe=N[$+0+ye]+N[$+12+ye],Ae=N[$+4+ye]+N[$+8+ye],De=N[$+4+ye]-N[$+8+ye],Re=N[$+0+ye]-N[$+12+ye];_e[0+ye]=xe+Ae,_e[8+ye]=xe-Ae,_e[4+ye]=Re+De,_e[12+ye]=Re-De}for(ye=0;4>ye;++ye)xe=(N=_e[0+4*ye]+3)+_e[3+4*ye],Ae=_e[1+4*ye]+_e[2+4*ye],De=_e[1+4*ye]-_e[2+4*ye],Re=N-_e[3+4*ye],J[ie+0]=xe+Ae>>3,J[ie+16]=Re+De>>3,J[ie+32]=xe-Ae>>3,J[ie+48]=Re-De>>3,ie+=64}function Ct(N,$,J){var ie,ye=$-32,_e=Bo,xe=255-N[ye-1];for(ie=0;ie<J;++ie){var Ae,De=_e,Re=xe+N[$-1];for(Ae=0;Ae<J;++Ae)N[$+Ae]=De[Re+N[ye+Ae]];$+=32}}function Rt(N,$){Ct(N,$,4)}function wn(N,$){Ct(N,$,8)}function bn(N,$){Ct(N,$,16)}function _n(N,$){var J;for(J=0;16>J;++J)s(N,$+32*J,N,$-32,16)}function mn(N,$){var J;for(J=16;0<J;--J)r(N,$,N[$-1],16),$+=32}function ls(N,$,J){var ie;for(ie=0;16>ie;++ie)r($,J+32*ie,N,16)}function ds(N,$){var J,ie=16;for(J=0;16>J;++J)ie+=N[$-1+32*J]+N[$+J-32];ls(ie>>5,N,$)}function Ar(N,$){var J,ie=8;for(J=0;16>J;++J)ie+=N[$-1+32*J];ls(ie>>4,N,$)}function Ci(N,$){var J,ie=8;for(J=0;16>J;++J)ie+=N[$+J-32];ls(ie>>4,N,$)}function Sr(N,$){ls(128,N,$)}function An(N,$,J){return N+2*$+J+2>>2}function Lr(N,$){var J,ie=$-32;for(ie=new Uint8Array([An(N[ie-1],N[ie+0],N[ie+1]),An(N[ie+0],N[ie+1],N[ie+2]),An(N[ie+1],N[ie+2],N[ie+3]),An(N[ie+2],N[ie+3],N[ie+4])]),J=0;4>J;++J)s(N,$+32*J,ie,0,ie.length)}function wo(N,$){var J=N[$-1],ie=N[$-1+32],ye=N[$-1+64],_e=N[$-1+96];pe(N,$+0,16843009*An(N[$-1-32],J,ie)),pe(N,$+32,16843009*An(J,ie,ye)),pe(N,$+64,16843009*An(ie,ye,_e)),pe(N,$+96,16843009*An(ye,_e,_e))}function Ml(N,$){var J,ie=4;for(J=0;4>J;++J)ie+=N[$+J-32]+N[$-1+32*J];for(ie>>=3,J=0;4>J;++J)r(N,$+32*J,ie,4)}function Fr(N,$){var J=N[$-1+0],ie=N[$-1+32],ye=N[$-1+64],_e=N[$-1-32],xe=N[$+0-32],Ae=N[$+1-32],De=N[$+2-32],Re=N[$+3-32];N[$+0+96]=An(ie,ye,N[$-1+96]),N[$+1+96]=N[$+0+64]=An(J,ie,ye),N[$+2+96]=N[$+1+64]=N[$+0+32]=An(_e,J,ie),N[$+3+96]=N[$+2+64]=N[$+1+32]=N[$+0+0]=An(xe,_e,J),N[$+3+64]=N[$+2+32]=N[$+1+0]=An(Ae,xe,_e),N[$+3+32]=N[$+2+0]=An(De,Ae,xe),N[$+3+0]=An(Re,De,Ae)}function Si(N,$){var J=N[$+1-32],ie=N[$+2-32],ye=N[$+3-32],_e=N[$+4-32],xe=N[$+5-32],Ae=N[$+6-32],De=N[$+7-32];N[$+0+0]=An(N[$+0-32],J,ie),N[$+1+0]=N[$+0+32]=An(J,ie,ye),N[$+2+0]=N[$+1+32]=N[$+0+64]=An(ie,ye,_e),N[$+3+0]=N[$+2+32]=N[$+1+64]=N[$+0+96]=An(ye,_e,xe),N[$+3+32]=N[$+2+64]=N[$+1+96]=An(_e,xe,Ae),N[$+3+64]=N[$+2+96]=An(xe,Ae,De),N[$+3+96]=An(Ae,De,De)}function Qr(N,$){var J=N[$-1+0],ie=N[$-1+32],ye=N[$-1+64],_e=N[$-1-32],xe=N[$+0-32],Ae=N[$+1-32],De=N[$+2-32],Re=N[$+3-32];N[$+0+0]=N[$+1+64]=_e+xe+1>>1,N[$+1+0]=N[$+2+64]=xe+Ae+1>>1,N[$+2+0]=N[$+3+64]=Ae+De+1>>1,N[$+3+0]=De+Re+1>>1,N[$+0+96]=An(ye,ie,J),N[$+0+64]=An(ie,J,_e),N[$+0+32]=N[$+1+96]=An(J,_e,xe),N[$+1+32]=N[$+2+96]=An(_e,xe,Ae),N[$+2+32]=N[$+3+96]=An(xe,Ae,De),N[$+3+32]=An(Ae,De,Re)}function mi(N,$){var J=N[$+0-32],ie=N[$+1-32],ye=N[$+2-32],_e=N[$+3-32],xe=N[$+4-32],Ae=N[$+5-32],De=N[$+6-32],Re=N[$+7-32];N[$+0+0]=J+ie+1>>1,N[$+1+0]=N[$+0+64]=ie+ye+1>>1,N[$+2+0]=N[$+1+64]=ye+_e+1>>1,N[$+3+0]=N[$+2+64]=_e+xe+1>>1,N[$+0+32]=An(J,ie,ye),N[$+1+32]=N[$+0+96]=An(ie,ye,_e),N[$+2+32]=N[$+1+96]=An(ye,_e,xe),N[$+3+32]=N[$+2+96]=An(_e,xe,Ae),N[$+3+64]=An(xe,Ae,De),N[$+3+96]=An(Ae,De,Re)}function Wr(N,$){var J=N[$-1+0],ie=N[$-1+32],ye=N[$-1+64],_e=N[$-1+96];N[$+0+0]=J+ie+1>>1,N[$+2+0]=N[$+0+32]=ie+ye+1>>1,N[$+2+32]=N[$+0+64]=ye+_e+1>>1,N[$+1+0]=An(J,ie,ye),N[$+3+0]=N[$+1+32]=An(ie,ye,_e),N[$+3+32]=N[$+1+64]=An(ye,_e,_e),N[$+3+64]=N[$+2+64]=N[$+0+96]=N[$+1+96]=N[$+2+96]=N[$+3+96]=_e}function io(N,$){var J=N[$-1+0],ie=N[$-1+32],ye=N[$-1+64],_e=N[$-1+96],xe=N[$-1-32],Ae=N[$+0-32],De=N[$+1-32],Re=N[$+2-32];N[$+0+0]=N[$+2+32]=J+xe+1>>1,N[$+0+32]=N[$+2+64]=ie+J+1>>1,N[$+0+64]=N[$+2+96]=ye+ie+1>>1,N[$+0+96]=_e+ye+1>>1,N[$+3+0]=An(Ae,De,Re),N[$+2+0]=An(xe,Ae,De),N[$+1+0]=N[$+3+32]=An(J,xe,Ae),N[$+1+32]=N[$+3+64]=An(ie,J,xe),N[$+1+64]=N[$+3+96]=An(ye,ie,J),N[$+1+96]=An(_e,ye,ie)}function Ha(N,$){var J;for(J=0;8>J;++J)s(N,$+32*J,N,$-32,8)}function Yi(N,$){var J;for(J=0;8>J;++J)r(N,$,N[$-1],8),$+=32}function aa(N,$,J){var ie;for(ie=0;8>ie;++ie)r($,J+32*ie,N,8)}function Di(N,$){var J,ie=8;for(J=0;8>J;++J)ie+=N[$+J-32]+N[$-1+32*J];aa(ie>>4,N,$)}function Gr(N,$){var J,ie=4;for(J=0;8>J;++J)ie+=N[$+J-32];aa(ie>>3,N,$)}function Qs(N,$){var J,ie=4;for(J=0;8>J;++J)ie+=N[$-1+32*J];aa(ie>>3,N,$)}function Nr(N,$){aa(128,N,$)}function Oi(N,$,J){var ie=N[$-J],ye=N[$+0],_e=3*(ye-ie)+rf[1020+N[$-2*J]-N[$+J]],xe=Th[112+(_e+4>>3)];N[$-J]=Bo[255+ie+Th[112+(_e+3>>3)]],N[$+0]=Bo[255+ye-xe]}function il(N,$,J,ie){var ye=N[$+0],_e=N[$+J];return xo[255+N[$-2*J]-N[$-J]]>ie||xo[255+_e-ye]>ie}function Tl(N,$,J,ie){return 4*xo[255+N[$-J]-N[$+0]]+xo[255+N[$-2*J]-N[$+J]]<=ie}function Tu(N,$,J,ie,ye){var _e=N[$-3*J],xe=N[$-2*J],Ae=N[$-J],De=N[$+0],Re=N[$+J],tt=N[$+2*J],St=N[$+3*J];return 4*xo[255+Ae-De]+xo[255+xe-Re]>ie?0:xo[255+N[$-4*J]-_e]<=ye&&xo[255+_e-xe]<=ye&&xo[255+xe-Ae]<=ye&&xo[255+St-tt]<=ye&&xo[255+tt-Re]<=ye&&xo[255+Re-De]<=ye}function Hc(N,$,J,ie){var ye=2*ie+1;for(ie=0;16>ie;++ie)Tl(N,$+ie,J,ye)&&Oi(N,$+ie,J)}function qc(N,$,J,ie){var ye=2*ie+1;for(ie=0;16>ie;++ie)Tl(N,$+ie*J,1,ye)&&Oi(N,$+ie*J,1)}function ef(N,$,J,ie){var ye;for(ye=3;0<ye;--ye)Hc(N,$+=4*J,J,ie)}function Nd(N,$,J,ie){var ye;for(ye=3;0<ye;--ye)qc(N,$+=4,J,ie)}function al(N,$,J,ie,ye,_e,xe,Ae){for(_e=2*_e+1;0<ye--;){if(Tu(N,$,J,_e,xe))if(il(N,$,J,Ae))Oi(N,$,J);else{var De=N,Re=$,tt=J,St=De[Re-2*tt],je=De[Re-tt],ct=De[Re+0],gt=De[Re+tt],Ut=De[Re+2*tt],_t=27*(Yt=rf[1020+3*(ct-je)+rf[1020+St-gt]])+63>>7,zt=18*Yt+63>>7,Yt=9*Yt+63>>7;De[Re-3*tt]=Bo[255+De[Re-3*tt]+Yt],De[Re-2*tt]=Bo[255+St+zt],De[Re-tt]=Bo[255+je+_t],De[Re+0]=Bo[255+ct-_t],De[Re+tt]=Bo[255+gt-zt],De[Re+2*tt]=Bo[255+Ut-Yt]}$+=ie}}function Yc(N,$,J,ie,ye,_e,xe,Ae){for(_e=2*_e+1;0<ye--;){if(Tu(N,$,J,_e,xe))if(il(N,$,J,Ae))Oi(N,$,J);else{var De=N,Re=$,tt=J,St=De[Re-tt],je=De[Re+0],ct=De[Re+tt],gt=Th[112+(4+(Ut=3*(je-St))>>3)],Ut=Th[112+(Ut+3>>3)],_t=gt+1>>1;De[Re-2*tt]=Bo[255+De[Re-2*tt]+_t],De[Re-tt]=Bo[255+St+Ut],De[Re+0]=Bo[255+je-gt],De[Re+tt]=Bo[255+ct-_t]}$+=ie}}function Ch(N,$,J,ie,ye,_e){al(N,$,J,1,16,ie,ye,_e)}function Kc(N,$,J,ie,ye,_e){al(N,$,1,J,16,ie,ye,_e)}function Sh(N,$,J,ie,ye,_e){var xe;for(xe=3;0<xe;--xe)Yc(N,$+=4*J,J,1,16,ie,ye,_e)}function Y(N,$,J,ie,ye,_e){var xe;for(xe=3;0<xe;--xe)Yc(N,$+=4,1,J,16,ie,ye,_e)}function me(N,$,J,ie,ye,_e,xe,Ae){al(N,$,ye,1,8,_e,xe,Ae),al(J,ie,ye,1,8,_e,xe,Ae)}function Fe(N,$,J,ie,ye,_e,xe,Ae){al(N,$,1,ye,8,_e,xe,Ae),al(J,ie,1,ye,8,_e,xe,Ae)}function Je(N,$,J,ie,ye,_e,xe,Ae){Yc(N,$+4*ye,ye,1,8,_e,xe,Ae),Yc(J,ie+4*ye,ye,1,8,_e,xe,Ae)}function pt(N,$,J,ie,ye,_e,xe,Ae){Yc(N,$+4,1,ye,8,_e,xe,Ae),Yc(J,ie+4,1,ye,8,_e,xe,Ae)}function Ht(){this.ba=new Qn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function zn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qn(){this.ua=0,this.Wa=new st,this.vb=new st,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Q,this.yc=new j}function xs(){this.xb=this.a=0,this.l=new bo,this.ca=new Qn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new B,this.Pb=0,this.wd=new B,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qn,this.ab=0,this.gc=o(4,zn),this.Oc=0}function ks(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function pr(N,$,J,ie,ye,_e,xe){for(N=N==null?0:N[$+0],$=0;$<xe;++$)ye[_e+$]=N+J[ie+$]&255,N=ye[_e+$]}function gi(N,$,J,ie,ye,_e,xe){var Ae;if(N==null)pr(null,null,J,ie,ye,_e,xe);else for(Ae=0;Ae<xe;++Ae)ye[_e+Ae]=N[$+Ae]+J[ie+Ae]&255}function Ki(N,$,J,ie,ye,_e,xe){if(N==null)pr(null,null,J,ie,ye,_e,xe);else{var Ae,De=N[$+0],Re=De,tt=De;for(Ae=0;Ae<xe;++Ae)Re=tt+(De=N[$+Ae])-Re,tt=J[ie+Ae]+(-256&Re?0>Re?0:255:Re)&255,Re=De,ye[_e+Ae]=tt}}function Jr(N,$,J,ie){var ye=$.width,_e=$.o;if(e(N!=null&&$!=null),0>J||0>=ie||J+ie>_e)return null;if(!N.Cc){if(N.ga==null){var xe;if(N.ga=new ks,(xe=N.ga==null)||(xe=$.width*$.o,e(N.Gb.length==0),N.Gb=a(xe),N.Uc=0,N.Gb==null?xe=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,xe=1),xe=!xe),!xe){xe=N.ga;var Ae=N.Fa,De=N.P,Re=N.qc,tt=N.mb,St=N.nb,je=De+1,ct=Re-1,gt=xe.l;if(e(Ae!=null&&tt!=null&&$!=null),lf[0]=null,lf[1]=pr,lf[2]=gi,lf[3]=Ki,xe.ca=tt,xe.tb=St,xe.c=$.width,xe.i=$.height,e(0<xe.c&&0<xe.i),1>=Re)$=0;else if(xe.$a=3&Ae[De+0],xe.Z=Ae[De+0]>>2&3,xe.Lc=Ae[De+0]>>4&3,De=Ae[De+0]>>6&3,0>xe.$a||1<xe.$a||4<=xe.Z||1<xe.Lc||De)$=0;else if(gt.put=Fn,gt.ac=ir,gt.bc=fs,gt.ma=xe,gt.width=$.width,gt.height=$.height,gt.Da=$.Da,gt.v=$.v,gt.va=$.va,gt.j=$.j,gt.o=$.o,xe.$a)e:{e(xe.$a==1),$=vs();t:for(;;){if($==null){$=0;break e}if(e(xe!=null),xe.mc=$,$.c=xe.c,$.i=xe.i,$.l=xe.l,$.l.ma=xe,$.l.width=xe.c,$.l.height=xe.i,$.a=0,ne($.m,Ae,je,ct),!_s(xe.c,xe.i,1,$,null)||($.ab==1&&$.gc[0].hc==3&&rn($.s)?(xe.ic=1,Ae=$.c*$.i,$.Ta=null,$.Ua=0,$.V=a(Ae),$.Ba=0,$.V==null?($.a=1,$=0):$=1):(xe.ic=0,$=Vr($,xe.c)),!$))break t;$=1;break e}xe.mc=null,$=0}else $=ct>=xe.c*xe.i;xe=!$}if(xe)return null;N.ga.Lc!=1?N.Ga=0:ie=_e-J}e(N.ga!=null),e(J+ie<=_e);e:{if($=(Ae=N.ga).c,_e=Ae.l.o,Ae.$a==0){if(je=N.rc,ct=N.Vc,gt=N.Fa,De=N.P+1+J*$,Re=N.mb,tt=N.nb+J*$,e(De<=N.P+N.qc),Ae.Z!=0)for(e(lf[Ae.Z]!=null),xe=0;xe<ie;++xe)lf[Ae.Z](je,ct,gt,De,Re,tt,$),je=Re,ct=tt,tt+=$,De+=$;else for(xe=0;xe<ie;++xe)s(Re,tt,gt,De,$),je=Re,ct=tt,tt+=$,De+=$;N.rc=je,N.Vc=ct}else{if(e(Ae.mc!=null),$=J+ie,e((xe=Ae.mc)!=null),e($<=xe.i),xe.C>=$)$=1;else if(Ae.ic||ol(),Ae.ic){Ae=xe.V,je=xe.Ba,ct=xe.c;var Ut=xe.i,_t=(gt=1,De=xe.$/ct,Re=xe.$%ct,tt=xe.m,St=xe.s,xe.$),zt=ct*Ut,Yt=ct*$,dn=St.wc,en=_t<Yt?ze(St,Re,De):null;e(_t<=zt),e($<=Ut),e(rn(St));t:for(;;){for(;!tt.h&&_t<Yt;){if(Re&dn||(en=ze(St,Re,De)),e(en!=null),ge(tt),256>(Ut=ve(en.G[0],en.H[0],tt)))Ae[je+_t]=Ut,++_t,++Re>=ct&&(Re=0,++De<=$&&!(De%16)&&un(xe,De));else{if(!(280>Ut)){gt=0;break t}Ut=re(Ut-256,tt);var Yn,jn=ve(en.G[4],en.H[4],tt);if(ge(tt),!(_t>=(jn=Pe(ct,jn=re(jn,tt)))&&zt-_t>=Ut)){gt=0;break t}for(Yn=0;Yn<Ut;++Yn)Ae[je+_t+Yn]=Ae[je+_t+Yn-jn];for(_t+=Ut,Re+=Ut;Re>=ct;)Re-=ct,++De<=$&&!(De%16)&&un(xe,De);_t<Yt&&Re&dn&&(en=ze(St,Re,De))}e(tt.h==se(tt))}un(xe,De>$?$:De);break t}!gt||tt.h&&_t<zt?(gt=0,xe.a=tt.h?5:3):xe.$=_t,$=gt}else $=Gn(xe,xe.V,xe.Ba,xe.c,xe.i,$,Yr);if(!$){ie=0;break e}}J+ie>=_e&&(N.Cc=1),ie=1}if(!ie)return null;if(N.Cc&&((ie=N.ga)!=null&&(ie.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+J*ye}function Ea(N,$,J,ie,ye,_e){for(;0<ye--;){var xe,Ae=N,De=$+(J?1:0),Re=N,tt=$+(J?0:3);for(xe=0;xe<ie;++xe){var St=Re[tt+4*xe];St!=255&&(St*=32897,Ae[De+4*xe+0]=Ae[De+4*xe+0]*St>>23,Ae[De+4*xe+1]=Ae[De+4*xe+1]*St>>23,Ae[De+4*xe+2]=Ae[De+4*xe+2]*St>>23)}$+=_e}}function zi(N,$,J,ie,ye){for(;0<ie--;){var _e;for(_e=0;_e<J;++_e){var xe=N[$+2*_e+0],Ae=15&(Re=N[$+2*_e+1]),De=4369*Ae,Re=(240&Re|Re>>4)*De>>16;N[$+2*_e+0]=(240&xe|xe>>4)*De>>16&240|(15&xe|xe<<4)*De>>16>>4&15,N[$+2*_e+1]=240&Re|Ae}$+=ye}}function _a(N,$,J,ie,ye,_e,xe,Ae){var De,Re,tt=255;for(Re=0;Re<ye;++Re){for(De=0;De<ie;++De){var St=N[$+De];_e[xe+4*De]=St,tt&=St}$+=J,xe+=Ae}return tt!=255}function vc(N,$,J,ie,ye){var _e;for(_e=0;_e<ye;++_e)J[ie+_e]=N[$+_e]>>8}function ol(){sr=Ea,zr=zi,Lc=_a,fl=vc}function Xc(N,$,J){A[N]=function(ie,ye,_e,xe,Ae,De,Re,tt,St,je,ct,gt,Ut,_t,zt,Yt,dn){var en,Yn=dn-1>>1,jn=Ae[De+0]|Re[tt+0]<<16,Ds=St[je+0]|ct[gt+0]<<16;e(ie!=null);var Wn=3*jn+Ds+131074>>2;for($(ie[ye+0],255&Wn,Wn>>16,Ut,_t),_e!=null&&(Wn=3*Ds+jn+131074>>2,$(_e[xe+0],255&Wn,Wn>>16,zt,Yt)),en=1;en<=Yn;++en){var ar=Ae[De+en]|Re[tt+en]<<16,Pi=St[je+en]|ct[gt+en]<<16,Fs=jn+ar+Ds+Pi+524296,$n=Fs+2*(ar+Ds)>>3;Wn=$n+jn>>1,jn=(Fs=Fs+2*(jn+Pi)>>3)+ar>>1,$(ie[ye+2*en-1],255&Wn,Wn>>16,Ut,_t+(2*en-1)*J),$(ie[ye+2*en-0],255&jn,jn>>16,Ut,_t+(2*en-0)*J),_e!=null&&(Wn=Fs+Ds>>1,jn=$n+Pi>>1,$(_e[xe+2*en-1],255&Wn,Wn>>16,zt,Yt+(2*en-1)*J),$(_e[xe+2*en+0],255&jn,jn>>16,zt,Yt+(2*en+0)*J)),jn=ar,Ds=Pi}1&dn||(Wn=3*jn+Ds+131074>>2,$(ie[ye+dn-1],255&Wn,Wn>>16,Ut,_t+(dn-1)*J),_e!=null&&(Wn=3*Ds+jn+131074>>2,$(_e[xe+dn-1],255&Wn,Wn>>16,zt,Yt+(dn-1)*J)))}}function Dd(){So[Ip]=Ff,So[Uo]=Ih,So[Vm]=n0,So[ec]=Dp,So[Ap]=zf,So[kh]=Iu,So[af]=cf,So[Lp]=Ih,So[Wm]=Dp,So[Pd]=zf,So[Gm]=Iu}function Pf(N){return N&-16384?0>N?0:255:N>>Ym}function _c(N,$){return Pf((19077*N>>8)+(26149*$>>8)-14234)}function Hl(N,$,J){return Pf((19077*N>>8)-(6419*$>>8)-(13320*J>>8)+8708)}function tf(N,$){return Pf((19077*N>>8)+(33050*$>>8)-17685)}function xc(N,$,J,ie,ye){ie[ye+0]=_c(N,J),ie[ye+1]=Hl(N,$,J),ie[ye+2]=tf(N,$)}function Xi(N,$,J,ie,ye){ie[ye+0]=tf(N,$),ie[ye+1]=Hl(N,$,J),ie[ye+2]=_c(N,J)}function kl(N,$,J,ie,ye){var _e=Hl(N,$,J);$=_e<<3&224|tf(N,$)>>3,ie[ye+0]=248&_c(N,J)|_e>>5,ie[ye+1]=$}function Cc(N,$,J,ie,ye){var _e=240&tf(N,$)|15;ie[ye+0]=240&_c(N,J)|Hl(N,$,J)>>4,ie[ye+1]=_e}function $f(N,$,J,ie,ye){ie[ye+0]=255,xc(N,$,J,ie,ye+1)}function El(N,$,J,ie,ye){Xi(N,$,J,ie,ye),ie[ye+3]=255}function Ia(N,$,J,ie,ye){xc(N,$,J,ie,ye),ie[ye+3]=255}function ql(N,$,J){A[N]=function(ie,ye,_e,xe,Ae,De,Re,tt,St){for(var je=tt+(-2&St)*J;tt!=je;)$(ie[ye+0],_e[xe+0],Ae[De+0],Re,tt),$(ie[ye+1],_e[xe+0],Ae[De+0],Re,tt+J),ye+=2,++xe,++De,tt+=2*J;1&St&&$(ie[ye+0],_e[xe+0],Ae[De+0],Re,tt)}}function ku(N,$,J){return J==0?N==0?$==0?6:5:$==0?4:0:J}function Yl(N,$,J,ie,ye){switch(N>>>30){case 3:Ac($,J,ie,ye,0);break;case 2:Na($,J,ie,ye);break;case 1:yr($,J,ie,ye)}}function zo(N,$){var J,ie,ye=$.M,_e=$.Nb,xe=N.oc,Ae=N.pc+40,De=N.oc,Re=N.pc+584,tt=N.oc,St=N.pc+600;for(J=0;16>J;++J)xe[Ae+32*J-1]=129;for(J=0;8>J;++J)De[Re+32*J-1]=129,tt[St+32*J-1]=129;for(0<ye?xe[Ae-1-32]=De[Re-1-32]=tt[St-1-32]=129:(r(xe,Ae-32-1,127,21),r(De,Re-32-1,127,9),r(tt,St-32-1,127,9)),ie=0;ie<N.za;++ie){var je=$.ya[$.aa+ie];if(0<ie){for(J=-1;16>J;++J)s(xe,Ae+32*J-4,xe,Ae+32*J+12,4);for(J=-1;8>J;++J)s(De,Re+32*J-4,De,Re+32*J+4,4),s(tt,St+32*J-4,tt,St+32*J+4,4)}var ct=N.Gd,gt=N.Hd+ie,Ut=je.ad,_t=je.Hc;if(0<ye&&(s(xe,Ae-32,ct[gt].y,0,16),s(De,Re-32,ct[gt].f,0,8),s(tt,St-32,ct[gt].ea,0,8)),je.Za){var zt=xe,Yt=Ae-32+16;for(0<ye&&(ie>=N.za-1?r(zt,Yt,ct[gt].y[15],4):s(zt,Yt,ct[gt+1].y,0,4)),J=0;4>J;J++)zt[Yt+128+J]=zt[Yt+256+J]=zt[Yt+384+J]=zt[Yt+0+J];for(J=0;16>J;++J,_t<<=2)zt=xe,Yt=Ae+xa[J],Qi[je.Ob[J]](zt,Yt),Yl(_t,Ut,16*+J,zt,Yt)}else if(zt=ku(ie,ye,je.Ob[0]),dl[zt](xe,Ae),_t!=0)for(J=0;16>J;++J,_t<<=2)Yl(_t,Ut,16*+J,xe,Ae+xa[J]);for(J=je.Gc,zt=ku(ie,ye,je.Dd),Zc[zt](De,Re),Zc[zt](tt,St),_t=Ut,zt=De,Yt=Re,255&(je=0|J)&&(170&je?ul(_t,256,zt,Yt):nr(_t,256,zt,Yt)),je=tt,_t=St,255&(J>>=8)&&(170&J?ul(Ut,320,je,_t):nr(Ut,320,je,_t)),ye<N.Ub-1&&(s(ct[gt].y,0,xe,Ae+480,16),s(ct[gt].f,0,De,Re+224,8),s(ct[gt].ea,0,tt,St+224,8)),J=8*_e*N.B,ct=N.sa,gt=N.ta+16*ie+16*_e*N.R,Ut=N.qa,je=N.ra+8*ie+J,_t=N.Ha,zt=N.Ia+8*ie+J,J=0;16>J;++J)s(ct,gt+J*N.R,xe,Ae+32*J,16);for(J=0;8>J;++J)s(Ut,je+J*N.B,De,Re+32*J,8),s(_t,zt+J*N.B,tt,St+32*J,8)}}function Kl(N,$,J,ie,ye,_e,xe,Ae,De){var Re=[0],tt=[0],St=0,je=De!=null?De.kd:0,ct=De??new nn;if(N==null||12>J)return 7;ct.data=N,ct.w=$,ct.ha=J,$=[$],J=[J],ct.gb=[ct.gb];e:{var gt=$,Ut=J,_t=ct.gb;if(e(N!=null),e(Ut!=null),e(_t!=null),_t[0]=0,12<=Ut[0]&&!t(N,gt[0],"RIFF")){if(t(N,gt[0]+8,"WEBP")){_t=3;break e}var zt=We(N,gt[0]+4);if(12>zt||4294967286<zt){_t=3;break e}if(je&&zt>Ut[0]-8){_t=7;break e}_t[0]=zt,gt[0]+=12,Ut[0]-=12}_t=0}if(_t!=0)return _t;for(zt=0<ct.gb[0],J=J[0];;){e:{var Yt=N;Ut=$,_t=J;var dn=Re,en=tt,Yn=gt=[0];if((Wn=St=[St])[0]=0,8>_t[0])_t=7;else{if(!t(Yt,Ut[0],"VP8X")){if(We(Yt,Ut[0]+4)!=10){_t=3;break e}if(18>_t[0]){_t=7;break e}var jn=We(Yt,Ut[0]+8),Ds=1+$e(Yt,Ut[0]+12);if(2147483648<=Ds*(Yt=1+$e(Yt,Ut[0]+15))){_t=3;break e}Yn!=null&&(Yn[0]=jn),dn!=null&&(dn[0]=Ds),en!=null&&(en[0]=Yt),Ut[0]+=18,_t[0]-=18,Wn[0]=1}_t=0}}if(St=St[0],gt=gt[0],_t!=0)return _t;if(Ut=!!(2&gt),!zt&&St)return 3;if(_e!=null&&(_e[0]=!!(16&gt)),xe!=null&&(xe[0]=Ut),Ae!=null&&(Ae[0]=0),xe=Re[0],gt=tt[0],St&&Ut&&De==null){_t=0;break}if(4>J){_t=7;break}if(zt&&St||!zt&&!St&&!t(N,$[0],"ALPH")){J=[J],ct.na=[ct.na],ct.P=[ct.P],ct.Sa=[ct.Sa];e:{jn=N,_t=$,zt=J;var Wn=ct.gb;dn=ct.na,en=ct.P,Yn=ct.Sa,Ds=22,e(jn!=null),e(zt!=null),Yt=_t[0];var ar=zt[0];for(e(dn!=null),e(Yn!=null),dn[0]=null,en[0]=null,Yn[0]=0;;){if(_t[0]=Yt,zt[0]=ar,8>ar){_t=7;break e}var Pi=We(jn,Yt+4);if(4294967286<Pi){_t=3;break e}var Fs=8+Pi+1&-2;if(Ds+=Fs,0<Wn&&Ds>Wn){_t=3;break e}if(!t(jn,Yt,"VP8 ")||!t(jn,Yt,"VP8L")){_t=0;break e}if(ar[0]<Fs){_t=7;break e}t(jn,Yt,"ALPH")||(dn[0]=jn,en[0]=Yt+8,Yn[0]=Pi),Yt+=Fs,ar-=Fs}}if(J=J[0],ct.na=ct.na[0],ct.P=ct.P[0],ct.Sa=ct.Sa[0],_t!=0)break}J=[J],ct.Ja=[ct.Ja],ct.xa=[ct.xa];e:if(Wn=N,_t=$,zt=J,dn=ct.gb[0],en=ct.Ja,Yn=ct.xa,jn=_t[0],Yt=!t(Wn,jn,"VP8 "),Ds=!t(Wn,jn,"VP8L"),e(Wn!=null),e(zt!=null),e(en!=null),e(Yn!=null),8>zt[0])_t=7;else{if(Yt||Ds){if(Wn=We(Wn,jn+4),12<=dn&&Wn>dn-12){_t=3;break e}if(je&&Wn>zt[0]-8){_t=7;break e}en[0]=Wn,_t[0]+=8,zt[0]-=8,Yn[0]=Ds}else Yn[0]=5<=zt[0]&&Wn[jn+0]==47&&!(Wn[jn+4]>>5),en[0]=zt[0];_t=0}if(J=J[0],ct.Ja=ct.Ja[0],ct.xa=ct.xa[0],$=$[0],_t!=0)break;if(4294967286<ct.Ja)return 3;if(Ae==null||Ut||(Ae[0]=ct.xa?2:1),xe=[xe],gt=[gt],ct.xa){if(5>J){_t=7;break}Ae=xe,je=gt,Ut=_e,N==null||5>J?N=0:5<=J&&N[$+0]==47&&!(N[$+4]>>5)?(zt=[0],Wn=[0],dn=[0],ne(en=new B,N,$,J),ro(en,zt,Wn,dn)?(Ae!=null&&(Ae[0]=zt[0]),je!=null&&(je[0]=Wn[0]),Ut!=null&&(Ut[0]=dn[0]),N=1):N=0):N=0}else{if(10>J){_t=7;break}Ae=gt,N==null||10>J||!Ga(N,$+3,J-3)?N=0:(je=N[$+0]|N[$+1]<<8|N[$+2]<<16,Ut=16383&(N[$+7]<<8|N[$+6]),N=16383&(N[$+9]<<8|N[$+8]),1&je||3<(je>>1&7)||!(je>>4&1)||je>>5>=ct.Ja||!Ut||!N?N=0:(xe&&(xe[0]=Ut),Ae&&(Ae[0]=N),N=1))}if(!N||(xe=xe[0],gt=gt[0],St&&(Re[0]!=xe||tt[0]!=gt)))return 3;De!=null&&(De[0]=ct,De.offset=$-De.w,e(4294967286>$-De.w),e(De.offset==De.ha-J));break}return _t==0||_t==7&&St&&De==null?(_e!=null&&(_e[0]|=ct.na!=null&&0<ct.na.length),ie!=null&&(ie[0]=xe),ye!=null&&(ye[0]=gt),0):_t}function Sc(N,$,J){var ie=$.width,ye=$.height,_e=0,xe=0,Ae=ie,De=ye;if($.Da=N!=null&&0<N.Da,$.Da&&(Ae=N.cd,De=N.bd,_e=N.v,xe=N.j,11>J||(_e&=-2,xe&=-2),0>_e||0>xe||0>=Ae||0>=De||_e+Ae>ie||xe+De>ye))return 0;if($.v=_e,$.j=xe,$.va=_e+Ae,$.o=xe+De,$.U=Ae,$.T=De,$.da=N!=null&&0<N.da,$.da){if(!He(Ae,De,J=[N.ib],_e=[N.hb]))return 0;$.ib=J[0],$.hb=_e[0]}return $.ob=N!=null&&N.ob,$.Kb=N==null||!N.Sd,$.da&&($.ob=$.ib<3*ie/4&&$.hb<3*ye/4,$.Kb=0),1}function Od(N){if(N==null)return 2;if(11>N.S){var $=N.f.RGBA;$.fb+=(N.height-1)*$.A,$.A=-$.A}else $=N.f.kb,N=N.height,$.O+=(N-1)*$.fa,$.fa=-$.fa,$.N+=(N-1>>1)*$.Ab,$.Ab=-$.Ab,$.W+=(N-1>>1)*$.Db,$.Db=-$.Db,$.F!=null&&($.J+=(N-1)*$.lb,$.lb=-$.lb);return 0}function Xl(N,$,J,ie){if(ie==null||0>=N||0>=$)return 2;if(J!=null){if(J.Da){var ye=J.cd,_e=J.bd,xe=-2&J.v,Ae=-2&J.j;if(0>xe||0>Ae||0>=ye||0>=_e||xe+ye>N||Ae+_e>$)return 2;N=ye,$=_e}if(J.da){if(!He(N,$,ye=[J.ib],_e=[J.hb]))return 2;N=ye[0],$=_e[0]}}ie.width=N,ie.height=$;e:{var De=ie.width,Re=ie.height;if(N=ie.S,0>=De||0>=Re||!(N>=Ip&&13>N))N=2;else{if(0>=ie.Rd&&ie.sd==null){xe=_e=ye=$=0;var tt=(Ae=De*jp[N])*Re;if(11>N||(_e=(Re+1)/2*($=(De+1)/2),N==12&&(xe=(ye=De)*Re)),(Re=a(tt+2*_e+xe))==null){N=1;break e}ie.sd=Re,11>N?((De=ie.f.RGBA).eb=Re,De.fb=0,De.A=Ae,De.size=tt):((De=ie.f.kb).y=Re,De.O=0,De.fa=Ae,De.Fd=tt,De.f=Re,De.N=0+tt,De.Ab=$,De.Cd=_e,De.ea=Re,De.W=0+tt+_e,De.Db=$,De.Ed=_e,N==12&&(De.F=Re,De.J=0+tt+2*_e),De.Tc=xe,De.lb=ye)}if($=1,ye=ie.S,_e=ie.width,xe=ie.height,ye>=Ip&&13>ye)if(11>ye)N=ie.f.RGBA,$&=(Ae=Math.abs(N.A))*(xe-1)+_e<=N.size,$&=Ae>=_e*jp[ye],$&=N.eb!=null;else{N=ie.f.kb,Ae=(_e+1)/2,tt=(xe+1)/2,De=Math.abs(N.fa),Re=Math.abs(N.Ab);var St=Math.abs(N.Db),je=Math.abs(N.lb),ct=je*(xe-1)+_e;$&=De*(xe-1)+_e<=N.Fd,$&=Re*(tt-1)+Ae<=N.Cd,$=($&=St*(tt-1)+Ae<=N.Ed)&De>=_e&Re>=Ae&St>=Ae,$&=N.y!=null,$&=N.f!=null,$&=N.ea!=null,ye==12&&($&=je>=_e,$&=ct<=N.Tc,$&=N.F!=null)}else $=0;N=$?0:2}}return N!=0||J!=null&&J.fd&&(N=Od(ie)),N}var Mc=64,vo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Aa=24,Pn=32,Tc=8,kc=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ze("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(N){return N},A.Predictor2=function(N,$,J){return $[J+0]},A.Predictor3=function(N,$,J){return $[J+1]},A.Predictor4=function(N,$,J){return $[J-1]},A.Predictor5=function(N,$,J){return dt(dt(N,$[J+1]),$[J+0])},A.Predictor6=function(N,$,J){return dt(N,$[J-1])},A.Predictor7=function(N,$,J){return dt(N,$[J+0])},A.Predictor8=function(N,$,J){return dt($[J-1],$[J+0])},A.Predictor9=function(N,$,J){return dt($[J+0],$[J+1])},A.Predictor10=function(N,$,J){return dt(dt(N,$[J-1]),dt($[J+0],$[J+1]))},A.Predictor11=function(N,$,J){var ie=$[J+0];return 0>=Bt(ie>>24&255,N>>24&255,($=$[J-1])>>24&255)+Bt(ie>>16&255,N>>16&255,$>>16&255)+Bt(ie>>8&255,N>>8&255,$>>8&255)+Bt(255&ie,255&N,255&$)?ie:N},A.Predictor12=function(N,$,J){var ie=$[J+0];return(Ft((N>>24&255)+(ie>>24&255)-(($=$[J-1])>>24&255))<<24|Ft((N>>16&255)+(ie>>16&255)-($>>16&255))<<16|Ft((N>>8&255)+(ie>>8&255)-($>>8&255))<<8|Ft((255&N)+(255&ie)-(255&$)))>>>0},A.Predictor13=function(N,$,J){var ie=$[J-1];return(It((N=dt(N,$[J+0]))>>24&255,ie>>24&255)<<24|It(N>>16&255,ie>>16&255)<<16|It(N>>8&255,ie>>8&255)<<8|It(255&N,255&ie))>>>0};var Qc=A.PredictorAdd0;A.PredictorAdd1=Gt,Ze("Predictor2","PredictorAdd2"),Ze("Predictor3","PredictorAdd3"),Ze("Predictor4","PredictorAdd4"),Ze("Predictor5","PredictorAdd5"),Ze("Predictor6","PredictorAdd6"),Ze("Predictor7","PredictorAdd7"),Ze("Predictor8","PredictorAdd8"),Ze("Predictor9","PredictorAdd9"),Ze("Predictor10","PredictorAdd10"),Ze("Predictor11","PredictorAdd11"),Ze("Predictor12","PredictorAdd12"),Ze("Predictor13","PredictorAdd13");var Jc=A.PredictorAdd2;Xt("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),Xt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Dr,nf=A.ColorIndexInverseTransform,ll=A.MapARGB,Ql=A.VP8LColorIndexInverseTransformAlpha,La=A.MapAlpha,Jl=A.VP8LPredictorsAdd=[];Jl.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Eu,sf,Zl,Ec,cl,Ic,_o,Ac,Na,ul,yr,nr,F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr,Lc,fl,jf=a(511),Bm=a(2041),Ep=a(225),Mh=a(767),Um=0,rf=Bm,Th=Ep,Bo=Mh,xo=jf,Ip=0,Uo=1,Vm=2,ec=3,Ap=4,kh=5,af=6,Lp=7,Wm=8,Pd=9,Gm=10,Nc=[2,3,7],$d=[3,3,11],jd=[280,256,256,256,40],Hm=[0,1,1,1,0],Eh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Dc=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Oc=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],of=8,Pc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],$c=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Il=null,$1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],t0=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Np=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],j1=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Co=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Mi=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],mr=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],dl=[],Qi=[],Zc=[],Rf=1,qm=2,lf=[],So=[];Xc("UpsampleRgbLinePair",xc,3),Xc("UpsampleBgrLinePair",Xi,3),Xc("UpsampleRgbaLinePair",Ia,4),Xc("UpsampleBgraLinePair",El,4),Xc("UpsampleArgbLinePair",$f,4),Xc("UpsampleRgba4444LinePair",Cc,2),Xc("UpsampleRgb565LinePair",kl,2);var Ff=A.UpsampleRgbLinePair,n0=A.UpsampleBgrLinePair,Ih=A.UpsampleRgbaLinePair,Dp=A.UpsampleBgraLinePair,zf=A.UpsampleArgbLinePair,Iu=A.UpsampleRgba4444LinePair,cf=A.UpsampleRgb565LinePair,jc=16,Ah=1<<jc-1,Bf=-227,Uf=482,Ym=6,Vf=0,Mo=a(256),Op=a(256),R1=a(256),yw=a(256),F1=a(Uf-Bf),bw=a(Uf-Bf);ql("YuvToRgbRow",xc,3),ql("YuvToBgrRow",Xi,3),ql("YuvToRgbaRow",Ia,4),ql("YuvToBgraRow",El,4),ql("YuvToArgbRow",$f,4),ql("YuvToRgba4444Row",Cc,2),ql("YuvToRgb565Row",kl,2);var xa=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Rd=[0,2,8],Pp=[8,7,6,4,4,2,2,2,1,1,1,1],$p=1;this.WebPDecodeRGBA=function(N,$,J,ie,ye){var _e=Uo,xe=new Ht,Ae=new Qn;xe.ba=Ae,Ae.S=_e,Ae.width=[Ae.width],Ae.height=[Ae.height];var De=Ae.width,Re=Ae.height,tt=new On;if(tt==null||N==null)var St=2;else e(tt!=null),St=Kl(N,$,J,tt.width,tt.height,tt.Pd,tt.Qd,tt.format,null);if(St!=0?De=0:(De!=null&&(De[0]=tt.width[0]),Re!=null&&(Re[0]=tt.height[0]),De=1),De){Ae.width=Ae.width[0],Ae.height=Ae.height[0],ie!=null&&(ie[0]=Ae.width),ye!=null&&(ye[0]=Ae.height);e:{if(ie=new bo,(ye=new nn).data=N,ye.w=$,ye.ha=J,ye.kd=1,$=[0],e(ye!=null),((N=Kl(ye.data,ye.w,ye.ha,null,null,null,$,null,ye))==0||N==7)&&$[0]&&(N=4),($=N)==0){if(e(xe!=null),ie.data=ye.data,ie.w=ye.w+ye.offset,ie.ha=ye.ha-ye.offset,ie.put=Fn,ie.ac=ir,ie.bc=fs,ie.ma=xe,ye.xa){if((N=vs())==null){xe=1;break e}if((function(je,ct){var gt=[0],Ut=[0],_t=[0];t:for(;;){if(je==null)return 0;if(ct==null)return je.a=2,0;if(je.l=ct,je.a=0,ne(je.m,ct.data,ct.w,ct.ha),!ro(je.m,gt,Ut,_t)){je.a=3;break t}if(je.xb=qm,ct.width=gt[0],ct.height=Ut[0],!_s(gt[0],Ut[0],1,je,null))break t;return 1}return e(je.a!=0),0})(N,ie)){if(ie=($=Xl(ie.width,ie.height,xe.Oa,xe.ba))==0){t:{ie=N;n:for(;;){if(ie==null){ie=0;break t}if(e(ie.s.yc!=null),e(ie.s.Ya!=null),e(0<ie.s.Wb),e((J=ie.l)!=null),e((ye=J.ma)!=null),ie.xb!=0){if(ie.ca=ye.ba,ie.tb=ye.tb,e(ie.ca!=null),!Sc(ye.Oa,J,ec)){ie.a=2;break n}if(!Vr(ie,J.width)||J.da)break n;if((J.da||os(ie.ca.S))&&ol(),11>ie.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ie.ca.f.kb.F!=null&&ol()),ie.Pb&&0<ie.s.ua&&ie.s.vb.X==null&&!de(ie.s.vb,ie.s.Wa.Xa)){ie.a=1;break n}ie.xb=0}if(!Gn(ie,ie.V,ie.Ba,ie.c,ie.i,J.o,Et))break n;ye.Dc=ie.Ma,ie=1;break t}e(ie.a!=0),ie=0}ie=!ie}ie&&($=N.a)}else $=N.a}else{if((N=new Wa)==null){xe=1;break e}if(N.Fa=ye.na,N.P=ye.P,N.qc=ye.Sa,Zt(N,ie)){if(($=Xl(ie.width,ie.height,xe.Oa,xe.ba))==0){if(N.Aa=0,J=xe.Oa,e((ye=N)!=null),J!=null){if(0<(De=0>(De=J.Md)?0:100<De?255:255*De/100)){for(Re=tt=0;4>Re;++Re)12>(St=ye.pb[Re]).lc&&(St.ia=De*Pp[0>St.lc?0:St.lc]>>3),tt|=St.ia;tt&&(alert("todo:VP8InitRandom"),ye.ia=1)}ye.Ga=J.Id,100<ye.Ga?ye.Ga=100:0>ye.Ga&&(ye.Ga=0)}(function(je,ct){if(je==null)return 0;if(ct==null)return Us(je,2,"NULL VP8Io parameter in VP8Decode().");if(!je.cb&&!Zt(je,ct))return 0;if(e(je.cb),ct.ac==null||ct.ac(ct)){ct.ob&&(je.L=0);var gt=Rd[je.L];if(je.L==2?(je.yb=0,je.zb=0):(je.yb=ct.v-gt>>4,je.zb=ct.j-gt>>4,0>je.yb&&(je.yb=0),0>je.zb&&(je.zb=0)),je.Va=ct.o+15+gt>>4,je.Hb=ct.va+15+gt>>4,je.Hb>je.za&&(je.Hb=je.za),je.Va>je.Ub&&(je.Va=je.Ub),0<je.L){var Ut=je.ed;for(gt=0;4>gt;++gt){var _t;if(je.Qa.Cb){var zt=je.Qa.Lb[gt];je.Qa.Fb||(zt+=Ut.Tb)}else zt=Ut.Tb;for(_t=0;1>=_t;++_t){var Yt=je.gd[gt][_t],dn=zt;if(Ut.Pc&&(dn+=Ut.vd[0],_t&&(dn+=Ut.od[0])),0<(dn=0>dn?0:63<dn?63:dn)){var en=dn;0<Ut.wb&&(en=4<Ut.wb?en>>2:en>>1)>9-Ut.wb&&(en=9-Ut.wb),1>en&&(en=1),Yt.dd=en,Yt.tc=2*dn+en,Yt.ld=40<=dn?2:15<=dn?1:0}else Yt.tc=0;Yt.La=_t}}}gt=0}else Us(je,6,"Frame setup failed"),gt=je.a;if(gt=gt==0){if(gt){je.$c=0,0<je.Aa||(je.Ic=$p);t:{gt=je.Ic,Ut=4*(en=je.za);var Yn=32*en,jn=en+1,Ds=0<je.L?en*(0<je.Aa?2:1):0,Wn=(je.Aa==2?2:1)*en;if((Yt=Ut+832+(_t=3*(16*gt+Rd[je.L])/2*Yn)+(zt=je.Fa!=null&&0<je.Fa.length?je.Kc.c*je.Kc.i:0))!=Yt)gt=0;else{if(Yt>je.Vb){if(je.Vb=0,je.Ec=a(Yt),je.Fc=0,je.Ec==null){gt=Us(je,1,"no memory during frame initialization.");break t}je.Vb=Yt}Yt=je.Ec,dn=je.Fc,je.Ac=Yt,je.Bc=dn,dn+=Ut,je.Gd=o(Yn,rl),je.Hd=0,je.rb=o(jn+1,wa),je.sb=1,je.wa=Ds?o(Ds,oi):null,je.Y=0,je.D.Nb=0,je.D.wa=je.wa,je.D.Y=je.Y,0<je.Aa&&(je.D.Y+=en),e(!0),je.oc=Yt,je.pc=dn,dn+=832,je.ya=o(Wn,pi),je.aa=0,je.D.ya=je.ya,je.D.aa=je.aa,je.Aa==2&&(je.D.aa+=en),je.R=16*en,je.B=8*en,en=(Yn=Rd[je.L])*je.R,Yn=Yn/2*je.B,je.sa=Yt,je.ta=dn+en,je.qa=je.sa,je.ra=je.ta+16*gt*je.R+Yn,je.Ha=je.qa,je.Ia=je.ra+8*gt*je.B+Yn,je.$c=0,dn+=_t,je.mb=zt?Yt:null,je.nb=zt?dn:null,e(dn+zt<=je.Fc+je.Vb),In(je),r(je.Ac,je.Bc,0,Ut),gt=1}}if(gt){if(ct.ka=0,ct.y=je.sa,ct.O=je.ta,ct.f=je.qa,ct.N=je.ra,ct.ea=je.Ha,ct.Vd=je.Ia,ct.fa=je.R,ct.Rc=je.B,ct.F=null,ct.J=0,!Um){for(gt=-255;255>=gt;++gt)jf[255+gt]=0>gt?-gt:gt;for(gt=-1020;1020>=gt;++gt)Bm[1020+gt]=-128>gt?-128:127<gt?127:gt;for(gt=-112;112>=gt;++gt)Ep[112+gt]=-16>gt?-16:15<gt?15:gt;for(gt=-255;510>=gt;++gt)Mh[255+gt]=0>gt?0:255<gt?255:gt;Um=1}_o=Ve,Ac=ft,ul=oe,yr=Ne,nr=Ue,Na=Of,F=Ch,ee=Kc,he=me,be=Fe,Le=Sh,rt=Y,$t=Je,an=pt,vn=Hc,Rn=qc,Es=ef,Js=Nd,Qi[0]=Ml,Qi[1]=Rt,Qi[2]=Lr,Qi[3]=wo,Qi[4]=Fr,Qi[5]=Qr,Qi[6]=Si,Qi[7]=mi,Qi[8]=io,Qi[9]=Wr,dl[0]=ds,dl[1]=bn,dl[2]=_n,dl[3]=mn,dl[4]=Ar,dl[5]=Ci,dl[6]=Sr,Zc[0]=Di,Zc[1]=wn,Zc[2]=Ha,Zc[3]=Yi,Zc[4]=Qs,Zc[5]=Gr,Zc[6]=Nr,gt=1}else gt=0}gt&&(gt=(function(ar,Pi){for(ar.M=0;ar.M<ar.Va;++ar.M){var Fs,$n=ar.Jc[ar.M&ar.Xb],Sn=ar.m,Ji=ar;for(Fs=0;Fs<Ji.za;++Fs){var Cs=Sn,Vs=Ji,Zr=Vs.Ac,Da=Vs.Bc+4*Fs,To=Vs.zc,Ti=Vs.ya[Vs.aa+Fs];if(Vs.Qa.Bb?Ti.$b=Me(Cs,Vs.Pa.jb[0])?2+Me(Cs,Vs.Pa.jb[2]):Me(Cs,Vs.Pa.jb[1]):Ti.$b=0,Vs.kc&&(Ti.Ad=Me(Cs,Vs.Bd)),Ti.Za=!Me(Cs,145)+0,Ti.Za){var Ca=Ti.Ob,Vo=0;for(Vs=0;4>Vs;++Vs){var Oa,Ys=To[0+Vs];for(Oa=0;4>Oa;++Oa){Ys=Co[Zr[Da+Oa]][Ys];for(var Or=Np[Me(Cs,Ys[0])];0<Or;)Or=Np[2*Or+Me(Cs,Ys[Or])];Ys=-Or,Zr[Da+Oa]=Ys}s(Ca,Vo,Zr,Da,4),Vo+=4,To[0+Vs]=Ys}}else Ys=Me(Cs,156)?Me(Cs,128)?1:3:Me(Cs,163)?2:0,Ti.Ob[0]=Ys,r(Zr,Da,Ys,4),r(To,0,Ys,4);Ti.Dd=Me(Cs,142)?Me(Cs,114)?Me(Cs,183)?1:3:2:0}if(Ji.m.Ka)return Us(ar,7,"Premature end-of-partition0 encountered.");for(;ar.ja<ar.za;++ar.ja){if(Ji=$n,Cs=(Sn=ar).rb[Sn.sb-1],Zr=Sn.rb[Sn.sb+Sn.ja],Fs=Sn.ya[Sn.aa+Sn.ja],Da=Sn.kc?Fs.Ad:0)Cs.la=Zr.la=0,Fs.Za||(Cs.Na=Zr.Na=0),Fs.Hc=0,Fs.Gc=0,Fs.ia=0;else{var Zi,Mr;if(Cs=Zr,Zr=Ji,Da=Sn.Pa.Xc,To=Sn.ya[Sn.aa+Sn.ja],Ti=Sn.pb[To.$b],Vs=To.ad,Ca=0,Vo=Sn.rb[Sn.sb-1],Ys=Oa=0,r(Vs,Ca,0,384),To.Za)var qa=0,ea=Da[3];else{Or=a(16);var Tr=Cs.Na+Vo.Na;if(Tr=Il(Zr,Da[1],Tr,Ti.Eb,0,Or,0),Cs.Na=Vo.Na=(0<Tr)+0,1<Tr)_o(Or,0,Vs,Ca);else{var oa=Or[0]+3>>3;for(Or=0;256>Or;Or+=16)Vs[Ca+Or]=oa}qa=1,ea=Da[0]}var ei=15&Cs.la,Sa=15&Vo.la;for(Or=0;4>Or;++Or){var Pa=1&Sa;for(oa=Mr=0;4>oa;++oa)ei=ei>>1|(Pa=(Tr=Il(Zr,ea,Tr=Pa+(1&ei),Ti.Sc,qa,Vs,Ca))>qa)<<7,Mr=Mr<<2|(3<Tr?3:1<Tr?2:Vs[Ca+0]!=0),Ca+=16;ei>>=4,Sa=Sa>>1|Pa<<7,Oa=(Oa<<8|Mr)>>>0}for(ea=ei,qa=Sa>>4,Zi=0;4>Zi;Zi+=2){for(Mr=0,ei=Cs.la>>4+Zi,Sa=Vo.la>>4+Zi,Or=0;2>Or;++Or){for(Pa=1&Sa,oa=0;2>oa;++oa)Tr=Pa+(1&ei),ei=ei>>1|(Pa=0<(Tr=Il(Zr,Da[2],Tr,Ti.Qc,0,Vs,Ca)))<<3,Mr=Mr<<2|(3<Tr?3:1<Tr?2:Vs[Ca+0]!=0),Ca+=16;ei>>=2,Sa=Sa>>1|Pa<<5}Ys|=Mr<<4*Zi,ea|=ei<<4<<Zi,qa|=(240&Sa)<<Zi}Cs.la=ea,Vo.la=qa,To.Hc=Oa,To.Gc=Ys,To.ia=43690&Ys?0:Ti.ia,Da=!(Oa|Ys)}if(0<Sn.L&&(Sn.wa[Sn.Y+Sn.ja]=Sn.gd[Fs.$b][Fs.Za],Sn.wa[Sn.Y+Sn.ja].La|=!Da),Ji.Ka)return Us(ar,7,"Premature end-of-file encountered.")}if(In(ar),Sn=Pi,Ji=1,Fs=($n=ar).D,Cs=0<$n.L&&$n.M>=$n.zb&&$n.M<=$n.Va,$n.Aa==0)t:{if(Fs.M=$n.M,Fs.uc=Cs,zo($n,Fs),Ji=1,Fs=(Mr=$n.D).Nb,Cs=(Ys=Rd[$n.L])*$n.R,Zr=Ys/2*$n.B,Or=16*Fs*$n.R,oa=8*Fs*$n.B,Da=$n.sa,To=$n.ta-Cs+Or,Ti=$n.qa,Vs=$n.ra-Zr+oa,Ca=$n.Ha,Vo=$n.Ia-Zr+oa,Sa=(ei=Mr.M)==0,Oa=ei>=$n.Va-1,$n.Aa==2&&zo($n,Mr),Mr.uc)for(Pa=(Tr=$n).D.M,e(Tr.D.uc),Mr=Tr.yb;Mr<Tr.Hb;++Mr){qa=Mr,ea=Pa;var yi=(or=(Ma=Tr).D).Nb;Zi=Ma.R;var or=or.wa[or.Y+qa],ko=Ma.sa,la=Ma.ta+16*yi*Zi+16*qa,ms=or.dd,ys=or.tc;if(ys!=0)if(e(3<=ys),Ma.L==1)0<qa&&Rn(ko,la,Zi,ys+4),or.La&&Js(ko,la,Zi,ys),0<ea&&vn(ko,la,Zi,ys+4),or.La&&Es(ko,la,Zi,ys);else{var kr=Ma.B,Al=Ma.qa,Rc=Ma.ra+8*yi*kr+8*qa,hl=Ma.Ha,Ma=Ma.Ia+8*yi*kr+8*qa;yi=or.ld,0<qa&&(ee(ko,la,Zi,ys+4,ms,yi),be(Al,Rc,hl,Ma,kr,ys+4,ms,yi)),or.La&&(rt(ko,la,Zi,ys,ms,yi),an(Al,Rc,hl,Ma,kr,ys,ms,yi)),0<ea&&(F(ko,la,Zi,ys+4,ms,yi),he(Al,Rc,hl,Ma,kr,ys+4,ms,yi)),or.La&&(Le(ko,la,Zi,ys,ms,yi),$t(Al,Rc,hl,Ma,kr,ys,ms,yi))}}if($n.ia&&alert("todo:DitherRow"),Sn.put!=null){if(Mr=16*ei,ei=16*(ei+1),Sa?(Sn.y=$n.sa,Sn.O=$n.ta+Or,Sn.f=$n.qa,Sn.N=$n.ra+oa,Sn.ea=$n.Ha,Sn.W=$n.Ia+oa):(Mr-=Ys,Sn.y=Da,Sn.O=To,Sn.f=Ti,Sn.N=Vs,Sn.ea=Ca,Sn.W=Vo),Oa||(ei-=Ys),ei>Sn.o&&(ei=Sn.o),Sn.F=null,Sn.J=null,$n.Fa!=null&&0<$n.Fa.length&&Mr<ei&&(Sn.J=Jr($n,Sn,Mr,ei-Mr),Sn.F=$n.mb,Sn.F==null&&Sn.F.length==0)){Ji=Us($n,3,"Could not decode alpha data.");break t}Mr<Sn.j&&(Ys=Sn.j-Mr,Mr=Sn.j,e(!(1&Ys)),Sn.O+=$n.R*Ys,Sn.N+=$n.B*(Ys>>1),Sn.W+=$n.B*(Ys>>1),Sn.F!=null&&(Sn.J+=Sn.width*Ys)),Mr<ei&&(Sn.O+=Sn.v,Sn.N+=Sn.v>>1,Sn.W+=Sn.v>>1,Sn.F!=null&&(Sn.J+=Sn.v),Sn.ka=Mr-Sn.j,Sn.U=Sn.va-Sn.v,Sn.T=ei-Mr,Ji=Sn.put(Sn))}Fs+1!=$n.Ic||Oa||(s($n.sa,$n.ta-Cs,Da,To+16*$n.R,Cs),s($n.qa,$n.ra-Zr,Ti,Vs+8*$n.B,Zr),s($n.Ha,$n.Ia-Zr,Ca,Vo+8*$n.B,Zr))}if(!Ji)return Us(ar,6,"Output aborted.")}return 1})(je,ct)),ct.bc!=null&&ct.bc(ct),gt&=1}return gt?(je.cb=0,gt):0})(N,ie)||($=N.a)}}else $=N.a}$==0&&xe.Oa!=null&&xe.Oa.fd&&($=Od(xe.ba))}xe=$}_e=xe!=0?null:11>_e?Ae.f.RGBA.eb:Ae.f.kb.y}else _e=null;return _e};var jp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(A,D){for(var L="",P=0;P<4;P++)L+=String.fromCharCode(A[D++]);return L}function f(A,D){return A[D+0]|A[D+1]<<8}function d(A,D){return(A[D+0]|A[D+1]<<8|A[D+2]<<16)>>>0}function h(A,D){return(A[D+0]|A[D+1]<<8|A[D+2]<<16|A[D+3]<<24)>>>0}new c;var p=[0],g=[0],b=[],v=new c,w=n,x=(function(A,D){var L={},P=0,j=!1,G=0,Q=0;if(L.frames=[],!(function(R,B){for(var W=0;W<4;W++)if(R[B+W]!="RIFF".charCodeAt(W))return!0;return!1})(A,D)){for(h(A,D+=4),D+=8;D<A.length;){var q=u(A,D),te=h(A,D+=4);D+=4;var Z=te+(1&te);switch(q){case"VP8 ":case"VP8L":L.frames[P]===void 0&&(L.frames[P]={}),(H=L.frames[P]).src_off=j?Q:D-8,H.src_size=G+te+8,P++,j&&(j=!1,G=0,Q=0);break;case"VP8X":(H=L.header={}).feature_flags=A[D];var ne=D+4;H.canvas_width=1+d(A,ne),ne+=3,H.canvas_height=1+d(A,ne),ne+=3;break;case"ALPH":j=!0,G=Z+8,Q=D-8;break;case"ANIM":(H=L.header).bgcolor=h(A,D),ne=D+4,H.loop_count=f(A,ne),ne+=2;break;case"ANMF":var le,H;(H=L.frames[P]={}).offset_x=2*d(A,D),D+=3,H.offset_y=2*d(A,D),D+=3,H.width=1+d(A,D),D+=3,H.height=1+d(A,D),D+=3,H.duration=d(A,D),D+=3,le=A[D++],H.dispose=1&le,H.blend=le>>1&1}q!="ANMF"&&(D+=Z)}return L}})(w,0);x.response=w,x.rgbaoutput=!0,x.dataurl=!1;var S=x.header?x.header:null,C=x.frames?x.frames:null;if(S){S.loop_counter=S.loop_count,p=[S.canvas_height],g=[S.canvas_width];for(var M=0;M<C.length&&C[M].blend!=0;M++);}var k=C[0],E=v.WebPDecodeRGBA(w,k.src_off,k.src_size,g,p);k.rgba=E,k.imgwidth=g[0],k.imgheight=p[0];for(var I=0;I<g[0]*p[0]*4;I++)b[I]=E[I];return this.width=g,this.height=p,this.data=b,this}(function(n){var e,t,s,r,a,o,l,c,u,f=function(R){return R=R||{},this.isStrokeTransparent=R.isStrokeTransparent||!1,this.strokeOpacity=R.strokeOpacity||1,this.strokeStyle=R.strokeStyle||"#000000",this.fillStyle=R.fillStyle||"#000000",this.isFillTransparent=R.isFillTransparent||!1,this.fillOpacity=R.fillOpacity||1,this.font=R.font||"10px sans-serif",this.textBaseline=R.textBaseline||"alphabetic",this.textAlign=R.textAlign||"left",this.lineWidth=R.lineWidth||1,this.lineJoin=R.lineJoin||"miter",this.lineCap=R.lineCap||"butt",this.path=R.path||[],this.transform=R.transform!==void 0?R.transform.clone():new c,this.globalCompositeOperation=R.globalCompositeOperation||"normal",this.globalAlpha=R.globalAlpha||1,this.clip_path=R.clip_path||[],this.currentPoint=R.currentPoint||new o,this.miterLimit=R.miterLimit||10,this.lastPoint=R.lastPoint||new o,this.lineDashOffset=R.lineDashOffset||0,this.lineDash=R.lineDash||[],this.margin=R.margin||[0,0,0,0],this.prevPageLastElemOffset=R.prevPageLastElemOffset||0,this.ignoreClearRect=typeof R.ignoreClearRect!="boolean"||R.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var d=function(R){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var B=R;Object.defineProperty(this,"pdf",{get:function(){return B}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(de){W=!!de}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(de){se=!!de}});var ue=0;Object.defineProperty(this,"posX",{get:function(){return ue},set:function(de){isNaN(de)||(ue=de)}});var ge=0;Object.defineProperty(this,"posY",{get:function(){return ge},set:function(de){isNaN(de)||(ge=de)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(de){var Be;typeof de=="number"?Be=[de,de,de,de]:((Be=new Array(4))[0]=de[0],Be[1]=de.length>=2?de[1]:Be[0],Be[2]=de.length>=3?de[2]:Be[0],Be[3]=de.length>=4?de[3]:Be[1]),u.margin=Be}});var Ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ce},set:function(de){Ce=de}});var Se=0;Object.defineProperty(this,"lastBreak",{get:function(){return Se},set:function(de){Se=de}});var Me=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Me},set:function(de){Me=de}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(de){de instanceof f&&(u=de)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(de){u.path=de}});var pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return pe},set:function(de){pe=de}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(de){var Be;Be=h(de),this.ctx.fillStyle=Be.style,this.ctx.isFillTransparent=Be.a===0,this.ctx.fillOpacity=Be.a,this.pdf.setFillColor(Be.r,Be.g,Be.b,{a:Be.a}),this.pdf.setTextColor(Be.r,Be.g,Be.b,{a:Be.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(de){var Be=h(de);this.ctx.strokeStyle=Be.style,this.ctx.isStrokeTransparent=Be.a===0,this.ctx.strokeOpacity=Be.a,Be.a===0?this.pdf.setDrawColor(255,255,255):(Be.a,this.pdf.setDrawColor(Be.r,Be.g,Be.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(de){["butt","round","square"].indexOf(de)!==-1&&(this.ctx.lineCap=de,this.pdf.setLineCap(de))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(de){isNaN(de)||(this.ctx.lineWidth=de,this.pdf.setLineWidth(de))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(de){["bevel","round","miter"].indexOf(de)!==-1&&(this.ctx.lineJoin=de,this.pdf.setLineJoin(de))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(de){isNaN(de)||(this.ctx.miterLimit=de,this.pdf.setMiterLimit(de))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(de){this.ctx.textBaseline=de}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(de){["right","end","center","left","start"].indexOf(de)!==-1&&(this.ctx.textAlign=de)}});var fe=null,$e=null,We=null;Object.defineProperty(this,"fontFaces",{get:function(){return We},set:function(de){fe=null,$e=null,We=de}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(de){var Be;if(this.ctx.font=de,(Be=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(de))!==null){var st=Be[1];Be[2];var He=Be[3],Xe=Be[4];Be[5];var Ke=Be[6],Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Xe)[2];Xe=Math.floor(Ze==="px"?parseFloat(Xe)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(Xe)*this.pdf.getFontSize():parseFloat(Xe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Xe);var xt=(function(Xt){var us,yn,En=[],Vn=Xt.trim();if(Vn==="")return B3;if(Vn in FW)return[FW[Vn]];for(;Vn!=="";){switch(yn=null,us=(Vn=BW(Vn)).charAt(0)){case'"':case"'":yn=h2e(Vn.substring(1),us);break;default:yn=p2e(Vn)}if(yn===null||(En.push(yn[0]),(Vn=BW(yn[1]))!==""&&Vn.charAt(0)!==","))return B3;Vn=Vn.replace(/^,/,"")}return En})(Ke);if(this.fontFaces){var dt=(function(Xt,us){var yn=Xt.getFontList(),En=JSON.stringify(yn);if(fe===null||$e!==En){var Vn=(function(Nn){var Dn=[];return Object.keys(Nn).forEach(function(gr){Nn[gr].forEach(function(os){var ps=null;switch(os){case"bold":ps={family:gr,weight:"bold"};break;case"italic":ps={family:gr,style:"italic"};break;case"bolditalic":ps={family:gr,weight:"bold",style:"italic"};break;case"":case"normal":ps={family:gr}}ps!==null&&(ps.ref={name:gr,style:os},Dn.push(ps))})}),Dn})(yn);fe=(function(Nn){for(var Dn={},gr=0;gr<Nn.length;++gr){var os=z3(Nn[gr]),ps=os.family,Ss=os.stretch,Qn=os.style,On=os.weight;Dn[ps]=Dn[ps]||{},Dn[ps][Ss]=Dn[ps][Ss]||{},Dn[ps][Ss][Qn]=Dn[ps][Ss][Qn]||{},Dn[ps][Ss][Qn][On]=os}return Dn})(Vn.concat(us)),$e=En}return fe})(this.pdf,this.fontFaces),Ft=xt.map(function(Xt){return{family:Xt,stretch:"normal",weight:He,style:st}}),It=(function(Xt,us,yn){for(var En=(yn=yn||{}).defaultFontFamily||"times",Vn=Object.assign({},d2e,yn.genericFontFamilies||{}),Nn=null,Dn=null,gr=0;gr<us.length;++gr)if(Vn[(Nn=z3(us[gr])).family]&&(Nn.family=Vn[Nn.family]),Xt.hasOwnProperty(Nn.family)){Dn=Xt[Nn.family];break}if(!(Dn=Dn||Xt[En]))throw new Error("Could not find a font-family for the rule '"+zW(Nn)+"' and default family '"+En+"'.");if(Dn=(function(os,ps){if(ps[os])return ps[os];var Ss=iR[os],Qn=Ss<=iR.normal?-1:1,On=RW(ps,Hne,Ss,Qn);if(!On)throw new Error("Could not find a matching font-stretch value for "+os);return On})(Nn.stretch,Dn),Dn=(function(os,ps){if(ps[os])return ps[os];for(var Ss=Gne[os],Qn=0;Qn<Ss.length;++Qn)if(ps[Ss[Qn]])return ps[Ss[Qn]];throw new Error("Could not find a matching font-style for "+os)})(Nn.style,Dn),!(Dn=(function(os,ps){if(ps[os])return ps[os];if(os===400&&ps[500])return ps[500];if(os===500&&ps[400])return ps[400];var Ss=f2e[os],Qn=RW(ps,qne,Ss,os<400?-1:1);if(!Qn)throw new Error("Could not find a matching font-weight for value "+os);return Qn})(Nn.weight,Dn)))throw new Error("Failed to resolve a font for the rule '"+zW(Nn)+"'.");return Dn})(dt,Ft);this.pdf.setFont(It.ref.name,It.ref.style)}else{var Bt="";(He==="bold"||parseInt(He,10)>=700||st==="bold")&&(Bt="bold"),st==="italic"&&(Bt+="italic"),Bt.length===0&&(Bt="normal");for(var Gt="",At={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ht=0;ht<xt.length;ht++){if(this.pdf.internal.getFont(xt[ht],Bt,{noFallback:!0,disableWarning:!0})!==void 0){Gt=xt[ht];break}if(Bt==="bolditalic"&&this.pdf.internal.getFont(xt[ht],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Gt=xt[ht],Bt="bold";else if(this.pdf.internal.getFont(xt[ht],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Gt=xt[ht],Bt="normal";break}}if(Gt===""){for(var Qt=0;Qt<xt.length;Qt++)if(At[xt[Qt]]){Gt=At[xt[Qt]];break}}Gt=Gt===""?"Times":Gt,this.pdf.setFont(Gt,Bt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(de){this.ctx.globalCompositeOperation=de}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(de){this.ctx.globalAlpha=de}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(de){this.ctx.lineDashOffset=de,H.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(de){this.ctx.lineDash=de,H.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(de){this.ctx.ignoreClearRect=!!de}})};d.prototype.setLineDash=function(R){this.lineDash=R},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){C.call(this,"fill",!1)},d.prototype.stroke=function(){C.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(R,B){if(isNaN(R)||isNaN(B))throw ha.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new o(R,B));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new o(R,B)},d.prototype.closePath=function(){var R=new o(0,0),B=0;for(B=this.path.length-1;B!==-1;B--)if(this.path[B].type==="begin"&&Wi(this.path[B+1])==="object"&&typeof this.path[B+1].x=="number"){R=new o(this.path[B+1].x,this.path[B+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(R.x,R.y)},d.prototype.lineTo=function(R,B){if(isNaN(R)||isNaN(B))throw ha.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new o(R,B));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},d.prototype.quadraticCurveTo=function(R,B,W,se){if(isNaN(W)||isNaN(se)||isNaN(R)||isNaN(B))throw ha.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ue=this.ctx.transform.applyToPoint(new o(W,se)),ge=this.ctx.transform.applyToPoint(new o(R,B));this.path.push({type:"qct",x1:ge.x,y1:ge.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new o(ue.x,ue.y)},d.prototype.bezierCurveTo=function(R,B,W,se,ue,ge){if(isNaN(ue)||isNaN(ge)||isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se))throw ha.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ce=this.ctx.transform.applyToPoint(new o(ue,ge)),Se=this.ctx.transform.applyToPoint(new o(R,B)),Me=this.ctx.transform.applyToPoint(new o(W,se));this.path.push({type:"bct",x1:Se.x,y1:Se.y,x2:Me.x,y2:Me.y,x:Ce.x,y:Ce.y}),this.ctx.lastPoint=new o(Ce.x,Ce.y)},d.prototype.arc=function(R,B,W,se,ue,ge){if(isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se)||isNaN(ue))throw ha.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ge=!!ge,!this.ctx.transform.isIdentity){var Ce=this.ctx.transform.applyToPoint(new o(R,B));R=Ce.x,B=Ce.y;var Se=this.ctx.transform.applyToPoint(new o(0,W)),Me=this.ctx.transform.applyToPoint(new o(0,0));W=Math.sqrt(Math.pow(Se.x-Me.x,2)+Math.pow(Se.y-Me.y,2))}Math.abs(ue-se)>=2*Math.PI&&(se=0,ue=2*Math.PI),this.path.push({type:"arc",x:R,y:B,radius:W,startAngle:se,endAngle:ue,counterclockwise:ge})},d.prototype.arcTo=function(R,B,W,se,ue){throw new Error("arcTo not implemented.")},d.prototype.rect=function(R,B,W,se){if(isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se))throw ha.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(R,B),this.lineTo(R+W,B),this.lineTo(R+W,B+se),this.lineTo(R,B+se),this.lineTo(R,B),this.lineTo(R+W,B),this.lineTo(R,B)},d.prototype.fillRect=function(R,B,W,se){if(isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se))throw ha.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ue={};this.lineCap!=="butt"&&(ue.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ue.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(R,B,W,se),this.fill(),ue.hasOwnProperty("lineCap")&&(this.lineCap=ue.lineCap),ue.hasOwnProperty("lineJoin")&&(this.lineJoin=ue.lineJoin)}},d.prototype.strokeRect=function(R,B,W,se){if(isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se))throw ha.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(R,B,W,se),this.stroke())},d.prototype.clearRect=function(R,B,W,se){if(isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se))throw ha.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(R,B,W,se))},d.prototype.save=function(R){R=typeof R!="boolean"||R;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(B),R){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},d.prototype.restore=function(R){R=typeof R!="boolean"||R;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(B),R&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(R){var B,W,se,ue;if(R.isCanvasGradient===!0&&(R=R.getColor()),!R)return{r:0,g:0,b:0,a:0,style:R};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(R))B=0,W=0,se=0,ue=0;else{var ge=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(R);if(ge!==null)B=parseInt(ge[1]),W=parseInt(ge[2]),se=parseInt(ge[3]),ue=1;else if((ge=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(R))!==null)B=parseInt(ge[1]),W=parseInt(ge[2]),se=parseInt(ge[3]),ue=parseFloat(ge[4]);else{if(ue=1,typeof R=="string"&&R.charAt(0)!=="#"){var Ce=new Rne(R);R=Ce.ok?Ce.toHex():"#000000"}R.length===4?(B=R.substring(1,2),B+=B,W=R.substring(2,3),W+=W,se=R.substring(3,4),se+=se):(B=R.substring(1,3),W=R.substring(3,5),se=R.substring(5,7)),B=parseInt(B,16),W=parseInt(W,16),se=parseInt(se,16)}}return{r:B,g:W,b:se,a:ue,style:R}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(R,B,W,se){if(isNaN(B)||isNaN(W)||typeof R!="string")throw ha.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!p.call(this)){var ue=Z(this.ctx.transform.rotation),ge=this.ctx.transform.scaleX;P.call(this,{text:R,x:B,y:W,scale:ge,angle:ue,align:this.textAlign,maxWidth:se})}},d.prototype.strokeText=function(R,B,W,se){if(isNaN(B)||isNaN(W)||typeof R!="string")throw ha.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){se=isNaN(se)?void 0:se;var ue=Z(this.ctx.transform.rotation),ge=this.ctx.transform.scaleX;P.call(this,{text:R,x:B,y:W,scale:ge,renderingMode:"stroke",angle:ue,align:this.textAlign,maxWidth:se})}},d.prototype.measureText=function(R){if(typeof R!="string")throw ha.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var B=this.pdf,W=this.pdf.internal.scaleFactor,se=B.internal.getFontSize(),ue=B.getStringUnitWidth(R)*se/B.internal.scaleFactor;return new function(ge){var Ce=(ge=ge||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ce}}),this}({width:ue*=Math.round(96*W/72*1e4)/1e4})},d.prototype.scale=function(R,B){if(isNaN(R)||isNaN(B))throw ha.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new c(R,0,0,B,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},d.prototype.rotate=function(R){if(isNaN(R))throw ha.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var B=new c(Math.cos(R),Math.sin(R),-Math.sin(R),Math.cos(R),0,0);this.ctx.transform=this.ctx.transform.multiply(B)},d.prototype.translate=function(R,B){if(isNaN(R)||isNaN(B))throw ha.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new c(1,0,0,1,R,B);this.ctx.transform=this.ctx.transform.multiply(W)},d.prototype.transform=function(R,B,W,se,ue,ge){if(isNaN(R)||isNaN(B)||isNaN(W)||isNaN(se)||isNaN(ue)||isNaN(ge))throw ha.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ce=new c(R,B,W,se,ue,ge);this.ctx.transform=this.ctx.transform.multiply(Ce)},d.prototype.setTransform=function(R,B,W,se,ue,ge){R=isNaN(R)?1:R,B=isNaN(B)?0:B,W=isNaN(W)?0:W,se=isNaN(se)?1:se,ue=isNaN(ue)?0:ue,ge=isNaN(ge)?0:ge,this.ctx.transform=new c(R,B,W,se,ue,ge)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(R,B,W,se,ue,ge,Ce,Se,Me){var pe=this.pdf.getImageProperties(R),fe=1,$e=1,We=1,de=1;se!==void 0&&Se!==void 0&&(We=Se/se,de=Me/ue,fe=pe.width/se*Se/se,$e=pe.height/ue*Me/ue),ge===void 0&&(ge=B,Ce=W,B=0,W=0),se!==void 0&&Se===void 0&&(Se=se,Me=ue),se===void 0&&Se===void 0&&(Se=pe.width,Me=pe.height);var Be=this.ctx.transform.decompose(),st=Z(Be.rotate.shx),He=new c,Xe=(He=(He=(He=He.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale)).applyToRectangle(new l(ge-B*We,Ce-W*de,se*fe,ue*$e));if(this.autoPaging){for(var Ke,Ze=v.call(this,Xe),xt=[],dt=0;dt<Ze.length;dt+=1)xt.indexOf(Ze[dt])===-1&&xt.push(Ze[dt]);S(xt);for(var Ft=xt[0],It=xt[xt.length-1],Bt=Ft;Bt<It+1;Bt++){this.pdf.setPage(Bt);var Gt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],At=Bt===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xt=Bt===1?0:ht+(Bt-2)*Qt;if(this.ctx.clip_path.length!==0){var us=this.path;Ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(Ke,this.posX+this.margin[3],-Xt+At+this.ctx.prevPageLastElemOffset),M.call(this,"fill",!0),this.path=us}var yn=JSON.parse(JSON.stringify(Xe));yn=x([yn],this.posX+this.margin[3],-Xt+At+this.ctx.prevPageLastElemOffset)[0];var En=(Bt>Ft||Bt<It)&&b.call(this);En&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Gt,Qt,null).clip().discardPath()),this.pdf.addImage(R,"JPEG",yn.x,yn.y,yn.w,yn.h,null,null,st),En&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(R,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,st)};var v=function(R,B,W){var se=[];B=B||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ue=this.posY+this.ctx.prevPageLastElemOffset;switch(R.type){default:case"mt":case"lt":se.push(Math.floor((R.y+ue)/W)+1);break;case"arc":se.push(Math.floor((R.y+ue-R.radius)/W)+1),se.push(Math.floor((R.y+ue+R.radius)/W)+1);break;case"qct":var ge=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x,R.y);se.push(Math.floor((ge.y+ue)/W)+1),se.push(Math.floor((ge.y+ge.h+ue)/W)+1);break;case"bct":var Ce=le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x2,R.y2,R.x,R.y);se.push(Math.floor((Ce.y+ue)/W)+1),se.push(Math.floor((Ce.y+Ce.h+ue)/W)+1);break;case"rect":se.push(Math.floor((R.y+ue)/W)+1),se.push(Math.floor((R.y+R.h+ue)/W)+1)}for(var Se=0;Se<se.length;Se+=1)for(;this.pdf.internal.getNumberOfPages()<se[Se];)w.call(this);return se},w=function(){var R=this.fillStyle,B=this.strokeStyle,W=this.font,se=this.lineCap,ue=this.lineWidth,ge=this.lineJoin;this.pdf.addPage(),this.fillStyle=R,this.strokeStyle=B,this.font=W,this.lineCap=se,this.lineWidth=ue,this.lineJoin=ge},x=function(R,B,W){for(var se=0;se<R.length;se++)switch(R[se].type){case"bct":R[se].x2+=B,R[se].y2+=W;case"qct":R[se].x1+=B,R[se].y1+=W;default:R[se].x+=B,R[se].y+=W}return R},S=function(R){return R.sort(function(B,W){return B-W})},C=function(R,B){var W=this.fillStyle,se=this.strokeStyle,ue=this.lineCap,ge=this.lineWidth,Ce=Math.abs(ge*this.ctx.transform.scaleX),Se=this.lineJoin;if(this.autoPaging){for(var Me,pe,fe=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),We=[],de=0;de<$e.length;de++)if($e[de].x!==void 0)for(var Be=v.call(this,$e[de]),st=0;st<Be.length;st+=1)We.indexOf(Be[st])===-1&&We.push(Be[st]);for(var He=0;He<We.length;He++)for(;this.pdf.internal.getNumberOfPages()<We[He];)w.call(this);S(We);for(var Xe=We[0],Ke=We[We.length-1],Ze=Xe;Ze<Ke+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=W,this.strokeStyle=se,this.lineCap=ue,this.lineWidth=Ce,this.lineJoin=Se;var xt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],dt=Ze===1?this.posY+this.margin[0]:this.margin[0],Ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],It=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Bt=Ze===1?0:Ft+(Ze-2)*It;if(this.ctx.clip_path.length!==0){var Gt=this.path;Me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(Me,this.posX+this.margin[3],-Bt+dt+this.ctx.prevPageLastElemOffset),M.call(this,R,!0),this.path=Gt}if(pe=JSON.parse(JSON.stringify(fe)),this.path=x(pe,this.posX+this.margin[3],-Bt+dt+this.ctx.prevPageLastElemOffset),B===!1||Ze===0){var At=(Ze>Xe||Ze<Ke)&&b.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xt,It,null).clip().discardPath()),M.call(this,R,B),At&&this.pdf.restoreGraphicsState()}this.lineWidth=ge}this.path=fe}else this.lineWidth=Ce,M.call(this,R,B),this.lineWidth=ge},M=function(R,B){if((R!=="stroke"||B||!g.call(this))&&(R==="stroke"||B||!p.call(this))){for(var W,se,ue=[],ge=this.path,Ce=0;Ce<ge.length;Ce++){var Se=ge[Ce];switch(Se.type){case"begin":ue.push({begin:!0});break;case"close":ue.push({close:!0});break;case"mt":ue.push({start:Se,deltas:[],abs:[]});break;case"lt":var Me=ue.length;if(ge[Ce-1]&&!isNaN(ge[Ce-1].x)&&(W=[Se.x-ge[Ce-1].x,Se.y-ge[Ce-1].y],Me>0)){for(;Me>=0;Me--)if(ue[Me-1].close!==!0&&ue[Me-1].begin!==!0){ue[Me-1].deltas.push(W),ue[Me-1].abs.push(Se);break}}break;case"bct":W=[Se.x1-ge[Ce-1].x,Se.y1-ge[Ce-1].y,Se.x2-ge[Ce-1].x,Se.y2-ge[Ce-1].y,Se.x-ge[Ce-1].x,Se.y-ge[Ce-1].y],ue[ue.length-1].deltas.push(W);break;case"qct":var pe=ge[Ce-1].x+2/3*(Se.x1-ge[Ce-1].x),fe=ge[Ce-1].y+2/3*(Se.y1-ge[Ce-1].y),$e=Se.x+2/3*(Se.x1-Se.x),We=Se.y+2/3*(Se.y1-Se.y),de=Se.x,Be=Se.y;W=[pe-ge[Ce-1].x,fe-ge[Ce-1].y,$e-ge[Ce-1].x,We-ge[Ce-1].y,de-ge[Ce-1].x,Be-ge[Ce-1].y],ue[ue.length-1].deltas.push(W);break;case"arc":ue.push({deltas:[],abs:[],arc:!0}),Array.isArray(ue[ue.length-1].abs)&&ue[ue.length-1].abs.push(Se)}}se=B?null:R==="stroke"?"stroke":"fill";for(var st=!1,He=0;He<ue.length;He++)if(ue[He].arc)for(var Xe=ue[He].abs,Ke=0;Ke<Xe.length;Ke++){var Ze=Xe[Ke];Ze.type==="arc"?I.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,B,!st):j.call(this,Ze.x,Ze.y),st=!0}else if(ue[He].close===!0)this.pdf.internal.out("h"),st=!1;else if(ue[He].begin!==!0){var xt=ue[He].start.x,dt=ue[He].start.y;G.call(this,ue[He].deltas,xt,dt),st=!0}se&&A.call(this,se),B&&D.call(this)}},k=function(R){var B=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=B*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return R-W;case"top":return R+B-W;case"hanging":return R+B-2*W;case"middle":return R+B/2-W;default:return R}},E=function(R){return R+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var R=function(){};return R.colorStops=[],R.addColorStop=function(B,W){this.colorStops.push([B,W])},R.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},R.isCanvasGradient=!0,R},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(R,B,W,se,ue,ge,Ce,Se,Me){for(var pe=q.call(this,W,se,ue,ge),fe=0;fe<pe.length;fe++){var $e=pe[fe];fe===0&&(Me?L.call(this,$e.x1+R,$e.y1+B):j.call(this,$e.x1+R,$e.y1+B)),Q.call(this,R,B,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}Se?D.call(this):A.call(this,Ce)},A=function(R){switch(R){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},D=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(R,B){this.pdf.internal.out(t(R)+" "+s(B)+" m")},P=function(R){var B;switch(R.align){case"right":case"end":B="right";break;case"center":B="center";break;default:B="left"}var W,se,ue,ge=this.pdf.getTextDimensions(R.text),Ce=k.call(this,R.y),Se=E.call(this,Ce)-ge.h,Me=this.ctx.transform.applyToPoint(new o(R.x,Ce));if(this.autoPaging){var pe=this.ctx.transform.decompose(),fe=new c;fe=(fe=(fe=fe.multiply(pe.translate)).multiply(pe.skew)).multiply(pe.scale);for(var $e=this.ctx.transform.applyToRectangle(new l(R.x,Ce,ge.w,ge.h)),We=fe.applyToRectangle(new l(R.x,Se,ge.w,ge.h)),de=v.call(this,We),Be=[],st=0;st<de.length;st+=1)Be.indexOf(de[st])===-1&&Be.push(de[st]);S(Be);for(var He=Be[0],Xe=Be[Be.length-1],Ke=He;Ke<Xe+1;Ke++){this.pdf.setPage(Ke);var Ze=Ke===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[2],Ft=dt-this.margin[0],It=this.pdf.internal.pageSize.width-this.margin[1],Bt=It-this.margin[3],Gt=Ke===1?0:xt+(Ke-2)*Ft;if(this.ctx.clip_path.length!==0){var At=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(W,this.posX+this.margin[3],-1*Gt+Ze),M.call(this,"fill",!0),this.path=At}var ht=x([JSON.parse(JSON.stringify(We))],this.posX+this.margin[3],-Gt+Ze+this.ctx.prevPageLastElemOffset)[0];R.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*R.scale),ue=this.lineWidth,this.lineWidth=ue*R.scale);var Qt=this.autoPaging!=="text";if(Qt||ht.y+ht.h<=dt){if(Qt||ht.y>=Ze&&ht.x<=It){var Xt=Qt?R.text:this.pdf.splitTextToSize(R.text,R.maxWidth||It-ht.x)[0],us=x([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Gt+Ze+this.ctx.prevPageLastElemOffset)[0],yn=Qt&&(Ke>He||Ke<Xe)&&b.call(this);yn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bt,Ft,null).clip().discardPath()),this.pdf.text(Xt,us.x,us.y,{angle:R.angle,align:B,renderingMode:R.renderingMode}),yn&&this.pdf.restoreGraphicsState()}}else ht.y<dt&&(this.ctx.prevPageLastElemOffset+=dt-ht.y);R.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=ue)}}else R.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*R.scale),ue=this.lineWidth,this.lineWidth=ue*R.scale),this.pdf.text(R.text,Me.x+this.posX,Me.y+this.posY,{angle:R.angle,align:B,renderingMode:R.renderingMode,maxWidth:R.maxWidth}),R.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=ue)},j=function(R,B,W,se){W=W||0,se=se||0,this.pdf.internal.out(t(R+W)+" "+s(B+se)+" l")},G=function(R,B,W){return this.pdf.lines(R,B,W,null,null)},Q=function(R,B,W,se,ue,ge,Ce,Se){this.pdf.internal.out([e(r(W+R)),e(a(se+B)),e(r(ue+R)),e(a(ge+B)),e(r(Ce+R)),e(a(Se+B)),"c"].join(" "))},q=function(R,B,W,se){for(var ue=2*Math.PI,ge=Math.PI/2;B>W;)B-=ue;var Ce=Math.abs(W-B);Ce<ue&&se&&(Ce=ue-Ce);for(var Se=[],Me=se?-1:1,pe=B;Ce>1e-5;){var fe=pe+Me*Math.min(Ce,ge);Se.push(te.call(this,R,pe,fe)),Ce-=Math.abs(fe-pe),pe=fe}return Se},te=function(R,B,W){var se=(W-B)/2,ue=R*Math.cos(se),ge=R*Math.sin(se),Ce=ue,Se=-ge,Me=Ce*Ce+Se*Se,pe=Me+Ce*ue+Se*ge,fe=4/3*(Math.sqrt(2*Me*pe)-pe)/(Ce*ge-Se*ue),$e=Ce-fe*Se,We=Se+fe*Ce,de=$e,Be=-We,st=se+B,He=Math.cos(st),Xe=Math.sin(st);return{x1:R*Math.cos(B),y1:R*Math.sin(B),x2:$e*He-We*Xe,y2:$e*Xe+We*He,x3:de*He-Be*Xe,y3:de*Xe+Be*He,x4:R*Math.cos(W),y4:R*Math.sin(W)}},Z=function(R){return 180*R/Math.PI},ne=function(R,B,W,se,ue,ge){var Ce=R+.5*(W-R),Se=B+.5*(se-B),Me=ue+.5*(W-ue),pe=ge+.5*(se-ge),fe=Math.min(R,ue,Ce,Me),$e=Math.max(R,ue,Ce,Me),We=Math.min(B,ge,Se,pe),de=Math.max(B,ge,Se,pe);return new l(fe,We,$e-fe,de-We)},le=function(R,B,W,se,ue,ge,Ce,Se){var Me,pe,fe,$e,We,de,Be,st,He,Xe,Ke,Ze,xt,dt,Ft=W-R,It=se-B,Bt=ue-W,Gt=ge-se,At=Ce-ue,ht=Se-ge;for(pe=0;pe<41;pe++)He=(Be=(fe=R+(Me=pe/40)*Ft)+Me*((We=W+Me*Bt)-fe))+Me*(We+Me*(ue+Me*At-We)-Be),Xe=(st=($e=B+Me*It)+Me*((de=se+Me*Gt)-$e))+Me*(de+Me*(ge+Me*ht-de)-st),pe==0?(Ke=He,Ze=Xe,xt=He,dt=Xe):(Ke=Math.min(Ke,He),Ze=Math.min(Ze,Xe),xt=Math.max(xt,He),dt=Math.max(dt,Xe));return new l(Math.round(Ke),Math.round(Ze),Math.round(xt-Ke),Math.round(dt-Ze))},H=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var R,B,W=(R=this.ctx.lineDash,B=this.ctx.lineDashOffset,JSON.stringify({lineDash:R,lineDashOffset:B}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(bs.API),(function(n){var e=function(o){var l,c,u,f,d,h,p,g,b,v;for(c=[],u=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>u;u+=4)(d=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(h=(d=((d=((d=((d=(d-(v=d%85))/85)-(b=d%85))/85)-(g=d%85))/85)-(p=d%85))/85)%85,c.push(h+33,p+33,g+33,b+33,v+33)):c.push(122);return(function(w,x){for(var S=x;S>0;S--)w.pop()})(c,l.length),String.fromCharCode.apply(String,c)+"~>"},t=function(o){var l,c,u,f,d,h=String,p="length",g=255,b="charCodeAt",v="slice",w="replace";for(o[v](-2),o=o[v](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),u=[],f=0,d=(o+=l="uuuuu"[v](o[p]%5||5))[p];d>f;f+=5)c=52200625*(o[b](f)-33)+614125*(o[b](f+1)-33)+7225*(o[b](f+2)-33)+85*(o[b](f+3)-33)+(o[b](f+4)-33),u.push(g&c>>24,g&c>>16,g&c>>8,g&c);return(function(x,S){for(var C=S;C>0;C--)x.pop()})(u,l[p]),h.fromCharCode.apply(h,u)},s=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Jj(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};n.processDataByFilters=function(o,l){var c=0,u=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=t(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=r(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=s(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}})(bs.API),(function(n){n.loadFile=function(e,t,s){return(function(r,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=(function(c,u,f){var d=new XMLHttpRequest,h=0,p=function(g){var b=g.length,v=[],w=String.fromCharCode;for(h=0;h<b;h+=1)v.push(w(255&g.charCodeAt(h)));return v.join("")};if(d.open("GET",c,!u),d.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(d.onload=function(){d.status===200?f(p(this.responseText)):f(void 0)}),d.send(null),u&&d.status===200)return p(d.responseText)})(r,a,o)}catch{}return l})(e,t,s)},n.loadImageFile=n.loadFile})(bs.API),(function(n){function e(){return(zs.html2canvas?Promise.resolve(zs.html2canvas):x3(()=>import("./html2canvas.esm-3ybT_T2r.js"),[],import.meta.url)).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(zs.DOMPurify?Promise.resolve(zs.DOMPurify):x3(()=>import("./purify.es-Bzr520pe.js"),[],import.meta.url)).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var s=function(l){var c=Wi(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},r=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},a=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)u!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||f.appendChild(l(d,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||(function(u){switch(s(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l),c){case"string":return this.then(t).then(function(u){return this.set({src:r("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var g=f[p],b=g.src.find(function(v){return v.format==="truetype"});b&&u.addFont(b.url,g.ref.name,g.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(s(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(s(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||bs.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,d){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(h){return u.updateProgress(null,f),h}).then(f,d).then(function(h){return u.updateProgress(1),h})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),h=u.call(d,l,c);return o.convert(h,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,bs.getPageSize=function(l,c,u){if(Wi(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var d,h=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var g,b=0,v=0;if(p.hasOwnProperty(h))b=p[h][1]/d,v=p[h][0]/d;else try{b=u[1],v=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",v>b&&(g=v,v=b,b=g);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",b>v&&(g=v,v=b,b=g)}return{width:v,height:b,unit:c,k:d,orientation:l}},n.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(z3):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}})(bs.API),bs.API.addJS=function(n){return VW=n,this.internal.events.subscribe("postPutResources",function(){CI=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(CI+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),UW=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+VW+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){CI!==void 0&&UW!==void 0&&this.internal.out("/Names <</JavaScript "+CI+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),a=0;a<r.length;a++){var o=r[a],l=s.exec(o);if(l!=null){var c=l[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(a=0;a<u;a++){var d=t.internal.newObject();f.push(d);var h=t.internal.getPageInfo(a+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),a=0;a<f.length;a++)t.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(s,r,a){var o={title:r,options:a,children:[]};return s==null&&(s=this.root),s.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(s){s.id=t.internal.newObjectDeferred();for(var r=0;r<s.children.length;r++)this.genIds_r(s.children[r])},t.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},t.outline.renderItems=function(s){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<s.children.length;a++){var o=s.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(s)),a>0&&this.line("/Prev "+this.makeRef(s.children[a-1])),a<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var u=0;u<s.children.length;u++)this.renderItems(s.children[u])},t.outline.line=function(s){this.ctx.val+=s+`\r
`},t.outline.makeRef=function(s){return s.id+" 0 R"},t.outline.makeString=function(s){return"("+t.internal.pdfEscape(s)+")"},t.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(s,r){for(var a=0;a<r.children.length;a++)s.count++,this.count_r(s,r.children[a]);return s.count}}])})(bs.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,s,r,a,o,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,c=(function(d){for(var h,p=256*d.charCodeAt(4)+d.charCodeAt(5),g=d.length,b={width:0,height:0,numcomponents:1},v=4;v<g;v+=2){if(v+=p,e.indexOf(d.charCodeAt(v+1))!==-1){h=256*d.charCodeAt(v+5)+d.charCodeAt(v+6),b={width:256*d.charCodeAt(v+7)+d.charCodeAt(v+8),height:h,numcomponents:d.charCodeAt(v+9)};break}p=256*d.charCodeAt(v+2)+d.charCodeAt(v+3)}return b})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:t,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:s,alias:r}}return f}})(bs.API),bs.API.processPNG=function(n,e,t,s){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var r,a=Qve(n,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,u=a.palette,f=a.depth;r=u&&c===1?(function(I){for(var A=I.width,D=I.height,L=I.data,P=I.palette,j=I.depth,G=!1,Q=[],q=[],te=void 0,Z=!1,ne=0,le=0;le<P.length;le++){var H=qV(P[le],4),R=H[0],B=H[1],W=H[2],se=H[3];Q.push(R,B,W),se!=null&&(se===0?(ne++,q.length<1&&q.push(le)):se<255&&(Z=!0))}if(Z||ne>1){G=!0,q=void 0;var ue=A*D;te=new Uint8Array(ue);for(var ge=new DataView(L.buffer),Ce=0;Ce<ue;Ce++){var Se=U3(ge,Ce,j),Me=qV(P[Se],4)[3];te[Ce]=Me}}else ne===0&&(q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:L,alphaBytes:te,needSMask:G,palette:Q,mask:q}})(a):c===2||c===4?(function(I){for(var A=I.data,D=I.width,L=I.height,P=I.channels,j=I.depth,G=P===2?"DeviceGray":"DeviceRGB",Q=P-1,q=D*L,te=Q,Z=q*te,ne=1*q,le=Math.ceil(Z*j/8),H=Math.ceil(ne*j/8),R=new Uint8Array(le),B=new Uint8Array(H),W=new DataView(A.buffer),se=new DataView(R.buffer),ue=new DataView(B.buffer),ge=!1,Ce=0;Ce<q;Ce++){for(var Se=Ce*P,Me=0;Me<te;Me++)JW(se,U3(W,Se+Me,j),Ce*te+Me,j);var pe=U3(W,Se+te,j);pe<(1<<j)-1&&(ge=!0),JW(ue,pe,1*Ce,j)}return{colorSpace:G,colorsPerPixel:Q,sMaskBitsPerComponent:ge?j:void 0,colorBytes:R,alphaBytes:B,needSMask:ge}})(a):(function(I){var A=I.data,D=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:D,colorsPerPixel:D==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?(function(L){for(var P=L.length,j=new Uint8Array(2*P),G=new DataView(j.buffer,j.byteOffset,j.byteLength),Q=0;Q<P;Q++)G.setUint16(2*Q,L[Q],!1);return j})(A):A,needSMask:!1}})(a);var d,h,p,g=r,b=g.colorSpace,v=g.colorsPerPixel,w=g.sMaskBitsPerComponent,x=g.colorBytes,S=g.alphaBytes,C=g.needSMask,M=g.palette,k=g.mask,E=null;return s!==bs.API.image_compression.NONE&&typeof Jj=="function"?(E=(function(I){var A;switch(I){case bs.API.image_compression.FAST:A=11;break;case bs.API.image_compression.MEDIUM:A=13;break;case bs.API.image_compression.SLOW:A=14;break;default:A=12}return A})(s),d=this.decode.FLATE_DECODE,h="/Predictor ".concat(E," /Colors ").concat(v," /BitsPerComponent ").concat(f," /Columns ").concat(o),n=qW(x,Math.ceil(o*v*f/8),v,f,s),C&&(p=qW(S,Math.ceil(o*w/8),1,w,s))):(d=void 0,h=void 0,n=x,C&&(p=S)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:t,data:n,index:e,filter:d,decodeParameters:h,transparency:k,palette:M,sMask:p,predictor:E,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:w,colorSpace:b}}},(function(n){n.processGIF89A=function(e,t,s,r){var a=new b2e(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},f=new V3(100).encode(u,100);return n.processJPEG.call(this,f,t,s,r)},n.processGIF87A=n.processGIF89A})(bs.API),Bh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:s,blue:t,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Bh.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){ha.log("bit decode error:"+t)}},Bh.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,r=0;r<e;r++)for(var a=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+8*r*4,l=0;l<8&&8*r+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}t!==0&&(this.pos+=4-t)}},Bh.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<n;r++){var a=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+2*r*4,l=a>>4,c=15&a,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*r+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Bh.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var r=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*s;if(r<this.palette.length){var o=this.palette[r];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}n!==0&&(this.pos+=4-n)}},Bh.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,u=a>>15?255:0,f=s*this.width*4+4*r;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=u}this.pos+=n}},Bh.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&t)/t*255|0,u=(o>>11)/e*255|0,f=r*this.width*4+4*a;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=n}},Bh.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=a,this.data[o+1]=r,this.data[o+2]=s,this.data[o+3]=255}this.pos+=this.width%4}},Bh.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=a,this.data[l+1]=r,this.data[l+2]=s,this.data[l+3]=o}},Bh.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,s,r){var a=new Bh(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new V3(100).encode(c,100);return n.processJPEG.call(this,u,t,s,r)}})(bs.API),eG.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,s,r){var a=new eG(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},u=new V3(100).encode(c,100);return n.processJPEG.call(this,u,t,s,r)}})(bs.API),bs.API.processRGBA=function(n,e,t){for(var s=n.data,r=s.length,a=new Uint8Array(r/4*3),o=new Uint8Array(r/4),l=0,c=0,u=0;u<r;u+=4){var f=s[u],d=s[u+1],h=s[u+2],p=s[u+3];a[l++]=f,a[l++]=d,a[l++]=h,o[c++]=p}var g=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:g,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},bs.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},pv=bs.API,SI=pv.getCharWidthsArray=function(n,e){var t,s,r=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:r.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:r.metadata.Unicode.kerning,f=u.fof?u.fof:1,d=e.doKerning!==!1,h=0,p=n.length,g=0,b=l[0]||c,v=[];for(t=0;t<p;t++)s=n.charCodeAt(t),typeof r.metadata.widthOfString=="function"?v.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(s))+o*(1e3/a)||0)/1e3):(h=d&&Wi(u[s])==="object"&&!isNaN(parseInt(u[s][g],10))?u[s][g]/f:0,v.push((l[s]||b)/c+h)),g=s;return v},WW=pv.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return pv.processArabic&&(n=pv.processArabic(n)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(n,t,r)/t:SI.apply(this,arguments).reduce(function(a,o){return a+o},0)},GW=function(n,e,t,s){for(var r=[],a=0,o=n.length,l=0;a!==o&&l+e[a]<t;)l+=e[a],a++;r.push(n.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>s&&(r.push(n.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&r.push(n.slice(c,a)),r},HW=function(n,e,t){t||(t={});var s,r,a,o,l,c,u,f=[],d=[f],h=t.textIndent||0,p=0,g=0,b=n.split(" "),v=SI.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?b[0].length+2:t.lineIndent||0){var w=Array(c).join(" "),x=[];b.map(function(C){(C=C.split(/\s*\n/)).length>1?x=x.concat(C.map(function(M,k){return(k&&M.length?`
`:"")+M})):x.push(C[0])}),b=x,c=WW.apply(this,[w,t])}for(a=0,o=b.length;a<o;a++){var S=0;if(s=b[a],c&&s[0]==`
`&&(s=s.substr(1),S=1),h+p+(g=(r=SI.apply(this,[s,t])).reduce(function(C,M){return C+M},0))>e||S){if(g>e){for(l=GW.apply(this,[s,r,e-(h+p),e]),f.push(l.shift()),f=[l.pop()];l.length;)d.push([l.shift()]);g=r.slice(s.length-(f[0]?f[0].length:0)).reduce(function(C,M){return C+M},0)}else f=[s];d.push(f),h=g+c,p=v}else f.push(s),h+=p+g,p=v}return u=c?function(C,M){return(M?w:"")+C.join(" ")}:function(C){return C.join(" ")},d.map(u)},pv.splitTextToSize=function(n,e,t){var s,r=(t=t||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var d=this.internal.getFont(f.fontName,f.fontStyle),h="Unicode";return d.metadata[h]?{widths:d.metadata[h].widths||{0:1},kerning:d.metadata[h].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);s=Array.isArray(n)?n:String(n).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/r;a.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,a.lineIndent=t.lineIndent;var l,c,u=[];for(l=0,c=s.length;l<c;l++)u=u.concat(HW.apply(this,[s[l],o,a]));return u},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",s={},r={},a=0;a<16;a++)s[t[a]]=e[a],r[e[a]]=t[a];var o=function(h){return"0x"+parseInt(h,10).toString(16)},l=n.__fontmetrics__.compress=function(h){var p,g,b,v,w=["{"];for(var x in h){if(p=h[x],isNaN(parseInt(x,10))?g="'"+x+"'":(x=parseInt(x,10),g=(g=o(x).slice(2)).slice(0,-1)+r[g.slice(-1)]),typeof p=="number")p<0?(b=o(p).slice(3),v="-"):(b=o(p).slice(2),v=""),b=v+b.slice(0,-1)+r[b.slice(-1)];else{if(Wi(p)!=="object")throw new Error("Don't know what to do with value type "+Wi(p)+".");b=l(p)}w.push(g+b)}return w.push("}"),w.join("")},c=n.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,g,b,v,w={},x=1,S=w,C=[],M="",k="",E=h.length-1,I=1;I<E;I+=1)(v=h[I])=="'"?p?(b=p.join(""),p=void 0):p=[]:p?p.push(v):v=="{"?(C.push([S,b]),S={},b=void 0):v=="}"?((g=C.pop())[0][g[1]]=S,b=void 0,S=g[0]):v=="-"?x=-1:b===void 0?s.hasOwnProperty(v)?(M+=s[v],b=parseInt(M,16)*x,x=1,M=""):M+=v:s.hasOwnProperty(v)?(k+=s[v],S[b]=parseInt(k,16)*x,x=1,b=void 0,k=""):k+=v;return w},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(h){var p=h.font,g=d.Unicode[p.postScriptName];g&&(p.metadata.Unicode={},p.metadata.Unicode.widths=g.widths,p.metadata.Unicode.kerning=g.kerning);var b=f.Unicode[p.postScriptName];b&&(p.metadata.Unicode.encoding=b,p.encoding=b.codePages[0])}])})(bs.API),(function(n){var e=function(t){for(var s=t.length,r=new Uint8Array(s),a=0;a<s;a++)r[a]=t.charCodeAt(a);return r};n.API.events.push(["addFont",function(t){var s=void 0,r=t.font,a=t.instance;if(!r.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(s=a.existsFileInVFS(r.postScriptName)===!1?a.loadFile(r.postScriptName):a.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(fL(l)),o.metadata=n.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(r,s)}}])})(bs),bs.API.addSvgAsImage=function(n,e,t,s,r,a,o,l){if(isNaN(e)||isNaN(t))throw ha.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(r))throw ha.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=s,c.height=r;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(zs.canvg?Promise.resolve(zs.canvg):x3(()=>import("./index.es-33WeMpxg.js"),__vite__mapDeps([0,1,2]),import.meta.url)).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(u,n,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(f)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),e,t,s,r,o,l)})},bs.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var r=0;r<this.internal.pages[s].length;r++)this.internal.pages[s][r]=this.internal.pages[s][r].replace(e,t);return this},bs.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var s,r,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,f=0,d=0;function h(g,b){var v,w=!1;for(v=0;v<g.length;v+=1)g[v]===b&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=l.length;for(d=0;d<p;d+=1)t[l[d]].value=t[l[d]].defaultValue,t[l[d]].explicitSet=!1}if(Wi(n)==="object"){for(r in n)if(a=n[r],h(l,r)&&a!==void 0){if(t[r].type==="boolean"&&typeof a=="boolean")t[r].value=a;else if(t[r].type==="name"&&h(t[r].valueSet,a))t[r].value=a;else if(t[r].type==="integer"&&Number.isInteger(a))t[r].value=a;else if(t[r].type==="array"){for(u=0;u<a.length;u+=1)if(s=!0,a[u].length===1&&typeof a[u][0]=="number")c.push(String(a[u]-1));else if(a[u].length>1){for(f=0;f<a[u].length;f+=1)typeof a[u][f]!="number"&&(s=!1);s===!0&&c.push([a[u][0]-1,a[u][1]-1].join(" "))}t[r].value="["+c.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,b=[];for(g in t)t[g].explicitSet===!0&&(t[g].type==="name"?b.push("/"+g+" /"+t[g].value):b.push("/"+g+" "+t[g].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(s)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+o.length+l.length+r.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(r+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(s,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(bs.API),(function(n){var e=n.API,t=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],d=0,h=a.length;d<h;++d){if(l=o.metadata.characterToGlyph(a.charCodeAt(d)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(d),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},s=function(a){var o,l,c,u,f,d,h;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,h=(l=Object.keys(a).sort(function(p,g){return p-g})).length;d<h;d++)o=l[d],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(u=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof n.API.TTFFont&&l.encoding==="Identity-H"){for(var d=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",g=0;g<h.length;g++)p+=String.fromCharCode(h[g]);var b=u();f({data:p,addLength1:!0,objectId:b}),c("endobj");var v=u();f({data:s(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var w=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Tv(l.fontName)),c("/FontFile2 "+b+" 0 R"),c("/FontBBox "+n.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var x=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Tv(l.fontName)),c("/FontDescriptor "+w+" 0 R"),c("/W "+n.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+v+" 0 R"),c("/BaseFont /"+Tv(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+x+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof n.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var d=l.metadata.rawData,h="",p=0;p<d.length;p++)h+=String.fromCharCode(d[p]);var g=u();f({data:h,addLength1:!0,objectId:g}),c("endobj");var b=u();f({data:s(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var v=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+g+" 0 R"),c("/Flags 96"),c("/FontBBox "+n.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Tv(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var w=0;w<l.metadata.hmtx.widths.length;w++)l.metadata.hmtx.widths[w]=parseInt(l.metadata.hmtx.widths[w]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+Tv(l.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var r=function(a){var o,l=a.text||"",c=a.x,u=a.y,f=a.options||{},d=a.mutex||{},h=d.pdfEscape,p=d.activeFontKey,g=d.fonts,b=p,v="",w=0,x="",S=g[b].encoding;if(g[b].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:d};for(x=l,b=p,Array.isArray(l)&&(x=l[0]),w=0;w<x.length;w+=1)g[b].metadata.hasOwnProperty("cmap")&&(o=g[b].metadata.cmap.unicode.codeMap[x[w].charCodeAt(0)]),o||x[w].charCodeAt(0)<256&&g[b].metadata.hasOwnProperty("Unicode")?v+=x[w]:v+="";var C="";return parseInt(b.slice(1))<14||S==="WinAnsiEncoding"?C=h(v,b).split("").map(function(M){return M.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(C=t(v,g[b])),d.isHex=!0,{text:C,x:c,y:u,options:f,mutex:d}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([r(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(r(Object.assign({},c,{text:o[u]})).text);a.text=l}else a.text=r(Object.assign({},c,{text:o})).text}])})(bs),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,s){return e.call(this),this.internal.vFS[t]=s,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(bs.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(s){var r,a,o,l,c,u,f,d=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,S=0;this.__bidiEngine__={};var C=function(L){var P=L.charCodeAt(),j=P>>8,G=b[j];return G!==void 0?d[256*G+(255&P)]:j===252||j===253?"AL":w.test(j)?"L":j===8?"R":"N"},M=function(L){for(var P,j=0;j<L.length;j++){if((P=C(L.charAt(j)))==="L")return!1;if(P==="R")return!0}return!1},k=function(L,P,j,G){var Q,q,te,Z,ne=P[G];switch(ne){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"N":case"AN":break;case"EN":x&&(ne="AN");break;case"AL":x=!0,ne="R";break;case"WS":case"BN":ne="N";break;case"CS":G<1||G+1>=P.length||(Q=j[G-1])!=="EN"&&Q!=="AN"||(q=P[G+1])!=="EN"&&q!=="AN"?ne="N":x&&(q="AN"),ne=q===Q?q:"N";break;case"ES":ne=(Q=G>0?j[G-1]:"B")==="EN"&&G+1<P.length&&P[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&j[G-1]==="EN"){ne="EN";break}if(x){ne="N";break}for(te=G+1,Z=P.length;te<Z&&P[te]==="ET";)te++;ne=te<Z&&P[te]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Z=P.length,te=G+1;te<Z&&P[te]==="NSM";)te++;if(te<Z){var le=L[G],H=le>=1425&&le<=2303||le===64286;if(Q=P[te],H&&(Q==="R"||Q==="AL")){ne="R";break}}}ne=G<1||(Q=P[G-1])==="B"?"N":j[G-1];break;case"B":x=!1,r=!0,ne=S;break;case"S":a=!0,ne="N"}return ne},E=function(L,P,j){var G=L.split("");return j&&I(G,j,{hiLevel:S}),G.reverse(),P&&P.reverse(),G.join("")},I=function(L,P,j){var G,Q,q,te,Z,ne=-1,le=L.length,H=0,R=[],B=S?p:h,W=[];for(x=!1,r=!1,a=!1,Q=0;Q<le;Q++)W[Q]=C(L[Q]);for(q=0;q<le;q++){if(Z=H,R[q]=k(L,W,R,q),G=240&(H=B[Z][g[R[q]]]),H&=15,P[q]=te=B[H][5],G>0)if(G===16){for(Q=ne;Q<q;Q++)P[Q]=1;ne=-1}else ne=-1;if(B[H][6])ne===-1&&(ne=q);else if(ne>-1){for(Q=ne;Q<q;Q++)P[Q]=te;ne=-1}W[q]==="B"&&(P[q]=0),j.hiLevel|=te}a&&(function(se,ue,ge){for(var Ce=0;Ce<ge;Ce++)if(se[Ce]==="S"){ue[Ce]=S;for(var Se=Ce-1;Se>=0&&se[Se]==="WS";Se--)ue[Se]=S}})(W,P,le)},A=function(L,P,j,G,Q){if(!(Q.hiLevel<L)){if(L===1&&S===1&&!r)return P.reverse(),void(j&&j.reverse());for(var q,te,Z,ne,le=P.length,H=0;H<le;){if(G[H]>=L){for(Z=H+1;Z<le&&G[Z]>=L;)Z++;for(ne=H,te=Z-1;ne<te;ne++,te--)q=P[ne],P[ne]=P[te],P[te]=q,j&&(q=j[ne],j[ne]=j[te],j[te]=q);H=Z}H++}}},D=function(L,P,j){var G=L.split(""),Q={hiLevel:S};return j||(j=[]),I(G,j,Q),(function(q,te,Z){if(Z.hiLevel!==0&&f)for(var ne,le=0;le<q.length;le++)te[le]===1&&(ne=v.indexOf(q[le]))>=0&&(q[le]=v[ne+1])})(G,j,Q),A(2,G,P,j,Q),A(1,G,P,j,Q),G.join("")};return this.__bidiEngine__.doBidiReorder=function(L,P,j){if((function(Q,q){if(q)for(var te=0;te<Q.length;te++)q[te]=te;l===void 0&&(l=M(Q)),u===void 0&&(u=M(Q))})(L,P),o||!c||u)if(o&&c&&l^u)S=l?1:0,L=E(L,P,j);else if(!o&&c&&u)S=l?1:0,L=D(L,P,j),L=E(L,P);else if(!o||l||c||u){if(o&&!c&&l^u)L=E(L,P),l?(S=0,L=D(L,P,j)):(S=1,L=D(L,P,j),L=E(L,P));else if(o&&l&&!c&&u)S=1,L=D(L,P,j),L=E(L,P);else if(!o&&!c&&l^u){var G=f;l?(S=1,L=D(L,P,j),S=0,f=!1,L=D(L,P,j),f=G):(S=0,L=D(L,P,j),L=E(L,P),S=1,f=!1,L=D(L,P,j),f=G,L=E(L,P))}}else S=0,L=D(L,P,j);else S=l?1:0,L=D(L,P,j);return L},this.__bidiEngine__.setOptions=function(L){L&&(o=L.isInputVisual,c=L.isOutputVisual,l=L.isInputRtl,u=L.isOutputRtl,f=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(s){var r=s.text;s.x,s.y;var a=s.options||{};s.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,t.setOptions(a),Object.prototype.toString.call(r)==="[object Array]"){var l=0;for(o=[],l=0;l<r.length;l+=1)Object.prototype.toString.call(r[l])==="[object Array]"?o.push([t.doBidiReorder(r[l][0]),r[l][1],r[l][2]]):o.push([t.doBidiReorder(r[l])]);s.text=o}else s.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])})(bs),bs.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new c1(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new D2e(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new w2e(this.contents),this.head=new _2e(this),this.name=new T2e(this),this.cmap=new Kne(this),this.toUnicode={},this.hhea=new x2e(this),this.maxp=new k2e(this),this.hmtx=new E2e(this),this.post=new S2e(this),this.os2=new C2e(this),this.loca=new N2e(this),this.glyf=new I2e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,s,r,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(s=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,s){var r,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)r=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(r))+s*(1e3/t)||0;return o*(t/1e3)},n.prototype.lineHeight=function(e,t){var s;return t==null&&(t=!1),s=t?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},n})();var xp,c1=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,s;for(s=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)s[t]=String.fromCharCode(this.readByte());return s.join("")},n.prototype.writeString=function(e){var t,s,r;for(r=[],t=0,s=e.length;0<=s?t<s:t>s;t=0<=s?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,s,r,a,o,l,c;return e=this.readByte(),t=this.readByte(),s=this.readByte(),r=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^s)+4294967296*(255^r)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*s+4294967296*r+16777216*a+65536*o+256*l+c},n.prototype.writeLongLong=function(e){var t,s;return t=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,s;for(t=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)t.push(this.readByte());return t},n.prototype.write=function(e){var t,s,r,a;for(a=[],s=0,r=e.length;s<r;s++)t=e[s],a.push(this.writeByte(t));return a},n})(),w2e=(function(){var n;function e(t){var s,r,a;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,a=this.tableCount;0<=a?r<a:r>a;r=0<=a?++r:--r)s={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(t){var s,r,a,o,l,c,u,f,d,h,p,g,b;for(b in p=Object.keys(t).length,c=Math.log(2),d=16*Math.floor(Math.log(p)/c),o=Math.floor(d/c),f=16*p-d,(r=new c1).writeInt(this.scalarType),r.writeShort(p),r.writeShort(d),r.writeShort(o),r.writeShort(f),a=16*p,u=r.pos+a,l=null,g=[],t)for(h=t[b],r.writeString(b),r.writeInt(n(h)),r.writeInt(u),r.writeInt(h.length),g=g.concat(h),b==="head"&&(l=u),u+=h.length;u%4;)g.push(0),u++;return r.write(g),s=2981146554-n(r.data),r.pos=l+8,r.writeUInt32(s),r.data},n=function(t){var s,r,a,o;for(t=Xne.call(t);t.length%4;)t.push(0);for(a=new c1(t),r=0,s=0,o=t.length;s<o;s=s+=4)r+=a.readUInt32();return 4294967295&r},e})(),v2e={}.hasOwnProperty,Rm=function(n,e){for(var t in e)v2e.call(e,t)&&(n[t]=e[t]);function s(){this.constructor=n}return s.prototype=e.prototype,n.prototype=new s,n.__super__=e.prototype,n};xp=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var _2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new c1).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),tG=(function(){function n(e,t){var s,r,a,o,l,c,u,f,d,h,p,g,b,v,w,x,S;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),h=p/2,e.pos+=6,a=(function(){var C,M;for(M=[],c=C=0;0<=h?C<h:C>h;c=0<=h?++C:--C)M.push(e.readUInt16());return M})(),e.pos+=2,b=(function(){var C,M;for(M=[],c=C=0;0<=h?C<h:C>h;c=0<=h?++C:--C)M.push(e.readUInt16());return M})(),u=(function(){var C,M;for(M=[],c=C=0;0<=h?C<h:C>h;c=0<=h?++C:--C)M.push(e.readUInt16());return M})(),f=(function(){var C,M;for(M=[],c=C=0;0<=h?C<h:C>h;c=0<=h?++C:--C)M.push(e.readUInt16());return M})(),r=(this.length-e.pos+this.offset)/2,l=(function(){var C,M;for(M=[],c=C=0;0<=r?C<r:C>r;c=0<=r?++C:--C)M.push(e.readUInt16());return M})(),c=w=0,S=a.length;w<S;c=++w)for(v=a[c],s=x=g=b[c];g<=v?x<=v:x>=v;s=g<=v?++x:--x)f[c]===0?o=s+u[c]:(o=l[f[c]/2+(s-g)-(h-c)]||0)!==0&&(o+=u[c]),this.codeMap[s]=65535&o}e.pos=d}return n.encode=function(e,t){var s,r,a,o,l,c,u,f,d,h,p,g,b,v,w,x,S,C,M,k,E,I,A,D,L,P,j,G,Q,q,te,Z,ne,le,H,R,B,W,se,ue,ge,Ce,Se,Me,pe,fe;switch(G=new c1,o=Object.keys(e).sort(function($e,We){return $e-We}),t){case"macroman":for(b=0,v=(function(){var $e=[];for(g=0;g<256;++g)$e.push(0);return $e})(),x={0:0},a={},Q=0,ne=o.length;Q<ne;Q++)x[Se=e[r=o[Q]]]==null&&(x[Se]=++b),a[r]={old:e[r],new:x[e[r]]},v[r]=x[e[r]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(v),{charMap:a,subtable:G.data,maxGlyphID:b+1};case"unicode":for(P=[],d=[],S=0,x={},s={},w=u=null,q=0,le=o.length;q<le;q++)x[M=e[r=o[q]]]==null&&(x[M]=++S),s[r]={old:M,new:x[M]},l=x[M]-r,w!=null&&l===u||(w&&d.push(w),P.push(r),u=l),w=r;for(w&&d.push(w),d.push(65535),P.push(65535),D=2*(A=P.length),I=2*Math.pow(Math.log(A)/Math.LN2,2),h=Math.log(I/2)/Math.LN2,E=2*A-I,c=[],k=[],p=[],g=te=0,H=P.length;te<H;g=++te){if(L=P[g],f=d[g],L===65535){c.push(0),k.push(0);break}if(L-(j=s[L].new)>=32768)for(c.push(0),k.push(2*(p.length+A-g)),r=Z=L;L<=f?Z<=f:Z>=f;r=L<=f?++Z:--Z)p.push(s[r].new);else c.push(j-L),k.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*A+2*p.length),G.writeUInt16(0),G.writeUInt16(D),G.writeUInt16(I),G.writeUInt16(h),G.writeUInt16(E),ge=0,R=d.length;ge<R;ge++)r=d[ge],G.writeUInt16(r);for(G.writeUInt16(0),Ce=0,B=P.length;Ce<B;Ce++)r=P[Ce],G.writeUInt16(r);for(Me=0,W=c.length;Me<W;Me++)l=c[Me],G.writeUInt16(l);for(pe=0,se=k.length;pe<se;pe++)C=k[pe],G.writeUInt16(C);for(fe=0,ue=p.length;fe<ue;fe++)b=p[fe],G.writeUInt16(b);return{charMap:s,subtable:G.data,maxGlyphID:S+1}}},n})(),Kne=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,s,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)t=new tG(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var s,r;return t==null&&(t="macroman"),s=tG.encode(e,t),(r=new c1).writeUInt16(0),r.writeUInt16(1),s.table=r.data.concat(s.subtable),s},n})(),x2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),C2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,s;for(s=[],t=0;t<10;++t)s.push(e.readByte());return s})(),this.charRange=(function(){var t,s;for(s=[],t=0;t<4;++t)s.push(e.readInt());return s})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,s;for(s=[],t=0;t<2;t=++t)s.push(e.readInt());return s})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),S2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="post",n.prototype.parse=function(e){var t,s,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(s=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return s=e.readUInt16(),this.offsets=e.read(s);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},n})(),M2e=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},T2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="name",n.prototype.parse=function(e){var t,s,r,a,o,l,c,u,f,d,h;for(e.pos=this.offset,e.readShort(),t=e.readShort(),l=e.readShort(),s=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)s.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},a=f=0,d=s.length;f<d;a=++f)r=s[a],e.pos=r.offset,u=e.readString(r.length),o=new M2e(u,r),c[h=r.nameID]==null&&(c[h]=[]),c[r.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},n})(),k2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),E2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,s,r,a,o,l,c;for(e.pos=this.offset,this.metrics=[],t=0,l=this.file.hhea.numberOfMetrics;0<=l?t<l:t>l;t=0<=l?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,f;for(f=[],t=u=0;0<=r?u<r:u>r;t=0<=r?++u:--u)f.push(e.readInt16());return f})(),this.widths=(function(){var u,f,d,h;for(h=[],u=0,f=(d=this.metrics).length;u<f;u++)a=d[u],h.push(a.advance);return h}).call(this),s=this.widths[this.widths.length-1],c=[],t=o=0;0<=r?o<r:o>r;t=0<=r?++o:--o)c.push(this.widths.push(s));return c},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),Xne=[].slice,I2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,s,r,a,o,l,c,u,f,d;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,s=a.indexOf(e),(r=a.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+s,o=(l=new c1(t.read(r))).readShort(),u=l.readShort(),d=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new L2e(l,u,d,c,f):new A2e(l,o,u,d,c,f),this.cache[e]))},n.prototype.encode=function(e,t,s){var r,a,o,l,c;for(o=[],a=[],l=0,c=t.length;l<c;l++)r=e[t[l]],a.push(o.length),r&&(o=o.concat(r.encode(s)));return a.push(o.length),{table:o,offsets:a}},n})(),A2e=(function(){function n(e,t,s,r,a,o){this.raw=e,this.numberOfContours=t,this.xMin=s,this.yMin=r,this.xMax=a,this.yMax=o,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),L2e=(function(){function n(e,t,s,r,a){var o,l;for(this.raw=e,this.xMin=t,this.yMin=s,this.xMax=r,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return n.prototype.encode=function(){var e,t,s;for(t=new c1(Xne.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),N2e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Rm(n,xp),n.prototype.tag="loca",n.prototype.parse=function(e){var t,s;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var r,a;for(a=[],s=0,r=this.length;s<r;s+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var r,a;for(a=[],s=0,r=this.length;s<r;s+=4)a.push(e.readUInt32());return a}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var s=new Uint32Array(this.offsets.length),r=0,a=0,o=0;o<s.length;++o)if(s[o]=r,a<t.length&&t[a]==o){++a,s[o]=r;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(r+=c)}for(var u=new Array(4*s.length),f=0;f<s.length;++f)u[4*f+3]=255&s[f],u[4*f+2]=(65280&s[f])>>8,u[4*f+1]=(16711680&s[f])>>16,u[4*f]=(4278190080&s[f])>>24;return u},n})(),D2e=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,s,r,a;for(t in r=this.font.cmap.tables[0].codeMap,e={},a=this.subset)s=a[t],e[t]=r[s];return e},n.prototype.glyphsFor=function(e){var t,s,r,a,o,l,c;for(r={},o=0,l=e.length;o<l;o++)r[a=e[o]]=this.font.glyf.glyphFor(a);for(a in t=[],r)(s=r[a])!=null&&s.compound&&t.push.apply(t,s.glyphIDs);if(t.length>0)for(a in c=this.glyphsFor(t))s=c[a],r[a]=s;return r},n.prototype.encode=function(e,t){var s,r,a,o,l,c,u,f,d,h,p,g,b,v,w;for(r in s=Kne.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},w=s.charMap)p[(c=w[r]).old]=c.new;for(g in h=s.maxGlyphID,o)g in p||(p[g]=h++);return f=(function(x){var S,C;for(S in C={},x)C[x[S]]=S;return C})(p),d=Object.keys(f).sort(function(x,S){return x-S}),b=(function(){var x,S,C;for(C=[],x=0,S=d.length;x<S;x++)l=d[x],C.push(f[l]);return C})(),a=this.font.glyf.encode(o,b,p),u=this.font.loca.encode(a.offsets,b),v={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},n})();bs.API.PDFObject=(function(){var n;function e(){}return n=function(t,s){return(Array(s+1).join("0")+t).slice(-s)},e.convert=function(t){var s,r,a,o;if(Array.isArray(t))return"["+(function(){var l,c,u;for(u=[],l=0,c=t.length;l<c;l++)s=t[l],u.push(e.convert(s));return u})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in a=["<<"],t)o=t[r],a.push("/"+r+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+t},e})();function W3(n,e,t,s){const r=e.target,a=new Dt(t,s),o=Qa.transformPoint(a,Qa.invertTransform(r.calcTransformMatrix())),l=r.width,c=l/2,u=o.x-c;let f=l+u;f<10&&(f=10);const d=r.getOriginalSize().width,h=r.cropX||0;if(h+f>d&&(f=d-h),f===l)return!1;const p=Qa.cos(r.angle),g=Qa.sin(r.angle),b=u/2*r.scaleX*p,v=u/2*r.scaleX*g;return r.set("width",f),r.set("left",r.left+b),r.set("top",r.top+v),!0}function G3(n,e,t,s){const r=e.target,a=new Dt(t,s),o=Qa.transformPoint(a,Qa.invertTransform(r.calcTransformMatrix())),l=r.width,c=-l/2,u=o.x-c;let f=l-u;f<10&&(f=10);let d=r.cropX||0,h=d+u;if(h<0?(h=0,f=l+d):h+f>r.getOriginalSize().width,f===l&&h===d)return!1;const p=h-d,g=Qa.cos(r.angle),b=Qa.sin(r.angle),v=p/2*r.scaleX*g,w=p/2*r.scaleX*b;return r.set("cropX",h),r.set("width",f),r.set("left",r.left+v),r.set("top",r.top+w),!0}function H3(n,e,t,s){const r=e.target,a=new Dt(t,s),o=Qa.transformPoint(a,Qa.invertTransform(r.calcTransformMatrix())),l=r.height,c=o.y-l/2;let u=l+c;u<10&&(u=10);const f=r.getOriginalSize().height,d=r.cropY||0;if(d+u>f&&(u=f-d),u===l)return!1;const h=Qa.cos(r.angle),p=Qa.sin(r.angle),g=c/2*r.scaleY*-p,b=c/2*r.scaleY*h;return r.set("height",u),r.set("left",r.left+g),r.set("top",r.top+b),!0}function q3(n,e,t,s){const r=e.target,a=new Dt(t,s),o=Qa.transformPoint(a,Qa.invertTransform(r.calcTransformMatrix())),l=r.height,c=o.y- -l/2;let u=l-c;u<10&&(u=10);let f=r.cropY||0,d=f+c;d<0&&(d=0,u=l+f);const h=d-f,p=Qa.cos(r.angle),g=Qa.sin(r.angle),b=h/2*r.scaleY*-g,v=h/2*r.scaleY*p;return r.set("cropY",d),r.set("height",u),r.set("left",r.left+b),r.set("top",r.top+v),!0}function O0(n,e,t,s,r){n.save(),n.translate(e,t),r.angle&&n.rotate(-Qa.degreesToRadians(r.angle)),n.shadowColor="rgba(0,0,0,0.3)",n.shadowBlur=4,n.fillStyle="white",n.strokeStyle="black",n.lineWidth=1;const a=10;n.beginPath(),n.rect(-a/2,-a/2,a,a),n.fillStyle="#ffffff",n.strokeStyle="rgba(0,0,0,0.5)",n.lineWidth=1,n.fill(),n.stroke(),n.restore()}function O2e(){return{mr:new Ol({x:.5,y:0,cursorStyle:"ew-resize",actionHandler:W3,render:O0}),ml:new Ol({x:-.5,y:0,cursorStyle:"ew-resize",actionHandler:G3,render:O0}),mb:new Ol({x:0,y:.5,cursorStyle:"ns-resize",actionHandler:H3,render:O0}),mt:new Ol({x:0,y:-.5,cursorStyle:"ns-resize",actionHandler:q3,render:O0}),br:new Ol({x:.5,y:.5,cursorStyle:"nwse-resize",actionHandler:(n,e,t,s)=>{const r=W3(n,e,t,s),a=H3(n,e,t,s);return r||a},render:O0}),bl:new Ol({x:-.5,y:.5,cursorStyle:"nesw-resize",actionHandler:(n,e,t,s)=>{const r=G3(n,e,t,s),a=H3(n,e,t,s);return r||a},render:O0}),tr:new Ol({x:.5,y:-.5,cursorStyle:"nesw-resize",actionHandler:(n,e,t,s)=>{const r=W3(n,e,t,s),a=q3(n,e,t,s);return r||a},render:O0}),tl:new Ol({x:-.5,y:-.5,cursorStyle:"nwse-resize",actionHandler:(n,e,t,s)=>{const r=G3(n,e,t,s),a=q3(n,e,t,s);return r||a},render:O0})}}function Qne(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function P2e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nG(n,e){return n.get(Qne(n,e))}function $2e(n,e,t){P2e(n,e),e.set(n,t)}function j2e(n,e,t){return n.set(Qne(n,e),t),t}const R2e=100,As={},F2e=()=>{As.previousActiveElement instanceof HTMLElement?(As.previousActiveElement.focus(),As.previousActiveElement=null):document.body&&document.body.focus()},z2e=n=>new Promise(e=>{if(!n)return e();const t=window.scrollX,s=window.scrollY;As.restoreFocusTimeout=setTimeout(()=>{F2e(),e()},R2e),window.scrollTo(t,s)}),Jne="swal2-",B2e=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],Wt=B2e.reduce((n,e)=>(n[e]=Jne+e,n),{}),U2e=["success","warning","info","question","error"],cN=U2e.reduce((n,e)=>(n[e]=Jne+e,n),{}),Zne="SweetAlert2:",IF=n=>n.charAt(0).toUpperCase()+n.slice(1),Gu=n=>{console.warn(`${Zne} ${typeof n=="object"?n.join(" "):n}`)},Vb=n=>{console.error(`${Zne} ${n}`)},sG=[],V2e=n=>{sG.includes(n)||(sG.push(n),Gu(n))},ese=(n,e=null)=>{V2e(`"${n}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},L4=n=>typeof n=="function"?n():n,AF=n=>n&&typeof n.toPromise=="function",bT=n=>AF(n)?n.toPromise():Promise.resolve(n),LF=n=>n&&Promise.resolve(n)===n,Ju=()=>document.body.querySelector(`.${Wt.container}`),wT=n=>{const e=Ju();return e?e.querySelector(n):null},Md=n=>wT(`.${n}`),_i=()=>Md(Wt.popup),$2=()=>Md(Wt.icon),W2e=()=>Md(Wt["icon-content"]),tse=()=>Md(Wt.title),NF=()=>Md(Wt["html-container"]),nse=()=>Md(Wt.image),DF=()=>Md(Wt["progress-steps"]),N4=()=>Md(Wt["validation-message"]),Nm=()=>wT(`.${Wt.actions} .${Wt.confirm}`),j2=()=>wT(`.${Wt.actions} .${Wt.cancel}`),Wb=()=>wT(`.${Wt.actions} .${Wt.deny}`),G2e=()=>Md(Wt["input-label"]),R2=()=>wT(`.${Wt.loader}`),vT=()=>Md(Wt.actions),sse=()=>Md(Wt.footer),D4=()=>Md(Wt["timer-progress-bar"]),OF=()=>Md(Wt.close),H2e=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,PF=()=>{const n=_i();if(!n)return[];const e=n.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),t=Array.from(e).sort((a,o)=>{const l=parseInt(a.getAttribute("tabindex")||"0"),c=parseInt(o.getAttribute("tabindex")||"0");return l>c?1:l<c?-1:0}),s=n.querySelectorAll(H2e),r=Array.from(s).filter(a=>a.getAttribute("tabindex")!=="-1");return[...new Set(t.concat(r))].filter(a=>Mf(a))},$F=()=>Ig(document.body,Wt.shown)&&!Ig(document.body,Wt["toast-shown"])&&!Ig(document.body,Wt["no-backdrop"]),O4=()=>{const n=_i();return n?Ig(n,Wt.toast):!1},q2e=()=>{const n=_i();return n?n.hasAttribute("data-loading"):!1},Td=(n,e)=>{if(n.textContent="",e){const s=new DOMParser().parseFromString(e,"text/html"),r=s.querySelector("head");r&&Array.from(r.childNodes).forEach(o=>{n.appendChild(o)});const a=s.querySelector("body");a&&Array.from(a.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?n.appendChild(o.cloneNode(!0)):n.appendChild(o)})}},Ig=(n,e)=>{if(!e)return!1;const t=e.split(/\s+/);for(let s=0;s<t.length;s++)if(!n.classList.contains(t[s]))return!1;return!0},Y2e=(n,e)=>{Array.from(n.classList).forEach(t=>{!Object.values(Wt).includes(t)&&!Object.values(cN).includes(t)&&!Object.values(e.showClass||{}).includes(t)&&n.classList.remove(t)})},xd=(n,e,t)=>{if(Y2e(n,e),!e.customClass)return;const s=e.customClass[t];if(s){if(typeof s!="string"&&!s.forEach){Gu(`Invalid type of customClass.${t}! Expected string or iterable object, got "${typeof s}"`);return}Li(n,s)}},P4=(n,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return n.querySelector(`.${Wt.popup} > .${Wt[e]}`);case"checkbox":return n.querySelector(`.${Wt.popup} > .${Wt.checkbox} input`);case"radio":return n.querySelector(`.${Wt.popup} > .${Wt.radio} input:checked`)||n.querySelector(`.${Wt.popup} > .${Wt.radio} input:first-child`);case"range":return n.querySelector(`.${Wt.popup} > .${Wt.range} input`);default:return n.querySelector(`.${Wt.popup} > .${Wt.input}`)}},rse=n=>{if(n.focus(),n.type!=="file"){const e=n.value;n.value="",n.value=e}},ise=(n,e,t)=>{!n||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(s=>{Array.isArray(n)?n.forEach(r=>{t?r.classList.add(s):r.classList.remove(s)}):t?n.classList.add(s):n.classList.remove(s)}))},Li=(n,e)=>{ise(n,e,!0)},mh=(n,e)=>{ise(n,e,!1)},H0=(n,e)=>{const t=Array.from(n.children);for(let s=0;s<t.length;s++){const r=t[s];if(r instanceof HTMLElement&&Ig(r,e))return r}},Zy=(n,e,t)=>{t===`${parseInt(`${t}`)}`&&(t=parseInt(t)),t||parseInt(`${t}`)===0?n.style.setProperty(e,typeof t=="number"?`${t}px`:t):n.style.removeProperty(e)},dc=(n,e="flex")=>{n&&(n.style.display=e)},vu=n=>{n&&(n.style.display="none")},jF=(n,e="block")=>{n&&new MutationObserver(()=>{_T(n,n.innerHTML,e)}).observe(n,{childList:!0,subtree:!0})},rG=(n,e,t,s)=>{const r=n.querySelector(e);r&&r.style.setProperty(t,s)},_T=(n,e,t="flex")=>{e?dc(n,t):vu(n)},Mf=n=>!!(n&&(n.offsetWidth||n.offsetHeight||n.getClientRects().length)),K2e=()=>!Mf(Nm())&&!Mf(Wb())&&!Mf(j2()),aR=n=>n.scrollHeight>n.clientHeight,X2e=(n,e)=>{let t=n;for(;t&&t!==e;){if(aR(t))return!0;t=t.parentElement}return!1},ase=n=>{const e=window.getComputedStyle(n),t=parseFloat(e.getPropertyValue("animation-duration")||"0"),s=parseFloat(e.getPropertyValue("transition-duration")||"0");return t>0||s>0},RF=(n,e=!1)=>{const t=D4();t&&Mf(t)&&(e&&(t.style.transition="none",t.style.width="100%"),setTimeout(()=>{t.style.transition=`width ${n/1e3}s linear`,t.style.width="0%"},10))},Q2e=()=>{const n=D4();if(!n)return;const e=parseInt(window.getComputedStyle(n).width);n.style.removeProperty("transition"),n.style.width="100%";const t=parseInt(window.getComputedStyle(n).width),s=e/t*100;n.style.width=`${s}%`},J2e=()=>typeof window>"u"||typeof document>"u",Z2e=`
 <div aria-labelledby="${Wt.title}" aria-describedby="${Wt["html-container"]}" class="${Wt.popup}" tabindex="-1">
   <button type="button" class="${Wt.close}"></button>
   <ul class="${Wt["progress-steps"]}"></ul>
   <div class="${Wt.icon}"></div>
   <img class="${Wt.image}" />
   <h2 class="${Wt.title}" id="${Wt.title}"></h2>
   <div class="${Wt["html-container"]}" id="${Wt["html-container"]}"></div>
   <input class="${Wt.input}" id="${Wt.input}" />
   <input type="file" class="${Wt.file}" />
   <div class="${Wt.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Wt.select}" id="${Wt.select}"></select>
   <div class="${Wt.radio}"></div>
   <label class="${Wt.checkbox}">
     <input type="checkbox" id="${Wt.checkbox}" />
     <span class="${Wt.label}"></span>
   </label>
   <textarea class="${Wt.textarea}" id="${Wt.textarea}"></textarea>
   <div class="${Wt["validation-message"]}" id="${Wt["validation-message"]}"></div>
   <div class="${Wt.actions}">
     <div class="${Wt.loader}"></div>
     <button type="button" class="${Wt.confirm}"></button>
     <button type="button" class="${Wt.deny}"></button>
     <button type="button" class="${Wt.cancel}"></button>
   </div>
   <div class="${Wt.footer}"></div>
   <div class="${Wt["timer-progress-bar-container"]}">
     <div class="${Wt["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),e_e=()=>{const n=Ju();return n?(n.remove(),mh([document.documentElement,document.body],[Wt["no-backdrop"],Wt["toast-shown"],Wt["has-column"]]),!0):!1},py=()=>{As.currentInstance.resetValidationMessage()},t_e=()=>{const n=_i(),e=H0(n,Wt.input),t=H0(n,Wt.file),s=n.querySelector(`.${Wt.range} input`),r=n.querySelector(`.${Wt.range} output`),a=H0(n,Wt.select),o=n.querySelector(`.${Wt.checkbox} input`),l=H0(n,Wt.textarea);e.oninput=py,t.onchange=py,a.onchange=py,o.onchange=py,l.oninput=py,s.oninput=()=>{py(),r.value=s.value},s.onchange=()=>{py(),r.value=s.value}},n_e=n=>typeof n=="string"?document.querySelector(n):n,s_e=n=>{const e=_i();e.setAttribute("role",n.toast?"alert":"dialog"),e.setAttribute("aria-live",n.toast?"polite":"assertive"),n.toast||e.setAttribute("aria-modal","true")},r_e=n=>{window.getComputedStyle(n).direction==="rtl"&&(Li(Ju(),Wt.rtl),As.isRTL=!0)},i_e=n=>{const e=e_e();if(J2e()){Vb("SweetAlert2 requires document to initialize");return}const t=document.createElement("div");t.className=Wt.container,e&&Li(t,Wt["no-transition"]),Td(t,Z2e),t.dataset.swal2Theme=n.theme;const s=n_e(n.target);s.appendChild(t),n.topLayer&&(t.setAttribute("popover",""),t.showPopover()),s_e(n),r_e(s),t_e()},FF=(n,e)=>{n instanceof HTMLElement?e.appendChild(n):typeof n=="object"?a_e(n,e):n&&Td(e,n)},a_e=(n,e)=>{n.jquery?o_e(e,n):Td(e,n.toString())},o_e=(n,e)=>{if(n.textContent="",0 in e)for(let t=0;t in e;t++)n.appendChild(e[t].cloneNode(!0));else n.appendChild(e.cloneNode(!0))},l_e=(n,e)=>{const t=vT(),s=R2();!t||!s||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?vu(t):dc(t),xd(t,e,"actions"),c_e(t,s,e),Td(s,e.loaderHtml||""),xd(s,e,"loader"))};function c_e(n,e,t){const s=Nm(),r=Wb(),a=j2();!s||!r||!a||(K3(s,"confirm",t),K3(r,"deny",t),K3(a,"cancel",t),u_e(s,r,a,t),t.reverseButtons&&(t.toast?(n.insertBefore(a,s),n.insertBefore(r,s)):(n.insertBefore(a,e),n.insertBefore(r,e),n.insertBefore(s,e))))}function u_e(n,e,t,s){if(!s.buttonsStyling){mh([n,e,t],Wt.styled);return}Li([n,e,t],Wt.styled),s.confirmButtonColor&&n.style.setProperty("--swal2-confirm-button-background-color",s.confirmButtonColor),s.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",s.denyButtonColor),s.cancelButtonColor&&t.style.setProperty("--swal2-cancel-button-background-color",s.cancelButtonColor),Y3(n),Y3(e),Y3(t)}function Y3(n){const e=window.getComputedStyle(n);if(e.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const t=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");n.style.setProperty("--swal2-action-button-focus-box-shadow",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${t}`))}function K3(n,e,t){const s=IF(e);_T(n,t[`show${s}Button`],"inline-block"),Td(n,t[`${e}ButtonText`]||""),n.setAttribute("aria-label",t[`${e}ButtonAriaLabel`]||""),n.className=Wt[e],xd(n,t,`${e}Button`)}const f_e=(n,e)=>{const t=OF();t&&(Td(t,e.closeButtonHtml||""),xd(t,e,"closeButton"),_T(t,e.showCloseButton),t.setAttribute("aria-label",e.closeButtonAriaLabel||""))},d_e=(n,e)=>{const t=Ju();t&&(h_e(t,e.backdrop),p_e(t,e.position),m_e(t,e.grow),xd(t,e,"container"))};function h_e(n,e){typeof e=="string"?n.style.background=e:e||Li([document.documentElement,document.body],Wt["no-backdrop"])}function p_e(n,e){e&&(e in Wt?Li(n,Wt[e]):(Gu('The "position" parameter is not valid, defaulting to "center"'),Li(n,Wt.center)))}function m_e(n,e){e&&Li(n,Wt[`grow-${e}`])}var Ta={innerParams:new WeakMap,domCache:new WeakMap};const g_e=["input","file","range","select","radio","checkbox","textarea"],y_e=(n,e)=>{const t=_i();if(!t)return;const s=Ta.innerParams.get(n),r=!s||e.input!==s.input;g_e.forEach(a=>{const o=H0(t,Wt[a]);o&&(v_e(a,e.inputAttributes),o.className=Wt[a],r&&vu(o))}),e.input&&(r&&b_e(e),__e(e))},b_e=n=>{if(!n.input)return;if(!Wo[n.input]){Vb(`Unexpected type of input! Expected ${Object.keys(Wo).join(" | ")}, got "${n.input}"`);return}const e=ose(n.input);if(!e)return;const t=Wo[n.input](e,n);dc(e),n.inputAutoFocus&&setTimeout(()=>{rse(t)})},w_e=n=>{for(let e=0;e<n.attributes.length;e++){const t=n.attributes[e].name;["id","type","value","style"].includes(t)||n.removeAttribute(t)}},v_e=(n,e)=>{const t=_i();if(!t)return;const s=P4(t,n);if(s){w_e(s);for(const r in e)s.setAttribute(r,e[r])}},__e=n=>{if(!n.input)return;const e=ose(n.input);e&&xd(e,n,"input")},zF=(n,e)=>{!n.placeholder&&e.inputPlaceholder&&(n.placeholder=e.inputPlaceholder)},xT=(n,e,t)=>{if(t.inputLabel){const s=document.createElement("label"),r=Wt["input-label"];s.setAttribute("for",n.id),s.className=r,typeof t.customClass=="object"&&Li(s,t.customClass.inputLabel),s.innerText=t.inputLabel,e.insertAdjacentElement("beforebegin",s)}},ose=n=>{const e=_i();if(e)return H0(e,Wt[n]||Wt.input)},uN=(n,e)=>{["string","number"].includes(typeof e)?n.value=`${e}`:LF(e)||Gu(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},Wo={};Wo.text=Wo.email=Wo.password=Wo.number=Wo.tel=Wo.url=Wo.search=Wo.date=Wo["datetime-local"]=Wo.time=Wo.week=Wo.month=(n,e)=>(uN(n,e.inputValue),xT(n,n,e),zF(n,e),n.type=e.input,n);Wo.file=(n,e)=>(xT(n,n,e),zF(n,e),n);Wo.range=(n,e)=>{const t=n.querySelector("input"),s=n.querySelector("output");return uN(t,e.inputValue),t.type=e.input,uN(s,e.inputValue),xT(t,n,e),n};Wo.select=(n,e)=>{if(n.textContent="",e.inputPlaceholder){const t=document.createElement("option");Td(t,e.inputPlaceholder),t.value="",t.disabled=!0,t.selected=!0,n.appendChild(t)}return xT(n,n,e),n};Wo.radio=n=>(n.textContent="",n);Wo.checkbox=(n,e)=>{const t=P4(_i(),"checkbox");t.value="1",t.checked=!!e.inputValue;const s=n.querySelector("span");return Td(s,e.inputPlaceholder||e.inputLabel),t};Wo.textarea=(n,e)=>{uN(n,e.inputValue),zF(n,e),xT(n,n,e);const t=s=>parseInt(window.getComputedStyle(s).marginLeft)+parseInt(window.getComputedStyle(s).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const s=parseInt(window.getComputedStyle(_i()).width),r=()=>{if(!document.body.contains(n))return;const a=n.offsetWidth+t(n);a>s?_i().style.width=`${a}px`:Zy(_i(),"width",e.width)};new MutationObserver(r).observe(n,{attributes:!0,attributeFilter:["style"]})}}),n};const x_e=(n,e)=>{const t=NF();t&&(jF(t),xd(t,e,"htmlContainer"),e.html?(FF(e.html,t),dc(t,"block")):e.text?(t.textContent=e.text,dc(t,"block")):vu(t),y_e(n,e))},C_e=(n,e)=>{const t=sse();t&&(jF(t),_T(t,!!e.footer,"block"),e.footer&&FF(e.footer,t),xd(t,e,"footer"))},S_e=(n,e)=>{const t=Ta.innerParams.get(n),s=$2();if(!s)return;if(t&&e.icon===t.icon){aG(s,e),iG(s,e);return}if(!e.icon&&!e.iconHtml){vu(s);return}if(e.icon&&Object.keys(cN).indexOf(e.icon)===-1){Vb(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),vu(s);return}dc(s),aG(s,e),iG(s,e),Li(s,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",lse)},iG=(n,e)=>{for(const[t,s]of Object.entries(cN))e.icon!==t&&mh(n,s);Li(n,e.icon&&cN[e.icon]),k_e(n,e),lse(),xd(n,e,"icon")},lse=()=>{const n=_i();if(!n)return;const e=window.getComputedStyle(n).getPropertyValue("background-color"),t=n.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let s=0;s<t.length;s++)t[s].style.backgroundColor=e},M_e=n=>`
  ${n.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${n.animation?'<div class="swal2-success-fix"></div>':""}
  ${n.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,T_e=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,aG=(n,e)=>{if(!e.icon&&!e.iconHtml)return;let t=n.innerHTML,s="";e.iconHtml?s=oG(e.iconHtml):e.icon==="success"?(s=M_e(e),t=t.replace(/ style=".*?"/g,"")):e.icon==="error"?s=T_e:e.icon&&(s=oG({question:"?",warning:"!",info:"i"}[e.icon])),t.trim()!==s.trim()&&Td(n,s)},k_e=(n,e)=>{if(e.iconColor){n.style.color=e.iconColor,n.style.borderColor=e.iconColor;for(const t of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])rG(n,t,"background-color",e.iconColor);rG(n,".swal2-success-ring","border-color",e.iconColor)}},oG=n=>`<div class="${Wt["icon-content"]}">${n}</div>`,E_e=(n,e)=>{const t=nse();if(t){if(!e.imageUrl){vu(t);return}dc(t,""),t.setAttribute("src",e.imageUrl),t.setAttribute("alt",e.imageAlt||""),Zy(t,"width",e.imageWidth),Zy(t,"height",e.imageHeight),t.className=Wt.image,xd(t,e,"image")}};let BF=!1,cse=0,use=0,fse=0,dse=0;const I_e=n=>{n.addEventListener("mousedown",fN),document.body.addEventListener("mousemove",dN),n.addEventListener("mouseup",hN),n.addEventListener("touchstart",fN),document.body.addEventListener("touchmove",dN),n.addEventListener("touchend",hN)},A_e=n=>{n.removeEventListener("mousedown",fN),document.body.removeEventListener("mousemove",dN),n.removeEventListener("mouseup",hN),n.removeEventListener("touchstart",fN),document.body.removeEventListener("touchmove",dN),n.removeEventListener("touchend",hN)},fN=n=>{const e=_i();if(n.target===e||$2().contains(n.target)){BF=!0;const t=hse(n);cse=t.clientX,use=t.clientY,fse=parseInt(e.style.insetInlineStart)||0,dse=parseInt(e.style.insetBlockStart)||0,Li(e,"swal2-dragging")}},dN=n=>{const e=_i();if(BF){let{clientX:t,clientY:s}=hse(n);const r=t-cse;e.style.insetInlineStart=`${fse+(As.isRTL?-r:r)}px`,e.style.insetBlockStart=`${dse+(s-use)}px`}},hN=()=>{const n=_i();BF=!1,mh(n,"swal2-dragging")},hse=n=>{let e=0,t=0;return n.type.startsWith("mouse")?(e=n.clientX,t=n.clientY):n.type.startsWith("touch")&&(e=n.touches[0].clientX,t=n.touches[0].clientY),{clientX:e,clientY:t}},L_e=(n,e)=>{const t=Ju(),s=_i();if(!(!t||!s)){if(e.toast){Zy(t,"width",e.width),s.style.width="100%";const r=R2();r&&s.insertBefore(r,$2())}else Zy(s,"width",e.width);Zy(s,"padding",e.padding),e.color&&(s.style.color=e.color),e.background&&(s.style.background=e.background),vu(N4()),N_e(s,e),e.draggable&&!e.toast?(Li(s,Wt.draggable),I_e(s)):(mh(s,Wt.draggable),A_e(s))}},N_e=(n,e)=>{const t=e.showClass||{};n.className=`${Wt.popup} ${Mf(n)?t.popup:""}`,e.toast?(Li([document.documentElement,document.body],Wt["toast-shown"]),Li(n,Wt.toast)):Li(n,Wt.modal),xd(n,e,"popup"),typeof e.customClass=="string"&&Li(n,e.customClass),e.icon&&Li(n,Wt[`icon-${e.icon}`])},D_e=(n,e)=>{const t=DF();if(!t)return;const{progressSteps:s,currentProgressStep:r}=e;if(!s||s.length===0||r===void 0){vu(t);return}dc(t),t.textContent="",r>=s.length&&Gu("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),s.forEach((a,o)=>{const l=O_e(a);if(t.appendChild(l),o===r&&Li(l,Wt["active-progress-step"]),o!==s.length-1){const c=P_e(e);t.appendChild(c)}})},O_e=n=>{const e=document.createElement("li");return Li(e,Wt["progress-step"]),Td(e,n),e},P_e=n=>{const e=document.createElement("li");return Li(e,Wt["progress-step-line"]),n.progressStepsDistance&&Zy(e,"width",n.progressStepsDistance),e},$_e=(n,e)=>{const t=tse();t&&(jF(t),_T(t,!!(e.title||e.titleText),"block"),e.title&&FF(e.title,t),e.titleText&&(t.innerText=e.titleText),xd(t,e,"title"))},pse=(n,e)=>{L_e(n,e),d_e(n,e),D_e(n,e),S_e(n,e),E_e(n,e),$_e(n,e),f_e(n,e),x_e(n,e),l_e(n,e),C_e(n,e);const t=_i();typeof e.didRender=="function"&&t&&e.didRender(t),As.eventEmitter.emit("didRender",t)},j_e=()=>Mf(_i()),mse=()=>{var n;return(n=Nm())===null||n===void 0?void 0:n.click()},R_e=()=>{var n;return(n=Wb())===null||n===void 0?void 0:n.click()},F_e=()=>{var n;return(n=j2())===null||n===void 0?void 0:n.click()},F2=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),gse=n=>{n.keydownTarget&&n.keydownHandlerAdded&&(n.keydownTarget.removeEventListener("keydown",n.keydownHandler,{capture:n.keydownListenerCapture}),n.keydownHandlerAdded=!1)},z_e=(n,e,t)=>{gse(n),e.toast||(n.keydownHandler=s=>U_e(e,s,t),n.keydownTarget=e.keydownListenerCapture?window:_i(),n.keydownListenerCapture=e.keydownListenerCapture,n.keydownTarget.addEventListener("keydown",n.keydownHandler,{capture:n.keydownListenerCapture}),n.keydownHandlerAdded=!0)},oR=(n,e)=>{var t;const s=PF();if(s.length){n=n+e,n===-2&&(n=s.length-1),n===s.length?n=0:n===-1&&(n=s.length-1),s[n].focus();return}(t=_i())===null||t===void 0||t.focus()},yse=["ArrowRight","ArrowDown"],B_e=["ArrowLeft","ArrowUp"],U_e=(n,e,t)=>{n&&(e.isComposing||e.keyCode===229||(n.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?V_e(e,n):e.key==="Tab"?W_e(e):[...yse,...B_e].includes(e.key)?G_e(e.key):e.key==="Escape"&&H_e(e,n,t)))},V_e=(n,e)=>{if(!L4(e.allowEnterKey))return;const t=P4(_i(),e.input);if(n.target&&t&&n.target instanceof HTMLElement&&n.target.outerHTML===t.outerHTML){if(["textarea","file"].includes(e.input))return;mse(),n.preventDefault()}},W_e=n=>{const e=n.target,t=PF();let s=-1;for(let r=0;r<t.length;r++)if(e===t[r]){s=r;break}n.shiftKey?oR(s,-1):oR(s,1),n.stopPropagation(),n.preventDefault()},G_e=n=>{const e=vT(),t=Nm(),s=Wb(),r=j2();if(!e||!t||!s||!r)return;const a=[t,s,r];if(document.activeElement instanceof HTMLElement&&!a.includes(document.activeElement))return;const o=yse.includes(n)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let c=0;c<e.children.length;c++){if(l=l[o],!l)return;if(l instanceof HTMLButtonElement&&Mf(l))break}l instanceof HTMLButtonElement&&l.focus()}},H_e=(n,e,t)=>{n.preventDefault(),L4(e.allowEscapeKey)&&t(F2.esc)};var r2={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const q_e=()=>{const n=Ju();Array.from(document.body.children).forEach(t=>{t.contains(n)||(t.hasAttribute("aria-hidden")&&t.setAttribute("data-previous-aria-hidden",t.getAttribute("aria-hidden")||""),t.setAttribute("aria-hidden","true"))})},bse=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},wse=typeof window<"u"&&!!window.GestureEvent,Y_e=()=>{if(wse&&!Ig(document.body,Wt.iosfix)){const n=document.body.scrollTop;document.body.style.top=`${n*-1}px`,Li(document.body,Wt.iosfix),K_e()}},K_e=()=>{const n=Ju();if(!n)return;let e;n.ontouchstart=t=>{e=X_e(t)},n.ontouchmove=t=>{e&&(t.preventDefault(),t.stopPropagation())}},X_e=n=>{const e=n.target,t=Ju(),s=NF();return!t||!s||Q_e(n)||J_e(n)?!1:e===t||!aR(t)&&e instanceof HTMLElement&&!X2e(e,s)&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(aR(s)&&s.contains(e))},Q_e=n=>n.touches&&n.touches.length&&n.touches[0].touchType==="stylus",J_e=n=>n.touches&&n.touches.length>1,Z_e=()=>{if(Ig(document.body,Wt.iosfix)){const n=parseInt(document.body.style.top,10);mh(document.body,Wt.iosfix),document.body.style.top="",document.body.scrollTop=n*-1}},exe=()=>{const n=document.createElement("div");n.className=Wt["scrollbar-measure"],document.body.appendChild(n);const e=n.getBoundingClientRect().width-n.clientWidth;return document.body.removeChild(n),e};let Gv=null;const txe=n=>{Gv===null&&(document.body.scrollHeight>window.innerHeight||n==="scroll")&&(Gv=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Gv+exe()}px`)},nxe=()=>{Gv!==null&&(document.body.style.paddingRight=`${Gv}px`,Gv=null)};function vse(n,e,t,s){O4()?lG(n,s):(z2e(t).then(()=>lG(n,s)),gse(As)),wse?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),$F()&&(nxe(),Z_e(),bse()),sxe()}function sxe(){mh([document.documentElement,document.body],[Wt.shown,Wt["height-auto"],Wt["no-backdrop"],Wt["toast-shown"]])}function q0(n){n=ixe(n);const e=r2.swalPromiseResolve.get(this),t=rxe(this);this.isAwaitingPromise?n.isDismissed||(CT(this),e(n)):t&&e(n)}const rxe=n=>{const e=_i();if(!e)return!1;const t=Ta.innerParams.get(n);if(!t||Ig(e,t.hideClass.popup))return!1;mh(e,t.showClass.popup),Li(e,t.hideClass.popup);const s=Ju();return mh(s,t.showClass.backdrop),Li(s,t.hideClass.backdrop),axe(n,e,t),!0};function _se(n){const e=r2.swalPromiseReject.get(this);CT(this),e&&e(n)}const CT=n=>{n.isAwaitingPromise&&(delete n.isAwaitingPromise,Ta.innerParams.get(n)||n._destroy())},ixe=n=>typeof n>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},n),axe=(n,e,t)=>{var s;const r=Ju(),a=ase(e);typeof t.willClose=="function"&&t.willClose(e),(s=As.eventEmitter)===null||s===void 0||s.emit("willClose",e),a?oxe(n,e,r,t.returnFocus,t.didClose):vse(n,r,t.returnFocus,t.didClose)},oxe=(n,e,t,s,r)=>{As.swalCloseEventFinishedCallback=vse.bind(null,n,t,s,r);const a=function(o){if(o.target===e){var l;(l=As.swalCloseEventFinishedCallback)===null||l===void 0||l.call(As),delete As.swalCloseEventFinishedCallback,e.removeEventListener("animationend",a),e.removeEventListener("transitionend",a)}};e.addEventListener("animationend",a),e.addEventListener("transitionend",a)},lG=(n,e)=>{setTimeout(()=>{var t;typeof e=="function"&&e.bind(n.params)(),(t=As.eventEmitter)===null||t===void 0||t.emit("didClose"),n._destroy&&n._destroy()})},i2=n=>{let e=_i();if(e||new qv,e=_i(),!e)return;const t=R2();O4()?vu($2()):lxe(e,n),dc(t),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},lxe=(n,e)=>{const t=vT(),s=R2();!t||!s||(!e&&Mf(Nm())&&(e=Nm()),dc(t),e&&(vu(e),s.setAttribute("data-button-to-replace",e.className),t.insertBefore(s,e)),Li([n,t],Wt.loading))},cxe=(n,e)=>{e.input==="select"||e.input==="radio"?pxe(n,e):["text","email","number","tel","textarea"].some(t=>t===e.input)&&(AF(e.inputValue)||LF(e.inputValue))&&(i2(Nm()),mxe(n,e))},uxe=(n,e)=>{const t=n.getInput();if(!t)return null;switch(e.input){case"checkbox":return fxe(t);case"radio":return dxe(t);case"file":return hxe(t);default:return e.inputAutoTrim?t.value.trim():t.value}},fxe=n=>n.checked?1:0,dxe=n=>n.checked?n.value:null,hxe=n=>n.files&&n.files.length?n.getAttribute("multiple")!==null?n.files:n.files[0]:null,pxe=(n,e)=>{const t=_i();if(!t)return;const s=r=>{e.input==="select"?gxe(t,pN(r),e):e.input==="radio"&&yxe(t,pN(r),e)};AF(e.inputOptions)||LF(e.inputOptions)?(i2(Nm()),bT(e.inputOptions).then(r=>{n.hideLoading(),s(r)})):typeof e.inputOptions=="object"?s(e.inputOptions):Vb(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},mxe=(n,e)=>{const t=n.getInput();t&&(vu(t),bT(e.inputValue).then(s=>{t.value=e.input==="number"?`${parseFloat(s)||0}`:`${s}`,dc(t),t.focus(),n.hideLoading()}).catch(s=>{Vb(`Error in inputValue promise: ${s}`),t.value="",dc(t),t.focus(),n.hideLoading()}))};function gxe(n,e,t){const s=H0(n,Wt.select);if(!s)return;const r=(a,o,l)=>{const c=document.createElement("option");c.value=l,Td(c,o),c.selected=xse(l,t.inputValue),a.appendChild(c)};e.forEach(a=>{const o=a[0],l=a[1];if(Array.isArray(l)){const c=document.createElement("optgroup");c.label=o,c.disabled=!1,s.appendChild(c),l.forEach(u=>r(c,u[1],u[0]))}else r(s,l,o)}),s.focus()}function yxe(n,e,t){const s=H0(n,Wt.radio);if(!s)return;e.forEach(a=>{const o=a[0],l=a[1],c=document.createElement("input"),u=document.createElement("label");c.type="radio",c.name=Wt.radio,c.value=o,xse(o,t.inputValue)&&(c.checked=!0);const f=document.createElement("span");Td(f,l),f.className=Wt.label,u.appendChild(c),u.appendChild(f),s.appendChild(u)});const r=s.querySelectorAll("input");r.length&&r[0].focus()}const pN=n=>{const e=[];return n instanceof Map?n.forEach((t,s)=>{let r=t;typeof r=="object"&&(r=pN(r)),e.push([s,r])}):Object.keys(n).forEach(t=>{let s=n[t];typeof s=="object"&&(s=pN(s)),e.push([t,s])}),e},xse=(n,e)=>!!e&&e.toString()===n.toString(),bxe=n=>{const e=Ta.innerParams.get(n);n.disableButtons(),e.input?Cse(n,"confirm"):VF(n,!0)},wxe=n=>{const e=Ta.innerParams.get(n);n.disableButtons(),e.returnInputValueOnDeny?Cse(n,"deny"):UF(n,!1)},vxe=(n,e)=>{n.disableButtons(),e(F2.cancel)},Cse=(n,e)=>{const t=Ta.innerParams.get(n);if(!t.input){Vb(`The "input" parameter is needed to be set when using returnInputValueOn${IF(e)}`);return}const s=n.getInput(),r=uxe(n,t);t.inputValidator?_xe(n,r,e):s&&!s.checkValidity()?(n.enableButtons(),n.showValidationMessage(t.validationMessage||s.validationMessage)):e==="deny"?UF(n,r):VF(n,r)},_xe=(n,e,t)=>{const s=Ta.innerParams.get(n);n.disableInput(),Promise.resolve().then(()=>bT(s.inputValidator(e,s.validationMessage))).then(a=>{n.enableButtons(),n.enableInput(),a?n.showValidationMessage(a):t==="deny"?UF(n,e):VF(n,e)})},UF=(n,e)=>{const t=Ta.innerParams.get(n||void 0);t.showLoaderOnDeny&&i2(Wb()),t.preDeny?(n.isAwaitingPromise=!0,Promise.resolve().then(()=>bT(t.preDeny(e,t.validationMessage))).then(r=>{r===!1?(n.hideLoading(),CT(n)):n.close({isDenied:!0,value:typeof r>"u"?e:r})}).catch(r=>Sse(n||void 0,r))):n.close({isDenied:!0,value:e})},cG=(n,e)=>{n.close({isConfirmed:!0,value:e})},Sse=(n,e)=>{n.rejectPromise(e)},VF=(n,e)=>{const t=Ta.innerParams.get(n||void 0);t.showLoaderOnConfirm&&i2(),t.preConfirm?(n.resetValidationMessage(),n.isAwaitingPromise=!0,Promise.resolve().then(()=>bT(t.preConfirm(e,t.validationMessage))).then(r=>{Mf(N4())||r===!1?(n.hideLoading(),CT(n)):cG(n,typeof r>"u"?e:r)}).catch(r=>Sse(n||void 0,r))):cG(n,e)};function mN(){const n=Ta.innerParams.get(this);if(!n)return;const e=Ta.domCache.get(this);vu(e.loader),O4()?n.icon&&dc($2()):xxe(e),mh([e.popup,e.actions],Wt.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const xxe=n=>{const e=n.popup.getElementsByClassName(n.loader.getAttribute("data-button-to-replace"));e.length?dc(e[0],"inline-block"):K2e()&&vu(n.actions)};function Mse(){const n=Ta.innerParams.get(this),e=Ta.domCache.get(this);return e?P4(e.popup,n.input):null}function Tse(n,e,t){const s=Ta.domCache.get(n);e.forEach(r=>{s[r].disabled=t})}function kse(n,e){const t=_i();if(!(!t||!n))if(n.type==="radio"){const s=t.querySelectorAll(`[name="${Wt.radio}"]`);for(let r=0;r<s.length;r++)s[r].disabled=e}else n.disabled=e}function Ese(){Tse(this,["confirmButton","denyButton","cancelButton"],!1)}function Ise(){Tse(this,["confirmButton","denyButton","cancelButton"],!0)}function Ase(){kse(this.getInput(),!1)}function Lse(){kse(this.getInput(),!0)}function Nse(n){const e=Ta.domCache.get(this),t=Ta.innerParams.get(this);Td(e.validationMessage,n),e.validationMessage.className=Wt["validation-message"],t.customClass&&t.customClass.validationMessage&&Li(e.validationMessage,t.customClass.validationMessage),dc(e.validationMessage);const s=this.getInput();s&&(s.setAttribute("aria-invalid","true"),s.setAttribute("aria-describedby",Wt["validation-message"]),rse(s),Li(s,Wt.inputerror))}function Dse(){const n=Ta.domCache.get(this);n.validationMessage&&vu(n.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),mh(e,Wt.inputerror))}const Hv={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},Cxe=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],Sxe={allowEnterKey:void 0},Mxe=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Ose=n=>Object.prototype.hasOwnProperty.call(Hv,n),Pse=n=>Cxe.indexOf(n)!==-1,$se=n=>Sxe[n],Txe=n=>{Ose(n)||Gu(`Unknown parameter "${n}"`)},kxe=n=>{Mxe.includes(n)&&Gu(`The parameter "${n}" is incompatible with toasts`)},Exe=n=>{const e=$se(n);e&&ese(n,e)},jse=n=>{n.backdrop===!1&&n.allowOutsideClick&&Gu('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),n.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(n.theme)&&Gu(`Invalid theme "${n.theme}"`);for(const e in n)Txe(e),n.toast&&kxe(e),Exe(e)};function Rse(n){const e=Ju(),t=_i(),s=Ta.innerParams.get(this);if(!t||Ig(t,s.hideClass.popup)){Gu("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const r=Ixe(n),a=Object.assign({},s,r);jse(a),e.dataset.swal2Theme=a.theme,pse(this,a),Ta.innerParams.set(this,a),Object.defineProperties(this,{params:{value:Object.assign({},this.params,n),writable:!1,enumerable:!0}})}const Ixe=n=>{const e={};return Object.keys(n).forEach(t=>{Pse(t)?e[t]=n[t]:Gu(`Invalid parameter to update: ${t}`)}),e};function Fse(){const n=Ta.domCache.get(this),e=Ta.innerParams.get(this);if(!e){zse(this);return}n.popup&&As.swalCloseEventFinishedCallback&&(As.swalCloseEventFinishedCallback(),delete As.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),As.eventEmitter.emit("didDestroy"),Axe(this)}const Axe=n=>{zse(n),delete n.params,delete As.keydownHandler,delete As.keydownTarget,delete As.currentInstance},zse=n=>{n.isAwaitingPromise?(X3(Ta,n),n.isAwaitingPromise=!0):(X3(r2,n),X3(Ta,n),delete n.isAwaitingPromise,delete n.disableButtons,delete n.enableButtons,delete n.getInput,delete n.disableInput,delete n.enableInput,delete n.hideLoading,delete n.disableLoading,delete n.showValidationMessage,delete n.resetValidationMessage,delete n.close,delete n.closePopup,delete n.closeModal,delete n.closeToast,delete n.rejectPromise,delete n.update,delete n._destroy)},X3=(n,e)=>{for(const t in n)n[t].delete(e)};var Lxe=Object.freeze({__proto__:null,_destroy:Fse,close:q0,closeModal:q0,closePopup:q0,closeToast:q0,disableButtons:Ise,disableInput:Lse,disableLoading:mN,enableButtons:Ese,enableInput:Ase,getInput:Mse,handleAwaitingPromise:CT,hideLoading:mN,rejectPromise:_se,resetValidationMessage:Dse,showValidationMessage:Nse,update:Rse});const Nxe=(n,e,t)=>{n.toast?Dxe(n,e,t):(Pxe(e),$xe(e),jxe(n,e,t))},Dxe=(n,e,t)=>{e.popup.onclick=()=>{n&&(Oxe(n)||n.timer||n.input)||t(F2.close)}},Oxe=n=>!!(n.showConfirmButton||n.showDenyButton||n.showCancelButton||n.showCloseButton);let gN=!1;const Pxe=n=>{n.popup.onmousedown=()=>{n.container.onmouseup=function(e){n.container.onmouseup=()=>{},e.target===n.container&&(gN=!0)}}},$xe=n=>{n.container.onmousedown=e=>{e.target===n.container&&e.preventDefault(),n.popup.onmouseup=function(t){n.popup.onmouseup=()=>{},(t.target===n.popup||t.target instanceof HTMLElement&&n.popup.contains(t.target))&&(gN=!0)}}},jxe=(n,e,t)=>{e.container.onclick=s=>{if(gN){gN=!1;return}s.target===e.container&&L4(n.allowOutsideClick)&&t(F2.backdrop)}},Rxe=n=>typeof n=="object"&&n.jquery,uG=n=>n instanceof Element||Rxe(n),Fxe=n=>{const e={};return typeof n[0]=="object"&&!uG(n[0])?Object.assign(e,n[0]):["title","html","icon"].forEach((t,s)=>{const r=n[s];typeof r=="string"||uG(r)?e[t]=r:r!==void 0&&Vb(`Unexpected type of ${t}! Expected "string" or "Element", got ${typeof r}`)}),e};function zxe(...n){return new this(...n)}function Bxe(n){class e extends this{_main(s,r){return super._main(s,Object.assign({},n,r))}}return e}const Uxe=()=>As.timeout&&As.timeout.getTimerLeft(),Bse=()=>{if(As.timeout)return Q2e(),As.timeout.stop()},Use=()=>{if(As.timeout){const n=As.timeout.start();return RF(n),n}},Vxe=()=>{const n=As.timeout;return n&&(n.running?Bse():Use())},Wxe=n=>{if(As.timeout){const e=As.timeout.increase(n);return RF(e,!0),e}},Gxe=()=>!!(As.timeout&&As.timeout.isRunning());let fG=!1;const lR={};function Hxe(n="data-swal-template"){lR[n]=this,fG||(document.body.addEventListener("click",qxe),fG=!0)}const qxe=n=>{for(let e=n.target;e&&e!==document;e=e.parentNode)for(const t in lR){const s=e.getAttribute(t);if(s){lR[t].fire({template:s});return}}};class Yxe{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,t){const s=this._getHandlersByEventName(e);s.includes(t)||s.push(t)}once(e,t){const s=(...r)=>{this.removeListener(e,s),t.apply(this,r)};this.on(e,s)}emit(e,...t){this._getHandlersByEventName(e).forEach(s=>{try{s.apply(this,t)}catch(r){console.error(r)}})}removeListener(e,t){const s=this._getHandlersByEventName(e),r=s.indexOf(t);r>-1&&s.splice(r,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}As.eventEmitter=new Yxe;const Kxe=(n,e)=>{As.eventEmitter.on(n,e)},Xxe=(n,e)=>{As.eventEmitter.once(n,e)},Qxe=(n,e)=>{if(!n){As.eventEmitter.reset();return}e?As.eventEmitter.removeListener(n,e):As.eventEmitter.removeAllListeners(n)};var Jxe=Object.freeze({__proto__:null,argsToParams:Fxe,bindClickHandler:Hxe,clickCancel:F_e,clickConfirm:mse,clickDeny:R_e,enableLoading:i2,fire:zxe,getActions:vT,getCancelButton:j2,getCloseButton:OF,getConfirmButton:Nm,getContainer:Ju,getDenyButton:Wb,getFocusableElements:PF,getFooter:sse,getHtmlContainer:NF,getIcon:$2,getIconContent:W2e,getImage:nse,getInputLabel:G2e,getLoader:R2,getPopup:_i,getProgressSteps:DF,getTimerLeft:Uxe,getTimerProgressBar:D4,getTitle:tse,getValidationMessage:N4,increaseTimer:Wxe,isDeprecatedParameter:$se,isLoading:q2e,isTimerRunning:Gxe,isUpdatableParameter:Pse,isValidParameter:Ose,isVisible:j_e,mixin:Bxe,off:Qxe,on:Kxe,once:Xxe,resumeTimer:Use,showLoading:i2,stopTimer:Bse,toggleTimer:Vxe});class Zxe{constructor(e,t){this.callback=e,this.remaining=t,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const t=this.running;return t&&this.stop(),this.remaining+=e,t&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Vse=["swal-title","swal-html","swal-footer"],eCe=n=>{const e=typeof n.template=="string"?document.querySelector(n.template):n.template;if(!e)return{};const t=e.content;return lCe(t),Object.assign(tCe(t),nCe(t),sCe(t),rCe(t),iCe(t),aCe(t),oCe(t,Vse))},tCe=n=>{const e={};return Array.from(n.querySelectorAll("swal-param")).forEach(s=>{hb(s,["name","value"]);const r=s.getAttribute("name"),a=s.getAttribute("value");!r||!a||(typeof Hv[r]=="boolean"?e[r]=a!=="false":typeof Hv[r]=="object"?e[r]=JSON.parse(a):e[r]=a)}),e},nCe=n=>{const e={};return Array.from(n.querySelectorAll("swal-function-param")).forEach(s=>{const r=s.getAttribute("name"),a=s.getAttribute("value");!r||!a||(e[r]=new Function(`return ${a}`)())}),e},sCe=n=>{const e={};return Array.from(n.querySelectorAll("swal-button")).forEach(s=>{hb(s,["type","color","aria-label"]);const r=s.getAttribute("type");!r||!["confirm","cancel","deny"].includes(r)||(e[`${r}ButtonText`]=s.innerHTML,e[`show${IF(r)}Button`]=!0,s.hasAttribute("color")&&(e[`${r}ButtonColor`]=s.getAttribute("color")),s.hasAttribute("aria-label")&&(e[`${r}ButtonAriaLabel`]=s.getAttribute("aria-label")))}),e},rCe=n=>{const e={},t=n.querySelector("swal-image");return t&&(hb(t,["src","width","height","alt"]),t.hasAttribute("src")&&(e.imageUrl=t.getAttribute("src")||void 0),t.hasAttribute("width")&&(e.imageWidth=t.getAttribute("width")||void 0),t.hasAttribute("height")&&(e.imageHeight=t.getAttribute("height")||void 0),t.hasAttribute("alt")&&(e.imageAlt=t.getAttribute("alt")||void 0)),e},iCe=n=>{const e={},t=n.querySelector("swal-icon");return t&&(hb(t,["type","color"]),t.hasAttribute("type")&&(e.icon=t.getAttribute("type")),t.hasAttribute("color")&&(e.iconColor=t.getAttribute("color")),e.iconHtml=t.innerHTML),e},aCe=n=>{const e={},t=n.querySelector("swal-input");t&&(hb(t,["type","label","placeholder","value"]),e.input=t.getAttribute("type")||"text",t.hasAttribute("label")&&(e.inputLabel=t.getAttribute("label")),t.hasAttribute("placeholder")&&(e.inputPlaceholder=t.getAttribute("placeholder")),t.hasAttribute("value")&&(e.inputValue=t.getAttribute("value")));const s=Array.from(n.querySelectorAll("swal-input-option"));return s.length&&(e.inputOptions={},s.forEach(r=>{hb(r,["value"]);const a=r.getAttribute("value");if(!a)return;const o=r.innerHTML;e.inputOptions[a]=o})),e},oCe=(n,e)=>{const t={};for(const s in e){const r=e[s],a=n.querySelector(r);a&&(hb(a,[]),t[r.replace(/^swal-/,"")]=a.innerHTML.trim())}return t},lCe=n=>{const e=Vse.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(n.children).forEach(t=>{const s=t.tagName.toLowerCase();e.includes(s)||Gu(`Unrecognized element <${s}>`)})},hb=(n,e)=>{Array.from(n.attributes).forEach(t=>{e.indexOf(t.name)===-1&&Gu([`Unrecognized attribute "${t.name}" on <${n.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},Wse=10,cCe=n=>{const e=Ju(),t=_i();typeof n.willOpen=="function"&&n.willOpen(t),As.eventEmitter.emit("willOpen",t);const r=window.getComputedStyle(document.body).overflowY;dCe(e,t,n),setTimeout(()=>{uCe(e,t)},Wse),$F()&&(fCe(e,n.scrollbarPadding,r),q_e()),!O4()&&!As.previousActiveElement&&(As.previousActiveElement=document.activeElement),typeof n.didOpen=="function"&&setTimeout(()=>n.didOpen(t)),As.eventEmitter.emit("didOpen",t)},yN=n=>{const e=_i();if(n.target!==e)return;const t=Ju();e.removeEventListener("animationend",yN),e.removeEventListener("transitionend",yN),t.style.overflowY="auto",mh(t,Wt["no-transition"])},uCe=(n,e)=>{ase(e)?(n.style.overflowY="hidden",e.addEventListener("animationend",yN),e.addEventListener("transitionend",yN)):n.style.overflowY="auto"},fCe=(n,e,t)=>{Y_e(),e&&t!=="hidden"&&txe(t),setTimeout(()=>{n.scrollTop=0})},dCe=(n,e,t)=>{Li(n,t.showClass.backdrop),t.animation?(e.style.setProperty("opacity","0","important"),dc(e,"grid"),setTimeout(()=>{Li(e,t.showClass.popup),e.style.removeProperty("opacity")},Wse)):dc(e,"grid"),Li([document.documentElement,document.body],Wt.shown),t.heightAuto&&t.backdrop&&!t.toast&&Li([document.documentElement,document.body],Wt["height-auto"])};var dG={email:(n,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(n)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(n,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(n)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function hCe(n){n.inputValidator||(n.input==="email"&&(n.inputValidator=dG.email),n.input==="url"&&(n.inputValidator=dG.url))}function pCe(n){(!n.target||typeof n.target=="string"&&!document.querySelector(n.target)||typeof n.target!="string"&&!n.target.appendChild)&&(Gu('Target parameter is not valid, defaulting to "body"'),n.target="body")}function mCe(n){hCe(n),n.showLoaderOnConfirm&&!n.preConfirm&&Gu(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),pCe(n),typeof n.title=="string"&&(n.title=n.title.split(`
`).join("<br />")),i_e(n)}let fm;var MI=new WeakMap;class nl{constructor(...e){if($2e(this,MI,void 0),typeof window>"u")return;fm=this;const t=Object.freeze(this.constructor.argsToParams(e));this.params=t,this.isAwaitingPromise=!1,j2e(MI,this,this._main(fm.params))}_main(e,t={}){if(jse(Object.assign({},t,e)),As.currentInstance){const a=r2.swalPromiseResolve.get(As.currentInstance),{isAwaitingPromise:o}=As.currentInstance;As.currentInstance._destroy(),o||a({isDismissed:!0}),$F()&&bse()}As.currentInstance=fm;const s=yCe(e,t);mCe(s),Object.freeze(s),As.timeout&&(As.timeout.stop(),delete As.timeout),clearTimeout(As.restoreFocusTimeout);const r=bCe(fm);return pse(fm,s),Ta.innerParams.set(fm,s),gCe(fm,r,s)}then(e){return nG(MI,this).then(e)}finally(e){return nG(MI,this).finally(e)}}const gCe=(n,e,t)=>new Promise((s,r)=>{const a=o=>{n.close({isDismissed:!0,dismiss:o,isConfirmed:!1,isDenied:!1})};r2.swalPromiseResolve.set(n,s),r2.swalPromiseReject.set(n,r),e.confirmButton.onclick=()=>{bxe(n)},e.denyButton.onclick=()=>{wxe(n)},e.cancelButton.onclick=()=>{vxe(n,a)},e.closeButton.onclick=()=>{a(F2.close)},Nxe(t,e,a),z_e(As,t,a),cxe(n,t),cCe(t),wCe(As,t,a),vCe(e,t),setTimeout(()=>{e.container.scrollTop=0})}),yCe=(n,e)=>{const t=eCe(n),s=Object.assign({},Hv,e,t,n);return s.showClass=Object.assign({},Hv.showClass,s.showClass),s.hideClass=Object.assign({},Hv.hideClass,s.hideClass),s.animation===!1&&(s.showClass={backdrop:"swal2-noanimation"},s.hideClass={}),s},bCe=n=>{const e={popup:_i(),container:Ju(),actions:vT(),confirmButton:Nm(),denyButton:Wb(),cancelButton:j2(),loader:R2(),closeButton:OF(),validationMessage:N4(),progressSteps:DF()};return Ta.domCache.set(n,e),e},wCe=(n,e,t)=>{const s=D4();vu(s),e.timer&&(n.timeout=new Zxe(()=>{t("timer"),delete n.timeout},e.timer),e.timerProgressBar&&(dc(s),xd(s,e,"timerProgressBar"),setTimeout(()=>{n.timeout&&n.timeout.running&&RF(e.timer)})))},vCe=(n,e)=>{if(!e.toast){if(!L4(e.allowEnterKey)){ese("allowEnterKey"),CCe();return}_Ce(n)||xCe(n,e)||oR(-1,1)}},_Ce=n=>{const e=Array.from(n.popup.querySelectorAll("[autofocus]"));for(const t of e)if(t instanceof HTMLElement&&Mf(t))return t.focus(),!0;return!1},xCe=(n,e)=>e.focusDeny&&Mf(n.denyButton)?(n.denyButton.focus(),!0):e.focusCancel&&Mf(n.cancelButton)?(n.cancelButton.focus(),!0):e.focusConfirm&&Mf(n.confirmButton)?(n.confirmButton.focus(),!0):!1,CCe=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};nl.prototype.disableButtons=Ise;nl.prototype.enableButtons=Ese;nl.prototype.getInput=Mse;nl.prototype.disableInput=Lse;nl.prototype.enableInput=Ase;nl.prototype.hideLoading=mN;nl.prototype.disableLoading=mN;nl.prototype.showValidationMessage=Nse;nl.prototype.resetValidationMessage=Dse;nl.prototype.close=q0;nl.prototype.closePopup=q0;nl.prototype.closeModal=q0;nl.prototype.closeToast=q0;nl.prototype.rejectPromise=_se;nl.prototype.update=Rse;nl.prototype._destroy=Fse;Object.assign(nl,Jxe);Object.keys(Lxe).forEach(n=>{nl[n]=function(...e){return fm&&fm[n]?fm[n](...e):null}});nl.DismissReason=F2;nl.version="11.26.10";const qv=nl;qv.default=qv;typeof document<"u"&&(function(n,e){var t=n.createElement("style");if(n.getElementsByTagName("head")[0].appendChild(t),t.styleSheet)t.styleSheet.disabled||(t.styleSheet.cssText=e);else try{t.innerHTML=e}catch{t.innerText=e}})(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const $s={success:n=>{qv.fire({icon:"success",title:"Success",text:n,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,background:"#fff",color:"#333"})},error:n=>{qv.fire({icon:"error",title:"Error",text:n,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#fff",color:"#d33"})},info:n=>{qv.fire({icon:"info",title:"Info",text:n,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}};var Q3={exports:{}},hG;function SCe(){return hG||(hG=1,(function(n){var e=(function(t){var s=Object.prototype,r=s.hasOwnProperty,a=Object.defineProperty||function(ne,le,H){ne[le]=H.value},o,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function d(ne,le,H){return Object.defineProperty(ne,le,{value:H,enumerable:!0,configurable:!0,writable:!0}),ne[le]}try{d({},"")}catch{d=function(le,H,R){return le[H]=R}}function h(ne,le,H,R){var B=le&&le.prototype instanceof S?le:S,W=Object.create(B.prototype),se=new q(R||[]);return a(W,"_invoke",{value:P(ne,H,se)}),W}t.wrap=h;function p(ne,le,H){try{return{type:"normal",arg:ne.call(le,H)}}catch(R){return{type:"throw",arg:R}}}var g="suspendedStart",b="suspendedYield",v="executing",w="completed",x={};function S(){}function C(){}function M(){}var k={};d(k,c,function(){return this});var E=Object.getPrototypeOf,I=E&&E(E(te([])));I&&I!==s&&r.call(I,c)&&(k=I);var A=M.prototype=S.prototype=Object.create(k);C.prototype=M,a(A,"constructor",{value:M,configurable:!0}),a(M,"constructor",{value:C,configurable:!0}),C.displayName=d(M,f,"GeneratorFunction");function D(ne){["next","throw","return"].forEach(function(le){d(ne,le,function(H){return this._invoke(le,H)})})}t.isGeneratorFunction=function(ne){var le=typeof ne=="function"&&ne.constructor;return le?le===C||(le.displayName||le.name)==="GeneratorFunction":!1},t.mark=function(ne){return Object.setPrototypeOf?Object.setPrototypeOf(ne,M):(ne.__proto__=M,d(ne,f,"GeneratorFunction")),ne.prototype=Object.create(A),ne},t.awrap=function(ne){return{__await:ne}};function L(ne,le){function H(W,se,ue,ge){var Ce=p(ne[W],ne,se);if(Ce.type==="throw")ge(Ce.arg);else{var Se=Ce.arg,Me=Se.value;return Me&&typeof Me=="object"&&r.call(Me,"__await")?le.resolve(Me.__await).then(function(pe){H("next",pe,ue,ge)},function(pe){H("throw",pe,ue,ge)}):le.resolve(Me).then(function(pe){Se.value=pe,ue(Se)},function(pe){return H("throw",pe,ue,ge)})}}var R;function B(W,se){function ue(){return new le(function(ge,Ce){H(W,se,ge,Ce)})}return R=R?R.then(ue,ue):ue()}a(this,"_invoke",{value:B})}D(L.prototype),d(L.prototype,u,function(){return this}),t.AsyncIterator=L,t.async=function(ne,le,H,R,B){B===void 0&&(B=Promise);var W=new L(h(ne,le,H,R),B);return t.isGeneratorFunction(le)?W:W.next().then(function(se){return se.done?se.value:W.next()})};function P(ne,le,H){var R=g;return function(W,se){if(R===v)throw new Error("Generator is already running");if(R===w){if(W==="throw")throw se;return Z()}for(H.method=W,H.arg=se;;){var ue=H.delegate;if(ue){var ge=j(ue,H);if(ge){if(ge===x)continue;return ge}}if(H.method==="next")H.sent=H._sent=H.arg;else if(H.method==="throw"){if(R===g)throw R=w,H.arg;H.dispatchException(H.arg)}else H.method==="return"&&H.abrupt("return",H.arg);R=v;var Ce=p(ne,le,H);if(Ce.type==="normal"){if(R=H.done?w:b,Ce.arg===x)continue;return{value:Ce.arg,done:H.done}}else Ce.type==="throw"&&(R=w,H.method="throw",H.arg=Ce.arg)}}}function j(ne,le){var H=le.method,R=ne.iterator[H];if(R===o)return le.delegate=null,H==="throw"&&ne.iterator.return&&(le.method="return",le.arg=o,j(ne,le),le.method==="throw")||H!=="return"&&(le.method="throw",le.arg=new TypeError("The iterator does not provide a '"+H+"' method")),x;var B=p(R,ne.iterator,le.arg);if(B.type==="throw")return le.method="throw",le.arg=B.arg,le.delegate=null,x;var W=B.arg;if(!W)return le.method="throw",le.arg=new TypeError("iterator result is not an object"),le.delegate=null,x;if(W.done)le[ne.resultName]=W.value,le.next=ne.nextLoc,le.method!=="return"&&(le.method="next",le.arg=o);else return W;return le.delegate=null,x}D(A),d(A,f,"Generator"),d(A,c,function(){return this}),d(A,"toString",function(){return"[object Generator]"});function G(ne){var le={tryLoc:ne[0]};1 in ne&&(le.catchLoc=ne[1]),2 in ne&&(le.finallyLoc=ne[2],le.afterLoc=ne[3]),this.tryEntries.push(le)}function Q(ne){var le=ne.completion||{};le.type="normal",delete le.arg,ne.completion=le}function q(ne){this.tryEntries=[{tryLoc:"root"}],ne.forEach(G,this),this.reset(!0)}t.keys=function(ne){var le=Object(ne),H=[];for(var R in le)H.push(R);return H.reverse(),function B(){for(;H.length;){var W=H.pop();if(W in le)return B.value=W,B.done=!1,B}return B.done=!0,B}};function te(ne){if(ne){var le=ne[c];if(le)return le.call(ne);if(typeof ne.next=="function")return ne;if(!isNaN(ne.length)){var H=-1,R=function B(){for(;++H<ne.length;)if(r.call(ne,H))return B.value=ne[H],B.done=!1,B;return B.value=o,B.done=!0,B};return R.next=R}}return{next:Z}}t.values=te;function Z(){return{value:o,done:!0}}return q.prototype={constructor:q,reset:function(ne){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Q),!ne)for(var le in this)le.charAt(0)==="t"&&r.call(this,le)&&!isNaN(+le.slice(1))&&(this[le]=o)},stop:function(){this.done=!0;var ne=this.tryEntries[0],le=ne.completion;if(le.type==="throw")throw le.arg;return this.rval},dispatchException:function(ne){if(this.done)throw ne;var le=this;function H(ge,Ce){return W.type="throw",W.arg=ne,le.next=ge,Ce&&(le.method="next",le.arg=o),!!Ce}for(var R=this.tryEntries.length-1;R>=0;--R){var B=this.tryEntries[R],W=B.completion;if(B.tryLoc==="root")return H("end");if(B.tryLoc<=this.prev){var se=r.call(B,"catchLoc"),ue=r.call(B,"finallyLoc");if(se&&ue){if(this.prev<B.catchLoc)return H(B.catchLoc,!0);if(this.prev<B.finallyLoc)return H(B.finallyLoc)}else if(se){if(this.prev<B.catchLoc)return H(B.catchLoc,!0)}else if(ue){if(this.prev<B.finallyLoc)return H(B.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(ne,le){for(var H=this.tryEntries.length-1;H>=0;--H){var R=this.tryEntries[H];if(R.tryLoc<=this.prev&&r.call(R,"finallyLoc")&&this.prev<R.finallyLoc){var B=R;break}}B&&(ne==="break"||ne==="continue")&&B.tryLoc<=le&&le<=B.finallyLoc&&(B=null);var W=B?B.completion:{};return W.type=ne,W.arg=le,B?(this.method="next",this.next=B.finallyLoc,x):this.complete(W)},complete:function(ne,le){if(ne.type==="throw")throw ne.arg;return ne.type==="break"||ne.type==="continue"?this.next=ne.arg:ne.type==="return"?(this.rval=this.arg=ne.arg,this.method="return",this.next="end"):ne.type==="normal"&&le&&(this.next=le),x},finish:function(ne){for(var le=this.tryEntries.length-1;le>=0;--le){var H=this.tryEntries[le];if(H.finallyLoc===ne)return this.complete(H.completion,H.afterLoc),Q(H),x}},catch:function(ne){for(var le=this.tryEntries.length-1;le>=0;--le){var H=this.tryEntries[le];if(H.tryLoc===ne){var R=H.completion;if(R.type==="throw"){var B=R.arg;Q(H)}return B}}throw new Error("illegal catch attempt")},delegateYield:function(ne,le,H){return this.delegate={iterator:te(ne),resultName:le,nextLoc:H},this.method==="next"&&(this.arg=o),x}},t})(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(Q3)),Q3.exports}var J3,pG;function WF(){return pG||(pG=1,J3=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`),J3}var Z3,mG;function Gse(){if(mG)return Z3;mG=1;const n=WF();let e=0;return Z3=({id:t,action:s,payload:r={}})=>{let a=t;return typeof a>"u"&&(a=n("Job",e),e+=1),{id:a,action:s,payload:r}},Z3}var GC={},gG;function GF(){if(gG)return GC;gG=1;let n=!1;return GC.logging=n,GC.setLogging=e=>{n=e},GC.log=(...e)=>n?console.log.apply(this,e):null,GC}var e5,yG;function MCe(){if(yG)return e5;yG=1;const n=Gse(),{log:e}=GF(),t=WF();let s=0;return e5=()=>{const r=t("Scheduler",s),a={},o={};let l=[];s+=1;const c=()=>l.length,u=()=>Object.keys(a).length,f=()=>{if(l.length!==0){const b=Object.keys(a);for(let v=0;v<b.length;v+=1)if(typeof o[b[v]]>"u"){l[0](a[b[v]]);break}}},d=(b,v)=>new Promise((w,x)=>{const S=n({action:b,payload:v});l.push(async C=>{l.shift(),o[C.id]=S;try{w(await C[b].apply(this,[...v,S.id]))}catch(M){x(M)}finally{delete o[C.id],f()}}),e(`[${r}]: Add ${S.id} to JobQueue`),e(`[${r}]: JobQueue length=${l.length}`),f()});return{addWorker:b=>(a[b.id]=b,e(`[${r}]: Add ${b.id}`),e(`[${r}]: Number of workers=${u()}`),f(),b.id),addJob:async(b,...v)=>{if(u()===0)throw Error(`[${r}]: You need to have at least one worker before adding jobs`);return d(b,v)},terminate:async()=>{Object.keys(a).forEach(async b=>{await a[b].terminate()}),l=[]},getQueueLen:c,getNumWorkers:u}},e5}function TCe(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var t5,bG;function kCe(){return bG||(bG=1,t5=n=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof TCe=="function"&&(e.type="node"),typeof n>"u"?e:e[n]}),t5}var n5,wG;function ECe(){if(wG)return n5;wG=1;const e=kCe()("type")==="browser"?t=>new URL(t,window.location.href).href:t=>t;return n5=t=>{const s={...t};return["corePath","workerPath","langPath"].forEach(r=>{t[r]&&(s[r]=e(s[r]))}),s},n5}var s5,vG;function Hse(){return vG||(vG=1,s5={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),s5}const ICe="7.0.0",ACe={version:ICe};var r5,_G;function LCe(){return _G||(_G=1,r5={workerBlobURL:!0,logger:()=>{}}),r5}var i5,xG;function NCe(){if(xG)return i5;xG=1;const n=ACe.version;return i5={...LCe(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},i5}var a5,CG;function DCe(){return CG||(CG=1,a5=({workerPath:n,workerBlobURL:e})=>{let t;if(Blob&&URL&&e){const s=new Blob([`importScripts("${n}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(s))}else t=new Worker(n);return t}),a5}var o5,SG;function OCe(){return SG||(SG=1,o5=n=>{n.terminate()}),o5}var l5,MG;function PCe(){return MG||(MG=1,l5=(n,e)=>{n.onmessage=({data:t})=>{e(t)}}),l5}var c5,TG;function $Ce(){return TG||(TG=1,c5=async(n,e)=>{n.postMessage(e)}),c5}var u5,kG;function jCe(){if(kG)return u5;kG=1;const n=t=>new Promise((s,r)=>{const a=new FileReader;a.onload=()=>{s(a.result)},a.onerror=({target:{error:{code:o}}})=>{r(Error(`File could not be read! Code=${o}`))},a.readAsArrayBuffer(t)}),e=async t=>{let s=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?s=atob(t.split(",")[1]).split("").map(r=>r.charCodeAt(0)):s=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(s=await e(t.src)),t.tagName==="VIDEO"&&(s=await e(t.poster)),t.tagName==="CANVAS"&&await new Promise(r=>{t.toBlob(async a=>{s=await n(a),r()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const r=await t.convertToBlob();s=await n(r)}else(t instanceof File||t instanceof Blob)&&(s=await n(t));return new Uint8Array(s)};return u5=e,u5}var f5,EG;function RCe(){if(EG)return f5;EG=1;const n=NCe(),e=DCe(),t=OCe(),s=PCe(),r=$Ce(),a=jCe();return f5={defaultOptions:n,spawnWorker:e,terminateWorker:t,onMessage:s,send:r,loadImage:a},f5}var d5,IG;function qse(){if(IG)return d5;IG=1;const n=ECe(),e=Gse(),{log:t}=GF(),s=WF(),r=Hse(),{defaultOptions:a,spawnWorker:o,terminateWorker:l,onMessage:c,loadImage:u,send:f}=RCe();let d=0;return d5=async(h="eng",p=r.LSTM_ONLY,g={},b={})=>{const v=s("Worker",d),{logger:w,errorHandler:x,...S}=n({...a,...g}),C={},M=typeof h=="string"?h.split("+"):h;let k=p,E=b;const I=[r.DEFAULT,r.LSTM_ONLY].includes(p)&&!S.legacyCore;let A,D;const L=new Promise((Se,Me)=>{D=Se,A=Me}),P=Se=>{A(Se.message)};let j=o(S);j.onerror=P,d+=1;const G=({id:Se,action:Me,payload:pe})=>new Promise((fe,$e)=>{t(`[${v}]: Start ${Se}, action=${Me}`);const We=`${Me}-${Se}`;C[We]={resolve:fe,reject:$e},f(j,{workerId:v,jobId:Se,action:Me,payload:pe})}),Q=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),q=Se=>G(e({id:Se,action:"load",payload:{options:{lstmOnly:I,corePath:S.corePath,logging:S.logging}}})),te=(Se,Me,pe)=>G(e({id:pe,action:"FS",payload:{method:"writeFile",args:[Se,Me]}})),Z=(Se,Me)=>G(e({id:Me,action:"FS",payload:{method:"readFile",args:[Se,{encoding:"utf8"}]}})),ne=(Se,Me)=>G(e({id:Me,action:"FS",payload:{method:"unlink",args:[Se]}})),le=(Se,Me,pe)=>G(e({id:pe,action:"FS",payload:{method:Se,args:Me}})),H=(Se,Me)=>G(e({id:Me,action:"loadLanguage",payload:{langs:Se,options:{langPath:S.langPath,dataPath:S.dataPath,cachePath:S.cachePath,cacheMethod:S.cacheMethod,gzip:S.gzip,lstmOnly:[r.DEFAULT,r.LSTM_ONLY].includes(k)&&!S.legacyLang}}})),R=(Se,Me,pe,fe)=>G(e({id:fe,action:"initialize",payload:{langs:Se,oem:Me,config:pe}})),B=(Se="eng",Me,pe,fe)=>{if(I&&[r.TESSERACT_ONLY,r.TESSERACT_LSTM_COMBINED].includes(Me))throw Error("Legacy model requested but code missing.");const $e=Me||k;k=$e;const We=pe||E;E=We;const Be=(typeof Se=="string"?Se.split("+"):Se).filter(st=>!M.includes(st));return M.push(...Be),Be.length>0?H(Be,fe).then(()=>R(Se,$e,We,fe)):R(Se,$e,We,fe)},W=(Se={},Me)=>G(e({id:Me,action:"setParameters",payload:{params:Se}})),se=async(Se,Me={},pe={text:!0},fe)=>G(e({id:fe,action:"recognize",payload:{image:await u(Se),options:Me,output:pe}})),ue=async(Se,Me)=>{if(I)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return G(e({id:Me,action:"detect",payload:{image:await u(Se)}}))},ge=async()=>(j!==null&&(l(j),j=null),Promise.resolve());c(j,({workerId:Se,jobId:Me,status:pe,action:fe,data:$e})=>{const We=`${fe}-${Me}`;if(pe==="resolve")t(`[${Se}]: Complete ${Me}`),C[We].resolve({jobId:Me,data:$e}),delete C[We];else if(pe==="reject")if(C[We].reject($e),delete C[We],fe==="load"&&A($e),x)x($e);else throw Error($e);else pe==="progress"&&w({...$e,userJobId:Me})});const Ce={id:v,worker:j,load:Q,writeText:te,readText:Z,removeFile:ne,FS:le,reinitialize:B,setParameters:W,recognize:se,detect:ue,terminate:ge};return q().then(()=>H(h)).then(()=>R(h,p,b)).then(()=>D(Ce)).catch(()=>{}),L},d5}var h5,AG;function FCe(){if(AG)return h5;AG=1;const n=qse();return h5={recognize:async(s,r,a)=>{const o=await n(r,1,a);return o.recognize(s).finally(async()=>{await o.terminate()})},detect:async(s,r)=>{const a=await n("osd",0,r);return a.detect(s).finally(async()=>{await a.terminate()})}},h5}var p5,LG;function zCe(){return LG||(LG=1,p5={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),p5}var m5,NG;function BCe(){return NG||(NG=1,m5={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),m5}var g5,DG;function UCe(){if(DG)return g5;DG=1,SCe();const n=MCe(),e=qse(),t=FCe(),s=zCe(),r=Hse(),a=BCe(),{setLogging:o}=GF();return g5={languages:s,OEM:r,PSM:a,createScheduler:n,createWorker:e,setLogging:o,...t},g5}var VCe=UCe();const WCe={extractText:async(n,e="lao+eng",t=null)=>{let s=null;try{return s=await VCe.createWorker(e,1,{logger:a=>{t&&a.status==="recognizing text"&&t(a.progress),console.log(a)}}),(await s.recognize(n)).data.text}catch(r){throw console.error("OCR Failed:",r),r}finally{s&&await s.terminate()}}};class GCe{constructor(e){this.cm=e,this.canvas=e.canvas,this._isDisposed=!1,this.isDragging=!1,this.isSpacePanning=!1,this.isHandMode=!1,this.lastPosX=0,this.lastPosY=0,this.canvasWrapper=document.getElementById("canvas-wrapper"),this.zoomCallback=null,this.handleWindowResize=()=>{this.canvasWrapper&&!this._isDisposed&&this.resizeCanvasElement(this.canvasWrapper.clientWidth,this.canvasWrapper.clientHeight)},this.setupZoomPan(),window.addEventListener("resize",this.handleWindowResize),this.canvasWrapper&&(this.resizeTimeout=setTimeout(()=>{this._isDisposed||this.resizeCanvasElement(this.canvasWrapper.clientWidth,this.canvasWrapper.clientHeight)},0))}dispose(){this._isDisposed=!0,window.removeEventListener("resize",this.handleWindowResize),clearTimeout(this.resizeTimeout)}onZoomChange(e){this.zoomCallback=e}setupZoomPan(){this.canvas.on("mouse:wheel",e=>{if(!e.e.altKey)return;const t=e.e.deltaY;let s=this.canvas.getZoom();s*=.999**t,s>5&&(s=5),s<.05&&(s=.05);const r=new Dt(e.e.offsetX,e.e.offsetY);this.canvas.zoomToPoint(r,s),this.zoomCallback&&this.zoomCallback(s),e.e.preventDefault(),e.e.stopPropagation()}),this.canvas.on("mouse:down",e=>{const t=e.e;(this.isSpacePanning||this.isHandMode)&&(this.isDragging=!0,this.canvas.selection=!1,this.lastPosX=t.clientX,this.lastPosY=t.clientY,this.canvas.setCursor("grabbing"))}),this.canvas.on("mouse:move",e=>{if(this.isDragging){const t=e.e,s=t.clientX-this.lastPosX,r=t.clientY-this.lastPosY;this.canvas.relativePan(new Dt(s,r)),this.lastPosX=t.clientX,this.lastPosY=t.clientY,e.e.preventDefault()}}),this.canvas.on("mouse:up",()=>{this.canvas.setViewportTransform(this.canvas.viewportTransform),this.isDragging=!1,(this.isHandMode||this.isSpacePanning)&&this.canvas.setCursor("grab"),!this.isHandMode&&!this.isSpacePanning?(this.canvas.selection=!0,this.canvas.setCursor("default")):this.canvas.setCursor("grab")})}setZoom(e){let t=e;t>5&&(t=5),t<.05&&(t=.05);const s=new Dt(this.canvas.width/2,this.canvas.height/2);this.canvas.zoomToPoint(s,t),this.zoomCallback&&this.zoomCallback(t)}zoomIn(){this.setZoom(this.canvas.getZoom()*1.2)}zoomOut(){this.setZoom(this.canvas.getZoom()/1.2)}resetZoom(){if(!this.cm.originalWidth)this.canvas.setViewportTransform([1,0,0,1,0,0]);else{const t=this.canvas.width,s=this.canvas.height,r=this.cm.originalWidth,a=this.cm.originalHeight,o=(t-r*1)/2,l=(s-a*1)/2;this.canvas.setViewportTransform([1,0,0,1,o,l])}this.zoomCallback&&this.zoomCallback(1)}fitToScreen(){if(!this.cm.originalWidth)return;const e=this.canvas.width,t=this.canvas.height,s=(e-80)/this.cm.originalWidth,r=(t-80)/this.cm.originalHeight;let a=Math.min(s,r);this.canvas.setViewportTransform([1,0,0,1,0,0]);const o=(e-this.cm.originalWidth*a)/2,l=(t-this.cm.originalHeight*a)/2;this.canvas.setViewportTransform([a,0,0,a,o,l]),this.canvas.requestRenderAll(),this.zoomCallback&&this.zoomCallback(a)}resizeCanvasElement(e,t){this.canvas.setDimensions({width:parseInt(e),height:parseInt(t)})}resizePage(e,t){const s=parseInt(e),r=parseInt(t);this.cm.originalWidth=s,this.cm.originalHeight=r,this.cm.workspace&&(this.cm.workspace.set({width:s,height:r}),this.cm.workspace.setCoords(),this.cm.canvas.requestRenderAll()),this.fitToScreen()}toggleHandMode(){return this._isDisposed||!this.canvas?!1:(this.isHandMode=!this.isHandMode,this.isHandMode?(this.canvas.selection=!1,this.canvas.defaultCursor="grab",this.canvas.hoverCursor="grab",this.canvas.moveCursor="grab",this.canvas.setCursor("grab")):(this.canvas.selection=!0,this.canvas.defaultCursor="default",this.canvas.hoverCursor="move",this.canvas.moveCursor="move",this.canvas.setCursor("default")),this.isHandMode)}setSpacePanning(e){this._isDisposed||!this.canvas||this.isSpacePanning!==e&&(this.isSpacePanning=e,e?(this.canvas.selection=!1,this.canvas.defaultCursor="grab",this.canvas.hoverCursor="grab",this.canvas.moveCursor="grab",this.canvas.setCursor("grab"),this.canvas.discardActiveObject(),this.canvas.requestRenderAll()):(this.isHandMode||(this.canvas.selection=!0,this.canvas.defaultCursor="default",this.canvas.hoverCursor="move",this.canvas.moveCursor="move",this.canvas.setCursor("default")),this.isDragging=!1,this.canvas.requestRenderAll()))}}class HCe{constructor(e){this.cm=e,this.canvas=e.canvas,this.setupEvents(),this.setupDragDrop(),this.setupShortcuts()}dispose(){this.boundKeydown&&document.removeEventListener("keydown",this.boundKeydown),this.boundKeyup&&document.removeEventListener("keyup",this.boundKeyup),this.boundPaste&&document.removeEventListener("paste",this.boundPaste),this.canvas&&this.canvas.off()}setupEvents(){const e=()=>{this.cm.selectionCallback&&this.cm.selectionCallback(this.canvas.getActiveObject())};let t,s="Modification";const r=l=>{s=l,clearTimeout(t),t=setTimeout(()=>{o(s)},500)},a=(l,c)=>{if(!l)return c;const u=l.type==="i-text"?"Text":l.type==="image"?"Image":l.type.charAt(0).toUpperCase()+l.type.slice(1);return`${c} ${u}`},o=(l="Modification",c=null)=>{this.cm.historyManager&&this.cm.historyManager.saveState(l)};this.canvas.on("selection:created",e),this.canvas.on("selection:updated",e),this.canvas.on("selection:cleared",e),this.canvas.on("path:created",l=>{const c=l.path;c&&(c.set("strokeUniform",!0),c.setCoords(),this.canvas.requestRenderAll())}),this.canvas.on("object:modified",l=>{e();const c=a(l.target,"Modified");r(c)}),this.canvas.on("object:added",l=>{if(l.target&&!l.target.isSmartGuide&&!l.target.excludeFromExport){const c=a(l.target,"Added");o(c,l.target)}}),this.canvas.on("object:removed",l=>{if(l.target&&!l.target.isSmartGuide&&!l.target.excludeFromExport){const c=a(l.target,"Removed");o(c,l.target)}}),this.canvas.on("object:moving",l=>{e(),this.cm.snapToGrid&&this.cm.snapToGrid(l.target),this.cm.handleObjectMoving&&this.cm.handleObjectMoving(l)}),this.canvas.on("object:scaling",e),this.canvas.on("object:rotating",e),this.canvas.on("mouse:up",()=>{this.cm.clearGuidelines&&this.cm.clearGuidelines()})}setupDragDrop(){const e=this.canvas.wrapperEl;e.addEventListener("dragover",t=>{t.preventDefault(),t.stopPropagation()}),e.addEventListener("drop",t=>{t.preventDefault(),t.stopPropagation();const s=t.dataTransfer.files[0];if(s&&s.type.startsWith("image/")){const r=new FileReader;r.onload=a=>this.cm.addImage(a.target.result),r.readAsDataURL(s),$s.success("Image uploaded via drag & drop")}})}setupShortcuts(){this.boundKeydown=async e=>{if(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.isContentEditable||e.repeat||!this.cm||!this.cm.canvas)return;const t=this.cm.getActiveObject();if(e.key==="Delete"||e.key==="Backspace"){this.cm.removeActiveObject();return}if(t){const s=e.shiftKey?10:1;e.key==="ArrowLeft"?(e.preventDefault(),this.cm.nudgeActiveObject(-s,0)):e.key==="ArrowRight"?(e.preventDefault(),this.cm.nudgeActiveObject(s,0)):e.key==="ArrowUp"?(e.preventDefault(),this.cm.nudgeActiveObject(0,-s)):e.key==="ArrowDown"&&(e.preventDefault(),this.cm.nudgeActiveObject(0,s))}if((e.ctrlKey||e.metaKey)&&(e.code==="KeyC"&&(e.preventDefault(),await this.cm.copy()),e.code==="KeyV"&&this.cm.clipboardManager.clipboard&&(e.preventDefault(),await this.cm.paste()),e.code==="KeyD"&&(e.preventDefault(),this.cm.duplicateActiveObject())),(e.ctrlKey||e.metaKey)&&e.code==="KeyG"&&(e.preventDefault(),e.shiftKey?this.cm.ungroup():this.cm.group()),(e.ctrlKey||e.metaKey)&&e.code==="KeyA"&&(e.preventDefault(),this.cm.selectAll&&this.cm.selectAll()),e.code==="Space"||e.key===" "){if(t&&t.isEditing||this.cm.viewport&&this.cm.viewport.isSpacePanning)return;e.preventDefault(),this.cm.viewport&&this.cm.viewport.setSpacePanning(!0)}},this.boundKeyup=e=>{(e.code==="Space"||e.key===" ")&&this.cm&&this.cm.viewport&&this.cm.viewport.setSpacePanning(!1)},this.boundPaste=async e=>{if(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.isContentEditable)return;const t=e.clipboardData||window.clipboardData;if(!t)return;const s=t.items;let r=!1;for(let a=0;a<s.length;a++)if(s[a].type.indexOf("image")!==-1){r=!0;const o=s[a].getAsFile(),l=new FileReader;l.onload=c=>{this.cm.addImage(c.target.result)},l.readAsDataURL(o),$s.success("Image pasted from clipboard");break}else s[a].type.indexOf("text/plain")!==-1&&(r=!0,s[a].getAsString(o=>{if(o){this.cm.clipboardManager&&this.cm.clipboardManager.hasInternalContent;const l=this.canvas.viewportTransform,c=this.canvas.getCenter(),u=(c.left-l[4])/l[0],f=(c.top-l[5])/l[3],d=new lh(o,{left:u,top:f,originX:"center",originY:"center",fontFamily:"Noto Sans Lao",fontSize:40,fill:"#ffffff"});this.canvas.add(d),this.canvas.setActiveObject(d),this.canvas.requestRenderAll(),$s.success("Text pasted from clipboard")}}));r&&e.preventDefault()},document.addEventListener("keydown",this.boundKeydown),document.addEventListener("keyup",this.boundKeyup),document.addEventListener("paste",this.boundPaste)}}class qCe{constructor(e){this.cm=e}get canvas(){return this.cm.canvas}get workspace(){return this.cm.workspace}align(e,t=!1){const s=this.canvas.getActiveObject();if(!s)return;const a=(s.type?s.type.toLowerCase():"")==="activeselection",o=a&&!t?s.getObjects():[s];let l;a&&!t?l=s.getBoundingRect():l={left:this.workspace.left,top:this.workspace.top,width:this.workspace.width,height:this.workspace.height},o.forEach(c=>{const f=a&&!t?c.getBoundingRect():c.getBoundingRect(!0),d=a&&!t?s.getBoundingRect():l;let h=0,p=0;switch(e){case"left":h=d.left-f.left;break;case"center":h=d.left+d.width/2-(f.left+f.width/2);break;case"right":h=d.left+d.width-(f.left+f.width);break;case"top":p=d.top-f.top;break;case"middle":p=d.top+d.height/2-(f.top+f.height/2);break;case"bottom":p=d.top+d.height-(f.top+f.height);break}(h!==0||p!==0)&&(c.set({left:c.left+h,top:c.top+p}),c.setCoords())}),a&&!t&&(typeof s._calcBounds=="function"&&s._calcBounds(),s.setCoords(),s.set("dirty",!0)),this.canvas.fire("object:modified",{target:s}),this.canvas.renderAll(),this.cm.historyManager&&this.cm.historyManager.saveState(`Align ${e}`)}distribute(e){const t=this.canvas.getActiveObject();if(!t||(t.type?t.type.toLowerCase():"")!=="activeselection")return;const r=t.getObjects().map(h=>({obj:h,bounds:h.getBoundingRect()})).sort((h,p)=>e==="horizontal"?h.bounds.left-p.bounds.left:h.bounds.top-p.bounds.top);if(r.length<3)return;const a=e==="horizontal",o=r.reduce((h,p)=>h+(a?p.bounds.width:p.bounds.height),0),l=t.getBoundingRect(),f=((a?l.width:l.height)-o)/(r.length-1);let d=a?l.left:l.top;r.forEach(h=>{const p=h.obj,g=h.bounds;if(a){const b=d-g.left;p.set("left",p.left+b),d+=g.width+f}else{const b=d-g.top;p.set("top",p.top+b),d+=g.height+f}p.setCoords(),p.set("dirty",!0)}),typeof t._calcBounds=="function"&&t._calcBounds(),t.setCoords(),t.set("dirty",!0),this.canvas.fire("object:modified",{target:t}),this.canvas.renderAll(),this.cm.historyManager&&this.cm.historyManager.saveState(`Distribute ${e}`)}}class YCe{constructor(e){this.cm=e,this.clipboard=null}get canvas(){return this.cm.canvas}get hasInternalContent(){return!!this.clipboard}async copy(){const e=this.canvas.getActiveObject();if(e){const t=await e.clone();this.clipboard=t,$s.info("Copied to clipboard")}}async paste(){if(this.clipboard){const e=await this.clipboard.clone();this.canvas.discardActiveObject(),e.set({left:e.left+10,top:e.top+10,evented:!0}),e.type==="activeSelection"?(e.canvas=this.canvas,e.forEachObject(t=>this.canvas.add(t)),e.setCoords()):this.canvas.add(e),this.clipboard.top+=10,this.clipboard.left+=10,this.canvas.setActiveObject(e),this.canvas.requestRenderAll(),$s.success("Pasted object");return}try{const e=await navigator.clipboard.readText();if(e){const t=this.canvas.viewportTransform,s=this.canvas.getCenter(),r=(s.left-t[4])/t[0],a=(s.top-t[5])/t[3],o=new fabric.IText(e,{left:r,top:a,originX:"center",originY:"center",fontFamily:"Noto Sans Lao",fontSize:40,fill:"#ffffff"});this.canvas.add(o),this.canvas.setActiveObject(o),this.canvas.requestRenderAll(),$s.success("Pasted text from clipboard")}}catch(e){console.warn("Clipboard read permission denied or empty",e)}}async duplicate(){const e=this.canvas.getActiveObject();if(!e)return;const t=await e.clone();this.canvas.discardActiveObject(),t.set({left:(e.left||0)+10,top:(e.top||0)+10,evented:!0}),t.type==="activeSelection"?(t.canvas=this.canvas,t.forEachObject(s=>this.canvas.add(s)),t.setCoords()):this.canvas.add(t),this.canvas.setActiveObject(t),this.canvas.requestRenderAll(),$s.success("Object duplicated")}}class KCe{constructor(e){this.cm=e,this.gridObject=null,this.snapThreshold=10,this.guidelines=[]}get canvas(){return this.cm.canvas}get workspace(){return this.cm.workspace}get originalWidth(){return this.cm.originalWidth}get originalHeight(){return this.cm.originalHeight}toggleGrid(){if(this.gridObject)return this.canvas.remove(this.gridObject),this.gridObject=null,this.canvas.requestRenderAll(),!1;const e=50,t=document.createElement("canvas");t.width=e,t.height=e;const s=t.getContext("2d");s.strokeStyle="rgba(0, 0, 0, 0.1)",s.lineWidth=1,s.beginPath(),s.moveTo(.5,0),s.lineTo(.5,e),s.moveTo(0,.5),s.lineTo(e,.5),s.stroke();const r=new oL({source:t,repeat:"repeat"}),a=new dm({left:0,top:0,width:this.originalWidth,height:this.originalHeight,fill:r,selectable:!1,evented:!1,excludeFromExport:!0});if(this.gridObject=a,this.canvas.add(a),this.workspace){const o=this.canvas.getObjects().indexOf(this.workspace);this.canvas.moveObjectTo(a,o+1)}else this.canvas.sendObjectToBack(a);return this.canvas.requestRenderAll(),!0}snapToGrid(e){if(!this.gridObject)return;const t=50,s=10,r=Math.round(e.left/t)*t,a=Math.round(e.top/t)*t;Math.abs(e.left-r)<s&&e.set("left",r),Math.abs(e.top-a)<s&&e.set("top",a)}addGuide(e,t){let s;const r={stroke:"cyan",strokeDashArray:[4,4],strokeWidth:1,selectable:!0,evented:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,hasControls:!1,hasBorders:!1,id:"guide",excludeFromExport:!0};return e==="horizontal"?s=new W0([0,0,this.originalWidth,0],{...r,top:t,left:0,lockMovementX:!0,lockMovementY:!1,hoverCursor:"ns-resize",moveCursor:"ns-resize",width:this.originalWidth}):s=new W0([0,0,0,this.originalHeight],{...r,top:0,left:t,lockMovementX:!1,lockMovementY:!0,hoverCursor:"ew-resize",moveCursor:"ew-resize",height:this.originalHeight}),this.canvas.add(s),this.canvas.bringObjectToFront(s),this.canvas.setActiveObject(s),this.canvas.requestRenderAll(),s}handleObjectMoving(e){const t=e.target,s=this.canvas,r=this.originalWidth,a=this.originalHeight,o=this.snapThreshold;this.clearGuidelines();const l=t.left,c=t.top,u=t.getScaledWidth(),f=t.getScaledHeight(),d=l+u/2,h=c+f/2,p=l+u,g=c+f;let b=null,v=null;Math.abs(d-r/2)<o&&(t.set({left:r/2-u/2}),b=r/2),b||s.getObjects().forEach(w=>{if(w===t||!w.visible)return;if(w.id==="guide"){if(w.lockMovementY){const k=w.left;Math.abs(l-k)<o?(t.set({left:k}),b=k):Math.abs(p-k)<o?(t.set({left:k-u}),b=k):Math.abs(d-k)<o&&(t.set({left:k-u/2}),b=k)}return}const x=w.left,S=w.getScaledWidth(),C=x+S/2,M=x+S;Math.abs(d-C)<o?(t.set({left:C-u/2}),b=C):Math.abs(l-x)<o?(t.set({left:x}),b=x):Math.abs(p-M)<o?(t.set({left:M-u}),b=M):Math.abs(l-M)<o?(t.set({left:M}),b=M):Math.abs(p-x)<o&&(t.set({left:x-u}),b=x)}),Math.abs(h-a/2)<o&&(t.set({top:a/2-f/2}),v=a/2),v||s.getObjects().forEach(w=>{if(w===t||!w.visible)return;if(w.id==="guide"){if(w.lockMovementX){const k=w.top;Math.abs(c-k)<o?(t.set({top:k}),v=k):Math.abs(g-k)<o?(t.set({top:k-f}),v=k):Math.abs(h-k)<o&&(t.set({top:k-f/2}),v=k)}return}const x=w.top,S=w.getScaledHeight(),C=x+S/2,M=x+S;Math.abs(h-C)<o?(t.set({top:C-f/2}),v=C):Math.abs(c-x)<o?(t.set({top:x}),v=x):Math.abs(g-M)<o?(t.set({top:M-f}),v=M):Math.abs(c-M)<o?(t.set({top:M}),v=M):Math.abs(g-x)<o&&(t.set({top:x-f}),v=x)}),b!==null&&this.drawVerticalLine(b),v!==null&&this.drawHorizontalLine(v)}clearGuidelines(){this.canvas.getObjects("line").forEach(e=>{e.isSmartGuide&&this.canvas.remove(e)}),this.canvas.requestRenderAll()}drawVerticalLine(e){this.drawGuideLine([e,0,e,this.originalHeight])}drawHorizontalLine(e){this.drawGuideLine([0,e,this.originalWidth,e])}drawGuideLine(e){const t=new W0(e,{stroke:"red",strokeWidth:1,selectable:!1,evented:!1,strokeDashArray:[4,4],isSmartGuide:!0,excludeFromExport:!0});this.canvas.add(t)}}class XCe{constructor(e){this.canvasManager=e}get canvas(){return this.canvasManager.canvas}getActiveObject(){return this.canvasManager.getActiveObject()}async duplicate(){}toggleLock(){const e=this.getActiveObject();if(!e)return;const t=!e.lockMovementX;e.set({lockMovementX:t,lockMovementY:t,lockScalingX:t,lockScalingY:t,lockRotation:t,hasControls:!t,selectable:!0}),this.canvas.requestRenderAll(),$s.info(t?"Object locked":"Object unlocked")}reset(){this.canvas.discardActiveObject(),this.canvas.requestRenderAll()}remove(){const e=this.getActiveObject();!e||e.isEditing||(e.type==="activeSelection"||e instanceof ip?e.forEachObject(t=>{this.canvas.remove(t)}):this.canvas.remove(e),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.canvasManager.selectionCallback&&this.canvasManager.selectionCallback(null),$s.success("Object(s) removed"))}flip(e){const t=this.getActiveObject();t&&(t.type==="activeSelection"?t.forEachObject(s=>{e==="horizontal"?s.set("flipX",!s.flipX):s.set("flipY",!s.flipY)}):e==="horizontal"?t.set("flipX",!t.flipX):t.set("flipY",!t.flipY),this.canvas.requestRenderAll(),this.canvas.requestRenderAll())}layer(e){switch(e){case"up":this.bringForward();break;case"down":this.sendBackward();break;case"front":this.bringToFront();break;case"back":this.sendToBack();break}}bringForward(){const e=this.getActiveObject();e&&(this.canvas.bringObjectForward(e),this.canvas.renderAll(),this.canvas.fire("layer:updated"))}sendBackward(){const e=this.getActiveObject();e&&this.canvas.getObjects().indexOf(e)>0&&(this.canvas.sendObjectBackwards(e),this.canvas.renderAll(),this.canvas.fire("layer:updated"))}bringToFront(){const e=this.getActiveObject();e&&(this.canvas.bringObjectToFront(e),this.canvas.renderAll(),this.canvas.fire("layer:updated"))}sendToBack(){const e=this.getActiveObject();e&&(this.canvas.sendObjectToBack(e),this.canvasManager.workspace&&this.canvas.sendObjectToBack(this.canvasManager.workspace),this.canvas.renderAll(),this.canvas.fire("layer:updated"))}group(){const e=this.getActiveObject();if(!e||e.type!=="activeSelection"&&e.type!=="activeselection")return;const t=e.getObjects();this.canvas.discardActiveObject(),t.forEach(r=>this.canvas.remove(r));const s=new xm(t,{selectable:!0,evented:!0,subTargetCheck:!1,interactive:!1});s.setCoords(),this.canvas.add(s),this.canvas.setActiveObject(s),this.canvas.requestRenderAll(),$s.success("Grouped objects")}async ungroup(){const e=this.getActiveObject();if(!e||e.type!=="group"&&e.type!=="Group")return;const t=e.calcTransformMatrix(),s=e.angle||0,r=e.scaleX||1,a=e.scaleY||1,o=[...e.getObjects()];this.canvas.remove(e),this.canvas.discardActiveObject();const l=[],c=o.map(f=>f.clone()),u=await Promise.all(c);for(let f=0;f<u.length;f++){const d=o[f],h=u[f],p=Qa.transformPoint(new Dt(d.left,d.top),t);h.set({left:p.x,top:p.y,angle:(d.angle||0)+s,scaleX:(d.scaleX||1)*r,scaleY:(d.scaleY||1)*a,group:null,selectable:!0,evented:!0,dirty:!0}),h.setCoords(),this.canvas.add(h),l.push(h)}if(l.length>0){const f=new ip(l,{canvas:this.canvas});this.canvas.setActiveObject(f)}this.canvas.requestRenderAll(),$s.success("Ungrouped objects")}}const OG={rect:n=>new dm({strokeUniform:!0,...n}),circle:n=>(n.width&&!n.radius&&(n.radius=n.width/2),new Ty({strokeUniform:!0,...n})),triangle:n=>new xS({strokeUniform:!0,...n}),star:n=>{const e=[{x:350,y:75},{x:380,y:160},{x:470,y:160},{x:400,y:215},{x:423,y:301},{x:350,y:250},{x:277,y:301},{x:303,y:215},{x:231,y:161},{x:321,y:161}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},pentagon:n=>{const e=[{x:50,y:0},{x:100,y:38},{x:82,y:100},{x:18,y:100},{x:0,y:38}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},hexagon:n=>{const e=[{x:50,y:0},{x:100,y:25},{x:100,y:75},{x:50,y:100},{x:0,y:75},{x:0,y:25}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},arrow:n=>{const e=[{x:0,y:25},{x:50,y:25},{x:50,y:0},{x:100,y:50},{x:50,y:100},{x:50,y:75},{x:0,y:75}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},heart:n=>{const e="M 272.70141,238.71731         C 206.46141,238.71731 152.70141,292.47731 152.70141,358.71731          C 152.70141,493.46231 288.63461,521.28716 381.92956,598.5043         C 468.52458,519.8324 611.16641,496.06231 611.16641,358.71731         C 611.16641,292.47731 557.40641,238.71731 491.16641,238.71731         C 449.12141,238.71731 411.66641,262.11731 381.92956,298.5043         C 352.19271,262.11731 314.73141,238.71731 272.70141,238.71731          z",t=new Cg(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},message_box:n=>{const e="M20,2H4C2.9,2,2,2.9,2,4v18l4-4h14c1.1,0,2-0.9,2-2V4C22,2.9,21.1,2,20,2z",t=new Cg(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},right_triangle:n=>{const e=[{x:0,y:0},{x:0,y:100},{x:100,y:100}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},diamond:n=>{const e=[{x:50,y:0},{x:100,y:50},{x:50,y:100},{x:0,y:50}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},parallelogram:n=>{const e=[{x:25,y:0},{x:100,y:0},{x:75,y:100},{x:0,y:100}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},trapezoid:n=>{const e=[{x:25,y:0},{x:75,y:0},{x:100,y:100},{x:0,y:100}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},cross:n=>{const e=[{x:35,y:0},{x:65,y:0},{x:65,y:35},{x:100,y:35},{x:100,y:65},{x:65,y:65},{x:65,y:100},{x:35,y:100},{x:35,y:65},{x:0,y:65},{x:0,y:35},{x:35,y:35}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},cloud:n=>{const e="M17.5,19c-4.1,0-7.5-3.4-7.5-7.5c0-1.8,0.6-3.4,1.7-4.7C10.6,2.8,14.5,0,19,0c5.4,0,9.8,3.9,10.8,9.1 c1.4-0.7,3-1.1,4.7-1.1c5.2,0,9.5,4.3,9.5,9.5c0,0.3,0,0.5,0,0.8C46.8,18.8,49,21.6,49,25c0,4.4-3.6,8-8,8H9c-5,0-9-4-9-9 c0-4.7,3.6-8.5,8.2-8.9C8.8,22.2,12.8,19,17.5,19z",t=new Cg(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t},burst:n=>{const e=[],a={x:50,y:50};for(let l=0;l<24;l++){const c=l%2===0?50:30,u=Math.PI*l/12;e.push({x:a.x+c*Math.sin(u),y:a.y+c*Math.cos(u)})}const o=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return o.scaleToWidth(n.width||100),o},lightning:n=>{const e=[{x:40,y:0},{x:15,y:60},{x:45,y:60},{x:25,y:100},{x:75,y:35},{x:45,y:35}],t=new Pu(e,{strokeUniform:!0,...n,objectCaching:!1});return t.scaleToWidth(n.width||100),t}},QCe=(n,e)=>OG[n]?OG[n](e):(console.warn(`Shape type "${n}" not found in config.`),null);class JCe{constructor(e){this.canvasManager=e}get canvas(){return this.canvasManager.canvas}addText(e="Double click to edit",t={}){const s=new lh(e,{left:100,top:100,fontFamily:"'Phetsarath OT', 'Noto Sans Lao', sans-serif",fill:"#333",fontSize:40,...t});this.canvas.add(s),this.canvas.setActiveObject(s),this.canvas.requestRenderAll()}async addImage(e,t={}){try{const s=await ih.fromURL(e);s.width>this.canvasManager.originalWidth&&s.scaleToWidth(this.canvasManager.originalWidth/2),t.fill&&s.set({tint:t.fill}),this.canvas.add(s),s.set({left:this.canvasManager.originalWidth/2,top:this.canvasManager.originalHeight/2,originX:"center",originY:"center"}),this.canvas.setActiveObject(s),this.canvas.requestRenderAll()}catch(s){console.error("Error loading image:",s)}}addShape(e,t={}){const s={left:100,top:100,...t},r=QCe(e,s);r&&(this.canvas.add(r),this.canvas.setActiveObject(r),this.canvas.requestRenderAll())}async addSVG(e,t={}){try{const s=await Mbe(e),{objects:r,opts:a}=s;if(r&&r.length>0){const o=new xm(r,{...a,...t,left:100,top:100});if(t.fill){const l=c=>{c.forEach(u=>{u.type==="group"?l(u._objects):u.set&&u.set("fill",t.fill)})};o._objects&&l(o._objects),o.set("fill",t.fill)}this.canvas.add(o),this.canvas.setActiveObject(o),this.canvas.requestRenderAll()}else $s.info("Loaded SVG but found no objects.")}catch(s){console.error("SVG Load Error",s),$s.error("Failed to load SVG: "+s.message)}}async addSVGString(e,t={}){try{const s=await sne(e),{objects:r,opts:a}=s;if(r&&r.length>0){const o=new xm(r,{...a,...t,left:100,top:100});if(t.fill){const l=c=>{c.forEach(u=>{u.type==="group"?l(u._objects):u.set&&(u.set("fill",t.fill),u.type==="path"&&u.set("stroke",t.fill))})};o._objects&&l(o._objects),o.set("fill",t.fill)}this.canvas.add(o),this.canvas.setActiveObject(o),this.canvas.requestRenderAll()}}catch(s){console.error("SVG String Load Error",s)}}}class PG{constructor(e){this.canvasManager=e}get canvas(){return this.canvasManager.canvas}applyImageFilter(e,t,s){if(!e||!e.filters)return;const a={brightness:"Brightness",contrast:"Contrast",blur:"Blur",sharpen:"Convolute",saturation:"Saturation",grayscale:"Grayscale",sepia:"Sepia",hue:"HueRotation",noise:"Noise",pixelate:"Pixelate",tint:"BlendColor"}[t];if(!a)return;let o=e.filters.find(l=>l.type===a);if(!o){const l=Vbe[a];if(l){let c={};t==="blur"?c={blur:s}:t==="pixelate"?c={blocksize:s}:t==="hue"?c={rotation:s}:t==="tint"?c={color:s,mode:"multiply",alpha:.5}:t==="sharpen"?c={matrix:[0,0,0,0,1,0,0,0,0]}:c[t]=s,o=new l(c),e.filters.push(o)}}if(o){let l=!1;if(t==="blur")o.blur=s,s===0&&(l=!0);else if(t==="pixelate")o.blocksize=s,s===0&&(l=!0);else if(t==="hue")o.rotation=s,s===0&&(l=!0);else if(t==="grayscale"||t==="sepia")s===0&&(l=!0);else if(t==="tint")o.color=s,(!s||s==="transparent"||s==="rgba(0,0,0,0)")&&(l=!0);else if(t==="noise")o.noise=s,s===0&&(l=!0);else if(t==="sharpen")if(s<=0)l=!0;else{const c=s;o.matrix=[0,-c,0,-c,1+4*c,-c,0,-c,0]}else o[t]=s,s===0&&(l=!0);if(l){const c=e.filters.indexOf(o);c>-1&&e.filters.splice(c,1)}}e.applyFilters(),this.canvas.requestRenderAll()}}class ZCe{constructor(e){this.canvasManager=e}get canvas(){return this.canvasManager.canvas}loadGoogleFont(e){if(!e||["Arial","Times New Roman","Courier New","Verdana","Georgia","Trebuchet MS","Impact","Noto Sans Lao Looped","Noto Serif Lao","Phetsarath OT","Noto Sans Lao"].some(a=>e.includes(a)))return;const s=e.replace(/['"]/g,"").split(",")[0].trim(),r="font-css-"+s.replace(/\s+/g,"-").toLowerCase();if(!document.getElementById(r)){const a=document.createElement("link");a.id=r,a.rel="stylesheet",a.href=`https://fonts.googleapis.com/css2?family=${s.replace(/\s+/g,"+")}:wght@400;700&display=swap`,document.head.appendChild(a),a.onload=()=>{this.canvas.requestRenderAll()}}}setTextStyle(e,t){const s=this.canvasManager.getActiveObject();s&&s.type==="i-text"&&(e==="fontFamily"&&this.loadGoogleFont(t),s.set(e,t),this.canvas.requestRenderAll())}toggleTextDecoration(e){const t=this.canvasManager.getActiveObject();if(t&&t.type==="i-text"){if(e==="fontWeight"){const s=t.fontWeight==="bold";t.set("fontWeight",s?"normal":"bold")}else if(e==="fontStyle"){const s=t.fontStyle==="italic";t.set("fontStyle",s?"normal":"italic")}else e==="underline"&&t.set("underline",!t.underline);this.canvas.requestRenderAll()}return t[e]}}var eSe=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,r){s.__proto__=r}||function(s,r){for(var a in r)r.hasOwnProperty(a)&&(s[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function s(){this.constructor=e}e.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}})(),tSe=Object.prototype.hasOwnProperty;function cR(n,e){return tSe.call(n,e)}function uR(n){if(Array.isArray(n)){for(var e=new Array(n.length),t=0;t<e.length;t++)e[t]=""+t;return e}if(Object.keys)return Object.keys(n);var s=[];for(var r in n)cR(n,r)&&s.push(r);return s}function dd(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function fR(n){for(var e=0,t=n.length,s;e<t;){if(s=n.charCodeAt(e),s>=48&&s<=57){e++;continue}return!1}return!0}function Ey(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function Yse(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function dR(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(var e=0,t=n.length;e<t;e++)if(dR(n[e]))return!0}else if(typeof n=="object"){for(var s=uR(n),r=s.length,a=0;a<r;a++)if(dR(n[s[a]]))return!0}}return!1}function $G(n,e){var t=[n];for(var s in e){var r=typeof e[s]=="object"?JSON.stringify(e[s],null,2):e[s];typeof r<"u"&&t.push(s+": "+r)}return t.join(`
`)}var Kse=(function(n){eSe(e,n);function e(t,s,r,a,o){var l=this.constructor,c=n.call(this,$G(t,{name:s,index:r,operation:a,tree:o}))||this;return c.name=s,c.index=r,c.operation=a,c.tree=o,Object.setPrototypeOf(c,l.prototype),c.message=$G(t,{name:s,index:r,operation:a,tree:o}),c}return e})(Error),No=Kse,nSe=dd,$v={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var s=n[e];return delete n[e],{newDocument:t,removed:s}},replace:function(n,e,t){var s=n[e];return n[e]=this.value,{newDocument:t,removed:s}},move:function(n,e,t){var s=bN(t,this.path);s&&(s=dd(s));var r=eb(t,{op:"remove",path:this.from}).removed;return eb(t,{op:"add",path:this.path,value:r}),{newDocument:t,removed:s}},copy:function(n,e,t){var s=bN(t,this.from);return eb(t,{op:"add",path:this.path,value:dd(s)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:EM(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}},sSe={add:function(n,e,t){return fR(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var s=n.splice(e,1);return{newDocument:t,removed:s[0]}},replace:function(n,e,t){var s=n[e];return n[e]=this.value,{newDocument:t,removed:s}},move:$v.move,copy:$v.copy,test:$v.test,_get:$v._get};function bN(n,e){if(e=="")return n;var t={op:"_get",path:e};return eb(n,t),t.value}function eb(n,e,t,s,r,a){if(t===void 0&&(t=!1),s===void 0&&(s=!0),r===void 0&&(r=!0),a===void 0&&(a=0),t&&(typeof t=="function"?t(e,0,n,e.path):wN(e,0)),e.path===""){var o={newDocument:n};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=n,o;if(e.op==="move"||e.op==="copy")return o.newDocument=bN(n,e.from),e.op==="move"&&(o.removed=n),o;if(e.op==="test"){if(o.test=EM(n,e.value),o.test===!1)throw new No("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return o.newDocument=n,o}else{if(e.op==="remove")return o.removed=n,o.newDocument=null,o;if(e.op==="_get")return e.value=n,o;if(t)throw new No("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,n);return o}}else{s||(n=dd(n));var l=e.path||"",c=l.split("/"),u=n,f=1,d=c.length,h=void 0,p=void 0,g=void 0;for(typeof t=="function"?g=t:g=wN;;){if(p=c[f],p&&p.indexOf("~")!=-1&&(p=Yse(p)),r&&(p=="__proto__"||p=="prototype"&&f>0&&c[f-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&h===void 0&&(u[p]===void 0?h=c.slice(0,f).join("/"):f==d-1&&(h=e.path),h!==void 0&&g(e,0,n,h)),f++,Array.isArray(u)){if(p==="-")p=u.length;else{if(t&&!fR(p))throw new No("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,n);fR(p)&&(p=~~p)}if(f>=d){if(t&&e.op==="add"&&p>u.length)throw new No("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,n);var o=sSe[e.op].call(e,u,p,n);if(o.test===!1)throw new No("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return o}}else if(f>=d){var o=$v[e.op].call(e,u,p,n);if(o.test===!1)throw new No("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return o}if(u=u[p],t&&f<d&&(!u||typeof u!="object"))throw new No("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,n)}}}function $4(n,e,t,s,r){if(s===void 0&&(s=!0),r===void 0&&(r=!0),t&&!Array.isArray(e))throw new No("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");s||(n=dd(n));for(var a=new Array(e.length),o=0,l=e.length;o<l;o++)a[o]=eb(n,e[o],t,!0,r,o),n=a[o].newDocument;return a.newDocument=n,a}function rSe(n,e,t){var s=eb(n,e);if(s.test===!1)throw new No("Test operation failed","TEST_OPERATION_FAILED",t,e,n);return s.newDocument}function wN(n,e,t,s){if(typeof n!="object"||n===null||Array.isArray(n))throw new No("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if($v[n.op]){if(typeof n.path!="string")throw new No("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new No('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new No("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new No("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&dR(n.value))throw new No("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var r=n.path.split("/").length,a=s.split("/").length;if(r!==a+1&&r!==a)throw new No("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==s)throw new No("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var o={op:"_get",path:n.from,value:void 0},l=Xse([o],t);if(l&&l.name==="OPERATION_PATH_UNRESOLVABLE")throw new No("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new No("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function Xse(n,e,t){try{if(!Array.isArray(n))throw new No("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)$4(dd(e),dd(n),t||!0);else{t=t||wN;for(var s=0;s<n.length;s++)t(n[s],s,e,void 0)}}catch(r){if(r instanceof No)return r;throw r}}function EM(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),s=Array.isArray(e),r,a,o;if(t&&s){if(a=n.length,a!=e.length)return!1;for(r=a;r--!==0;)if(!EM(n[r],e[r]))return!1;return!0}if(t!=s)return!1;var l=Object.keys(n);if(a=l.length,a!==Object.keys(e).length)return!1;for(r=a;r--!==0;)if(!e.hasOwnProperty(l[r]))return!1;for(r=a;r--!==0;)if(o=l[r],!EM(n[o],e[o]))return!1;return!0}return n!==n&&e!==e}const iSe=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:No,_areEquals:EM,applyOperation:eb,applyPatch:$4,applyReducer:rSe,deepClone:nSe,getValueByPointer:bN,validate:Xse,validator:wN},Symbol.toStringTag,{value:"Module"}));var HF=new WeakMap,aSe=(function(){function n(e){this.observers=new Map,this.obj=e}return n})(),oSe=(function(){function n(e,t){this.callback=e,this.observer=t}return n})();function lSe(n){return HF.get(n)}function cSe(n,e){return n.observers.get(e)}function uSe(n,e){n.observers.delete(e.callback)}function fSe(n,e){e.unobserve()}function dSe(n,e){var t=[],s,r=lSe(n);if(!r)r=new aSe(n),HF.set(n,r);else{var a=cSe(r,e);s=a&&a.observer}if(s)return s;if(s={},r.value=dd(n),e){s.callback=e,s.next=null;var o=function(){hR(s)},l=function(){clearTimeout(s.next),s.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",l),window.addEventListener("keyup",l),window.addEventListener("mousedown",l),window.addEventListener("keydown",l),window.addEventListener("change",l))}return s.patches=t,s.object=n,s.unobserve=function(){hR(s),clearTimeout(s.next),uSe(r,s),typeof window<"u"&&(window.removeEventListener("mouseup",l),window.removeEventListener("keyup",l),window.removeEventListener("mousedown",l),window.removeEventListener("keydown",l),window.removeEventListener("change",l))},r.observers.set(e,new oSe(e,s)),s}function hR(n,e){e===void 0&&(e=!1);var t=HF.get(n.object);qF(t.value,n.object,n.patches,"",e),n.patches.length&&$4(t.value,n.patches);var s=n.patches;return s.length>0&&(n.patches=[],n.callback&&n.callback(s)),s}function qF(n,e,t,s,r){if(e!==n){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=uR(e),o=uR(n),l=!1,c=o.length-1;c>=0;c--){var u=o[c],f=n[u];if(cR(e,u)&&!(e[u]===void 0&&f!==void 0&&Array.isArray(e)===!1)){var d=e[u];typeof f=="object"&&f!=null&&typeof d=="object"&&d!=null&&Array.isArray(f)===Array.isArray(d)?qF(f,d,t,s+"/"+Ey(u),r):f!==d&&(r&&t.push({op:"test",path:s+"/"+Ey(u),value:dd(f)}),t.push({op:"replace",path:s+"/"+Ey(u),value:dd(d)}))}else Array.isArray(n)===Array.isArray(e)?(r&&t.push({op:"test",path:s+"/"+Ey(u),value:dd(f)}),t.push({op:"remove",path:s+"/"+Ey(u)}),l=!0):(r&&t.push({op:"test",path:s,value:n}),t.push({op:"replace",path:s,value:e}))}if(!(!l&&a.length==o.length))for(var c=0;c<a.length;c++){var u=a[c];!cR(n,u)&&e[u]!==void 0&&t.push({op:"add",path:s+"/"+Ey(u),value:dd(e[u])})}}}function pR(n,e,t){t===void 0&&(t=!1);var s=[];return qF(n,e,s,"",t),s}const hSe=Object.freeze(Object.defineProperty({__proto__:null,compare:pR,generate:hR,observe:dSe,unobserve:fSe},Symbol.toStringTag,{value:"Module"}));Object.assign({},iSe,hSe,{JsonPatchError:Kse,deepClone:dd,escapePathComponent:Ey,unescapePathComponent:Yse});class pSe{constructor(e){this.cm=e,this.history=[],this.currentIndex=-1,this.locked=!1,this.maxDepth=50,this.saveState("Initial")}get canvas(){return this.cm.canvas}saveState(e=null){if(this.locked||!this.canvas)return;const t=this.cm.saveProject();if(this.currentIndex===-1)this.history=[{state:JSON.parse(JSON.stringify(t)),label:e||"Initial"}],this.currentIndex=0;else{const s=this.getFullState(this.currentIndex),r=pR(s,t);if(r.length===0)return;const a=pR(t,s);if(this.currentIndex<this.history.length-1&&(this.history=this.history.slice(0,this.currentIndex+1)),this.history.push({forward:r,backward:a,label:e||"Action"}),this.currentIndex++,this.history.length>this.maxDepth){this.history.shift(),this.currentIndex--;const o=this.getFullState(0);this.history[0]={state:o,label:this.history[0].label}}}this.notifyUpdate()}getFullState(e){if(e<0||e>=this.history.length)return null;let t=JSON.parse(JSON.stringify(this.history[0].state));for(let s=1;s<=e;s++)t=$4(t,this.history[s].forward).newDocument;return t}async undo(){if(this.currentIndex<=0)return;this.currentIndex--;const e=this.getFullState(this.currentIndex);await this.loadState(e),this.notifyUpdate()}async redo(){if(this.currentIndex>=this.history.length-1)return;this.currentIndex++;const e=this.getFullState(this.currentIndex);await this.loadState(e),this.notifyUpdate()}async loadState(e){this.locked=!0;try{await this.cm.loadProject(e)}catch(t){console.error("History Load Error:",t),$s.error("Failed to restore state")}finally{this.locked=!1}}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.history.length-1}notifyUpdate(){window.dispatchEvent(new CustomEvent("historyUpdate",{detail:{canUndo:this.canUndo(),canRedo:this.canRedo(),label:this.history[this.currentIndex]?.label||""}}))}}var y5={exports:{}},jG;function mSe(){return jG||(jG=1,(function(n){(function(){function e(){var t=this;this.versionnumber="1.2.6",this.imageToSVG=function(s,r,a){a=t.checkoptions(a),t.loadImage(s,function(o){r(t.imagedataToSVG(t.getImgdata(o),a))},a)},this.imagedataToSVG=function(s,r){r=t.checkoptions(r);var a=t.imagedataToTracedata(s,r);return t.getsvgstring(a,r)},this.imageToTracedata=function(s,r,a){a=t.checkoptions(a),t.loadImage(s,function(o){r(t.imagedataToTracedata(t.getImgdata(o),a))},a)},this.imagedataToTracedata=function(s,r){r=t.checkoptions(r);var a=t.colorquantization(s,r);if(r.layering===0)for(var o={layers:[],palette:a.palette,width:a.array[0].length-2,height:a.array.length-2},l=0;l<a.palette.length;l++){var c=t.batchtracepaths(t.internodes(t.pathscan(t.layeringstep(a,l),r.pathomit),r),r.ltres,r.qtres);o.layers.push(c)}else{var u=t.layering(a);r.layercontainerid&&t.drawLayers(u,t.specpalette,r.scale,r.layercontainerid);var f=t.batchpathscan(u,r.pathomit),d=t.batchinternodes(f,r),o={layers:t.batchtracelayers(d,r.ltres,r.qtres),palette:a.palette,width:s.width,height:s.height}}return o},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(s){s=s||{},typeof s=="string"&&(s=s.toLowerCase(),t.optionpresets[s]?s=t.optionpresets[s]:s={});for(var r=Object.keys(t.optionpresets.default),a=0;a<r.length;a++)s.hasOwnProperty(r[a])||(s[r[a]]=t.optionpresets.default[r[a]]);return s},this.colorquantization=function(s,r){var a=[],o=0,l,c,u,f=[],d=s.width*s.height,h,p,g,b,v;if(s.data.length<d*4){for(var w=new Uint8ClampedArray(d*4),x=0;x<d;x++)w[x*4]=s.data[x*3],w[x*4+1]=s.data[x*3+1],w[x*4+2]=s.data[x*3+2],w[x*4+3]=255;s.data=w}for(p=0;p<s.height+2;p++)for(a[p]=[],h=0;h<s.width+2;h++)a[p][h]=-1;for(r.pal?v=r.pal:r.colorsampling===0?v=t.generatepalette(r.numberofcolors):r.colorsampling===1?v=t.samplepalette(r.numberofcolors,s):v=t.samplepalette2(r.numberofcolors,s),r.blurradius>0&&(s=t.blur(s,r.blurradius,r.blurdelta)),b=0;b<r.colorquantcycles;b++){if(b>0)for(g=0;g<v.length;g++)f[g].n>0&&(v[g]={r:Math.floor(f[g].r/f[g].n),g:Math.floor(f[g].g/f[g].n),b:Math.floor(f[g].b/f[g].n),a:Math.floor(f[g].a/f[g].n)}),f[g].n/d<r.mincolorratio&&b<r.colorquantcycles-1&&(v[g]={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)});for(h=0;h<v.length;h++)f[h]={r:0,g:0,b:0,a:0,n:0};for(p=0;p<s.height;p++)for(h=0;h<s.width;h++){for(o=(p*s.width+h)*4,u=0,c=1024,g=0;g<v.length;g++)l=Math.abs(v[g].r-s.data[o])+Math.abs(v[g].g-s.data[o+1])+Math.abs(v[g].b-s.data[o+2])+Math.abs(v[g].a-s.data[o+3]),l<c&&(c=l,u=g);f[u].r+=s.data[o],f[u].g+=s.data[o+1],f[u].b+=s.data[o+2],f[u].a+=s.data[o+3],f[u].n++,a[p+1][h+1]=u}}return{array:a,palette:v}},this.samplepalette=function(s,r){for(var a,o=[],l=0;l<s;l++)a=Math.floor(Math.random()*r.data.length/4)*4,o.push({r:r.data[a],g:r.data[a+1],b:r.data[a+2],a:r.data[a+3]});return o},this.samplepalette2=function(s,r){for(var a,o=[],l=Math.ceil(Math.sqrt(s)),c=Math.ceil(s/l),u=r.width/(l+1),f=r.height/(c+1),d=0;d<c;d++)for(var h=0;h<l&&o.length!==s;h++)a=Math.floor((d+1)*f*r.width+(h+1)*u)*4,o.push({r:r.data[a],g:r.data[a+1],b:r.data[a+2],a:r.data[a+3]});return o},this.generatepalette=function(s){var r=[],a,o,l;if(s<8)for(var c=Math.floor(255/(s-1)),u=0;u<s;u++)r.push({r:u*c,g:u*c,b:u*c,a:255});else{var f=Math.floor(Math.pow(s,.3333333333333333)),d=Math.floor(255/(f-1)),h=s-f*f*f;for(a=0;a<f;a++)for(o=0;o<f;o++)for(l=0;l<f;l++)r.push({r:a*d,g:o*d,b:l*d,a:255});for(a=0;a<h;a++)r.push({r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)})}return r},this.layering=function(s){var r=[],a=0,o=s.array.length,l=s.array[0].length,c,u,f,d,h,p,g,b,v,w,x;for(x=0;x<s.palette.length;x++)for(r[x]=[],w=0;w<o;w++)for(r[x][w]=[],v=0;v<l;v++)r[x][w][v]=0;for(w=1;w<o-1;w++)for(v=1;v<l-1;v++)a=s.array[w][v],c=s.array[w-1][v-1]===a?1:0,u=s.array[w-1][v]===a?1:0,f=s.array[w-1][v+1]===a?1:0,d=s.array[w][v-1]===a?1:0,h=s.array[w][v+1]===a?1:0,p=s.array[w+1][v-1]===a?1:0,g=s.array[w+1][v]===a?1:0,b=s.array[w+1][v+1]===a?1:0,r[a][w+1][v+1]=1+h*2+b*4+g*8,d||(r[a][w+1][v]=2+g*4+p*8),u||(r[a][w][v+1]=0+f*2+h*4+8),c||(r[a][w][v]=0+u*2+4+d*8);return r},this.layeringstep=function(s,r){var a=[],o=s.array.length,l=s.array[0].length,c,u;for(u=0;u<o;u++)for(a[u]=[],c=0;c<l;c++)a[u][c]=0;for(u=1;u<o;u++)for(c=1;c<l;c++)a[u][c]=(s.array[u-1][c-1]===r?1:0)+(s.array[u-1][c]===r?2:0)+(s.array[u][c-1]===r?8:0)+(s.array[u][c]===r?4:0);return a},this.pointinpoly=function(s,r){for(var a=!1,o=0,l=r.length-1;o<r.length;l=o++)a=r[o].y>s.y!=r[l].y>s.y&&s.x<(r[l].x-r[o].x)*(s.y-r[o].y)/(r[l].y-r[o].y)+r[o].x?!a:a;return a},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(s,r){for(var a=[],o=0,l=0,c=0,u=0,f=s[0].length,d=s.length,h=0,p=!0,g=!1,b,v=0;v<d;v++)for(var w=0;w<f;w++)if(s[v][w]==4||s[v][w]==11)for(c=w,u=v,a[o]={},a[o].points=[],a[o].boundingbox=[c,u,c,u],a[o].holechildren=[],p=!1,l=0,g=s[v][w]==11,h=1;!p;){if(a[o].points[l]={},a[o].points[l].x=c-1,a[o].points[l].y=u-1,a[o].points[l].t=s[u][c],c-1<a[o].boundingbox[0]&&(a[o].boundingbox[0]=c-1),c-1>a[o].boundingbox[2]&&(a[o].boundingbox[2]=c-1),u-1<a[o].boundingbox[1]&&(a[o].boundingbox[1]=u-1),u-1>a[o].boundingbox[3]&&(a[o].boundingbox[3]=u-1),b=t.pathscan_combined_lookup[s[u][c]][h],s[u][c]=b[0],h=b[1],c+=b[2],u+=b[3],c-1===a[o].points[0].x&&u-1===a[o].points[0].y)if(p=!0,a[o].points.length<r)a.pop();else{if(a[o].isholepath=!!g,g){for(var x=0,S=[-1,-1,f+1,d+1],C=0;C<o;C++)!a[C].isholepath&&t.boundingboxincludes(a[C].boundingbox,a[o].boundingbox)&&t.boundingboxincludes(S,a[C].boundingbox)&&t.pointinpoly(a[o].points[0],a[C].points)&&(x=C,S=a[C].boundingbox);a[x].holechildren.push(o)}o++}l++}return a},this.boundingboxincludes=function(s,r){return s[0]<r[0]&&s[1]<r[1]&&s[2]>r[2]&&s[3]>r[3]},this.batchpathscan=function(s,r){var a=[];for(var o in s)s.hasOwnProperty(o)&&(a[o]=t.pathscan(s[o],r));return a},this.internodes=function(s,r){var a=[],o=0,l=0,c=0,u=0,f=0,d,h;for(d=0;d<s.length;d++)for(a[d]={},a[d].points=[],a[d].boundingbox=s[d].boundingbox,a[d].holechildren=s[d].holechildren,a[d].isholepath=s[d].isholepath,o=s[d].points.length,h=0;h<o;h++)l=(h+1)%o,c=(h+2)%o,u=(h-1+o)%o,f=(h-2+o)%o,r.rightangleenhance&&t.testrightangle(s[d],f,u,h,l,c)&&(a[d].points.length>0&&(a[d].points[a[d].points.length-1].linesegment=t.getdirection(a[d].points[a[d].points.length-1].x,a[d].points[a[d].points.length-1].y,s[d].points[h].x,s[d].points[h].y)),a[d].points.push({x:s[d].points[h].x,y:s[d].points[h].y,linesegment:t.getdirection(s[d].points[h].x,s[d].points[h].y,(s[d].points[h].x+s[d].points[l].x)/2,(s[d].points[h].y+s[d].points[l].y)/2)})),a[d].points.push({x:(s[d].points[h].x+s[d].points[l].x)/2,y:(s[d].points[h].y+s[d].points[l].y)/2,linesegment:t.getdirection((s[d].points[h].x+s[d].points[l].x)/2,(s[d].points[h].y+s[d].points[l].y)/2,(s[d].points[l].x+s[d].points[c].x)/2,(s[d].points[l].y+s[d].points[c].y)/2)});return a},this.testrightangle=function(s,r,a,o,l,c){return s.points[o].x===s.points[r].x&&s.points[o].x===s.points[a].x&&s.points[o].y===s.points[l].y&&s.points[o].y===s.points[c].y||s.points[o].y===s.points[r].y&&s.points[o].y===s.points[a].y&&s.points[o].x===s.points[l].x&&s.points[o].x===s.points[c].x},this.getdirection=function(s,r,a,o){var l=8;return s<a?r<o?l=1:r>o?l=7:l=0:s>a?r<o?l=3:r>o?l=5:l=4:r<o?l=2:r>o?l=6:l=8,l},this.batchinternodes=function(s,r){var a=[];for(var o in s)s.hasOwnProperty(o)&&(a[o]=t.internodes(s[o],r));return a},this.tracepath=function(s,r,a){var o=0,l,c,u,f={};for(f.segments=[],f.boundingbox=s.boundingbox,f.holechildren=s.holechildren,f.isholepath=s.isholepath;o<s.points.length;){for(l=s.points[o].linesegment,c=-1,u=o+1;(s.points[u].linesegment===l||s.points[u].linesegment===c||c===-1)&&u<s.points.length-1;)s.points[u].linesegment!==l&&c===-1&&(c=s.points[u].linesegment),u++;u===s.points.length-1&&(u=0),f.segments=f.segments.concat(t.fitseq(s,r,a,o,u)),u>0?o=u:o=s.points.length}return f},this.fitseq=function(s,r,a,o,l){if(l>s.points.length||l<0)return[];var c=o,u=0,f=!0,d,h,p,g=l-o;g<0&&(g+=s.points.length);for(var b=(s.points[l].x-s.points[o].x)/g,v=(s.points[l].y-s.points[o].y)/g,w=(o+1)%s.points.length,x;w!=l;)x=w-o,x<0&&(x+=s.points.length),d=s.points[o].x+b*x,h=s.points[o].y+v*x,p=(s.points[w].x-d)*(s.points[w].x-d)+(s.points[w].y-h)*(s.points[w].y-h),p>r&&(f=!1),p>u&&(c=w,u=p),w=(w+1)%s.points.length;if(f)return[{type:"L",x1:s.points[o].x,y1:s.points[o].y,x2:s.points[l].x,y2:s.points[l].y}];var S=c;f=!0,u=0;var C=(S-o)/g,M=(1-C)*(1-C),k=2*(1-C)*C,E=C*C,I=(M*s.points[o].x+E*s.points[l].x-s.points[S].x)/-k,A=(M*s.points[o].y+E*s.points[l].y-s.points[S].y)/-k;for(w=o+1;w!=l;)C=(w-o)/g,M=(1-C)*(1-C),k=2*(1-C)*C,E=C*C,d=M*s.points[o].x+k*I+E*s.points[l].x,h=M*s.points[o].y+k*A+E*s.points[l].y,p=(s.points[w].x-d)*(s.points[w].x-d)+(s.points[w].y-h)*(s.points[w].y-h),p>a&&(f=!1),p>u&&(c=w,u=p),w=(w+1)%s.points.length;if(f)return[{type:"Q",x1:s.points[o].x,y1:s.points[o].y,x2:I,y2:A,x3:s.points[l].x,y3:s.points[l].y}];var D=S;return t.fitseq(s,r,a,o,D).concat(t.fitseq(s,r,a,D,l))},this.batchtracepaths=function(s,r,a){var o=[];for(var l in s)s.hasOwnProperty(l)&&o.push(t.tracepath(s[l],r,a));return o},this.batchtracelayers=function(s,r,a){var o=[];for(var l in s)s.hasOwnProperty(l)&&(o[l]=t.batchtracepaths(s[l],r,a));return o},this.roundtodec=function(s,r){return+s.toFixed(r)},this.svgpathstring=function(s,r,a,o){var l=s.layers[r],c=l[a],u="",f;if(o.linefilter&&c.segments.length<3)return u;if(u="<path "+(o.desc?'desc="l '+r+" p "+a+'" ':"")+t.tosvgcolorstr(s.palette[r],o)+'d="',o.roundcoords===-1){for(u+="M "+c.segments[0].x1*o.scale+" "+c.segments[0].y1*o.scale+" ",f=0;f<c.segments.length;f++)u+=c.segments[f].type+" "+c.segments[f].x2*o.scale+" "+c.segments[f].y2*o.scale+" ",c.segments[f].hasOwnProperty("x3")&&(u+=c.segments[f].x3*o.scale+" "+c.segments[f].y3*o.scale+" ");u+="Z "}else{for(u+="M "+t.roundtodec(c.segments[0].x1*o.scale,o.roundcoords)+" "+t.roundtodec(c.segments[0].y1*o.scale,o.roundcoords)+" ",f=0;f<c.segments.length;f++)u+=c.segments[f].type+" "+t.roundtodec(c.segments[f].x2*o.scale,o.roundcoords)+" "+t.roundtodec(c.segments[f].y2*o.scale,o.roundcoords)+" ",c.segments[f].hasOwnProperty("x3")&&(u+=t.roundtodec(c.segments[f].x3*o.scale,o.roundcoords)+" "+t.roundtodec(c.segments[f].y3*o.scale,o.roundcoords)+" ");u+="Z "}for(var d=0;d<c.holechildren.length;d++){var h=l[c.holechildren[d]];if(o.roundcoords===-1)for(h.segments[h.segments.length-1].hasOwnProperty("x3")?u+="M "+h.segments[h.segments.length-1].x3*o.scale+" "+h.segments[h.segments.length-1].y3*o.scale+" ":u+="M "+h.segments[h.segments.length-1].x2*o.scale+" "+h.segments[h.segments.length-1].y2*o.scale+" ",f=h.segments.length-1;f>=0;f--)u+=h.segments[f].type+" ",h.segments[f].hasOwnProperty("x3")&&(u+=h.segments[f].x2*o.scale+" "+h.segments[f].y2*o.scale+" "),u+=h.segments[f].x1*o.scale+" "+h.segments[f].y1*o.scale+" ";else for(h.segments[h.segments.length-1].hasOwnProperty("x3")?u+="M "+t.roundtodec(h.segments[h.segments.length-1].x3*o.scale)+" "+t.roundtodec(h.segments[h.segments.length-1].y3*o.scale)+" ":u+="M "+t.roundtodec(h.segments[h.segments.length-1].x2*o.scale)+" "+t.roundtodec(h.segments[h.segments.length-1].y2*o.scale)+" ",f=h.segments.length-1;f>=0;f--)u+=h.segments[f].type+" ",h.segments[f].hasOwnProperty("x3")&&(u+=t.roundtodec(h.segments[f].x2*o.scale)+" "+t.roundtodec(h.segments[f].y2*o.scale)+" "),u+=t.roundtodec(h.segments[f].x1*o.scale)+" "+t.roundtodec(h.segments[f].y1*o.scale)+" ";u+="Z "}if(u+='" />',o.lcpr||o.qcpr){for(f=0;f<c.segments.length;f++)c.segments[f].hasOwnProperty("x3")&&o.qcpr&&(u+='<circle cx="'+c.segments[f].x2*o.scale+'" cy="'+c.segments[f].y2*o.scale+'" r="'+o.qcpr+'" fill="cyan" stroke-width="'+o.qcpr*.2+'" stroke="black" />',u+='<circle cx="'+c.segments[f].x3*o.scale+'" cy="'+c.segments[f].y3*o.scale+'" r="'+o.qcpr+'" fill="white" stroke-width="'+o.qcpr*.2+'" stroke="black" />',u+='<line x1="'+c.segments[f].x1*o.scale+'" y1="'+c.segments[f].y1*o.scale+'" x2="'+c.segments[f].x2*o.scale+'" y2="'+c.segments[f].y2*o.scale+'" stroke-width="'+o.qcpr*.2+'" stroke="cyan" />',u+='<line x1="'+c.segments[f].x2*o.scale+'" y1="'+c.segments[f].y2*o.scale+'" x2="'+c.segments[f].x3*o.scale+'" y2="'+c.segments[f].y3*o.scale+'" stroke-width="'+o.qcpr*.2+'" stroke="cyan" />'),!c.segments[f].hasOwnProperty("x3")&&o.lcpr&&(u+='<circle cx="'+c.segments[f].x2*o.scale+'" cy="'+c.segments[f].y2*o.scale+'" r="'+o.lcpr+'" fill="white" stroke-width="'+o.lcpr*.2+'" stroke="black" />');for(var d=0;d<c.holechildren.length;d++){var h=l[c.holechildren[d]];for(f=0;f<h.segments.length;f++)h.segments[f].hasOwnProperty("x3")&&o.qcpr&&(u+='<circle cx="'+h.segments[f].x2*o.scale+'" cy="'+h.segments[f].y2*o.scale+'" r="'+o.qcpr+'" fill="cyan" stroke-width="'+o.qcpr*.2+'" stroke="black" />',u+='<circle cx="'+h.segments[f].x3*o.scale+'" cy="'+h.segments[f].y3*o.scale+'" r="'+o.qcpr+'" fill="white" stroke-width="'+o.qcpr*.2+'" stroke="black" />',u+='<line x1="'+h.segments[f].x1*o.scale+'" y1="'+h.segments[f].y1*o.scale+'" x2="'+h.segments[f].x2*o.scale+'" y2="'+h.segments[f].y2*o.scale+'" stroke-width="'+o.qcpr*.2+'" stroke="cyan" />',u+='<line x1="'+h.segments[f].x2*o.scale+'" y1="'+h.segments[f].y2*o.scale+'" x2="'+h.segments[f].x3*o.scale+'" y2="'+h.segments[f].y3*o.scale+'" stroke-width="'+o.qcpr*.2+'" stroke="cyan" />'),!h.segments[f].hasOwnProperty("x3")&&o.lcpr&&(u+='<circle cx="'+h.segments[f].x2*o.scale+'" cy="'+h.segments[f].y2*o.scale+'" r="'+o.lcpr+'" fill="white" stroke-width="'+o.lcpr*.2+'" stroke="black" />')}}return u},this.getsvgstring=function(s,r){r=t.checkoptions(r);for(var a=s.width*r.scale,o=s.height*r.scale,l="<svg "+(r.viewbox?'viewBox="0 0 '+a+" "+o+'" ':'width="'+a+'" height="'+o+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+t.versionnumber+'" >',c=0;c<s.layers.length;c++)for(var u=0;u<s.layers[c].length;u++)s.layers[c][u].isholepath||(l+=t.svgpathstring(s,c,u,r));return l+="</svg>",l},this.compareNumbers=function(s,r){return s-r},this.torgbastr=function(s){return"rgba("+s.r+","+s.g+","+s.b+","+s.a+")"},this.tosvgcolorstr=function(s,r){return'fill="rgb('+s.r+","+s.g+","+s.b+')" stroke="rgb('+s.r+","+s.g+","+s.b+')" stroke-width="'+r.strokewidth+'" opacity="'+s.a/255+'" '},this.appendSVGString=function(s,r){var a;r?(a=document.getElementById(r),a||(a=document.createElement("div"),a.id=r,document.body.appendChild(a))):(a=document.createElement("div"),document.body.appendChild(a)),a.innerHTML+=s},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(s,r,a){var o,l,c,u,f,d,h,p,g,b,v={width:s.width,height:s.height,data:[]};if(r=Math.floor(r),r<1)return s;r>5&&(r=5),a=Math.abs(a),a>1024&&(a=1024);var w=t.gks[r-1];for(l=0;l<s.height;l++)for(o=0;o<s.width;o++){for(d=0,h=0,p=0,g=0,b=0,c=-r;c<r+1;c++)o+c>0&&o+c<s.width&&(f=(l*s.width+o+c)*4,d+=s.data[f]*w[c+r],h+=s.data[f+1]*w[c+r],p+=s.data[f+2]*w[c+r],g+=s.data[f+3]*w[c+r],b+=w[c+r]);f=(l*s.width+o)*4,v.data[f]=Math.floor(d/b),v.data[f+1]=Math.floor(h/b),v.data[f+2]=Math.floor(p/b),v.data[f+3]=Math.floor(g/b)}var x=new Uint8ClampedArray(v.data);for(l=0;l<s.height;l++)for(o=0;o<s.width;o++){for(d=0,h=0,p=0,g=0,b=0,c=-r;c<r+1;c++)l+c>0&&l+c<s.height&&(f=((l+c)*s.width+o)*4,d+=x[f]*w[c+r],h+=x[f+1]*w[c+r],p+=x[f+2]*w[c+r],g+=x[f+3]*w[c+r],b+=w[c+r]);f=(l*s.width+o)*4,v.data[f]=Math.floor(d/b),v.data[f+1]=Math.floor(h/b),v.data[f+2]=Math.floor(p/b),v.data[f+3]=Math.floor(g/b)}for(l=0;l<s.height;l++)for(o=0;o<s.width;o++)f=(l*s.width+o)*4,u=Math.abs(v.data[f]-s.data[f])+Math.abs(v.data[f+1]-s.data[f+1])+Math.abs(v.data[f+2]-s.data[f+2])+Math.abs(v.data[f+3]-s.data[f+3]),u>a&&(v.data[f]=s.data[f],v.data[f+1]=s.data[f+1],v.data[f+2]=s.data[f+2],v.data[f+3]=s.data[f+3]);return v},this.loadImage=function(s,r,a){var o=new Image;a&&a.corsenabled&&(o.crossOrigin="Anonymous"),o.onload=function(){var l=document.createElement("canvas");l.width=o.width,l.height=o.height;var c=l.getContext("2d");c.drawImage(o,0,0),r(l)},o.src=s},this.getImgdata=function(s){var r=s.getContext("2d");return r.getImageData(0,0,s.width,s.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(s,r,a,o){a=a||1;var l,c,u,f,d,h;o?(h=document.getElementById(o),h||(h=document.createElement("div"),h.id=o,document.body.appendChild(h))):(h=document.createElement("div"),document.body.appendChild(h));for(d in s)if(s.hasOwnProperty(d)){l=s[d][0].length,c=s[d].length;var p=document.createElement("canvas");p.width=l*a,p.height=c*a;var g=p.getContext("2d");for(f=0;f<c;f++)for(u=0;u<l;u++)g.fillStyle=t.torgbastr(r[s[d][f][u]%r.length]),g.fillRect(u*a,f*a,a,a);h.appendChild(p)}}}n.exports=new e})()})(y5)),y5.exports}var gSe=mSe();const ySe=k2(gSe),bSe={trace:async(n,e={})=>new Promise((t,s)=>{try{const r={ltres:1,qtres:1,pathomit:8,colorsampling:1,numberofcolors:16,mincolorratio:.02,colorquantcycles:3,scale:1,simplifyTolerance:0,roundcoords:1,lcpr:0,qcpr:0,desc:!1,viewbox:!0,...e};ySe.imageToSVG(n,a=>{a?t(a):s(new Error("Failed to generate SVG string"))},r)}catch(r){console.error("Vectorization failed:",r),s(r)}})};var TI=function(n,e){return n<e?-1:n>e?1:0},RG=function(n){return n.reduce(function(e,t){return e+t},0)},wSe=(function(){function n(t){this.colors=t}var e=n.prototype;return e.palette=function(){return this.colors},e.map=function(t){return t},n})(),vSe=(function(){function n(a,o,l){return(a<<10)+(o<<5)+l}function e(a){var o=[],l=!1;function c(){o.sort(a),l=!0}return{push:function(u){o.push(u),l=!1},peek:function(u){return l||c(),u===void 0&&(u=o.length-1),o[u]},pop:function(){return l||c(),o.pop()},size:function(){return o.length},map:function(u){return o.map(u)},debug:function(){return l||c(),o}}}function t(a,o,l,c,u,f,d){var h=this;h.r1=a,h.r2=o,h.g1=l,h.g2=c,h.b1=u,h.b2=f,h.histo=d}function s(){this.vboxes=new e(function(a,o){return TI(a.vbox.count()*a.vbox.volume(),o.vbox.count()*o.vbox.volume())})}function r(a,o){if(o.count()){var l=o.r2-o.r1+1,c=o.g2-o.g1+1,u=Math.max.apply(null,[l,c,o.b2-o.b1+1]);if(o.count()==1)return[o.copy()];var f,d,h,p,g=0,b=[],v=[];if(u==l)for(f=o.r1;f<=o.r2;f++){for(p=0,d=o.g1;d<=o.g2;d++)for(h=o.b1;h<=o.b2;h++)p+=a[n(f,d,h)]||0;b[f]=g+=p}else if(u==c)for(f=o.g1;f<=o.g2;f++){for(p=0,d=o.r1;d<=o.r2;d++)for(h=o.b1;h<=o.b2;h++)p+=a[n(d,f,h)]||0;b[f]=g+=p}else for(f=o.b1;f<=o.b2;f++){for(p=0,d=o.r1;d<=o.r2;d++)for(h=o.g1;h<=o.g2;h++)p+=a[n(d,h,f)]||0;b[f]=g+=p}return b.forEach(function(w,x){v[x]=g-w}),(function(w){var x,S,C,M,k,E=w+"1",I=w+"2",A=0;for(f=o[E];f<=o[I];f++)if(b[f]>g/2){for(C=o.copy(),M=o.copy(),k=(x=f-o[E])<=(S=o[I]-f)?Math.min(o[I]-1,~~(f+S/2)):Math.max(o[E],~~(f-1-x/2));!b[k];)k++;for(A=v[k];!A&&b[k-1];)A=v[--k];return C[I]=k,M[E]=C[I]+1,[C,M]}})(u==l?"r":u==c?"g":"b")}}return t.prototype={volume:function(a){var o=this;return o._volume&&!a||(o._volume=(o.r2-o.r1+1)*(o.g2-o.g1+1)*(o.b2-o.b1+1)),o._volume},count:function(a){var o=this,l=o.histo;if(!o._count_set||a){var c,u,f,d=0;for(c=o.r1;c<=o.r2;c++)for(u=o.g1;u<=o.g2;u++)for(f=o.b1;f<=o.b2;f++)d+=l[n(c,u,f)]||0;o._count=d,o._count_set=!0}return o._count},copy:function(){var a=this;return new t(a.r1,a.r2,a.g1,a.g2,a.b1,a.b2,a.histo)},avg:function(a){var o=this,l=o.histo;if(!o._avg||a){var c,u,f,d,h=0,p=0,g=0,b=0;if(o.r1===o.r2&&o.g1===o.g2&&o.b1===o.b2)o._avg=[o.r1<<3,o.g1<<3,o.b1<<3];else{for(u=o.r1;u<=o.r2;u++)for(f=o.g1;f<=o.g2;f++)for(d=o.b1;d<=o.b2;d++)h+=c=l[n(u,f,d)]||0,p+=c*(u+.5)*8,g+=c*(f+.5)*8,b+=c*(d+.5)*8;o._avg=h?[~~(p/h),~~(g/h),~~(b/h)]:[~~(8*(o.r1+o.r2+1)/2),~~(8*(o.g1+o.g2+1)/2),~~(8*(o.b1+o.b2+1)/2)]}}return o._avg},contains:function(a){var o=this,l=a[0]>>3;return gval=a[1]>>3,bval=a[2]>>3,l>=o.r1&&l<=o.r2&&gval>=o.g1&&gval<=o.g2&&bval>=o.b1&&bval<=o.b2}},s.prototype={push:function(a){this.vboxes.push({vbox:a,color:a.avg()})},palette:function(){return this.vboxes.map(function(a){return a.color})},size:function(){return this.vboxes.size()},map:function(a){for(var o=this.vboxes,l=0;l<o.size();l++)if(o.peek(l).vbox.contains(a))return o.peek(l).color;return this.nearest(a)},nearest:function(a){for(var o,l,c,u=this.vboxes,f=0;f<u.size();f++)((l=Math.sqrt(Math.pow(a[0]-u.peek(f).color[0],2)+Math.pow(a[1]-u.peek(f).color[1],2)+Math.pow(a[2]-u.peek(f).color[2],2)))<o||o===void 0)&&(o=l,c=u.peek(f).color);return c},forcebw:function(){var a=this.vboxes;a.sort(function(u,f){return TI(RG(u.color),RG(f.color))});var o=a[0].color;o[0]<5&&o[1]<5&&o[2]<5&&(a[0].color=[0,0,0]);var l=a.length-1,c=a[l].color;c[0]>251&&c[1]>251&&c[2]>251&&(a[l].color=[255,255,255])}},{quantize:function(a,o){if(!Number.isInteger(o)||o<1||o>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!a.length||o<2||o>256||!a.length||o<2||o>256)return!1;for(var l=[],c=new Set,u=0;u<a.length;u++){var f=a[u],d=f.join(",");c.has(d)||(c.add(d),l.push(f))}if(l.length<=o)return new wSe(l);var h=(function(x){var S,C=new Array(32768);return x.forEach(function(M){S=n(M[0]>>3,M[1]>>3,M[2]>>3),C[S]=(C[S]||0)+1}),C})(a);h.forEach(function(){});var p=(function(x,S){var C,M,k,E=1e6,I=0,A=1e6,D=0,L=1e6,P=0;return x.forEach(function(j){(C=j[0]>>3)<E?E=C:C>I&&(I=C),(M=j[1]>>3)<A?A=M:M>D&&(D=M),(k=j[2]>>3)<L?L=k:k>P&&(P=k)}),new t(E,I,A,D,L,P,S)})(a,h),g=new e(function(x,S){return TI(x.count(),S.count())});function b(x,S){for(var C,M=x.size(),k=0;k<1e3;){if(M>=S||k++>1e3)return;if((C=x.pop()).count()){var E=r(h,C),I=E[0],A=E[1];if(!I)return;x.push(I),A&&(x.push(A),M++)}else x.push(C),k++}}g.push(p),b(g,.75*o);for(var v=new e(function(x,S){return TI(x.count()*x.volume(),S.count()*S.volume())});g.size();)v.push(g.pop());b(v,o);for(var w=new s;v.size();)w.push(v.pop());return w}}})().quantize,Qse=function(n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=n.naturalWidth,this.height=this.canvas.height=n.naturalHeight,this.context.drawImage(n,0,0,this.width,this.height)};Qse.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var kv=function(){};kv.prototype.getColor=function(n,e){return e===void 0&&(e=10),this.getPalette(n,5,e)[0]},kv.prototype.getPalette=function(n,e,t){var s=(function(l){var c=l.colorCount,u=l.quality;if(c!==void 0&&Number.isInteger(c)){if(c===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");c=Math.max(c,2),c=Math.min(c,20)}else c=10;return(u===void 0||!Number.isInteger(u)||u<1)&&(u=10),{colorCount:c,quality:u}})({colorCount:e,quality:t}),r=new Qse(n),a=(function(l,c,u){for(var f,d,h,p,g,b=l,v=[],w=0;w<c;w+=u)d=b[0+(f=4*w)],h=b[f+1],p=b[f+2],((g=b[f+3])===void 0||g>=125)&&(d>250&&h>250&&p>250||v.push([d,h,p]));return v})(r.getImageData().data,r.width*r.height,s.quality),o=vSe(a,s.colorCount);return o?o.palette():null},kv.prototype.getColorFromUrl=function(n,e,t){var s=this,r=document.createElement("img");r.addEventListener("load",function(){var a=s.getPalette(r,5,t);e(a[0],n)}),r.src=n},kv.prototype.getImageData=function(n,e){var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="arraybuffer",t.onload=function(){if(this.status==200){var s=new Uint8Array(this.response);i=s.length;for(var r=new Array(i),a=0;a<s.length;a++)r[a]=String.fromCharCode(s[a]);var o=r.join(""),l=window.btoa(o);e("data:image/png;base64,"+l)}},t.send()},kv.prototype.getColorAsync=function(n,e,t){var s=this;this.getImageData(n,function(r){var a=document.createElement("img");a.addEventListener("load",function(){var o=s.getPalette(a,5,t);e(o[0],this)}),a.src=r})};const mR={extractColors:async(n,e=6)=>new Promise((t,s)=>{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{try{const a=new kv,o=a.getColor(r),l=a.getPalette(r,e),c=mR.rgbToHex(o[0],o[1],o[2]),u=l.map(f=>mR.rgbToHex(f[0],f[1],f[2]));t({dominant:c,palette:u})}catch(a){console.error("Color extraction failed:",a),s(a)}},r.onerror=a=>{console.error("Failed to load image for color extraction:",a),s(a)},r.src=typeof n=="string"?n:n.src}),rgbToHex:(n,e,t)=>{const s=r=>{const a=r.toString(16);return a.length===1?"0"+a:a};return"#"+s(n)+s(e)+s(t)}},_Se=({scale:n,name:e,version:t,meta:{architecture:s,...r},path:a})=>({scale:n,modelType:"layers",_internals:{path:a,name:e,version:t},meta:{architecture:s,...r},inputRange:[0,255],outputRange:[0,255]}),xSe="@upscalerjs/default-model",CSe="1.0.0-beta.17",SSe=2,MSe=_Se({scale:SSe,name:xSe,version:CSe,path:"models/model.json",meta:{C:1,D:2,G:4,G0:64,T:10,architecture:"rdn",patchSize:128,size:"slim",artifactReducing:!1,sharpening:!1,dataset:"div2k",modelFileName:"rdn-C1-D2-G4-G064-T10-x2-patchsize128-compress100-sharpen0-datadiv2k-vary_cFalse_best-val_loss_epoch494"}});const TSe=1e-7,kSe=1e-4;class YF{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class j4{refCount(e){return yf("refCount")}incRef(e){return yf("incRef")}timerAvailable(){return!0}time(e){return yf("time")}read(e){return yf("read")}readSync(e){return yf("readSync")}readToGPU(e,t){return yf("readToGPU")}numDataIds(){return yf("numDataIds")}disposeData(e,t){return yf("disposeData")}write(e,t,s){return yf("write")}move(e,t,s,r,a){return yf("move")}createTensorFromGPUData(e,t,s){return yf("createTensorFromGPUData")}memory(){return yf("memory")}floatPrecision(){return yf("floatPrecision")}epsilon(){return this.floatPrecision()===32?TSe:kSe}dispose(){return yf("dispose")}}function yf(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function KF(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,Sg(n,e,t)}function ESe(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,s=0;for(;t>0;)s=Math.random()*t|0,t--,Sg(n,t,s),Sg(e,t,s)}function u1(n,e,t){return Math.max(n,Math.min(e,t))}function R4(n){return n%2===0?n:n+1}function Sg(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function Jse(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function ISe(n,e){const t=Math.random();return e*t+(1-t)*n}function ASe(n,e){let t=0;for(let s=0;s<n.length;s++){const r=Number(n[s])-Number(e[s]);t+=r*r}return t}function we(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function mc(n,e,t=""){we(xr(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Gb(n){we(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ot(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function LSe(n){return n.length===0}function Zse(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==null&&e[t]!==null&&n[t]!==e[t])return!1;return!0}function xr(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function pb(n){return n%1===0}function NSe(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function vN(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function DSe(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return KF(e),e}function tb(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function gR(n,e=r=>0,t,s){return new Promise((r,a)=>{let o=0;const l=()=>{if(n()){r();return}o++;const c=e(o);if(t!=null&&o>=t){a();return}s!=null?s(l,c):setTimeout(l,c)};l()})}function XF(n,e){let t=1,s=-1;for(let a=0;a<n.length;++a)if(n[a]>=0)t*=n[a];else if(n[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(n[a]<0)throw Error(`Shapes can not be < 0. Found ${n[a]} at dim ${a}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function dr(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),we(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),we(n.every(s=>pb(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function Vg(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||r?null:dr(e,n).sort();let o=0;for(let l=0;l<n.length;++l){if(a!=null){if(a[o]===l&&n[l]!==1)throw new Error(`Can't squeeze axis ${l} since its dim '${n[l]}' is not 1`);(a[o]==null||a[o]>l)&&n[l]===1&&(t.push(n[l]),s.push(l)),a[o]<=l&&o++}n[l]!==1&&(t.push(n[l]),s.push(l))}return{newShape:t,keptDims:s}}function Bl(n,e){return po(n,e)}function po(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function ere(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function tre(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function QF(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function IM(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function nre(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function wm(n){return typeof n=="string"||n instanceof String}function sre(n){return typeof n=="boolean"}function _N(n){return typeof n=="number"}function Hb(n){return Array.isArray(n)?Hb(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":_N(n)?"float32":wm(n)?"string":sre(n)?"bool":"float32"}function f1(n){return!!(n&&n.constructor&&n.call&&n.apply)}function xN(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function gs(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function rre(n,e,t,s=!1){const r=new Array;if(e.length===1){const a=e[0]*(s?2:1);for(let o=0;o<a;o++)r[o]=t[n+o]}else{const a=e[0],o=e.slice(1),l=o.reduce((c,u)=>c*u)*(s?2:1);for(let c=0;c<a;c++)r[c]=rre(n+c*l,o,t,s)}return r}function yd(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,a)=>r*a)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return rre(0,n,e,t)}function ire(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function F4(n,e){const t=hc(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function hc(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function JF(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return yd(n,new Float32Array(t));if(e==="int32")return yd(n,new Int32Array(t));if(e==="bool")return yd(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Df(n){n.forEach(e=>{we(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function op(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function qb(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function Dg(n){return n&&n.then&&typeof n.then=="function"}const FG="tfjsflags";class are{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=OSe,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(bt().getBool("IS_TEST")||bt().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];bt().getBool("IS_TEST")||bt().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Dg(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);FG in e&&e[FG].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=$Se(r,a)})}}function OSe(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(PSe(e,s[0],s[1]),s.join("="))),e}function PSe(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function $Se(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function bt(){return ZF}let ZF=null;function jSe(n){ZF=n}let b5;function ore(){if(b5==null){let n;if(typeof window<"u")n=window;else if(typeof window<"u")n=window;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");b5=n}return b5}function RSe(){const n=ore();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function ez(n,e){const t=RSe();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const ST="Abs",z2="Acos",B2="Acosh",Yb="Add",MT="AddN",z4="All",B4="Any",TT="ArgMax",kT="ArgMin",U2="Asin",V2="Asinh",W2="Atan",G2="Atanh",H2="Atan2",ET="AvgPool",U4="AvgPoolGrad",IT="AvgPool3D",V4="AvgPool3DGrad",AT="BatchMatMul",LT="BatchToSpaceND",W4="Bincount",NT="BitwiseAnd",lre="BroadcastTo",G4="BroadcastArgs",q2="Cast",Y2="Ceil",K2="ClipByValue",H4="Complex",DT="ComplexAbs",OT="Concat",PT="Conv2D",q4="Conv2DBackpropFilter",$T="Conv2DBackpropInput",jT="Conv3D",Y4="Conv3DBackpropFilterV2",K4="Conv3DBackpropInputV2",X2="Cos",Q2="Cosh",X4="Cumprod",RT="Cumsum",Q4="CropAndResize",J4="DenseBincount",Z4="DepthToSpace",FT="DepthwiseConv2dNative",eD="DepthwiseConv2dNativeBackpropFilter",tD="DepthwiseConv2dNativeBackpropInput",nD="Diag",zT="Dilation2D",CN="Dilation2DBackpropInput",SN="Dilation2DBackpropFilter",sD="Draw",J2="RealDiv",rD="Einsum",Z2="Elu",iD="EluGrad",e_="Erf",BT="Equal",t_="Exp",UT="ExpandDims",n_="Expm1",aD="FFT",oD="Fill",lD="FlipLeftRight",s_="Floor",r_="FloorDiv",VT="FusedBatchNorm",WT="GatherV2",cD="GatherNd",GT="Greater",i_="GreaterEqual",a_="Identity",uD="IFFT",fD="Imag",o_="IsFinite",l_="IsInf",c_="IsNan",HT="LeakyRelu",qT="Less",YT="LessEqual",dD="LinSpace",u_="Log",f_="Log1p",KT="LogicalAnd",XT="LogicalNot",QT="LogicalOr",FSe="LogicalXor",cre="LogSoftmax",zSe="LowerBound",JT="LRN",hD="LRNGrad",BSe="MatrixBandPart",ZT="Max",d_="Maximum",ek="MaxPool",pD="MaxPoolGrad",tk="MaxPool3D",mD="MaxPool3DGrad",gD="MaxPoolWithArgmax",nk="Mean",sk="Min",h_="Minimum",rk="MirrorPad",p_="Mod",yD="Multinomial",m_="Multiply",ik="Neg",ak="NotEqual",bD="NonMaxSuppressionV3",wD="NonMaxSuppressionV4",vD="NonMaxSuppressionV5",ok="OnesLike",lk="OneHot",ck="Pack",uk="PadV2",USe="Pool",g_="Pow",fk="Prelu",dk="Prod",_D="RaggedGather",xD="RaggedRange",CD="RaggedTensorToTensor",SD="Range",MD="Real",y_="Reciprocal",b_="Relu",hk="Reshape",pk="ResizeNearestNeighbor",TD="ResizeNearestNeighborGrad",mk="ResizeBilinear",kD="ResizeBilinearGrad",w_="Relu6",gk="Reverse",v_="Round",__="Rsqrt",ED="ScatterNd",ID="TensorScatterUpdate",AD="SearchSorted",yk="Select",x_="Selu",bk="Slice",C_="Sin",S_="Sinh",M_="Sign",T_="Sigmoid",k_="Softplus",E_="Sqrt",wk="Sum",vk="SpaceToBatchND",_k="SplitV",xk="Softmax",LD="SparseFillEmptyRows",ND="SparseReshape",DD="SparseSegmentMean",OD="SparseSegmentSum",PD="SparseToDense",I_="SquaredDifference",$D="Square",Ck="StaticRegexReplace",jD="StridedSlice",RD="StringNGrams",FD="StringSplit",zD="StringToHashBucketFast",A_="Sub",L_="Tan",N_="Tanh",D_="Tile",BD="TopK",UD="Transform",nb="Transpose",VD="Unique",Sk="Unpack",Mk="UnsortedSegmentSum",VSe="UpperBound",Tk="ZerosLike",O_="Step",MN="FromPixels",WD="RotateWithOffset",AM="_FusedMatMul",LM="FusedConv2D",NM="FusedDepthwiseConv2D";function cd(...n){bt().getBool("IS_TEST")||bt().getBool("PROD")||console.warn(...n)}function WSe(...n){bt().getBool("IS_TEST")||bt().getBool("PROD")||console.log(...n)}const a2=ez("kernelRegistry",()=>new Map),DM=ez("gradRegistry",()=>new Map);function OM(n,e){const t=tz(n,e);return a2.get(t)}function yR(n){return DM.get(n)}function TN(n){const e=a2.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[a,o]=r,[l]=a.split("_");l===n&&t.push(o)}return t}function GD(n){const{kernelName:e,backendName:t}=n,s=tz(e,t);a2.has(s)&&cd(`The kernel '${e}' for backend '${t}' is already registered`),a2.set(s,n)}function ure(n){const{kernelName:e}=n;DM.has(e)&&bt().getBool("DEBUG")&&cd(`Overriding the gradient for '${e}'`),DM.set(e,n)}function GSe(n,e){const t=tz(n,e);if(!a2.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);a2.delete(t)}function HSe(n){if(!DM.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);DM.delete(n)}function qSe(n,e){TN(n).forEach(s=>{const r=Object.assign({},s,{backendName:e});GD(r)})}function tz(n,e){return`${e}_${n}`}function fre(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var w5,zG;function YSe(){if(zG)return w5;zG=1,w5=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(D,L,P){this.low=D|0,this.high=L|0,this.unsigned=!!P}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(D){return(D&&D.__isLong__)===!0}e.isLong=t;var s={},r={};function a(D,L){var P,j,G;return L?(D>>>=0,(G=0<=D&&D<256)&&(j=r[D],j)?j:(P=l(D,(D|0)<0?-1:0,!0),G&&(r[D]=P),P)):(D|=0,(G=-128<=D&&D<128)&&(j=s[D],j)?j:(P=l(D,D<0?-1:0,!1),G&&(s[D]=P),P))}e.fromInt=a;function o(D,L){if(isNaN(D))return L?x:w;if(L){if(D<0)return x;if(D>=g)return E}else{if(D<=-b)return I;if(D+1>=b)return k}return D<0?o(-D,L).neg():l(D%p|0,D/p|0,L)}e.fromNumber=o;function l(D,L,P){return new e(D,L,P)}e.fromBits=l;var c=Math.pow;function u(D,L,P){if(D.length===0)throw Error("empty string");if(D==="NaN"||D==="Infinity"||D==="+Infinity"||D==="-Infinity")return w;if(typeof L=="number"?(P=L,L=!1):L=!!L,P=P||10,P<2||36<P)throw RangeError("radix");var j;if((j=D.indexOf("-"))>0)throw Error("interior hyphen");if(j===0)return u(D.substring(1),L,P).neg();for(var G=o(c(P,8)),Q=w,q=0;q<D.length;q+=8){var te=Math.min(8,D.length-q),Z=parseInt(D.substring(q,q+te),P);if(te<8){var ne=o(c(P,te));Q=Q.mul(ne).add(o(Z))}else Q=Q.mul(G),Q=Q.add(o(Z))}return Q.unsigned=L,Q}e.fromString=u;function f(D,L){return typeof D=="number"?o(D,L):typeof D=="string"?u(D,L):l(D.low,D.high,typeof L=="boolean"?L:D.unsigned)}e.fromValue=f;var d=65536,h=1<<24,p=d*d,g=p*p,b=g/2,v=a(h),w=a(0);e.ZERO=w;var x=a(0,!0);e.UZERO=x;var S=a(1);e.ONE=S;var C=a(1,!0);e.UONE=C;var M=a(-1);e.NEG_ONE=M;var k=l(-1,2147483647,!1);e.MAX_VALUE=k;var E=l(-1,-1,!0);e.MAX_UNSIGNED_VALUE=E;var I=l(0,-2147483648,!1);e.MIN_VALUE=I;var A=e.prototype;return A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},A.toString=function(L){if(L=L||10,L<2||36<L)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(I)){var P=o(L),j=this.div(P),G=j.mul(P).sub(this);return j.toString(L)+G.toInt().toString(L)}else return"-"+this.neg().toString(L);for(var Q=o(c(L,6),this.unsigned),q=this,te="";;){var Z=q.div(Q),ne=q.sub(Z.mul(Q)).toInt()>>>0,le=ne.toString(L);if(q=Z,q.isZero())return le+te;for(;le.length<6;)le="0"+le;te=""+le+te}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var L=this.high!=0?this.high:this.low,P=31;P>0&&(L&1<<P)==0;P--);return this.high!=0?P+33:P+1},A.isZero=function(){return this.high===0&&this.low===0},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return(this.low&1)===1},A.isEven=function(){return(this.low&1)===0},A.equals=function(L){return t(L)||(L=f(L)),this.unsigned!==L.unsigned&&this.high>>>31===1&&L.high>>>31===1?!1:this.high===L.high&&this.low===L.low},A.eq=A.equals,A.notEquals=function(L){return!this.eq(L)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(L){return this.comp(L)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(L){return this.comp(L)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(L){return this.comp(L)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(L){return this.comp(L)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(L){if(t(L)||(L=f(L)),this.eq(L))return 0;var P=this.isNegative(),j=L.isNegative();return P&&!j?-1:!P&&j?1:this.unsigned?L.high>>>0>this.high>>>0||L.high===this.high&&L.low>>>0>this.low>>>0?-1:1:this.sub(L).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(S)},A.neg=A.negate,A.add=function(L){t(L)||(L=f(L));var P=this.high>>>16,j=this.high&65535,G=this.low>>>16,Q=this.low&65535,q=L.high>>>16,te=L.high&65535,Z=L.low>>>16,ne=L.low&65535,le=0,H=0,R=0,B=0;return B+=Q+ne,R+=B>>>16,B&=65535,R+=G+Z,H+=R>>>16,R&=65535,H+=j+te,le+=H>>>16,H&=65535,le+=P+q,le&=65535,l(R<<16|B,le<<16|H,this.unsigned)},A.subtract=function(L){return t(L)||(L=f(L)),this.add(L.neg())},A.sub=A.subtract,A.multiply=function(L){if(this.isZero())return w;if(t(L)||(L=f(L)),n){var P=n.mul(this.low,this.high,L.low,L.high);return l(P,n.get_high(),this.unsigned)}if(L.isZero())return w;if(this.eq(I))return L.isOdd()?I:w;if(L.eq(I))return this.isOdd()?I:w;if(this.isNegative())return L.isNegative()?this.neg().mul(L.neg()):this.neg().mul(L).neg();if(L.isNegative())return this.mul(L.neg()).neg();if(this.lt(v)&&L.lt(v))return o(this.toNumber()*L.toNumber(),this.unsigned);var j=this.high>>>16,G=this.high&65535,Q=this.low>>>16,q=this.low&65535,te=L.high>>>16,Z=L.high&65535,ne=L.low>>>16,le=L.low&65535,H=0,R=0,B=0,W=0;return W+=q*le,B+=W>>>16,W&=65535,B+=Q*le,R+=B>>>16,B&=65535,B+=q*ne,R+=B>>>16,B&=65535,R+=G*le,H+=R>>>16,R&=65535,R+=Q*ne,H+=R>>>16,R&=65535,R+=q*Z,H+=R>>>16,R&=65535,H+=j*le+G*ne+Q*Z+q*te,H&=65535,l(B<<16|W,H<<16|R,this.unsigned)},A.mul=A.multiply,A.divide=function(L){if(t(L)||(L=f(L)),L.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&L.low===-1&&L.high===-1)return this;var P=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,L.low,L.high);return l(P,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:w;var j,G,Q;if(this.unsigned){if(L.unsigned||(L=L.toUnsigned()),L.gt(this))return x;if(L.gt(this.shru(1)))return C;Q=x}else{if(this.eq(I)){if(L.eq(S)||L.eq(M))return I;if(L.eq(I))return S;var q=this.shr(1);return j=q.div(L).shl(1),j.eq(w)?L.isNegative()?S:M:(G=this.sub(L.mul(j)),Q=j.add(G.div(L)),Q)}else if(L.eq(I))return this.unsigned?x:w;if(this.isNegative())return L.isNegative()?this.neg().div(L.neg()):this.neg().div(L).neg();if(L.isNegative())return this.div(L.neg()).neg();Q=w}for(G=this;G.gte(L);){j=Math.max(1,Math.floor(G.toNumber()/L.toNumber()));for(var te=Math.ceil(Math.log(j)/Math.LN2),Z=te<=48?1:c(2,te-48),ne=o(j),le=ne.mul(L);le.isNegative()||le.gt(G);)j-=Z,ne=o(j,this.unsigned),le=ne.mul(L);ne.isZero()&&(ne=S),Q=Q.add(ne),G=G.sub(le)}return Q},A.div=A.divide,A.modulo=function(L){if(t(L)||(L=f(L)),n){var P=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,L.low,L.high);return l(P,n.get_high(),this.unsigned)}return this.sub(this.div(L).mul(L))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return l(~this.low,~this.high,this.unsigned)},A.and=function(L){return t(L)||(L=f(L)),l(this.low&L.low,this.high&L.high,this.unsigned)},A.or=function(L){return t(L)||(L=f(L)),l(this.low|L.low,this.high|L.high,this.unsigned)},A.xor=function(L){return t(L)||(L=f(L)),l(this.low^L.low,this.high^L.high,this.unsigned)},A.shiftLeft=function(L){return t(L)&&(L=L.toInt()),(L&=63)===0?this:L<32?l(this.low<<L,this.high<<L|this.low>>>32-L,this.unsigned):l(0,this.low<<L-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(L){return t(L)&&(L=L.toInt()),(L&=63)===0?this:L<32?l(this.low>>>L|this.high<<32-L,this.high>>L,this.unsigned):l(this.high>>L-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(L){if(t(L)&&(L=L.toInt()),L&=63,L===0)return this;var P=this.high;if(L<32){var j=this.low;return l(j>>>L|P<<32-L,P>>>L,this.unsigned)}else return L===32?l(P,0,this.unsigned):l(P>>>L-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},A.toBytes=function(L){return L?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var L=this.high,P=this.low;return[P&255,P>>>8&255,P>>>16&255,P>>>24,L&255,L>>>8&255,L>>>16&255,L>>>24]},A.toBytesBE=function(){var L=this.high,P=this.low;return[L>>>24,L>>>16&255,L>>>8&255,L&255,P>>>24,P>>>16&255,P>>>8&255,P&255]},e.fromBytes=function(L,P,j){return j?e.fromBytesLE(L,P):e.fromBytesBE(L,P)},e.fromBytesLE=function(L,P){return new e(L[0]|L[1]<<8|L[2]<<16|L[3]<<24,L[4]|L[5]<<8|L[6]<<16|L[7]<<24,P)},e.fromBytesBE=function(L,P){return new e(L[4]<<24|L[5]<<16|L[6]<<8|L[7],L[0]<<24|L[1]<<16|L[2]<<8|L[3],P)},w5}var dre=YSe();const hre=k2(dre),KSe=K0e({__proto__:null,default:hre},[dre]);const jy=hre||KSe;function kk(n){return jy.fromString(n,!0,16)}const pre=kk("c3a5c85c97cb3127"),Iy=kk("b492b66fbe98f273"),pu=kk("9ae16a3b2f90404f");function bR(n){return n.xor(n.shru(47))}function mre(n,e,t){const s=n.slice(e,e+t);return jy.fromBytes(Array.from(s),!0,!0)}function ma(n,e){return mre(n,e,8)}function BG(n,e){return mre(n,e,4)}function Pl(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function n1(n,e,t=kk("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function XSe(n,e,t,s,r,a){r=r.add(n),a=Pl(a.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(t),a=a.add(Pl(r,44)),[r.add(s),a.add(o)]}function kI(n,e,t,s){return XSe(ma(n,e),ma(n,e+8),ma(n,e+16),ma(n,e+24),t,s)}function QSe(n,e=n.length){if(e>=8){const t=pu.add(e*2),s=ma(n,0).add(pu),r=ma(n,e-8),a=Pl(r,37).mul(t).add(s),o=Pl(s,25).add(r).mul(t);return n1(a,o,t)}if(e>=4){const t=pu.add(e*2),s=BG(n,0);return n1(s.shl(3).add(e),BG(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],a=t+(s<<8),o=e+(r<<2);return bR(pu.mul(a).xor(pre.mul(o))).mul(pu)}return pu}function JSe(n,e=n.length){const t=pu.add(e*2),s=ma(n,0).mul(Iy),r=ma(n,8),a=ma(n,e-8).mul(t),o=ma(n,e-16).mul(pu);return n1(Pl(s.add(r),43).add(Pl(a,30)).add(o),s.add(Pl(r.add(pu),18)).add(a),t)}function ZSe(n,e=n.length){const t=pu.add(e*2),s=ma(n,0).mul(pu),r=ma(n,8),a=ma(n,e-8).mul(t),o=ma(n,e-16).mul(pu),l=Pl(s.add(r),43).add(Pl(a,30)).add(o),c=n1(l,s.add(Pl(r.add(pu),18)).add(a),t),u=ma(n,16).mul(t),f=ma(n,24),d=l.add(ma(n,e-32)).mul(t),h=c.add(ma(n,e-24)).mul(t);return n1(Pl(u.add(f),43).add(Pl(d,30)).add(h),u.add(Pl(f.add(s),18)).add(d),t)}function gre(n,e=n.length){const t=jy.fromNumber(81,!0);if(e<=32)return e<=16?QSe(n,e):JSe(n,e);if(e<=64)return ZSe(n,e);let s=t,r=t.mul(Iy).add(113),a=bR(r.mul(pu).add(113)).mul(pu),o=[jy.UZERO,jy.UZERO],l=[jy.UZERO,jy.UZERO];s=s.mul(pu).add(ma(n,0));let c=0;const u=(e-1>>6)*64,f=u+(e-1&63)-63;do s=Pl(s.add(r).add(o[0]).add(ma(n,c+8)),37).mul(Iy),r=Pl(r.add(o[1]).add(ma(n,c+48)),42).mul(Iy),s=s.xor(l[1]),r=r.add(o[0]).add(ma(n,c+40)),a=Pl(a.add(l[0]),33).mul(Iy),o=kI(n,c,o[1].mul(Iy),s.add(l[0])),l=kI(n,c+32,a.add(l[1]),r.add(ma(n,c+16))),[a,s]=[s,a],c+=64;while(c!==u);const d=Iy.add(a.and(255).shl(1));return c=f,l[0]=l[0].add(e-1&63),o[0]=o[0].add(l[0]),l[0]=l[0].add(o[0]),s=Pl(s.add(r).add(o[0]).add(ma(n,c+8)),37).mul(d),r=Pl(r.add(o[1]).add(ma(n,c+48)),42).mul(d),s=s.xor(l[1].mul(9)),r=r.add(o[0].mul(9).add(ma(n,c+40))),a=Pl(a.add(l[0]),33).mul(d),o=kI(n,c,o[1].mul(d),s.add(l[0])),l=kI(n,c+32,a.add(l[1]),r.add(ma(n,c+16))),[a,s]=[s,a],n1(n1(o[0],l[0],d).add(bR(r).mul(pre)).add(a),n1(o[1],l[1],d).add(s),d)}function Wg(n,e){return e==="string"?Cm(n):C1([n],e)}function eMe(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function C1(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Dm(n)),bt().getBool("DEBUG")&&ere(n,e),eMe(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function oc(){return bt().platform.now()}function yre(n,e){return bt().platform.fetch(n,e)}function Cm(n,e="utf-8"){return e=e||"utf-8",bt().platform.encode(n,e)}function Og(n,e="utf-8"){return e=e||"utf-8",bt().platform.decode(n,e)}function gl(n){return bt().platform.isTypedArray!=null?bt().platform.isTypedArray(n):fre(n)}function Dm(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Dg(n)||n==null||gl(n)&&t)e.push(n);else if(Array.isArray(n)||gl(n))for(let s=0;s<n.length;++s)Dm(n[s],e,t);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Dm(n[r],e,t)}return e}const tMe=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:xr,arraysEqualWithNull:Zse,assert:we,assertNonNegativeIntegerDimensions:Df,assertNonNull:Gb,assertShapesMatch:mc,bytesFromStringArray:nre,bytesPerElement:IM,checkConversionForErrors:ere,clamp:u1,computeStrides:gs,convertBackendValuesAndArrayBuffer:ire,createScalarValue:Wg,createShuffledIndices:DSe,decodeString:Og,distSquared:ASe,encodeString:Cm,fetch:yre,fingerPrint64:gre,flatten:Dm,getArrayFromDType:po,getTypedArrayFromDType:Bl,hasEncodingLoss:QF,hexToLong:kk,indexToLoc:qb,inferDtype:Hb,inferFromImplicitShape:XF,isBoolean:sre,isFunction:f1,isInt:pb,isNumber:_N,isPromise:Dg,isScalarShape:LSe,isString:wm,isTypedArray:gl,isValidDtype:tre,locToIndex:op,makeOnesTypedArray:F4,makeZerosNestedTypedArray:JF,makeZerosTypedArray:hc,nearestDivisor:xN,nearestLargerEven:R4,now:oc,parseAxisParam:dr,randUniform:ISe,repeatedTry:gR,rightPad:tb,shuffle:KF,shuffleCombo:ESe,sizeFromShape:Ot,sizeToSquarishShape:vN,squeezeShape:Vg,sum:Jse,swap:Sg,tanh:NSe,toNestedArray:yd,toTypedArray:C1},Symbol.toStringTag,{value:"Module"}));class nMe{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new rMe)}profileKernel(e,t,s){let r;const a=()=>{r=s()};let o;const l=oc();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const u of r)u.dataSync();o=Promise.resolve({kernelMs:oc()-l})}if(bt().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const f=r[u];f.data().then(d=>{sMe(d,f.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:a,extraInfo:o}=e;s.forEach(l=>{Promise.all([l.data(),r,o]).then(c=>{this.logger.logKernelProfile(t,l,c[0],c[1],a,c[2])})})}}function sMe(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}class rMe{logKernelProfile(e,t,s,r,a,o){const l=typeof r=="number"?tb(`${r}ms`,9):r.error,c=tb(e,25),u=t.rank,f=t.size,d=tb(t.shape.toString(),14);let h="";for(const p in a){const g=a[p];if(g!=null){const b=g.shape||t.shape,v=b.length;h+=`${p}: ${v}D ${v>0?b:""} `}}console.log(`%c${c}	%c${l}	%c${u}D ${d}	%c${f}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function iMe(n,e,t){const s={},r={};for(let c=0;c<e.length;c++)s[e[c].id]=!0;for(let c=0;c<n.length;c++){const u=n[c],f=u.inputs;for(const d in f){const h=f[d];let p=!1;for(let g=0;g<e.length;g++)if(s[h.id]){u.outputs.forEach(b=>s[b.id]=!0),p=!0,r[u.id]=!0;break}if(p)break}}const a={};a[t.id]=!0;const o={};for(let c=n.length-1;c>=0;c--){const u=n[c],f=u.inputs;for(let d=0;d<u.outputs.length;d++)if(a[u.outputs[d].id]){for(const h in f)a[f[h].id]=!0,o[u.id]=!0;break}}const l=[];for(let c=0;c<n.length;c++){const u=n[c];if(r[u.id]&&o[u.id]){const f={};for(const h in u.inputs){const p=u.inputs[h];s[p.id]&&(f[h]=p)}const d=Object.assign({},u);d.inputs=f,d.outputs=u.outputs,l.push(d)}}return l}function aMe(n,e,t,s){for(let r=e.length-1;r>=0;r--){const a=e[r],o=[];if(a.outputs.forEach(c=>{const u=n[c.id];u!=null?o.push(u):o.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const l=a.gradient(o);for(const c in a.inputs){if(!(c in l))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(l)}.`);const u=t(()=>l[c]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${u.dtype}'`);const f=a.inputs[c];if(!xr(u.shape,f.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${c}' has shape '${u.shape}', which does not match the shape of the input '${f.shape}'`);if(n[f.id]==null)n[f.id]=u;else{const d=n[f.id];n[f.id]=s(d,u),d.dispose()}}}}const UG=20,HC=3,v5=7;function oMe(n,e,t,s){const r=gs(e),a=lMe(n,e,t,r),o=e.length,l=gL(n,e,t,r,a),c=["Tensor"];return s&&(c.push(`  dtype: ${t}`),c.push(`  rank: ${o}`),c.push(`  shape: [${e}]`),c.push("  values:")),c.push(l.map(u=>"    "+u).join(`
`)),c.join(`
`)}function lMe(n,e,t,s){const r=Ot(e),a=s[s.length-1],o=new Array(a).fill(0),l=e.length,c=t==="complex64"?zS(n):n;if(l>1)for(let u=0;u<r/a;u++){const f=u*a;for(let d=0;d<a;d++)o[d]=Math.max(o[d],FS(c[f+d],0,t).length)}return o}function FS(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(v5))} + ${parseFloat(n[1].toFixed(v5))}j`:wm(n)?s=`'${n}'`:t==="bool"?s=bre(n):s=parseFloat(n.toFixed(v5)).toString(),tb(s,e)}function bre(n){return n===0?"false":"true"}function gL(n,e,t,s,r,a=!0){const o=t==="complex64"?2:1,l=e[0],c=e.length;if(c===0){if(t==="complex64"){const b=zS(n);return[FS(b[0],0,t)]}return t==="bool"?[bre(n[0])]:[n[0].toString()]}if(c===1){if(l>UG){const v=HC*o;let w=Array.from(n.slice(0,v)),x=Array.from(n.slice((l-HC)*o,l*o));return t==="complex64"&&(w=zS(w),x=zS(x)),["["+w.map((S,C)=>FS(S,r[C],t)).join(", ")+", ..., "+x.map((S,C)=>FS(S,r[l-HC+C],t)).join(", ")+"]"]}return["["+(t==="complex64"?zS(n):Array.from(n)).map((v,w)=>FS(v,r[w],t)).join(", ")+"]"]}const u=e.slice(1),f=s.slice(1),d=s[0]*o,h=[];if(l>UG){for(let b=0;b<HC;b++){const v=b*d,w=v+d;h.push(...gL(n.slice(v,w),u,t,f,r,!1))}h.push("...");for(let b=l-HC;b<l;b++){const v=b*d,w=v+d;h.push(...gL(n.slice(v,w),u,t,f,r,b===l-1))}}else for(let b=0;b<l;b++){const v=b*d,w=v+d;h.push(...gL(n.slice(v,w),u,t,f,r,b===l-1))}const p=c===2?",":"";h[0]="["+(l>0?h[0]+p:"");for(let b=1;b<h.length-1;b++)h[b]=" "+h[b]+p;let g=`,
`;for(let b=2;b<c;b++)g+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(a?"":g),h}function zS(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}class el{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=Ot(e),s!=null){const r=s.length;we(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||po(t,this.size),this.strides=gs(e)}set(e,...t){t.length===0&&(t=[0]),we(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Jh().makeTensor(this.values,this.shape,this.dtype)}}let Jh=null,Ev=null;function cMe(n){Jh=n}function uMe(n){Ev=n}let jr=class{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ot(e),this.strides=gs(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Ev.buffer(this.shape,this.dtype,e)}bufferSync(){return Ev.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return yd(this.shape,e,this.dtype==="complex64")}arraySync(){return yd(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Jh().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>Og(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Jh().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Jh().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Og(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Jh().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Jh().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Ev.print(this,e)}clone(){return this.throwIfDisposed(),Ev.clone(this)}toString(e=!1){const t=this.dataSync();return oMe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Ev.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Jh().makeVariable(this,e,t,s)}};Object.defineProperty(jr,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function jt(){return ez("Tensor",()=>jr)}jt();class PM extends jr{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!xr(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Jh().disposeTensor(this),this.dataId=e.dataId,Jh().incRef(this,null)}dispose(){Jh().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(PM,Symbol.hasInstance,{value:n=>n instanceof jr&&n.assign!=null&&n.assign instanceof Function});var wR;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(wR||(wR={}));var vR;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(vR||(vR={}));var _R;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(_R||(_R={}));var xR;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(xR||(xR={}));var CR;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(CR||(CR={}));const fMe={float32:xR,int32:vR,bool:_R,complex64:CR};function Hu(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return fMe[n][e]}function HD(n){return Hu(n,"int32")}function wre(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function vre(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}function to(n,e){if(n.dtype===e.dtype)return[n,e];const t=Hu(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function _re(n,e){we(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function qD(n,e){return e.some(t=>t.id===n.id)}function Pg(n){const e=[];return xre(n,e,new Set),e}function xre(n,e,t){if(n==null)return;if(n instanceof jr){e.push(n);return}if(!dMe(n))return;const s=n;for(const r in s){const a=s[r];t.has(a)||(t.add(a),xre(a,e,t))}}function dMe(n){return Array.isArray(n)||typeof n=="object"}const hMe=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:_re,getTensorsInContainer:Pg,isTensorInList:qD,makeTypesMatch:to},Symbol.toStringTag,{value:"Module"}));function _5(n){return n.kernelName!=null}class VG{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class o2{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new VG}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(cd(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new nMe(this.backendInstance),!0}setupRegisteredKernels(){TN(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){TN(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof j4)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,cd(`Initialization of backend ${e} failed`),cd(o.stack||o.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return cd(`Initialization of backend ${e} failed`),cd(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,a=this.readSync(t),o=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,a,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return o2.nextTensorId++}nextVariableId(){return o2.nextVariableId++}clone(e){const t=Ge.runKernel(a_,{x:e}),s={x:e},r=o=>({x:()=>{const l="float32",c={x:o},u={dtype:l};return Ge.runKernel(q2,c,u)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,a,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(OM(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let a=0;s.forEach(c=>{a+=c.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=r-t-a-o;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),a=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let c;const u=_5(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(_5(e)){const{kernelName:g,inputs:b,attrs:v}=e;this.backendName==null&&this.backend;const w=OM(g,this.backendName);we(w!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),l=()=>{const x=this.backend.numDataIds();c=w.kernelFunc({inputs:b,attrs:v,backend:this.backend});const S=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,x,S);const C=S.map(M=>M.rank!=null?M:this.makeTensorFromTensorInfo(M));if(r){const M=this.getTensorsForGradient(g,b,C);s=this.saveTensorsForBackwardMode(M)}return C}}else{const{forwardFunc:g}=e,b=v=>{r&&(s=v.map(w=>this.keep(this.clone(w))))};l=()=>{const v=this.backend.numDataIds();c=this.tidy(()=>g(this.backend,b));const w=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,v,w),w}}const{inputs:f,attrs:d}=e,h=_5(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=l():(p=this.profiler.profileKernel(u,f,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),t=p.outputs)}),r&&this.addTapeNode(u,f,t,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(f).map(g=>f[g]!=null?f[g].shape:null),outputShapes:t.map(g=>g.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(c)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=yR(e);if(r!=null){const a=r.inputsToSave||[],o=r.outputsToSave||[];let l;r.saveAllInputs?(we(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(t).map(u=>t[u])):l=a.map(u=>t[u]);const c=s.filter((u,f)=>o[f]);return l.concat(c)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=e;s==="string"&&wm(e[0])&&(a=e.map(c=>Cm(c)));const o=r.write(a,t,s),l=new jr(t,s,o,this.nextTensorId());if(this.trackTensor(l,r),s==="string"){const c=this.state.tensorInfo.get(o),u=nre(a);this.state.numBytes+=u-c.bytes,c.bytes=u}return l}makeTensorFromDataId(e,t,s,r){s=s||"float32";const a={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:a}=e,o=new jr(r,a,s,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const a=new PM(e,t,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*IM(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof PM||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*IM(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,a,o){const l={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:a},c=yR(e);c!=null&&(r=c.gradFunc),r!=null&&(l.gradient=u=>(u=u.map((f,d)=>{if(f==null){const h=s[d],p=hc(h.size,h.dtype);return this.makeTensor(p,h.shape,h.dtype)}return f}),r(u.length>1?u:u[0],a,o))),this.state.activeTape.push(l)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=Pg(e),s=new Set(t.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const o=this.state.activeScope.track[a];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,t,s,r=!1){if(we(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));we(a instanceof jr,()=>"The result y returned by f() must be a tensor.");const o=iMe(this.state.activeTape,t,a);if(!r&&o.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const l={};l[a.id]=s??pMe(a.shape),aMe(l,o,u=>this.tidy(u),mMe);const c=t.map(u=>l[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const f of u.saved)f.dispose()}),this.state.activeTape=null),{value:a,grads:c}})}customGrad(e){return we(f1(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{we(t.every(l=>l instanceof jr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((l,c)=>{r[c]=l});const a=(l,c)=>(s=e(...t,c),we(s.value instanceof jr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),we(f1(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(l,c)=>{const u=s.gradFunc(l,c),f=Array.isArray(u)?u:[u];we(f.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),we(f.every(h=>h instanceof jr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return f.forEach((h,p)=>{d[p]=()=>h}),d};return this.runKernelFunc({forwardFunc:a,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=oc(),s=await this.backend.time(e);return s.wallMs=oc()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new VG;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}o2.nextTensorId=0;o2.nextVariableId=0;function pMe(n){const e=F4(Ot(n),"float32");return Ge.makeTensor(e,n,"float32")}function Cre(){const n=ore();if(n._tfengine==null){const e=new are(n);n._tfengine=new o2(e)}return jSe(n._tfengine.ENV),cMe(()=>n._tfengine),n._tfengine}const Ge=Cre();function mMe(n,e){const t={a:n,b:e};return Ge.runKernel(Yb,t)}function gMe(){return typeof navigator<"u"&&navigator!=null}let SR;function yMe(n){SR=n}function nz(n){if(SR!==void 0)return SR;if(n||gMe()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function sz(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const bMe=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:sz,isMobile:nz,mockIsMobile:yMe},Symbol.toStringTag,{value:"Module"}));const qu=bt();qu.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});qu.registerFlag("IS_BROWSER",()=>sz());qu.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");qu.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));qu.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));qu.registerFlag("PROD",()=>!1);qu.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>qu.getBool("DEBUG"));qu.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);qu.registerFlag("IS_TEST",()=>!1);qu.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>qu.getBool("DEBUG"));qu.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);qu.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);qu.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function Om(n,e){let t=n;if(gl(n))return e==="string"?[]:[n.length];if(wre(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(vre(n))return[n.buffer.size/(e==null?4:IM(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||gl(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&bt().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Sre(n,s,[]),s}function Sre(n,e,t){if(t=t||[],!Array.isArray(n)&&!gl(n)){we(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}we(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),we(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)Sre(n[r],s,t.concat(r))}function WG(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function Te(n,e,t,s="numeric"){if(n instanceof jr)return WG(s,n.dtype,e,t),n;let r=Hb(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),WG(s,r,e,t),n==null||!gl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const c=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${c}'`)}const a=Om(n,r);!gl(n)&&!Array.isArray(n)&&(n=[n]);const l=r!=="string"?C1(n,r):Dm(n,[],!0);return Ge.makeTensor(l,a,r)}function $M(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((a,o)=>Te(a,`${e}[${o}]`,t,s))}const rz="__op";function Ye(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+rz;const r=(...a)=>{Ge.startScope(t);try{const o=s(...a);return Dg(o)&&console.error("Cannot return a Promise inside of tidy."),Ge.endScope(o),o}catch(o){throw Ge.endScope(null),o}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}function wMe(n,e){const t=Te(n,"real","complex"),s=Te(e,"imag","complex");mc(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return Ge.runKernel(H4,r)}const $g=Ye({complex_:wMe});function S1(n,e,t,s){if(s==null)s=Hb(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(vre(n)||wre(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return Ge.backend.createTensorFromGPUData(n,e||t,s)}if(!gl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Df(e);const r=Ot(e),a=Ot(t);we(r===a,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${a}`);for(let o=0;o<t.length;++o){const l=t[o],c=o===t.length-1?l!==Ot(e.slice(o)):!0;we(t[o]===e[o]||!c,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!gl(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?C1(n,s):Dm(n,[],!0),Ge.makeTensor(n,e,s)}function Tf(n,e,t){const s=Om(n,t);return S1(n,e,s,t)}const MR={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Cp{static join(e){return new Cp(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>gl(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=t-e,a=new ArrayBuffer(r),o=new Uint8Array(a);let l=0;for(let c=s;c<this.shards.length;c++){const u=this.shards[c],d=e+l-u.start,h=l,g=Math.min(t,u.end)-u.start,b=new Uint8Array(u.buffer,d,g-d);if(o.set(b,h),l+=b.length,t<u.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=vMe(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function vMe(n,e){let t=0,s=n.length;for(;t<=s;){const r=Math.floor((s-t)/2)+t,a=e(n[r]);if(a===0)return r;a<0?s=r:t=r+1}return-1}const kN=4;async function TR(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<r.length;++o){const l=r[o],c=Array.isArray(n)?n[o].tensor:n[l];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${l}': ${c.dtype}`);const u={name:l,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){const f=new Promise(async d=>{const h=await c.bytes(),p=h.reduce((v,w)=>v+w.length,0)+kN*h.length,g=new Uint8Array(p);let b=0;for(let v=0;v<h.length;v++){const w=h[v],x=new Uint8Array(new Uint32Array([w.length]).buffer);g.set(x,b),b+=kN,g.set(w,b),b+=w.length}d(g)});s.push(f)}else s.push(c.data());e!=null&&(u.group=e),t.push(u)}const a=await Promise.all(s);return{data:_Me(a),specs:t}}function iz(n,e){const t=new Cp(n),s={};let r,a=0;for(const o of e){const l=o.name,c=o.dtype,u=o.shape,f=Ot(u);let d;if("quantization"in o){const h=o.quantization;if(h.dtype==="uint8"||h.dtype==="uint16"){if(!("min"in h&&"scale"in h))throw new Error(`Weight ${o.name} with quantization ${h.dtype} doesn't have corresponding metadata min and scale.`)}else if(h.dtype==="float16"){if(c!=="float32")throw new Error(`Weight ${o.name} is quantized with ${h.dtype} which only supports weights of type float32 not ${c}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${h.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=MR[h.dtype],g=t.slice(a,a+f*p),b=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(c==="float32")if(h.dtype==="uint8"||h.dtype==="uint16"){d=new Float32Array(b.length);for(let v=0;v<b.length;v++){const w=b[v];d[v]=w*h.scale+h.min}}else if(h.dtype==="float16")r===void 0&&(r=kMe()),d=r(b);else throw new Error(`Unsupported quantization type ${h.dtype} for weight type float32.`);else if(c==="int32"){if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error(`Unsupported quantization type ${h.dtype} for weight type int32.`);d=new Int32Array(b.length);for(let v=0;v<b.length;v++){const w=b[v];d[v]=Math.round(w*h.scale+h.min)}}else throw new Error(`Unsupported dtype in weight '${l}': ${c}`);a+=f*p}else if(c==="string"){const h=Ot(o.shape);d=[];for(let p=0;p<h;p++){const g=new Uint32Array(t.slice(a,a+kN))[0];a+=kN;const b=new Uint8Array(t.slice(a,a+g));d.push(b),a+=g}}else{const h=MR[c],p=t.slice(a,a+f*h);if(c==="float32")d=new Float32Array(p);else if(c==="int32")d=new Int32Array(p);else if(c==="bool")d=new Uint8Array(p);else if(c==="complex64"){d=new Float32Array(p);const g=new Float32Array(d.length/2),b=new Float32Array(d.length/2);for(let x=0;x<g.length;x++)g[x]=d[x*2],b[x]=d[x*2+1];const v=Tf(g,u,"float32"),w=Tf(b,u,"float32");s[l]=$g(v,w),v.dispose(),w.dispose()}else throw new Error(`Unsupported dtype in weight '${l}': ${c}`);a+=f*h}c!=="complex64"&&(s[l]=Tf(d,u,c))}return s}function _Me(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(a=>{if(e+=a.byteLength,t.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const az=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function GG(n){return az?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function xMe(n){if(az)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function CMe(n){if(az){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function Mre(n){return Cp.join(n)}function HG(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const t=n.split("/");return t[t.length-1]}function Tre(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function oz(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(s.initializerSignature=n.initializerSignature),s}async function lz(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),oz(n,t,s)}function Ek(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:GG(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:GG(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Cp(n.weightData).byteLength}}function cz(n){const e=[];for(const t of n)e.push(...t.weights);return e}function SMe(){const n=t=>{let s=t<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function MMe(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function TMe(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function kMe(){const n=SMe(),e=MMe(),t=TMe();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let o=0;o<s.length;o++){const l=s[o],c=n[t[l>>10]+(l&1023)]+e[l>>10];a[o]=c}return new Float32Array(r)}}class Xa{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Xa.instance==null&&(Xa.instance=new Xa),Xa.instance}static registerSaveRouter(e){Xa.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Xa.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Xa.getHandlers(e,"save")}static getLoadHandlers(e,t){return Xa.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?Xa.getInstance().loadRouters:Xa.getInstance().saveRouters).forEach(o=>{const l=o(e,s);l!==null&&r.push(l)}),r}}const EMe=n=>Xa.registerSaveRouter(n),IMe=n=>Xa.registerLoadRouter(n),kre=n=>Xa.getSaveHandlers(n),Ere=(n,e)=>Xa.getLoadHandlers(n,e);const kR="tensorflowjs",ER=1,Hy="models_store",Y0="model_info_store";function Ire(){if(!bt().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function IR(n){const e=n.result;e.createObjectStore(Hy,{keyPath:"modelPath"}),e.createObjectStore(Y0,{keyPath:"modelPath"})}class mb{constructor(e){if(this.indexedDB=Ire(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const a=this.indexedDB.open(kR,ER);a.onupgradeneeded=()=>IR(a),a.onsuccess=()=>{const o=a.result;if(t==null){const l=o.transaction(Hy,"readonly"),u=l.objectStore(Hy).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=f=>(o.close(),r(u.error)),l.oncomplete=()=>o.close()}else{t.weightData=Cp.join(t.weightData);const l=Ek(t),c=o.transaction(Y0,"readwrite");let u=c.objectStore(Y0),f;try{f=u.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(h){return r(h)}let d;f.onsuccess=()=>{d=o.transaction(Hy,"readwrite");const h=d.objectStore(Hy);let p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:l})}catch(g){return r(g)}p.onsuccess=()=>s({modelArtifactsInfo:l}),p.onerror=g=>{u=c.objectStore(Y0);const b=u.delete(this.modelPath);b.onsuccess=()=>(o.close(),r(p.error)),b.onerror=v=>(o.close(),r(p.error))}},f.onerror=h=>(o.close(),r(f.error)),c.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},a.onerror=o=>r(a.error)})}}mb.URL_SCHEME="indexeddb://";const Are=n=>bt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(mb.URL_SCHEME)?AMe(n.slice(mb.URL_SCHEME.length)):null;Xa.registerSaveRouter(Are);Xa.registerLoadRouter(Are);function AMe(n){return new mb(n)}function LMe(n){return n.startsWith(mb.URL_SCHEME)?n.slice(mb.URL_SCHEME.length):n}class NMe{constructor(){this.indexedDB=Ire()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(kR,ER);s.onupgradeneeded=()=>IR(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(Y0,"readonly"),l=a.objectStore(Y0).getAll();l.onsuccess=()=>{const c={};for(const u of l.result)c[u.modelPath]=u.modelArtifactsInfo;e(c)},l.onerror=c=>(r.close(),t(l.error)),a.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=LMe(e),new Promise((t,s)=>{const r=this.indexedDB.open(kR,ER);r.onupgradeneeded=()=>IR(r),r.onsuccess=()=>{const a=r.result,o=a.transaction(Y0,"readwrite"),l=o.objectStore(Y0),c=l.get(e);let u;c.onsuccess=()=>{if(c.result==null)return a.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const f=l.delete(e),d=()=>{u=a.transaction(Hy,"readwrite");const p=u.objectStore(Hy).delete(e);p.onsuccess=()=>t(c.result.modelArtifactsInfo),p.onerror=g=>s(c.error)};f.onsuccess=d,f.onerror=h=>(d(),a.close(),s(c.error))}},c.onerror=f=>(a.close(),s(c.error)),o.oncomplete=()=>{u==null?a.close():u.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}const Mg="/",Iv="tensorflowjs_models",Lre="info",DMe="model_topology",OMe="weight_specs",PMe="weight_data",$Me="model_metadata";function Nre(n){return{info:[Iv,n,Lre].join(Mg),topology:[Iv,n,DMe].join(Mg),weightSpecs:[Iv,n,OMe].join(Mg),weightData:[Iv,n,PMe].join(Mg),modelMetadata:[Iv,n,$Me].join(Mg)}}function Dre(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function jMe(n){const e=n.split(Mg);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Mg)}function RMe(n){return n.startsWith(gb.URL_SCHEME)?n.slice(gb.URL_SCHEME.length):n}class gb{constructor(e){if(!bt().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Nre(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Ek(e),a=Cp.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,xMe(a));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw Dre(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const l=JSON.parse(a);t.format=l.format,t.generatedBy=l.generatedBy,t.convertedBy=l.convertedBy,l.signature!=null&&(t.signature=l.signature),l.userDefinedMetadata!=null&&(t.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(t.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(t.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(t.trainingConfig=l.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=CMe(o),t}}gb.URL_SCHEME="localstorage://";const Ore=n=>bt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(gb.URL_SCHEME)?FMe(n.slice(gb.URL_SCHEME.length)):null;Xa.registerSaveRouter(Ore);Xa.registerLoadRouter(Ore);function FMe(n){return new gb(n)}class zMe{constructor(){we(bt().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),we(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Iv+Mg,s=Mg+Lre;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(s)){const o=jMe(a);e[o]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=RMe(e);const t=Nre(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return Dre(t),s}}const Yv="://";class hu{constructor(){this.managers={}}static getInstance(){return hu.instance==null&&(hu.instance=new hu),hu.instance}static registerManager(e,t){we(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Yv)&&(e=e.slice(0,e.indexOf(Yv))),we(e.length>0,()=>"scheme must not be an empty string.");const s=hu.getInstance();we(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=hu.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(hu.getInstance().managers)}}function yL(n){if(n.indexOf(Yv)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${hu.getSchemes().join(",")}`);return{scheme:n.split(Yv)[0],path:n.split(Yv)[1]}}async function Pre(n,e,t=!1){we(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=Xa.getLoadHandlers(n);we(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),we(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],a=Xa.getSaveHandlers(e);we(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),we(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const o=a[0],l=yL(n).scheme,c=yL(n).path,u=l===yL(n).scheme,f=await r.load();t&&u&&await hu.getManager(l).removeModel(c);const d=await o.save(f);return t&&!u&&await hu.getManager(l).removeModel(c),d.modelArtifactsInfo}async function BMe(){const n=hu.getSchemes(),e={};for(const t of n){const s=await hu.getManager(t).listModels();for(const r in s){const a=t+Yv+r;e[a]=s[r]}}return e}async function UMe(n){const e=yL(n);return hu.getManager(e.scheme).removeModel(e.path)}async function VMe(n,e){return Pre(n,e,!1)}async function WMe(n,e){return Pre(n,e,!0)}class GMe{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!bt().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return fre(e)}}if(bt().get("IS_BROWSER")){bt().setPlatform("browser",new GMe);try{hu.registerManager(gb.URL_SCHEME,new zMe)}catch{}try{hu.registerManager(mb.URL_SCHEME,new NMe)}catch{}}const HMe={importFetch:()=>require("node-fetch")};let x5;class qMe{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return bt().global.fetch!=null?bt().global.fetch(e,t):(x5==null&&(x5=HMe.importFetch()),x5(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}bt().get("IS_NODE")&&!bt().get("IS_BROWSER")&&bt().setPlatform("node",new qMe);function tr(n,e="float32",t){return e=e||"float32",Df(n),new el(n,e,t)}function YMe(n,e){const t=Te(n,"x","cast");if(!tre(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return Ge.runKernel(q2,s,r)}const Cn=Ye({cast_:YMe});function KMe(n){const t={x:Te(n,"x","clone","string_or_numeric")};return Ge.runKernel(a_,t)}const Sm=Ye({clone_:KMe});function uz(n,e=!1){console.log(n.toString(e))}Cre();const XMe={buffer:tr,cast:Cn,clone:Sm,print:uz};uMe(XMe);function QMe(){bt().set("PROD",!0)}function JMe(){bt().set("DEBUG",!0)}function ZMe(){bt().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function eTe(n){bt().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function tTe(){Ge.disposeVariables()}function Xh(){return Ge}function AR(){return Ge.memory()}function nTe(n){return Ge.profile(n)}function wt(n,e){return Ge.tidy(n,e)}function Ws(n){Pg(n).forEach(t=>t.dispose())}function bl(n){return Ge.keep(n)}function sTe(n){return Ge.time(n)}function rTe(n){return Ge.setBackend(n)}function iTe(){return Ge.ready()}function aTe(){return Ge.backendName}function oTe(n){Ge.removeBackend(n)}function lTe(n){return Ge.findBackend(n)}function cTe(n){return Ge.findBackendFactory(n)}function fz(n,e,t=1){return Ge.registerBackend(n,e,t)}function $re(){return Ge.backend}function uTe(n,e){bt().setPlatform(n,e)}function fTe(n,e){let t=Te(n,"a","add"),s=Te(e,"b","add");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(Yb,r)}const ln=Ye({add_:fTe});function dTe(n,e){let t=Te(n,"a","floorDiv"),s=Te(e,"b","floorDiv");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(r_,r)}const YD=Ye({floorDiv_:dTe});function hTe(n,e){let t=Te(n,"a","div"),s=Te(e,"b","div");if([t,s]=to(t,s),t.dtype==="int32"&&s.dtype==="int32")return YD(t,s);const r={a:t,b:s},a={};return Ge.runKernel(J2,r,a)}const cs=Ye({div_:hTe});function pTe(n,e){let t=Te(n,"a","mul"),s=Te(e,"b","mul");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(m_,r)}const et=Ye({mul_:pTe});function mTe(n){const e=Te(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Ge.runKernel(DT,t)}else{const t={x:e};return Ge.runKernel(ST,t)}}const Go=Ye({abs_:mTe});function gTe(n){const t={x:Te(n,"x","acos")};return Ge.runKernel(z2,t)}const dz=Ye({acos_:gTe});function yTe(n){const t={x:Te(n,"x","acosh")};return Ge.runKernel(B2,t)}const hz=Ye({acosh_:yTe});function bTe(n){we(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),we(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((r,a)=>Te(r,`tensors${a}`,"addN")),t=e[0];e.forEach(r=>{if(r.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!xr(r.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return Ge.runKernel(MT,s)}const jre=Ye({addN_:bTe});function wTe(n,e=null,t=!1){const r={x:Te(n,"x","all","bool")},a={axis:e,keepDims:t};return Ge.runKernel(z4,r,a)}const KD=Ye({all_:wTe});function vTe(n,e=null,t=!1){const r={x:Te(n,"x","any","bool")},a={axis:e,keepDims:t};return Ge.runKernel(B4,r,a)}const jM=Ye({any_:vTe});function _Te(n,e=0){const s={x:Te(n,"x","argMax")},r={axis:e};return Ge.runKernel(TT,s,r)}const yb=Ye({argMax_:_Te});function xTe(n,e=0){const s={x:Te(n,"x","argMin")},r={axis:e};return Ge.runKernel(kT,s,r)}const pz=Ye({argMin_:xTe});function CTe(n){const t={x:Te(n,"x","asin")};return Ge.runKernel(U2,t)}const mz=Ye({asin_:CTe});function STe(n){const t={x:Te(n,"x","asinh")};return Ge.runKernel(V2,t)}const gz=Ye({asinh_:STe});function MTe(n){const t={x:Te(n,"x","atan")};return Ge.runKernel(W2,t)}const yz=Ye({atan_:MTe});function TTe(n,e){let t=Te(n,"a","atan2"),s=Te(e,"b","atan2");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(H2,r)}const bz=Ye({atan2_:TTe});function kTe(n){const t={x:Te(n,"x","atanh")};return Ge.runKernel(G2,t)}const wz=Ye({atanh_:kTe});function Ik(n,e,t,s,r="NHWC",a){const o=n[3],l=[...e,o],c=Hg(r);return Vl(n,l,t,a,s,null,null,c)}function vh(n,e,t,s,r,a,o="channelsLast"){const[l,c]=RM(e);let u;if(o==="channelsLast")u=[l,c,n[3],n[3]];else if(o==="channelsFirst")u=[l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return Vl(n,u,t,s,r,a,!1,o)}function Gg(n,e,t,s,r,a,o="NDHWC"){const[l,c,u]=LR(e);let f,d;if(o==="NDHWC")d="channelsLast",f=[l,c,u,n[4],n[4]];else if(o==="NCDHW")d="channelsFirst",f=[l,c,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return M1(n,f,t,s,r,!1,d,a)}function Vl(n,e,t,s,r,a,o=!1,l="channelsLast"){let[c,u,f,d]=[-1,-1,-1,-1];if(l==="channelsLast")[c,u,f,d]=n;else if(l==="channelsFirst")[c,d,u,f]=n;else throw new Error(`Unknown dataFormat ${l}`);const[h,p,,g]=e,[b,v]=RM(t),[w,x]=RM(s),S=Kv(h,w),C=Kv(p,x),{padInfo:M,outHeight:k,outWidth:E}=ATe(r,u,f,b,v,S,C,a,l),I=o?g*d:g;let A;return l==="channelsFirst"?A=[c,I,k,E]:l==="channelsLast"&&(A=[c,k,E,I]),{batchSize:c,dataFormat:l,inHeight:u,inWidth:f,inChannels:d,outHeight:k,outWidth:E,outChannels:I,padInfo:M,strideHeight:b,strideWidth:v,filterHeight:h,filterWidth:p,effectiveFilterHeight:S,effectiveFilterWidth:C,dilationHeight:w,dilationWidth:x,inShape:n,outShape:A,filterShape:e}}function M1(n,e,t,s,r,a=!1,o="channelsLast",l){let[c,u,f,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[c,u,f,d,h]=n;else if(o==="channelsFirst")[c,h,u,f,d]=n;else throw new Error(`Unknown dataFormat ${o}`);const[p,g,b,,v]=e,[w,x,S]=LR(t),[C,M,k]=LR(s),E=Kv(p,C),I=Kv(g,M),A=Kv(b,k),{padInfo:D,outDepth:L,outHeight:P,outWidth:j}=LTe(r,u,f,d,w,x,S,E,I,A,l),G=a?v*h:v;let Q;return o==="channelsFirst"?Q=[c,G,L,P,j]:o==="channelsLast"&&(Q=[c,L,P,j,G]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:f,inWidth:d,inChannels:h,outDepth:L,outHeight:P,outWidth:j,outChannels:G,padInfo:D,strideDepth:w,strideHeight:x,strideWidth:S,filterDepth:p,filterHeight:g,filterWidth:b,effectiveFilterDepth:E,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationDepth:C,dilationHeight:M,dilationWidth:k,inShape:n,outShape:Q,filterShape:e}}function ETe(n,e,t,s,r){s==null&&(s=vz(n,e,t));const a=n[0],o=n[1],l=FM((a-e+2*s)/t+1,r),c=FM((o-e+2*s)/t+1,r);return[l,c]}function ITe(n,e,t,s,r,a){r==null&&(r=vz(n,e[0],s[0]));const o=[0,0,0,t];for(let l=0;l<3;l++)n[l]+2*r>=e[l]&&(o[l]=FM((n[l]-e[l]+2*r)/s[l]+1,a));return o}function vz(n,e,t,s=1){const r=Kv(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function RM(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function LR(n){return typeof n=="number"?[n,n,n]:n}function Kv(n,e){return e<=1?n:n+(n-1)*(e-1)}function ATe(n,e,t,s,r,a,o,l,c){let u,f,d;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const p=ETe([e,t],a,s,n,l);f=p[0],d=p[1]}else if(n==="same"){f=Math.ceil(e/s),d=Math.ceil(t/r);const h=Math.max(0,(f-1)*s+a-e),p=Math.max(0,(d-1)*r+o-t),g=Math.floor(h/2),b=h-g,v=Math.floor(p/2),w=p-v;u={top:g,bottom:b,left:v,right:w,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((e-a+1)/s),d=Math.ceil((t-o+1)/r);else if(typeof n=="object"){const h=c==="channelsLast"?n[1][0]:n[2][0],p=c==="channelsLast"?n[1][1]:n[2][1],g=c==="channelsLast"?n[2][0]:n[3][0],b=c==="channelsLast"?n[2][1]:n[3][1];u={top:h,bottom:p,left:g,right:b,type:h===0&&p===0&&g===0&&b===0?"VALID":"EXPLICIT"},f=FM((e-a+h+p)/s+1,l),d=FM((t-o+g+b)/r+1,l)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:f,outWidth:d}}function LTe(n,e,t,s,r,a,o,l,c,u,f){let d,h,p,g;if(n==="valid"&&(n=0),typeof n=="number"){d={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=ITe([e,t,s,1],[l,c,u],1,[r,a,o],n,f);h=v[0],p=v[1],g=v[2]}else if(n==="same"){h=Math.ceil(e/r),p=Math.ceil(t/a),g=Math.ceil(s/o);const b=(h-1)*r+l-e,v=(p-1)*a+c-t,w=(g-1)*o+u-s,x=Math.floor(b/2),S=b-x,C=Math.floor(v/2),M=v-C,k=Math.floor(w/2),E=w-k;d={top:C,bottom:M,left:k,right:E,front:x,back:S,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:d,outDepth:h,outHeight:p,outWidth:g}}function FM(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function d1(n){const[e,t,s]=RM(n);return e===1&&t===1&&s===1}function gc(n,e){return d1(n)||d1(e)}function bb(n){return RM(n).every(e=>e>0)}function Hg(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Cu(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")we(pb(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{we(pb(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}function NTe(n,e){const s={x:Te(n,"x","reshape","string_or_numeric")},r={shape:e};return Ge.runKernel(hk,s,r)}const nt=Ye({reshape_:NTe});function DTe(n,e,t,s,r){const a=Te(n,"x","avgPool","float32"),o=1;we(gc(t,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);let l=a,c=!1;a.rank===3&&(c=!0,l=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),we(l.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${l.rank}.`),Cu("avgPool",s,r);const u={x:l},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let d=Ge.runKernel(ET,u,f);return d=Cn(d,a.dtype),c?nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ak=Ye({avgPool_:DTe});function OTe(n,e,t,s,r,a="NDHWC"){const o=Te(n,"x","avgPool3d","float32");let l=o,c=!1;o.rank===4&&(c=!0,l=nt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),we(l.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),we(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),we(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),Cu("avgPool3d",s,r);const u={x:l},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:a};let d=Ge.runKernel(IT,u,f);return d=Cn(d,l.dtype),c?nt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const _z=Ye({avgPool3d_:OTe});function PTe(n,e=0){we(n.length>=1,()=>"Pass at least one tensor to concat");const t=$M(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),t.length===1)return Sm(t[0]);const s=t,r={axis:e};return Ge.runKernel(OT,s,r)}const Po=Ye({concat_:PTe});function $Te(n,e,t=!1,s=!1){let r=Te(n,"a","matMul"),a=Te(e,"b","matMul");[r,a]=to(r,a);const o={a:r,b:a},l={transposeA:t,transposeB:s};return Ge.runKernel(AT,o,l)}const fr=Ye({matMul_:$Te});function jTe(n){const t={x:Te(n,"x","sigmoid","float32")};return Ge.runKernel(T_,t)}const lp=Ye({sigmoid_:jTe});function RTe(n,e,t){const s=Te(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:e,size:t};return Ge.runKernel(bk,r,a)}const Pr=Ye({slice_:RTe});function FTe(n){const t={x:Te(n,"x","tanh","float32")};return Ge.runKernel(N_,t)}const wb=Ye({tanh_:FTe});function zTe(n,e,t,s,r,a){const o=Te(n,"forgetBias","basicLSTMCell"),l=Te(e,"lstmKernel","basicLSTMCell"),c=Te(t,"lstmBias","basicLSTMCell"),u=Te(s,"data","basicLSTMCell"),f=Te(r,"c","basicLSTMCell"),d=Te(a,"h","basicLSTMCell"),h=Po([u,d],1),p=fr(h,l),g=ln(p,c),b=g.shape[0],v=g.shape[1]/4,w=[b,v],x=Pr(g,[0,0],w),S=Pr(g,[0,v],w),C=Pr(g,[0,v*2],w),M=Pr(g,[0,v*3],w),k=ln(et(lp(x),wb(S)),et(f,lp(ln(o,C)))),E=et(wb(k),lp(M));return[k,E]}const Rre=Ye({basicLSTMCell_:zTe});function BTe(n,e,t){const s=Te(n,"x","batchToSpaceND"),r=e.reduce((l,c)=>l*c);we(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),we(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),we(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const a={x:s},o={blockShape:e,crops:t};return Ge.runKernel(LT,a,o)}const Lk=Ye({batchToSpaceND_:BTe});function UTe(n){let e;return n.rank===0||n.rank===1?e=nt(n,[1,1,1,n.size]):n.rank===2?e=nt(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=nt(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}function VTe(n,e,t,s,r,a){a==null&&(a=.001);const o=Te(n,"x","batchNorm"),l=Te(e,"mean","batchNorm"),c=Te(t,"variance","batchNorm");let u;r!=null&&(u=Te(r,"scale","batchNorm"));let f;s!=null&&(f=Te(s,"offset","batchNorm")),we(l.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),we(f==null||l.rank===f.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),we(u==null||l.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:UTe(o),scale:u,offset:f,mean:l,variance:c},p={varianceEpsilon:a},g=Ge.runKernel(VT,h,p);return nt(g,o.shape)}const P_=Ye({batchNorm_:VTe});function WTe(n,e,t,s,r,a){const o=Te(n,"x","batchNorm"),l=Te(e,"mean","batchNorm"),c=Te(t,"variance","batchNorm");let u;r!=null&&(u=Te(r,"scale","batchNorm"));let f;return s!=null&&(f=Te(s,"offset","batchNorm")),we(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),we(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`),we(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&we(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),f!=null&&we(f.rank===2||f.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${f.rank}.`),P_(o,l,c,f,u,a)}const xz=Ye({batchNorm2d_:WTe});function GTe(n,e,t,s,r,a){const o=Te(n,"x","batchNorm"),l=Te(e,"mean","batchNorm"),c=Te(t,"variance","batchNorm");let u;r!=null&&(u=Te(r,"scale","batchNorm"));let f;return s!=null&&(f=Te(s,"offset","batchNorm")),we(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),we(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`),we(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&we(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),f!=null&&we(f.rank===3||f.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${f.rank}.`),P_(o,l,c,f,u,a)}const Cz=Ye({batchNorm3d_:GTe});function HTe(n,e,t,s,r,a){const o=Te(n,"x","batchNorm"),l=Te(e,"mean","batchNorm"),c=Te(t,"variance","batchNorm");let u;r!=null&&(u=Te(r,"scale","batchNorm"));let f;return s!=null&&(f=Te(s,"offset","batchNorm")),we(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),we(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`),we(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&we(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),f!=null&&we(f.rank===4||f.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${f.rank}.`),P_(o,l,c,f,u,a)}const Sz=Ye({batchNorm4d_:HTe});function qTe(n,e,t){const s=Te(n,"x","bincount"),r=Te(e,"weights","bincount");we(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),we(t>=0,()=>`size must be non-negative, but got ${t}.`),we(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},o={size:t};return Ge.runKernel(W4,a,o)}const Mz=Ye({bincount_:qTe});function YTe(n,e){const t=Te(n,"x","bitwiseAnd"),s=Te(e,"y","bitwiseAnd");if(!xr(t.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${t.shape}, y: ${s.shape}`);if(t.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${t.dtype} and type of y: ${s.dtype}`);const r={a:t,b:s};return Ge.runKernel(NT,r)}const Fre=Ye({bitwiseAnd_:YTe});function KTe(n,e){const t=Te(n,"s0","broadcastArgs","int32"),s=Te(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:t,s1:s};return Ge.runKernel(G4,r)}const zre=Ye({broadcastArgs_:KTe});function XTe(n,e){let t=Te(n,"broadcastTo","x");const s=t.shape;if(Df(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=nt(t,u)}const r=t.shape,a=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])a[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(a.map((u,f)=>u>1?f:-1).filter(u=>u>=0).length===0)return Sm(t);const l={x:t},c={reps:a};return Ge.runKernel(D_,l,c)}const sb=Ye({broadcastTo_:XTe});function QTe(n){const t={x:Te(n,"x","ceil","float32")};return Ge.runKernel(Y2,t)}const Tz=Ye({ceil_:QTe});function Kb(n,e,t){Df(n),t=t||Hb(e);const s={shape:n,value:e,dtype:t};return Ge.runKernel(oD,{},s)}function JTe(n,e,t){const s=Te(n,"x","clipByValue");if(we(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return Kb(s.shape,e,s.dtype);const r={x:s},a={clipValueMin:e,clipValueMax:t};return Ge.runKernel(K2,r,a)}const Yu=Ye({clipByValue_:JTe});function ZTe(n){return Po(n,0)}const kz=Ye({concat1d_:ZTe});function eke(n,e){return Po(n,e)}const Ez=Ye({concat2d_:eke});function tke(n,e){return Po(n,e)}const Iz=Ye({concat3d_:tke});function nke(n,e){return Po(n,e)}const Az=Ye({concat4d_:nke});function ske(n,e,t,s,r="NHWC",a=[1,1],o){const l=Te(n,"x","conv2d","float32"),c=Te(e,"filter","conv2d","float32");let u=l,f=!1;l.rank===3&&(f=!0,u=nt(l,[1,l.shape[0],l.shape[1],l.shape[2]])),we(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),we(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),Cu("conv2d",s,o);const d=r==="NHWC"?u.shape[3]:u.shape[1];we(d===c.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${c.shape[2]}.`),we(gc(t,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),we(bb(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),we(bb(t),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:c},p={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o},g=Ge.runKernel(PT,h,p);return f?nt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const jg=Ye({conv2d_:ske});function rke(n,e,t,s,r="NWC",a=1,o){const l=Te(n,"x","conv1d"),c=Te(e,"filter","conv1d");let u=l,f=!1;l.rank===2&&(f=!0,u=nt(l,[1,l.shape[0],l.shape[1]])),we(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),we(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),Cu("conv1d",s,o),we(u.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${c.shape[1]}.`),we(gc(t,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${a}'`),we(bb(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),we(bb(t),()=>"Error in conv1D: Stride should be larger than 0."),we(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=nt(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=nt(u,[u.shape[0],1,u.shape[1],u.shape[2]]),v=jg(h,d,[1,t],s,"NHWC",[1,a],o);return f?nt(v,[v.shape[2],v.shape[3]]):nt(v,[v.shape[0],v.shape[2],v.shape[3]])}const XD=Ye({conv1d_:rke});function ike(n,e,t,s,r,a="NHWC",o){we(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let l=n,c=e,u=!1;e.rank===3&&(u=!0,c=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]),l=[1,n[0],n[1],n[2]]),we(l.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${l.length}.`),we(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),we(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const f=a==="NHWC"?l[3]:l[1],d=a==="NHWC"?c.shape[3]:c.shape[1];we(f===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${f}) must match input depth for filter ${t.shape[2]}.`),we(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),Cu("conv2dDerInput",r,o);const h={dy:c,filter:t},p={strides:s,pad:r,dataFormat:a,dimRoundingMode:o,inputShape:l},g=Ge.runKernel($T,h,p);return u?nt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Lz=Ye({conv2DBackpropInput_:ike});function ake(n,e,t,s,r,a){const o=Te(n,"x","conv2dTranspose"),l=Te(e,"filter","conv2dTranspose");return Lz(t,o,l,s,r,"NHWC",a)}const QD=Ye({conv2dTranspose_:ake});function oke(n,e,t,s,r="NDHWC",a=[1,1,1]){const o=Te(n,"x","conv3d"),l=Te(e,"filter","conv3d");let c=o,u=!1;o.rank===4&&(u=!0,c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),we(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),we(l.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${l.rank}.`),we(c.shape[4]===l.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${l.shape[3]}.`),we(gc(t,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),we(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),we(bb(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),we(bb(t),()=>"Error in conv3D: Strides should be larger than 0.");const f={x:c,filter:l},d={strides:t,pad:s,dataFormat:r,dilations:a},h=Ge.runKernel(jT,f,d);return u?nt(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Nz=Ye({conv3d_:oke});function lke(n,e,t,s,r){we(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,o=e,l=!1;e.rank===4&&(l=!0,o=nt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,n[0],n[1],n[2],n[3]]);const c=a[4],u=o.shape[4];we(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),we(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),we(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),we(c===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${t.shape[3]}.`),we(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const f={dy:o,filter:t},d={pad:r,strides:s,inputShape:a},h=Ge.runKernel(K4,f,d);return l?nt(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Bre=Ye({conv3DBackpropInput_:lke});function cke(n,e,t,s,r){const a=Te(n,"x","conv3dTranspose"),o=Te(e,"filter","conv3dTranspose");return Bre(t,a,o,s,r)}const Dz=Ye({conv3dTranspose_:cke});function uke(n){const t={x:Te(n,"x","cos","float32")};return Ge.runKernel(X2,t)}const Nk=Ye({cos_:uke});function fke(n){const t={x:Te(n,"x","cosh","float32")};return Ge.runKernel(Q2,t)}const JD=Ye({cosh_:fke});function dke(n,e=0,t=!1,s=!1){const a={x:Te(n,"x","cumprod")},o={axis:e,exclusive:t,reverse:s};return Ge.runKernel(X4,a,o)}const zM=Ye({cumprod_:dke});function hke(n,e=0,t=!1,s=!1){const a={x:Te(n,"x","cumsum")},o={axis:e,exclusive:t,reverse:s};return Ge.runKernel(RT,a,o)}const ZD=Ye({cumsum_:hke});function pke(n,e,t,s=!1){const r=Te(n,"x","denseBincount"),a=Te(e,"weights","denseBincount");we(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),we(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),we(t>=0,()=>`size must be non-negative, but got ${t}.`),we(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const o={x:r,weights:a},l={size:t,binaryOutput:s};return Ge.runKernel(J4,o,l)}const EN=Ye({denseBincount_:pke});function mke(n,e,t="NHWC"){const s=Te(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],a=t==="NHWC"?s.shape[2]:s.shape[3],o=t==="NHWC"?s.shape[3]:s.shape[1];we(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),we(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),we(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${s.shape}`),we(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const l={x:s},c={blockSize:e,dataFormat:t};return Ge.runKernel(Z4,l,c)}const Oz=Ye({depthToSpace_:mke});function gke(n,e,t,s,r="NHWC",a=[1,1],o){const l=Te(n,"x","depthwiseConv2d","float32"),c=Te(e,"filter","depthwiseConv2d","float32");let u=l,f=!1;l.rank===3&&(f=!0,u=nt(l,[1,l.shape[0],l.shape[1],l.shape[2]])),we(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),we(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const d=r==="NHWC"?u.shape[3]:u.shape[1];we(d===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${c.shape[2]}.`),Cu("depthwiseConv2d",s,o);const h={x:u,filter:c},p={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o},g=Ge.runKernel(FT,h,p);return f?nt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const $_=Ye({depthwiseConv2d_:gke});function yke(n){const t={x:Te(n,"x","diag")};return Ge.runKernel(nD,t)}const Ure=Ye({diag_:yke});function bke(n,e,t,s,r=[1,1],a="NHWC"){const o=Te(n,"x","dilation2d"),l=Te(e,"filter","dilation2d");we(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),we(l.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${l.rank}.`),we(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let c=o,u=!1;o.rank===3&&(c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),we(c.shape[3]===l.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${l.shape[2]}`);const f={x:c,filter:l},d={strides:t,pad:s,dilations:r},h=Ge.runKernel(zT,f,d);return u?nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Pz=Ye({dilation2d_:bke});function vb(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const a=t-1-r,o=n[a]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(a)}return s}function tl(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],a=e.length-s-1,o=e[a];(r==null||r===1&&o>1)&&t.unshift(a)}return t}function Gs(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let r=0;r<t;r++){let a=n[n.length-r-1];a==null&&(a=1);let o=e[e.length-r-1];if(o==null&&(o=1),a===1)s[t-r-1]=o;else if(o===1)s[t-r-1]=a;else if(a!==o){const l=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(l)}else s[t-r-1]=a}return s}const wke=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Gs,getBroadcastDims:vb,getReductionAxes:tl},Symbol.toStringTag,{value:"Module"}));function vke(n,e){let t=Te(n,"a","equal","string_or_numeric"),s=Te(e,"b","equal","string_or_numeric");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(BT,r)}const Ef=Ye({equal_:vke});function _ke(n,e,t){const s=Te(e,"a","where"),r=Te(t,"b","where"),a=Te(n,"condition","where","bool"),o=Gs(Gs(a.shape,s.shape),r.shape),l=sb(a,o),c=sb(s,o),u=sb(r,o),f={condition:l,t:c,e:u};return Ge.runKernel(yk,f)}const Fl=Ye({where_:_ke});function xke(n){const t={x:Te(n,"x","zerosLike")};return Ge.runKernel(Tk,t)}const Rr=Ye({zerosLike_:xke});function Cke(n,e){let t=Te(n,"a","div"),s=Te(e,"b","div");[t,s]=to(t,s);const r=cs(t,s),a=Rr(r),o=Ef(s,a);return Fl(o,a,r)}const $z=Ye({divNoNan_:Cke});function Ske(n,e){const t=Te(n,"t1","dot"),s=Te(e,"t2","dot");we((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],a=s.rank===1?s.size:s.shape[0];if(we(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),t.rank===1&&s.rank===1){const o=nt(t,[1,-1]),l=nt(s,[-1,1]),c=fr(o,l);return nt(c,[])}else if(t.rank===1&&s.rank===2){const o=nt(t,[1,-1]),l=nt(s,[s.shape[0],s.shape[1]]),c=fr(o,l);return nt(c,[c.size])}else if(t.rank===2&&s.rank===1){const o=nt(s,[-1,1]),l=fr(t,o);return nt(l,[l.size])}else{const o=nt(s,[s.shape[0],s.shape[1]]);return fr(t,o)}}const jz=Ye({dot_:Ske});function Mke(n,...e){const t=e.map((r,a)=>Te(r,`tensors${a}`,"einsum")),s={equation:n};return Ge.runKernel(rD,t,s)}const Ry=Ye({einsum_:Mke});function Tke(n){const t={x:Te(n,"x","elu","float32")};return Ge.runKernel(Z2,t)}const j_=Ye({elu_:Tke});function kke(n,e){const t=Te(n,"x","ensureShape","string_or_numeric");if(!Zse(t.shape,e))throw new Error(`EnsureShape: Shape of tensor ${t.shape} is not compatible with expected shape ${e}`);return n}const Vre=Ye({ensureShape_:kke});function Eke(n){let e=Te(n,"x","erf");we(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Cn(e,"float32"));const t={x:e};return Ge.runKernel(e_,t)}const Rz=Ye({erf_:Eke});function Fz(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function Wre(n,e,t){const s=n.length+e.length,r=[];let a=0,o=0;for(let l=0;l<s;l++)t.indexOf(l)===-1?r.push(n[a++]):r.push(e[o++]);return r}function Wl(n,e){const t=[],s=n.length;for(let a=0;a<s;a++)e.indexOf(a)===-1&&t.push(n[a]);const r=e.map(a=>n[a]);return[t,r]}function $o(n,e){const t=e.map(s=>1);return Wre(n,t,e)}function yc(n,e,t){we(Fz(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function no(n,e){if(Fz(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function T1(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function jo(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}function Ike(n,e=null,t=!1){const r={x:Te(n,"x","max")},a={reductionIndices:e,keepDims:t};return Ge.runKernel(ZT,r,a)}const bd=Ye({max_:Ike});function Ake(n,e=null,t=!1){const r={x:Te(n,"x","min")},a={axis:e,keepDims:t};return Ge.runKernel(sk,r,a)}const l2=Ye({min_:Ake});function Lke(n,e){let t=Te(n,"base","pow"),s=Te(e,"exp","pow");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(g_,r)}const Rg=Ye({pow_:Lke});function ws(n,e){if((gl(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&gl(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return S1(n,[],[],e)}function Nke(n){const t={x:Te(n,"x","sqrt","float32")};return Ge.runKernel(E_,t)}const pc=Ye({sqrt_:Nke});function Dke(n){const e=Te(n,"x","square"),t={};return Ge.runKernel("Square",{x:e},t)}const Hi=Ye({square_:Dke});function Oke(n,e=null,t=!1){let s=Te(n,"x","sum");s.dtype==="bool"&&(s=Cn(s,"int32"));const r={x:s},a={axis:e,keepDims:t};return Ge.runKernel(wk,r,a)}const Xn=Ye({sum_:Oke});function Pke(n,e="euclidean",t=null,s=!1){n=Te(n,"x","norm");const r=Gre(n,e,t);let a=r.shape;if(s){const o=dr(t,n.shape);a=$o(r.shape,o)}return nt(r,a)}function Gre(n,e,t=null){if(n.rank===0)return Go(n);if(n.rank!==1&&t===null)return Gre(nt(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Xn(Go(n),t);if(e===1/0)return bd(Go(n),t);if(e===-1/0)return l2(Go(n),t);if(e==="euclidean"||e===2)return pc(Xn(Rg(Go(n),ws(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return bd(Xn(Go(n),t[0]),t[1]-1);if(e===1/0)return bd(Xn(Go(n),t[1]),t[0]);if(e===-1/0)return l2(Xn(Go(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return pc(Xn(Hi(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const R_=Ye({norm_:Pke});function $ke(n,e=null,t=!1){return R_(n,"euclidean",e,t)}const zz=Ye({euclideanNorm_:$ke});function jke(n){const t={x:Te(n,"x","exp")};return Ge.runKernel(t_,t)}const Ku=Ye({exp_:jke});function Rke(n,e=0){const t=Te(n,"x","expandDims","string_or_numeric");we(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return Ge.runKernel(UT,s,r)}const lc=Ye({expandDims_:Rke});function Fke(n){const t={x:Te(n,"x","expm1")};return Ge.runKernel(n_,t)}const Bz=Ye({expm1_:Fke});function zke(n,e){const t=Te(n,"x","tile","string_or_numeric");we(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return Ge.runKernel(D_,s,r)}const hd=Ye({tile_:zke});function Bke(n,e,t,s="float32"){e==null&&(e=n);const r=tr([n,e],s),a=n<=e?n:e;for(let l=0;l<a;++l)r.set(1,l,l);const o=nt(r.toTensor(),[n,e]);if(t==null)return o;if(t.length===1)return hd(lc(o,0),[t[0],1,1]);if(t.length===2)return hd(lc(lc(o,0),0),[t[0],t[1],1,1]);if(t.length===3)return hd(lc(lc(lc(o,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const eO=Ye({eye_:Bke});function Uke(n){const t={x:Te(n,"x","floor","float32")};return Ge.runKernel(s_,t)}const F_=Ye({floor_:Uke});function Vke(n,e,t=0,s=0){const r=Te(n,"x","gather"),a=Te(e,"indices","gather","int32"),o={x:r,indices:a},l={axis:t,batchDims:s};return Ge.runKernel(WT,o,l)}const z_=Ye({gather_:Vke});function Wke(n,e){let t=Te(n,"a","greater","string_or_numeric"),s=Te(e,"b","greater","string_or_numeric");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(GT,r)}const Su=Ye({greater_:Wke});function Gke(n,e){let t=Te(n,"a","greaterEqual","string_or_numeric"),s=Te(e,"b","greaterEqual","string_or_numeric");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(i_,r)}const qg=Ye({greaterEqual_:Gke});function Hke(n){const t={input:Te(n,"input","imag")};return Ge.runKernel(fD,t)}const Dk=Ye({imag_:Hke});function qke(n){const t={x:Te(n,"x","isFinite")};return Ge.runKernel(o_,t)}const Uz=Ye({isFinite_:qke});function Yke(n){const t={x:Te(n,"x","isInf")};return Ge.runKernel(l_,t)}const Vz=Ye({isInf_:Yke});function Kke(n){const t={x:Te(n,"x","isNaN")};return Ge.runKernel(c_,t)}const Wz=Ye({isNaN_:Kke});function Xke(n,e=.2){const s={x:Te(n,"x","leakyRelu")},r={alpha:e};return Ge.runKernel(HT,s,r)}const Ok=Ye({leakyRelu_:Xke});function Qke(n,e){let t=Te(n,"a","less","string_or_numeric"),s=Te(e,"b","less","string_or_numeric");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(qT,r)}const c2=Ye({less_:Qke});function Jke(n,e){let t=Te(n,"a","lessEqual","string_or_numeric"),s=Te(e,"b","lessEqual","string_or_numeric");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(YT,r)}const k1=Ye({lessEqual_:Jke});function Hre(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return Ge.runKernel(dD,{},s)}function Zke(n,e=5,t=1,s=1,r=.5){const a=Te(n,"x","localResponseNormalization");we(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),we(pb(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=a,l=!1;a.rank===3&&(l=!0,o=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={x:o},u={depthRadius:e,bias:t,alpha:s,beta:r},f=Ge.runKernel(JT,c,u);return l?nt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Gz=Ye({localResponseNormalization_:Zke});function eEe(n){const t={x:Te(n,"x","log","float32")};return Ge.runKernel(u_,t)}const If=Ye({log_:eEe});function tEe(n){const t={x:Te(n,"x","log1p")};return Ge.runKernel(f_,t)}const Pk=Ye({log1p_:tEe});function nEe(n){return we(f1(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const s=Te(e,"x","tf.grad","string_or_numeric"),r=t!=null?Te(t,"dy","tf.grad"):null;return Ge.tidy(()=>{const{value:a,grads:o}=Ge.gradients(()=>n(s),[s],r);return r!=null&&mc(a.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),tO(o),o[0]})}}function sEe(n){return we(f1(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{we(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=$M(e,"args","tf.grads","string_or_numeric"),r=t!=null?Te(t,"dy","tf.grads"):null;return Ge.tidy(()=>{const{value:a,grads:o}=Ge.gradients(()=>n(...s),s,r);return r!=null&&mc(a.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),tO(o),o})}}function rEe(n){return we(f1(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{we(e instanceof jr,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),we(t==null||t instanceof jr,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=Ge.gradients(()=>n(e),[e],t);return tO(s),{grad:s[0],value:r}}}function iEe(n){return we(f1(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{we(Array.isArray(e)&&e.every(r=>r instanceof jr),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),we(t==null||t instanceof jr,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=Ge.gradients(()=>n(...e),e,t);return t!=null&&mc(s.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),tO(s.grads),s}}function qre(n,e){we(f1(n),()=>"The f passed in variableGrads(f) must be a function"),we(e==null||Array.isArray(e)&&e.every(u=>u instanceof PM),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in Ge.registeredVariables)e.push(Ge.registeredVariables[u])}const s=t?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),we(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:o,grads:l}=Ge.gradients(n,e,null,a);we(l.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),we(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const c={};return e.forEach((u,f)=>{l[f]!=null&&(c[u.name]=l[f])}),s?.forEach(u=>c[u.name]=null),{value:o,grads:c}}function Pm(n){return Ge.customGrad(n)}function tO(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function aEe(n){const t={x:Te(n,"x","neg")};return Ge.runKernel(ik,t)}const ya=Ye({neg_:aEe});function oEe(n){const t={x:Te(n,"x","softplus")};return Ge.runKernel(k_,t)}const Xb=Ye({softplus_:oEe});function lEe(n){const e=Te(n,"x","logSigmoid");return Pm(s=>({value:ya(Xb(ya(s))),gradFunc:o=>et(o,lp(ya(s)))}))(e)}const Hz=Ye({logSigmoid_:lEe});function cEe(n,e){let t=Te(n,"a","sub"),s=Te(e,"b","sub");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(A_,r)}const Bn=Ye({sub_:cEe});function uEe(n,e=-1){const t=Te(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Pm((r,a)=>{const l=bd(r,e,!0),c=Bn(r,l),u=Bn(Cn(c,"float32"),If(Xn(Ku(c),e,!0)));return a([u]),{value:u,gradFunc:(d,h)=>{const[p]=h,g=!0,b=Ku(p);return Bn(d,et(Xn(d,e,g),b))}}})(t)}const nO=Ye({logSoftmax_:uEe});function fEe(n,e=null,t=!1){const s=Te(n,"x","logSumExp"),r=dr(e,s.shape),a=bd(s,r,!0),o=Bn(s,a),l=Ku(o),c=Xn(l,r),u=If(c),f=ln(nt(a,u.shape),u);if(t){const d=$o(f.shape,r);return nt(f,d)}return f}const $k=Ye({logSumExp_:fEe});function dEe(n,e){const t=Te(n,"a","logicalAnd","bool"),s=Te(e,"b","logicalAnd","bool");Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(KT,r)}const gh=Ye({logicalAnd_:dEe});function hEe(n){const t={x:Te(n,"x","logicalNot","bool")};return Ge.runKernel(XT,t)}const jk=Ye({logicalNot_:hEe});function pEe(n,e){const t=Te(n,"a","logicalOr","bool"),s=Te(e,"b","logicalOr","bool");Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(QT,r)}const sO=Ye({logicalOr_:pEe});function mEe(n,e){const t=Te(n,"a","logicalXor","bool"),s=Te(e,"b","logicalXor","bool");return Gs(t.shape,s.shape),gh(sO(n,e),jk(gh(n,e)))}const qz=Ye({logicalXor_:mEe});const EI=2147483648;function gEe(n,e,t="left"){const s=Te(n,"sortedSequence","searchSorted"),r=Te(e,"values","searchSorted"),a=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],l=nt(s,[-1,a]),c=nt(r,[-1,o]);if(l.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(l.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ot(c.shape)>=EI)throw new Error(`values tensor size must less than ${EI}`);if(l.shape[1]>=EI)throw new Error(`trailing dim_size must less than ${EI} for int32 output type, was ${l.shape[1]}`);const u={sortedSequence:l,values:c},f={side:t};return Ge.runKernel(AD,u,f)}const rO=Ye({searchSorted_:gEe});function Yre(n,e){return rO(n,e,"left")}function yEe(n,e,t,s,r){const a=Te(n,"x","maxPool"),o=1;let l=a,c=!1;a.rank===3&&(c=!0,l=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),we(l.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.rank}.`),we(gc(t,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),Cu("maxPool",s,r);const u={x:l},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r},d=Ge.runKernel(ek,u,f);return c?nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Rk=Ye({maxPool_:yEe});function bEe(n,e=[1,1,1],t,s,r,a="NDHWC"){const o=Te(n,"x","maxPool3d");let l=o,c=!1;o.rank===4&&(c=!0,l=nt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),we(l.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),we(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Cu("maxPool3d",s,r);const u={x:l},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:a},d=Ge.runKernel(tk,u,f);return c?nt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Yz=Ye({maxPool3d_:bEe});function wEe(n,e,t,s,r=!1){const o={x:Te(n,"x","maxPoolWithArgmax")},l={filterSize:e,strides:t,pad:s,includeBatchInIndex:r},c=Ge.runKernel(gD,o,l);return{result:c[0],indexes:c[1]}}const Kre=Ye({maxPoolWithArgmax_:wEe});function vEe(n,e){let t=Te(n,"a","maximum"),s=Te(e,"b","maximum");[t,s]=to(t,s),t.dtype==="bool"&&(t=Cn(t,"int32"),s=Cn(s,"int32")),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(d_,r)}const Fm=Ye({maximum_:vEe});function _Ee(n,e=null,t=!1){const r={x:Te(n,"x","mean")},a={axis:e,keepDims:t};return Ge.runKernel(nk,r,a)}const Ja=Ye({mean_:_Ee});function Xo(n,e="float32"){if(Df(n),e==="complex64"){const s=Xo(n,"float32"),r=Xo(n,"float32");return $g(s,r)}const t=hc(Ot(n),e);return Ge.makeTensor(t,n,e)}function Fu(n,e="float32"){if(Df(n),e==="complex64"){const s=Fu(n,"float32"),r=Xo(n,"float32");return $g(s,r)}const t=F4(Ot(n),e);return Ge.makeTensor(t,n,e)}function Xre(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=Te(n,"x","meshgrid",n instanceof jr?n.dtype:"float32");if(e===void 0)return[s];let r=Te(e,"y","meshgrid",e instanceof jr?e.dtype:"float32");const a=Ot(s.shape),o=Ot(r.shape);return t==="xy"?(s=nt(s,[1,-1]),r=nt(r,[-1,1]),[fr(Fu([o,1],s.dtype),s),fr(r,Fu([1,a],r.dtype))]):(s=nt(s,[-1,1]),r=nt(r,[1,-1]),[fr(s,Fu([1,o],s.dtype)),fr(Fu([a,1],r.dtype),r)])}function xEe(n,e){let t=Te(n,"a","minimum"),s=Te(e,"b","minimum");[t,s]=to(t,s),t.dtype==="bool"&&(t=Cn(t,"int32"),s=Cn(s,"int32")),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(h_,r)}const h1=Ye({minimum_:xEe});function CEe(n,e,t){we(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=Te(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");we(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let l=0;l<s.rank;l++)we(e[l].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),we(e[l][0]>=0&&e[l][0]<=s.shape[l]-r&&e[l][1]>=0&&e[l][1]<=s.shape[l]-r,()=>`Padding in dimension ${l} cannot be greater than or equal to ${s.shape[l]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:e,mode:t},o={x:s};return Ge.runKernel(rk,o,a)}const Kz=Ye({mirrorPad_:CEe});function SEe(n,e){let t=Te(n,"a","mod"),s=Te(e,"b","mod");[t,s]=to(t,s);const r={a:t,b:s};return Ge.runKernel(p_,r)}const Xz=Ye({mod_:SEe});function MEe(n,e=null,t=!1){n=Te(n,"x","moments");const s=dr(e,n.shape),r=Ja(n,s,t);let a=r.shape;t||(a=$o(r.shape,s));const o=Hi(Bn(Cn(n,"float32"),nt(r,a))),l=Ja(o,s,t);return{mean:r,variance:l}}const Fk=Ye({moments_:MEe});function TEe(n,e,t,s){const r=Te(e,"data","multiRNNCell"),a=$M(t,"c","multiRNNCell"),o=$M(s,"h","multiRNNCell");let l=r;const c=[];for(let d=0;d<n.length;d++){const h=n[d](l,a[d],o[d]);c.push(h[0]),c.push(h[1]),l=h[1]}const u=[],f=[];for(let d=0;d<c.length;d+=2)u.push(c[d]),f.push(c[d+1]);return[u,f]}const Qre=Ye({multiRNNCell_:TEe});function kEe(n,e,t,s=!1){const r=Te(n,"logits","multinomial"),a=r.size,o=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);t=t||Math.random();const c={logits:o===1?nt(r,[1,-1]):r},u={numSamples:e,seed:t,normalized:s},f=Ge.runKernel(yD,c,u);return o===1?nt(f,[f.size]):f}const Jre=Ye({multinomial_:kEe});function EEe(n,e){let t=Te(n,"a","notEqual","string_or_numeric"),s=Te(e,"b","notEqual","string_or_numeric");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s};return Ge.runKernel(ak,r)}const _b=Ye({notEqual_:EEe});function IEe(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:Te(n,"indices","oneHot","int32")},l={dtype:r,depth:e,onValue:t,offValue:s};return Ge.runKernel(lk,o,l)}const u2=Ye({oneHot_:IEe});function AEe(n){const t={x:Te(n,"x","onesLike")};return Ge.runKernel(ok,t)}const Af=Ye({onesLike_:AEe});function LEe(n,e){const t=Te(n,"v1","outerProduct"),s=Te(e,"v2","outerProduct");we(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const r=nt(t,[-1,1]),a=nt(s,[1,-1]);return fr(r,a)}const Zre=Ye({outerProduct_:LEe});function NEe(n,e,t=0){const s=Te(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},a={x:s};return Ge.runKernel(uk,a,r)}const Yg=Ye({pad_:NEe});function DEe(n,e,t=0){return we(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Yg(n,[e],t)}const eie=Ye({pad1d_:DEe});function OEe(n,e,t=0){return we(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Yg(n,e,t)}const tie=Ye({pad2d_:OEe});function PEe(n,e,t=0){return we(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Yg(n,e,t)}const nie=Ye({pad3d_:PEe});function $Ee(n,e,t=0){return we(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Yg(n,e,t)}const sie=Ye({pad4d_:$Ee});function jEe(n,e,t){const s=Te(n,"x","spaceToBatchND");we(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),we(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),we(s.shape.reduce((o,l,c)=>c>0&&c<=e.length?o&&(l+t[c-1][0]+t[c-1][1])%e[c-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},a={blockShape:e,paddings:t};return Ge.runKernel(vk,r,a)}const zk=Ye({spaceToBatchND_:jEe});function REe(n,e,t,s,r,a,o){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const l=Te(n,"x","maxPool");let c=l,u=!1;l.rank===3&&(u=!0,c=nt(l,[1,l.shape[0],l.shape[1],l.shape[2]])),we(gc(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const f=vh(c.shape,e,a,r,s),d=[f.dilationHeight,f.dilationWidth];let h;s==="same"?h=zEe([f.filterHeight,f.filterWidth],d):h=[[0,0],[0,0]];const p=d[0]===1&&d[1]===1,[g,b]=FEe([f.inHeight,f.inWidth],d,h),v=p?s:"valid",w=p?c:zk(c,d,g),S=(t==="avg"?()=>Ak(w,e,a,v,o):()=>Rk(w,e,a,v,o))(),C=p?S:Lk(S,d,b);return u?nt(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function FEe(n,e,t){const s=t.map(f=>f[0]),r=t.map(f=>f[1]),a=n.concat(s,r),o=e.map((f,d)=>(f-a[d]%f)%f),l=r.map((f,d)=>f+o[d]),c=e.map((f,d)=>[s[d],l[d]]),u=e.map((f,d)=>[0,o[d]]);return[c,u]}function zEe(n,e){const s=n.map((o,l)=>o+(o-1)*(e[l]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),a=s.map((o,l)=>o-r[l]);return s.map((o,l)=>[r[l],a[l]])}const Qz=Ye({pool_:REe});function BEe(n,e){const t=Te(n,"x","prelu"),s=Te(e,"alpha","prelu"),r={x:t,alpha:s};return Ge.runKernel(fk,r)}const Bk=Ye({prelu_:BEe});function UEe(n,e=null,t=!1){let s=Te(n,"x","prod");s.dtype==="bool"&&(s=Cn(s,"int32"));const r={x:s},a={axis:e,keepDims:t};return Ge.runKernel(dk,r,a)}const Jz=Ye({prod_:UEe});function VEe(n,e,t,s){const r=n.map((f,d)=>Te(f,`tensors${d}`,"raggedGather","int32")),a=Te(e,"paramsDenseValues","raggedGather"),o=Te(t,"indices","raggedGather","int32"),l={paramsNestedSplits:r,paramsDenseValues:a,indices:o},c={outputRaggedRank:s},u=Ge.runKernel(_D,l,c);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const rie=Ye({raggedGather_:VEe});function WEe(n,e,t){const s=Te(n,"starts","raggedRange"),r=Te(e,"limits","raggedRange",s.dtype),a=Te(t,"deltas","raggedRange",s.dtype),o={starts:s,limits:r,deltas:a},l=Ge.runKernel(xD,o);return{rtNestedSplits:l[0],rtDenseValues:l[1]}}const iie=Ye({raggedRange_:WEe});function GEe(n,e,t,s,r){const a=Te(n,"shape","raggedTensorToTensor","int32"),o=Te(e,"values","raggedTensorToTensor"),l=Te(t,"defaultValue","raggedTensorToTensor",o.dtype),c=s.map((d,h)=>Te(d,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:a,values:o,defaultValue:l,rowPartitionTensors:c},f={rowPartitionTypes:r};return Ge.runKernel(CD,u,f)}const aie=Ye({raggedTensorToTensor_:GEe});function HEe(n,e,t){Df(n);const s=Ot(n);let r=null;if(t==null||t==="float32")r=new Float32Array(s);else if(t==="int32")r=new Int32Array(s);else if(t==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let a=0;a<s;a++)r[a]=e();return Ge.makeTensor(r,n,t)}const oie=Ye({rand_:HEe});var bL={exports:{}},qEe=bL.exports,qG;function YEe(){return qG||(qG=1,(function(n){(function(e,t,s){function r(c){var u=this,f=l();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=f(" "),u.s1=f(" "),u.s2=f(" "),u.s0-=f(c),u.s0<0&&(u.s0+=1),u.s1-=f(c),u.s1<0&&(u.s1+=1),u.s2-=f(c),u.s2<0&&(u.s2+=1),f=null}function a(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function o(c,u){var f=new r(c),d=u&&u.state,h=f.next;return h.int32=function(){return f.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&a(d,f),h.state=function(){return a(f,{})}),h}function l(){var c=4022871197,u=function(f){f=String(f);for(var d=0;d<f.length;d++){c+=f.charCodeAt(d);var h=.02519603282416938*c;c=h>>>0,h-=c,h*=c,c=h>>>0,h-=c,c+=h*4294967296}return(c>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=o:this.alea=o})(qEe,n)})(bL)),bL.exports}var wL={exports:{}},KEe=wL.exports,YG;function XEe(){return YG||(YG=1,(function(n){(function(e,t,s){function r(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var d=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^d^d>>>8},l===(l|0)?c.x=l:u+=l;for(var f=0;f<u.length+64;f++)c.x^=u.charCodeAt(f)|0,c.next()}function a(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new r(l),f=c&&c.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,g=(h+p)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,f&&(typeof f=="object"&&a(f,u),d.state=function(){return a(u,{})}),d}t&&t.exports?t.exports=o:this.xor128=o})(KEe,n)})(wL)),wL.exports}var vL={exports:{}},QEe=vL.exports,KG;function JEe(){return KG||(KG=1,(function(n){(function(e,t,s){function r(l){var c=this,u="";c.next=function(){var d=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(d^d<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:u+=l;for(var f=0;f<u.length+64;f++)c.x^=u.charCodeAt(f)|0,f==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function a(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new r(l),f=c&&c.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,g=(h+p)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,f&&(typeof f=="object"&&a(f,u),d.state=function(){return a(u,{})}),d}t&&t.exports?t.exports=o:this.xorwow=o})(QEe,n)})(vL)),vL.exports}var _L={exports:{}},ZEe=_L.exports,XG;function eIe(){return XG||(XG=1,(function(n){(function(e,t,s){function r(l){var c=this;c.next=function(){var f=c.x,d=c.i,h,p;return h=f[d],h^=h>>>7,p=h^h<<24,h=f[d+1&7],p^=h^h>>>10,h=f[d+3&7],p^=h^h>>>3,h=f[d+4&7],p^=h^h<<7,h=f[d+7&7],h=h^h<<13,p^=h^h<<9,f[d]=p,c.i=d+1&7,p};function u(f,d){var h,p=[];if(d===(d|0))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[h&7]=p[h&7]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],f.x=p,f.i=0,h=256;h>0;--h)f.next()}u(c,l)}function a(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new r(l),f=c&&c.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,g=(h+p)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,f&&(f.x&&a(f,u),d.state=function(){return a(u,{})}),d}t&&t.exports?t.exports=o:this.xorshift7=o})(ZEe,n)})(_L)),_L.exports}var xL={exports:{}},tIe=xL.exports,QG;function nIe(){return QG||(QG=1,(function(n){(function(e,t,s){function r(l){var c=this;c.next=function(){var f=c.w,d=c.X,h=c.i,p,g;return c.w=f=f+1640531527|0,g=d[h+34&127],p=d[h=h+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,g=d[h]=g^p,c.i=h,g+(f^f>>>16)|0};function u(f,d){var h,p,g,b,v,w=[],x=128;for(d===(d|0)?(p=d,d=null):(d=d+"\0",p=0,x=Math.max(x,d.length)),g=0,b=-32;b<x;++b)d&&(p^=d.charCodeAt((b+32)%d.length)),b===0&&(v=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,b>=0&&(v=v+1640531527|0,h=w[b&127]^=p+v,g=h==0?g+1:0);for(g>=128&&(w[(d&&d.length||0)&127]=-1),g=127,b=512;b>0;--b)p=w[g+34&127],h=w[g=g+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,w[g]=p^h;f.w=v,f.X=w,f.i=g}u(c,l)}function a(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new r(l),f=c&&c.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,g=(h+p)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,f&&(f.X&&a(f,u),d.state=function(){return a(u,{})}),d}t&&t.exports?t.exports=o:this.xor4096=o})(tIe,n)})(xL)),xL.exports}var CL={exports:{}},sIe=CL.exports,JG;function rIe(){return JG||(JG=1,(function(n){(function(e,t,s){function r(l){var c=this,u="";c.next=function(){var d=c.b,h=c.c,p=c.d,g=c.a;return d=d<<25^d>>>7^h,h=h-p|0,p=p<<24^p>>>8^g,g=g-d|0,c.b=d=d<<20^d>>>12^h,c.c=h=h-p|0,c.d=p<<16^h>>>16^g,c.a=g-d|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):u+=l;for(var f=0;f<u.length+20;f++)c.b^=u.charCodeAt(f)|0,c.next()}function a(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new r(l),f=c&&c.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,g=(h+p)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,f&&(typeof f=="object"&&a(f,u),d.state=function(){return a(u,{})}),d}t&&t.exports?t.exports=o:this.tychei=o})(sIe,n)})(CL)),CL.exports}var SL={exports:{}};const iIe={},aIe=Object.freeze(Object.defineProperty({__proto__:null,default:iIe},Symbol.toStringTag,{value:"Module"})),oIe=X0e(aIe);var lIe=SL.exports,ZG;function cIe(){return ZG||(ZG=1,(function(n){(function(e,t,s){var r=256,a=6,o=52,l="random",c=s.pow(r,a),u=s.pow(2,o),f=u*2,d=r-1,h;function p(C,M,k){var E=[];M=M==!0?{entropy:!0}:M||{};var I=w(v(M.entropy?[C,S(t)]:C??x(),3),E),A=new g(E),D=function(){for(var L=A.g(a),P=c,j=0;L<u;)L=(L+j)*r,P*=r,j=A.g(1);for(;L>=f;)L/=2,P/=2,j>>>=1;return(L+j)/P};return D.int32=function(){return A.g(4)|0},D.quick=function(){return A.g(4)/4294967296},D.double=D,w(S(A.S),t),(M.pass||k||function(L,P,j,G){return G&&(G.S&&b(G,A),L.state=function(){return b(A,{})}),j?(s[l]=L,P):L})(D,I,"global"in M?M.global:this==s,M.state)}function g(C){var M,k=C.length,E=this,I=0,A=E.i=E.j=0,D=E.S=[];for(k||(C=[k++]);I<r;)D[I]=I++;for(I=0;I<r;I++)D[I]=D[A=d&A+C[I%k]+(M=D[I])],D[A]=M;(E.g=function(L){for(var P,j=0,G=E.i,Q=E.j,q=E.S;L--;)P=q[G=d&G+1],j=j*r+q[d&(q[G]=q[Q=d&Q+P])+(q[Q]=P)];return E.i=G,E.j=Q,j})(r)}function b(C,M){return M.i=C.i,M.j=C.j,M.S=C.S.slice(),M}function v(C,M){var k=[],E=typeof C,I;if(M&&E=="object")for(I in C)try{k.push(v(C[I],M-1))}catch{}return k.length?k:E=="string"?C:C+"\0"}function w(C,M){for(var k=C+"",E,I=0;I<k.length;)M[d&I]=d&(E^=M[d&I]*19)+k.charCodeAt(I++);return S(M)}function x(){try{var C;return h&&(C=h.randomBytes)?C=C(r):(C=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(C)),S(C)}catch{var M=e.navigator,k=M&&M.plugins;return[+new Date,e,k,e.screen,S(t)]}}function S(C){return String.fromCharCode.apply(0,C)}if(w(s.random(),t),n.exports){n.exports=p;try{h=oIe}catch{}}else s["seed"+l]=p})(typeof self<"u"?self:lIe,[],Math)})(SL)),SL.exports}var C5,eH;function uIe(){if(eH)return C5;eH=1;var n=YEe(),e=XEe(),t=JEe(),s=eIe(),r=nIe(),a=rIe(),o=cIe();return o.alea=n,o.xor128=e,o.xorwow=t,o.xorshift7=s,o.xor4096=r,o.tychei=a,C5=o,C5}var B_=uIe();const fIe=.001,lie=.1;function dIe(n,e,t){return t==null&&(t=Zz()),NR(n,e,(s,r)=>eB(s,r,t))}function Zz(){return Ge.backend.floatPrecision()===32?fIe:lie}function NR(n,e,t){let s=!0;if((gl(n)||gl(e))&&(s=!1),gl(n)&&gl(e)&&(s=!0),s){const o=n.constructor.name,l=e.constructor.name;if(o!==l)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${l}`)}if(Array.isArray(n)&&Array.isArray(e)){const o=Om(n),l=Om(e);if(!xr(o,l))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${l}]`)}const r=gl(n)?n:Dm(n),a=gl(e)?e:Dm(e);if(r.length!==a.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${a.length}.
Actual:   ${r}.
Expected: ${a}.`);for(let o=0;o<a.length;++o){const l=r[o],c=a[o];if(!t(l,c))throw new Error(`Arrays differ: actual[${o}] = ${l}, expected[${o}] = ${c}.
Actual:   ${r}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function hIe(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function pIe(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return wm(n)||wm(n[0])||wm(e)||wm(e[0])?NR(n,t,(s,r)=>s==r):NR(n,e,(s,r)=>eB(s,r,0))}function mIe(n,e,t){if(t==null&&(t=Zz()),!eB(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function eB(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function gIe(n,e,t){for(let s=0;s<n.length;s++)if(n[s]<e||n[s]>t)throw new Error(`Value out of range:${n[s]} low: ${e}, high: ${t}`)}function yIe(n,e){const t=new Float32Array(n),s=new Float32Array(e);if(t.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${t.length}`);for(let r=0;r<s.length;r++)if(t[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${t[r]} instead`)}function cie(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?cie(t):n[e]=Cm(t)}return n}function bIe(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",s=>t(e)),e.load()})}async function wIe(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const vIe=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:lie,createVideoElement:bIe,encodeStrings:cie,expectArrayBuffersEqual:yIe,expectArraysClose:dIe,expectArraysEqual:pIe,expectNumbersClose:mIe,expectPromiseToFail:hIe,expectValuesInRange:gIe,play:wIe,testEpsilon:Zz},Symbol.toStringTag,{value:"Module"}));class tB{constructor(e,t,s,r,a){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=a||Math.random();this.random=B_.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,a,o;do r=2*this.random()-1,a=2*this.random()-1,o=r*r+a*a;while(o>=1||o===0);const l=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*l,t=this.mean+this.stdDev*a*l,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class _Ie{constructor(e,t,s,r){this.alpha=e,this.beta=1/t,this.dtype=s;const a=r||Math.random();this.randu=B_.alea(a.toString()),this.randn=new tB(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,r,a,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,e=r*r,t=1-.331*e*e,s=.5*e+this.d*(1-o+Math.log(o)),a=this.randu(),a<t||Math.log(a)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class xIe{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=B_.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}function CIe(n,e,t=1,s="float32",r){if(Df(n),t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new _Ie(e,t,s,r),o=tr(n,s);for(let l=0;l<o.values.length;l++)o.values[l]=a.nextValue();return o.toTensor()}const uie=Ye({randomGamma_:CIe});function SIe(n,e=0,t=1,s,r){if(Df(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new tB(e,t,s,!1,r),o=tr(n,s);for(let l=0;l<o.values.length;l++)o.values[l]=a.nextValue();return o.toTensor()}const iO=Ye({randomNormal_:SIe});function MIe(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return iO(n,0,1,e,t)}const fie=Ye({randomStandardNormal_:MIe});function TIe(n,e=0,t=1,s="float32",r){Df(n);const a=tr(n,s),o=new xIe(e,t,null,r);for(let l=0;l<a.values.length;l++)a.values[l]=o.nextValue();return a.toTensor()}const E1=Ye({randomUniform_:TIe});function kIe(n,e,t,s){return E1(n,e,t,"int32",s)}const die=Ye({randomUniformInt_:kIe});function xb(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return Ge.runKernel(SD,{},r)}function EIe(n){const t={input:Te(n,"input","real")};return Ge.runKernel(MD,t)}const f2=Ye({real_:EIe});function IIe(n){const t={x:Te(n,"x","reciprocal")};return Ge.runKernel(y_,t)}const nB=Ye({reciprocal_:IIe});function AIe(n){const t={x:Te(n,"x","relu")};return Ge.runKernel(b_,t)}const Sp=Ye({relu_:AIe});function LIe(n){const t={x:Te(n,"x","relu6")};return Ge.runKernel(w_,t)}const aO=Ye({relu6_:LIe});function NIe(n,e){const s={x:Te(n,"x","reverse")},r={dims:e};return Ge.runKernel(gk,s,r)}const Cd=Ye({reverse_:NIe});function DIe(n){const e=Te(n,"x","reverse");return we(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Cd(e,0)}const hie=Ye({reverse1d_:DIe});function OIe(n,e){const t=Te(n,"x","reverse");return we(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Cd(t,e)}const pie=Ye({reverse2d_:OIe});function PIe(n,e){const t=Te(n,"x","reverse");return we(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Cd(t,e)}const mie=Ye({reverse3d_:PIe});function $Ie(n,e){const t=Te(n,"x","reverse");return we(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Cd(t,e)}const gie=Ye({reverse4d_:$Ie});function jIe(n){const t={x:Te(n,"x","round")};return Ge.runKernel(v_,t)}const oO=Ye({round_:jIe});function RIe(n){const t={x:Te(n,"x","rsqrt","float32")};return Ge.runKernel(__,t)}const lO=Ye({rsqrt_:RIe});function FIe(n){const t={x:Te(n,"x","selu")};return Ge.runKernel(x_,t)}const cO=Ye({selu_:FIe});function zIe(n,e,t,s,r,a=[1,1],o="NHWC"){const l=Te(n,"x","separableConv2d"),c=Te(e,"depthwiseFilter","separableConv2d"),u=Te(t,"pointwiseFilter","separableConv2d");let f=l,d=!1;if(l.rank===3&&(d=!0,f=nt(l,[1,l.shape[0],l.shape[1],l.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");we(f.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${f.rank}.`),we(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),we(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),we(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),we(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=c.shape[2],p=c.shape[3];we(u.shape[2]===h*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${u.shape[2]}.`);const g=$_(f,c,s,r,o,a),v=jg(g,u,1,"valid",o);return d?nt(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const uO=Ye({separableConv2d_:zIe});async function BIe(n,e){const t=Te(n,"x","setdiff1d"),s=Te(e,"y","setdiff1d");we(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),we(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),we(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await t.data(),a=await s.data(),o=new Set(a);let l=0;for(let f=0;f<r.length;f++)o.has(r[f])||l++;const c=new el([l],t.dtype),u=new el([l],"int32");for(let f=0,d=0;f<r.length;f++)o.has(r[f])||(c.values[d]=r[f],u.values[d]=f,d++);return[c.toTensor(),u.toTensor()]}const yie=BIe;function UIe(n){const t={x:Te(n,"x","sign")};return Ge.runKernel(M_,t)}const sB=Ye({sign_:UIe});function VIe(n){const t={x:Te(n,"x","sin","float32")};return Ge.runKernel(C_,t)}const fO=Ye({sin_:VIe});function WIe(n){const t={x:Te(n,"x","sinh")};return Ge.runKernel(S_,t)}const dO=Ye({sinh_:WIe});function GIe(n,e,t){const s=Te(n,"x","slice1d");return we(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Pr(s,[e],[t])}const Uk=Ye({slice1d_:GIe});function HIe(n,e,t){const s=Te(n,"x","slice2d");return we(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Pr(s,e,t)}const hO=Ye({slice2d_:HIe});function qIe(n,e,t){const s=Te(n,"x","slice3d");return we(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Pr(s,e,t)}const Vk=Ye({slice3d_:qIe});function YIe(n,e,t){const s=Te(n,"x","slice4d");return we(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Pr(s,e,t)}const d2=Ye({slice4d_:YIe});function KIe(n,e=-1){const t=Te(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return Ge.runKernel(xk,s,r)}const Wk=Ye({softmax_:KIe});function XIe(n){we(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Ge.runKernel(aD,e)}const Gk=Ye({fft_:XIe});function QIe(n){we(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Ge.runKernel(uD,e)}const h2=Ye({ifft_:QIe});function JIe(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=nt(n,[t,e]);s=h2(r)}else{const r=[t,2*(e-1)],a=nt(f2(n),[t,e]),o=nt(Dk(n),[t,e]),l=Cd(Pr(a,[0,1],[t,e-2]),1),c=et(Cd(Pr(o,[0,1],[t,e-2]),1),ws(-1)),u=Po([a,l],1),f=Po([o,c],1),d=nt($g(u,f),[r[0],r[1]]);s=h2(d)}if(s=f2(s),n.rank===3&&n.shape[0]!==0){const r=s,a=n.shape[0];s=nt(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const pO=Ye({irfft_:JIe});function ZIe(n,e,t=0){const r={x:Te(n,"x","split")},a={numOrSizeSplits:e,axis:t};return Ge.runKernel(_k,r,a)}const Uu=Ye({split_:ZIe});function eAe(n,e){we(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const g=n.shape.map(v=>0),b=n.shape.map(v=>v);b[n.shape.length-1]=e,r=Pr(n,g,b),t=e}else if(e!=null&&e>t){const g=n.shape.map(b=>b);g[n.shape.length-1]=e-t,r=Po([n,Xo(g)],n.shape.length-1),t=e}else r=n;const a=Rr(r),o=nt($g(r,a),[s,t]),l=Gk(o),c=Math.floor(t/2)+1,u=f2(l),f=Dk(l),d=Uu(u,[c,t-c],u.shape.length-1),h=Uu(f,[c,t-c],f.shape.length-1),p=r.shape.slice();return p[r.shape.length-1]=c,nt($g(d[0],h[0]),p)}const Hk=Ye({rfft_:eAe});function tAe(n,e){let t=Te(n,"a","squaredDifference"),s=Te(e,"b","squaredDifference");[t,s]=to(t,s),Gs(t.shape,s.shape);const r={a:t,b:s},a={};return Ge.runKernel(I_,r,a)}const mO=Ye({squaredDifference_:tAe});function nAe(n,e){const t=Te(n,"x","squeeze","string_or_numeric");return nt(t,Vg(t.shape,e).newShape)}const I1=Ye({squeeze_:nAe});function sAe(n,e=0){const t=$M(n,"tensors","stack","string_or_numeric");we(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&we(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return Ge.runKernel(ck,s,r)}const _u=Ye({stack_:sAe});function rAe(n,e=0){const s={x:Te(n,"x","step")},r={alpha:e};return Ge.runKernel(O_,s,r)}const Qb=Ye({step_:rAe});function iAe(n,e,t,s,r=0,a=0,o=0,l=0,c=0){const f={x:Te(n,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:s,beginMask:r,endMask:a,ellipsisMask:o,newAxisMask:l,shrinkAxisMask:c};return Ge.runKernel(jD,f,d)}const rB=Ye({stridedSlice_:iAe});function aAe(n){const t={x:Te(n,"x","tan","float32")};return Ge.runKernel(L_,t)}const iB=Ye({tan_:aAe});function fc(n,e){Gb(n);const t=Om(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return S1(n,null,t,e)}function s1(n,e,t){if(Gb(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Om(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return S1(n,e,s,t)}function aB(n,e,t){if(Gb(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Om(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return S1(n,e,s,t)}function bie(n,e,t){if(Gb(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Om(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return S1(n,e,s,t)}function wie(n,e,t){if(Gb(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Om(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return S1(n,e,s,t)}function vie(n,e,t){if(Gb(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Om(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,S1(n,e,s,t)}function oB(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(a+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(a+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(a+` update.rank != ${r+n.length-s}`);for(let o=0;o<r;++o)if(t.shape[o]!==e.shape[o])throw new Error(a+` updates.shape[${o}] (${t.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<t.rank-r;++o)if(t.shape[o+r]!==n[o+s])throw new Error(a+` updates.shape[${o+r}] (${t.shape[o+r]}) != shape[${o+r}] (${n[o+r]})`)}function gO(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}oB(t,e,n)}function A1(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,a=t.length;let o=1;for(let d=r;d<a;++d)o*=t[d];const l=r<1?1:r,c=Ot(e.shape)/l,u=[...gs(t.slice(0,r)),1],f=Ot(t);return{sliceRank:r,numUpdates:c,sliceSize:o,strides:u,outputSize:f}}const oAe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:A1,validateInput:gO,validateUpdateShape:oB},Symbol.toStringTag,{value:"Module"}));function lAe(n,e,t){const s=Te(n,"tensor","tensorScatterupdate"),r=Te(e,"indices","tensorScatterupdate","int32"),a=Te(t,"updates","tensorScatterupdate");if(gO(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const o={tensor:s,indices:r,updates:a},l={};return Ge.runKernel(ID,o,l)}const _ie=Ye({tensorScatterUpdate_:lAe});function cAe(n,e=1,t=!0){const s=Te(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const a={x:s},o={k:e,sorted:t},[l,c]=Ge.runKernel(BD,a,o);return{values:l,indices:c}}const lB=Ye({topk_:cAe});function uAe(n,e=0,t=1,s,r){if(Df(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new tB(e,t,s,!0,r),o=tr(n,s);for(let l=0;l<o.values.length;l++)o.values[l]=a.nextValue();return o.toTensor()}const yO=Ye({truncatedNormal_:uAe});function fAe(n,e=0){const t=Te(n,"x","unique","string_or_numeric");we(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[a,o]=Ge.runKernel(VD,s,r);return{values:a,indices:o}}const cB=Ye({unique_:fAe});function dAe(n,e,t){const s=Te(n,"x","unsortedSegmentSum"),r=Te(e,"segmentIds","unsortedSegmentSum","int32");we(pb(t),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},o={numSegments:t};return Ge.runKernel(Mk,a,o)}const bO=Ye({unsortedSegmentSum_:dAe});function hAe(n,e=0){const t=Te(n,"x","unstack","string_or_numeric");we(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return Ge.runKernel(Sk,s,r)}const Sd=Ye({unstack_:hAe});function xie(n,e){return rO(n,e,"right")}function uB(n,e=!0,t,s){return Ge.makeVariable(n,e,t,s)}function wO(n,e){const t=[];for(let a=0;a<e.length;a++)e[a]&&t.push(a);const s=tr(n,"int32"),r=tr([t.length,n.length],"int32");for(let a=0;a<t.length;a++){const o=s.indexToLoc(t[a]),l=a*n.length;r.values.set(o,l)}return r.toTensor()}async function pAe(n){const e=Te(n,"condition","whereAsync","bool"),t=await e.data(),s=wO(e.shape,t);return n!==e&&e.dispose(),s}const fB=pAe;async function mAe(n,e,t){const s=Te(n,"tensor","boolMask"),r=Te(e,"mask","boolMask","bool"),a=t??0,o=r.rank,l=s.shape;we(o>0,()=>"mask cannot be scalar"),mc(l.slice(a,a+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let b=a;b<a+o;b++)c*=l[b];const u=l.slice(0,a).concat([c],l.slice(a+o)),f=nt(s,u),d=nt(r,[-1]),h=await fB(d),p=I1(h,[1]),g=z_(f,p,a);return n!==s&&s.dispose(),e!==r&&r.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),g}const Cie=mAe;function gAe(n,e,t){const s=Te(n,"x","transpose");if(e==null&&(e=s.shape.map((o,l)=>l).reverse()),we(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{we(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:e};return s.dtype==="complex64"?wt(()=>{let o=f2(s),l=Dk(s);return o=Ge.runKernel(nb,{x:o},a),l=Ge.runKernel(nb,{x:l},a),t&&(l=ya(l)),$g(o,l)}):Ge.runKernel(nb,r,a)}const Ir=Ye({transpose_:gAe});function yAe(n,e,t,s,r=!0){const a=Te(n,"v","movingAverage"),o=Te(e,"x","movingAverage"),l=Te(t,"decay","movingAverage");_re(a,o),we(xr(a.shape,o.shape),()=>"Shape mismatch in v and x");const c=ws(1),u=Bn(c,l);let f=et(Bn(o,a),u);if(r){we(s!=null,()=>"When using zeroDebias: true, step is required.");const d=Te(s,"step","movingAverage");f=cs(f,Bn(c,Rg(l,d)))}return ln(a,f)}const Sie=Ye({movingAverage_:yAe});function bAe(n,e,t){Df(t);const s=Te(n,"indices","scatterND","int32"),r=Te(e,"updates","scatterND");gO(r,s,t);const a={indices:s,updates:r},o={shape:t};return Ge.runKernel(ED,a,o)}const Mie=Ye({scatterND_:bAe});function wAe(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,a=n.rank>1?n.shape[1]:1;if(t.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${a}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function vAe(n,e,t,s=0){Df(t);const r=Te(n,"sparseIndices","sparseToDense","int32"),a=Te(e,"sparseValues","sparseToDense","string_or_numeric"),o=Te(s,"defaultValue","sparseToDense",a.dtype);wAe(r,a,t,o);const l={sparseIndices:r,sparseValues:a,defaultValue:o},c={outputShape:t};return Ge.runKernel(PD,l,c)}const Tie=Ye({sparseToDense_:vAe});function _Ae(n,e){const t=Te(e,"indices","gatherND","int32"),r={params:Te(n,"x","gatherND","string_or_numeric"),indices:t};return Ge.runKernel(cD,r)}const kie=Ye({gatherND_:_Ae});function xAe(n,e){if(e==null)return n.shape.slice();if(xr(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}function CAe(n,e,t,s){const r=Te(n,"x","dropout");if(we(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),we(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof jr?r.clone():r;const a=xAe(r,t),o=1-e,l=cs(F_(ln(E1(a,0,1,"float32",s),o)),o);return et(r,l)}const dB=Ye({dropout_:CAe});function hB(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function vO(n,e,t){const s=1-n%2,r=new Float32Array(n);for(let a=0;a<n;++a){const o=2*Math.PI*a/(n+s-1);r[a]=e-t*Math.cos(o)}return fc(r,"float32")}async function SAe(n,e,t=1){const s=Te(n,"predictions","inTopK"),r=Te(e,"targets","inTopK");we(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),we(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),mc(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];we(t>0&&t<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${t}`);const o=await s.data(),l=await r.data(),[c,u]=[o.length/a,a],f=Bl("bool",c);for(let d=0;d<c;d++){const h=d*u,p=o.subarray(h,h+u),g=[];for(let b=0;b<p.length;b++)g.push({value:p[b],index:b});g.sort((b,v)=>v.value-b.value),f[d]=0;for(let b=0;b<t;b++)if(g[b].index===l[d]){f[d]=1;break}}return n!==s&&s.dispose(),e!==r&&r.dispose(),Tf(f,r.shape,"bool")}const Eie=SAe;function MAe(n,e,t,s,r,a="NHWC",o){let l=n;n.rank===3&&(l=nt(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=e;c.rank===3&&(c=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]])),we(l.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${l.shape}.`),we(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),we(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=a==="NHWC"?l.shape[3]:l.shape[1],f=a==="NHWC"?c.shape[3]:c.shape[1];we(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),we(f===t[3],()=>`Error in conv2dDerFilter: depth of dy (${f}) must match output depth for filter (${t[3]}).`),Cu("conv2dDerFilter",r,o);const d={x:l,dy:c},h={strides:s,pad:r,dataFormat:a,dimRoundingMode:o,filterShape:t};return Ge.runKernel(q4,d,h)}const pB=Ye({conv2DBackpropFilter_:MAe});function _O(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return et(n,Qb(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function xO(n,e){let t=e;const s=tl(n.shape,e.shape);return s.length>0&&(t=Xn(t,s)),nt(t,n.shape)}function CO(n,e,t,s){if(e==="linear")return n;if(e==="relu")return Sp(n);if(e==="elu")return j_(n);if(e==="relu6")return aO(n);if(e==="prelu")return Bk(n,t);if(e==="leakyrelu")return Ok(n,s);if(e==="sigmoid")return lp(n);throw new Error(`Unknown fused activation ${e}.`)}const SO=(n,e)=>!(n>0)||e==="linear";function TAe({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:f}){if(c=c||"linear",SO(Ge.state.gradientDepth,c)===!1){we(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=jg(n,e,t,s,r,a,o);return l!=null&&(k=ln(k,l)),CO(k,c,u,f)}const d=Te(n,"x","conv2d","float32"),h=Te(e,"filter","conv2d","float32");let p=d,g=!1;d.rank===3&&(g=!0,p=nt(d,[1,d.shape[0],d.shape[1],d.shape[2]])),we(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),we(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Cu("fused conv2d",s,o);const b=r==="NHWC"?p.shape[3]:p.shape[1];we(h.shape[2]===b,()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${h.shape[2]}.`),we(gc(t,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);const v=Vl(p.shape,h.shape,t,a,s,o);let w;l!=null&&(w=Te(l,"bias","fused conv2d"),[w]=to(w,d),r==="NHWC"?Gs(v.outShape,w.shape):(we(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),we(w.shape.length===0||w.shape[0]===v.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let x;if(u!=null){const k=u.shape;if(we(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)we(k[0]===1||k[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${v.outChannels}).`);else if(k.length===3)try{Gs(k,v.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(I)}x=Te(u,"prelu weights","fused conv2d")}const S=(k,E)=>{we(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[I,A,D,L]=E,P=_O(k,D,c);we(d1(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const j=Lz(A.shape,P,I,t,s),G=pB(A,P,I.shape,t,s),Q=[j,G];if(L!=null){const q=xO(L,P);Q.push(q)}return Q},C={x:p,filter:h,bias:w,preluActivationWeights:x},M={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o,activation:c,leakyreluAlpha:f};return l==null?Pm((E,I,A)=>{let D=Ge.runKernel(LM,C,M);return A([I,E,D]),g&&(D=nt(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:S}})(p,h):Pm((E,I,A,D)=>{let L=Ge.runKernel(LM,C,M);return D([I,E,L,A]),g&&(L=nt(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:S}})(p,h,w)}const Iie=Ye({fusedConv2d_:TAe});function kAe(n,e,t,s,r,a=[1,1],o){let l=n;n.rank===3&&(l=nt(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=e;c.rank===3&&(c=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:l,dy:c},f={strides:s,pad:r,dimRoundingMode:o,dilations:a,filterShape:t};return Ge.runKernel(eD,u,f)}const Aie=Ye({depthwiseConv2dNativeBackpropFilter_:kAe});function EAe(n,e,t,s,r,a=[1,1],o){let l=e,c=!1;e.rank===3&&(c=!0,l=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:l,filter:t},f={strides:s,pad:r,dimRoundingMode:o,dilations:a,inputShape:n},d=Ge.runKernel(tD,u,f);return c?nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Lie=Ye({depthwiseConv2dNativeBackpropInput_:EAe});function IAe({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:f}){if(SO(Ge.state.gradientDepth,c)===!1){let M=$_(n,e,t,s,r,a,o);return l!=null&&(M=ln(M,l)),CO(M,c,u,f)}const d=Te(n,"x","depthwiseConv2d","float32"),h=Te(e,"filter","depthwiseConv2d","float32");let p=d,g=!1;d.rank===3&&(g=!0,p=nt(d,[1,d.shape[0],d.shape[1],d.shape[2]])),we(p.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),we(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),we(p.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),a==null&&(a=[1,1]),we(gc(t,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Cu("fused depthwiseConv2d",s,o);const b=Vl(p.shape,h.shape,t,a,s,o,!0);let v;l!=null&&(v=Te(l,"bias","fused conv2d"),[v]=to(v,d),Gs(b.outShape,v.shape));let w;u!=null&&(w=Te(u,"prelu weights","fused depthwiseConv2d"));const x=(M,k)=>{we(d1(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[E,I,A,D]=k,L=_O(M,A,c),P=Lie(I.shape,L,E,t,s,a,o),j=Aie(I,L,E.shape,t,s,a,o);if(D!=null){const G=xO(v,L);return[P,j,G]}return[P,j]},S={x:p,filter:h,bias:v,preluActivationWeights:w},C={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o,activation:c,leakyreluAlpha:f};return l==null?Pm((k,E,I)=>{let A=Ge.runKernel(NM,S,C);return I([E,k,A]),g&&(A=nt(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:x}})(p,h):Pm((k,E,I,A)=>{let D=Ge.runKernel(NM,S,C);return A([E,k,D,I]),g&&(D=nt(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:x}})(p,h,v)}const AAe=Ye({fusedDepthwiseConv2d_:IAe});function LAe({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}){if(SO(Ge.state.gradientDepth,a)===!1){let L=fr(n,e,t,s);return r!=null&&(L=ln(L,r)),CO(L,a,o,l)}let c=Te(n,"a","fused matMul"),u=Te(e,"b","fused matMul");[c,u]=to(c,u);const f=t?c.shape[c.rank-2]:c.shape[c.rank-1],d=s?u.shape[u.rank-1]:u.shape[u.rank-2],h=t?c.shape[c.rank-1]:c.shape[c.rank-2],p=s?u.shape[u.rank-2]:u.shape[u.rank-1],g=c.shape.slice(0,-2),b=u.shape.slice(0,-2),v=Ot(g),w=Ot(b);we(f===d,()=>`Error in fused matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${c.shape} and ${u.shape} and transposeA=${t} and transposeB=${s} must match.`);const S=Gs(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,p]),C=t?nt(c,[v,f,h]):nt(c,[v,h,f]),M=s?nt(u,[w,p,d]):nt(u,[w,d,p]);let k;r!=null&&(k=Te(r,"bias","fused matMul"),[k]=to(k,c),Gs(S,k.shape));let E;o!=null&&(E=Te(o,"prelu weights","fused matMul"));const I=(L,P)=>{const[j,G,Q,q]=P,te=_O(nt(L,Q.shape),Q,a);let Z,ne;if(!t&&!s?(Z=fr(te,G,!1,!0),ne=fr(j,te,!0,!1)):!t&&s?(Z=fr(te,G,!1,!1),ne=fr(te,j,!0,!1)):t&&!s?(Z=fr(G,te,!1,!0),ne=fr(j,te,!1,!1)):(Z=fr(G,te,!0,!0),ne=fr(te,j,!0,!0)),r!=null){const le=xO(q,te);return[Z,ne,le]}else return[Z,ne]},A={a:C,b:M,bias:k,preluActivationWeights:E},D={transposeA:t,transposeB:s,activation:a,leakyreluAlpha:l};return r==null?Pm((P,j,G)=>{const Q=Ge.runKernel(AM,A,D);return G([P,j,Q]),{value:nt(Q,S),gradFunc:I}})(C,M):Pm((P,j,G,Q)=>{const q=Ge.runKernel(AM,A,D);return Q([P,j,q,G]),{value:nt(q,S),gradFunc:I}})(C,M,k)}const DR=Ye({fusedMatMul_:LAe});const Nie=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Iie,depthwiseConv2d:AAe,matMul:DR},Symbol.toStringTag,{value:"Module"}));function NAe(n){return vO(n,.54,.46)}const DAe=Ye({hammingWindow_:NAe});function OAe(n){return vO(n,.5,.5)}const Die=Ye({hannWindow_:OAe});function PAe(n,e,t,s=!1,r=0){let a=0;const o=[];for(;a+e<=n.size;)o.push(Pr(n,a,e)),a+=t;if(s)for(;a<n.size;){const l=a+e-n.size,c=Po([Pr(n,a,e-l),Kb([l],r)]);o.push(c),a+=t}return o.length===0?s1([],[0,e]):nt(Po(o),[o.length,e])}const Oie=Ye({frame_:PAe});function $Ae(n,e,t,s,r=Die){s==null&&(s=hB(e));const a=Oie(n,e,t),o=et(a,r(e));return Hk(o,s)}const jAe=Ye({stft_:$Ae});function RAe(n,e,t,s,r="bilinear",a=0){const o=Te(n,"image","cropAndResize"),l=Te(e,"boxes","cropAndResize","float32"),c=Te(t,"boxInd","cropAndResize","int32"),u=l.shape[0];we(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),we(l.rank===2&&l.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${l.shape}.`),we(c.rank===1&&c.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${l.shape}.`),we(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),we(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),we(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const f={image:o,boxes:l,boxInd:c},d={method:r,extrapolationValue:a,cropSize:s};return Ge.runKernel(Q4,f,d)}const FAe=Ye({cropAndResize_:RAe});function zAe(n){const e=Te(n,"image","flipLeftRight","float32");we(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Ge.runKernel(lD,t,{})}const BAe=Ye({flipLeftRight_:zAe});function UAe(n){const e=Te(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];we(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),we(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,hd(e,r)}const VAe=Ye({grayscaleToRGB_:UAe});function WAe(n){const e=Te(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];we(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),we(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,a=Cn(e,"float32"),o=fc([.2989,.587,.114]);let l;switch(e.rank){case 2:l=Ry("ij,j->i",a,o);break;case 3:l=Ry("ijk,k->ij",a,o);break;case 4:l=Ry("ijkl,l->ijk",a,o);break;case 5:l=Ry("ijklm,m->ijkl",a,o);break;case 6:l=Ry("ijklmn,n->ijklm",a,o);break;default:throw new Error("Not a valid tensor rank.")}return l=lc(l,-1),Cn(l,r)}const GAe=Ye({rgbToGrayscale_:WAe});function HAe(n,e,t=0,s=.5){const r=Te(n,"image","rotateWithOffset","float32");we(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},o={radians:e,fillValue:t,center:s};return Ge.runKernel(WD,a,o)}const qAe=Ye({rotateWithOffset_:HAe});function U_(n,e,t,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const o=n.shape[0];return t=Math.min(t,o),we(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),we(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),we(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),we(e.rank===1,()=>"scores must be a 1D tensor"),we(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),we(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}function YAe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const a=Te(n,"boxes","nonMaxSuppression","float32"),o=Te(e,"scores","nonMaxSuppression","float32"),l=U_(a,o,t,s,r);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const c={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return Ge.runKernel(bD,{boxes:a,scores:o},c)}const KAe=Ye({nonMaxSuppression_:YAe});function XAe(n,e,t){const s=QAe(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function QAe(n,e,t){return ZAe(n,e,t||JAe)}function JAe(n,e){return n>e?1:n<e?-1:0}function ZAe(n,e,t){let s=0,r=n.length,a=0,o=!1;for(;s<r;){a=s+(r-s>>>1);const l=t(e,n[a]);l>0?s=a+1:(r=a,o=!l)}return o?s:-s-1}function MO(n,e,t,s,r){return mB(n,e,t,s,r,0)}function TO(n,e,t,s,r,a){return mB(n,e,t,s,r,0,!1,a,!0)}function kO(n,e,t,s,r,a){return mB(n,e,t,s,r,a,!0)}function mB(n,e,t,s,r,a,o=!1,l=!1,c=!1){const u=[];for(let v=0;v<e.length;v++)e[v]>r&&u.push({score:e[v],boxIndex:v,suppressBeginIndex:0});u.sort(tH);const f=a>0?-.5/a:0,d=[],h=[];for(;d.length<t&&u.length>0;){const v=u.pop(),{score:w,boxIndex:x,suppressBeginIndex:S}=v;if(w<r)break;let C=!1;for(let M=d.length-1;M>=S;--M){const k=eLe(n,x,d[M]);if(k>=s){C=!0;break}if(v.score=v.score*tLe(s,f,k),v.score<=r)break}v.suppressBeginIndex=d.length,C||(v.score===w?(d.push(x),h.push(v.score)):v.score>r&&XAe(u,v,tH))}const p=d.length,g=t-p;l&&g>0&&(d.push(...new Array(g).fill(0)),h.push(...new Array(g).fill(0)));const b={selectedIndices:d};return o&&(b.selectedScores=h),c&&(b.validOutputs=p),b}function eLe(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),a=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),l=Math.max(s[0],s[2]),c=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),f=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),p=(l-a)*(c-o),g=(d-u)*(h-f);if(p<=0||g<=0)return 0;const b=Math.max(a,u),v=Math.max(o,f),w=Math.min(l,d),x=Math.min(c,h),S=Math.max(w-b,0)*Math.max(x-v,0);return S/(p+g-S)}function tLe(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function tH(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}async function nLe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const a=Te(n,"boxes","nonMaxSuppressionAsync"),o=Te(e,"scores","nonMaxSuppressionAsync"),l=U_(a,o,t,s,r);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const c=await Promise.all([a.data(),o.data()]),u=c[0],f=c[1],{selectedIndices:d}=MO(u,f,t,s,r);return a!==n&&a.dispose(),o!==e&&o.dispose(),fc(d,"int32")}const sLe=nLe;function rLe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const o=Te(n,"boxes","nonMaxSuppression"),l=Te(e,"scores","nonMaxSuppression"),c=U_(o,l,t,s,r,a);t=c.maxOutputSize,s=c.iouThreshold,r=c.scoreThreshold,a=c.softNmsSigma;const u={boxes:o,scores:l},f={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},d=Ge.runKernel(vD,u,f);return{selectedIndices:d[0],selectedScores:d[1]}}const iLe=Ye({nonMaxSuppressionWithScore_:rLe});async function aLe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const o=Te(n,"boxes","nonMaxSuppressionAsync"),l=Te(e,"scores","nonMaxSuppressionAsync"),c=U_(o,l,t,s,r,a);t=c.maxOutputSize,s=c.iouThreshold,r=c.scoreThreshold,a=c.softNmsSigma;const u=await Promise.all([o.data(),l.data()]),f=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=kO(f,d,t,s,r,a);return o!==n&&o.dispose(),l!==e&&l.dispose(),{selectedIndices:fc(h,"int32"),selectedScores:fc(p)}}const oLe=aLe;function lLe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const o=Te(n,"boxes","nonMaxSuppression"),l=Te(e,"scores","nonMaxSuppression"),c=U_(o,l,t,s,r,null),u=c.maxOutputSize,f=c.iouThreshold,d=c.scoreThreshold,h={boxes:o,scores:l},p={maxOutputSize:u,iouThreshold:f,scoreThreshold:d,padToMaxOutputSize:a},g=Ge.runKernel(wD,h,p);return{selectedIndices:g[0],validOutputs:g[1]}}const cLe=Ye({nonMaxSuppressionPadded_:lLe});async function uLe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const o=Te(n,"boxes","nonMaxSuppressionAsync"),l=Te(e,"scores","nonMaxSuppressionAsync"),c=U_(o,l,t,s,r,null),u=c.maxOutputSize,f=c.iouThreshold,d=c.scoreThreshold,[h,p]=await Promise.all([o.data(),l.data()]),{selectedIndices:g,validOutputs:b}=TO(h,p,u,f,d,a);return o!==n&&o.dispose(),l!==e&&l.dispose(),{selectedIndices:fc(g,"int32"),validOutputs:ws(b,"int32")}}const fLe=uLe;function dLe(n,e,t=!1,s=!1){const r=Te(n,"images","resizeBilinear");we(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),we(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),we(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,o=!1;r.rank===3&&(o=!0,a=nt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},c={alignCorners:t,halfPixelCenters:s,size:e},u=Ge.runKernel(mk,l,c);return o?nt(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Pie=Ye({resizeBilinear_:dLe});function hLe(n,e,t=!1,s=!1){const r=Te(n,"images","resizeNearestNeighbor");we(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),we(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),we(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),we(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,o=!1;r.rank===3&&(o=!0,a=nt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},c={alignCorners:t,halfPixelCenters:s,size:e},u=Ge.runKernel(pk,l,c);return o?nt(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const $ie=Ye({resizeNearestNeighbor_:hLe});function pLe(n,e="binary",t=!1,s=.5){const r=Te(n,"image","threshold"),a=.2989,o=.587,l=.114,c=r.shape[0]*r.shape[1];let u=et(fc([s]),255),f,d,h,p;if(we(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),we(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),we(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),we(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[f,d,h]=Uu(r,[1,1,1],-1);const v=et(f,a),w=et(d,o),x=et(h,l);p=ln(ln(v,w),x)}else p=n;if(e==="otsu"){const v=Mz(Cn(oO(p),"int32"),Tf([]),256);u=mLe(v,c)}const g=t?k1(p,u):Su(p,u);return Cn(et(g,255),"int32")}function mLe(n,e){let t=fc([-1]),s=fc([0]),r=fc([0]),a,o,l,c,u,f;for(let d=0;d<n.size-1;d++){a=Pr(n,0,d+1),o=Pr(n,d+1),u=cs(Xn(a),e),f=cs(Xn(o),e);const h=Xn(et(a,xb(0,a.size)));l=cs(h,Xn(a));const p=Kb(o.shape,a.size),g=ln(xb(0,o.size),p),b=et(o,g);c=cs(Xn(b),Xn(o));const v=Bn(l,c),w=Bn(l,c),x=et(u,f);r=et(et(x,v),w);const S=Su(r,s);s=Fl(S,r,s),t=Fl(S,fc([d]),t)}return t}const gLe=Ye({threshold_:pLe});function yLe(n,e,t="nearest",s="constant",r=0,a){const o=Te(n,"image","transform","float32"),l=Te(e,"transforms","transform","float32");we(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),we(l.rank===2&&(l.shape[0]===o.shape[0]||l.shape[0]===1)&&l.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),we(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const c={image:o,transforms:l},u={interpolation:t,fillMode:s,fillValue:r,outputShape:a};return Ge.runKernel(UD,c,u)}const bLe=Ye({transform_:yLe});function wLe(n,e,t){const s=Te(n,"a","bandPart");we(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,o]=s.shape.slice(-2);let l,c;typeof e=="number"?(we(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),we(e<=a,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`),l=Te(e<0?a:e,"numLower","bandPart")):(we(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),l=Fl(c2(e,0),a,h1(e,a))),typeof t=="number"?(we(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),we(t<=o,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${o}).`),c=Te(t<0?o:t,"numUpper","bandPart")):(we(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),c=Fl(c2(t,0),o,h1(t,o)));const u=nt(xb(0,a,1,"int32"),[-1,1]),f=xb(0,o,1,"int32"),d=Bn(u,f),h=gh(k1(d,l),qg(d,ya(c))),p=Xo([a,o],s.dtype);return nt(_u(Sd(nt(s,[-1,a,o])).map(g=>Fl(h,g,p))),r)}const vLe=Ye({bandPart_:wLe});function _Le(n){let e;if(Array.isArray(n)){e=!1,we(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let a=1;a<n.length;++a)we(n[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[a].shape[0]} vs. ${r})`)}else e=!0,n=Uu(n,n.shape[0],0).map(r=>I1(r,[0]));we(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(Ge.tidy(()=>{let a=s[r];if(r>0)for(let o=0;o<r;++o){const l=et(Xn(et(t[o],a)),t[o]);a=Bn(a,l)}return cs(a,R_(a,"euclidean"))}));return e?_u(t,0):t}const xLe=Ye({gramSchmidt_:_Le});function CLe(n,e=!1){if(we(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return nH(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((c,u)=>c*u),s=Sd(nt(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],a=[];s.forEach(c=>{const[u,f]=nH(c,e);r.push(u),a.push(f)});const o=nt(_u(r,0),n.shape),l=nt(_u(a,0),n.shape);return[o,l]}}function nH(n,e=!1){return Ge.tidy(()=>{we(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=eO(t),a=Sm(n);const o=s1([[1]],[1,1]);let l=Sm(o);const c=t>=s?s:t;for(let u=0;u<c;++u){const f=a,d=l,h=r;[l,a,r]=Ge.tidy(()=>{const p=Pr(a,[u,u],[t-u,1]),g=R_(p),b=Pr(a,[u,u],[1,1]),v=Fl(Su(b,0),s1([[-1]]),s1([[1]])),w=Bn(b,et(v,g)),x=cs(p,w);x.shape[0]===1?l=Sm(o):l=Po([o,Pr(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const S=ya(cs(fr(v,w),g)),C=Pr(a,[u,0],[t-u,s]),M=et(S,l),k=Ir(l);if(u===0)a=Bn(C,fr(M,fr(k,C)));else{const A=Bn(C,fr(M,fr(k,C)));a=Po([Pr(a,[0,0],[u,s]),A],0)}const E=Ir(M),I=Pr(r,[0,u],[t,r.shape[1]-u]);if(u===0)r=Bn(I,fr(fr(I,l),E));else{const A=Bn(I,fr(fr(I,l),E));r=Po([Pr(r,[0,0],[t,u]),A],1)}return[l,a,r]}),Ws([f,d,h])}return!e&&t>s&&(r=Pr(r,[0,0],[t,s]),a=Pr(a,[0,0],[s,s])),[r,a]})}const SLe=Ye({qr_:CLe});var mu;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(mu||(mu={}));function MLe(n,e,t=mu.SUM_BY_NONZERO_WEIGHTS){const s=Te(n,"losses","computeWeightedLoss");let r=null;e!=null&&(r=Te(e,"weights","computeWeightedLoss"));const a=r==null?s:et(s,r);if(t===mu.NONE)return a;if(t===mu.SUM)return Xn(a);if(t===mu.MEAN){if(r==null)return Ja(a);{const o=s.size/r.size,l=cs(Xn(a),Xn(r));return o>1?cs(l,ws(o)):l}}if(t===mu.SUM_BY_NONZERO_WEIGHTS){if(r==null)return cs(Xn(a),ws(s.size));{const o=et(r,Fu(s.shape)),l=Cn(Xn(_b(o,ws(0))),"float32");return cs(Xn(a),l)}}throw Error(`Unknown reduction: ${t}`)}const Kg=Ye({computeWeightedLoss_:MLe});function TLe(n,e,t,s=mu.SUM_BY_NONZERO_WEIGHTS){const r=Te(n,"labels","absoluteDifference"),a=Te(e,"predictions","absoluteDifference");let o=null;t!=null&&(o=Te(t,"weights","absoluteDifference")),mc(r.shape,a.shape,"Error in absoluteDifference: ");const l=Go(Bn(r,a));return Kg(l,o,s)}const kLe=Ye({absoluteDifference_:TLe});function ELe(n,e,t,s,r=mu.SUM_BY_NONZERO_WEIGHTS){const a=Te(n,"labels","cosineDistance"),o=Te(e,"predictions","cosineDistance");let l=null;s!=null&&(l=Te(s,"weights","cosineDistance")),mc(a.shape,o.shape,"Error in cosineDistance: ");const c=ws(1),u=Bn(c,Xn(et(a,o),t,!0));return Kg(u,l,r)}const ILe=Ye({cosineDistance_:ELe});function ALe(n,e,t,s=mu.SUM_BY_NONZERO_WEIGHTS){let r=Te(n,"labels","hingeLoss");const a=Te(e,"predictions","hingeLoss");let o=null;t!=null&&(o=Te(t,"weights","hingeLoss")),mc(r.shape,a.shape,"Error in hingeLoss: ");const l=ws(1);r=Bn(et(ws(2),r),l);const c=Sp(Bn(l,et(r,a)));return Kg(c,o,s)}const LLe=Ye({hingeLoss_:ALe});function NLe(n,e,t,s=1,r=mu.SUM_BY_NONZERO_WEIGHTS){const a=Te(n,"labels","huberLoss"),o=Te(e,"predictions","huberLoss");let l=null;t!=null&&(l=Te(t,"weights","huberLoss")),mc(a.shape,o.shape,"Error in huberLoss: ");const c=ws(s),u=Go(Bn(o,a)),f=h1(u,c),d=Bn(u,f),h=ln(et(ws(.5),Hi(f)),et(c,d));return Kg(h,l,r)}const DLe=Ye({huberLoss_:NLe});function OLe(n,e,t,s=1e-7,r=mu.SUM_BY_NONZERO_WEIGHTS){const a=Te(n,"labels","logLoss"),o=Te(e,"predictions","logLoss");let l=null;t!=null&&(l=Te(t,"weights","logLoss")),mc(a.shape,o.shape,"Error in logLoss: ");const c=ws(1),u=ws(s),f=ya(et(a,If(ln(o,u)))),d=et(Bn(c,a),If(ln(Bn(c,o),u))),h=Bn(f,d);return Kg(h,l,r)}const PLe=Ye({logLoss_:OLe});function $Le(n,e,t,s=mu.SUM_BY_NONZERO_WEIGHTS){const r=Te(n,"labels","meanSquaredError"),a=Te(e,"predictions","meanSquaredError");let o=null;t!=null&&(o=Te(t,"weights","meanSquaredError")),mc(r.shape,a.shape,"Error in meanSquaredError: ");const l=mO(r,a);return Kg(l,o,s)}const jLe=Ye({meanSquaredError_:$Le});function RLe(n,e){const t=Te(n,"labels","sigmoidCrossEntropyWithLogits"),s=Te(e,"logits","sigmoidCrossEntropyWithLogits");mc(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Sp(s),a=et(s,t),o=Pk(Ku(ya(Go(s))));return ln(Bn(r,a),o)}function FLe(n,e,t,s=0,r=mu.SUM_BY_NONZERO_WEIGHTS){let a=Te(n,"multiClassLabels","sigmoidCrossEntropy");const o=Te(e,"logits","sigmoidCrossEntropy");let l=null;if(t!=null&&(l=Te(t,"weights","sigmoidCrossEntropy")),mc(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=ws(s),f=ws(1),d=ws(.5);a=ln(et(a,Bn(f,u)),et(d,u))}const c=RLe(a,o);return Kg(c,l,r)}const zLe=Ye({sigmoidCrossEntropy_:FLe});function BLe(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Pm((r,a,o)=>{const c=$k(a,[t],!0),u=Bn(Cn(a,"float32"),c);o([r,u]);const f=ya(et(u,r));return{value:Xn(f,[t]),gradFunc:(p,g)=>{const[b,v]=g,w=$o(p.shape,[t]);return[et(nt(p,w),Bn(Cn(b,"float32"),Ku(v))),et(nt(p,w),Bn(Ku(v),Cn(b,"float32")))]}}})(n,e)}function ULe(n,e,t,s=0,r=mu.SUM_BY_NONZERO_WEIGHTS){let a=Te(n,"onehotLabels","softmaxCrossEntropy");const o=Te(e,"logits","softmaxCrossEntropy");let l=null;if(t!=null&&(l=Te(t,"weights","softmaxCrossEntropy")),mc(a.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const u=ws(s),f=ws(1),d=ws(a.shape[1]);a=ln(et(a,Bn(f,u)),cs(u,d))}const c=BLe(a,o);return Kg(c,l,r)}const VLe=Ye({softmaxCrossEntropy_:ULe});function WLe(n,e,t,s){const r=Te(n,"indices","sparseFillEmptyRows","int32"),a=Te(e,"values","sparseFillEmptyRows"),o=Te(t,"denseShape","sparseFillEmptyRows","int32"),l=Te(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(l.rank!==0)throw new Error(`Default value should be a scalar but received shape ${l.shape}`);const c={indices:r,values:a,denseShape:o,defaultValue:l},u=Ge.runKernel(LD,c);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const GLe=Ye({sparseFillEmptyRows_:WLe});function HLe(n,e,t){const s=Te(n,"inputIndices","sparseReshape","int32"),r=Te(e,"inputShape","sparseReshape","int32"),a=Te(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const o={inputIndices:s,inputShape:r,newShape:a},l=Ge.runKernel(ND,o);return{outputIndices:l[0],outputShape:l[1]}}const qLe=Ye({sparseReshape_:HLe});function YLe(n,e,t){const s=Te(n,"data","sparseSegmentMean"),r=Te(e,"indices","sparseSegmentMean","int32"),a=Te(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const o={data:s,indices:r,segmentIds:a};return Ge.runKernel(DD,o)}const KLe=Ye({sparseSegmentMean_:YLe});function XLe(n,e,t){const s=Te(n,"data","sparseSegmentSum"),r=Te(e,"indices","sparseSegmentSum","int32"),a=Te(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const o={data:s,indices:r,segmentIds:a};return Ge.runKernel(OD,o)}const QLe=Ye({sparseSegmentSum_:XLe});function JLe(n,e,t,s,r,a,o,l){const c=Te(n,"data","stringNGrams","string");if(c.dtype!=="string")throw new Error("Data must be of datatype string");if(c.shape.length!==1)throw new Error(`Data must be a vector, saw: ${c.shape}`);const u=Te(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const f={separator:t,nGramWidths:s,leftPad:r,rightPad:a,padWidth:o,preserveShortSequences:l},d={data:c,dataSplits:u},h=Ge.runKernel(RD,d,f);return{nGrams:h[0],nGramsSplits:h[1]}}const ZLe=Ye({stringNGrams_:JLe});function eNe(n,e,t=!0){const s=Te(n,"input","stringSplit","string"),r=Te(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:t},o={input:s,delimiter:r},l=Ge.runKernel(FD,o,a);return{indices:l[0],values:l[1],shape:l[2]}}const tNe=Ye({stringSplit_:eNe});function nNe(n,e){const t=Te(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:t};return Ge.runKernel(zD,r,s)}const sNe=Ye({stringToHashBucketFast_:nNe});function rNe(n,e,t,s=!0){const r=Te(n,"input","staticRegexReplace","string"),a={pattern:e,rewrite:t,replaceGlobal:s};return Ge.runKernel(Ck,{x:r},a)}const iNe=Ye({staticRegexReplace_:rNe});const jie={fft:Gk,ifft:h2,rfft:Hk,irfft:pO},Rie={hammingWindow:DAe,hannWindow:Die,frame:Oie,stft:jAe},ch={flipLeftRight:BAe,grayscaleToRGB:VAe,resizeNearestNeighbor:$ie,resizeBilinear:Pie,rgbToGrayscale:GAe,rotateWithOffset:qAe,cropAndResize:FAe,nonMaxSuppression:KAe,nonMaxSuppressionAsync:sLe,nonMaxSuppressionWithScore:iLe,nonMaxSuppressionWithScoreAsync:oLe,nonMaxSuppressionPadded:cLe,nonMaxSuppressionPaddedAsync:fLe,threshold:gLe,transform:bLe},gB={bandPart:vLe,gramSchmidt:xLe,qr:SLe},Fie={absoluteDifference:kLe,computeWeightedLoss:Kg,cosineDistance:ILe,hingeLoss:LLe,huberLoss:DLe,logLoss:PLe,meanSquaredError:jLe,sigmoidCrossEntropy:zLe,softmaxCrossEntropy:VLe},zie={sparseFillEmptyRows:GLe,sparseReshape:qLe,sparseSegmentMean:KLe,sparseSegmentSum:QLe},Bie={stringNGrams:ZLe,stringSplit:tNe,stringToHashBucketFast:sNe,staticRegexReplace:iNe};const aNe=new Map,OR=new Map;class Jb{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class ud{constructor(){this.classNameMap={}}static getMap(){return ud.instance==null&&(ud.instance=new ud),ud.instance}static register(e){ud.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function fn(n,e,t){we(n.className!=null,()=>"Class being registered does not have the static className property defined."),we(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),we(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,r=e+">"+s;return ud.register(n),aNe.set(r,n),OR.set(n,r),n}function oNe(n){return OR.has(n)?OR.get(n):n.className}const lNe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Jb,SerializationMap:ud,getRegisteredName:oNe,registerClass:fn},Symbol.toStringTag,{value:"Module"}));class Xg extends Jb{minimize(e,t=!1,s){const{value:r,grads:a}=this.computeGradients(e,s);if(s!=null){const o=s.map(l=>({name:l.name,tensor:a[l.name]}));this.applyGradients(o)}else this.applyGradients(a);return Ws(a),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return qre(e,t)}dispose(){this.iterations_!=null&&Ws(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ws(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Xg,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});class yB extends Xg{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=Ge.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Ge.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:wt(()=>Rr(a).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:wt(()=>Rr(a).variable(o))});const l=Array.isArray(e)?e[r].tensor:e[s];if(l==null)return;const c=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;wt(()=>{const f=ln(et(c,this.rho),et(Hi(l),1-this.rho)),d=et(cs(pc(ln(u,this.epsilon)),pc(ln(c,this.epsilon))),l),h=ln(et(u,this.rho),et(Hi(d),1-this.rho));c.assign(f),u.assign(h);const p=ln(et(d,-this.learningRate),a);a.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ws(this.accumulatedGrads.map(e=>e.variable)),Ws(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}class bB extends Xg{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Ge.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:wt(()=>Kb(a.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable;wt(()=>{const c=ln(l,Hi(o));l.assign(c);const u=ln(et(cs(o,pc(ln(c,Ge.backend.epsilon()))),-this.learningRate),a);a.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ws(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}class wB extends Xg{static get className(){return"Adam"}constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],wt(()=>{this.accBeta1=ws(t).variable(),this.accBeta2=ws(s).variable()}),r==null&&(this.epsilon=Ge.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);wt(()=>{const s=Bn(1,this.accBeta1),r=Bn(1,this.accBeta2);t.forEach((a,o)=>{const l=Ge.registeredVariables[a],c=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:wt(()=>Rr(l).variable(c))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${a}/v`,variable:wt(()=>Rr(l).variable(c))});const u=Array.isArray(e)?e[o].tensor:e[a];if(u==null)return;const f=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=ln(et(f,this.beta1),et(u,1-this.beta1)),p=ln(et(d,this.beta2),et(Hi(u),1-this.beta2)),g=cs(h,s),b=cs(p,r);f.assign(h),d.assign(p);const v=ln(et(cs(g,ln(pc(b),this.epsilon)),-this.learningRate),l);l.assign(v)}),this.accBeta1.assign(et(this.accBeta1,this.beta1)),this.accBeta2.assign(et(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ws(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ws(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),wt(()=>{this.accBeta1.assign(Rg(this.beta1,this.iterations_+1)),this.accBeta2.assign(Rg(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}class vB extends Xg{static get className(){return"Adamax"}constructor(e,t,s,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],wt(()=>{this.iteration=ws(0).variable(),this.accBeta1=ws(t).variable()}),r==null&&(this.epsilon=Ge.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);wt(()=>{const s=Bn(1,this.accBeta1),r=cs(-this.learningRate,ln(et(this.iteration,this.decay),1));t.forEach((a,o)=>{const l=Ge.registeredVariables[a],c=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:Rr(l).variable(c)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${a}/v`,variable:Rr(l).variable(c)});const u=Array.isArray(e)?e[o].tensor:e[a];if(u==null)return;const f=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=ln(et(f,this.beta1),et(u,1-this.beta1)),p=et(d,this.beta2),g=Go(u),b=Fm(p,g);f.assign(h),d.assign(b);const v=ln(et(cs(r,s),cs(h,ln(b,this.epsilon))),l);l.assign(v)}),this.iteration.assign(ln(this.iteration,1)),this.accBeta1.assign(et(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ws(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ws(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class EO extends Xg{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const o=Ge.registeredVariables[s];wt(()=>{const l=ln(et(this.c,a),o);o.assign(l)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=bl(ws(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class _B extends EO{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=ws(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Ge.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:wt(()=>Rr(a).variable(!1))});const o=this.accumulations[r].variable,l=Array.isArray(e)?e[r].tensor:e[s];l!=null&&wt(()=>{let c;const u=ln(et(this.m,o),l);this.useNesterov?c=ln(et(this.c,ln(l,et(u,this.m))),a):c=ln(et(this.c,u),a),o.assign(u),a.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ws(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class xB extends Xg{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=Ge.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Ge.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:wt(()=>Rr(a).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:wt(()=>Rr(a).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:wt(()=>Rr(a).variable(o))});const l=Array.isArray(e)?e[r].tensor:e[s];if(l==null)return;const c=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;wt(()=>{const f=ln(et(c,this.decay),et(Hi(l),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=ln(et(d,this.decay),et(l,1-this.decay)),p=cs(et(l,this.learningRate),pc(Bn(f,ln(Hi(h),this.epsilon)))),g=ln(et(u,this.momentum),p);c.assign(f),d.assign(h),u.assign(g);const b=Bn(a,g);a.assign(b)}else{const d=ln(et(c,this.decay),et(Hi(l),1-this.decay)),h=ln(et(u,this.momentum),cs(et(l,this.learningRate),pc(ln(d,this.epsilon))));c.assign(d),u.assign(h);const p=Bn(a,h);a.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ws(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ws(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ws(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const cNe=[yB,bB,wB,vB,_B,xB,EO];function uNe(){for(const n of cNe)fn(n)}const fNe="model",dNe=".json",hNe=".weights.bin";function sH(n){return new Promise(e=>setTimeout(e)).then(n)}class Cb{constructor(e){if(!bt().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Cb.URL_SCHEME)&&(e=e.slice(Cb.URL_SCHEME.length)),(e==null||e.length===0)&&(e=fNe),this.modelJsonFileName=e+dNe,this.weightDataFileName=e+hNe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=Cp.join(e.weightData),s=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=Tre(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),l=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(l.download=this.modelJsonFileName,l.href=o,await sH(()=>l.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=s,await sH(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ek(e)}}}}Cb.URL_SCHEME="downloads://";class pNe{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),o=a.modelTopology;if(o==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const c=lz(a,u=>this.loadWeights(u));e(c)},s.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const o of e)t.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(e),a=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(a).then(o=>[t,o])}loadWeightsFile(e,t){return new Promise((s,r)=>{const a=new FileReader;a.onload=o=>{const l=o.target.result;s(l)},a.onerror=o=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(a=>HG(a.name)),r={};for(const a of e)a.paths.forEach(o=>{const l=HG(o);if(t.indexOf(l)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${l}'`);if(t.push(l),s.indexOf(l)===-1)throw new Error(`Weight file with basename '${l}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(l)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const mNe=n=>bt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Cb.URL_SCHEME)?gNe(n.slice(Cb.URL_SCHEME.length)):null;Xa.registerSaveRouter(mNe);function gNe(n="model"){return new Cb(n)}function yNe(n){return new pNe(n)}function rH(n,e,t,s){o(n),t=t??0,s=s??1,l(t,s);let r=0;const a=c=>(c.then(u=>{const f=t+ ++r/n.length*(s-t);return e(f),u}),c);function o(c){we(c!=null&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")}function l(c,u){we(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),we(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),we(u>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${u}`)}return Promise.all(n.map(a))}async function Uie(n,e){e==null&&(e={});const t=e.fetchFunc==null?bt().platform.fetch:e.fetchFunc,s=n.map(d=>t(d,e.requestInit,{isBinary:!0})),l=(e.onProgress==null?await Promise.all(s):await rH(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(l):await rH(l,e.onProgress,.5,1)}async function Vie(n,e="",t,s){return Wie(o=>Uie(o,{requestInit:s}))(n,e,t)}function Wie(n){return async(e,t="",s)=>{const r=e.map(()=>!1),a={},o=s!=null?s.map(()=>!1):[],l=[];if(e.forEach((p,g)=>{let b=0;p.weights.forEach(v=>{const w="quantization"in v?v.quantization.dtype:v.dtype,x=MR[w]*Ot(v.shape),S=()=>{r[g]=!0,a[g]==null&&(a[g]=[]),a[g].push({manifestEntry:v,groupOffset:b,sizeBytes:x})};s!=null?s.forEach((C,M)=>{C===v.name&&(S(),o[M]=!0)}):S(),l.push(v.name),b+=x})}),!o.every(p=>p)){const p=s.filter((g,b)=>!o[b]);throw new Error(`Could not find weights in manifest with names: ${p.join(", ")}. 
Manifest JSON has weights with names: ${l.join(", ")}.`)}const c=r.reduce((p,g,b)=>(g&&p.push(b),p),[]),u=[];c.forEach(p=>{e[p].paths.forEach(g=>{const b=t+(t.endsWith("/")?"":"/")+g;u.push(b)})});const f=await n(u),d={};let h=0;return c.forEach(p=>{const g=e[p].paths.length,b=new Cp(f.slice(h,h+g));a[p].forEach(w=>{const x=b.slice(w.groupOffset,w.groupOffset+w.sizeBytes),S=iz(x,[w.manifestEntry]);for(const C in S)d[C]=S[C]}),h+=g}),d}}const bNe="application/octet-stream",wNe="application/json";class CB{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(we(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=bt().platform.fetch,we(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&we(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=Tre(e,s);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:wNe}),"model.json"),e.weightData!=null){const o=Cp.join(e.weightData);t.body.append("model.weights.bin",new Blob([o],{type:bNe}),"model.weights.bin")}const a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:Ek(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=t.modelTopology,r=t.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return lz(t,a=>this.loadWeights(a))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=vNe(t),a=this.weightPathPrefix||s,o=cz(e),l=[],c=[];for(const f of e)for(const d of f.paths)this.weightUrlConverter!=null?c.push(this.weightUrlConverter(d)):l.push(a+d+r);this.weightUrlConverter&&l.push(...await Promise.all(c));const u=await Uie(l,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,u]}}CB.URL_SCHEME_REGEX=/^https?:\/\//;function vNe(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),r=t>e?n.substring(t):"";return[s+"/",r]}function PR(n){return n.match(CB.URL_SCHEME_REGEX)!=null}const Gie=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>PR(s)):t=PR(n),t)return SB(n,e)}return null};Xa.registerSaveRouter(Gie);Xa.registerLoadRouter(Gie);function SB(n,e){return new CB(n,e)}function Hie(n,e){return SB(n,e)}class S5{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class qie{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class _Ne{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function xNe(n,e,t,s){const r=arguments;return new _Ne(IN(...r))}function IN(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new S5(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new S5({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new S5({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function CNe(n){return new qie(n)}function SNe(n){return new qie(n)}const MB=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Cp,browserFiles:yNe,browserHTTPRequest:Hie,concatenateArrayBuffers:Mre,copyModel:VMe,decodeWeights:iz,encodeWeights:TR,fromMemory:xNe,fromMemorySync:IN,getLoadHandlers:Ere,getModelArtifactsForJSON:lz,getModelArtifactsForJSONSync:oz,getModelArtifactsInfoForJSON:Ek,getSaveHandlers:kre,getWeightSpecs:cz,http:SB,isHTTPScheme:PR,listModels:BMe,loadWeights:Vie,moveModel:WMe,registerLoadRouter:IMe,registerSaveRouter:EMe,removeModel:UMe,weightsLoaderFactory:Wie,withSaveHandler:CNe,withSaveHandlerSync:SNe},Symbol.toStringTag,{value:"Module"}));function MNe(n,e,t){const s=Te(n,"labels","confusionMatrix"),r=Te(e,"predictions","confusionMatrix");we(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),we(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),we(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),we(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),we(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const a=u2(Cn(s,"int32"),t),o=u2(Cn(r,"int32"),t),l=Ir(a),c=fr(l,o);return Cn(c,"int32")}const TNe=Ye({confusionMatrix_:MNe});const kNe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:TNe},Symbol.toStringTag,{value:"Module"}));let my,iH=!1;function Yie(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,s=!1,r=!1,a=!1,o=!1,l=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)a=!0;else if(n.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)l=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(OM(MN,Ge.backendName)!=null){const g={pixels:n},b={numChannels:e};return Ge.runKernel(MN,g,b)}const[u,f]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let d;if(o)d=n.getContext("2d").getImageData(0,0,u,f).data;else if(s||t)d=n.data;else if(a||r||l){if(my==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")my=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else my=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});my.canvas.width=u,my.canvas.height=f,my.drawImage(n,0,0,u,f),d=my.getImageData(0,0,u,f).data}let h;if(e===4)h=new Int32Array(d);else{const g=u*f;h=new Int32Array(g*e);for(let b=0;b<g;b++)for(let v=0;v<e;++v)h[b*e+v]=d[b*4+v]}return aB(h,[f,u,e],"int32")}function ENe(n){return n!=null&&n.data instanceof Uint8Array}function INe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function ANe(n){return n!=null&&n.width!==0&&n.height!==0}function LNe(n){return INe()&&!(n instanceof ImageBitmap)&&ANe(n)&&!ENe(n)}async function Kie(n,e=3){let t=null;if(bt().getBool("WRAP_TO_IMAGEBITMAP")&&LNe(n)){let s;try{s=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===n.width&&s.height===n.height?t=s:t=n}else t=n;return Yie(t,e)}function Xie(n){if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const e=n.rank===2?1:n.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`)}function NNe(n){const e=n?.alpha||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function DNe(n,e){let t=Te(n,"img","toPixels");if(!(n instanceof jr)){const u=t;t=Cn(u,"int32"),u.dispose()}Xie(t);const[s,r]=t.shape.slice(0,2),a=t.rank===2?1:t.shape[2],o=await t.data(),l=t.dtype==="float32"?255:1,c=new Uint8ClampedArray(r*s*4);for(let u=0;u<s*r;++u){const f=[0,0,0,255];for(let h=0;h<a;h++){const p=o[u*a+h];if(t.dtype==="float32"){if(p<0||p>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${p}.`)}else if(t.dtype==="int32"&&(p<0||p>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${p}.`);a===1?(f[0]=p*l,f[1]=p*l,f[2]=p*l):f[h]=p*l}const d=u*4;c[d+0]=Math.round(f[0]),c[d+1]=Math.round(f[1]),c[d+2]=Math.round(f[2]),c[d+3]=Math.round(f[3])}if(e!=null){iH||OM(sD,Ge.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),iH=!0),e.width=r,e.height=s;const u=e.getContext("2d"),f=new ImageData(c,r,s);u.putImageData(f,0,0)}return t!==n&&t.dispose(),c}function ONe(n,e,t){let s=Te(n,"img","draw");if(!(n instanceof jr)){const o=s;s=Cn(o,"int32"),o.dispose()}Xie(s),NNe(t?.imageOptions);const r={image:s},a={canvas:e,options:t};Ge.runKernel(sD,r,a)}const Qie=Ye({fromPixels_:Yie}),PNe=Object.freeze(Object.defineProperty({__proto__:null,draw:ONe,fromPixels:Qie,fromPixelsAsync:Kie,toPixels:DNe},Symbol.toStringTag,{value:"Module"}));function IO(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(Ot(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,a=r[r.length-1];let o=1;for(let d=0;d<r.length-1;++d)o*=r[d];const l=n.shape,c=r.slice();c.pop();let u=1;for(let d=a;d<t;++d)u*=l[d],c.push(l[d]);const f=[...gs(n.shape).map(d=>d/u),1].slice(0,a);return[c,o,u,f]}const $Ne=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:IO},Symbol.toStringTag,{value:"Module"}));const $R=-2,jNe=-1;function TB(n,e,t){const s=n.shape.length;we(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),we(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)we(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function RNe(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function kB(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function Jie(n,e,t,s){const r=[...n];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<t;a++)a===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function Zie(n,e,t){return t<=n?t:t-(e-1)}function eae(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function FNe(n,e,t,s,r,a,o,l,c){const u=n.length;let f=new Array(u),d=new Array(u),h=new Array(u);if(e.length&&t>0){const p=e[0],g=t+1;f=tae(o,p,g,s,n),d=nae(l,p,g,r,n),h=Jie(a,p,g,n)}else for(let p=0;p<u;p++)f[p]=rae(o,s,a,n,p,c),d[p]=iae(l,r,a,n,p,c),h[p]=sae(a,p,c);return{begin:f,end:d,strides:h}}function tae(n,e,t,s,r){const a=[...r],o=eae(t,e);for(let l=0;l<a.length;l++)if(o.indexOf(l)>-1)a[l]=0;else{const c=Zie(e,t,l);let u=s[c];n&1<<c&&(u=0),a[l]=u}return a}function nae(n,e,t,s,r){const a=[...r],o=eae(t,e);for(let l=0;l<a.length;l++)if(o.indexOf(l)>-1)a[l]=Number.MAX_SAFE_INTEGER;else{const c=Zie(e,t,l);let u=s[c];n&1<<c&&(u=Number.MAX_SAFE_INTEGER),a[l]=u}for(let l=0;l<a.length;l++){const c=r[l];a[l]<0&&(a[l]+=c),a[l]=u1(0,a[l],r[l])}return a}function sae(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function rae(n,e,t,s,r,a){let o=e[r];const l=t[r]||1;(n&1<<r||a&1<<r||o==null)&&(l>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const c=s[r];return o<0&&(o+=c),o=u1(0,o,c-1),o}function iae(n,e,t,s,r,a){let o=e[r];const l=t[r]||1;(n&1<<r||a&1<<r||o==null)&&(l>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const c=s[r];return o<0&&(o+=c),l>0?o=u1(0,o,c):o=u1(-1,o,c-1),o}function EB(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function IB(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function AO(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{we(o!==-1,()=>"slice() does not support negative begin indexing.")});let a;return t==null?a=new Array(r).fill(-1):typeof t=="number"?a=[t,...new Array(r-1).fill(-1)]:t.length<r?a=t.concat(new Array(r-t.length).fill(-1)):a=t,a=a.map((o,l)=>o>=0?o:(we(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${l}.`),n.shape[l]-s[l])),[s,a]}function AB(n,e,t,s,r,a,o,l,c){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,o!=null&&(o&o-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let f=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:r,endMask:a,ellipsisMask:o,newAxisMask:l,shrinkAxisMask:c};for(let S=0;S<d.dims;S++)f&&(1<<S&l)!==0&&d.numAddAxisAfterEllipsis++,1<<S&o&&(f=!0);f||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};zNe(d,h);let p=!0,g=!0,b=!0;const v=[],w=[];for(let S=0;S<n.length;++S){if(h.strides[S]===0)throw Error(`strides[${S}] must be non-zero`);const C=!!(h.shrinkAxisMask&1<<S),M=n[S];if(M===-1){v.push(C?1:-1);continue}const k=[h.beginMask&1<<S,h.endMask&1<<S],E=[h.strides[S]>0?0:-1,h.strides[S]>0?M:M-1];if(C&&h.strides[S]<=0)throw Error("only stride 1 allowed on non-range indexing.");b=b&&h.strides[S]===1;const I=!!(h.beginMask&1<<S&&h.endMask&1<<S);if(h.beginValid&&h.endValid){if(C){const P=h.begin[S]<0?M+h.begin[S]:h.begin[S];if(h.begin[S]=P,h.end[S]=h.begin[S]+1,P<0||P>=M)throw Error(`slice index ${h.begin[S]} of dimension ${S} out of bounds.`)}else h.begin[S]=aH(h.begin[S],0,h.strides[S],M,k,E),h.end[S]=aH(h.end[S],1,h.strides[S],M,k,E);const L=h.strides[S]===1&&h.begin[S]===0&&h.end[S]===M;p=p&&L,g=g&&(S===0&&h.strides[S]===1||L)}else p=p&&h.strides[S]===1&&I,g=g&&(S===0&&h.strides[S]===1||I);let A,D=!1;if(h.beginValid&&h.endValid?(A=h.end[S]-h.begin[S],D=!0):C?(A=1,D=!0):I&&M>=0&&(h.strides[S]<0?A=-M:A=M,D=!0),D){let L;A===0||A<0!=h.strides[S]<0?L=0:L=Math.trunc(A/h.strides[S])+(A%h.strides[S]!==0?1:0),v.push(L)}else v.push(-1)}for(let S=0;S<h.finalShapeGatherIndices.length;++S){const C=h.finalShapeGatherIndices[S];C>=0?w.push(v[C]):C===$R&&w.push(1)}return{finalShapeSparse:w.filter((S,C)=>h.finalShapeGatherIndices[C]!==$R),finalShape:w,isIdentity:p,sliceDim0:g,isSimpleSlice:b,begin:h.begin,end:h.end,strides:h.strides}}function zNe(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push($R),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(jNe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function aH(n,e,t,s,r,a){if(r[e])return t>0?a[e]:a[e+1&1];{const o=n<0?s+n:n;return o<a[0]?a[0]:o>a[1]?a[1]:o}}const aae=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:TB,computeFlatOffset:IB,computeOutShape:kB,getNormalizedAxes:FNe,isSliceContinous:EB,maskToAxes:RNe,parseSliceParams:AO,sliceInfo:AB,startForAxis:rae,startIndicesWithElidedDims:tae,stopForAxis:iae,stopIndicesWithElidedDims:nae,stridesForAxis:sae,stridesWithElidedDims:Jie},Symbol.toStringTag,{value:"Module"}));const oae="4.11.0";class lae{static sgd(e){return new EO(e)}static momentum(e,t,s=!1){return new _B(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,a=!1){return new xB(e,t,s,r,a)}static adam(e=.001,t=.9,s=.999,r=null){return new wB(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new yB(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,a=0){return new vB(e,t,s,r,a)}static adagrad(e,t=.1){return new bB(e,t)}}const Ay=lae;const BNe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function LB(){return new Promise(n=>BNe(()=>n()))}function NB(n,e){const t=n[0].length;n.forEach((r,a)=>{we(r.length===t,()=>`Error in concat${t}D: rank of tensors[${a}] must be the same as the rank of the rest (${t})`)}),we(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,a)=>{for(let o=0;o<t;o++)we(o===e||r[o]===s[o],()=>`Error in concat${t}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function Mm(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}var Zh;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Zh||(Zh={}));function cae(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const a=t[r],o=s[s.length-t.length+r],l=s[o];if(a>=0)if(l>=0){if(l!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${a} but shape[${r+n}] = ${l}`)}else s[o]=a}return s}function uae(n){const e={FIRST_DIM_SIZE:Zh.FIRST_DIM_SIZE,VALUE_ROWIDS:Zh.VALUE_ROWIDS,ROW_LENGTHS:Zh.ROW_LENGTHS,ROW_SPLITS:Zh.ROW_SPLITS,ROW_LIMITS:Zh.ROW_LIMITS,ROW_STARTS:Zh.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function fae(n){return n.length===0?0:n[0]===Zh.FIRST_DIM_SIZE?n.length-1:n.length}function dae(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const a=n[r],o=e[r+1];if(a>=0&&o>=0&&a!==1&&a!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${a} but ragged tensor input.flatValues.shape[${r-n.length}] = ${o}`)}}const DB=30;function LO(n){return n<=DB?n:xN(n,Math.floor(Math.sqrt(n)))}function OB(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}function qk(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const a=e.length;for(let o=0;o<a;++o)r=r.concat([n[o+1]/e[o],e[o]]);r=r.concat(n.slice(a+1))}return r}function Yk(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],a=[];for(let o=1;o<n;++o)o>=e*2+1||o%2===1?a.push(o):r.push(o);s.push(...r),s.push(0),s.push(...a)}return s}function Kk(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let a=1;a<n.length;++a)a<=e.length?s?r.push(e[a-1]*n[a]):r.push(n[a]/e[a-1]):r.push(n[a]);return r}function PB(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function $B(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}const NO=1.7580993408473768,DO=1.0507009873554805;const jB=.3275911,RB=.254829592,FB=-.284496736,zB=1.421413741,BB=-1.453152027,UB=1.061405429;function Fg(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function hae(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function pae(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function mae(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function VB(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function gae(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function yae(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const a=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:t,imag:s}}function bae(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}const M5="->",UNe=/->/g,oH=",",lH="...";function WB(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(UNe,"").length)/M5.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${M5}").`);const[s,r]=n.split(M5);we(s.indexOf(lH)===-1,()=>`The ellipsis notation ("${lH}") is not supported yet.`);const a=s.split(oH),o=a.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const l=[];for(let h=0;h<r.length;++h){const p=r[h];if(!a.some(g=>g.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);l.indexOf(p)===-1&&l.push(p)}for(let h=0;h<s.length;++h){const p=s[h];l.indexOf(p)===-1&&p!==oH&&l.push(p)}const c=new Array(a.length);for(let h=0;h<o;++h){if(new Set(a[h].split("")).size!==a[h].length)throw new Error(`Found duplicate axes in input component ${a[h]}. Support for duplicate axes in input is not implemented yet.`);c[h]=[];for(let p=0;p<a[h].length;++p)c[h].push(l.indexOf(a[h][p]))}const u=l.length,f=r.length,d=[];for(let h=f;h<u;++h)d.push(h);return{allDims:l,summedDims:d,idDims:c}}function GB(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function HB(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const a=t[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=a[o]:we(s[e[r][o]]===a[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(a)}, but got dimension ${a[o]}`)}}function qB(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let o=0;o<r;++o)s.push([]);const a=[];for(let o=0;o<t.length;++o){const l=t[o],c=VNe(e,l);for(const u of c)a.indexOf(u)===-1&&(s[o].push(u),a.push(u))}return{path:t,steps:s}}function YB(n){return n.every((e,t)=>e===t)}function VNe(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function KB(n,e,t=0){let s=[];if(typeof e=="number")we(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((o,l)=>(l===-1&&(o+=1),o),0);we(r<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const o=e.reduce((l,c)=>c>0?l+c:l);e[a]=n.shape[t]-o}we(n.shape[t]===e.reduce((o,l)=>o+l),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}function wae(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function vae(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function _ae(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}function xae(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function Cae(n,e){return`size ${n} must be non-negative, not ${e}`}function Sae(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Mae(n,e){const t=Ot(n),s=Ot(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function Tae(n,e){const t=Ot(n),s=Ot(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}function jR(){return"segment ids must be >= 0"}function kae(){return"segment ids are not increasing"}function Eae(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Iae(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}function Aae(n,e){let t=!1,s;for(n<=DB?(s=n,t=!0):s=xN(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=xN(n,s+1);return s}function Lae(n,e,t){const s=[],r=n.length;for(let a=0;a<r;a++)a!==e?s.push(n[a]):s.push(t);return s}function XB(n,e,t,s){const r=e.shape.length,a=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let d=0;d<s;++d)if(n.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${n.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=n.shape[t],l=[];let c=1,u=1,f=1;for(let d=0;d<s;++d)l.push(n.shape[d]),c*=n.shape[d];for(let d=s;d<t;d++)l.push(n.shape[d]),u*=n.shape[d];for(let d=s;d<r;d++)l.push(e.shape[d]);for(let d=t+1;d<a;d++)l.push(n.shape[d]),f*=n.shape[d];return{batchSize:c,sliceSize:f,outerSize:u,dimSize:o,outputShape:l}}const WNe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:XB,computeOutShape:Lae,segOpComputeOptimalWindowSize:Aae},Symbol.toStringTag,{value:"Module"}));function zg(n){try{return n.map(e=>Og(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Nae(n){return n.map(e=>Cm(e))}const Dae=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:RB,ERF_A2:FB,ERF_A3:zB,ERF_A4:BB,ERF_A5:UB,ERF_P:jB,PARALLELIZE_THRESHOLD:DB,get RowPartitionType(){return Zh},SELU_SCALE:DO,SELU_SCALEALPHA:NO,applyActivation:CO,assertAndGetBroadcastShape:Gs,assertAxesAreInnerMostDims:yc,assertParamsConsistent:NB,assignToTypedArray:gae,axesAreInnerMostDims:Fz,calculateShapes:A1,checkEinsumDimSizes:HB,checkPadOnDimRoundingMode:Cu,combineLocations:Wre,combineRaggedTensorToTensorShapes:cae,complexWithEvenIndex:pae,complexWithOddIndex:mae,computeConv2DInfo:Vl,computeConv3DInfo:M1,computeDefaultPad:vz,computeDilation2DInfo:Ik,computeOptimalWindowSize:LO,computeOutAndReduceShapes:Wl,computeOutShape:Mm,computePool2DInfo:vh,computePool3DInfo:Gg,convertConv2DDataFormat:Hg,decodeEinsumEquation:WB,eitherStridesOrDilationsAreOne:gc,expandShapeToKeepDim:$o,exponent:bae,exponents:yae,fromStringArrayToUint8:Nae,fromUint8ToStringArray:zg,getAxesPermutation:no,getBroadcastDims:vb,getComplexWithIndex:VB,getEinsumComputePath:qB,getEinsumPermutation:GB,getFusedBiasGradient:xO,getFusedDyActivation:_O,getImageCenter:OB,getInnerMostAxes:jo,getPermuted:Yk,getRaggedRank:fae,getReductionAxes:tl,getReshaped:qk,getReshapedPermuted:Kk,getRowPartitionTypesHelper:uae,getSliceBeginCoords:PB,getSliceSize:$B,getSparseFillEmptyRowsIndicesDenseShapeMismatch:wae,getSparseFillEmptyRowsNegativeIndexErrorMessage:vae,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:_ae,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Sae,getSparseReshapeInputOutputMismatchErrorMessage:Tae,getSparseReshapeInputOutputMultipleErrorMessage:Mae,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:xae,getSparseReshapeNegativeOutputDimErrorMessage:Cae,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Iae,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:jR,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:kae,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Eae,getUndoAxesPermutation:T1,isIdentityPermutation:YB,log:WSe,mergeRealAndImagArrays:Fg,prepareAndValidate:IO,prepareSplitSize:KB,segment_util:WNe,shouldFuse:SO,slice_util:aae,splitRealAndImagArrays:hae,stridesOrDilationsArePositive:bb,tupleValuesAreOne:d1,upcastType:Hu,validateDefaultValueShape:dae,validateInput:gO,validateUpdateShape:oB,warn:cd},Symbol.toStringTag,{value:"Module"}));const GNe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:MO,nonMaxSuppressionV4Impl:TO,nonMaxSuppressionV5Impl:kO,whereImpl:wO},Symbol.toStringTag,{value:"Module"}));uNe();var rb;(function(n){n.UNDEFINED="undefined",n.INVALID_MODEL_TYPE="invalidModelType",n.MISSING_PATH="missingPath"})(rb||(rb={}));const Oae=n=>!n||!Array.isArray(n)||n.length!==4?!1:n.every(e=>e===null||typeof e=="number"),Pae=n=>Oae(n)&&n[1]!==null&&n[2]!==null&&n[1]>0&&n[2]>0;function $ae(n){function e(t){try{return t.shape.length===n}catch{}return!1}return e}const jae=$ae(4),HNe=$ae(3),Xk=n=>n instanceof jr,qNe=n=>typeof n=="string",YNe=n=>typeof n=="string"&&["layers","graph"].includes(n);class ML extends Error{type;constructor(e){super(e),this.type=e}}const KNe=n=>{if(n===void 0)throw new ML(rb.UNDEFINED);if(!YNe(n.modelType??"layers"))throw new ML(rb.INVALID_MODEL_TYPE);if(!n.path&&!n._internals?.path)throw new ML(rb.MISSING_PATH);return!0},XNe=n=>typeof n=="number",Rae=n=>Array.isArray(n)&&n.length===2&&n.every(XNe),fM=n=>{console.warn(Array.isArray(n)?n.join(`
`):n)};function QB(n){return n!==void 0&&typeof n=="function"}function QNe(n){return QB(n)&&n.length<=1}const JNe=(n,e,t)=>!QB(n)||n.length<=1?!1:t===void 0&&e==="tensor"?!0:t==="tensor",ZNe=n=>n?n.aborted:!1;async function Fae(n,e){let t;for(t=await n.next();!t.done;t=await n.next())e&&await e(t.value);return t.value}function zae(n){return n!=null}function dM(n,e,...t){const s=t.filter(zae);if(s.length){const r=n.tidy(()=>s.reduce((a,o)=>o(a),e));return!e.isDisposed&&e!==r&&e.dispose(),r}return e}const e4e=n=>n instanceof ML,t4e="https://upscalerjs.com/documentation/troubleshooting#deprecated-model-definition-function",n4e=["Passing a model definition as a function is deprecated and will be removed in a future version.","To leverage model lifecycle methods, use the setup and teardown methods.",`For more information, see ${t4e}.`].join(" "),s4e="https://upscalerjs.com/documentation/troubleshooting#padding-is-undefined",r4e=['"padding" is undefined, but "patchSize" is explicitly defined.',"Without padding, patches of images often have visible artifacting at the seams. Defining an explicit padding will resolve the artifacting.",`For more information, see ${s4e}.`,'To hide this warning, pass an explicit padding of "0".'].join(" "),i4e="https://upscalerjs.com/documentation/troubleshooting#progress-specified-without-patch-size",a4e=['The "progress" callback was provided but "patchSize" was not defined.','Without a "patchSize", the "progress" callback will never be called.',`For more information, see ${i4e}.`].join(" "),o4e="https://upscalerjs.com/documentation/troubleshooting#invalid-predicted-tensor",l4e=n=>[`The tensor returned by the model was not a valid rank-4 tensor. It's shape is ${JSON.stringify(n)}.}`,"UpscalerJS only supports models returning valid image-like data in four dimensional form.",`For more information, see ${o4e}.`].join(" "),c4e="https://upscalerjs.com/documentation/troubleshooting#invalid-model-prediction",u4e=["The model output was not a valid tensor. UpscalerJS only supports models returning valid tensors.","This is likely an error with the model itself, not UpscalerJS.",`For more information, see ${c4e}.`].join(" "),f4e=new Error("No defined tensors were passed to concatTensors");class d4e extends Error{message="The upscale request received an abort signal"}const h4e="https://upscalerjs.com/documentation/troubleshooting#invalid-model-type",p4e="https://upscalerjs.com/documentation/troubleshooting#input-size-and-patch-size",m4e="https://upscalerjs.com/documentation/troubleshooting#error-with-model-input-shape",g4e=n=>[`You've provided an invalid model type: ${JSON.stringify(n)}. Accepted types are "layers" and "graph".`,`For more information, see ${h4e}.`].join(" "),JB="There is a bug with the upscaler code. Please report this.",y4e=["You have provided a patchSize, but the model definition already includes an input size.","Your patchSize will be ignored.",`For more information, see ${p4e}.`].join(" "),b4e=n=>[`Expected model to have a rank-4 compatible input shape. Instead got: ${JSON.stringify(n)}.`,`For more information, see ${m4e}.`].join(" "),w4e=n=>new Error([`Invalid patch size: ${n}. Patch size must be greater than 0.`].join(" ")),v4e=(n,e)=>new Error([`Invalid patch size and padding: ${n} and ${e}. Patch size must be greater than padding * 2.`].join(" ")),_4e="https://upscalerjs.com/documentation/troubleshooting#patch-size-indivisible-by-divisibility-factor",x4e=(n,e,t)=>[`Invalid patch size: ${n}. The model has a defined divibility factor of ${e} and patch size must be a multiple of this number.`,`Patch size has been scaled up to ${t}.`,`
For more information, see ${_4e}.`].join(" "),C4e=new Error(["Model input sizes must be square. If you are using a model with a non-square input size and would like to request support,","please file a feature request at https://github.com/thekevinscott/upscalerjs"].join(" ")),S4e="https://upscalerjs.com/documentation/troubleshooting#missing-path-and-internals",M4e=n=>['Provided model configuration is missing both a "path" and "_internals". A valid path to a model JSON file must be provided.',`For more information, see ${S4e}.`,`The model configuration provided was: ${JSON.stringify(n)}`].join(" ");function T4e(n,e){switch(n){case rb.INVALID_MODEL_TYPE:return new Error(g4e(e?.modelType));case rb.MISSING_PATH:return new Error(M4e(e));default:return new Error(JB)}}const Bae=(n,e,t)=>async s=>{if(t&&await n.nextFrame(),ZNe(e))throw Array.isArray(s)?s.forEach(r=>r?.dispose()):Xk(s)&&s.dispose(),new d4e},AN=n=>!n||typeof n!="object"?!1:"patchSize"in n&&typeof n.patchSize=="number",RR=n=>!!n&&typeof n=="number"&&n>0,k4e="https://upscalerjs.com/documentation/troubleshooting#invalid-warmup-value",E4e=n=>["Invalid value passed to warmup in warmupSizes:",JSON.stringify(n),`For more information, see ${k4e}.`].join(`
`),FR=n=>new Error(E4e(n)),I4e=n=>{if(AN(n)){const{patchSize:e}=n;return e}return n};async function*A4e(n,e,t){const{model:s,modelDefinition:r}=await e;for(const a of t){if(!AN(a)&&!RR(a))throw FR(a);const o=I4e(a);let l=n.zeros([1,o,o,3]);yield[l];const c=[r.preprocess,u=>s.predict(u),r.postprocess].filter(Boolean);for(const u of c)l=dM(n,l,u),yield[l];l.dispose(),yield}}const L4e=n=>{if(Array.isArray(n)){for(const e of n)if(!AN(e)&&!RR(e))throw FR(n);return n}else if(AN(n)||RR(n))return[n];throw FR(n)},cH=async(n,e,t,{signal:s=void 0,awaitNextFrame:r=!1}={},a)=>{const o=Bae(n,s||a.signal,r);await o(),await Fae(A4e(n,e,L4e(t)),o)},N4e=(n,e)=>e instanceof n.LayersModel,D4e=n=>({...n});function O4e(n){return typeof n=="function"}function P4e(n,e){return O4e(e)?(fM(n4e),e(n)):e}async function $4e(n,e){const t=P4e(n,e);return t.setup&&await t.setup(n),t}function uH(n,e,t){return t==="graph"?n.loadGraphModel(e):n.loadLayersModel(e)}const j4e=(n,e)=>N4e(n,e)?e.layers[0].batchInputShape:e.inputs[0].shape,R4e=(n,{model:e})=>{const t=j4e(n,e);if(!Oae(t))throw new Error(b4e(t));return t},T5=(n,e)=>Math.ceil(e/n)*n,F4e=(n,e,{patchSize:t,padding:s},r)=>{const a=R4e(n,e);if(t!==void 0){if(t<=0)throw w4e(t);if(s!==void 0&&s*2>=t)throw v4e(t,s)}if(Pae(a)){if(t!==void 0&&fM(y4e),a[1]!==a[2])throw C4e;return{patchSize:a[1],padding:s,modelInputShape:a}}t!==void 0&&s===void 0&&fM(r4e);const{divisibilityFactor:o}=e.modelDefinition;if(o!==void 0){if(t!==void 0){const l=T5(o,t);return l!==t&&fM(x4e(t,o,l)),{patchSize:l,padding:s,modelInputShape:[null,l,l,3]}}return{patchSize:void 0,padding:void 0,modelInputShape:[null,T5(o,r[1]),T5(o,r[2]),3]}}return{patchSize:t,padding:s,modelInputShape:void 0}},z4e=(n,e)=>t=>{const s=t.shape[1],r=t.shape[2];return Pae(e)&&(e[1]>s||e[2]>r)?n.tidy(()=>{const a=Math.max(s,e[1]),o=Math.max(r,e[2]),l=n.zeros([1,s,o-r,3]),c=n.zeros([1,a-s,o,3]),u=n.concat([t,l],2);return n.concat([u,c],1)}):t},fH=(n,e,t)=>s=>{const r=e[1]*t,a=e[2]*t;return r<s.shape[1]||a<s.shape[2]?n.tidy(()=>n.slice(s,[0,0,0],[1,r,a,3])):s},dH=n=>e=>{const t=Rae(n)?n[1]:255;return e.clipByValue(0,t).mul(t===1?255:1)},B4e=(n,e)=>t=>Rae(e)&&e[1]===1?n.mul(t,1/255):t,U4e=(n,e)=>n.tidy(()=>{const[t,s]=e.shape,r=n.fill([t,s],255).expandDims(2);return e.clipByValue(0,255).concat([r],2).dataSync()});function V4e(n){return Xk(n)?n.clone():n}function hH(n,e,t=0){const s=e.filter(zae);if(s.length===0)throw f4e;const r=n.concat(s,t);return e.forEach(a=>a?.dispose()),r}const pH=(n,e,t,s)=>{let r=e;const a=e===0||t===n?0:s,o=r+t>n;let l=o?t-(n-r):0;const c=o||t===n?0:s,u=o?0:a;let f=t-(o?l:0);o&&(r=n-t),r-=u,l+=u,f-=u+c;const d=t>n?n:t-a-c;return{pre:{origin:r,size:t},post:{origin:l,size:f},increment:d}},W4e=([n,e],t,s)=>{const r=[];let a=0,o=0;for(;o<e;){const{pre:{origin:l,size:c},post:{origin:u,size:f},increment:d}=pH(e,o,Math.min(t,e),s),h=[];for(;a<n;){const{pre:{origin:p,size:g},post:{origin:b,size:v},increment:w}=pH(n,a,Math.min(t,n),s);h.push({pre:{origin:[l,p],size:[c,g]},post:{origin:[u,b],size:[f,v]}}),a+=w}r.push(h),a=0,o+=d}return r},G4e=(n,e,t,s)=>(n*t+e+1)/s,mH=(n,e)=>{const t=n.predict(e);if(!Xk(t))throw new Error(u4e);if(jae(t))return t;throw new Error(l4e(t.shape))};async function*H4e(n,e,{output:t,progress:s,progressOutput:r},a,{originalImageSize:o,patchSize:l,padding:c=0},{tensorAsBase64:u}){const{model:f,modelDefinition:d}=a,h=d.scale??1;if(l){const[v,w]=e.shape.slice(1),x=W4e([w,v],l,c);yield;let S;const C=x.length*x[0].length;for(let E=0;E<x.length;E++){const I=x[E],A=I.length;let D;yield[D,S];for(let L=0;L<A;L++){const{pre:P,post:j}=I[L];yield[S,D];const G=e.slice([0,...P.origin],[-1,...P.size]);yield[S,D,G];const Q=mH(f,G);G.dispose(),yield[S,D,Q];const q=[0,j.origin[0]*h,j.origin[1]*h],te=[-1,j.size[0]*h,j.size[1]*h],Z=Q.slice(q,te);Q.dispose(),yield[S,D,Z];const ne=dM(n,Z,d.postprocess,dH(d.outputRange));if(yield[S,D,ne],s!==void 0&&QB(s)){const le=G4e(E,L,A,C);if(QNe(s))s(le);else{const H=ne.squeeze(),R={row:E,col:L,patchCoordinates:{pre:P,post:j}};if(JNe(s,t,r))s(le,H,R);else{const B=u(n,H);H.dispose(),s(le,B,R)}}}yield[S,D,ne],D=hH(n,[D,ne],2),ne.dispose(),yield[S,D]}S=hH(n,[S,D],1),D.dispose(),yield[S]}const M=dM(n,S.clone(),fH(n,o,h));S?.dispose(),yield[M];const k=M.squeeze();return M.dispose(),k}s&&fM(a4e);const p=mH(f,e);yield[p];const g=dM(n,p.clone(),d.postprocess,dH(d.outputRange),fH(n,o,h));p.dispose(),yield[g];const b=g.squeeze();return g.dispose(),b}async function*q4e(n,e,t,s,{getImageAsTensor:r,tensorAsBase64:a}){const o=V4e(e),l=await r(n,o);yield l;const c=l.shape,{patchSize:u,padding:f,modelInputShape:d}=F4e(n,s,t,c),h=dM(n,l,s.modelDefinition.preprocess,B4e(n,s.modelDefinition.inputRange),d?z4e(n,d):void 0);yield h;const p=H4e(n,h,{output:t.output,progressOutput:t.progressOutput,progress:t.progress},s,{originalImageSize:c,patchSize:u,padding:f},{tensorAsBase64:a});let g=await p.next();for(yield g.value;!g.done;)g=await p.next(),Array.isArray(g.value)?yield[...g.value,h]:Xk(g.value)?yield[g.value,h]:yield h;h.dispose();const b=g.value;if(t.output==="tensor")return b;const v=a(n,b);return b.dispose(),v}async function Y4e(n,e,{signal:t,awaitNextFrame:s,...r},a,{checkValidEnvironment:o,...l}){o(e,{output:r.output,progressOutput:r.progressOutput});const c=Bae(n,t||a.signal,s);await c();const u=await Fae(q4e(n,e,r,a,l),c);return await c(),u}const K4e=MSe;function X4e({tf:n,getUpscaleOptions:e,checkValidEnvironment:t,getImageAsTensor:s,tensorAsBase64:r,loadModel:a}){class o{_opts;_model;ready;_abortController=new AbortController;constructor(c={}){this._opts={...c},this._model=a(n,$4e(n,this._opts.model||K4e)),this.ready=new Promise((u,f)=>{this._model.then(()=>cH(n,this._model,this._opts.warmupSizes||[],void 0,{signal:this._abortController.signal})).then(u).catch(f)})}async execute(c,u){const f={checkValidEnvironment:t,getImageAsTensor:s,tensorAsBase64:r};await this.ready;const d=await this._model;return Y4e(n,c,e(u),{...d,signal:this._abortController.signal},f)}upscale=this.execute.bind(this);warmup=async(c=[],u)=>(await this.ready,cH(n,this._model,c,u,{signal:this._abortController.signal}));abort=()=>{this._abortController.abort(),this._abortController=new AbortController};dispose=async()=>{await this.ready;const{model:c,modelDefinition:u}=await this._model;u.teardown&&await u.teardown(n),c.dispose()};getModel=()=>this._model}return o}const Uae={kernelName:ST,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,Qb(Cn(t,"float32"),-1))}}};const Q4e={kernelName:z2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Hi(Cn(t,"float32")),r=pc(Bn(ws(1),s));return ya(cs(n,r))}}}};const J4e={kernelName:B2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=pc(Bn(Hi(Cn(t,"float32")),1));return cs(n,s)}}}};const Z4e={kernelName:Yb,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{let l=n;const c=tl(t.shape,r);return c.length>0&&(l=Xn(l,c)),nt(l,t.shape)},b:()=>{let l=n;const c=tl(s.shape,r);return c.length>0&&(l=Xn(l,c)),nt(l,s.shape)}}}};const eDe={kernelName:MT,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,r)=>{t[r]=()=>n.clone()}),t}};const tDe={kernelName:TT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Rr(t)}}};const nDe={kernelName:kT,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Rr(t)}}};const sDe={kernelName:U2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,pc(Bn(ws(1),Hi(Cn(t,"float32")))))}}};const rDe={kernelName:V2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=pc(ln(ws(1),Hi(Cn(t,"float32"))));return cs(n,s)}}}};const iDe={kernelName:H2,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{const l=ln(Hi(t),Hi(s));let c=et(n,cs(s,l));const u=tl(t.shape,r);return u.length>0&&(c=Xn(c,u)),nt(c,t.shape)},b:()=>{const l=ln(Hi(t),Hi(s));let c=ya(et(n,cs(t,l)));const u=tl(s.shape,r);return u.length>0&&(c=Xn(c,u)),nt(c,s.shape)}}}};const aDe={kernelName:W2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,ln(Hi(Cn(t,"float32")),1))}}};const oDe={kernelName:G2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,Bn(ws(1),Hi(Cn(t,"float32"))))}}};function lDe(n,e,t,s,r,a){const o=Te(n,"dy","avgPool3dGrad"),l=Te(e,"input","avgPool3dGrad");let c=o,u=l,f=!1;l.rank===4&&(f=!0,c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=nt(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),we(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),we(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Cu("avgPool3dGrad",r,a);const d={dy:c,input:u},h={filterSize:t,strides:s,pad:r,dimRoundingMode:a},p=Ge.runKernel(V4,d,h);return f?nt(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const cDe=Ye({avgPool3dGrad_:lDe});const uDe={kernelName:IT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:a,pad:o,dimRoundingMode:l}=t;return{x:()=>cDe(n,s,r,a,o,l)}}};function fDe(n,e,t,s,r){const a=Te(n,"dy","avgPoolGrad"),o=Te(e,"input","avgPoolGrad");we(o.rank===a.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`);let l=o,c=a,u=!1;o.rank===3&&(u=!0,l=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),we(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),we(l.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${l.rank}.`);const f={dy:c,input:l},d={filterSize:t,strides:s,pad:r},h=Ge.runKernel(U4,f,d);return u?nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const dDe=Ye({avgPoolGrad_:fDe});const hDe={kernelName:ET,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:a,pad:o}=t;return{x:()=>dDe(n,s,r,a,o)}}};const pDe={kernelName:AT,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,r]=e,{transposeA:a,transposeB:o}=t;return!a&&!o?{a:()=>fr(n,r,!1,!0),b:()=>fr(s,n,!0,!1)}:!a&&o?{a:()=>fr(n,r,!1,!1),b:()=>fr(n,s,!0,!1)}:a&&!o?{a:()=>fr(r,n,!1,!0),b:()=>fr(s,n,!1,!1)}:{a:()=>fr(r,n,!0,!0),b:()=>fr(n,s,!0,!0)}}};const mDe={kernelName:LT,gradFunc:(n,e,t)=>{const{blockShape:s,crops:r}=t;return{x:()=>zk(n,s,r)}}};const gDe={kernelName:lre,gradFunc:(n,e,t)=>{const s=t,r=s.inputShape,a=s.shape,o=Array.from(a);for(let c=r.length-1;c>=0;c--)if(r[c]===a[c])o[c]=1;else if(r[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const l=[];for(let c=0;c<o.length;c++)o[c]>1&&l.push(c);return{x:()=>Xn(n,l,!0)}}};const yDe={kernelName:q2,gradFunc:n=>({x:()=>n.clone()})};const bDe={kernelName:Y2,gradFunc:n=>({x:()=>Rr(n)})};const wDe={kernelName:K2,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:r,clipValueMax:a}=t;return{x:()=>Fl(gh(qg(s,r),k1(s,a)),n,Rr(n))}}};const vDe={kernelName:DT,inputsToSave:["x"],gradFunc:Uae.gradFunc};const _De={kernelName:OT,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(c=>c.shape),{axis:r}=t,a=dr(r,e[0].shape)[0],o=s.map(c=>c[a]);return Uu(n,o,a).map(c=>()=>c)}};const xDe={kernelName:PT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{dilations:a,strides:o,pad:l,dataFormat:c}=t;return we(d1(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>Lz(s.shape,n,r,o,l,c),filter:()=>pB(s,n,r.shape,o,l,c)}}};const CDe={kernelName:$T,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c}=t;return{dy:()=>jg(n,r,a,o,l,1,c),filter:()=>pB(n,s,r.shape,a,o,l,c)}}};function SDe(n,e,t,s,r){let a=n;n.rank===4&&(a=nt(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=e;o.rank===4&&(o=nt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),we(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),we(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),we(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),we(a.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${t[3]}.`),we(o.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${t[4]}).`);const l={x:a,dy:o},c={strides:s,pad:r,filterShape:t};return Ge.runKernel(Y4,l,c)}const MDe=Ye({conv3DBackpropFilter_:SDe});const TDe={kernelName:jT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:a}=t;we(d1(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,l]=e;return{x:()=>Bre(o.shape,n,l,r,a),filter:()=>MDe(o,n,l.shape,r,a)}}};const kDe={kernelName:X2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(ya(fO(Cn(t,"float32"))),n)}}};const EDe={kernelName:Q2,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(dO(Cn(t,"float32")),n)}}};const IDe={kernelName:RT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r,exclusive:a,reverse:o}=t;return{x:()=>{const l=no([r],s.rank);let c=ZD(n,r,a,!o);return l!=null&&(c=Ir(c,l)),c}}}};const ADe={kernelName:FT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:o}=t,l=s??[1,1];we(d1(l),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${l}'`);const[c,u]=e;return we(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),we(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),we(c.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),we(gc(r,l),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${l}'.`),Cu("depthwiseConv2d",a,o),{x:()=>Lie(c.shape,n,u,r,a,l,o),filter:()=>Aie(c,n,u.shape,r,a,l,o)}}};const LDe={kernelName:zT,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,a={x:s,filter:r,dy:n},o={x:s,filter:r,dy:n};return{x:()=>Ge.runKernel(CN,a,t),filter:()=>Ge.runKernel(SN,o,t)}}};const NDe={kernelName:Z2,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>Ge.runKernel(iD,s)}}};const DDe={kernelName:e_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=et(Ku(ya(Hi(t))),2/Math.sqrt(Math.PI));return{x:()=>et(n,s)}}};const ODe={kernelName:t_,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,t)}}};const PDe={kernelName:UT,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>nt(n,t.shape)}}};const $De={kernelName:n_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,Ku(t))}}};const jDe={kernelName:s_,gradFunc:n=>({x:()=>Rr(n)})};const RDe={kernelName:r_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{const l=cs(n,Cn(s,"float32")),c=tl(t.shape,r);return c.length>0?nt(Xn(l,c),t.shape):l},b:()=>{let l=et(n,Cn(t,"float32"));const c=tl(s.shape,r);c.length>0&&(l=nt(Xn(l,c),s.shape));const u=Hi(s);return ya(cs(l,Cn(u,"float32")))}}}};const FDe={kernelName:VT,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[r,a,o,l]=e,c=l??ws(1),u=tl(a.shape,r.shape),f=[];if(a.rank===1){for(let C=0;C<r.shape.length-1;++C)f.push(r.shape[C]);f.push(1)}const d=Bn(r,a),h=et(n,c),p=lO(ln(o,ws(s))),g=et(et(et(p,p),p),ws(-.5));return{x:()=>a.rank===1?nt(et(et(n,hd(nt(p,[1,1,1,a.shape[0]]),f)),c),r.shape):nt(et(et(n,p),c),r.shape),mean:()=>{let C=et(et(p,ws(-1)),h);return a.rank===1&&(C=Xn(C,u)),nt(C,a.shape)},variance:()=>{let C=et(et(g,d),h);return a.rank===1&&(C=Xn(C,u)),nt(C,a.shape)},scale:()=>{const C=et(d,p);let M=et(n,C);return a.rank===1&&(M=Xn(M,u)),nt(M,a.shape)},offset:()=>{let C=n;return a.rank===1&&(C=Xn(C,u)),nt(C,a.shape)}}}};const zDe={kernelName:WT,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,r]=e,{axis:a,batchDims:o}=t,l=dr(a,s.shape)[0],c=(u,f,d)=>()=>{const h=u.shape,p=f.size,g=h.slice(0,l),b=g.length,v=h.slice(a,h.length).slice(1),w=v.length,x=gH(0,b),S=gH(b+1,b+1+w),C=yH([g,[p],v]),M=nt(d,C),k=nt(f,[p]),E=yH([[b],x,S]),I=Ir(M,E);let A=bO(I,k,u.shape[l]);const D=T1(E);return A=Ir(A,D),A};if(o===1){const u=s.shape[0],f=s.split(u,0);return{x:()=>_u(f.map((p,g)=>c(p,r.slice(g,1),n.slice(g,1))())).reshape(s.shape),indices:()=>r}}else return{x:c(s,r,n),indices:()=>r}}};function gH(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function yH(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}const BDe={kernelName:i_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>Rr(t),b:()=>Rr(s)}}};const UDe={kernelName:a_,gradFunc:n=>({x:()=>Cn(n,"float32")})};const VDe={kernelName:o_,gradFunc:n=>({x:()=>Rr(n)})};const WDe={kernelName:l_,gradFunc:n=>({x:()=>Rr(n)})};const GDe={kernelName:c_,gradFunc:n=>({x:()=>Rr(n)})};const HDe={kernelName:HT,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:r}=t,a=Su(s,0);return{x:()=>Fl(a,n,et(n,r))}}};const qDe={kernelName:f_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,ln(t,1))}}};const YDe={kernelName:u_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,Cn(t,"float32"))}}};const KDe={kernelName:cre,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;return{logits:()=>{const o=Ku(s);return Bn(n,et(Xn(n,r,!0),o))}}}};function XDe(n,e,t,s=5,r=1,a=1,o=.5){const l={x:n,y:e,dy:t},c={depthRadius:s,bias:r,alpha:a,beta:o};return Ge.runKernel(hD,l,c)}const QDe=Ye({localResponseNormalizationBackprop_:XDe});const JDe={kernelName:JT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{depthRadius:a,bias:o,alpha:l,beta:c}=t;return{x:()=>QDe(s,r,n,a,o,l,c)}}};function Vae(n,e,t,s){return e.rank<t.rank&&(e=nt(e,$o(e.shape,s))),n.rank<t.rank&&(n=nt(n,$o(n.shape,s))),{x:()=>et(n,Cn(Ef(t,e),n.dtype))}}const bH={kernelName:ZT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:r}=s,a=e[0],o=e[1],l=dr(r,a.shape),c=Vae(n,o,a,l);return{x:()=>c.x()}}};const ZDe={kernelName:d_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>et(n,Cn(qg(t,s),"float32")),b:()=>et(n,Cn(c2(t,s),"float32"))}}};function eOe(n,e,t,s,r,a,o){const l=Te(n,"dy","maxPool3dGrad"),c=Te(e,"input","maxPool3dGrad"),u=Te(t,"output","maxPool3dGrad");let f=l,d=c,h=u,p=!1;c.rank===4&&(p=!0,f=nt(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=nt(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),h=nt(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),we(f.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),we(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),we(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Cu("maxPool3dGrad",a,o);const g={dy:f,input:d,output:h},b={filterSize:s,strides:r,pad:a,dimRoundingMode:o},v=Ge.runKernel(mD,g,b);return p?nt(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const tOe=Ye({maxPool3dGrad_:eOe});const nOe={kernelName:tk,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=t;return{x:()=>tOe(n,s,r,a,o,l,c)}}};function sOe(n,e,t,s,r,a,o){const l=Te(n,"dy","maxPoolGrad"),c=Te(e,"input","maxPoolGrad"),u=Te(t,"output","maxPoolGrad");we(c.rank===l.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${l.rank})`),we(l.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),we(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),Cu("maxPoolGrad",a,o);const f={dy:l,input:c,output:u},d={filterSize:s,strides:r,pad:a,dimRoundingMode:o};return Ge.runKernel(pD,f,d)}const rOe=Ye({maxPoolGrad_:sOe});const iOe={kernelName:ek,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:a,strides:o,pad:l}=t;return{x:()=>rOe(n,s,r,a,o,l)}}};const aOe={kernelName:nk,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t,a=dr(r,s.shape),l=Wl(s.shape,a)[1],c=Ot(l);return{x:()=>{const f=s.shape.slice();a.forEach(p=>{f[p]=1});const d=nt(n,f);return cs(et(d,Fu(s.shape,"float32")),c)}}}};const oOe={kernelName:sk,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:r}=s,[a,o]=e,l=dr(r,a.shape),c=Vae(n,o,a,l);return{x:()=>c.x()}}};const lOe={kernelName:h_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>et(n,Cn(k1(t,s),"float32")),b:()=>et(n,Cn(Su(t,s),"float32"))}}};const cOe={kernelName:rk,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,a=r.map(o=>o[0]);return{x:()=>Pr(n,a,s.shape)}}};const uOe={kernelName:p_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{const l=tl(t.shape,r);return l.length>0?nt(Xn(n,l),t.shape):n},b:()=>{const l=et(n,ya(F_(cs(t,s)))),c=tl(s.shape,r);return c.length>0?nt(Xn(l,c),s.shape):l}}}};const fOe={kernelName:m_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{const l=et(n,Cn(s,"float32")),c=tl(t.shape,r);return c.length>0?nt(Xn(l,c),t.shape):l},b:()=>{const l=et(n,Cn(t,"float32")),c=tl(s.shape,r);return c.length>0?nt(Xn(l,c),s.shape):l}}}};const dOe={kernelName:ik,gradFunc:n=>({x:()=>ya(n)})};const hOe={kernelName:lk,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>Xo(t.shape,"float32")}}};const pOe={kernelName:ok,gradFunc:n=>({x:()=>Rr(n)})};const mOe={kernelName:ck,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return Sd(n,s).map(a=>()=>a)}};const wH={kernelName:uk,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,a=r.map(o=>o[0]);return{x:()=>Pr(n,a,s.shape)}}};const gOe={kernelName:g_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,r]=e,a=t,o=s,l=Gs(a.shape,o.shape);return{a:()=>{const f=Cn(o,"float32");let d=et(n,et(f,Rg(a,Bn(f,ws(1)))));const h=tl(a.shape,l);return h.length>0&&(d=Xn(d,h)),nt(d,a.shape)},b:()=>{const f=Su(a,0),d=Fl(f,If(a),Rr(a));let h=et(n,et(r,d));const p=tl(o.shape,l);return p.length>0&&(h=Xn(h,p)),nt(h,o.shape)}}}};const yOe={kernelName:fk,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,r=Su(t,0);return{x:()=>Fl(r,n,et(n,s)),alpha:()=>{let a=Fl(r,Rr(n),et(n,t));const o=tl(s.shape,n.shape);return o.length>0&&(a=Xn(a,o)),nt(a,s.shape)}}}};function bOe(n,e,t){const s=n.shape.slice();s[t]=1;const r=nt(e,s),a=zM(n,t,!0,!1),o=zM(n,t,!0,!0),l=et(a,o);return et(r,l)}function wOe(n,e,t){const s=n.shape.length,r=s-t.length,a=no(t,s);let o=n;a!=null&&(o=Ir(n,a));const l=o.shape.slice(),u=l.splice(s-t.length,t.length).reduce((h,p)=>h*p,1);l.push(u);const f=o.reshape(l);let d=bOe(f,e,r);if(d=d.reshape(o.shape),a!=null){const h=T1(a);d=Ir(d,h)}return d}const vOe={kernelName:dk,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;let a=[];return r==null?a=s.shape.map((o,l)=>l):typeof r=="number"?a=[r]:a=r,{x:()=>wOe(s,n,a)}}};const _Oe={kernelName:J2,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{const l=cs(n,Cn(s,"float32")),c=tl(t.shape,r);return c.length>0?nt(Xn(l,c),t.shape):l},b:()=>{let l=et(n,Cn(t,"float32"));const c=tl(s.shape,r);c.length>0&&(l=nt(Xn(l,c),s.shape));const u=Hi(s);return ya(cs(l,Cn(u,"float32")))}}}};const xOe={kernelName:y_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,ya(Hi(t)))}}};const COe={kernelName:w_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=et(k1(t,6),Qb(t));return{x:()=>et(n,Cn(s,"float32"))}}};const SOe={kernelName:b_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,Cn(Qb(t),"float32"))}}};const MOe={kernelName:hk,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,t.shape)}}};const TOe={kernelName:mk,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>Ge.runKernel(kD,r,t)}}};const kOe={kernelName:pk,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>Ge.runKernel(TD,r,t)}}};const EOe={kernelName:gk,gradFunc:(n,e,t)=>{const{dims:s}=t,r=dr(s,n.shape);return{x:()=>Cd(n,r)}}};const IOe={kernelName:v_,gradFunc:n=>({x:()=>Rr(n)})};const AOe={kernelName:__,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ya(cs(n,et(Rg(t,1.5),2)))}}};const LOe={kernelName:yk,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>Cn(Rr(t),"float32"),t:()=>et(n,Cn(t,n.dtype)),e:()=>et(n,Cn(jk(t),n.dtype))}}};const NOe={kernelName:x_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Su(t,ws(0)),r=ws(NO),a=ws(DO),o=et(n,a),l=et(et(n,r),Ku(Cn(t,"float32")));return Fl(s,o,l)}}}};const DOe={kernelName:T_,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,et(t,Bn(ws(1),t)))}}};const OOe={kernelName:M_,gradFunc:n=>({x:()=>Rr(n)})};const POe={kernelName:C_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(Nk(Cn(t,"float32")),n)}}};const $Oe={kernelName:S_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(JD(Cn(t,"float32")),n)}}};const jOe={kernelName:bk,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:r,size:a}=t,o=s.shape,[l,c]=AO(s,r,a),u=[];for(let f=0;f<n.rank;f++)u.push([l[f],o[f]-l[f]-c[f]]);return{x:()=>Yg(n,u)}}};const ROe={kernelName:xk,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:r}=t,a=!0,o=et(n,s);return{logits:()=>Bn(o,et(Xn(o,[r],a),s))}}};const FOe={kernelName:k_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,lp(t))}}};const vH={kernelName:vk,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:r}=t;return{x:()=>Lk(n,s,r)}}};const _H={kernelName:_k,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>Po(n,s)}}};const zOe={kernelName:E_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,et(pc(Cn(t,"float32")),2))}}};const BOe={kernelName:$D,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(n,et(Cn(t,"float32"),2))}}};const UOe={kernelName:I_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ws(2);return{a:()=>et(n,et(r,Bn(t,s))),b:()=>et(n,et(r,Bn(s,t)))}}};const VOe={kernelName:O_,gradFunc:n=>({x:()=>Rr(n)})};const WOe={kernelName:A_,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Gs(t.shape,s.shape);return{a:()=>{let l=n;const c=tl(t.shape,r);return c.length>0&&(l=Xn(l,c)),nt(l,t.shape)},b:()=>{let l=n;const c=tl(s.shape,r);return c.length>0&&(l=Xn(l,c)),nt(ya(l),s.shape)}}}};const GOe={kernelName:wk,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,r=s.shape.slice(),{axis:a}=t;dr(a,s.shape).forEach(u=>{r[u]=1});const l=nt(n,r),c=et(l,Fu(s.shape,"float32"));return{x:()=>c}}};const HOe={kernelName:L_,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>cs(n,Hi(Nk(t)))}}};const qOe={kernelName:N_,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>et(Bn(ws(1),Hi(t)),n)}}};const YOe={kernelName:D_,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:r}=t;return{x:()=>{let o=Rr(s);if(s.rank===1)for(let l=0;l<r[0];++l)o=ln(o,Pr(n,[l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)o=ln(o,Pr(n,[l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)for(let u=0;u<r[2];++u)o=ln(o,Pr(n,[l*s.shape[0],c*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)for(let u=0;u<r[2];++u)for(let f=0;f<r[3];++f)o=ln(o,Pr(n,[l*s.shape[0],c*s.shape[1],u*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};const KOe={kernelName:nb,gradFunc:(n,e,t)=>{const s=t,{perm:r}=s,a=T1(r);return{x:()=>Ir(n,a)}}};const XOe={kernelName:Sk,gradFunc:(n,e,t)=>{const s=t,{axis:r}=s;return{value:()=>_u(n,r)}}};const QOe={kernelName:Mk,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>JOe(n,t)}}};function JOe(n,e){const t=Fm(e,Rr(e)),s=z_(n,t);let r=qg(e,ws(0,"int32"));const a=s.rank-r.rank;for(let l=0;l<a;++l)r=lc(r,l+1);r=gh(r,Fu(s.shape,"bool"));const o=Rr(s);return Fl(r,s,o)}const ZOe={kernelName:Tk,gradFunc:n=>({x:()=>Rr(n)})};const ePe=[Uae,Q4e,J4e,Z4e,eDe,tDe,nDe,sDe,rDe,iDe,aDe,oDe,uDe,hDe,pDe,mDe,gDe,yDe,bDe,wDe,vDe,_De,CDe,xDe,TDe,kDe,EDe,IDe,ADe,LDe,_Oe,NDe,DDe,ODe,PDe,$De,RDe,jDe,FDe,zDe,BDe,UDe,VDe,WDe,GDe,HDe,qDe,YDe,KDe,JDe,bH,bH,ZDe,nOe,iOe,aOe,oOe,lOe,cOe,uOe,fOe,dOe,hOe,pOe,mOe,wH,wH,gOe,yOe,vOe,xOe,COe,SOe,MOe,TOe,kOe,EOe,IOe,AOe,LOe,NOe,DOe,OOe,POe,$Oe,jOe,ROe,FOe,vH,vH,_H,_H,zOe,UOe,BOe,VOe,WOe,GOe,HOe,qOe,YOe,KOe,XOe,QOe,ZOe];for(const n of ePe)ure(n);jt().prototype.abs=function(){return this.throwIfDisposed(),Go(this)};jt().prototype.acos=function(){return this.throwIfDisposed(),dz(this)};jt().prototype.acosh=function(){return this.throwIfDisposed(),hz(this)};jt().prototype.add=function(n){return this.throwIfDisposed(),ln(this,n)};jt().prototype.all=function(n,e){return this.throwIfDisposed(),KD(this,n,e)};jt().prototype.any=function(n,e){return this.throwIfDisposed(),jM(this,n,e)};jt().prototype.argMax=function(n){return this.throwIfDisposed(),yb(this,n)};jt().prototype.argMin=function(n){return this.throwIfDisposed(),pz(this,n)};jt().prototype.asScalar=function(){return this.throwIfDisposed(),we(this.size===1,()=>"The array must have only 1 element."),nt(this,[])};jt().prototype.asType=function(n){return this.throwIfDisposed(),Cn(this,n)};jt().prototype.as1D=function(){return this.throwIfDisposed(),nt(this,[this.size])};jt().prototype.as2D=function(n,e){return this.throwIfDisposed(),nt(this,[n,e])};jt().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),nt(this,[n,e,t])};jt().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),nt(this,[n,e,t,s])};jt().prototype.as5D=function(n,e,t,s,r){return this.throwIfDisposed(),nt(this,[n,e,t,s,r])};jt().prototype.asin=function(){return this.throwIfDisposed(),mz(this)};jt().prototype.asinh=function(){return this.throwIfDisposed(),gz(this)};jt().prototype.atan=function(){return this.throwIfDisposed(),yz(this)};jt().prototype.atan2=function(n){return this.throwIfDisposed(),bz(this,n)};jt().prototype.atanh=function(){return this.throwIfDisposed(),wz(this)};jt().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),Ak(this,n,e,t,s)};jt().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),Lk(this,n,e)};jt().prototype.batchNorm=function(n,e,t,s,r){return this.throwIfDisposed(),P_(this,n,e,t,s,r)};jt().prototype.broadcastTo=function(n){return this.throwIfDisposed(),sb(this,n)};jt().prototype.cast=function(n){return this.throwIfDisposed(),Cn(this,n)};jt().prototype.ceil=function(){return this.throwIfDisposed(),Tz(this)};jt().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),Yu(this,n,e)};jt().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof jr&&(n=[n]),Po([this,...n],e)};jt().prototype.conv1d=function(n,e,t,s,r,a){return this.throwIfDisposed(),XD(this,n,e,t,s,r,a)};jt().prototype.conv2dTranspose=function(n,e,t,s,r){return this.throwIfDisposed(),QD(this,n,e,t,s,r)};jt().prototype.conv2d=function(n,e,t,s,r,a){return this.throwIfDisposed(),jg(this,n,e,t,s,r,a)};jt().prototype.cos=function(){return this.throwIfDisposed(),Nk(this)};jt().prototype.cosh=function(){return this.throwIfDisposed(),JD(this)};jt().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),zM(this,n,e,t)};jt().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),ZD(this,n,e,t)};jt().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),Oz(this,n,e)};jt().prototype.depthwiseConv2d=function(n,e,t,s,r,a){return this.throwIfDisposed(),$_(this,n,e,t,s,r,a)};jt().prototype.dilation2d=function(n,e,t,s,r){return this.throwIfDisposed(),Pz(this,n,e,t,s,r)};jt().prototype.divNoNan=function(n){return this.throwIfDisposed(),$z(this,n)};jt().prototype.div=function(n){return this.throwIfDisposed(),cs(this,n)};jt().prototype.dot=function(n){return this.throwIfDisposed(),jz(this,n)};jt().prototype.elu=function(){return this.throwIfDisposed(),j_(this)};jt().prototype.equal=function(n){return this.throwIfDisposed(),Ef(this,n)};jt().prototype.erf=function(){return this.throwIfDisposed(),Rz(this)};jt().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),zz(this,n,e)};jt().prototype.exp=function(){return this.throwIfDisposed(),Ku(this)};jt().prototype.expandDims=function(n){return this.throwIfDisposed(),lc(this,n)};jt().prototype.expm1=function(){return this.throwIfDisposed(),Bz(this)};jt().prototype.fft=function(){return this.throwIfDisposed(),Gk(this)};jt().prototype.flatten=function(){return this.throwIfDisposed(),nt(this,[this.size])};jt().prototype.floor=function(){return this.throwIfDisposed(),F_(this)};jt().prototype.floorDiv=function(n){return this.throwIfDisposed(),YD(this,n)};jt().prototype.gather=function(n,e,t){return this.throwIfDisposed(),z_(this,n,e,t)};jt().prototype.greaterEqual=function(n){return this.throwIfDisposed(),qg(this,n)};jt().prototype.greater=function(n){return this.throwIfDisposed(),Su(this,n)};jt().prototype.ifft=function(){return this.throwIfDisposed(),h2(this)};jt().prototype.irfft=function(){return this.throwIfDisposed(),pO(this)};jt().prototype.isFinite=function(){return this.throwIfDisposed(),Uz(this)};jt().prototype.isInf=function(){return this.throwIfDisposed(),Vz(this)};jt().prototype.isNaN=function(){return this.throwIfDisposed(),Wz(this)};jt().prototype.leakyRelu=function(n){return this.throwIfDisposed(),Ok(this,n)};jt().prototype.lessEqual=function(n){return this.throwIfDisposed(),k1(this,n)};jt().prototype.less=function(n){return this.throwIfDisposed(),c2(this,n)};jt().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),Gz(this,n,e,t,s)};jt().prototype.logSigmoid=function(){return this.throwIfDisposed(),Hz(this)};jt().prototype.logSoftmax=function(n){return this.throwIfDisposed(),nO(this,n)};jt().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),$k(this,n,e)};jt().prototype.log=function(){return this.throwIfDisposed(),If(this)};jt().prototype.log1p=function(){return this.throwIfDisposed(),Pk(this)};jt().prototype.logicalAnd=function(n){return this.throwIfDisposed(),gh(this,n)};jt().prototype.logicalNot=function(){return this.throwIfDisposed(),jk(this)};jt().prototype.logicalOr=function(n){return this.throwIfDisposed(),sO(this,n)};jt().prototype.logicalXor=function(n){return this.throwIfDisposed(),qz(this,n)};jt().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),fr(this,n,e,t)};jt().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),Rk(this,n,e,t,s)};jt().prototype.max=function(n,e){return this.throwIfDisposed(),bd(this,n,e)};jt().prototype.maximum=function(n){return this.throwIfDisposed(),Fm(this,n)};jt().prototype.mean=function(n,e){return this.throwIfDisposed(),Ja(this,n,e)};jt().prototype.min=function(n,e){return this.throwIfDisposed(),l2(this,n,e)};jt().prototype.minimum=function(n){return this.throwIfDisposed(),h1(this,n)};jt().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),Kz(this,n,e)};jt().prototype.mod=function(n){return this.throwIfDisposed(),Xz(this,n)};jt().prototype.mul=function(n){return this.throwIfDisposed(),et(this,n)};jt().prototype.neg=function(){return this.throwIfDisposed(),ya(this)};jt().prototype.norm=function(n,e,t){return this.throwIfDisposed(),R_(this,n,e,t)};jt().prototype.notEqual=function(n){return this.throwIfDisposed(),_b(this,n)};jt().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),u2(this,n,e,t)};jt().prototype.onesLike=function(){return this.throwIfDisposed(),Af(this)};jt().prototype.pad=function(n,e){return this.throwIfDisposed(),Yg(this,n,e)};jt().prototype.pool=function(n,e,t,s,r,a){return this.throwIfDisposed(),Qz(this,n,e,t,s,r,a)};jt().prototype.pow=function(n){return this.throwIfDisposed(),Rg(this,n)};jt().prototype.prelu=function(n){return this.throwIfDisposed(),Bk(this,n)};jt().prototype.prod=function(n,e){return this.throwIfDisposed(),Jz(this,n,e)};jt().prototype.reciprocal=function(){return this.throwIfDisposed(),nB(this)};jt().prototype.relu=function(){return this.throwIfDisposed(),Sp(this)};jt().prototype.relu6=function(){return this.throwIfDisposed(),aO(this)};jt().prototype.reshapeAs=function(n){return this.throwIfDisposed(),nt(this,n.shape)};jt().prototype.reshape=function(n){return this.throwIfDisposed(),nt(this,n)};jt().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),Pie(this,n,e,t)};jt().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),$ie(this,n,e,t)};jt().prototype.reverse=function(n){return this.throwIfDisposed(),Cd(this,n)};jt().prototype.rfft=function(){return this.throwIfDisposed(),Hk(this)};jt().prototype.round=function(){return this.throwIfDisposed(),oO(this)};jt().prototype.rsqrt=function(){return this.throwIfDisposed(),lO(this)};jt().prototype.selu=function(){return this.throwIfDisposed(),cO(this)};jt().prototype.separableConv2d=function(n,e,t,s,r,a){return this.throwIfDisposed(),uO(this,n,e,t,s,r,a)};jt().prototype.sigmoid=function(){return this.throwIfDisposed(),lp(this)};jt().prototype.sign=function(){return this.throwIfDisposed(),sB(this)};jt().prototype.sin=function(){return this.throwIfDisposed(),fO(this)};jt().prototype.sinh=function(){return this.throwIfDisposed(),dO(this)};jt().prototype.slice=function(n,e){return this.throwIfDisposed(),Pr(this,n,e)};jt().prototype.softmax=function(n){return this.throwIfDisposed(),Wk(this,n)};jt().prototype.softplus=function(){return this.throwIfDisposed(),Xb(this)};jt().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),zk(this,n,e)};jt().prototype.split=function(n,e){return this.throwIfDisposed(),Uu(this,n,e)};jt().prototype.sqrt=function(){return this.throwIfDisposed(),pc(this)};jt().prototype.square=function(){return this.throwIfDisposed(),Hi(this)};jt().prototype.squaredDifference=function(n){return this.throwIfDisposed(),mO(this,n)};jt().prototype.squeeze=function(n){return this.throwIfDisposed(),I1(this,n)};jt().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof jr?[this,n]:[this,...n];return _u(t,e)};jt().prototype.step=function(n){return this.throwIfDisposed(),Qb(this,n)};jt().prototype.stridedSlice=function(n,e,t,s,r,a,o,l){return this.throwIfDisposed(),rB(this,n,e,t,s,r,a,o,l)};jt().prototype.sub=function(n){return this.throwIfDisposed(),Bn(this,n)};jt().prototype.sum=function(n,e){return this.throwIfDisposed(),Xn(this,n,e)};jt().prototype.tan=function(){return this.throwIfDisposed(),iB(this)};jt().prototype.tanh=function(){return this.throwIfDisposed(),wb(this)};jt().prototype.tile=function(n){return this.throwIfDisposed(),hd(this,n)};jt().prototype.toBool=function(){return this.throwIfDisposed(),Cn(this,"bool")};jt().prototype.toFloat=function(){return this.throwIfDisposed(),Cn(this,"float32")};jt().prototype.toInt=function(){return this.throwIfDisposed(),Cn(this,"int32")};jt().prototype.topk=function(n,e){return this.throwIfDisposed(),lB(this,n,e)};jt().prototype.transpose=function(n){return this.throwIfDisposed(),Ir(this,n)};jt().prototype.unique=function(n){return this.throwIfDisposed(),cB(this,n)};jt().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),bO(this,n,e)};jt().prototype.unstack=function(n){return this.throwIfDisposed(),Sd(this,n)};jt().prototype.where=function(n,e){return this.throwIfDisposed(),Fl(n,this,e)};jt().prototype.zerosLike=function(){return this.throwIfDisposed(),Rr(this)};class hm extends Error{constructor(e){super(e),Object.setPrototypeOf(this,hm.prototype)}}class uh extends Error{constructor(e){super(e),Object.setPrototypeOf(this,uh.prototype)}}class at extends Error{constructor(e){super(e),Object.setPrototypeOf(this,at.prototype)}}class er extends Error{constructor(e){super(e),Object.setPrototypeOf(this,er.prototype)}}class ZB extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ZB.prototype)}}class Wae{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}function Sb(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function pm(n,e){if(!n)throw new ZB(e)}function xH(n,e){let t=0;for(const s of n)s===e&&t++;return t}function Ru(n){return n.length===1?n[0]:n}function sa(n){return Array.isArray(n)?n:[n]}function wg(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Fy(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Kd={};function e8(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function zR(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>zR(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:zR(s))}}}function Qk(n,e={},t={},s="object",r=!1){if(typeof n=="string"){const a=n;let o;if(a in t)o=t[a];else if(a in Kd)o=Kd[a];else if(o=e[a],o==null)throw new at(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const a=n;if(a.className==null||a.config==null)throw new at(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const o=a.className;let l,c;if(o in t?[l,c]=t[o]:o in Kd?[l,c]=Kd.className:o in e&&([l,c]=e[o]),l==null)throw new at(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){const u={};for(const p of Object.keys(Kd))u[p]=Kd[p];for(const p of Object.keys(t))u[p]=t[p];const f=a.config;f.customObjects=u;const d=Object.assign({},Kd);for(const p of Object.keys(t))Kd[p]=t[p];zR(a.config);const h=c(l,a.config,t,r);return Kd=Object.assign({},d),h}else{const u=Object.assign({},Kd);for(const d of Object.keys(t))Kd[d]=t[d];const f=new l(a.config);return Kd=Object.assign({},u),f}}}function tPe(n,e){return n<e?-1:n>e?1:0}function II(n,e){return-1*tPe(n,e)}function r1(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function nPe(n){if(n==null)throw new at(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Zb(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new at(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function t8(n,e,t=0,s=1/0){return pm(t>=0),pm(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(r=>typeof r===e)}function jl(n,e){Array.isArray(n)?(we(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>jl(t,`element ${s+1} of ${e}`))):we(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${Gae(n)}.`)}function Gae(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>Gae(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function sPe(n,e,t){let s=t!=null?t():oc(),r;return(...o)=>{const l=t!=null?t():oc();return l-s<e||(s=l,r=n(...o)),r}}function Hae(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}let rPe=0;function qae(){return rPe++}const AI={};function OO(n=""){return n in AI||(AI[n]=0),AI[n]+=1,n+AI[n].toString()}const iPe=["channelsFirst","channelsLast"],aPe=["nearest","bilinear"],oPe=["valid","same","causal"],lPe=["max","avg"],cPe=["sum","mul","concat","ave"];const mv=new Map;function Ro(n){Zb(iPe,"DataFormat",n)}function uPe(n){Zb(aPe,"InterpolationFormat",n)}function kd(n){Zb(oPe,"PaddingMode",n)}function Yae(n){Zb(lPe,"PoolMode",n)}const hM=[],CH="/";function ib(n,e){hM.push(n);try{const t=e();return hM.pop(),t}catch(t){throw hM.pop(),t}}function fPe(){return hM.length===0?"":hM.join(CH)+CH}function Kae(n){if(!Qae(n))throw new Error("Not a valid tensor name: '"+n+"'");return fPe()+n}function Xae(n){if(!Qae(n))throw new Error("Not a valid tensor name: '"+n+"'");mv.has(n)||mv.set(n,0);const e=mv.get(n);if(mv.set(n,mv.get(n)+1),e>0){const t=`${n}_${e}`;return mv.set(t,1),t}else return n}const dPe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Qae(n){return!!n.match(dPe)}function hPe(n){return n===parseInt(n.toString(),10)}function i1(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let r=e;r<t;++r)s*=n[r];return s}function p2(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function p1(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function gp(n,e){if(e<n)throw new at(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}let k5;function wl(){return k5==null&&(k5=$re().epsilon()),k5}function yp(){return"channelsLast"}function Tm(n,e){return Cn(n,e)}function Jk(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),nt(n,t)}function pPe(n,e){return wt(()=>{if(n.shape.length!==2)throw new at(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Jk(n,1);return BR(t,[1,e,1])})}function mPe(n){const e=[i1(n.shape)];return nt(n,e)}function gPe(n){if(n.rank<=1)throw new at(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],i1(n.shape,1)];return nt(n,e)}function ab(n,e,t){return wt(()=>{switch(n.rank){case 1:return Uk(n,e,t);case 2:return hO(n,[e,0],[t,n.shape[1]]);case 3:return Vk(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return d2(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Pr(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Pr(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new at(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function E5(n,e,t){return wt(()=>{switch(n.rank){case 1:return Uk(n,e,t);case 2:return hO(n,[0,e],[n.shape[0],t]);case 3:return Vk(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return d2(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new at(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function LI(n,e,t,s){return wt(()=>{switch(n.rank){case 1:return Uk(n,e,t);case 2:switch(s){case 1:return ab(n,e,t);case 2:return E5(n,e,t);default:throw new at(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return ab(n,e,t);case 2:return Vk(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return E5(n,e,t);default:throw new at(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return ab(n,e,t);case 2:return d2(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return d2(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return E5(n,e,t);default:throw new at(`The axis is not within the rank of the tensor ${s}`)}default:throw new at(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function n8(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),Po(n,e)}function SH(n,e){switch(n.rank){case 1:return kz([n,e]);case 2:return Ez([n,e],0);case 3:return Iz([n,e],0);case 4:return Az([n,e],0);default:throw new at(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function BR(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new at(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return hd(n,e)}function PO(n,e=0,t=1,s,r){return iO(n,e,t,s,r)}function km(n,e,t,s){if(n.rank<2||e.rank<2)throw new er(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=n.shape.slice(-1)[0],a=e.shape.slice(-2)[0];if(r!==a)throw new er(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return DR({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?UR(n.rank,s,yp()):null,activation:t});{const r=n.shape.slice(),a=r.pop();n=nt(n,[-1,a]);const o=e.shape.slice(),l=o.pop(),c=o.pop(),u=[...o,l],f=Array.from({length:e.rank},(g,b)=>b===0?e.rank-2:b<=e.rank-2?b-1:b);e=nt(Ir(e,f),[c,-1]);const d=[...r,...u];return nt(DR({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?UR(n.rank,s,yp()):null,activation:t}),d)}}function Jae(n,e,t){return wt(()=>(Array.isArray(e)?e=fc(e,"int32"):e=Cn(e,"int32"),z_(n,e,t)))}function Zk(n){return et(n,n)}function UR(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new at(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?nt(e,[1,s[0],1,1,1]):nt(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?nt(e,[1,1,1,1,s[0]]):nt(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?nt(e,[1,s[0],1,1]):nt(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?nt(e,[1,1,1,s[0]]):nt(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?nt(e,[1,s[0],1]):nt(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?nt(e,[1,1,s[0]]):nt(e,[1].concat(s))}else if(n<3)return e;throw new at(`Unsupported input rank by biasAdd: ${e.rank}`)}function Mp(n,e,t){return wt(()=>(t==null&&(t=yp()),Ro(t),ln(n,UR(n.rank,e,t))))}function yPe(n,e=1){if(e!==1)throw new er(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return j_(n)}function bPe(n){return wt(()=>cs(n,ln(Go(n),1)))}function Zae(n,e,t,s){return wt(()=>dB(n,e,t,s))}function wPe(n){return wt(()=>{const e=ln(.5,et(.2,n));return Yu(e,0,1)})}function eE(n,e,t=!1){return t?n():e()}const vPe=["fanIn","fanOut","fanAvg"],_Pe=["normal","uniform","truncatedNormal"];function xPe(n){Zb(vPe,"FanMode",n)}function CPe(n){Zb(_Pe,"Distribution",n)}class _h extends Jb{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class s8 extends _h{apply(e,t){return Xo(e,t)}}s8.className="Zeros";fn(s8);class $O extends _h{apply(e,t){return Fu(e,t)}}$O.className="Ones";fn($O);class r8 extends _h{constructor(e){if(super(),typeof e!="object")throw new at(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new at(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return wt(()=>et(ws(this.value),Fu(e,t)))}getConfig(){return{value:this.value}}}r8.className="Constant";fn(r8);class i8 extends _h{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return E1(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}i8.className="RandomUniform";fn(i8);class a8 extends _h{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new er(`randomNormal does not support dType ${t}.`);return PO(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}a8.className="RandomNormal";fn(a8);class o8 extends _h{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new er(`truncatedNormal does not support dType ${t}.`);return yO(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}o8.className="TruncatedNormal";fn(o8);class l8 extends _h{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return wt(()=>{if(e.length!==2||e[0]!==e[1])throw new at("Identity matrix initializer can only be used for 2D square matrices.");return et(this.gain,eO(e[0]))})}getConfig(){return{gain:this.gain}}}l8.className="Identity";fn(l8);function SPe(n,e="channelsLast"){let t,s;if(Ro(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const r=i1(n,2);t=n[1]*r,s=n[0]*r}else if(e==="channelsLast"){const r=i1(n,0,n.length-2);t=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=i1(n);t=Math.sqrt(r),s=Math.sqrt(r)}return[t,s]}class Xu extends _h{constructor(e){if(super(),e.scale<0)throw new at(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,xPe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,CPe(this.distribution),this.seed=e.seed}apply(e,t){const s=SPe(e),r=s[0],a=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,a):o/=Math.max(1,(r+a)/2),this.distribution==="normal"){const l=Math.sqrt(o);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new er(`${this.getClassName()} does not support dType ${t}.`);return yO(e,0,l,t,this.seed)}else{const l=Math.sqrt(3*o);return E1(e,-l,l,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Xu.className="VarianceScaling";fn(Xu);class jO extends Xu{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Xu.className}}jO.className="GlorotUniform";fn(jO);class RO extends Xu{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Xu.className}}RO.className="GlorotNormal";fn(RO);class FO extends Xu{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Xu.className}}FO.className="HeNormal";fn(FO);class zO extends Xu{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Xu.className}}zO.className="HeUniform";fn(zO);class BO extends Xu{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Xu.className}}BO.className="LeCunNormal";fn(BO);class UO extends Xu{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Xu.className}}UO.className="LeCunUniform";fn(UO);class c8 extends _h{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return wt(()=>{if(e.length<2)throw new er("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=Ot(e.slice(0,-1)),r=e[e.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],l=PO(o,0,1,t,this.seed),c=gB.qr(l,!1);let u=c[0];const d=c[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=et(u,d.sign()),s<r&&(u=u.transpose()),et(ws(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}c8.className="Orthogonal";fn(c8);const MH={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function TH(n,e={}){return Qk(n,ud.getMap().classNameMap,e,"initializer")}function eo(n){return e8(n)}function za(n){if(typeof n=="string"){const e=n in MH?MH[n]:n;if(e==="GlorotNormal")return new RO;if(e==="GlorotUniform")return new jO;if(e==="HeNormal")return new FO;if(e==="HeUniform")return new zO;if(e==="LeCunNormal")return new BO;if(e==="LeCunUniform")return new UO;{const t={};return t.className=e,t.config={},TH(t)}}else return n instanceof _h?n:TH(n)}function VR(n){return Array.isArray(n)&&Array.isArray(n[0])}function LN(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function js(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new at(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function ii(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new at(`Expected exactly 1 Shape; got ${n.length}`)}else return n}function NN(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,r)=>s*r);return e}const kH="Variable";class eoe{constructor(e,t="float32",s=kH,r=!0,a=null){this.dtype=t??"float32",this.shape=e.shape,this.id=qae(),s=s??kH,this.originalName=Kae(s),this.name=Xae(this.originalName),this.trainable_=r,this.constraint=a,this.val=uB(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),MPe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function MPe(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function WR(n){return n.map(e=>e.read())}function u8(n){n.forEach(e=>{e[0].write(e[1])})}class Jo{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class bp{constructor(e,t,s,r,a,o,l){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=l,this.id=qae(),o!=null&&(this.originalName=Kae(o),this.name=Xae(this.originalName)),this.rank=t.length}}let TPe=0;class VO{constructor(e,t){this.callArgs=t,this.id=TPe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let kPe=0;class hr extends Jb{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=kPe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=wg(s)+"_"+OO(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),s=[a].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new uh(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new at(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ru(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ru(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new hm(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new hm(`Layer ${this.name} is not connected, no input to return.`);return Ru(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new hm(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new hm(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ru(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=sa(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=sa(this.inputSpec);if(t.length!==s.length)throw new at(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const a=t[r],o=s[r];if(o==null)continue;const l=a.rank;if(o.ndim!=null&&l!==o.ndim)throw new at(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${l}`);if(o.maxNDim!=null&&l>o.maxNDim)throw new at(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${l}`);if(o.minNDim!=null&&l<o.minNDim)throw new at(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${l}.`);if(o.dtype!=null&&a.dtype!==o.dtype)throw new at(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${a.dtype}.`);if(o.axes){const c=a.shape;for(const u in o.axes){const f=Number(u),d=o.axes[u],h=f>=0?c[f]:c[c.length+f];if(d!=null&&[d,null].indexOf(h)===-1)throw new at(`Input ${r} is incompatible with layer ${this.name}: expected axis ${f} of input shape to have value ${d} but got shape ${c}.`)}}if(o.shape!=null)for(let c=0;c<o.shape.length;++c){const u=o.shape[c],f=a.shape[c];if(u!=null&&f!=null&&u!==f)throw new at(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${a.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=sa(e),r=APe(e),a=LPe(e);if(r===a)throw new at("Arguments to apply() must be all SymbolicTensors or all Tensors");return ib(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const l of sa(e))o.push(l.shape);this.build(Ru(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let o=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,o);const l=sa(o),c=[];for(let u of l)s.indexOf(u)!==-1&&(u=u.clone()),c.push(u);if(o=Ru(c),this.activityRegularizer!=null)throw new er("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=EPe(e),l=this.computeOutputShape(o);let c;const u=IPe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),l!=null&&l.length>0&&Array.isArray(l[0])?c=l.map((f,d)=>new bp(u,f,this,sa(e),t,this.name,d)):c=new bp(u,l,this,sa(e),t,this.name),this.addInboundNode(e,c,null,null,o,l,t),this._refCount++,this.activityRegularizer!=null)throw new er("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new hm(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new hm(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new uh(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return NN(this.weights)}build(e){this.built=!0}getWeights(e=!1){return WR(e?this.trainableWeights:this.weights)}setWeights(e){wt(()=>{const t=this.weights;if(t.length!==e.length)throw new at(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],r=WR(t);for(let a=0;a<r.length;++a){const o=r[a],l=t[a],c=e[a];if(!xr(o.shape,c.shape))throw new at(`Layer weight shape ${o.shape} not compatible with provided weight shape ${c.shape}`);s.push([l,c])}u8(s)})}addWeight(e,t,s,r,a,o,l,c){if(this._addedWeightNames.indexOf(e)!==-1)throw new at(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=c!=null?c():za("zeros"));const u=r.apply(t,s),f=new eoe(u,s,e,o,l);return u.dispose(),a!=null&&this.addLoss(()=>a.apply(f.read())),o==null&&(o=!0),o?this._trainableWeights.push(f):this._nonTrainableWeights.push(f),f}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=sa(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s);if(t instanceof Array&&r instanceof Array){if(t.length!==r.length)throw new Error(`${this.name} outputs ${t.length} tensors but ${r.length} masks for those tensors`);for(let a=0;a<t.length;a++)t[a].kerasMask=r[a]}else{if(r instanceof Array)throw new Error(`{this.name} outputs a single tensor but ${r.length} masks`);if(t instanceof Array)throw new Error(`{this.name} outputs ${t.length} tensors but only one mask`);t.kerasMask=r}}addInboundNode(e,t,s,r,a,o,l=null){const c=sa(e);t=sa(t),s=sa(s),r=sa(r),a=LN(a),o=LN(o);const u=[],f=[],d=[];for(const h of c)u.push(h.sourceLayer),f.push(h.nodeIndex),d.push(h.tensorIndex);new VO({outboundLayer:this,inboundLayers:u,nodeIndices:f,tensorIndices:d,inputTensors:c,outputTensors:t,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:o},l);for(let h=0;h<t.length;h++)t[h].sourceLayer=this,t[h].nodeIndex=this.inboundNodes.length-1,t[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function EPe(n){n=sa(n);const e=[];for(const t of n)e.push(t.shape);return Ru(e)}function IPe(n){return"float32"}function toe(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const o=s.inputTensors[a],l=s.inboundLayers[a],c=s.nodeIndices[a],u=toe(o,l,c);for(const f of u)r.indexOf(f)===-1&&r.push(f)}return r}}}function APe(n){let e=!0;for(const t of sa(n))if(!(t instanceof bp)){e=!1;break}return e}function LPe(n){let e=!0;for(const t of sa(n))if(t instanceof bp){e=!1;break}return e}class V_ extends hr{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:OO("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new at("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new at("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new at("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const r=new bp(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new VO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new at(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}V_.className="InputLayer";fn(V_);function noe(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new at("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new V_({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}function NPe(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return Cn(e,n.dtype)}catch{throw new at(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class K0{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof K0)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=NPe(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new at(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof bp){if(this.id2Value[e.id]==null)throw new at(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new at(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof bp){if(this.id2Value[e.id]==null)throw new at(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new at(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Ws(this.id2Mask)}}const DN=new Wae,ON=new Wae;function DPe(n){DN?.setMaxEntries(n),ON?.setMaxEntries(n)}function BS(n,e,t,s){const r=t==null?!1:t.training,a=Array.isArray(n),o=a?n:[n],l=o.map(g=>g.name),c=[],u=e.names();for(const g of l)u.indexOf(g)!==-1?c.push(e.getValue(g)):c.push(null);const f=l.join(",")+"|"+e.names().sort().join(",");let d=DN.get(f),h;if(d==null){const g=OPe(o,e);d=g.sorted,h=g.recipientCounts,DN.put(f,d),ON.put(f,h)}h={},r||Object.assign(h,ON.get(f));const p=new K0(e);for(let g=0;g<d.length;++g){const b=d[g],v=b.sourceLayer;if(v instanceof V_)continue;const w=[],x=[],S=[];let C=!1;for(const A of b.inputs){const D=p.getValue(A),L=p.getMask(A);w.push(D),x.push(L),L!=null&&(C=!0),r||(h[A.name]--,h[A.name]===0&&!e.hasKey(A)&&l.indexOf(A.name)===-1&&!D.isDisposed&&A.sourceLayer.stateful!==!0&&S.push(D))}C&&(t=t||{},t.mask=x[0]);const M=sa(v.apply(w,t));let k=null;v.supportsMasking&&(k=v.computeMask(w,x));const E=$Pe(b),I=Array.isArray(E)?E:[E];for(let A=0;A<I.length;++A){p.hasKey(I[A])||p.add(I[A],M[A],Array.isArray(k)?k[0]:k);const D=l.indexOf(I[A].name);D!==-1&&(c[D]=M[A])}r||Ws(S)}return p.disposeMasks(),a?c:c[0]}function OPe(n,e){we(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const r=EH(n[0],e);t=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of n){const{sorted:o,recipientMap:l}=EH(a,e);for(const c of o)r.has(c.name)||(t.push(c),r.add(c.name));for(const c in l)s[c]==null&&(s[c]=new Set),l[c].forEach(u=>s[c].add(u))}}return{sorted:t,recipientCounts:PPe(s)}}function PPe(n){const e={};for(const t in n)e[t]=n[t].size;return e}function EH(n,e){const t=new Set,s=[],r={};for(const l of e.names())t.add(l);const a=[],o=[];for(a.push(n);a.length>0;){const l=a[a.length-1];if(t.has(l.name)){a.pop();continue}const c=o[o.length-1]===a.length-1;if(l.inputs.length===0||c)a.pop(),s.push(l),t.add(l.name),c&&o.pop();else{o.push(a.length-1);for(const u of l.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(l.name),!t.has(u.name)&&a.push(u)}}return{sorted:s,recipientMap:r}}function $Pe(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}const jPe=bt();jPe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,DPe);function f8(n,e){return wt(()=>pc(Xn(et(n,n),e,!0)))}class tE extends Jb{getConfig(){return{}}}class d8 extends tE{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return wt(()=>{const t=f8(e,this.axis),s=Yu(t,0,this.maxValue);return et(e,cs(s,ln(wl(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}d8.className="MaxNorm";fn(d8);class h8 extends tE{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return wt(()=>cs(e,ln(wl(),f8(e,this.axis))))}getConfig(){return{axis:this.axis}}}h8.className="UnitNorm";fn(h8);class p8 extends tE{apply(e){return Sp(e)}}p8.className="NonNeg";fn(p8);class m8 extends tE{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return wt(()=>{const t=f8(e,this.axis),s=ln(et(this.rate,Yu(t,this.minValue,this.maxValue)),et(1-this.rate,t));return et(e,cs(s,ln(wl(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}m8.className="MinMaxNorm";fn(m8);const IH={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function _l(n){return e8(n)}function AH(n,e={}){return Qk(n,ud.getMap().classNameMap,e,"constraint")}function xl(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in IH?IH[n]:n,config:{}};return AH(t)}else return n instanceof tE?n:AH(n)}function RPe(n){return new d8(n)}function FPe(n){return new h8(n)}function zPe(){return new p8}function BPe(n){return new m8(n)}const UPe=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:RPe,minMaxNorm:BPe,nonNeg:zPe,unitNorm:FPe},Symbol.toStringTag,{value:"Module"}));function VPe(){return new s8}function WPe(){return new $O}function GPe(n){return new r8(n)}function HPe(n){return new i8(n)}function qPe(n){return new a8(n)}function YPe(n){return new o8(n)}function KPe(n){return new l8(n)}function XPe(n){return new Xu(n)}function QPe(n){return new jO(n)}function JPe(n){return new RO(n)}function ZPe(n){return new FO(n)}function e3e(n){return new zO(n)}function t3e(n){return new BO(n)}function n3e(n){return new UO(n)}function s3e(n){return new c8(n)}const r3e=Object.freeze(Object.defineProperty({__proto__:null,constant:GPe,glorotNormal:JPe,glorotUniform:QPe,heNormal:ZPe,heUniform:e3e,identity:KPe,leCunNormal:t3e,leCunUniform:n3e,ones:WPe,orthogonal:s3e,randomNormal:qPe,randomUniform:HPe,truncatedNormal:YPe,varianceScaling:XPe,zeros:VPe},Symbol.toStringTag,{value:"Module"}));async function B0(n){if(n==null)return;const e=[],t=[],s=[];for(const r in n){const a=n[r];if(typeof a!="number"){const o=a;e.push(o.data()),t.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let a=0;a<r.length;++a)n[t[a]]=r[a][0];Ws(s)}}function soe(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}var LH;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(LH||(LH={}));const i3e=125;class m2{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class roe{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class a3e extends m2{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const r in t){const a=t[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const l=wt(()=>ln(this.totals[r],et(a,s)));this.totals[r]=l,o?.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:wt(()=>{const r=et(cs(1,this.seen),this.totals[s]);t[s]=r,this.totals[s].dispose(),bl(t[s])}))}}class ioe extends m2{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const a in this.history){const o=this.history[a];for(let l=0;l<o.length;++l)if(typeof o[l]!="number"){const c=o[l];e.push(c.data()),t.push(a),s.push(l)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[t[a]][s[a]].dispose(),this.history[t[a]][s[a]]=r[a][0]}}class aoe extends m2{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||LB,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=i3e),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");_N(this.yieldEvery)&&(this.maybeWait=sPe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const r=[];this.yield!=null&&(await B0(s),r.push(this.yield(e,t,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await B0(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await B0(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await B0(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await B0(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):_N(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await B0(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await B0(e),await this.trainEnd(e))}}function ooe(n,e){return n==null&&(n={}),n instanceof m2?[n]:Array.isArray(n)&&n[0]instanceof m2?n:sa(n).map(s=>new aoe(s,e))}class od{constructor(){}static registerCallbackConstructor(e,t){we(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),od.checkForDuplicate(t),od.constructors[e]==null&&(od.constructors[e]=[]),od.constructors[e].push(t)}static checkForDuplicate(e){for(const t in od.constructors)od.constructors[+t].forEach(r=>{if(r===e)throw new at("Duplicate callback constructor.")})}static clear(){od.constructors={}}static createCallbacks(e){const t=[];for(const s in od.constructors){const r=+s;e>=r&&t.push(...od.constructors[r])}return t.map(s=>new s)}}od.constructors={};function loe(n,e,t,s,r,a,o,l,c){const u=new ioe,f=[new a3e,...od.createCallbacks(e)];n!=null&&f.push(...n),f.push(u);const d=new roe(f);return d.setParams({epochs:t,initialEpoch:s,samples:r,steps:a,batchSize:o,verbose:e,doValidation:l,metrics:c}),{callbackList:d,history:u}}function cp(n,e={},t=!1){return Qk(n,ud.getMap().classNameMap,e,"layer",t)}function PN(n,e){return wt(()=>{n.dtype!=="float32"&&(n=Cn(n,"float32"));const t=Xn(Zk(n),e,!0),s=Kb(t.shape,wl()),r=pc(Fm(t,s));return cs(n,r)})}function ew(n,e){return wt(()=>Ja(Zk(Bn(e,n)),-1))}function WO(n,e){return wt(()=>Ja(Go(Bn(e,n)),-1))}function W_(n,e){return wt(()=>{const t=Bn(n,e),s=Yu(Go(n),wl(),Number.MAX_VALUE),r=Go(cs(t,s));return et(100,Ja(r,-1))})}function o3e(n,e){return wt(()=>{const t=Yu(e,wl(),Number.MAX_VALUE),s=If(ln(1,t)),r=Yu(n,wl(),Number.MAX_VALUE),a=If(ln(1,r));return Ja(Zk(Bn(s,a)),-1)})}function l3e(n,e){return wt(()=>{const t=Fm(0,Bn(1,et(n,e)));return Ja(Zk(t),-1)})}function c3e(n,e){return wt(()=>{const t=Fm(0,Bn(1,et(n,e)));return Ja(t,-1)})}function u3e(n,e){return wt(()=>{const t=Xn(et(n,e),-1),s=bd(et(Bn(1,n),e),-1);return Fm(0,ln(1,Bn(s,t)))})}function f3e(n,e){return wt(()=>{const t=Math.log(2),s=Bn(e,n),r=Bn(ln(s,Xb(et(-2,s))),t);return Ja(r,-1)})}function BM(n,e,t=!1){return wt(()=>{if(t)e=Wk(e);else{const s=Xn(e,e.shape.length-1,!0);e=cs(e,s)}return e=Yu(e,wl(),1-wl()),ya(Xn(et(Cn(n,"float32"),If(e)),e.shape.length-1))})}function $N(n,e,t=!1){return wt(()=>{const s=Cn(F_(mPe(n)),"int32");e=Yu(e,wl(),1-wl());const r=e.shape,a=nt(u2(s,r[r.length-1]),r);return BM(a,e,t)})}function d3e(n,e){if(!xr(n.shape,e.shape))throw new at(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return wt(()=>{const t=Sp(e),s=ya(Go(e));return ln(Bn(t,et(e,n)),Pk(Ku(s)))})}function GO(n,e){return wt(()=>{let t;return t=Yu(e,wl(),1-wl()),t=If(cs(t,Bn(1,t))),Ja(d3e(n,t),-1)})}function h3e(n,e){return wt(()=>{const t=Yu(n,wl(),1),s=Yu(e,wl(),1);return Xn(et(n,If(cs(t,s))),-1)})}function p3e(n,e){return wt(()=>{const t=If(ln(wl(),e));return Ja(Bn(e,et(n,t)),-1)})}function g8(n,e){return wt(()=>{const t=PN(n,-1),s=PN(e,-1),r=et(t,s);return ya(Xn(r,-1))})}const jN={meanSquaredError:ew,meanAbsoluteError:WO,meanAbsolutePercentageError:W_,meanSquaredLogarithmicError:o3e,squaredHinge:l3e,hinge:c3e,categoricalHinge:u3e,logcosh:f3e,categoricalCrossentropy:BM,sparseCategoricalCrossentropy:$N,binaryCrossentropy:GO,kullbackLeiblerDivergence:h3e,poisson:p3e,cosineProximity:g8};function I5(n){if(typeof n=="string"){if(n in jN)return jN[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new at(e)}else return n}function y8(n,e){return wt(()=>{const t=et(.5,Af(e)),s=Tm(Su(e,t),n.dtype);return Ja(Ef(n,s),-1)})}function b8(n,e){return wt(()=>Tm(Ef(yb(n,-1),yb(e,-1)),"float32"))}function coe(n,e){return wt(()=>Cn(Xn(gh(Ef(n,1),Ef(e,1))),"float32"))}function m3e(n,e){return wt(()=>Cn(Xn(gh(Ef(n,1),Ef(e,0))),"float32"))}function g3e(n,e){return wt(()=>Cn(Xn(gh(Ef(n,0),Ef(e,1))),"float32"))}function uoe(n,e){return wt(()=>{const t=coe(n,e),s=g3e(n,e),r=ln(t,s);return Cn(Fl(Su(r,0),cs(t,r),0),"float32")})}function y3e(n,e){return wt(()=>{const t=coe(n,e),s=m3e(n,e),r=ln(t,s);return Cn(Fl(Su(r,0),cs(t,r),0),"float32")})}function foe(n,e){return GO(n,e)}function doe(n,e){return n.rank===e.rank&&(n=I1(n,[n.rank-1])),e=yb(e,-1),e.dtype!==n.dtype&&(e=Cn(e,n.dtype)),Cn(Ef(n,e),"float32")}const b3e=ew,w3e=ew,v3e=WO,_3e=WO,x3e=W_,C3e=W_,w8=BM,S3e=g8,hoe=$N,RN={binaryAccuracy:y8,categoricalAccuracy:b8,precision:uoe,categoricalCrossentropy:w8,sparseCategoricalCrossentropy:hoe,mse:b3e,MSE:w3e,mae:v3e,MAE:_3e,mape:x3e,MAPE:C3e,cosine:S3e};function M3e(n){if(typeof n=="string"&&n in RN)return RN[n];if(typeof n!="string"&&n!=null)return n;throw new at(`Unknown metric ${n}`)}function NI(n){if(pm(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(jN))if(jN[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(RN))if(RN[t]===n){e=t;break}return e!==void 0?e:n.name}}function T3e(n){const e={Adagrad:()=>Ay.adagrad(.01),Adadelta:()=>Ay.adadelta(1,.95,wl()),Adam:()=>Ay.adam(.001,.9,.999,wl()),Adamax:()=>Ay.adamax(.002,.9,.999,wl(),0),RMSProp:()=>Ay.rmsprop(.001,.9,0,wl()),SGD:()=>Ay.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new at(`Unknown Optimizer ${n}`)}const NH=1*1024*1024;function DH(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!GR(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>NH&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${NH}.`)}}function GR(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!GR(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!GR(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}function k3e(n,e,t,s=console.log){const r=I3e(n),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(f=>Math.floor(e*f)));let o;if(!r){a.push("Receives inputs"),o=[];for(const f in n.nodesByDepth)o.push(...n.nodesByDepth[f])}s("_".repeat(e)),FN(a,t,s),s("=".repeat(e));const l=n.layers;for(let f=0;f<l.length;++f)r?A3e(l[f],t,s):L3e(l[f],t,o,s),s((f===l.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const c=E3e(n),u=NN(n.nonTrainableWeights);s(`Total params: ${c+u}`),s(`Trainable params: ${c}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function E3e(n){let e;return n.collectedTrainableWeights!=null?e=NN(n.collectedTrainableWeights):e=NN(n.trainableWeights),e}function I3e(n){let e=!0;const t=[],s=[];for(const r in n.nodesByDepth)t.push(n.nodesByDepth[r]);for(const r of t){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of n.layers){let a=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(a){e=!1;break}else a=!0;if(!e)break}return e}function FN(n,e,t=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);t(s)}function A3e(n,e,t){let s,r;try{r=n.inboundNodes.map(c=>JSON.stringify(c.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const a=n.name,o=n.getClassName(),l=[`${a} (${o})`,r,s,n.countParams().toString()];FN(l,e,t)}function L3e(n,e,t,s){let r,a;try{a=n.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const o=[];for(const d of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const p=d.inboundLayers[h].name,g=d.nodeIndices[h],b=d.tensorIndices[h];o.push(`${p}[${g}][${b}]`)}const l=n.name,c=n.getClassName(),u=o.length===0?"":o[0],f=[`${l} (${c})`,a,r,n.countParams().toString(),u];FN(f,e,s);for(let d=1;d<o.length;++d)FN(["","","","",o[d]],e,s)}function poe(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function UM(n,e){if(n===null)return null;if(typeof n=="string")return Fy(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];poe(e,r,a)?t.push(a):t.push(UM(a,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")t[s]=r;else{const a=Fy(s);t[a]=UM(r,a)}}return t}}function HR(n,e){if(n==null)return null;if(typeof n=="string")return wg(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];poe(e,r,a)?t.push(a):t.push(HR(a,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s],a=wg(s);(s==="name"||s==="className")&&typeof r=="string"?t[a]=r:t[a]=HR(r,s)}return t}}const HO="4.11.0";const N3e=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Kh extends hr{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=OO(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],r1(this.inputs).length!==this.inputs.length)throw new at(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);r1(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const S=x.sourceLayer,C=x.nodeIndex,M=x.tensorIndex;this.outputLayers.push(S),this.outputLayersNodeIndices.push(C),this.outputLayersTensorIndices.push(M)}for(const x of this.inputs){const S=x.sourceLayer,C=x.nodeIndex,M=x.tensorIndex;pm(C===0,"input layer has >1 nodes"),pm(M===0,"input layer has >1 tensors"),this.inputLayers.push(S),this.inputLayersNodeIndices.push(C),this.inputLayersTensorIndices.push(M)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const S=this.inputLayers[x];if(!(S instanceof V_))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${S.getClassName()}.`);this.inputNames.push(S.name),this.feedInputShapes.push(S.batchInputShape),this.feedInputNames.push(S.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const t={},s={},r={},a={},o={},l=[],c=(x,S,C,M,k,E)=>{(M==null||k==null||E==null)&&(M=x.sourceLayer,k=x.nodeIndex,E=x.tensorIndex);const I=M.inboundNodes[k];if(C.indexOf(I)!==-1)throw new uh(`The tensor ${x.name} at layer "${M.name}" is part of a cycle.`);if(S.indexOf(I)!==-1)return;this.containerNodes.add(Kh.nodeKey(M,k)),M.id in o||(o[M.id]=Object.keys(o).length),C.indexOf(I)===-1&&C.push(I);const A=I.inboundLayers.length;for(let D=0;D<A;D++){const L=I.inputTensors[D],P=I.inboundLayers[D],j=I.nodeIndices[D],G=I.tensorIndices[D];c(L,S,C,P,j,G)}for(S.push(I);C.indexOf(I)>=0;)C.splice(C.indexOf(I),1);l.push(I)},u=[],f=[];for(const x of this.outputs)c(x,u,f);const d=l.slice().reverse();for(const x of d){s[x.id]=x,x.id in t||(t[x.id]=0);let S=t[x.id];const C=r[x.outboundLayer.id]==null?0:r[x.outboundLayer.id];S=Math.max(S,C),r[x.outboundLayer.id]=S,a[x.outboundLayer.id]=x.outboundLayer,t[x.id]=S;for(let M=0;M<x.inboundLayers.length;M++){const k=x.inboundLayers[M],E=x.nodeIndices[M],I=k.inboundNodes[E],A=t[I.id]==null?0:t[I.id];t[I.id]=Math.max(S+1,A),s[I.id]=I}}const h={};for(const x in t){const S=t[x];S in h||(h[S]=[]),h[S].push(s[x])}const p={};for(const x in r){const S=r[x];S in p||(p[S]=[]),p[S].push(a[x])}let g=Object.keys(p).map(x=>parseInt(x,10)).sort(II);this.layers=[];for(const x of g){const S=p[x];S.sort((C,M)=>{const k=o[C.id],E=o[M.id];return k<E?-1:k>E?1:0});for(const C of S)C instanceof Kh&&this.internalContainerRefs.push(C),this.layers.push(C)}this.layersByDepth=p,g=Object.keys(h).map(x=>parseInt(x,10)).sort(II);const b=this.inputs.slice(),v=[];for(const x of g)for(const S of h[x]){const C=S.outboundLayer;if(C!=null){for(const M of S.inputTensors)if(b.indexOf(M)===-1)throw new uh(`Graph disconnected: cannot obtain value for tensor ${M} at layer "${C.name}". The following previous layers were accessed without issue: ${v}`);for(const M of S.outputTensors)b.push(M);v.push(C.name)}}this.nodesByDepth=h;const w=this.layers.map(x=>x.name);for(const x of w){const S=w.filter(C=>C===x).length;if(S!==1)throw new uh(`The name "${x}" is used ${S} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new VO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new at("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let r=0;const a=N3e(e);a&&this.parseWeights(e);for(const l of this.layers)for(const[c,u]of l.weights.entries()){const f=a?`${u.name.split("/").slice(0,-1).join("/")+"/"}${c}`:u.originalName;if(s[f]!=null)throw new at(`Duplicate weight name: ${f}`);s[f]=u,r++}const o=[];for(const l in e){let c=l;if(s[l]==null){const u=l.split("/");c=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[c]!=null)o.push([s[c],e[l]]);else if(t)throw new at(`Provided weight data has no target variable: ${l}`);delete s[c]}if(t){const l=[];for(const c in s)l.push(c);if(l.length>0)throw new at(`${l.length} of ${r} weights are not set: ${l}`)}u8(o)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");a!==t&&(e[a]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${HO}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=HR(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return wt(()=>{e=sa(e);const s=new K0;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return BS(this.outputs,s,t)})}computeMask(e,t){return wt(()=>{e=sa(e);let s;return t==null?s=Sb(null,e.length):s=sa(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=LN(e);if(t.length!==this.inputLayers.length)throw new at(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let l=0;l<t.length;l++){const c=this.inputLayers[l],u=t[l],f=c.name+"_0_0";s[f]=u}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(II);if(r.length>1)for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const f=u.outboundLayer;if(this.inputLayers.map(b=>b.id).indexOf(f.id)!==-1)continue;const d=[];for(let b=0;b<u.inboundLayers.length;b++){const v=u.inboundLayers[b],w=u.nodeIndices[b],x=u.tensorIndices[b],S=`${v.name}_${w}_${x}`,C=s[S];d.push(C)}const h=f.computeOutputShape(Ru(d)),p=LN(h),g=f.inboundNodes.indexOf(u);for(let b=0;b<p.length;b++){const v=`${f.name}_${g}_${b}`;s[v]=p[b]}}}const a=[],o=[];for(let l=0;l<this.outputLayers.length;l++){const c=this.outputLayers[l],u=this.outputLayersNodeIndices[l],f=this.outputLayersTensorIndices[l],d=`${c.name}_${u}_${f}`;o.push(d)}for(let l=0;l<o.length;l++){const c=o[l];pm(c in s),a.push(s[c])}return Ru(a)}runInternalGraph(e,t){t==null&&(t=Sb(null,e.length));const s={};for(let c=0;c<this.inputs.length;++c){const u=this.inputs[c],f=e[c],d=t[c];s[u.id]=[f,d]}const r=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(II);for(const c of r){const u=this.nodesByDepth[c];for(const f of u){const d=f.outboundLayer,h=f.inputTensors,p=f.outputTensors,g=new Array;for(const b of h)b.id in s&&g.push(s[b.id]);if(g.length===h.length){let b={},v,w,x,S;if(f.callArgs!=null&&(b=f.callArgs),g.length===1){const[C,M]=g[0];b.mask==null&&(b.mask=M),x=sa(d.call(C,b)),S=sa(d.computeMask(C,M)),v=[C],w=[M]}else v=g.map(C=>C[0]),w=g.map(C=>C[1]),b.mask==null&&(b.mask=w),x=sa(d.call(v,b)),S=sa(d.computeMask(v,w));if(d.activityRegularizer)throw new er("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let C=0;C<p.length;++C){const M=p[C],k=x[C],E=S[C];s[M.id]=[k,E]}}}}const a=[],o=[],l=[];for(const c of this.outputs){pm(c.id in s,`Could not compute output ${c.name} : ${c.id}`);const[u,f]=s[c.id];l.push(u.shape),a.push(u),o.push(f)}return[a,o,l]}buildNodeConversionMap(e){const t={};let s;for(const r of this.layers){s=r instanceof Kh?1:0;for(let a=0;a<r.inboundNodes.length;a++){const o=Kh.nodeKey(r,a);this.containerNodes.has(o)&&(t[o]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new at("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new at(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new at(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return wt(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const r=Kh.nodeKey(t,s);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const l=o.getClassName(),c=o.getConfig(),u=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],p=Kh.nodeKey(o,d);let g={};if(this.containerNodes.has(p)){if(h.callArgs)try{JSON.stringify(h.callArgs),g=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),g={}}if(h.inboundLayers.length>0){const b=[];for(let v=0;v<h.inboundLayers.length;v++){const w=h.inboundLayers[v],x=h.nodeIndices[v],S=h.tensorIndices[v],C=Kh.nodeKey(w,x);let M=t[C];M==null&&(M=0),b.push([w.name,M,S,g])}u.push(b)}}}const f={};f.name=o.name,f.className=l,f.config=c,f.inboundNodes=u,s.push(f)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const l=this.inputLayers[o],c=this.inputLayersNodeIndices[o],u=Kh.nodeKey(l,c);if(!this.containerNodes.has(u))continue;let f=t[u];f==null&&(f=0);const d=this.inputLayersTensorIndices[o];r.push([l.name,f,d])}e.inputLayers=r;const a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],u=Kh.nodeKey(l,c);if(!this.containerNodes.has(u))continue;let f=t[u];f==null&&(f=0);const d=this.outputLayersTensorIndices[o];a.push([l.name,f,d])}return e.outputLayers=a,e}static fromConfig(e,t,s={},r=!1){const a={},o={};function l(v,w){v.name in o?o[v.name].push(w):o[v.name]=[w]}function c(v,w){const x=[];let S;for(const C of w){const M=C[0],k=C[1],E=C[2];if(S=C[3]==null?{}:C[3],!(M in a)){l(v,w);return}const I=a[M];if(I.inboundNodes.length<=k){l(v,w);return}const A=I.inboundNodes[k];x.push(A.outputTensors[E])}x.length>0&&v.apply(Ru(x),S)}function u(v){const w=v.name,x=cp(v,t.customObjects!=null?t.customObjects:{});x.setFastWeightInitDuringBuild(r),a[w]=x,v.inboundNodes.forEach(C=>{if(!(C instanceof Array))throw new at(`Corrupted configuration, expected array for nodeData: ${C}`);l(x,C)})}const f=t.name,d=t.layers;for(const v of d)u(v);for(;!nPe(o);)for(const v of d){const w=a[v.name];if(w.name in o){const x=o[w.name];delete o[w.name];for(const S of x)c(w,S)}}const h=[],p=[],g=t.inputLayers;for(const v of g){const w=v[0],x=v[1],S=v[2];pm(w in a);const M=a[w].inboundNodes[x].outputTensors;h.push(M[S])}const b=t.outputLayers;for(const v of b){const w=v[0],x=v[1],S=v[2];pm(w in a);const M=a[w].inboundNodes[x].outputTensors;p.push(M[S])}return new e({inputs:h,outputs:p,name:f})}get stateful(){if(this._stateful)throw new at("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){wt(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}function D3e(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return e.forEach(a=>{a in n?r.push(n[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function moe(n,e){return D3e(n,e,"classWeight")}async function goe(n,e,t,s){if(t!=null){const r=wt(()=>{if(n.shape.length===1)return Sm(n);if(n.shape.length===2){if(n.shape[1]>1)return yb(n,1);if(n.shape[1]===1)return nt(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());Ws(r);const o=[];return a.forEach(l=>{if(t[l]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${l} exists in the data but not in classWeight`);o.push(t[l])}),fc(o,"float32")}else return null}function O3e(n,e){return et(n,e)}const P3e=32;function yoe(n,e){let t,s;const r=e;t=r.xs,s=r.ys,we(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const a=OH("input",n.inputNames,t),o=OH("output",n.outputNames,s),l=a[0].shape[0];we(a.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),we(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let c=0;c<a.length;c++)we(a[c].shape[0]===l,()=>`Batch size mismatch: input ${n.inputNames[c]} has ${a[c].shape[0]}; expected  ${l} based on input ${n.inputNames[0]}.`);for(let c=0;c<o.length;c++)we(o[c].shape[0]===l,()=>`Batch size mismatch: output ${n.outputNames[c]} has ${o[c].shape[0]}; expected  ${l} based on input ${n.inputNames[0]}.`);return{xs:a,ys:o}}function OH(n,e,t){if(t instanceof jr)return[t];if(Array.isArray(t))return we(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const r of e){if(t[r]==null)throw new at(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(t[r])}return s}}function $3e(n){if(n.length===3)throw new er("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function j3e(n,e,t){const s=t.batchesPerEpoch!=null;if(we(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),we(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),we(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),we(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),we(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=t.validationData!=null;let a,o;if(r)if(PH(t.validationData))we(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const v=$3e(t.validationData);a=v.xs,o=v.ys}const l=n.makeTrainFunction(),c=n.getDedupedMetricsNames();let u;r?u=c.slice().concat(c.map(v=>"val_"+v)):u=c.slice();const f=ooe(t.callbacks,t.yieldEvery),d=t.verbose==null?1:t.verbose,{callbackList:h,history:p}=loe(f,d,t.epochs,null,null,R3e(e,t),null,r,u);h.setModel(n),n.history=p,await h.onTrainBegin(),n.stopTraining_=!1;let g=t.initialEpoch==null?0:t.initialEpoch,b=await e.iterator();for(;g<t.epochs;){const v={};await h.onEpochBegin(g);let w=0,x=0;for(s||(b=await e.iterator());!s||w<t.batchesPerEpoch;){const S=await b.next();if(s&&S.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(S.value!=null){const{xs:C,ys:M}=yoe(n,S.value),k={};k.batch=x,k.size=C[0].shape[0],await h.onBatchBegin(x,k);const E=[];if(t.classWeight!=null){const D=moe(t.classWeight,n.outputNames);for(let L=0;L<D.length;++L)E.push(await goe(M[L],null,D[L]))}const I=C.concat(M).concat(E),A=l(I);Ws(I);for(let D=0;D<c.length;++D){const L=c[D],P=A[D];k[L]=P,bl(P)}await h.onBatchEnd(x,k),soe(k),x++,w++}if(s?w>=t.batchesPerEpoch:S.done){if(r){let C;PH(t.validationData)?C=sa(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):C=sa(n.evaluate(a,o,{batchSize:t.validationBatchSize==null?P3e:t.validationBatchSize,verbose:0}));for(let M=0;M<n.metricsNames.length;++M)v[`val_${n.metricsNames[M]}`]=C[M]}break}if(n.stopTraining_)break}if(await h.onEpochEnd(g,v),g++,n.stopTraining_)break}return await h.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function R3e(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function PH(n){return typeof n.iterator=="function"}function F3e(n){return typeof n.next=="function"}async function z3e(n,e,t){t=t||{};const s=t.batches!=null,r=n.testFunction;let a=[];if(t.verbose>0)throw new er("Verbose mode is not implemented yet.");we(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const o=F3e(e)?e:await e.iterator();let l=0,c=0;for(;!s||c<t.batches;){const u=await o.next();if(a=wt(()=>{if(u.value){const{xs:f,ys:d}=yoe(n,u.value),h=f.concat(d),p=wt(()=>r(h));if(Ws(h),c===0)for(let b=0;b<p.length;++b)a.push(ws(0));const g=h[0].shape[0];for(let b=0;b<p.length;++b){const v=p[b],w=a[b];a[b]=wt(()=>ln(a[b],et(g,v))),c>0&&Ws(w)}Ws(p),l+=g,++c}return a}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<a.length;++u){const f=a[u];a[u]=cs(a[u],l),Ws(f)}return Ru(a)}function A5(n){we(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function qC(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>ab(s,e,t-e)):ab(n,e,t-e)}function qR(n,e){return wt(()=>n==null?null:Array.isArray(n)?n.map(t=>qR(t,e)):Jae(n,e.dtype==="int32"?e:Cn(e,"int32")))}function L5(n,e){const t=[];let s=0,r=null;for(;s<n;)r=s+e,r>=n&&(r=n),t.push([s,r]),s=r;return t}function boe(n){const e=[];n instanceof jr&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(Jk(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Uh(n,e){if(n==null)return;const t=[];if(e instanceof jr)t.push(e.id);else if(Array.isArray(e))e.forEach(r=>t.push(r.id));else if(e!=null)for(const r in e){const a=e[r];t.push(a.id)}const s=[];if(n instanceof jr)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{t.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const a=n[r];t.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}function B3e(n){return n instanceof jr}function YR(n){return Array.isArray(n)}function $H(n){return!B3e(n)&&!YR(n)}function jH(n,e,t,s=!0,r=""){if(e==null||e.length===0){if(n!=null){let o=!1;if(YR(n)&&n.length>0)o=!0;else if($H(n)){for(const l in n)if(n.hasOwnProperty(l)){o=!0;break}}else o=!0;if(o)throw new at(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(o=>null);let a;if($H(n)){n=n,a=[];for(const o of e){if(n[o]==null)throw new at(`No data provided for "${o}". Need data for each key in: ${e}`);a.push(n[o])}}else if(YR(n)){if(n=n,n.length!==e.length)throw new at(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);a=n}else{if(n=n,e.length>1)throw new at(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);a=[n]}if(a=boe(a),t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const l=a[o];if(l.shape.length!==t[o].length)throw new at(`Error when checking ${r}: expected ${e[o]} to have ${t[o].length} dimension(s). but got array with shape ${l.shape}`);for(let c=0;c<t[o].length;++c){if(c===0&&!s)continue;const u=l.shape[c],f=t[o][c];if(f!=null&&f>=0&&u!==f)throw new at(`${r} expected a batch of elements where each example has shape [${t[o].slice(1,t[o].length)}] (i.e.,tensor shape [*,${t[o].slice(1,t[o].length)}]) but the ${r} received an input with ${l.shape[0]} examples, each with shape [${l.shape.slice(1,l.shape.length)}] (tensor shape [${l.shape}])`)}}return a}function U3e(n,e,t){const s=r1(n.map(a=>a.shape[0]));s.sort();const r=r1(e.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new at(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(a=>a.shape))}`);if(r.length>1)throw new at(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!xr(s,r))throw new at(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function V3e(n,e,t){const s=[ew,GO,BM];for(let r=0;r<n.length;++r){const a=n[r],o=e[r],l=t[r];if(o!=null){if(o===BM&&a.shape[a.shape.length-1]===1)throw new at(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const c=a.shape.slice(1),u=l.slice(1);for(let f=0;f<c.length;++f){const d=c[f],h=u[f];if(h!=null&&d!==h)throw new at(`A target Tensor with shape ${a.shape} was passed for an output of shape ${l}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function RH(n,e,t,s=!0,r=""){let a;if(Array.isArray(n)){if(n.length!==e.length)throw new at(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);a=n}else{if(e.length>1)throw new at(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);a=[n]}if(t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const l=a[o];if(l.shape.length!==t[o].length)throw new at(`Error when checking ${r}: expected ${e[o]} to have ${t[o].length} dimension(s), but got array with shape ${JSON.stringify(l.shape)}`);for(let c=0;c<t[o].length;++c){if(c===0&&!s)continue;const u=l.shape[c],f=t[o][c];if(f!=null&&f!==u)throw new at(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(t[o])} but got array with shape ${JSON.stringify(l.shape)}.`)}}}function W3e(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const r of e){let a=t.hasOwnProperty(r)?t[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const G3e="layers-model";class Ag extends Kh{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new at("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");k3e(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=T3e(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Xg))throw new at("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new at(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),t.push(I5(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new at(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(l=>I5(l))}else{const o=I5(e.loss);this.outputs.forEach(l=>{t.push(o)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const l=this.internalOutputShapes[o],c=this.outputNames[o];this.feedOutputNames.push(c),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ib("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const l=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([l,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=W3e(e.metrics,this.outputNames),a=(o,l,c)=>{this.outputNames.length>1&&(l=this.outputNames[o]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([c,o])};ib("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const l=r[o];(u=>{let d,h,p;for(const g of u){if(typeof g=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(g)!==-1){const v=this.internalOutputShapes[o];v[v.length-1]===1||this.lossFunctions[o]===GO?["accuracy","acc"].indexOf(g)!==-1?h=y8:["crossentropy","ce"].indexOf(g)!==-1&&(h=foe):this.lossFunctions[o]===$N?["accuracy","acc"].indexOf(g)!==-1?h=doe:["crossentropy","ce"].indexOf(g)!==-1&&(h=hoe):["accuracy","acc"].indexOf(g)!==-1?h=b8:["crossentropy","ce"].indexOf(g)!==-1&&(h=w8);let w;["accuracy","acc"].indexOf(g)!==-1?w="acc":["crossentropy","ce"].indexOf(g)!==-1&&(w="ce"),p=h,d=""+w}else p=M3e(g),d=""+NI(g);let b;ib(d,()=>{b=p}),a(o,d,b)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const r=s.batchSize==null?32:s.batchSize;A5(r);const o=this.standardizeUserDataXY(e,t,!0,r);try{const l=o[0].concat(o[1]);this.makeTestFunction();const c=this.testFunction,u=this.testLoop(c,l,r,s.verbose,s.steps);return Ru(u)}finally{Uh(o[0],e),Uh(o[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),z3e(this,e,t)}checkNumSamples(e,t,s,r="steps"){let a;if(s!=null){if(a=null,t!=null)throw new at(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new at(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new at("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),r=s?t:[t],a=this.retrieveSymbolicTensors(r),o=new K0;if(e instanceof jr&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new at(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)o.add(this.inputs[c],e[c])}else for(const c of this.inputs){const u=e[c.name];if(u==null)throw new at(`No value is provided for the model's input ${c.name}`);o.add(c,u)}const l=BS(a,o);return s?l:l[0]}retrieveSymbolicTensors(e){const t=Sb(null,e.length);let s=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],o=a.map(l=>l.name);for(let l=0;l<e.length;++l){const c=o.indexOf(e[l]);if(c!==-1&&(t[l]=a[c],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw t.forEach((a,o)=>{a==null&&r.push(e[o])}),new at(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,s=!1){return wt(()=>{const r=this.checkNumSamples(e);if(s)throw new er("Verbose predictLoop() is not implemented yet.");const a=L5(r,t),o=this.outputs.map(l=>[]);for(let l=0;l<a.length;++l)wt(()=>{const u=a[l][0],f=a[l][1],d=qC(e,u,f),h=[];if(Array.isArray(d))for(let g=0;g<d.length;++g)h.push({key:this.inputs[g],value:d[g]});else h.push({key:this.inputs[0],value:d});const p=new K0(h);return BS(this.outputs,p)}).forEach((u,f)=>o[f].push(u));return Ru(o.map(l=>Po(l,0)))})}predict(e,t={}){const s=boe(e);RH(s,this.inputNames,this.feedInputShapes,!1);try{const r=t.batchSize==null?32:t.batchSize;return A5(r),this.predictLoop(s,r)}finally{Uh(s,e)}}predictOnBatch(e){RH(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,r){if(this.optimizer_==null)throw new uh("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let o=0;o<this.feedOutputShapes.length;++o){const l=this.feedOutputShapes[o];this.feedLossFns[o]===$N?a.push(l.slice(0,l.length-1).concat([1])):a.push(l)}if(e=jH(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=jH(t,this.feedOutputNames,a,!1,"target"),U3e(e,t),V3e(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new at(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,r,a=!0,o){const[l,c]=this.standardizeUserDataXY(e,t,a,o);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const f=moe(r,this.outputNames);u=[];for(let d=0;d<f.length;++d)u.push(await goe(c[d],null,f[d]))}return[l,c,u]}testLoop(e,t,s,r=0,a){return wt(()=>{const o=this.checkNumSamples(t,s,a,"steps"),l=[];if(r>0)throw new er("Verbose mode is not implemented yet.");if(a!=null)throw new er("steps mode in testLoop() is not implemented yet");{const c=L5(o,s),u=fc(gp(0,o));for(let f=0;f<c.length;++f){const d=c[f][0],h=c[f][1],p=ab(u,d,h-d),g=qR(t,p),b=e(g);if(f===0)for(let v=0;v<b.length;++v)l.push(ws(0));for(let v=0;v<b.length;++v){const w=b[v];l[v]=ln(l[v],et(h-d,w))}}for(let f=0;f<l.length;++f)l[f]=cs(l[f],o)}return l})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const r=e[s];let a=r;if(xH(e,r)>1){const o=xH(e.slice(0,s),r);a+=`_${o}`}t.push(a)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],l=()=>{const d=[];for(let b=0;b<this.inputs.length;++b)d.push({key:this.inputs[b],value:s[b]});const h=new K0(d),p=BS(this.outputs,h,{training:!0});let g;for(let b=0;b<this.lossFunctions.length;++b){const v=this.lossFunctions[b];let w=v(r[b],p[b]);a[b]!=null&&(w=O3e(w,a[b]));const x=Ja(w);t.push(x),b===0?g=w:g=ln(g,w)}for(let b=0;b<this.metricsTensors.length;++b){let v;if(this.outputs.length>1&&b<this.outputs.length)v=t[b];else{const w=this.metricsTensors[b][0],x=this.metricsTensors[b][1];v=Ja(w(r[x],p[x]))}bl(v),o.push(v)}return g=Ja(g),this.calculateLosses().forEach(b=>{g=ln(g,b)}),g},c=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(l,!0,c)].concat(o)}}makeTestFunction(){this.testFunction=e=>wt(()=>{const t=[];let s;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:r[u]});const l=new K0(o),c=BS(this.outputs,l);for(let u=0;u<this.lossFunctions.length;++u){const f=this.lossFunctions[u],d=Ja(f(a[u],c[u]));u===0?s=d:s=ln(s,d),t.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const f=this.metricsTensors[u][0],d=this.metricsTensors[u][1],h=Ja(f(a[d],c[d]));t.push(h)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,o,l,c,u,f,d,h;try{const p=s.batchSize==null?32:s.batchSize;A5(p);const b=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,p);r=b[0],a=b[1],h=b[2];let v=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)c=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new er("validationData including sample weights is not supported yet."):new at(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const D=await this.standardizeUserData(c,u,null,null,!0,p);f=D[0],d=D[1],w=f.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const A=Math.floor(r[0].shape[0]*(1-s.validationSplit)),D=r[0].shape[0];f=qC(r,A,D),o=r,r=qC(r,0,A),d=qC(a,A,D),l=a,a=qC(a,0,A),w=f.concat(d)}else s.validationSteps!=null&&(v=!0);const x=r.concat(a).concat(h);this.checkTrainableWeightsConsistency();const S=this.makeTrainFunction(),C=this.getDedupedMetricsNames();let M,k;v?(this.makeTestFunction(),M=this.testFunction,k=C.slice().concat(C.map(A=>"val_"+A))):(M=null,w=[],k=C.slice());const E=ooe(s.callbacks,s.yieldEvery);return await this.fitLoop(S,x,C,p,s.epochs,s.verbose,E,M,w,s.shuffle,k,s.initialEpoch,null,null)}finally{this.isTraining=!1,Uh(r,e),Uh(a,t),Uh(o,e),Uh(l,t),Uh(f,c),Uh(d,u),h!=null&&Ws(h)}}async fitLoop(e,t,s,r,a,o,l,c,u,f,d,h,p,g){r==null&&(r=32),a==null&&(a=1),f==null&&(f=!0),h==null&&(h=0);let b=!1;if(c!=null&&u!=null&&(b=!0),g!=null&&(b=!0,p==null))throw new at("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,r,p,"steps_per_epoch");let w;v!=null&&(w=gp(0,v)),o==null&&(o=1);const{callbackList:x,history:S}=loe(l,o,a,h,v,p,r,b,d);x.setModel(this),this.history=S,await x.onTrainBegin(),this.stopTraining_=!1;for(let C=h;C<a;++C){await x.onEpochBegin(C);const M={};if(p!=null)throw new er("stepsPerEpoch mode is not implemented yet.");{if(f==="batch")throw new er("batch shuffling is not implemneted yet");f&&KF(w);const k=fc(w),E=L5(v,r);for(let I=0;I<E.length;++I){const A={};if(await x.onBatchBegin(I,A),wt(()=>{const D=E[I][0],L=E[I][1],P=ab(k,D,L-D);A.batch=I,A.size=L-D;const j=qR(t,P),G=e(j);for(let Q=0;Q<s.length;++Q){const q=s[Q],te=G[Q];A[q]=te,bl(te)}if(I===E.length-1&&b){const Q=this.testLoop(c,u,r);for(let q=0;q<s.length;++q){const te=s[q],Z=Q[q];bl(Z),M["val_"+te]=Z}}}),await x.onBatchEnd(I,A),soe(A),this.stopTraining_)break}k.dispose()}if(await x.onEpochEnd(C,M),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return j3e(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),r=s[0],a=s[1],l=this.makeTrainFunction()(r.concat(a)),c=[];for(const u of l){const f=await u.data();c.push(f[0])}return Ws(l),Uh(s[0],e),Uh(s[1],t),Ru(c)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||t.push({name:r[o].originalName,tensor:a[o]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=AR().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-AR().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=wg(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>wg(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const r of t)if(typeof s[r]=="string")e[r]=wg(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[wg(NI(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>wg(NI(e)));{const e={};for(const t in this.metrics)e[t]=wg(NI(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=UM(e.optimizer_config),s=cp(t);let r;if(typeof e.loss=="string")r=Fy(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>Fy(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=Fy(e.loss[o])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(o=>Fy(o));else if(e.metrics!=null){a={};for(const o in e.metrics)a[o]=Fy(e.metrics[o])}this.compile({loss:r,metrics:a,optimizer:s})}async save(e,t){if(typeof e=="string"){const u=kre(e);if(u.length===0)throw new at(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new at(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new at("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await TR(this.getNamedWeights(t)),l={modelTopology:this.toJSON(null,!1),format:G3e,generatedBy:`TensorFlow.js tfjs-layers v${HO}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:f,specs:d}=await TR(await this.optimizer.getWeights(),u);s.specs.push(...d),s.data=Mre([s.data,f])}return this.userDefinedMetadata!=null&&(DH(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=s.data,l.weightSpecs=s.specs,e.save(l)}setUserDefinedMetadata(e){DH(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Ag.className="Model";fn(Ag);class woe extends Ag{}woe.className="Functional";fn(woe);async function H3e(n,e){"modelTopology"in n||(n={modelTopology:n}),n=n;let t=n.modelTopology;t.model_config!=null&&(t=t.model_config);const s=UM(t),r=cp(s,e);if(n.weightsManifest!=null){const a=await Vie(n.weightsManifest,n.pathPrefix,r.weights.map(l=>l.originalName)),o={};for(const l of r.weights)o[l.originalName]=a[l.originalName];r.loadWeights(o),Ws(a)}return r}async function q3e(n,e){if(e==null&&(e={}),typeof n=="string"){const t=Ere(n,e);if(t.length===0)t.push(Hie(n,e));else if(t.length>1)throw new at(`Found more than one (${t.length}) load handlers for URL '${n}'`);n=t[0]}return Y3e(n,void 0,e)}async function Y3e(n,e,t){if(t==null&&(t={}),n.load==null)throw new at("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await n.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const a=t.strict==null?!0:t.strict,o=s.weightData!=null&&s.weightSpecs!=null&&a,l=cp(UM(r),e,o),c=s.trainingConfig;if(c!=null&&l.loadTrainingConfig(c),s.userDefinedMetadata!=null&&l.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new at("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:u,optimizerWeights:f}=K3e(s.weightData,s.weightSpecs);l.loadWeights(u,a),l.optimizer!=null&&f.length>0&&await l.optimizer.setWeights(f),Ws(u),Ws(f.map(d=>d.tensor))}return l}function K3e(n,e){const t=iz(n,e),s={},r=[];return e.forEach(a=>{a.group==="optimizer"?r.push({name:a.name,tensor:t[a.name]}):s[a.name]=t[a.name]}),{modelWeights:s,optimizerWeights:r}}class Mb extends Ag{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:OO("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new at(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof Mb||e instanceof Ag;let s;if(t){if(s=e,s.outputs.length!==1)throw new at("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new at("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new at("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=noe({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new at(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new at("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=toe(this.outputs[0])}this.inboundNodes=[],new VO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Sb(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(ii(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ag({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new uh("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new uh("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new uh("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new uh("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},r=!1){let a,o={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new at("Legacy serialization format not supported yet.");a=t}else we(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=t.layers,delete t.layers,o=t;const l=new e(o);if(!(l instanceof Mb))throw new er(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(const c of a){const f=cp(c,void 0,r);r&&f.setFastWeightInitDuringBuild(!0),l.add(f)}return l}set stopTraining(e){if(this.model==null)throw new at("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new at("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Mb.className="Sequential";fn(Mb);function X3e(n){return new Ag(n)}function Q3e(n){return new Mb(n)}function voe(n){return noe(n)}function J3e(n,e){od.registerCallbackConstructor(n,e)}let Zu=class extends Jb{getConfig(){return{}}};class _oe extends Zu{apply(e,t=1){return yPe(e,t)}}_oe.className="elu";fn(_oe);class xoe extends Zu{apply(e){return cO(e)}}xoe.className="selu";fn(xoe);class Coe extends Zu{apply(e){return Sp(e)}}Coe.className="relu";fn(Coe);class Soe extends Zu{apply(e){return wt(()=>h1(6,Sp(e)))}}Soe.className="relu6";fn(Soe);class Moe extends Zu{apply(e){return e}}Moe.className="linear";fn(Moe);class Toe extends Zu{apply(e){return lp(e)}}Toe.className="sigmoid";fn(Toe);class koe extends Zu{apply(e){return wPe(e)}}koe.className="hardSigmoid";fn(koe);class Eoe extends Zu{apply(e){return Xb(e)}}Eoe.className="softplus";fn(Eoe);class Ioe extends Zu{apply(e){return bPe(e)}}Ioe.className="softsign";fn(Ioe);class Aoe extends Zu{apply(e){return wb(e)}}Aoe.className="tanh";fn(Aoe);let v8=class extends Zu{apply(e,t=-1){return Wk(e,t)}};v8.className="softmax";fn(v8);class Loe extends Zu{apply(e,t=-1){return nO(e,t)}}Loe.className="logSoftmax";fn(Loe);class Noe extends Zu{apply(e,t=1){return wt(()=>et(lp(et(e,t)),e))}}Noe.className="swish";fn(Noe);class Doe extends Zu{apply(e){return wt(()=>et(e,wb(Xb(e))))}}Doe.className="mish";fn(Doe);function m1(n){return n.getClassName()}function N5(n,e={}){return Qk(n,ud.getMap().classNameMap,e,"activation")}function g1(n){if(n==null){const e={};return e.className="linear",e.config={},N5(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},N5(e)}else return n instanceof Zu?n:N5(n)}function _8(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class Ooe extends Jb{}class nE extends Ooe{constructor(e){super(),_8(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return wt(()=>{let t=Xo([1]);return this.hasL1&&(t=ln(t,Xn(et(this.l1,Go(e))))),this.hasL2&&(t=ln(t,Xn(et(this.l2,Zk(e))))),nt(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}nE.className="L1L2";fn(nE);function Z3e(n){return _8(n),new nE({l1:n!=null?n.l1:null,l2:0})}function e5e(n){return _8(n),new nE({l2:n!=null?n.l2:null,l1:0})}const FH={l1l2:"L1L2"};function ia(n){return e8(n)}function zH(n,e={}){return Qk(n,ud.getMap().classNameMap,e,"regularizer")}function Ba(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in FH?FH[n]:n,config:{}};return zH(t)}else return n instanceof Ooe?n:zH(n)}class x8 extends hr{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=js(e);let s=Sp(e);return this.maxValue!=null&&(s=Yu(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}x8.className="ReLU";fn(x8);class C8 extends hr{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=js(e);return Ok(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}C8.className="LeakyReLU";fn(C8);class S8 extends hr{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=za(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Ba(e.alphaRegularizer),this.alphaConstraint=xl(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new at(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=ii(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Jo({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=js(e),Bk(e,this.alpha.read())}getConfig(){const e={alphaInitializer:eo(this.alphaInitializer),alphaRegularizer:ia(this.alphaRegularizer),alphaConstraint:_l(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}S8.className="PReLU";fn(S8);let M8=class extends hr{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new er(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=js(e);return j_(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};M8.className="ELU";fn(M8);class T8 extends hr{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=js(e);return et(s,Cn(Su(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}T8.className="ThresholdedReLU";fn(T8);class k8 extends hr{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new v8().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return wt(()=>{let s=js(e);const r=t.mask;if(r!=null){const a=et(Bn(Fu(s.shape),Cn(r,s.dtype)),ws(-1e9));s=ln(s,a)}return this.axis instanceof Array?this.axis.length>1?Ku(Bn(s,$k(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}k8.className="Softmax";fn(k8);function Xv(n,e,t){if(typeof n=="number")return Sb(n,e);if(n.length!==e)throw new at(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const r=n[s];if(!hPe(r))throw new at(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function up(n,e,t,s,r=1){if(n==null)return n;const a=e+(e-1)*(r-1);let o;return t==="same"?o=n:o=n-a+1,Math.floor((o+s-1)/s)}function mm(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+p1([t-e,0]);else if(s==="same")n=n*e;else throw new at(`Unsupport padding mode: ${s}.`);return n}function E8(n,e){return wt(()=>(Ro(e),e==="channelsFirst"?Ir(n,[0,2,3,1]):n))}function Poe(n,e){return wt(()=>(Ro(e),e==="channelsFirst"?Ir(n,[0,2,3,4,1]):n))}function t5e(n,e,t,s=1,r="valid",a,o=1){return wt(()=>{if(a==null&&(a=yp()),Ro(a),n.shape.length!==3)throw new at(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new at(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new at(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(a==="channelsFirst"&&(n=Ir(n,[0,2,1])),r==="causal")throw new er("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let l=XD(n,e,s,r==="same"?"same":"valid","NWC",o);return t!=null&&(l=Mp(l,t)),l})}function BH(n,e,t,s=[1,1],r="valid",a,o,l=null){return wt(()=>{if(a==null&&(a=yp()),Ro(a),n.rank!==3&&n.rank!==4)throw new at(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new at(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let c=E8(n,a);if(r==="causal")throw new er("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=Iie({x:c,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:t,activation:l}),a==="channelsFirst"&&(c=Ir(c,[0,3,1,2])),c})}function n5e(n,e,t,s=[1,1,1],r="valid",a,o){return wt(()=>{if(a==null&&(a=yp()),Ro(a),n.rank!==4&&n.rank!==5)throw new at(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new at(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let l=Poe(n,a);if(r==="causal")throw new er("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return l=Nz(l,e,s,r==="same"?"same":"valid","NDHWC",o),t!=null&&(l=Mp(l,t)),a==="channelsFirst"&&(l=Ir(l,[0,4,1,2,3])),l})}class qO extends hr{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",qO.verifyArgs(t),this.rank=e,jl(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new er(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Xv(t.kernelSize,e,"kernelSize"),this.strides=Xv(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,kd(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Ro(this.dataFormat),this.activation=g1(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=za(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=xl(t.biasConstraint),this.biasRegularizer=Ba(t.biasRegularizer),this.activityRegularizer=Ba(t.activityRegularizer),this.dilationRate=Xv(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new at(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new at(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new at(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(pm("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!t8(e.kernelSize,"number",1,3))throw new at(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:m1(this.activation),useBias:this.useBias,biasInitializer:eo(this.biasInitializer),biasRegularizer:ia(this.biasRegularizer),activityRegularizer:ia(this.activityRegularizer),biasConstraint:_l(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class G_ extends qO{constructor(e,t){super(e,t),this.kernel=null,G_.verifyArgs(t),this.filters=t.filters,jl(this.filters,"filters"),this.kernelInitializer=za(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=xl(t.kernelConstraint),this.kernelRegularizer=Ba(t.kernelRegularizer)}build(e){e=ii(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new at(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return wt(()=>{e=js(e);let s;const r=this.bias==null?null:this.bias.read(),a=Hae(this.activation.getClassName());if(a!=null&&this.rank===2)s=BH(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=t5e(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=BH(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=n5e(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new er("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=ii(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<s.length;++a){const o=up(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);t.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:eo(this.kernelInitializer),kernelRegularizer:ia(this.kernelRegularizer),kernelConstraint:_l(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new at(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class H_ extends G_{constructor(e){super(2,e),H_.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!t8(e.kernelSize,"number",1,2))throw new at(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}H_.className="Conv2D";fn(H_);class q_ extends G_{constructor(e){super(3,e),q_.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new at(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}q_.className="Conv3D";fn(q_);class I8 extends H_{constructor(e){if(super(e),this.inputSpec=[new Jo({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new at(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=ii(e),e.length!==4)throw new at("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new at("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Jo({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return wt(()=>{let s=js(e);if(s.shape.length!==4)throw new at(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let o,l;this.dataFormat==="channelsFirst"?(o=2,l=3):(o=1,l=2);const c=r[o],u=r[l],f=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],p=this.strides[1],g=mm(c,h,f,this.padding),b=mm(u,p,d,this.padding),v=[a,g,b,this.filters];this.dataFormat!=="channelsLast"&&(s=Ir(s,[0,2,3,1]));let w=QD(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=Ir(w,[0,3,1,2])),this.bias!=null&&(w=Mp(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=ii(e);const t=e.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],u=this.strides[1];return t[s]=this.filters,t[r]=mm(t[r],c,o,this.padding),t[a]=mm(t[a],u,l,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}I8.className="Conv2DTranspose";fn(I8);class A8 extends q_{constructor(e){if(super(e),this.inputSpec=[new Jo({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new at(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=ii(e),e.length!==5)throw new at("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new at("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Jo({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return wt(()=>{let s=js(e);if(s.shape.length!==5)throw new at(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let o,l,c;this.dataFormat==="channelsFirst"?(c=2,o=3,l=4):(c=1,o=2,l=3);const u=r[c],f=r[o],d=r[l],h=this.kernelSize[0],p=this.kernelSize[1],g=this.kernelSize[2],b=this.strides[0],v=this.strides[1],w=this.strides[2],x=mm(u,b,h,this.padding),S=mm(f,v,p,this.padding),C=mm(d,w,g,this.padding),M=[a,x,S,C,this.filters];this.dataFormat!=="channelsLast"&&(s=Ir(s,[0,2,3,4,1]));let k=Dz(s,this.kernel.read(),M,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=Ir(k,[0,4,1,2,3])),this.bias!==null&&(k=Mp(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(e){e=ii(e);const t=e.slice();let s,r,a,o;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,o=4):(s=4,r=1,a=2,o=3);const l=this.kernelSize[0],c=this.kernelSize[1],u=this.kernelSize[2],f=this.strides[0],d=this.strides[1],h=this.strides[2];return t[s]=this.filters,t[r]=mm(t[r],f,l,this.padding),t[a]=mm(t[a],d,c,this.padding),t[o]=mm(t[o],h,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}A8.className="Conv3DTranspose";fn(A8);class $oe extends G_{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new at("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new at("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new at(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=za(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Ba(t.depthwiseRegularizer),this.depthwiseConstraint=xl(t.depthwiseConstraint),this.pointwiseInitializer=za(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Ba(t.pointwiseRegularizer),this.pointwiseConstraint=xl(t.pointwiseConstraint)}build(e){if(e=ii(e),e.length<this.rank+2)throw new at(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new at(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let l=0;l<this.rank;++l)a.push(1);a.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Jo({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return wt(()=>{e=js(e);let s;if(this.rank===1)throw new er("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Ir(e,[0,2,3,1])),s=uO(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Mp(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Ir(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=eo(this.depthwiseInitializer),e.pointwiseInitializer=eo(this.pointwiseInitializer),e.depthwiseRegularizer=ia(this.depthwiseRegularizer),e.pointwiseRegularizer=ia(this.pointwiseRegularizer),e.depthwiseConstraint=_l(this.depthwiseConstraint),e.pointwiseConstraint=_l(this.pointwiseConstraint),e}}$oe.className="SeparableConv";class L8 extends $oe{constructor(e){super(2,e)}}L8.className="SeparableConv2D";fn(L8);class sE extends G_{constructor(e){super(1,e),sE.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!t8(e.kernelSize,"number",1,1))throw new at(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}sE.className="Conv1D";fn(sE);class N8 extends hr{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return wt(()=>{if(e=js(e),this.dataFormat==="channelsLast"){const s=LI(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return LI(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=LI(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return LI(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}N8.className="Cropping2D";fn(N8);class D8 extends hr{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ro(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,uPe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return wt(()=>{let s=js(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Ir(s,[0,2,3,1]);const a=this.size[0]*r[2],o=this.size[1]*r[3],l=this.interpolation==="nearest"?ch.resizeNearestNeighbor(s,[a,o]):ch.resizeBilinear(s,[a,o]);return Ir(l,[0,3,1,2])}else{const a=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?ch.resizeNearestNeighbor(s,[a,o]):ch.resizeBilinear(s,[a,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}D8.className="UpSampling2D";fn(D8);function s5e(n,e,t=[1,1],s="valid",r,a){return wt(()=>{r==null&&(r=yp()),Ro(r);let o=E8(n,r);if(n.rank!==4)throw new at(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new at(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=$_(o,e,t,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(o=Ir(o,[0,3,1,2])),o})}class O8 extends qO{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=za(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=xl(e.depthwiseConstraint),this.depthwiseRegularizer=Ba(e.depthwiseRegularizer)}build(e){if(e=ii(e),e.length<4)throw new at(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new at(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return wt(()=>{e=js(e);let s=s5e(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Mp(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=ii(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=up(t,this.kernelSize[0],this.padding,this.strides[0]),o=up(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,o]:[e[0],a,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=eo(this.depthwiseInitializer),e.depthwiseRegularizer=ia(this.depthwiseRegularizer),e.depthwiseConstraint=_l(this.depthwiseRegularizer),e}}O8.className="DepthwiseConv2D";fn(O8);function joe(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new at("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return e=r(e),t=r(t),{inputs:n,initialState:e,constants:t}}function Roe(n,e,t,s=!1,r,a,o=!1,l=!1){return wt(()=>{const c=e.shape.length;if(c<3)throw new at(`Input should be at least 3D, but is ${c}D.`);const u=[1,0].concat(gp(2,c));e=Ir(e,u),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Cn(Cn(r,"bool"),"float32"),r.rank===c-1&&(r=lc(r,-1)),r=Ir(r,u)),s&&(e=Cd(e,0),r!=null&&(r=Cd(r,0)));const f=[];let d,h=t;const p=e.shape[0],g=Sd(e);let b;r!=null&&(b=Sd(r));for(let w=0;w<p;++w){const x=g[w],S=wt(()=>n(x,h));if(r==null)d=S[0],h=S[1];else{const C=wt(()=>{const M=b[w],k=Bn(Af(M),M),E=ln(et(S[0],M),et(h[0],k)),I=h.map((A,D)=>ln(et(S[1][D],M),et(A,k)));return{output:E,newStates:I}});d=C.output,h=C.newStates}l&&f.push(d)}let v;return l&&(v=_u(f,1)),[d,v,h]})}class Tp extends hr{constructor(e){super(e);let t;if(e.cell==null)throw new at("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new XO({cells:e.cell}):t=e.cell,t.stateSize==null)throw new at("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Jo({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return gp(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){VR(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const a=[];for(const o of t)a.push([e[0],o]);return[r].concat(a)}else return r}computeMask(e,t){return wt(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new er("Constants support is not implemented in RNN yet.");VR(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Jo({shape:[t,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!xr(this.stateSpec.map(o=>o.shape[o.shape.length-1]),a))throw new at(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(o=>new Jo({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){wt(()=>{if(!this.stateful)throw new hm("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new at("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Xo([s,r])):this.states_=[Xo([s,this.cell.stateSize])];else if(e==null)Ws(this.states_),this.keptStates!=null&&(Ws(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Xo([s,r])):this.states_[0]=Xo([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new at(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):Ws(this.states_);for(let r=0;r<this.states_.length;++r){const a=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,l=[s,o];if(!xr(a.shape,l))throw new at(`State ${r} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>bl(r.clone()))})}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const a=joe(e,s,r,this.numConstants);e=a.inputs,s=a.initialState,r=a.constants;let o=[],l=[];if(s!=null){t.initialState=s,o=o.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Jo({shape:u.shape}));l=l.concat(this.stateSpec)}if(r!=null&&(t.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof bp){const u=[e].concat(o),f=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=f;const h=super.apply(u,t);return this.inputSpec=d,h}else return super.apply(e,t)}call(e,t){return wt(()=>{const s=t==null?null:t.mask,r=t==null?null:t.training;let a=t==null?null:t.initialState;e=js(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==o)throw new at(`RNN Layer has ${o} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const l={training:r},u=Roe((g,b)=>{const v=this.cell.call([g].concat(b),l);return[v[0],v.slice(1)]},e,a,this.goBackwards,s,null,this.unroll,this.returnSequences),f=u[0],d=u[1],h=u[2];this.stateful&&this.resetStates(h,r);const p=this.returnSequences?d:f;return this.returnState?[p].concat(h):p})}getInitialState(e){return wt(()=>{let t=Xo(e.shape);return t=Xn(t,[1,2]),t=Jk(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?BR(t,[1,s]):t):this.cell.stateSize>1?[BR(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Tp.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const r=t.cell,a=cp(r,s);return new e(Object.assign(t,{cell:a}))}}Tp.className="RNN";fn(Tp);class rE extends hr{}class YO extends rE{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,jl(this.units,"units"),this.activation=g1(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=za(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=za(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=za(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ba(e.kernelRegularizer),this.recurrentRegularizer=Ba(e.recurrentRegularizer),this.biasRegularizer=Ba(e.biasRegularizer),this.kernelConstraint=xl(e.kernelConstraint),this.recurrentConstraint=xl(e.recurrentConstraint),this.biasConstraint=xl(e.biasConstraint),this.dropout=p2([1,p1([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=p2([1,p1([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=ii(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return wt(()=>{if(e=e,e.length!==2)throw new at(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=y1({ones:()=>Af(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=y1({ones:()=>Af(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const o=this.dropoutMask,l=this.recurrentDropoutMask;o!=null?a=km(et(e,o),this.kernel.read()):a=km(e,this.kernel.read()),this.bias!=null&&(a=Mp(a,this.bias.read())),l!=null&&(s=et(s,l));let c=ln(a,km(s,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:m1(this.activation),useBias:this.useBias,kernelInitializer:eo(this.kernelInitializer),recurrentInitializer:eo(this.recurrentInitializer),biasInitializer:eo(this.biasInitializer),kernelRegularizer:ia(this.kernelRegularizer),recurrentRegularizer:ia(this.recurrentRegularizer),biasRegularizer:ia(this.biasRegularizer),activityRegularizer:ia(this.activityRegularizer),kernelConstraint:_l(this.kernelConstraint),recurrentConstraint:_l(this.recurrentConstraint),biasConstraint:_l(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}YO.className="SimpleRNNCell";fn(YO);class P8 extends Tp{constructor(e){e.cell=new YO(e),super(e)}call(e,t){return wt(()=>{this.cell.dropoutMask!=null&&(Ws(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ws(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,t){return new e(t)}}P8.className="SimpleRNN";fn(P8);class KO extends rE{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new at("GRUCell does not support reset_after parameter set to true.");this.units=e.units,jl(this.units,"units"),this.activation=g1(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=g1(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=za(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=za(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=za(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ba(e.kernelRegularizer),this.recurrentRegularizer=Ba(e.recurrentRegularizer),this.biasRegularizer=Ba(e.biasRegularizer),this.kernelConstraint=xl(e.kernelConstraint),this.recurrentConstraint=xl(e.recurrentConstraint),this.biasConstraint=xl(e.biasConstraint),this.dropout=p2([1,p1([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=p2([1,p1([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=ii(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return wt(()=>{if(e=e,e.length!==2)throw new at(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=y1({ones:()=>Af(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=y1({ones:()=>Af(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,u;0<this.dropout&&this.dropout<1&&(e=et(e,a[0]));let f=km(e,this.kernel.read());this.useBias&&(f=Mp(f,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=et(r,o[0]));const d=this.recurrentKernel.read(),[h,p]=Uu(d,[2*this.units,this.units],d.rank-1),g=km(r,h),[b,v,w]=Uu(f,3,f.rank-1),[x,S]=Uu(g,2,g.rank-1);l=this.recurrentActivation.apply(ln(b,x)),c=this.recurrentActivation.apply(ln(v,S));const C=km(et(c,r),p);u=this.activation.apply(ln(w,C));const M=ln(et(l,r),et(ln(1,ya(l)),u));return[M,M]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:m1(this.activation),recurrentActivation:m1(this.recurrentActivation),useBias:this.useBias,kernelInitializer:eo(this.kernelInitializer),recurrentInitializer:eo(this.recurrentInitializer),biasInitializer:eo(this.biasInitializer),kernelRegularizer:ia(this.kernelRegularizer),recurrentRegularizer:ia(this.recurrentRegularizer),biasRegularizer:ia(this.biasRegularizer),activityRegularizer:ia(this.activityRegularizer),kernelConstraint:_l(this.kernelConstraint),recurrentConstraint:_l(this.recurrentConstraint),biasConstraint:_l(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}KO.className="GRUCell";fn(KO);class $8 extends Tp{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new KO(e),super(e)}call(e,t){return wt(()=>{this.cell.dropoutMask!=null&&(Ws(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ws(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}$8.className="GRU";fn($8);class iE extends rE{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,jl(this.units,"units"),this.activation=g1(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=g1(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=za(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=za(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=za(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Ba(e.kernelRegularizer),this.recurrentRegularizer=Ba(e.recurrentRegularizer),this.biasRegularizer=Ba(e.biasRegularizer),this.kernelConstraint=xl(e.kernelConstraint),this.recurrentConstraint=xl(e.recurrentConstraint),this.biasConstraint=xl(e.biasConstraint),this.dropout=p2([1,p1([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=p2([1,p1([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=ii(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,o=this.units;r=new(t=class extends _h{apply(c,u){const f=a.apply([o]),d=new $O().apply([o]),h=a.apply([o*2]);return SH(SH(f,d),h)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return wt(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new at(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=y1({ones:()=>Af(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=y1({ones:()=>Af(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,l=this.recurrentDropoutMask;let c,u,f,d;0<this.dropout&&this.dropout<1&&(e=et(e,o[0]));let h=km(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=et(r,l[0])),h=ln(h,km(r,this.recurrentKernel.read())),this.useBias&&(h=Mp(h,this.bias.read()));const[p,g,b,v]=Uu(h,4,h.rank-1);c=this.recurrentActivation.apply(p),u=this.recurrentActivation.apply(g),f=ln(et(u,a),et(c,this.activation.apply(b))),d=this.recurrentActivation.apply(v);const w=et(d,this.activation.apply(f));return[w,w,f]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:m1(this.activation),recurrentActivation:m1(this.recurrentActivation),useBias:this.useBias,kernelInitializer:eo(this.kernelInitializer),recurrentInitializer:eo(this.recurrentInitializer),biasInitializer:eo(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ia(this.kernelRegularizer),recurrentRegularizer:ia(this.recurrentRegularizer),biasRegularizer:ia(this.biasRegularizer),activityRegularizer:ia(this.activityRegularizer),kernelConstraint:_l(this.kernelConstraint),recurrentConstraint:_l(this.recurrentConstraint),biasConstraint:_l(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}iE.className="LSTMCell";fn(iE);class j8 extends Tp{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new iE(e),super(e)}call(e,t){return wt(()=>{this.cell.dropoutMask!=null&&(Ws(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ws(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}j8.className="LSTM";fn(j8);class XO extends rE{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return wt(()=>{e=e;let s=e.slice(1);const r=[];for(const l of this.cells.slice().reverse())Array.isArray(l.stateSize)?r.push(s.splice(0,l.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let o;for(let l=0;l<this.cells.length;++l){const c=this.cells[l];s=r[l],l===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=c.call(o,t),a.push(o.slice(1))}s=[];for(const l of a.slice().reverse())s.push(...l);return[o[0]].concat(s)})}build(e){VR(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,r)=>{ib(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,t,s={}){const r=[];for(const a of t.cells)r.push(cp(a,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return WR(e)}setWeights(e){const t=[];for(const s of this.cells){const r=s.weights.length,a=e.splice(r);for(let o=0;o<s.weights.length;++o)t.push([s.weights[o],a[o]])}u8(t)}}XO.className="StackedRNNCells";fn(XO);function y1(n){const{ones:e,rate:t,training:s=!1,count:r=1,dropoutFunc:a}=n,o=()=>a!=null?a(e(),t):Zae(e(),t),l=()=>eE(o,e,s);return!r||r<=1?bl(l().clone()):Array(r).fill(void 0).map(l).map(u=>bl(u.clone()))}var r5e=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class Foe extends Tp{constructor(e){if(e.unroll)throw new er("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new er("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Jo({ndim:5})]}call(e,t){return wt(()=>{if(this.cell.dropoutMask!=null&&(Ws(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ws(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new at("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return wt(()=>{const{stateSize:t}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],o=Xo(a);return Array.isArray(t)?Array(t.length).fill(o):[o]})}resetStates(e,t=!1){wt(()=>{if(!this.stateful)throw new hm("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new at("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Xo(a)):this.states_=[Xo(a)];else if(e==null)Ws(this.states_),this.keptStates!=null&&(Ws(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Xo(a)):this.states_[0]=Xo(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new at(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Ws(this.states_);for(let l=0;l<this.states_.length;++l){const c=e[l],u=a;if(!xr(c.shape,u))throw new at(`State ${l} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${c.shape}`);this.states_[l]=c}}this.states_=this.states_.map(l=>bl(l.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:r,padding:a,strides:o,dilationRate:l}=this.cell,c=t==="channelsFirst",u=e[c?3:2],f=e[c?4:3],d=up(u,r[0],a,o[0],l[0]),h=up(f,r[1],a,o[1],l[1]);return[...e.slice(0,2),...c?[s,d,h]:[d,h,s]]}}Foe.className="ConvRNN2D";class QO extends iE{constructor(e){const{filters:t,kernelSize:s,strides:r,padding:a,dataFormat:o,dilationRate:l}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,jl(this.filters,"filters"),this.kernelSize=Xv(s,2,"kernelSize"),this.kernelSize.forEach(c=>jl(c,"kernelSize")),this.strides=Xv(r||1,2,"strides"),this.strides.forEach(c=>jl(c,"strides")),this.padding=a||"valid",kd(this.padding),this.dataFormat=o||"channelsLast",Ro(this.dataFormat),this.dilationRate=Xv(l||1,2,"dilationRate"),this.dilationRate.forEach(c=>jl(c,"dilationRate"))}build(e){var t;e=ii(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new at(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],a=4,o=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const l=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){const u=this.biasInitializer,f=this.filters;c=new(t=class extends _h{apply(h,p){const g=u.apply([f]),b=Fu([f]),v=u.apply([f*2]);return n8([g,b,v])}},t.className="CustomInit",t)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return wt(()=>{if(e.length!==3)throw new at(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,r=e[0],a=e[1],o=e[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=y1({ones:()=>Af(r),rate:this.dropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,u=(le,H,R)=>!H||!H[R]?le:et(H[R],le);let f=u(r,c,0),d=u(r,c,1),h=u(r,c,2),p=u(r,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=y1({ones:()=>Af(a),rate:this.recurrentDropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const g=this.recurrentDropoutMask;let b=u(a,g,0),v=u(a,g,1),w=u(a,g,2),x=u(a,g,3);const S=3,[C,M,k,E]=Uu(this.kernel.read(),l,S),[I,A,D,L]=this.useBias?Uu(this.bias.read(),l):[null,null,null,null];f=this.inputConv(f,C,I,this.padding),d=this.inputConv(d,M,A,this.padding),h=this.inputConv(h,k,D,this.padding),p=this.inputConv(p,E,L,this.padding);const[P,j,G,Q]=Uu(this.recurrentKernel.read(),l,S);b=this.recurrentConv(b,P),v=this.recurrentConv(v,j),w=this.recurrentConv(w,G),x=this.recurrentConv(x,Q);const q=this.recurrentActivation.apply(ln(f,b)),te=this.recurrentActivation.apply(ln(d,v)),Z=ln(et(te,o),et(q,this.activation.apply(ln(h,w)))),ne=et(this.recurrentActivation.apply(ln(p,x)),this.activation.apply(Z));return[ne,ne,Z]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=r5e(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,t,s,r){const a=jg(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Mp(a,s,this.dataFormat):a}recurrentConv(e,t){return jg(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}QO.className="ConvLSTM2DCell";fn(QO);class R8 extends Foe{constructor(e){const t=new QO(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}R8.className="ConvLSTM2D";fn(R8);class JO extends hr{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return s}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e);if(0<this.rate&&this.rate<1){const r=t.training==null?!1:t.training,a=this.getNoiseShape(s);return eE(()=>Zae(s,this.rate,a,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}JO.className="Dropout";fn(JO);class F8 extends JO{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}F8.className="SpatialDropout1D";fn(F8);class z8 extends hr{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,jl(this.units,"units"),this.activation=g1(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=za(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=za(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=xl(e.kernelConstraint),this.biasConstraint=xl(e.biasConstraint),this.kernelRegularizer=Ba(e.kernelRegularizer),this.biasRegularizer=Ba(e.biasRegularizer),this.activityRegularizer=Ba(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=ii(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=ii(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e),r=Hae(this.activation.getClassName());let a;return r!=null?a=km(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=km(s,this.kernel.read()),this.bias!=null&&(a=Mp(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const e={units:this.units,activation:m1(this.activation),useBias:this.useBias,kernelInitializer:eo(this.kernelInitializer),biasInitializer:eo(this.biasInitializer),kernelRegularizer:ia(this.kernelRegularizer),biasRegularizer:ia(this.biasRegularizer),activityRegularizer:ia(this.activityRegularizer),kernelConstraint:_l(this.kernelConstraint),biasConstraint:_l(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}z8.className="Dense";fn(z8);class B8 extends hr{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=ii(e);for(const t of e.slice(1))if(t==null)throw new at(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],i1(e,1)]}call(e,t){return wt(()=>{this.invokeCallHook(e,t);let s=js(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=Ir(s,r)}return gPe(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}B8.className="Flatten";fn(B8);class U8 extends hr{constructor(e){super(e),this.supportsMasking=!0,this.activation=g1(e.activation)}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e);return this.activation.apply(s)})}getConfig(){const e={activation:m1(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}U8.className="Activation";fn(U8);class V8 extends hr{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return wt(()=>(e=js(e),pPe(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}V8.className="RepeatVector";fn(V8);class W8 extends hr{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",r=t.slice();let a=1,o=null;for(let c=0;c<r.length;++c){const u=r[c];if(this.isUnknown(u))if(o===null)o=c;else throw new at("Can only specifiy one unknown dimension.");else a*=u}const l=i1(e);if(o!==null){if(a===0||l%a!==0)throw new at(s);r[o]=l/a}else if(l!==a)throw new at(s);return r}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return nt(s,a)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}W8.className="Reshape";fn(W8);class G8 extends hr{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=gp(1,e.dims.length+1);if(!xr(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Jo({ndim:this.dims.length+1})]}computeOutputShape(e){e=ii(e);const t=e.slice();return this.dims.forEach((s,r)=>{t[r+1]=e[s]}),t}call(e,t){return Ir(js(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}G8.className="Permute";fn(G8);class H8 extends hr{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=js(e);return jM(_b(s,this.maskValue),-1)}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e),o=jM(_b(s,this.maskValue),-1,!0);return et(s,Cn(o,s.dtype))})}}H8.className="Masking";fn(H8);class q8 extends hr{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(sa(e.inputLength))}this.inputDim=e.inputDim,jl(this.inputDim,"inputDim"),this.outputDim=e.outputDim,jl(this.outputDim,"outputDim"),this.embeddingsInitializer=za(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Ba(e.embeddingsRegularizer),this.activityRegularizer=Ba(e.activityRegularizer),this.embeddingsConstraint=xl(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return wt(()=>this.maskZero?(e=js(e),_b(e,Rr(e))):null)}computeOutputShape(e){if(e=ii(e),this.inputLength==null)return[...e,this.outputDim];const t=sa(this.inputLength);if(t.length!==e.length-1)throw new at(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<t.length;++r){const a=t[r],o=e[r+1];if(a!=null&&o!=null&&a!==o)throw new at(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(t[s]=o),s++}}return[e[0],...t,this.outputDim]}call(e,t){return wt(()=>{this.invokeCallHook(e,t);let s=js(e);s.dtype!=="int32"&&(s=Tm(s,"int32"));const r=Jae(this.embeddings.read(),nt(s,[s.size]));return nt(r,ii(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:eo(this.embeddingsInitializer),embeddingsRegularizer:ia(this.embeddingsRegularizer),activityRegularizer:ia(this.activityRegularizer),embeddingsConstraint:_l(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}q8.className="Embedding";fn(q8);class tw extends hr{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new er}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const a=e[e.length-t.length+r],o=t[r];if(a==null||o==null||a<0||o<0)s.push(null);else if(a===1)s.push(o);else if(o===1)s.push(a);else{if(a!==o)throw new at("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(a)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[ii(e)]),e=e,e.length<2)throw new at(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const a of e)a!=null&&a[0]!==null&&t.push(a[0]);if(t=r1(t),t.length>1)throw new at(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){const o=e[a]==null?null:e[a].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(a=>a.length);e.indexOf(null)===-1&&r1(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return wt(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){const a=p1(r);for(let o of e){const l=o.rank;for(let c=0;c<a-l;++c)o=Jk(o,1);s.push(o)}return this.mergeFunction(s)}else{let a=!1;for(const c of e){const u=c.rank;if(u==null){const f=c.shape,d=f[0],h=f.slice(1).concat([d]);let p=nt(c,[d].concat(i1(f.slice(1))));p=Ir(p,[1,0]),p=nt(p,h),s.push(p),a=!0}else if(u>1){const f=gp(1,u).concat([0]);s.push(Ir(c,f)),a=!0}else s.push(c)}let o=this.mergeFunction(s);const l=o.rank;if(a){if(l==null){const c=o.shape,u=c.length,f=c[u-1],d=[f].concat(c.slice(0,c.length-1));o=nt(Ir(nt(o,[-1,f]),[1,0]),d)}else if(l>1){const c=[l-1].concat(gp(0,l-1));o=Ir(o,c)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){const a=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=r1(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return wt(()=>{if(t==null)return null;if(!Array.isArray(t))throw new at("`mask` should be an Array");if(!Array.isArray(e))throw new at("`inputs` should be an Array");if(t.length!==e.length)throw new at(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:lc(r,0));let s=t[0];for(let r=1;r<t.length-1;++r)s=gh(s,t[r]);return s})}}class Y8 extends tw{constructor(e){super(e)}mergeFunction(e){return wt(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ln(t,e[s]);return t})}}Y8.className="Add";fn(Y8);class K8 extends tw{constructor(e){super(e)}mergeFunction(e){return wt(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=et(t,e[s]);return t})}}K8.className="Multiply";fn(K8);class X8 extends tw{constructor(e){super(e)}mergeFunction(e){return wt(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ln(t,e[s]);return et(1/e.length,t)})}}X8.className="Average";fn(X8);class Q8 extends tw{constructor(e){super(e)}mergeFunction(e){return wt(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=Fm(t,e[s]);return t})}}Q8.className="Maximum";fn(Q8);class J8 extends tw{constructor(e){super(e)}mergeFunction(e){return wt(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=h1(t,e[s]);return t})}}J8.className="Minimum";fn(J8);class Z8 extends tw{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new at("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const r of e)if(r!=null){t=!1;break}if(t)return;const s=[];for(let r=0;r<e.length;++r){const a=e[r].slice();a.splice(this.axis,1);let o=!1;for(const l of s)if(xr(l,a)){o=!0;break}o||s.push(a)}if(s.length>1)throw new at("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return wt(()=>n8(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new at("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of t.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new at("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new at("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new at(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return wt(()=>{let s=!0;if(t.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)t[o]==null?r.push(Cn(Af(e[o]),"bool")):t[o].rank<e[o].rank?r.push(lc(t[o],-1)):r.push(t[o]);const a=Po(r,this.axis);return KD(a,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}Z8.className="Concatenate";fn(Z8);function YC(n,e){for(;n<0;)n+=e;return n}function i5e(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new er("batchDot is not implemented for tensors of 4D or higher rank yet");if(we(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),we(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new er("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=e.shape.length;t==null&&(t=[s-1,r-2]);const a=t;return wt(()=>{let o;if(s>r){o=s-r;const c=[];for(let u=0;u<o;++u)c.push(1);e=nt(e,e.shape.concat(c))}else if(r>s){o=r-s;const c=[];for(let u=0;u<o;++u)c.push(1);n=nt(n,n.shape.concat(c))}else o=0;let l;if(n.shape.length===2&&e.shape.length===2)a[0]===a[1]?l=Xn(et(n,e),a[0]):l=Xn(et(Ir(n,[1,0]),e),a[1]);else{const c=a[0]!==n.shape.length-1,u=a[1]===e.shape.length-1;l=fr(n,e,c,u)}if(o>0){let c;s>r?c=s+r-3:c=s-1;const u=[];for(let f=c;f<c+o;++f)u.push(f);l=I1(l,u)}return l.shape.length===1&&(l=lc(l,1)),l})}class e9 extends tw{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){we(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new er("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);if(t[r[0]]!==s[r[1]])throw new at(`Dimension incompatibility: ${t[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new at(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,o)=>YC(a,e[o].shape.length)):r=[YC(this.axes,t.shape.length),YC(this.axes,s.shape.length)],this.normalize&&(t=PN(t,r[0]),s=PN(s,r[1])),i5e(t,s,r)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[YC(this.axes,e.length),YC(this.axes,t.length)],s}computeOutputShape(e){we(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new er("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);t.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=t.concat(s);return a.length===1&&a.push(1),a}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}e9.className="Dot";fn(e9);class t9 extends hr{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e);return eE(()=>ln(PO(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}t9.className="GaussianNoise";fn(t9);class n9 extends hr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return wt(()=>{this.invokeCallHook(e,t);const s=js(e);return this.rate>0&&this.rate<1?eE(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return et(s,PO(s.shape,1,a))},()=>s,t.training||!1):s})}}n9.className="GaussianDropout";fn(n9);class s9 extends hr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||js(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return wt(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return eE(()=>{const a=js(e),l=-1.6732632423543772*1.0507009873554805;let c=qg(E1(s),this.rate);c=Tm(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,f=-u*l*this.rate,d=ln(et(a,c),et(ln(c,-1),l));return ln(et(d,u),f)},()=>js(e),t.training||!1)}return e})}}s9.className="AlphaDropout";fn(s9);function VM(n,e,t,s,r,a=.001){let o;if(n.rank===2)o=xz(n,e,t,s,r,a);else if(n.rank===3)o=Cz(n,e,t,s,r,a);else if(n.rank===4)o=Sz(n,e,t,s,r,a);else throw new er(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return o}function a5e(n,e,t,s,r=.001){return wt(()=>{const a=Fk(n,s),o=a.mean,l=a.variance;return[VM(n,o,l,t,e,r),o,l]})}function o5e(n,e,t,s,r=.001){return wt(()=>{const a=Fk(n,s),o=a.mean,l=a.variance,c=[];for(const g of gp(0,n.rank))s.indexOf(g)!==-1?c.push(1):c.push(n.shape[g]);const u=nt(o,c),f=nt(l,c),d=e==null?null:nt(e,c),h=t==null?null:nt(t,c);return[VM(n,u,f,h,d,r),o,l]})}function l5e(n,e,t,s,r=.001){return xr(s.slice().sort(),gp(0,n.rank-1))?a5e(n,e,t,s,r):o5e(n,e,t,s,r)}class r9 extends hr{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=za(e.betaInitializer||"zeros"),this.gammaInitializer=za(e.gammaInitializer||"ones"),this.movingMeanInitializer=za(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=za(e.movingVarianceInitializer||"ones"),this.betaConstraint=xl(e.betaConstraint),this.gammaConstraint=xl(e.gammaConstraint),this.betaRegularizer=Ba(e.betaRegularizer),this.gammaRegularizer=Ba(e.gammaRegularizer)}build(e){e=ii(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new at(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Jo({ndim:e.length,axes:{[t]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return wt(()=>{const s=t.training==null?!1:t.training,r=js(e),a=r.shape,o=a.length,l=gp(0,o),c=this.axis>=0?this.axis:this.axis+o;l.splice(c,1);const u=Sb(1,o);u[c]=a[c];const f=l.slice();f.sort();const d=!xr(f,gp(0,o).slice(0,o-1)),h=()=>{if(d){const x=nt(this.movingMean.read(),u),S=nt(this.movingVariance.read(),u),C=this.center?nt(this.beta.read(),u):null,M=this.scale?nt(this.gamma.read(),u):null;return VM(r,x,S,C,M,this.epsilon)}else return VM(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[p,g,b]=l5e(r,this.gamma.read(),this.beta.read(),l,this.epsilon),v=(x,S,C)=>{wt(()=>{const M=1-C,k=x.read(),E=et(Bn(k,S),M);x.write(Bn(k,E))})};return v(this.movingMean,g,this.momentum),v(this.movingVariance,b,this.momentum),p})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:eo(this.betaInitializer),gammaInitializer:eo(this.gammaInitializer),movingMeanInitializer:eo(this.movingMeanInitializer),movingVarianceInitializer:eo(this.movingVarianceInitializer),betaRegularizer:ia(this.betaRegularizer),gammaRegularizer:ia(this.gammaRegularizer),betaConstraint:_l(this.betaConstraint),gammaConstraint:_l(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}r9.className="BatchNormalization";fn(r9);class i9 extends hr{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=za(e.betaInitializer||"zeros"),this.gammaInitializer=za(e.gammaInitializer||"ones"),this.betaRegularizer=Ba(e.betaRegularizer),this.gammaRegularizer=Ba(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=ii(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(const a of this.axis)if(a<0||a>=t)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==r1(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const s=js(e),r=s.shape,a=r.length;return wt(()=>{let{mean:l,variance:c}=Fk(s,this.axis,!0);const u=Sb(1,a);for(const b of this.axis)u[b]=r[b];const f=b=>b!=null&&b.shape.length!==a?nt(b,u):b;let d=this.scale?f(this.gamma.read()):null,h=this.center?f(this.beta.read()):null;const p=[],g=[];for(let b=0;b<a;++b)this.axis.indexOf(b)!==-1?(p.push(r[b]),g.push(1)):(p.push(1),g.push(r[b]));return l=hd(l,p),c=hd(c,p),d!=null&&(d=hd(d,g)),h!=null&&(h=hd(h,g)),VM(s,l,c,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:eo(this.betaInitializer),gammaInitializer:eo(this.gammaInitializer),betaRegularizer:ia(this.betaRegularizer),gammaRegularizer:ia(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}i9.className="LayerNormalization";fn(i9);function c5e(n,e,t){return wt(()=>{if(n.rank!==4)throw new at(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new at("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=yp()),t!=="channelsLast"&&t!=="channelsFirst")throw new at(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Yg(n,s)})}class a9 extends hr{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?yp():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new at(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new at(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new at(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new Jo({ndim:4})]}computeOutputShape(e){e=ii(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return wt(()=>c5e(js(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}a9.className="ZeroPadding2D";fn(a9);function ZO(n,e,t,s,r,a){return wt(()=>{Ro(r),Yae(a),kd(s),t==null&&(t=[1,1]),s==null&&(s="valid"),r==null&&(r=yp()),a==null&&(a="max"),n=E8(n,r);let o;const l=s==="same"?"same":"valid";return a==="max"?o=Rk(n,e,t,l):o=Ak(n,e,t,l),r==="channelsFirst"&&(o=Ir(o,[0,3,1,2])),o})}function zoe(n,e,t,s,r,a){return wt(()=>{Ro(r),Yae(a),kd(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),r==null&&(r=yp()),a==null&&(a="max"),n=Poe(n,r);let o;const l=s==="same"?"same":"valid";return a==="max"?o=Yz(n,e,t,l):o=_z(n,e,t,l),r==="channelsFirst"&&(o=Ir(o,[0,4,1,2,3])),o})}class Boe extends hr{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new at(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(jl(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new at(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);jl(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,kd(this.padding),this.inputSpec=[new Jo({ndim:3})]}computeOutputShape(e){e=ii(e);const t=up(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return wt(()=>{this.invokeCallHook(e,t),e=Jk(js(e),2);const s=this.poolingFunction(js(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return I1(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class o9 extends Boe{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return Ro(a),kd(r),ZO(e,t,s,r,a,"max")}}o9.className="MaxPooling1D";fn(o9);class l9 extends Boe{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return Ro(a),kd(r),ZO(e,t,s,r,a,"avg")}}l9.className="AveragePooling1D";fn(l9);class Uoe extends hr{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new at(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];jl(this.poolSize,"poolSize"),jl(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ro(this.dataFormat),kd(this.padding),this.inputSpec=[new Jo({ndim:4})]}computeOutputShape(e){e=ii(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=up(t,this.poolSize[0],this.padding,this.strides[0]),s=up(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return wt(()=>(this.invokeCallHook(e,t),this.poolingFunction(js(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class c9 extends Uoe{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return Ro(a),kd(r),ZO(e,t,s,r,a,"max")}}c9.className="MaxPooling2D";fn(c9);class u9 extends Uoe{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return Ro(a),kd(r),ZO(e,t,s,r,a,"avg")}}u9.className="AveragePooling2D";fn(u9);class Voe extends hr{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new at(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];jl(this.poolSize,"poolSize"),jl(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ro(this.dataFormat),kd(this.padding),this.inputSpec=[new Jo({ndim:5})]}computeOutputShape(e){e=ii(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=up(t,this.poolSize[0],this.padding,this.strides[0]),s=up(s,this.poolSize[1],this.padding,this.strides[1]),r=up(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,r]:[e[0],t,s,r,e[4]]}call(e,t){return wt(()=>(this.invokeCallHook(e,t),this.poolingFunction(js(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class f9 extends Voe{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return Ro(a),kd(r),zoe(e,t,s,r,a,"max")}}f9.className="MaxPooling3D";fn(f9);class d9 extends Voe{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return Ro(a),kd(r),zoe(e,t,s,r,a,"avg")}}d9.className="AveragePooling3D";fn(d9);class Woe extends hr{constructor(e){super(e),this.inputSpec=[new Jo({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new er}}class h9 extends Woe{constructor(e){super(e||{})}call(e,t){return wt(()=>{const s=js(e);return Ja(s,1)})}}h9.className="GlobalAveragePooling1D";fn(h9);class p9 extends Woe{constructor(e){super(e||{})}call(e,t){return wt(()=>{const s=js(e);return bd(s,1)})}}p9.className="GlobalMaxPooling1D";fn(p9);class Goe extends hr{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ro(this.dataFormat),this.inputSpec=[new Jo({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new er}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class m9 extends Goe{call(e,t){return wt(()=>{const s=js(e);return this.dataFormat==="channelsLast"?Ja(s,[1,2]):Ja(s,[2,3])})}}m9.className="GlobalAveragePooling2D";fn(m9);class g9 extends Goe{call(e,t){return wt(()=>{const s=js(e);return this.dataFormat==="channelsLast"?bd(s,[1,2]):bd(s,[2,3])})}}g9.className="GlobalMaxPooling2D";fn(g9);class Hoe extends hr{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const r=t.layer,a=cp(r,s);delete t.layer;const o={layer:a};return Object.assign(o,t),new e(o)}}class y9 extends Hoe{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=ii(e),e.length<3)throw new at(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=ii(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,t){return wt(()=>(e=js(e),Roe((o,l)=>[js(this.layer.call(o,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}y9.className="TimeDistributed";fn(y9);function u5e(n){Zb(cPe,"BidirectionalMergeMode",n)}const f5e="concat";class b9 extends Hoe{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=cp(s),t.goBackwards=t.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=cp(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?f5e:e.mergeMode,u5e(this.mergeMode),e.weights)throw new er("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,r,a;return this.returnState&&(a=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):Ru(r)}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const a=joe(e,s,r,this.numConstants);if(e=a.inputs,s=a.initialState,r=a.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,t);const o=[],l=[];if(s!=null){const u=s.length;if(u%2>0)throw new at("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,o.push(...s);const f=s.map(d=>new Jo({shape:d.shape}));this.forwardLayer.stateSpec=f.slice(0,u/2),this.backwardLayer.stateSpec=f.slice(u/2),l.push(...f)}if(r!=null)throw new er("Support for constants in Bidirectional layers is not implemented yet.");const c=o[0]instanceof bp;for(const u of o)if(u instanceof bp!==c)throw new at("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){const u=[e].concat(o),f=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=f;const h=super.apply(u,t);return this.inputSpec=d,h}else return super.apply(e,t)}call(e,t){return wt(()=>{const s=t.initialState;let r,a;if(s==null)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{const c=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:c})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Cd(a,1));let l;return this.mergeMode==="concat"?l=n8([r,a]):this.mergeMode==="sum"?l=ln(r,a):this.mergeMode==="ave"?l=et(.5,ln(r,a)):this.mergeMode==="mul"?l=et(r,a):this.mergeMode==null&&(l=[r,a]),this.returnState?this.mergeMode==null?l.concat(o):[l].concat(o):l})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){ib(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),ib(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=cp(t.layer);if(delete t.layer,t.numConstants!=null)throw new er("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=s,new e(r)}}b9.className="Bidirectional";fn(b9);class w9 extends hr{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return wt(()=>(e=js(e),e.dtype!=="float32"&&(e=Tm(e,"float32")),ln(et(e,this.scale),this.offset)))}}w9.className="Rescaling";fn(w9);const{resizeBilinear:d5e,cropAndResize:h5e}=ch;class v9 extends hr{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,r,a,o,l,c){return wt(()=>{let u,f=!1;const d=t/o,h=s/l,p=(r+t)/o,g=(a+s)/l,b=[d,h,p,g],v=[];e.rank===3?(f=!0,u=_u([e])):u=e;for(let M=0;M<u.shape[0];M++)v.push(b);const w=Tf(v,[v.length,4]),x=xb(0,v.length,1,"int32"),C=h5e(u,w,x,[r,a],"nearest");return Tm(f?js(Sd(C)):C,c)})}upsize(e,t,s,r){return wt(()=>{const a=d5e(e,[t,s]);return Tm(a,r)})}call(e,t){return wt(()=>{const s=js(e),r=s.dtype,a=s.shape,o=a[a.length-3],l=a[a.length-2];let c=0;o!==this.height&&(c=Math.floor((o-this.height)/2));let u=0;return l!==this.width&&(u=Math.floor((l-this.width)/2),u===0&&(u=1)),c>=0&&u>=0?this.centerCrop(s,c,u,this.height,this.width,o,l,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=ii(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}v9.className="CenterCrop";fn(v9);function p5e(n,e,t,s){let r=js(n);if(r.dtype!=="int32"&&(r=Tm(r,"int32")),e==="int")return r;const a=r.shape;if(r.rank===0&&(r=lc(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=lc(r,-1)),r.rank>2)throw new at(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${a} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),l=r;let c;if(typeof s<"u"&&e==="count"?c=EN(l,s,t,o):c=EN(l,[],t,o),e!=="tfIdf")return c;if(s)return et(c,s);throw new at("When outputMode is 'tfIdf', weights must be provided.")}class _9 extends hr{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=ii(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return wt(()=>{e=js(e),e.dtype!=="int32"&&(e=Tm(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new at(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=js(t.countWeights)}const r=bd(e),a=l2(e),o=Su(this.numTokens,r).bufferSync().get(0),l=qg(a,0).bufferSync().get(0);if(!(o&&l))throw new at(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return p5e(e,this.outputMode,this.numTokens,s)})}}_9.className="CategoryEncoding";fn(_9);const m5e=["bilinear","nearest"],UH=new Set(m5e);class x9 extends hr{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(UH.has(e.interpolation))this.interpolation=e.interpolation;else throw new at(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=ii(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return wt(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return ch.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return ch.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...UH]} are supported`)})}}x9.className="Resizing";fn(x9);class qoe{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}qoe.className="RandomSeed";class Yoe extends hr{constructor(e){super(e),this.randomGenerator=new qoe(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}Yoe.className="BaseRandomLayer";const g5e=["bilinear","nearest"],VH=new Set(g5e);class C9 extends Yoe{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new at(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new at(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new at(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(VH.has(s))this.interpolation=s;else throw new at(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=ii(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return wt(()=>{const s=js(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=E1([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const o=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return ch.resizeBilinear(e,o);case"nearest":return ch.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...VH]} are supported`)}})}}C9.className="RandomWidth";fn(C9);function y5e(n){return new V_(n)}function b5e(n){return new M8(n)}function w5e(n){return new x8(n)}function v5e(n){return new C8(n)}function _5e(n){return new S8(n)}function x5e(n){return new k8(n)}function C5e(n){return new T8(n)}function S5e(n){return new sE(n)}function M5e(n){return new H_(n)}function T5e(n){return new I8(n)}function k5e(n){return new q_(n)}function E5e(n){return new A8(n)}function I5e(n){return new L8(n)}function A5e(n){return new N8(n)}function L5e(n){return new D8(n)}function N5e(n){return new O8(n)}function D5e(n){return new U8(n)}function O5e(n){return new z8(n)}function P5e(n){return new JO(n)}function $5e(n){return new F8(n)}function j5e(n){return new B8(n)}function R5e(n){return new V8(n)}function F5e(n){return new W8(n)}function z5e(n){return new G8(n)}function B5e(n){return new q8(n)}function U5e(n){return new Y8(n)}function V5e(n){return new X8(n)}function W5e(n){return new Z8(n)}function G5e(n){return new Q8(n)}function H5e(n){return new J8(n)}function q5e(n){return new K8(n)}function Y5e(n){return new e9(n)}function K5e(n){return new r9(n)}function X5e(n){return new i9(n)}function Q5e(n){return new a9(n)}function S9(n){return new l9(n)}function J5e(n){return S9(n)}function Z5e(n){return S9(n)}function M9(n){return new u9(n)}function e$e(n){return M9(n)}function t$e(n){return M9(n)}function T9(n){return new d9(n)}function n$e(n){return T9(n)}function s$e(n){return T9(n)}function r$e(n){return new h9(n)}function i$e(n){return new m9(n)}function Koe(n){return new p9(n)}function Xoe(n){return new g9(n)}function Qoe(n){return new o9(n)}function Joe(n){return new c9(n)}function a$e(n){return new f9(n)}function o$e(n){return new $8(n)}function l$e(n){return new KO(n)}function c$e(n){return new j8(n)}function u$e(n){return new iE(n)}function f$e(n){return new P8(n)}function d$e(n){return new YO(n)}function h$e(n){return new R8(n)}function p$e(n){return new QO(n)}function m$e(n){return new Tp(n)}function g$e(n){return new XO(n)}function y$e(n){return new b9(n)}function b$e(n){return new y9(n)}const w$e=Koe,v$e=Xoe,_$e=Qoe,x$e=Joe;function C$e(n){return new t9(n)}function S$e(n){return new n9(n)}function M$e(n){return new s9(n)}function T$e(n){return new H8(n)}function k$e(n){return new w9(n)}function E$e(n){return new v9(n)}function I$e(n){return new x9(n)}function A$e(n){return new _9(n)}function L$e(n){return new C9(n)}const N$e=Object.freeze(Object.defineProperty({__proto__:null,Layer:hr,RNN:Tp,RNNCell:rE,activation:D5e,add:U5e,alphaDropout:M$e,average:V5e,averagePooling1d:S9,averagePooling2d:M9,averagePooling3d:T9,avgPool1d:J5e,avgPool2d:e$e,avgPool3d:n$e,avgPooling1d:Z5e,avgPooling2d:t$e,avgPooling3d:s$e,batchNormalization:K5e,bidirectional:y$e,categoryEncoding:A$e,centerCrop:E$e,concatenate:W5e,conv1d:S5e,conv2d:M5e,conv2dTranspose:T5e,conv3d:k5e,conv3dTranspose:E5e,convLstm2d:h$e,convLstm2dCell:p$e,cropping2D:A5e,dense:O5e,depthwiseConv2d:N5e,dot:Y5e,dropout:P5e,elu:b5e,embedding:B5e,flatten:j5e,gaussianDropout:S$e,gaussianNoise:C$e,globalAveragePooling1d:r$e,globalAveragePooling2d:i$e,globalMaxPool1d:w$e,globalMaxPool2d:v$e,globalMaxPooling1d:Koe,globalMaxPooling2d:Xoe,gru:o$e,gruCell:l$e,input:voe,inputLayer:y5e,layerNormalization:X5e,leakyReLU:v5e,lstm:c$e,lstmCell:u$e,masking:T$e,maxPool1d:_$e,maxPool2d:x$e,maxPooling1d:Qoe,maxPooling2d:Joe,maxPooling3d:a$e,maximum:G5e,minimum:H5e,multiply:q5e,permute:z5e,prelu:_5e,randomWidth:L$e,reLU:w5e,repeatVector:R5e,rescaling:k$e,reshape:F5e,resizing:I$e,rnn:m$e,separableConv2d:I5e,simpleRNN:f$e,simpleRNNCell:d$e,softmax:x5e,spatialDropout1d:$5e,stackedRNNCells:g$e,thresholdedReLU:C5e,timeDistributed:b$e,upSampling2d:L5e,zeroPadding2d:Q5e},Symbol.toStringTag,{value:"Module"}));function D$e(n,e){return y8(n,e)}function O$e(n,e){return foe(n,e)}function P$e(n,e){return doe(n,e)}function $$e(n,e){return b8(n,e)}function j$e(n,e){return w8(n,e)}function R$e(n,e){return uoe(n,e)}function F$e(n,e){return y3e(n,e)}function z$e(n,e){return g8(n,e)}function B$e(n,e){return WO(n,e)}function U$e(n,e){return W_(n,e)}function V$e(n,e){return W_(n,e)}function W$e(n,e){return W_(n,e)}function G$e(n,e){return ew(n,e)}function H$e(n,e){return ew(n,e)}function q$e(n,e){return ew(n,e)}const Y$e=Object.freeze(Object.defineProperty({__proto__:null,MAPE:V$e,MSE:H$e,binaryAccuracy:D$e,binaryCrossentropy:O$e,categoricalAccuracy:$$e,categoricalCrossentropy:j$e,cosineProximity:z$e,mape:W$e,meanAbsoluteError:B$e,meanAbsolutePercentageError:U$e,meanSquaredError:G$e,mse:q$e,precision:R$e,recall:F$e,sparseCategoricalAccuracy:P$e},Symbol.toStringTag,{value:"Module"}));const K$e=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:H3e},Symbol.toStringTag,{value:"Module"}));function X$e(n){return new nE(n)}function Q$e(n){return Z3e(n)}function J$e(n){return e5e(n)}const Z$e=Object.freeze(Object.defineProperty({__proto__:null,l1:Q$e,l1l2:X$e,l2:J$e},Symbol.toStringTag,{value:"Module"}));class Zoe extends m2{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Ag))throw new Error("model must be a LayersModel, not some other Container");this.model=e}}function DI(n,e){return n<e}function WH(n,e){return n>e}class ele extends Zoe{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new er("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=DI:this.mode==="max"?this.monitorFunc=WH:this.monitor.indexOf("acc")!==-1?this.monitorFunc=WH:this.monitorFunc=DI,this.monitorFunc===DI&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===DI?1/0:-1/0}async onEpochEnd(e,t){await B0(t);const s=this.getMonitorValue(t);s!=null&&(this.monitorFunc(s-this.minDelta,this.best)?(this.best=s,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});const t=e[this.monitor];return t==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}}function eje(n){return new ele(n)}const tje={earlyStopping:eje};const nje=bt();nje.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var th;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(th||(th={}));var GH;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(GH||(GH={}));const k9={};function sje(n,e){const t={tfOpName:n,category:"custom",inputs:[],attrs:[],customExecutor:e};k9[n]=t}function tle(n){return k9[n]}function rje(n){delete k9[n]}function ae(n,e,t,s,r){const a=e.inputParams[n];if(a&&a.inputIndexStart!==void 0){const l=a.inputIndexStart,c=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?l+1:a.inputIndexEnd,u=l<0?e.inputNames.length+l:l;if(a.type==="tensor")return cc(e.inputNames[u],t,s,r);if(a.type==="tensors"){const h=e.inputs.slice(l,c);return e.inputNames.slice(l,c).filter((g,b)=>{var v;return((v=h[b])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(g=>cc(g,t,s,r))}const f=cc(e.inputNames[u],t,s,r),d=f.dataSync();return a.type==="number"?d[0]:yd(f.shape,d)}const o=e.attrParams[n];return o&&o.value}function cc(n,e,t,s){const[r,a]=vf(n,t);if(s!=null){const l=s.getHashTableHandleByName(r);if(l!=null)return l}const o=t.currentContextIds.find(l=>!!e[zN(r,l)]);return o!==void 0?e[zN(r,o)][a]:void 0}function HH(n,e,t){return e[zN(n,t.currentContextId)]}function vg(n,e){const[t,s,r]=vf(n,e);return[zN(t,e&&e.currentContextId),s,r]}function zN(n,e){return e?`${n}-${e}`:n}function vf(n,e){if(n==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const a=e.parseNodeNameCache.get(n);if(a!=null)return a}const s=n.split(":");let r;if(s.length===1)r=[n,0,void 0];else{const a=s[0],o=s.length===3?s[1]:void 0,l=Number(s[s.length-1]);r=[a,l,o]}return t&&e.parseNodeNameCache.set(n,r),r}function TL(n,e,t){let s=ae("pad",n,e,t);if(s==="explicit"){s=ae("explicitPaddings",n,e,t);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function _g(n){return n.kept?n:Sm(n)}const ije=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],aje=Object.freeze(Object.defineProperty({__proto__:null,json:ije},Symbol.toStringTag,{value:"Module"}));const oje=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],lje=Object.freeze(Object.defineProperty({__proto__:null,json:oje},Symbol.toStringTag,{value:"Module"}));const cje=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],uje=Object.freeze(Object.defineProperty({__proto__:null,json:cje},Symbol.toStringTag,{value:"Module"}));const fje=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],dje=Object.freeze(Object.defineProperty({__proto__:null,json:fje},Symbol.toStringTag,{value:"Module"}));const hje=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],pje=Object.freeze(Object.defineProperty({__proto__:null,json:hje},Symbol.toStringTag,{value:"Module"}));const mje=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],gje=Object.freeze(Object.defineProperty({__proto__:null,json:mje},Symbol.toStringTag,{value:"Module"}));const yje=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],bje=Object.freeze(Object.defineProperty({__proto__:null,json:yje},Symbol.toStringTag,{value:"Module"}));const wje=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],vje=Object.freeze(Object.defineProperty({__proto__:null,json:wje},Symbol.toStringTag,{value:"Module"}));const _je=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],xje=Object.freeze(Object.defineProperty({__proto__:null,json:_je},Symbol.toStringTag,{value:"Module"}));const Cje=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Sje=Object.freeze(Object.defineProperty({__proto__:null,json:Cje},Symbol.toStringTag,{value:"Module"}));const Mje=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Tje=Object.freeze(Object.defineProperty({__proto__:null,json:Mje},Symbol.toStringTag,{value:"Module"}));const kje=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Eje=Object.freeze(Object.defineProperty({__proto__:null,json:kje},Symbol.toStringTag,{value:"Module"}));const Ije=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Aje=Object.freeze(Object.defineProperty({__proto__:null,json:Ije},Symbol.toStringTag,{value:"Module"}));const Lje=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Nje=Object.freeze(Object.defineProperty({__proto__:null,json:Lje},Symbol.toStringTag,{value:"Module"}));const Dje=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Oje=Object.freeze(Object.defineProperty({__proto__:null,json:Dje},Symbol.toStringTag,{value:"Module"}));const Pje=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],$je=Object.freeze(Object.defineProperty({__proto__:null,json:Pje},Symbol.toStringTag,{value:"Module"}));const jje=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Rje=Object.freeze(Object.defineProperty({__proto__:null,json:jje},Symbol.toStringTag,{value:"Module"}));const Fje=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],zje=Object.freeze(Object.defineProperty({__proto__:null,json:Fje},Symbol.toStringTag,{value:"Module"}));const Bje=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Uje=Object.freeze(Object.defineProperty({__proto__:null,json:Bje},Symbol.toStringTag,{value:"Module"}));class qH{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[aje,lje,uje,dje,pje,gje,bje,vje,xje,Sje,Tje,Eje,Aje,Nje,Oje,$je,Rje,zje,Uje],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,t={}){const s=e.node,r=[],a=[],o=[],l=s.reduce((b,v)=>(b[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?r.push(b[v.name]):v.op==="Const"?a.push(b[v.name]):(v.input==null||v.input.length===0)&&o.push(b[v.name]),b),{});let c=[];const u=[];let f={},d={};t!=null&&(f=this.mapSignatureEntries(t.inputs),d=this.mapSignatureEntries(t.outputs));const h=Object.keys(l);h.forEach(b=>{const v=l[b];v.inputNames.forEach((w,x)=>{const[S,,C]=vg(w),M=l[S];if(M.outputs!=null){const k=M.outputs.indexOf(C);if(k!==-1){const E=`${S}:${k}`;v.inputNames[x]=E}}v.inputs.push(M),M.children.push(v)})}),Object.keys(d).length===0?h.forEach(b=>{const v=l[b];v.children.length===0&&u.push(v)}):Object.keys(d).forEach(b=>{const[v]=vg(b),w=l[v];w!=null&&(w.signatureKey=d[b],u.push(w))}),Object.keys(f).length>0?Object.keys(f).forEach(b=>{const[v]=vg(b),w=l[v];w&&(w.signatureKey=f[b],c.push(w))}):c=r;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((b,v)=>(b[v.signature.name]=this.mapFunction(v),b),{}));const g={nodes:l,inputs:c,outputs:u,weights:a,placeholders:r,signature:t,functions:p};return o.length>0&&(g.initNodes=o),g}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=tle(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((r,a)=>{const o=a.type;let l;switch(a.type){case"string":l=KR(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=KR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":l=n6(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=n6(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":l=QR(e.attr,a.tfName,a.defaultValue||0),l===void 0&&a.tfDeprecatedName&&(l=QR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":l=t6(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=t6(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":l=XR(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=XR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":l=r6(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=r6(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":l=e6(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=e6(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":l=s6(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=s6(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":l=JR(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=JR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":l=ZR(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=ZR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":l=YH(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=YH(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return r[a.name]={value:l,type:o},r},{})),s}mapFunction(e){const t=e.nodeDef,s=[],r=[];let a={};t!=null&&(a=t.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&r.push(d[h.name]),d),{}));const o=[],l=[];e.signature.inputArg.forEach(d=>{const[h]=vg(d.name),p={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:E9(d.type),type:"dtype"}},children:[]};p.signatureKey=d.name,o.push(p),a[h]=p}),Object.keys(a).forEach(d=>{const h=a[d];h.inputNames.forEach((p,g)=>{const[b,,v]=vg(p),w=a[b];if(w.outputs!=null){const x=w.outputs.indexOf(v);if(x!==-1){const S=`${b}:${x}`;h.inputNames[g]=S}}h.inputs.push(w),w.children.push(h)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[h,p]=vg(u[d.name]),g=a[h];g!=null&&(g.defaultOutput=p,l.push(g))});const f=this.mapArgsToSignature(e);return{nodes:a,inputs:o,outputs:l,weights:r,placeholders:s,signature:f}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function Vje(n){const e=bt().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function nle(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):Vje(n);return e?t:t.toLowerCase()}function KR(n,e,t,s=!1){const r=n[e];return r!=null?nle(r.s,s):t}function XR(n,e,t){const s=n[e];return s?s.b:t}function QR(n,e,t){const s=n[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:t;return typeof r=="number"?r:parseInt(r,10)}function E9(n){switch(typeof n=="string"&&(n=th[n]),n){case th.DT_FLOAT:case th.DT_HALF:return"float32";case th.DT_INT32:case th.DT_INT64:case th.DT_INT8:case th.DT_UINT8:return"int32";case th.DT_BOOL:return"bool";case th.DT_DOUBLE:return"float32";case th.DT_STRING:return"string";default:return null}}function YH(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function JR(n,e,t){const s=n[e];return s&&s.type?E9(s.type):t}function ZR(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(r=>E9(r)):t}function sle(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function e6(n,e,t){const s=n[e];return s&&s.shape?sle(s.shape):t}function t6(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):t}function n6(n,e,t,s=!1){const r=n[e];return r&&r.list&&r.list.s?r.list.s.map(a=>nle(a,s)):t}function s6(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>sle(r)):t}function r6(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}class Wje{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return cc(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return cc(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return QR(this.node.rawAttrs,e,t);if(s.s!=null)return KR(this.node.rawAttrs,e,t);if(s.b!=null)return XR(this.node.rawAttrs,e,t);if(s.shape!=null)return e6(this.node.rawAttrs,e,t);if(s.type!=null)return JR(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return t6(this.node.rawAttrs,e,t);if(s.list.s!=null)return n6(this.node.rawAttrs,e,t);if(s.list.shape!=null)return s6(this.node.rawAttrs,e,t);if(s.list.b!=null)return r6(this.node.rawAttrs,e,t);if(s.list.type!=null)return ZR(this.node.rawAttrs,e,t)}return t}}const bc=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:rz,abs:Go,acos:dz,acosh:hz,add:ln,addN:jre,all:KD,any:jM,argMax:yb,argMin:pz,asin:mz,asinh:gz,atan:yz,atan2:bz,atanh:wz,avgPool:Ak,avgPool3d:_z,basicLSTMCell:Rre,batchNorm:P_,batchNorm2d:xz,batchNorm3d:Cz,batchNorm4d:Sz,batchToSpaceND:Lk,bincount:Mz,bitwiseAnd:Fre,booleanMaskAsync:Cie,broadcastArgs:zre,broadcastTo:sb,buffer:tr,cast:Cn,ceil:Tz,clipByValue:Yu,clone:Sm,complex:$g,concat:Po,concat1d:kz,concat2d:Ez,concat3d:Iz,concat4d:Az,conv1d:XD,conv2d:jg,conv2dTranspose:QD,conv3d:Nz,conv3dTranspose:Dz,cos:Nk,cosh:JD,cosineWindow:vO,cumprod:zM,cumsum:ZD,denseBincount:EN,depthToSpace:Oz,depthwiseConv2d:$_,diag:Ure,dilation2d:Pz,div:cs,divNoNan:$z,dot:jz,dropout:dB,einsum:Ry,elu:j_,enclosingPowerOfTwo:hB,ensureShape:Vre,equal:Ef,erf:Rz,euclideanNorm:zz,exp:Ku,expandDims:lc,expm1:Bz,eye:eO,fft:Gk,fill:Kb,floor:F_,floorDiv:YD,fused:Nie,gather:z_,gatherND:kie,greater:Su,greaterEqual:qg,ifft:h2,imag:Dk,image:ch,inTopKAsync:Eie,irfft:pO,isFinite:Uz,isInf:Vz,isNaN:Wz,leakyRelu:Ok,less:c2,lessEqual:k1,linalg:gB,linspace:Hre,localResponseNormalization:Gz,log:If,log1p:Pk,logSigmoid:Hz,logSoftmax:nO,logSumExp:$k,logicalAnd:gh,logicalNot:jk,logicalOr:sO,logicalXor:qz,losses:Fie,lowerBound:Yre,matMul:fr,max:bd,maxPool:Rk,maxPool3d:Yz,maxPoolWithArgmax:Kre,maximum:Fm,mean:Ja,meshgrid:Xre,min:l2,minimum:h1,mirrorPad:Kz,mod:Xz,moments:Fk,movingAverage:Sie,mul:et,multiRNNCell:Qre,multinomial:Jre,neg:ya,norm:R_,notEqual:_b,oneHot:u2,ones:Fu,onesLike:Af,op:Ye,outerProduct:Zre,pad:Yg,pad1d:eie,pad2d:tie,pad3d:nie,pad4d:sie,pool:Qz,pow:Rg,prelu:Bk,print:uz,prod:Jz,raggedGather:rie,raggedRange:iie,raggedTensorToTensor:aie,rand:oie,randomGamma:uie,randomNormal:iO,randomStandardNormal:fie,randomUniform:E1,randomUniformInt:die,range:xb,real:f2,reciprocal:nB,relu:Sp,relu6:aO,reshape:nt,reverse:Cd,reverse1d:hie,reverse2d:pie,reverse3d:mie,reverse4d:gie,rfft:Hk,round:oO,rsqrt:lO,scalar:ws,scatterND:Mie,searchSorted:rO,selu:cO,separableConv2d:uO,setdiff1dAsync:yie,sigmoid:lp,sign:sB,signal:Rie,sin:fO,sinh:dO,slice:Pr,slice1d:Uk,slice2d:hO,slice3d:Vk,slice4d:d2,softmax:Wk,softplus:Xb,spaceToBatchND:zk,sparse:zie,sparseToDense:Tie,spectral:jie,split:Uu,sqrt:pc,square:Hi,squaredDifference:mO,squeeze:I1,stack:_u,step:Qb,stridedSlice:rB,string:Bie,sub:Bn,sum:Xn,tan:iB,tanh:wb,tensor:Tf,tensor1d:fc,tensor2d:s1,tensor3d:aB,tensor4d:bie,tensor5d:wie,tensor6d:vie,tensorScatterUpdate:_ie,tile:hd,topk:lB,transpose:Ir,truncatedNormal:yO,unique:cB,unsortedSegmentSum:bO,unstack:Sd,upperBound:xie,variable:uB,where:Fl,whereAsync:fB,zeros:Xo,zerosLike:Rr},Symbol.toStringTag,{value:"Module"}));const Gje=(n,e,t,s=bc)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(ae("a",n,e,t),ae("b",n,e,t))];case"AddN":return[s.addN(ae("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod(ae("a",n,e,t),ae("b",n,e,t))];case"Mul":return[s.mul(ae("a",n,e,t),ae("b",n,e,t))];case"RealDiv":case"Div":return[s.div(ae("a",n,e,t),ae("b",n,e,t))];case"DivNoNan":return[s.divNoNan(ae("a",n,e,t),ae("b",n,e,t))];case"FloorDiv":return[s.floorDiv(ae("a",n,e,t),ae("b",n,e,t))];case"Sub":return[s.sub(ae("a",n,e,t),ae("b",n,e,t))];case"Minimum":return[s.minimum(ae("a",n,e,t),ae("b",n,e,t))];case"Maximum":return[s.maximum(ae("a",n,e,t),ae("b",n,e,t))];case"Pow":return[s.pow(ae("a",n,e,t),ae("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference(ae("a",n,e,t),ae("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const Hje=(n,e,t,s=bc)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(ae("x",n,e,t))];case"Acos":return[s.acos(ae("x",n,e,t))];case"Acosh":return[s.acosh(ae("x",n,e,t))];case"Asin":return[s.asin(ae("x",n,e,t))];case"Asinh":return[s.asinh(ae("x",n,e,t))];case"Atan":return[s.atan(ae("x",n,e,t))];case"Atan2":return[s.atan2(ae("x",n,e,t),ae("y",n,e,t))];case"Atanh":return[s.atanh(ae("x",n,e,t))];case"Ceil":return[s.ceil(ae("x",n,e,t))];case"Complex":return[s.complex(ae("real",n,e,t),ae("imag",n,e,t))];case"Cos":return[s.cos(ae("x",n,e,t))];case"Cosh":return[s.cosh(ae("x",n,e,t))];case"Elu":return[s.elu(ae("x",n,e,t))];case"Erf":return[s.erf(ae("x",n,e,t))];case"Exp":return[s.exp(ae("x",n,e,t))];case"Expm1":return[s.expm1(ae("x",n,e,t))];case"Floor":return[s.floor(ae("x",n,e,t))];case"Log":return[s.log(ae("x",n,e,t))];case"Log1p":return[s.log1p(ae("x",n,e,t))];case"Imag":return[s.imag(ae("x",n,e,t))];case"Neg":return[s.neg(ae("x",n,e,t))];case"Reciprocal":return[s.reciprocal(ae("x",n,e,t))];case"Real":return[s.real(ae("x",n,e,t))];case"Relu":return[s.relu(ae("x",n,e,t))];case"Round":return[s.round(ae("x",n,e,t))];case"Selu":return[s.selu(ae("x",n,e,t))];case"Sigmoid":return[s.sigmoid(ae("x",n,e,t))];case"Sin":return[s.sin(ae("x",n,e,t))];case"Sign":return[s.sign(ae("x",n,e,t))];case"Sinh":return[s.sinh(ae("x",n,e,t))];case"Softplus":return[s.softplus(ae("x",n,e,t))];case"Sqrt":return[s.sqrt(ae("x",n,e,t))];case"Square":return[s.square(ae("x",n,e,t))];case"Tanh":return[s.tanh(ae("x",n,e,t))];case"Tan":return[s.tan(ae("x",n,e,t))];case"ClipByValue":return[s.clipByValue(ae("x",n,e,t),ae("clipValueMin",n,e,t),ae("clipValueMax",n,e,t))];case"Relu6":return[s.relu6(ae("x",n,e,t))];case"Rsqrt":return[s.rsqrt(cc(n.inputNames[0],e,t))];case"LeakyRelu":return[s.leakyRelu(ae("x",n,e,t),ae("alpha",n,e,t))];case"Prelu":return[s.prelu(ae("x",n,e,t),ae("alpha",n,e,t))];case"IsNan":return[s.isNaN(cc(n.inputNames[0],e,t))];case"IsInf":return[s.isInf(cc(n.inputNames[0],e,t))];case"IsFinite":return[s.isFinite(cc(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};function rh(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){we(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const r=n[s],a=e[s];we(r<0||a<0||r===a,()=>t+` Shapes ${n} and ${e} must match`)}}}function KH(n){return!(typeof n=="number"||n.some(e=>e<0))}function KC(n,e,t){let s=i6(n,t);const r=!KH(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(a=>{s=i6(a.shape,s)}),!KH(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function i6(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const r=n[s],a=e[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=r>=0?r:a}return t}class qje{constructor(e,t,s,r,a,o,l){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=l,this.tensors=[],this.closed_=!1,this.idTensor=ws(0),bl(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),rh(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,bl(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,r)=>this.write(s,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Tf([],[0].concat(this.elementShape));const s=this.readMany(e);return rh(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),_u(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Tf([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const s=this.readMany(t);return rh(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Po(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,Sd(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const r=e.map(c=>(s+=c,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:t.size/s,o=[];wt(()=>{t=nt(t,[1,s,a]);for(let c=0;c<e.length;++c){const f=[0,c===0?0:r[c-1],0],d=[1,e[c],a];o[c]=nt(Pr(t,f,d),this.elementShape)}return o});const l=[];for(let c=0;c<e.length;c++)l[c]=c;this.writeMany(l,o)}}class Tb{get id(){return this.idTensor.id}constructor(e,t,s,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e?.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);rh(t,a.shape,"TensorList shape mismatch: "),bl(a)}),this.idTensor=ws(0),this.maxNumElements=r,bl(this.idTensor)}copy(){return new Tb([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);rh(e,this.elementShape,"TensorList shape mismatch: ");const r=KC(this.elementShape,this.tensors,e);return wt(()=>{const a=this.tensors.map(o=>nt(o,r));return _u(a,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=KC(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,rh(r.shape,e,"TensorList shape mismatch: "),nt(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(rh(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");bl(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Tb([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);rh(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=KC(this.elementShape,this.tensors,t);return nt(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);rh(this.elementShape,t.shape,"TensorList shape mismatch: "),bl(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);rh(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=KC(this.elementShape,this.tensors,s);return e.length===0?Tf([],[0].concat(r)):wt(()=>{const a=e.map(o=>nt(this.tensors[o],r));return _u(a,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);rh(this.elementShape,t,"TensorList shape mismatch: ");const s=KC(this.elementShape,this.tensors,t);return this.size()===0?Tf([],[0].concat(s)):wt(()=>{const r=this.tensors.map(a=>nt(a,s));return Po(r,0)})}}function Yje(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const r=n.shape.slice(1);rh(r,e,"TensorList shape mismatch: ");const a=Sd(n);return new Tb(a,e,s)}function Kje(n,e,t,s){return new Tb([],n,e,s)}function Xje(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new Tb([],t,n.dtype,s),o=Sd(n,0);return e.forEach((l,c)=>{a.setItem(l,o[c])}),a}function Qje(n,e,t){let s=0;const r=e.map(f=>(s+=f,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const a=n.shape.slice(1),o=i6(a,t),l=s===0?0:n.size/s,c=wt(()=>{const f=[];n=nt(n,[1,s,l]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:r[d-1],0],g=[1,e[d],l];f[d]=nt(Pr(n,p,g),o)}return n.dispose(),f}),u=new Tb([],t,n.dtype,e.length);for(let f=0;f<c.length;f++)u.setItem(f,c[f]);return u}const Jje=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=ae("thenBranch",n,e,t),r=ae("elseBranch",n,e,t),a=ae("cond",n,e,t),o=ae("args",n,e,t);return(await a.data())[0]?t.functionMap[s].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap):t.functionMap[r].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=ae("body",n,e,t),r=ae("cond",n,e,t),a=ae("args",n,e,t),o=await t.functionMap[r].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap),l=a.map(f=>f.id);let c=await o[0].data();o.forEach(f=>{!f.kept&&l.indexOf(f.id)===-1&&f.dispose()});let u=a;for(;c[0];){const f=u;u=await t.functionMap[s].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);const d=u.map(p=>p.id);f.forEach(p=>{!p.kept&&l.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()});const h=await t.functionMap[r].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);c=await h[0].data(),h.forEach(p=>{!p.kept&&l.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()})}return u}case"LoopCond":{const s=ae("pred",n,e,t);return[_g(s)]}case"Switch":{const s=ae("pred",n,e,t);let r=ae("data",n,e,t);return r.kept||(r=_g(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>cc(r,e,t)!==void 0);if(s){const r=cc(s,e,t);return[_g(r)]}return}case"Enter":{const s=ae("frameName",n,e,t),r=ae("tensor",n,e,t);return t.enterFrame(s),[_g(r)]}case"Exit":{const s=ae("tensor",n,e,t);return t.exitFrame(),[_g(s)]}case"NextIteration":{const s=ae("tensor",n,e,t);return t.nextIteration(),[_g(s)]}case"TensorArrayV3":{const s=ae("size",n,e,t),r=ae("dtype",n,e,t),a=ae("elementShape",n,e,t),o=ae("dynamicSize",n,e,t),l=ae("clearAfterRead",n,e,t),c=ae("identicalElementShapes",n,e,t),u=ae("name",n,e,t),f=new qje(u,r,s,a,c,o,l);return t.addTensorArray(f),[f.idTensor,ws(1)]}case"TensorArrayWriteV3":{const s=ae("tensorArrayId",n,e,t),r=ae("index",n,e,t),a=ae("tensor",n,e,t),o=t.getTensorArray(s.id);return o.write(r,a),[o.idTensor]}case"TensorArrayReadV3":{const s=ae("tensorArrayId",n,e,t),r=ae("index",n,e,t);return[t.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=ae("tensorArrayId",n,e,t),r=ae("indices",n,e,t),a=ae("dtype",n,e,t);return[t.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=ae("tensorArrayId",n,e,t),r=ae("indices",n,e,t),a=ae("tensor",n,e,t),o=t.getTensorArray(s.id);return o.scatter(r,a),[o.idTensor]}case"TensorArrayConcatV3":{const s=ae("tensorArrayId",n,e,t),r=t.getTensorArray(s.id),a=ae("dtype",n,e,t);return[r.concat(a)]}case"TensorArraySplitV3":{const s=ae("tensorArrayId",n,e,t),r=ae("tensor",n,e,t),a=ae("lengths",n,e,t),o=t.getTensorArray(s.id);return o.split(a,r),[o.idTensor]}case"TensorArraySizeV3":{const s=ae("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return[ws(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=ae("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=ae("tensorListId",n,e,t),r=ae("index",n,e,t),a=ae("tensor",n,e,t),o=t.getTensorList(s.id);return o.setItem(r,a),[o.idTensor]}case"TensorListGetItem":{const s=ae("tensorListId",n,e,t),r=ae("index",n,e,t),a=ae("elementShape",n,e,t),o=ae("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(r,a,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=ae("indices",n,e,t),r=ae("tensor",n,e,t),a=ae("elementShape",n,e,t),o=ae("numElements",n,e,t),l=Xje(r,s,a,o);return t.addTensorList(l),[l.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=ae("elementShape",n,e,t),r=ae("elementDType",n,e,t);let a;n.op==="TensorListReserve"?a="numElements":a="maxNumElements";const o=ae(a,n,e,t),l=n.op==="TensorListReserve"?-1:o,c=Kje(s,r,o,l);return t.addTensorList(c),[c.idTensor]}case"TensorListGather":{const s=ae("tensorListId",n,e,t),r=ae("indices",n,e,t),a=ae("elementShape",n,e,t),o=ae("elementDType",n,e,t);return[t.getTensorList(s.id).gather(r,o,a)]}case"TensorListStack":{const s=ae("tensorListId",n,e,t),r=ae("elementShape",n,e,t),a=ae("elementDType",n,e,t),o=ae("numElements",n,e,t);return[t.getTensorList(s.id).stack(r,a,o)]}case"TensorListFromTensor":{const s=ae("tensor",n,e,t),r=ae("elementShape",n,e,t),a=ae("elementDType",n,e,t),o=Yje(s,r,a);return t.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=ae("tensorListId",n,e,t),r=t.getTensorList(s.id),a=ae("dtype",n,e,t),o=ae("elementShape",n,e,t);return[r.concat(a,o)]}case"TensorListPushBack":{const s=ae("tensorListId",n,e,t),r=ae("tensor",n,e,t),a=t.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=ae("tensorListId",n,e,t),r=ae("elementShape",n,e,t),a=ae("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=ae("tensor",n,e,t),r=ae("elementShape",n,e,t),a=ae("lengths",n,e,t),o=Qje(s,a,r);return t.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=ae("tensorListId",n,e,t),r=t.getTensorList(s.id);return[ws(r.size(),"int32")]}case"TensorListResize":{const s=ae("tensorListId",n,e,t),r=ae("size",n,e,t),o=t.getTensorList(s.id).resize(r);return t.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};function XH(n,e,t){const[s,r]=ae("fusedOps",n,e,t),a=s==="biasadd",o=!a,l=r==="prelu",c=s==="fusedbatchnorm",u=ae("numArgs",n,e,t);if(a){if(l&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&a&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const f=ae("strides",n,e,t),d=TL(n,e,t),h=ae("dataFormat",n,e,t).toUpperCase(),p=ae("dilations",n,e,t);let[g,b]=ae("args",n,e,t);o&&(b=g,g=void 0);const v=ae("leakyreluAlpha",n,e,t);return{stride:f,pad:d,dataFormat:h,dilations:p,biasArg:g,preluArg:b,activationFunc:r,leakyreluAlpha:v}}const Zje=(n,e,t,s=bc)=>{switch(n.op){case"Conv1D":{const r=ae("stride",n,e,t),a=ae("pad",n,e,t),o=ae("dataFormat",n,e,t).toUpperCase(),l=ae("dilation",n,e,t);return[s.conv1d(ae("x",n,e,t),ae("filter",n,e,t),r,a,o,l)]}case"Conv2D":{const r=ae("strides",n,e,t),a=TL(n,e,t),o=ae("dataFormat",n,e,t).toUpperCase(),l=ae("dilations",n,e,t);return[s.conv2d(ae("x",n,e,t),ae("filter",n,e,t),[r[1],r[2]],a,o,[l[1],l[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:o,dilations:l,biasArg:c,preluArg:u,activationFunc:f,leakyreluAlpha:d}=XH(n,e,t);return[s.fused.conv2d({x:ae("x",n,e,t),filter:ae("filter",n,e,t),strides:[r[1],r[2]],pad:a,dataFormat:o,dilations:[l[1],l[2]],bias:c,activation:f,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:o,dilations:l,biasArg:c,preluArg:u,activationFunc:f,leakyreluAlpha:d}=XH(n,e,t);return[s.fused.depthwiseConv2d({x:ae("x",n,e,t),filter:ae("filter",n,e,t),strides:[r[1],r[2]],pad:a,dataFormat:o,dilations:[l[1],l[2]],bias:c,activation:f,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=ae("outputShape",n,e,t),a=ae("strides",n,e,t),o=TL(n,e,t);return[s.conv2dTranspose(ae("x",n,e,t),ae("filter",n,e,t),r,[a[1],a[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=ae("strides",n,e,t),a=TL(n,e,t),o=ae("dilations",n,e,t),l=ae("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d(ae("input",n,e,t),ae("filter",n,e,t),[r[1],r[2]],a,l,[o[1],o[2]])]}case"Conv3D":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("dataFormat",n,e,t).toUpperCase(),l=ae("dilations",n,e,t);return[s.conv3d(ae("x",n,e,t),ae("filter",n,e,t),[r[1],r[2],r[3]],a,o,[l[1],l[2],l[3]])]}case"AvgPool":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("kernelSize",n,e,t);return[s.avgPool(ae("x",n,e,t),[o[1],o[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("kernelSize",n,e,t);return[s.maxPool(ae("x",n,e,t),[o[1],o[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("kernelSize",n,e,t),l=ae("includeBatchInIndex",n,e,t),{result:c,indexes:u}=s.maxPoolWithArgmax(ae("x",n,e,t),[o[1],o[2]],[r[1],r[2]],a,l);return[c,u]}case"AvgPool3D":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("kernelSize",n,e,t);return[s.avgPool3d(ae("x",n,e,t),[o[1],o[2],o[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("kernelSize",n,e,t);return[s.maxPool3d(ae("x",n,e,t),[o[1],o[2],o[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=ae("strides",n,e,t),a=ae("pad",n,e,t),o=ae("dilations",n,e,t),l=r[1],c=r[2],u=o[1],f=o[2];return[s.dilation2d(ae("x",n,e,t),ae("filter",n,e,t),[l,c],a,[u,f],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const eRe=(n,e,t,s=bc)=>{switch(n.op){case"Fill":{const r=ae("shape",n,e,t),a=ae("dtype",n,e,t),o=ae("value",n,e,t);return[s.fill(r,o,a)]}case"LinSpace":{const r=ae("start",n,e,t),a=ae("stop",n,e,t),o=ae("num",n,e,t);return[s.linspace(r,a,o)]}case"Multinomial":{const r=ae("logits",n,e,t),a=ae("numSamples",n,e,t),o=ae("seed",n,e,t);return[s.multinomial(r,a,o)]}case"OneHot":{const r=ae("indices",n,e,t),a=ae("depth",n,e,t),o=ae("onValue",n,e,t),l=ae("offValue",n,e,t),c=ae("dtype",n,e,t);return[s.oneHot(r,a,o,l,c)]}case"Ones":return[s.ones(ae("shape",n,e,t),ae("dtype",n,e,t))];case"OnesLike":return[s.onesLike(ae("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal(ae("shape",n,e,t),ae("dtype",n,e,t),ae("seed",n,e,t))];case"RandomUniform":return[s.randomUniform(ae("shape",n,e,t),ae("minval",n,e,t),ae("maxval",n,e,t),ae("dtype",n,e,t))];case"RandomUniformInt":return[s.randomUniformInt(ae("shape",n,e,t),ae("minval",n,e,t),ae("maxval",n,e,t),ae("seed",n,e,t))];case"Range":{const r=ae("start",n,e,t),a=ae("stop",n,e,t),o=ae("step",n,e,t);return[s.range(r,a,o,ae("dtype",n,e,t))]}case"TruncatedNormal":{const r=ae("shape",n,e,t),a=ae("mean",n,e,t),o=ae("stdDev",n,e,t),l=ae("seed",n,e,t);return[s.truncatedNormal(r,a,o,ae("dtype",n,e,t),l)]}case"Zeros":return[s.zeros(ae("shape",n,e,t),ae("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike(ae("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};function D5(n,e,t){const s=ae("boxes",n,e,t),r=ae("scores",n,e,t),a=ae("maxOutputSize",n,e,t),o=ae("iouThreshold",n,e,t),l=ae("scoreThreshold",n,e,t),c=ae("softNmsSigma",n,e,t);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}}const tRe=async(n,e,t,s,r=bc)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:o,maxOutputSize:l,iouThreshold:c,scoreThreshold:u,softNmsSigma:f}=D5(n,e,t),d=await r.image.nonMaxSuppressionWithScoreAsync(a,o,l,c,u,f);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:o,maxOutputSize:l,iouThreshold:c,scoreThreshold:u}=D5(n,e,t),f=ae("padToMaxOutputSize",n,e,t),d=await r.image.nonMaxSuppressionPaddedAsync(a,o,l,c,u,f);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:o,maxOutputSize:l,iouThreshold:c,scoreThreshold:u}=D5(n,e,t);return[await r.image.nonMaxSuppressionAsync(a,o,l,c,u)]}case"Where":{const a=r.cast(ae("condition",n,e,t),"bool"),o=[await r.whereAsync(a)];return a.dispose(),o}case"ListDiff":return r.setdiff1dAsync(ae("x",n,e,t),ae("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};const nRe=(n,e,t,s=bc)=>{switch(n.op){case"LowerBound":{const r=ae("sortedSequence",n,e,t),a=ae("values",n,e,t);return[s.lowerBound(r,a)]}case"TopKV2":{const r=ae("x",n,e,t),a=ae("k",n,e,t),o=ae("sorted",n,e,t),l=s.topk(r,a,o);return[l.values,l.indices]}case"UpperBound":{const r=ae("sortedSequence",n,e,t),a=ae("values",n,e,t);return[s.upperBound(r,a)]}case"Unique":{const r=ae("x",n,e,t),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=ae("x",n,e,t),a=ae("axis",n,e,t),o=s.unique(r,a);return[o.values,o.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const sRe=(n,e,t,s=bc)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const r=ae("default",n,e,t);return[cc(n.name,e,t)||r];case"Placeholder":return[cc(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const f=ae("x",n,e,t);return[_g(f)]}case"IdentityN":return ae("x",n,e,t).map(f=>_g(f));case"Snapshot":const a=ae("x",n,e,t);return[_g(a)];case"Shape":return[s.tensor1d(ae("x",n,e,t).shape,"int32")];case"ShapeN":return ae("x",n,e,t).map(f=>s.tensor1d(f.shape));case"Size":return[s.scalar(ae("x",n,e,t).size,"int32")];case"Rank":return[s.scalar(ae("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=ae("x",n,e,t),l=ae("data",n,e,t),c=ae("message",n,e,t),u=ae("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let f=0;f<l.length;f++)console.log(Array.prototype.slice.call(l[f].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${n.op} is not implemented`)}};class rRe{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=ws(0),this.tensorMap=new Map,bl(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return ws(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),wt(()=>{const r=Sd(t),a=s.length,o=r.length;we(a===o,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${o} elements.`);for(let l=0;l<a;l++){const c=s[l],u=r[l];bl(u),this.tensorMap.set(c,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return wt(()=>{const r=[];for(let a=0;a<s.length;a++){const o=s[a],l=this.findWithDefault(o,t);r.push(l)}return _u(r)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}const iRe=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(n.name);if(r!=null)return[r];{const a=ae("keyDType",n,e,t),o=ae("valueDType",n,e,t),l=new rRe(a,o);return s.addHashTable(n.name,l),[l.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=ae("tableHandle",n,e,t,s),a=ae("keys",n,e,t),o=ae("values",n,e,t);return[await s.getHashTableById(r.id).import(a,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=ae("tableHandle",n,e,t,s),a=ae("keys",n,e,t),o=ae("defaultValue",n,e,t);return[await s.getHashTableById(r.id).find(a,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=ae("tableHandle",n,e,t,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const aRe=(n,e,t,s=bc)=>{switch(n.op){case"ResizeBilinear":{const r=ae("images",n,e,t),a=ae("size",n,e,t),o=ae("alignCorners",n,e,t),l=ae("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(r,[a[0],a[1]],o,l)]}case"ResizeNearestNeighbor":{const r=ae("images",n,e,t),a=ae("size",n,e,t),o=ae("alignCorners",n,e,t),l=ae("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],o,l)]}case"CropAndResize":{const r=ae("image",n,e,t),a=ae("boxes",n,e,t),o=ae("boxInd",n,e,t),l=ae("cropSize",n,e,t),c=ae("method",n,e,t),u=ae("extrapolationValue",n,e,t);return[s.image.cropAndResize(r,a,o,l,c,u)]}case"ImageProjectiveTransformV3":{const r=ae("images",n,e,t),a=ae("transforms",n,e,t),o=ae("outputShape",n,e,t),l=ae("fillValue",n,e,t),c=ae("interpolation",n,e,t),u=ae("fillMode",n,e,t);return[s.image.transform(r,a,c.toLowerCase(),u.toLowerCase(),l,o)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const oRe=(n,e,t,s=bc)=>{switch(n.op){case"Equal":return[s.equal(ae("a",n,e,t),ae("b",n,e,t))];case"NotEqual":return[s.notEqual(ae("a",n,e,t),ae("b",n,e,t))];case"Greater":return[s.greater(ae("a",n,e,t),ae("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual(ae("a",n,e,t),ae("b",n,e,t))];case"Less":return[s.less(ae("a",n,e,t),ae("b",n,e,t))];case"LessEqual":return[s.lessEqual(ae("a",n,e,t),ae("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd(ae("a",n,e,t),ae("b",n,e,t))];case"LogicalNot":return[s.logicalNot(ae("a",n,e,t))];case"LogicalOr":return[s.logicalOr(ae("a",n,e,t),ae("b",n,e,t))];case"Select":case"SelectV2":return[s.where(ae("condition",n,e,t),ae("a",n,e,t),ae("b",n,e,t))];case"BitwiseAnd":return[s.bitwiseAnd(ae("a",n,e,t),ae("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const lRe=(n,e,t,s=bc)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(ae("a",n,e,t),ae("b",n,e,t),ae("transposeA",n,e,t),ae("transposeB",n,e,t))];case"Einsum":return[s.einsum(ae("equation",n,e,t),...ae("tensors",n,e,t))];case"Transpose":return[s.transpose(ae("x",n,e,t),ae("perm",n,e,t))];case"_FusedMatMul":const[r,a]=ae("fusedOps",n,e,t),o=r==="biasadd",l=a==="prelu",c=ae("numArgs",n,e,t),u=ae("leakyreluAlpha",n,e,t);if(o){if(l&&c!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&c!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[f,d]=ae("args",n,e,t);return[s.fused.matMul({a:ae("a",n,e,t),b:ae("b",n,e,t),transposeA:ae("transposeA",n,e,t),transposeB:ae("transposeB",n,e,t),bias:f,activation:a,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[s.linalg.bandPart(ae("a",n,e,t),ae("numLower",n,e,t),ae("numUpper",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const cRe=(n,e,t,s=bc)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(ae("x",n,e,t),ae("axis",n,e,t),ae("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(ae("x",n,e,t),ae("mean",n,e,t),ae("variance",n,e,t),ae("offset",n,e,t),ae("scale",n,e,t),ae("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm(ae("x",n,e,t),ae("mean",n,e,t),ae("variance",n,e,t),ae("offset",n,e,t),ae("scale",n,e,t),ae("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization(ae("x",n,e,t),ae("radius",n,e,t),ae("bias",n,e,t),ae("alpha",n,e,t),ae("beta",n,e,t))];case"Softmax":return[s.softmax(ae("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax(ae("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const uRe=(n,e,t,s=bc)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(ae("paramsNestedSplits",n,e,t),ae("paramsDenseValues",n,e,t),ae("indices",n,e,t),ae("outputRaggedRank",n,e,t));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(ae("starts",n,e,t),ae("limits",n,e,t),ae("splits",n,e,t));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(ae("shape",n,e,t),ae("values",n,e,t),ae("defaultValue",n,e,t),ae("rowPartitionTensors",n,e,t),ae("rowPartitionTypes",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const fRe=(n,e,t,s=bc)=>{switch(n.op){case"Max":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.max(ae("x",n,e,t),l,c)]}case"Mean":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.mean(ae("x",n,e,t),l,c)]}case"Min":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.min(ae("x",n,e,t),l,c)]}case"Sum":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.sum(ae("x",n,e,t),l,c)]}case"All":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.all(ae("x",n,e,t),l,c)]}case"Any":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.any(ae("x",n,e,t),l,c)]}case"ArgMax":{const l=ae("axis",n,e,t);return[s.argMax(ae("x",n,e,t),l)]}case"ArgMin":{const l=ae("axis",n,e,t);return[s.argMin(ae("x",n,e,t),l)]}case"Prod":{const l=ae("axis",n,e,t),c=ae("keepDims",n,e,t);return[s.prod(ae("x",n,e,t),l,c)]}case"Cumprod":{const l=ae("axis",n,e,t),c=ae("exclusive",n,e,t),u=ae("reverse",n,e,t);return[s.cumprod(ae("x",n,e,t),l,c,u)]}case"Cumsum":{const l=ae("axis",n,e,t),c=ae("exclusive",n,e,t),u=ae("reverse",n,e,t);return[s.cumsum(ae("x",n,e,t),l,c,u)]}case"Bincount":const r=ae("x",n,e,t),a=ae("weights",n,e,t),o=ae("size",n,e,t);return[s.bincount(r,a,o)];case"DenseBincount":{const l=ae("x",n,e,t),c=ae("weights",n,e,t),u=ae("size",n,e,t),f=ae("binaryOutput",n,e,t);return[s.denseBincount(l,c,u,f)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const dRe=(n,e,t,s=bc)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=ae("n",n,e,t),a=ae("axis",n,e,t);let o=ae("tensors",n,e,t);return o=o.slice(0,r),[s.concat(o,a)]}case"Gather":{const r=ae("x",n,e,t),a=ae("indices",n,e,t);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=ae("axis",n,e,t),a=ae("batchDims",n,e,t),o=ae("x",n,e,t),l=ae("indices",n,e,t);return[s.gather(o,s.cast(l,"int32"),r,a)]}case"Reverse":{const r=ae("dims",n,e,t),a=[];for(let l=0;l<r.length;l++)r[l]&&a.push(l);const o=ae("x",n,e,t);return[s.reverse(o,a)]}case"ReverseV2":{const r=ae("axis",n,e,t),a=ae("x",n,e,t);return[s.reverse(a,r)]}case"Slice":{const r=ae("begin",n,e,t),a=ae("size",n,e,t);return[s.slice(ae("x",n,e,t),r,a)]}case"StridedSlice":{const r=ae("begin",n,e,t),a=ae("end",n,e,t),o=ae("strides",n,e,t),l=ae("beginMask",n,e,t),c=ae("endMask",n,e,t),u=ae("ellipsisMask",n,e,t),f=ae("newAxisMask",n,e,t),d=ae("shrinkAxisMask",n,e,t),h=ae("x",n,e,t);return[s.stridedSlice(h,r,a,o,l,c,u,f,d)]}case"Pack":return wt(()=>{const r=ae("axis",n,e,t),a=ae("tensors",n,e,t),o=a[0].shape,l=s.squeeze(a[0]).shape,c=a.map(u=>{const f=xr(u.shape,o);if(!f&&!xr(s.squeeze(u).shape,l))throw new Error("the input tensors shape does not match");return f?u:s.reshape(u,o)});return[s.stack(c,r)]});case"Unpack":{const r=ae("axis",n,e,t),a=ae("tensor",n,e,t);return s.unstack(a,r)}case"Tile":{const r=ae("reps",n,e,t);return[s.tile(ae("x",n,e,t),r)]}case"Split":case"SplitV":{const r=ae("axis",n,e,t),a=ae("numOrSizeSplits",n,e,t),o=ae("x",n,e,t);return s.split(o,a,r)}case"ScatterNd":{const r=ae("indices",n,e,t),a=ae("values",n,e,t),o=ae("shape",n,e,t);return[s.scatterND(r,a,o)]}case"GatherNd":{const r=ae("x",n,e,t),a=ae("indices",n,e,t);return[s.gatherND(r,a)]}case"SparseToDense":{const r=ae("sparseIndices",n,e,t),a=ae("outputShape",n,e,t),o=ae("sparseValues",n,e,t),l=ae("defaultValue",n,e,t);return[s.sparseToDense(r,o,a,o.dtype===l.dtype?l:s.cast(l,o.dtype))]}case"TensorScatterUpdate":{const r=ae("indices",n,e,t),a=ae("values",n,e,t),o=ae("tensor",n,e,t);return[s.tensorScatterUpdate(o,r,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const hRe=(n,e,t,s=bc)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:o,reverseIndexMap:l}=s.sparse.sparseFillEmptyRows(ae("indices",n,e,t),ae("values",n,e,t),ae("denseShape",n,e,t),ae("defaultValue",n,e,t));return[r,a,o,l]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(ae("inputIndices",n,e,t),ae("inputShape",n,e,t),ae("newShape",n,e,t));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(ae("data",n,e,t),ae("indices",n,e,t),ae("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(ae("data",n,e,t),ae("indices",n,e,t),ae("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const pRe=(n,e,t,s=bc)=>{switch(n.op){case"FFT":return[s.fft(ae("x",n,e,t))];case"IFFT":return[s.ifft(ae("x",n,e,t))];case"RFFT":return[s.rfft(ae("x",n,e,t))];case"IRFFT":return[s.irfft(ae("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const mRe=(n,e,t,s=bc)=>{switch(n.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(ae("input",n,e,t),ae("pattern",n,e,t),ae("rewrite",n,e,t),ae("replaceGlobal",n,e,t))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(ae("data",n,e,t),ae("dataSplits",n,e,t),ae("separator",n,e,t),ae("nGramWidths",n,e,t),ae("leftPad",n,e,t),ae("rightPad",n,e,t),ae("padWidth",n,e,t),ae("preserveShortSequences",n,e,t));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:o}=s.string.stringSplit(ae("input",n,e,t),ae("delimiter",n,e,t),ae("skipEmpty",n,e,t));return[r,a,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(ae("input",n,e,t),ae("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const gRe=(n,e,t,s=bc)=>{switch(n.op){case"Cast":return[s.cast(ae("x",n,e,t),ae("dtype",n,e,t))];case"ExpandDims":{const r=ae("axis",n,e,t);return[s.expandDims(ae("x",n,e,t),r)]}case"Squeeze":{const r=ae("axis",n,e,t);return[s.squeeze(ae("x",n,e,t),r)]}case"Reshape":return[s.reshape(ae("x",n,e,t),ae("shape",n,e,t))];case"EnsureShape":return[s.ensureShape(ae("x",n,e,t),ae("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad(ae("x",n,e,t),ae("padding",n,e,t),ae("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad(ae("x",n,e,t),ae("padding",n,e,t),ae("constantValue",n,e,t))];case"SpaceToBatchND":{const r=ae("blockShape",n,e,t),a=ae("paddings",n,e,t);return[s.spaceToBatchND(ae("x",n,e,t),r,a)]}case"BatchToSpaceND":{const r=ae("blockShape",n,e,t),a=ae("crops",n,e,t);return[s.batchToSpaceND(ae("x",n,e,t),r,a)]}case"DepthToSpace":{const r=ae("blockSize",n,e,t),a=ae("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace(ae("x",n,e,t),r,a)]}case"BroadcastTo":return[s.broadcastTo(ae("x",n,e,t),ae("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs(ae("s0",n,e,t),ae("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};function QH(n,e,t,s,r=wt){const a=((o,l,c)=>{switch(o.category){case"arithmetic":return r(()=>Gje(o,l,c));case"basic_math":return r(()=>Hje(o,l,c));case"control":return Jje(o,l,c);case"convolution":return r(()=>Zje(o,l,c));case"creation":return r(()=>eRe(o,l,c));case"dynamic":return tRe(o,l,c);case"evaluation":return r(()=>nRe(o,l,c));case"image":return r(()=>aRe(o,l,c));case"graph":return r(()=>sRe(o,l,c));case"logical":return r(()=>oRe(o,l,c));case"matrices":return r(()=>lRe(o,l,c));case"normalization":return r(()=>cRe(o,l,c));case"ragged":return r(()=>uRe(o,l,c));case"reduction":return r(()=>fRe(o,l,c));case"slice_join":return r(()=>dRe(o,l,c));case"sparse":return r(()=>hRe(o,l,c));case"spectral":return r(()=>pRe(o,l,c));case"string":return r(()=>mRe(o,l,c));case"transformation":return r(()=>gRe(o,l,c));case"hash_table":return iRe(o,l,c,s);case"custom":const u=tle(o.op);if(u&&u.customExecutor)return u.customExecutor(new Wje(o,l,c));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Dg(a)?a.then(o=>[].concat(o)):[].concat(a)}class JH{constructor(e={},t={},s={},r={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function ZH(n,e,t,s){const r=new Set,a=[];let o=null,l=null;const c=new Set,u=new Set(Object.keys(n).map(h=>vf(h)[0]));s=s||[];const f=new Set(s.map(h=>vf(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((zy(h)||SRe(h)||MRe(h))&&o==null&&(o=h,l=o.children.map(p=>p.name).filter(p=>r.has(p))),r.add(h.name),t[h.name]==null&&!u.has(h.name)&&!f.has(h.name)){if(h.inputs.length===0){a.push(h.name);continue}h.inputs.forEach(p=>{c.has(p.name)||(c.add(p.name),d.push(p))})}}return{inputs:n,outputs:e,usedNodes:r,missingInputs:a,dynamicNode:o,syncInputs:l}}function yRe(n,e){const{usedNodes:t,inputs:s}=e,r=Object.keys(s).map(v=>vf(v)[0]).map(v=>n.nodes[v]),a=n.initNodes||[],o=v=>t.has(typeof v=="string"?v:v.name);function l(v){return[...new Map(v.map(w=>[w.name,w])).values()]}const c=l([...r,...n.weights,...a]).filter(o),u=l([...c,...Object.values(n.nodes)]).filter(o),f=new Map(u.map(v=>[v.name,v])),d={};for(const v of u){d[v.name]=d[v.name]||0;for(const w of v.children)o(w)||(d[w.name]=Number.POSITIVE_INFINITY),d[w.name]=(d[w.name]||0)+1}const h=Object.entries(d).filter(([,v])=>v===0).map(([v])=>v),p=[...h];for(;h.length>0;){const v=h.pop(),w=f.get(v);for(const x of w.children.filter(o))--d[x.name]===0&&(p.push(x.name),h.push(x.name))}const g=p.map(v=>f.get(v)),b=bRe(g,c);return wRe(b,c),b}function bRe(n,e){const t=new Map(n.map(o=>[o.name,o])),s=e.map(o=>o.name),r=new Set(s);for(;s.length>0;){const o=s.pop(),l=t.get(o);for(const c of l.children)!t.has(c.name)||r.has(c.name)||(r.add(c.name),s.push(c.name))}return n.filter(o=>r.has(o.name))}class OI extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function wRe(n,e){const t=new Map(n.map((l,c)=>[l.name,c])),s=new Set(e.map(l=>l.name)),r=l=>s.has(typeof l=="string"?l:l.name),a=new Set(n.map(l=>l.name)),o=l=>a.has(typeof l=="string"?l:l.name);for(const l of n){for(const c of l.children.filter(o)){if(!t.has(c.name))throw new OI(`Child ${c.name} of node ${l.name} is unreachable.`);if(t.get(l.name)>t.get(c.name))throw new OI(`Node ${l.name} is scheduled to run after its child ${c.name}.`)}if(!r(l))for(const c of l.inputs){if(!t.has(c.name))throw new OI(`Input ${c.name} of node ${l.name} is unreachable.`);if(t.get(c.name)>t.get(l.name))throw new OI(`Node ${l.name} is scheduled to run before its input ${c.name}.`)}}}function vRe(n){const e=new Map(n.map((l,c)=>[l.name,c])),t=Number.MAX_SAFE_INTEGER,s=n.map((l,c)=>zy(l)?t:c),r=l=>{const c=s[e.get(l.name)];return c??-1},a=n.map((l,c)=>l.children.map(r).reduce((u,f)=>Math.max(u,f),s[c])),o=new Map;for(let l=0;l<n.length;++l){const c=a[l];if(c===t)continue;const u=n[l],f=n[c];o.has(f.name)||o.set(f.name,[]),o.get(f.name).push(u)}return o}const _Re=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),xRe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),CRe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function zy(n){return _Re.has(n.op)}function SRe(n){return xRe.has(n.op)}function MRe(n){return CRe.has(n.op)}class BN{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new BN(e.functions[s],this)})}getCompilationKey(e,t){const s=e.map(a=>a.name).sort(),r=t.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const s=ZH(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:o}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const u=t.map(d=>d.name),f=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${f}]. Missing the following inputs: [${r}]`)}const l=yRe(this.graph,s),c=vRe(l);return{orderedNodes:l,nodeLiveUntilMap:c}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return bl(t),t}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,s])=>[t,this.cloneTensorList(s)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=s.map(h=>this.graph.nodes[vf(h)[0]]),a=t.map(h=>vf(h)[0]),o=new Set(a);let l=a.map(h=>this.graph.nodes[h]);l.length===0&&(l=this._outputs);const c=this.getCompilationKey(r,l);let u=this.compiledMap.get(c);u==null&&(u=this.compile(e,l),this.compiledMap.set(c,u));try{this.keepIntermediateTensors=bt().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const f={},d={};return wt(()=>{const h=new JH(this.weightMap,f,d,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[x,S]=vf(w,h),C=[];C[S]=e[w],p[x]=C,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(C))});const g=this.getFrozenTensorIds(p),{orderedNodes:b,nodeLiveUntilMap:v}=u;for(const w of b){if(p[w.name])continue;const x=QH(w,p,h,this._resourceManager);if(Dg(x))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);p[w.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,p,h,g,o,v.get(w.name))}return this.parent==null&&h.dispose(g),t.map(w=>cc(w,p,h))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,s,r,a,o,l){if(!(zy(t)||o.has(e))){for(const c of s[e])c!=null&&(l[c.id]=(l[c.id]||0)+t.children.length);for(const c of t.inputs){if(zy(c))continue;const u=HH(c.name,s,r);if(u!=null)for(const f of u){if(!f||f.kept||a.has(f.id))continue;const d=l[f.id];d===1?(f.dispose(),delete l[f.id]):d!=null&&l[f.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,s,r,a,o){function l(c){return zy(c)||a.has(c.name)}if(!(zy(e)||o==null))for(const c of o){if(l(c))continue;const u=HH(c.name,t,s);for(const f of u)!f||f.kept||r.has(f.id)||f.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=bt().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const o=new JH(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const l=await this.executeWithControlFlow(e,o,t,s),c=t.map(h=>cc(h,l,o)),u=c.map(h=>h.id),f=Object.keys(e).map(h=>e[h].id),d=new Set([...u,...f,...this.weightIds]);return Object.values(l).forEach(h=>{h.forEach(p=>{p&&!p.isDisposed&&!d.has(p.id)&&p.dispose()})}),this.parent==null&&o.dispose(d),c}async executeFunctionAsync(e,t,s){const r=e.reduce((a,o,l)=>(a[this.inputs[l].name]=o,a),{});return this._executeAsync(r,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,r){const a=Object.keys(e),o=a.map(C=>this.graph.nodes[vf(C)[0]]),l=s.map(C=>vf(C)[0]),c=new Set(l);let u=l.map(C=>this.graph.nodes[C]);u.length===0&&(u=this._outputs);const{usedNodes:f,missingInputs:d,dynamicNode:h,syncInputs:p}=ZH(e,u,this.weightMap,this._initNodes),g=[...o,...this.graph.weights,...this._initNodes||[]].map(C=>({node:C,contexts:t.currentContext})),b=Object.assign({},this.weightMap);Object.keys(e).forEach(C=>{const[M,k]=vf(C),E=[];E[k]=e[C],b[M]=E});const v={},w=this.getFrozenTensorIds(b),x={};for(;g.length>0;){const C=this.processStack(o,g,t,b,x,w,c,v,f);await Promise.all(C)}h==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const S=u.filter(C=>!zy(C)&&!cc(C.name,b,t)).map(C=>C.name);if(S.length>0){let C="";throw h!=null&&(C=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${S}] from the provided inputs [${a}]. Consider providing the following inputs: [${d}]. ${C}`)}return b}processStack(e,t,s,r,a,o,l,c,u){const f=[];for(;t.length>0;){const d=t.pop();s.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&ae("isConstant",d.node,r,s)&&([h]=vg(d.node.name,s)),r[d.node.name]==null){const p=QH(d.node,r,s,this._resourceManager);h||([h]=vg(d.node.name,s));const g=s.currentContext;Dg(p)?f.push(p.then(b=>(r[h]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(b)),s.currentContext=g,this.checkTensorForDisposal(h,d.node,r,s,o,l,c),this.processChildNodes(d.node,t,s,r,a,u),b))):(r[h]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(p)),this.checkTensorForDisposal(h,d.node,r,s,o,l,c),this.processChildNodes(d.node,t,s,r,a,u))}else this.processChildNodes(d.node,t,s,r,a,u)}return f}processChildNodes(e,t,s,r,a,o){e.children.forEach(l=>{const[c]=vg(l.name,s);a[c]||!o.has(l.name)||(l.op==="Merge"?l.inputNames.some(u=>!!cc(u,r,s))&&(a[c]=!0,t.push({contexts:s.currentContext,node:l})):l.inputNames.every(u=>!!cc(u,r,s))&&(a[c]=!0,t.push({contexts:s.currentContext,node:l})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[r]=vf(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const o=a.attrParams.shape.value,l=o.length===s.shape.length&&s.shape.every((c,u)=>o[u]===-1||o[u]===c);we(l,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&we(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var t,s;const r={};for(const a in e){const o=(s=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||s===void 0?void 0:s[a];o!=null?r[o.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){const t=Object.keys(e).filter(s=>{const[r]=vf(s);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[t];return a!=null?a.name:t},{})}checkOutputs(e){e.forEach(t=>{const[s]=vf(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class TRe{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const kRe="?tfjs-format=file",ERe="model.json";class I9{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},s=MB){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new TRe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Dg(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(s=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}this.signature=s,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new BN(qH.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const a=qH.Instance.transformGraph(e.modelInitializer);this.initializer=new BN(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof jr?[e]:e,s={};return t.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return e}predict(e,t){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,t){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var t;if(!(e instanceof jr)&&!Array.isArray(e)){const a=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(a!=null)for(const o in a){const l=a[o];l.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[l.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,o)=>{var l,c,u;const f=(u=(c=(l=this.signature)===null||l===void 0?void 0:l.inputs)===null||c===void 0?void 0:c[o])===null||u===void 0?void 0:u.resourceId;return f!=null?a[o]=this.resourceIdToCapturedInput[f]:a[o]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,s=Object.keys(t);for(let r=0;r<s.length;r++){const a=s[r],o=t[a];this.resourceIdToCapturedInput[o.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Ws(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function IRe(n,e={},t=MB){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=LRe(n));const s=new I9(n,e,t);return await s.load(),s}function ARe(n){if(n==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(n instanceof Array){const[s,r]=n;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const a=cz(s.weightsManifest),o=oz(s,a,r);e=IN(o)}else if("load"in n)e=n;else if("modelTopology"in n&&"weightSpecs"in n&&"weightData"in n)e=IN(n);else throw new Error("Unknown model format");const t=new I9(e);return t.load(),t}function LRe(n){return n.endsWith("/")||(n=n+"/"),`${n}${ERe}${kRe}`}const rle="4.11.0";function NRe(n,e){return UN(n,e)}function UN(n,e,t=new Map,s=new Set){if(n==null)return null;if(typeof Blob=="function"&&n instanceof Blob)return n.slice();if(s.has(n))throw new Error("Circular references are not supported.");if(t.has(n))return t.get(n);const r=e(n);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(g2(n)){const a=Array.isArray(n)?[]:{};s.add(n);for(const o in n){const l=n[o],c=UN(l,e,t,s);a[o]=c}return s.delete(n),n.__proto__&&(a.__proto__=n.__proto__),a}else throw new Error(`Can't recurse into non-iterable type: ${n}`);else return t.set(n,r.value),r.value}function DRe(n,e=ale){return ile(n,e)}function ile(n,e,t=new Set){const s=n[0];if(t.has(s))throw new Error("Circular references are not supported.");const r=e(n);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(g2(s)){const a=Array.isArray(s)?[]:{};t.add(s);for(const o in s){const l=n.map(u=>u[o]),c=ile(l,e,t);a[o]=c}return t.delete(s),a}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function ale(n){return n===null?null:g2(n[0])?{value:null,recurse:!0}:{value:n,recurse:!1}}async function ole(n,e){const t=new Map;UN(n,e,t);for(const r of Array.from(t.keys())){const a=t.get(r);if(Dg(a)){const o=await a;t.set(r,o)}}return UN(n,e,t)}function g2(n){let e=!1;if(bt().get("IS_BROWSER"))e=n instanceof TextDecoder;else{const{StringDecoder:t}=require("string_decoder");e=n instanceof t}return n!=null&&!ArrayBuffer.isView(n)&&(Array.isArray(n)||typeof n=="object"&&!(n instanceof jr)&&!(n instanceof Promise)&&!e)}function ORe(n){return n==null||PRe(n)||Array.isArray(n)||typeof n=="object"&&n instanceof jr||gl(n)}function PRe(n){return n===null||typeof n!="object"&&typeof n!="function"}function $Re(n){return NRe(n,jRe)}function jRe(n){return n instanceof jr?{value:n.clone(),recurse:!1}:g2(n)?{value:null,recurse:!0}:{value:n,recurse:!1}}class lle{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),s=this.get(t);return this.set(t,this.pop()),s}}class eP extends lle{constructor(){super(eP.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=this.capacity*2,t=new Array(e),s=this.length();for(let r=0;r<s;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}eP.INITIAL_CAPACITY=32;function cle(n){return new zRe(n)}function A9(n){return new BRe(n)}function RRe(n,e){return new ule(n,e)}function FRe(n,e=X0.FAIL){return new XRe(n,e)}class Ul{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let s=await e.next();for(;!s.done;)t.push(s.value),s=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),s=e(t.value);for(;!t.done&&s;)t=await this.next(),s=e(t.value)}handleErrors(e){return new YRe(this,e)}filter(e){return new HRe(this,e)}map(e){return new qRe(this,e)}mapAsync(e){return new eq(this,e)}serialMapAsync(e){return new eq(this,e).serial()}flatmap(e){return new KRe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(t=>t===!0)}rowMajorBatch(e,t=!0){return new GRe(this,e,t)}columnMajorBatch(e,t=!0,s=ale){return this.rowMajorBatch(e,t).map(a=>DRe(a,s))}concatenate(e,t){return new ule(cle([this,e]),t)}take(e){return e<0||e==null?this:new WRe(this,e)}skip(e){return e<0||e==null?this:new VRe(this,e)}prefetch(e){return new fle(this,e)}shuffle(e,t){return new QRe(this,e,t)}serial(){return new URe(this)}}class zRe extends Ul{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:$Re(e),done:!1}}}class BRe extends Ul{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class URe extends Ul{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class VRe extends Ul{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;Ws(e.value)}return this.upstream.next()}}class WRe extends Ul{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class GRe extends Ul{constructor(e,t,s=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class HRe extends Ul{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Ws(e.value)}}}class qRe extends Ul{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=Pg(e.value),s=this.transform(e.value),r=Pg(s);for(const a of t)qD(a,r)||a.dispose();return{value:s,done:!1}}}class YRe extends Ul{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class eq extends Ul{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=Pg(e.value),s=await this.transform(e.value),r=Pg(s);for(const a of t)qD(a,r)||a.dispose();return{value:s,done:!1}}}class L9 extends Ul{constructor(){super(),this.outputQueue=new eP,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class KRe extends L9{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=Pg(e.value),s=this.transform(e.value),r=Pg(s);this.outputQueue.pushAll(s);for(const a of t)qD(a,r)||a.dispose();return!0}}class ule extends Ul{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var X0;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(X0||(X0={}));class XRe extends Ul{constructor(e,t=X0.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,s=0;function r(o){return o instanceof Ul?{value:o.next().then(c=>(t++,c.done&&s++,c.value)),recurse:!1}:{value:null,recurse:!0}}const a=await ole(this.iterators,r);if(t===s)return{value:null,done:!0};if(s>0)switch(this.mismatchMode){case X0.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case X0.SHORTEST:return{value:null,done:!0};case X0.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class fle extends Ul{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new lle(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class QRe extends fle{constructor(e,t,s){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=B_.alea(s||oc().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}}class Y_{constructor(){this.size=null}batch(e,t=!0){const s=this;we(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:t?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),wf(async()=>(await s.iterator()).columnMajorBatch(e,t,e6e),r)}concatenate(e){const t=this;let s;return this.size===1/0||e.size===1/0?s=1/0:this.size!=null&&e.size!=null?s=this.size+e.size:s=null,wf(async()=>(await t.iterator()).concatenate(await e.iterator()),s)}filter(e){const t=this;let s;return this.size===1/0?s=1/0:s=null,wf(async()=>(await t.iterator()).filter(r=>wt(()=>e(r))),s)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return wf(async()=>(await t.iterator()).map(s=>wt(()=>e(s))),this.size)}mapAsync(e){const t=this;return wf(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return wf(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){const t=this;let s;return this.size!=null&&e>0?s=this.size*e:e===0?s=0:this.size!=null&&(e===void 0||e<0)?s=1/0:s=null,wf(async()=>{const r=A9(async()=>({value:await t.iterator(),done:!1}));return RRe(r.take(e))},s)}skip(e){const t=this;let s;return this.size!=null&&e>=0&&this.size>=e?s=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?s=0:s=null,wf(async()=>(await t.iterator()).skip(e),s)}shuffle(e,t,s=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,a=B_.alea(t||oc().toString());return wf(async()=>{let o=a.int32();return s&&(o+=a.int32()),(await r.iterator()).shuffle(e,o.toString())},this.size)}take(e){const t=this;let s;return this.size!=null&&this.size>e?s=e:this.size!=null&&this.size<=e?s=this.size:s=null,wf(async()=>(await t.iterator()).take(e),s)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}Y_.MAX_BUFFER_SIZE=1e4;function wf(n,e=null){return new class extends Y_{constructor(){super(...arguments),this.size=e}async iterator(){return n()}}}function JRe(n){return wf(async()=>cle(n),n.length)}function ZRe(n){if(!g2(n))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(n))for(let t=0;t<n.length;t++)e=e==null?n[t].size:Math.min(e,n[t].size);else if(n instanceof Object)for(const t in n)e=e==null?n[t].size:Math.min(e,n[t].size);return wf(async()=>{const t=await ole(n,s=>{if(s instanceof Y_)return{value:s.iterator(),recurse:!1};if(g2(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return FRe(t,X0.SHORTEST)},e)}function e6e(n){if(n===null)return null;const e=n[0];return ORe(e)?{value:t6e(n),recurse:!1}:{value:null,recurse:!0}}function t6e(n){if(n.length===0)throw new Error("Can't make a batch of zero elements.");return n[0]instanceof jr?_u(n):Tf(n)}class dle extends Y_{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(r=>(r.endsWith("\r")&&(r=r.slice(0,-1)),r))}}const PI='"',XC=Symbol("out"),tq=Symbol("field"),$I=Symbol("quote"),O5=Symbol("quoteafterquote"),nq=Symbol("quoteinquote");class hle extends Y_{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&we(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);const t=this.fullColumnNames.reduce((r,a)=>(r[a]=r[a]+1||1,r),{}),s=Object.keys(t).filter(r=>t[r]>1);if(we(s.length===0,()=>"Duplicate column names found: "+s.toString()),this.columnConfigs){for(const r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const t=await(await this.base.iterator()).next();if(t.done)throw new Error("No data was found for CSV parsing.");const s=t.value;return this.parseRow(s,!1)}else return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new dle(e),t||(t={}),this.hasHeader=t.hasHeader!==!1,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(we(t.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(t=>this.makeDataElement(t))}makeDataElement(e){const t=this.parseRow(e),s={},r={};for(let a=0;a<this.fullColumnNames.length;a++){const o=this.fullColumnNames[a],l=this.columnConfigs?this.columnConfigs[o]:null;if(!(this.configuredColumnsOnly&&!l)){const c=t[a];let u=null;if(c==="")if(l&&l.default!==void 0)u=l.default;else{if(l&&(l.required||l.isLabel))throw new Error(`Required column ${o} is empty in this line: ${e}`);u=void 0}else{const f=Number(c);if(isNaN(f))l&&l.dtype==="bool"?u=this.getBoolean(c):u=c;else if(!l||!l.dtype)u=f;else switch(l.dtype){case"float32":u=f;break;case"int32":u=Math.floor(f);break;case"bool":u=this.getBoolean(c);break;default:u=f}}l&&l.isLabel?r[o]=u:s[o]=u}}return Object.keys(r).length===0?s:{xs:s,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,t=!0){const s=[];let r=0;const a=e.length;let o=XC;for(let l=0;l<a;l++)switch(o){case XC:switch(e.charAt(l)){case PI:r=l+1,o=$I;break;case this.delimiter:if(r=l+1,this.delimiter===" "&&this.delimWhitespace)break;s.push(""),o=XC;break;default:o=tq,r=l;break}break;case tq:e.charAt(l)===this.delimiter&&(s.push(e.substring(r,l)),o=XC,r=l+1);break;case $I:e.charAt(l)===PI&&(o=O5);break;case O5:switch(e.charAt(l)){case this.delimiter:s.push(e.substring(r,l-1)),o=XC,r=l+1;break;case PI:o=$I;break;default:o=nq;break}break;case nq:e.charAt(l)===PI&&(o=$I);break}if(o===O5?s.push(e.substring(r,a-1)):s.push(e.substring(r)),t&&s.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${s}`);return s}}class N9 extends Ul{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;const t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!bt().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const t=new N9(e);return await t.start(),t}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(s){throw new Error(`Error thrown while initializing video stream: ${s.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t;const s=await this.getAudioData();if(this.includeSpectrogram){const r=this.flattenQueue(s.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const r=this.flattenQueue(s.timeDataQueue);t=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const e=[],t=[];let s=0;return new Promise(r=>{const a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++s===this.numFrames&&(clearInterval(a),r({freqDataQueue:e,timeDataQueue:t}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){const t=e[0].length,s=new Float32Array(e.length*t);return e.forEach((r,a)=>s.set(r,a*t)),s}getTensorFromAudioDataArray(e,t){const s=new Float32Array(Ot(t));return s.set(e,s.length-e.length),Tf(s,t)}}class D9 extends Ul{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=fc([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,a=(1-s)/2,o=(1-r)/2,l=a+s,c=r+o;this.cropBox=s1([o,a,c,l],[1,4])}else this.cropBox=s1([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,t={}){if(!bt().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!t.resizeWidth||!t.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=t.resizeWidth,e.height=t.resizeHeight}const s=new D9(e,t);return await s.start(),s}async start(){this.webcamConfig.facingMode&&we(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=Qie(this.webcamVideoElement)}catch(t){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(t)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(t){throw new Error(`Error thrown cropping the video: ${t.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return wt(()=>{const t=lc(Cn(e,"float32"),0);let s;s=ch.cropAndResize(t,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return nt(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}class ple{}class mle extends Ul{split(e){return new n6e(this,e)}}class n6e extends mle{constructor(e,t){super(),this.upstream=e,this.impl=new s6e(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class s6e extends L9{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(const s of t.slice(0,-1))this.outputQueue.push(s);return this.carryover=t[t.length-1],!0}}class r6e extends Ul{decodeUTF8(){return new i6e(this)}}class i6e extends mle{constructor(e){super(),this.upstream=e,this.impl=new a6e(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class a6e extends L9{constructor(e){if(super(),this.upstream=e,bt().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=require("string_decoder");this.decoder=new t("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let t;if(e.done)return!1;t=e.value;let s;return bt().get("IS_BROWSER")?s=this.decoder.decode(t,{stream:!0}):s=this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(s),!0}}class gle extends r6e{constructor(e,t={}){super(),this.file=e,this.options=t,we(e instanceof Uint8Array||(bt().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((t,s)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,r)));else{const a=new FileReader;a.onload=l=>{let c=a.result;if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),!(c instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));t(c)},a.onabort=l=>s(new Error("Aborted")),a.onerror=l=>s(new Error(l.type));const o=this.file.slice(this.offset,r);a.readAsArrayBuffer(o)}this.offset=r}),done:!1}}}async function o6e(n,e={},t){let s,r;typeof n=="string"?s=n:(s=n.url,r=l6e(n));const a=await yre(s,r);if(a.ok){const o=new Uint8Array(await a.arrayBuffer());return new gle(o,e)}else throw new Error(a.statusText)}const l6e=n=>({method:n.method,headers:n.headers,body:n.body,mode:n.mode,credentials:n.credentials,cache:n.cache,redirect:n.redirect,referrer:n.referrer,integrity:n.integrity});function yle(n){return typeof n=="string"&&n.slice(0,7)==="file://"}class ble extends ple{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(yle(this.input)&&bt().get("IS_NODE")){const e=require("fs");this.input=e.readFileSync(this.input.slice(7))}return new gle(this.input,this.options)}}class wle extends ple{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return yle(this.url)?new ble(this.url,this.fileOptions).iterator():o6e(this.url,this.fileOptions)}}function c6e(n,e={}){return new hle(new wle(n),e)}function u6e(n){const e=A9(n);return wf(async()=>e)}function f6e(n){return wf(async()=>{const e=await n();return A9(()=>e.next())})}async function d6e(n,e){return D9.create(n,e)}async function h6e(n){return N9.create(n)}const vle="4.11.0";const p6e=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:hle,Dataset:Y_,FileDataSource:ble,TextLineDataset:dle,URLDataSource:wle,array:JRe,csv:c6e,func:u6e,generator:f6e,microphone:h6e,version_data:vle,webcam:d6e,zip:ZRe},Symbol.toStringTag,{value:"Module"}));function es(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&we(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}const m6e=wO;class aE extends j4{nextDataId(){return aE.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new YF(this,Xh())}write(e,t,s){this.firstUse&&(this.firstUse=!1,bt().get("IS_NODE")&&cd(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&wm(s[0])){const a=s.map(o=>Cm(o));r=this.write(a,e,t)}else r=this.write(s,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return Fg(r,a)}return ire(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>Og(r));return tr(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return tr(e.shape,e.dtype,t)}makeOutput(e,t,s){return Xh().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=oc();return e(),{kernelMs:oc()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){es([e],"where");const t=this.readSync(e.dataId);return m6e(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}aE.nextDataId=0;function _le(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const g6e=n=>{const{x:e}=n.inputs,t=n.backend;es(e,"abs");let s=new Float32Array(Ot(e.shape));const r=t.data.get(e.dataId).values;return s=_le(r),t.makeOutput(s,e.shape,e.dtype)},y6e={kernelName:ST,backendName:"cpu",kernelFunc:g6e};function Fo(n){return(e,t,s,r,a)=>{const o=Gs(e,t),l=o.length,c=gs(o),u=Ot(o),f=Bl(a,u),d=e.length,h=t.length,p=gs(e),g=gs(t),b=vb(e,o),v=vb(t,o);if(b.length+v.length===0)for(let w=0;w<f.length;++w)f[w]=n(s[w%s.length],r[w%r.length]);else for(let w=0;w<f.length;++w){const x=qb(w,l,c),S=x.slice(-d);b.forEach(E=>S[E]=0);const C=op(S,d,p),M=x.slice(-h);v.forEach(E=>M[E]=0);const k=op(M,h,g);f[w]=n(s[C],r[k])}return[f,o]}}function _f(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.makeTensorInfo(s.shape,"complex64"),c=t.data.get(l.dataId);return c.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",a),imag:t.makeTensorInfo(r.shape,"float32",o)},l}const b6e={kernelName:H4,backendName:"cpu",kernelFunc:_f};function VN(n,e,t="float32"){if(t==="complex64"){const r=VN(n,e,"float32"),a=VN(n,e,"float32");return _f({inputs:{real:r,imag:a},backend:n})}const s=hc(Ot(e),t);return n.makeTensorInfo(e,t,s)}function $m(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const w6e={kernelName:a_,backendName:"cpu",kernelFunc:$m};function kb(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.real,a=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,a)}const v6e={kernelName:MD,backendName:"cpu",kernelFunc:kb};function xle(n,e,t,s){if(s==="int32"){const r=Int32Array.from(n);return[e,"int32",r]}if(s==="bool"){const r=C1([0],t),[a,o]=Fo((l,c)=>l!==c?1:0)(e,[],n,r,"bool");return[o,"bool",a]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function b1(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return $m({inputs:{x:r},backend:t});const f=VN(t,r.shape,r.dtype),d=b1({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),h=_f({inputs:{real:d,imag:f},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const f=kb({inputs:{input:r},backend:t}),d=b1({inputs:{x:f},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(f),d}if(!QF(r.dtype,a)){const f=$m({inputs:{x:r},backend:t});return{dataId:f.dataId,shape:f.shape,dtype:a}}const o=t.data.get(r.dataId).values,[l,c,u]=xle(o,r.shape,r.dtype,a);return t.makeTensorInfo(l,c,u)}const _6e={kernelName:q2,backendName:"cpu",kernelFunc:b1};function Sl(n,e,t,s){return t==null?({inputs:r,backend:a})=>{const{a:o,b:l}=r,c=a;es([o,l],n);const u=c.data.get(o.dataId).values,f=c.data.get(l.dataId).values,d=o.dtype==="string"?zg(u):u,h=o.dtype==="string"?zg(f):f,p=s||o.dtype,[g,b]=e(o.shape,l.shape,d,h,p);return c.makeTensorInfo(b,p,g)}:({inputs:r,backend:a})=>{const{a:o,b:l}=r,c=a;if(o.dtype==="complex64"||l.dtype==="complex64"){const u=b1({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),f=c.data.get(u.dataId),d=f.complexTensorInfos.real,h=f.complexTensorInfos.imag,p=c.data.get(d.dataId).values,g=c.data.get(h.dataId).values,b=b1({inputs:{x:l},backend:c,attrs:{dtype:"complex64"}}),v=c.data.get(b.dataId),w=v.complexTensorInfos.real,x=v.complexTensorInfos.imag,S=c.data.get(w.dataId).values,C=c.data.get(x.dataId).values,[M,k,E]=t(o.shape,l.shape,p,g,S,C),I=c.makeTensorInfo(E,"float32",M),A=c.makeTensorInfo(E,"float32",k),D=_f({inputs:{real:I,imag:A},backend:c});return c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(b),c.disposeIntermediateTensorInfo(I),c.disposeIntermediateTensorInfo(A),D}else{const u=c.data.get(o.dataId).values,f=c.data.get(l.dataId).values,d=s||o.dtype,[h,p]=e(o.shape,l.shape,u,f,d);return c.makeTensorInfo(p,d,h)}}}function O9(n){return(e,t,s,r,a,o)=>{const l=Gs(e,t),c=Ot(l),u=l.length,f=gs(l),d=Bl("float32",c),h=Bl("float32",c),p=vb(e,l),g=vb(t,l),b=Fg(s,r),v=Fg(a,o),w=e.length,x=gs(e),S=t.length,C=gs(t);if(p.length+g.length===0)for(let M=0;M<d.length;M++){const k=M%b.length,E=M%v.length,I=n(b[k*2],b[k*2+1],v[E*2],v[E*2+1]);d[M]=I.real,h[M]=I.imag}else for(let M=0;M<d.length;M++){const k=qb(M,u,f),E=k.slice(-w);p.forEach(P=>E[P]=0);const I=op(E,w,x),A=k.slice(-S);g.forEach(P=>A[P]=0);const D=op(A,S,C),L=n(b[I*2],b[I*2+1],v[D*2],v[D*2+1]);d[M]=L.real,h[M]=L.imag}return[d,h,l]}}const Cle=Fo(((n,e)=>n+e)),x6e=O9(((n,e,t,s)=>({real:n+t,imag:e+s}))),y2=Sl(Yb,Cle,x6e),C6e={kernelName:Yb,backendName:"cpu",kernelFunc:y2};function P9(n,e,t,s,r){const a=Ot(s),o=hc(r,t);for(let l=0;l<n.length;l++){const c=n[l];if(c<0)throw new Error("Input x must be non-negative!");c>=r||(a>0?o[c]+=e[l]:o[c]+=1)}return o}function Sle(n,e,t,s=!1){const r=n.shape[0],a=n.shape[1],o=tr([r,t],e.dtype);for(let l=0;l<r;l++)for(let c=0;c<a;c++){const u=n.get(l,c);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(s?o.set(1,l,u):e.size>0?o.set(o.get(l,u)+e.get(l,c),l,u):o.set(o.get(l,u)+1,l,u))}return o}const Mle=Fo(((n,e)=>n&e)),S6e=Sl(NT,Mle),M6e={kernelName:NT,backendName:"cpu",kernelFunc:S6e};function zm(n){return(e,t,s)=>{const r=po(t,e.length);for(let a=0;a<e.length;++a)r[a]=n(e[a],s);return r}}function Fi(n,e,t){const s=zm(e);return L1(n,s,t)}function L1(n,e,t){return({inputs:s,attrs:r,backend:a})=>{const{x:o}=s;es(o,n);const l=a,c=l.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=zg(c)}else u=c;const f=t||o.dtype,d=e(u,f,r);return l.makeTensorInfo(o.shape,f,d)}}const Tle=zm(n=>Math.ceil(n)),T6e=L1(Y2,Tle),k6e={kernelName:Y2,backendName:"cpu",kernelFunc:T6e};function kle(n,e,t,s){const r=po(t,Ot(e));if(s&&t!=="string"){let a=0;n.forEach(o=>{const l=Ot(o.shape);r.set(o.vals,a),a+=l})}else{let a=0;n.forEach(o=>{const l=t==="string"?zg(o.vals):o.vals;let c=0;for(let u=0;u<o.shape[0];++u){const f=u*e[1]+a;for(let d=0;d<o.shape[1];++d)r[f+d]=l[c++]}a+=o.shape[1]})}return r}const Ele=Fo((n,e)=>n===e?1:0),Ile=Sl(BT,Ele,null,"bool"),E6e={kernelName:BT,backendName:"cpu",kernelFunc:Ile};const Ale=zm(n=>Math.exp(n)),Lle=L1(t_,Ale,"float32"),I6e={kernelName:t_,backendName:"cpu",kernelFunc:Lle};const Nle=zm(n=>Math.expm1(n)),A6e=L1(n_,Nle),L6e={kernelName:n_,backendName:"cpu",kernelFunc:A6e};const Dle=zm(n=>Math.floor(n)),N6e=L1(s_,Dle),D6e={kernelName:s_,backendName:"cpu",kernelFunc:N6e};const Ole=Fo((n,e)=>Math.floor(n/e)),O6e=Sl(r_,Ole,null,"int32"),P6e={kernelName:r_,backendName:"cpu",kernelFunc:O6e};function Ple(n,e,t,s,r,a,o,l,c){const u=tr([s,a],t);for(let f=0;f<s;f++){const d=[];let h=0;for(let p=0;p<r;p++){const g=n[f*r+p];h+=g*o[p],d.push(g)}if(h<0||h>=c/a)throw new Error(`Invalid indices: ${d} does not index into ${l}`);for(let p=0;p<a;p++)u.values[f*a+p]=e.get(...e.indexToLoc(h*a+p))}return u}function $le(n,e,t){const s=tr(t,n.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),l=o[0],c=o[2],u=e.locToIndex([l,c]);o[2]=e.values[u];const f=n.locToIndex(o);0<=f&&f<n.values.length&&(s.values[r]=n.values[f])}return s}const jle=Fo((n,e)=>n>e?1:0),$6e=Sl(GT,jle,null,"bool"),j6e={kernelName:GT,backendName:"cpu",kernelFunc:$6e};const Rle=Fo((n,e)=>n>=e?1:0),R6e=Sl(i_,Rle,null,"bool"),F6e={kernelName:i_,backendName:"cpu",kernelFunc:R6e};const Fle=Fo((n,e)=>n<e?1:0),z6e=Sl(qT,Fle,null,"bool"),B6e={kernelName:qT,backendName:"cpu",kernelFunc:z6e};const zle=Fo((n,e)=>n<=e?1:0),U6e=Sl(YT,zle,null,"bool"),V6e={kernelName:YT,backendName:"cpu",kernelFunc:U6e};function Ble(n,e,t){const s=(e-n)/(t-1),r=hc(t,"float32");r[0]=n;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}const Ule=zm(n=>Math.log(n)),W6e=L1(u_,Ule),G6e={kernelName:u_,backendName:"cpu",kernelFunc:W6e};function Vle(n,e,t,s){const r=Bl(s,Ot(t));for(let a=0;a<r.length;++a){const o=a*e;let l=n[o];for(let c=0;c<e;++c){const u=n[o+c];(Number.isNaN(u)||u>l)&&(l=u)}r[a]=l}return r}const Wle=Fo(((n,e)=>Math.max(n,e))),H6e=Sl(d_,Wle),q6e={kernelName:d_,backendName:"cpu",kernelFunc:H6e};const Gle=Fo(((n,e)=>Math.min(n,e))),Y6e=Sl(h_,Gle),K6e={kernelName:h_,backendName:"cpu",kernelFunc:Y6e};const $9=Fo(((n,e)=>n*e)),X6e=O9(((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t}))),tP=Sl(m_,$9,X6e),Q6e={kernelName:m_,backendName:"cpu",kernelFunc:tP};function Hle(n,e,t){const s=Wg(-1,t);return $9([],e,s,n,t)}function J6e(n){const{inputs:e,backend:t}=n,{x:s}=e;es(s,"neg");const r=t.data.get(s.dataId).values,[a,o]=Hle(r,s.shape,s.dtype);return t.makeTensorInfo(o,s.dtype,a)}const Z6e={kernelName:ik,backendName:"cpu",kernelFunc:J6e};const qle=Fo(((n,e)=>n!==e?1:0)),eFe=Sl(ak,qle,null,"bool"),tFe={kernelName:ak,backendName:"cpu",kernelFunc:eFe};function j9(n,e,t,s,r){const a=e.length,o=Ot(e),l=gs(e),c=gs(r),u=Bl(t,Ot(r));for(let f=0;f<o;++f){const d=qb(f,a,l),h=new Array(d.length);for(let g=0;g<h.length;g++)h[g]=d[s[g]];const p=op(h,a,c);u[p]=n[f]}return u}function Qu(n){const{inputs:e,attrs:t,backend:s}=n,{x:r}=e,{perm:a}=t;es(r,"transpose");const o=r.shape.length,l=new Array(o);for(let d=0;d<l.length;d++)l[d]=r.shape[a[d]];const c=s.data.get(r.dataId).values,u=j9(c,r.shape,r.dtype,a,l);return{dataId:s.write(u,l,r.dtype),shape:l,dtype:r.dtype}}const nFe={kernelName:nb,backendName:"cpu",kernelFunc:Qu};function Yle(n,e,t,s){const[r,a]=Wl(n,s),o=Hu(e,"int32"),l=hc(Ot(r),o),c=Ot(a);for(let u=0;u<l.length;++u){const f=u*c;let d=1;for(let h=0;h<c;++h)d*=t[f+h];l[u]=d}return{outVals:l,outShape:r,outDtype:o}}function sFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s;es(r,"prod");const l=r.shape.length,c=dr(a,r.shape),u=no(c,l);let f=c,d=r;const h=[];u!=null&&(d=Qu({inputs:{x:r},backend:t,attrs:{perm:u}}),h.push(d),f=jo(f.length,l));const p=t.data.get(d.dataId).values,{outVals:g,outShape:b,outDtype:v}=Yle(d.shape,d.dtype,p,f);let w=b;return o&&(w=$o(b,c)),h.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.makeTensorInfo(w,v,g)}const rFe={kernelName:dk,backendName:"cpu",kernelFunc:sFe};function iFe(n,e,t){n.forEach((s,r)=>{if(s<0||s>=t){const a=qb(r,e.length,gs(e)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${t})`)}})}function aFe(n,e){for(let t=0;t<n.length;++t){const s=n[t],r=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function oFe(n,e,t,s){const r=[];let a=0;const o=e.length-1+t.length,l=new Array(o).fill(null).map(()=>[0]);aFe(t,s);let c=1;for(let u=0;u<e.length-1;++u){c*=e[u];const f=e[u+1];for(let d=1;d<c+1;++d)l[u].push(d*f)}for(let u=0;u<n.length;++u){let f=n[u],d=n[u]+1;for(let h=0;h<t.length;++h){const p=t[h],g=h+e.length-1;if(g>=0){const b=l[g],v=b[b.length-1]-p[f];for(let w=f;w<d;++w)l[g].push(p[w+1]+v)}f=p[f],d=p[d]}d!==f&&(r.push([f,d]),a+=d-f)}return{outSplits:l,valueSlices:r,numValues:a}}function lFe(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,r=po("int32",s);e.push(r),n[t].forEach((a,o)=>r[o]=a)}return e}function sq(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function cFe(n,e,t,s,r,a){const o=sq(e,2)[1],l=sq(a,2)[1];let c=0;for(const u of t)for(let f=u[0];f<u[1];++f){for(let d=0;d<s;++d)r[c*l+d]=n[f*o+d];++c}}function uFe(n,e,t,s,r){const a=e.slice();a[0]=r;const o=po(t,Ot(a)),l=n.length,c=l===0?0:l/e[0];return cFe(n,e,s,c,o,a),[o,a]}function Kle(n,e,t,s,r,a,o,l){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const c=e[0][0]-1;if(iFe(a,o,c),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:f,valueSlices:d,numValues:h}=oFe(a,o,n,u),p=lFe(f),g=uFe(t,s,r,d,h);return[p,g[0],g[1]]}const rq=2147483647;function Xle(n,e,t,s,r,a,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const l=e.length===0,c=r.length===0,u=o.length===0,f=[];l||f.push(e[0]),c||f.push(r[0]),u||f.push(o[0]);for(let v=1;v<f.length;++v)if(f[v]!==f[v-1])throw new Error("starts, limits, and deltas must have the same shape");const d=f.length===0?1:f[0],h=po("int32",d+1);h[0]=0;for(let v=0;v<d;++v){const w=l?n[0]:n[v],x=c?s[0]:s[v],S=u?a[0]:a[v];if(S===0)throw new Error("Requires delta != 0");let C;if(S>0&&x<w||S<0&&x>w)C=0;else if(C=Math.ceil(Math.abs((x-w)/S)),C>rq)throw new Error(`Requires ((limit - start) / delta) <= ${rq}`);h[v+1]=h[v]+C}const p=h[d],g=po(t,p);let b=0;for(let v=0;v<d;++v){const w=h[v+1]-h[v];let x=l?n[0]:n[v];const S=u?a[0]:a[v];for(let C=0;C<w;++C)g[b++]=x,x+=S}return[h,g]}var Xd=Zh;class WN{constructor(e,t,s,r,a,o,l,c,u,f){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=l,this.rowPartitionValues=c,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=uae(f),this.raggedRank=fae(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Xd.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Xd.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Xd.VALUE_ROWIDS:return WN.getMaxWidthValueRowID(t);case Xd.ROW_SPLITS:return WN.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Xd[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let r=0;r<t-1;++r){const a=e[r+1]-e[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,r=e[0],a=0;for(let o=1;o<t;++o){const l=e[o];l!==r&&(r=l,a=Math.max(o-s,a),s=o)}return Math.max(t-s,a)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return aq(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;dae(s,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=cae(this.raggedRank,r,t);o[0]<0&&(o[0]=e);for(let l=1;l<=this.raggedRank;++l)o[l]<0&&(o[l]=this.getMaxWidth(l));return o}calculateFirstParentOutputIndex(e,t,s){const r=Math.min(e,s),a=[];let o=0;for(let l=0;l<r;++l,o+=t)a.push(o);for(let l=r;l<e;++l)a.push(-1);return we(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,s,r){const a=e.length,o=[];for(let l=0;l<a-1;++l){const c=e[l+1]-e[l];let u=Math.min(r,c),f=t[l];f===-1&&(u=0);for(let d=0;d<u;++d)o.push(f),f+=s;for(let d=0;d<c-u;++d)o.push(-1)}if(a>0&&o.length!==e[a-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,s,r){const a=e.length,o=[];if(a===0)return[];let l=0,c=e[0];if(c>=t.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${t.length}`);let u=t[c];o.push(u);for(let f=1;f<a;++f){const d=e[f];if(d===c)u>=0&&(++l,l<r?u+=s:u=-1);else{if(l=0,c=d,d>=t.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${t.length}`);u=t[d]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,s,r){const a=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Xd.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,s,r);case Xd.ROW_SPLITS:if(a.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,s,r);default:throw new Error(`Unsupported partition type: ${Xd[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Xd.FIRST_DIM_SIZE:return e[0];case Xd.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Xd.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Xd[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let c=r.length-2;c>=0;--c)r[c]=r[c+1]*s[c+1];const a=aq(s,!1),o=po(this.valuesDType,Ot(a));if(r[0]*s[0]>0){let c=this.calculateFirstParentOutputIndex(t,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)c=this.calculateOutputIndex(u-1,c,r[u],s[u]);this.setOutput(this.raggedRank,c,o,a)}return[a,o]}setOutput(e,t,s,r){if(s.length===0)return;const a=this.values,o=s;let l=r.slice();l=l.slice(e+1);const c=Ot(l),u=t.length;let f=this.defaultValue;if(f.length!==c&&f.length!==1){const g=this.defaultValueShape;wt(()=>{const b=nt(f,g);f=sb(b,l).dataSync()})}let d=0,h=0,p=0;for(let g=0;g<=u;++g){let b=g<u?t[g]:-1;if(b===p){++p;continue}if(h<p){const v=a.subarray(d*c),w=o.subarray(h*c),x=(p-h)*c;iq(w,v,x)}if(g>=u){const v=s.length;b=Math.floor(v/c)}if(b>p)if(this.defaultValue.length===1)o.subarray(p*c,b*c).fill(this.defaultValue[0]),p=b;else for(;b>p;){const v=o.slice(p*c);iq(v,f,c),++p}b<0?(d=g+1,h=p):(d=g,h=p,p=h+1)}}}function iq(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function aq(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function Qle(n,e,t,s,r,a,o,l,c,u){return new WN(n,e,t,s,r,a,o,l,c,u).compute()}function Jle(n,e,t,s){const r=n===e,a=n<e&&t<0,o=e<n&&t>1;if(r||a||o)return hc(0,s);const l=Math.abs(Math.ceil((e-n)/t)),c=hc(l,s);e<n&&t===1&&(t=-1),c[0]=n;for(let u=1;u<c.length;u++)c[u]=c[u-1]+t;return c}const Zle=zm(n=>1/Math.sqrt(n)),fFe=L1(__,Zle),dFe={kernelName:__,backendName:"cpu",kernelFunc:fFe};function qy(n,e,t,s,r,a,o,l,c,u){const f=[s/r,r],d=n.values,h=e.values;if(s===0)return tr(t,e.dtype);const p=c instanceof el?c:tr(f,e.dtype);typeof c=="string"||typeof c=="number"?p.values.fill(c):typeof c=="boolean"&&p.values.fill(+c);for(let g=0;g<a;g++){const b=[];let v=0;for(let w=0;w<o;w++){const x=d[g*o+w];b.push(x),v+=x*l[w]}if(v<0||v>=s/r)throw new Error(`Invalid indices: ${b} does not index into ${t}`);for(let w=0;w<r;w++)u?p.values[v*r+w]+=h[g*r+w]:p.values[v*r+w]=e.rank===0?h[0]:h[g*r+w]}return p}const hFe=zm(n=>1/(1+Math.exp(-n))),ece=Fi(T_,n=>1/(1+Math.exp(-n))),pFe={kernelName:T_,backendName:"cpu",kernelFunc:ece};function tce(n,e,t,s,r){const a=EB(s,e,t),o=Ot(t),l=gs(s);if(a){const d=IB(e,l);return r==="string"?n.slice(d,d+o):n.subarray(d,d+o)}const c=r==="string"?zg(n):n,u=tr(s,r,c),f=tr(t,r);for(let d=0;d<f.size;++d){const h=f.indexToLoc(d),p=h.map((g,b)=>g+e[b]);f.set(u.get(...p),...h)}return r==="string"?Nae(f.values):f.values}function Eb(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,size:o}=s;es(r,"slice");const[l,c]=AO(r,a,o);TB(r,l,c);const u=t.data.get(r.dataId).values,f=tce(u,l,c,r.shape,r.dtype);return t.makeTensorInfo(c,r.dtype,f)}const mFe={kernelName:bk,backendName:"cpu",kernelFunc:Eb};function nce(n,e,t,s,r,a,o){const l=e[0],c=a[0],u=new Array(c),f=new Array(l),d=e[1];if(c===0){if(l!==0)throw new Error(wae(l));const v=po(t,0),w=po(r,0);return[v,[0,d],w,u,f]}let h=!0,p=0;const g=new Array(c).fill(0);for(let v=0;v<l;++v){const w=n[v*d];if(w<0)throw new Error(vae(v,w));if(w>=c)throw new Error(_ae(v,w,c));++g[w],h=h&&w>=p,p=w}let b=!0;for(let v=0;v<c;++v){const w=g[v]===0;u[v]=w,b=b&&!w,g[v]=Math.max(g[v],1),v>0&&(g[v]+=g[v-1])}if(b&&h){const v=n,w=s;for(let x=0;x<l;++x)f[x]=x;return[v,[l,d],w,u,f]}else{const v=g[c-1],w=po(t,v*d),x=po(r,v),S=new Array(c).fill(0);for(let C=0;C<l;++C){const M=n[C*d],k=S[M],E=(M===0?0:g[M-1])+k;S[M]++;for(let I=0;I<d;++I)w[E*d+I]=n[C*d+I];x[E]=s[C],f[C]=E}for(let C=0;C<c;++C)if(S[C]===0){const k=C===0?0:g[C-1];w[k*d+0]=C;for(let E=1;E<d;++E)w[k*d+E]=0;x[k]=o}return[w,[v,d],x,u,f]}}function sce(n,e,t,s,r){const a=Ot(s),o=e[0],l=r.length,c=[];let u=1,f=-1;for(let v=0;v<l;++v){const w=r[v];if(w===-1){if(f!==-1)throw new Error(xae(f,v));f=v,c.push(1)}else{if(w<0)throw new Error(Cae(v,w));u*=w,c.push(w)}}if(f!==-1){if(u<=0)throw new Error(Sae());const v=Math.trunc(a/u);if(u*v!==a)throw new Error(Mae(s,c));c[f]=v}if(Ot(c)!==a)throw new Error(Tae(s,c));const h=s.length,p=[];if(h>0){p[h-1]=1;for(let v=h-2;v>=0;--v)p[v]=p[v+1]*s[v+1]}const g=[];if(l>0){g[l-1]=1;for(let v=l-2;v>=0;--v)g[v]=g[v+1]*c[v+1]}const b=po(t,o*l);for(let v=0;v<o;++v){let w=0;for(let x=0;x<h;++x)w+=n[v*h+x]*p[x];for(let x=0;x<l;++x)b[v*l+x]=Math.trunc(w/g[x]),w%=g[x]}return[b,[o,l],c]}function R9(n,e,t,s,r,a=!1,o=0){const l=s.length,c=[e[0],n.length/e[0]],u=c[1],d=l>0?r[l-1]+1:0;if(d<0)throw new Error(jR());const h=e.slice();h[0]=d;const p=h.reduce((S,C)=>S*C,1),g=po(t,p);if(l===0)return d>0&&g.fill(o),[g,h];if(d<=0)throw new Error(jR());let b=0,v=1,w=0,x=r[b];for(;;){let S=0;if(v<l){if(S=r[v],x===S){++v;continue}if(x>=S)throw new Error(kae())}if(x<0||x>=d)throw new Error(Eae(x,d));x>w&&g.fill(o,w*u,x*u);for(let C=b;C<v;++C){const M=s[C];if(M<0||M>=c[0])throw new Error(Iae(C,s[C],c[0]));for(let k=0;k<u;k++)g[x*u+k]+=n[M*u+k]}if(a)for(let C=0;C<u;C++)g[x*u+C]/=v-b;if(b=v,++v,w=x+1,x=S,v>l)break}return w<d&&g.fill(o,w*u,d*u),[g,h]}const gFe=zm(n=>Math.sqrt(n)),yFe=Fi(E_,n=>Math.sqrt(n)),bFe={kernelName:E_,backendName:"cpu",kernelFunc:yFe};const rce=Fo(((n,e)=>{const t=n-e;return t*t})),wFe=Sl(I_,rce),vFe={kernelName:I_,backendName:"cpu",kernelFunc:wFe};const ice=zm((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:r}=e;return n.replace(new RegExp(t,s?"g":""),r)}),_Fe=L1(Ck,ice),xFe={kernelName:Ck,backendName:"cpu",kernelFunc:_Fe};function ace(n,e,t,s){const r=tr(n,e.dtype);for(let a=0;a<r.size;a++){const o=r.indexToLoc(a),l=new Array(o.length);for(let c=0;c<l.length;c++)l[c]=o[c]*t[c]+s[c];r.set(e.get(...l),...o)}return r}class CFe{constructor(e,t,s,r,a,o){this.separator=Cm(e),this.nGramWidths=t,this.leftPad=Cm(s),this.rightPad=Cm(r),this.padWidth=a,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,r,a,o){for(let l=0;l<a;++l){const c=this.getPadWidth(o),u=Math.max(0,c-l),f=Math.max(0,c-(a-(l+1))),d=o-(u+f),h=t+(u>0?0:l-c);let p=0;p+=u*this.leftPad.length;for(let x=0;x<d;++x)p+=e[h+x].length;p+=f*this.rightPad.length;const g=u+f+d-1;p+=g*this.separator.length,s[r+l]=new Uint8Array(p);const b=s[r+l];let v=0;const w=x=>x.forEach(S=>b[v++]=S);for(let x=0;x<u;++x)w(this.leftPad),w(this.separator);for(let x=0;x<d-1;++x)w(e[h+x]),w(this.separator);if(d>0){w(e[h+d-1]);for(let x=0;x<f;++x)w(this.separator),w(this.rightPad)}else{for(let x=0;x<f-1;++x)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,t){const s=e.length,r=t.length;if(r>0){let c=t[0];if(c!==0)throw new Error(`First split value must be 0, got ${c}`);for(let u=1;u<r;++u){let f=t[u]>=c;if(f=f&&t[u]<=s,!f)throw new Error(`Invalid split value ${t[u]}, must be in [${c}, ${s}]`);c=t[u]}if(c!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${c}`)}const a=r-1,o=po("int32",r);if(s===0||r===0){const c=new Array(s);for(let u=0;u<=a;++u)o[u]=0;return[c,o]}o[0]=0;for(let c=1;c<=a;++c){const u=t[c]-t[c-1];let f=0;this.nGramWidths.forEach(d=>{f+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&f===0&&(f=1),o[c]=o[c-1]+f}const l=new Array(o[a]);for(let c=0;c<a;++c){const u=t[c];let f=o[c];if(this.nGramWidths.forEach(d=>{const h=t[c+1]-t[c],p=this.getNumNGrams(h,d);this.createNGrams(e,u,l,f,p,d),f+=p}),this.preserveShort&&f===o[c]){const d=t[c+1]-t[c];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,u,l,f,1,h)}}return[l,o]}}function oce(n,e,t,s,r,a,o,l){return new CFe(t,s,r,a,o,l).compute(n,e)}function SFe(n,e,t,s){if(!n.length)return;if(e.length===0){for(let a=0;a<n.length;++a)s.push(n.subarray(a,a+1));return}if(e.length===1){const a=e[0];let o=n.indexOf(a);for(;o!==-1;){const l=n.subarray(0,o);(!t||l.length!==0)&&s.push(l),n=n.subarray(o+1),o=n.indexOf(a)}(!t||n.length!==0)&&s.push(n);return}let r=0;for(let a=0;a<n.length+1;a++)if(a===n.length||e.indexOf(n[a])!==-1){const o=n.subarray(r,a);(!t||o.length!==0)&&s.push(o),r=a+1}}function lce(n,e,t){const s=n.length,r=[];let a=0,o=0;const l=new Array(s);for(let h=0;h<s;++h){const p=r.length;SFe(n[h],e,t,r);const g=r.length-p;l[h]=g,a+=g,o=Math.max(o,g)}const c=po("int32",a*2),u=new Array(a),f=[s,o];let d=0;for(let h=0;h<s;++h)for(let p=0;p<l[h];++p)c[d*2]=h,c[d*2+1]=p,u[d]=r[d],++d;return[c,u,f]}function cce(n,e){const t=po("int32",n.length);for(let s=0;s<n.length;++s)t[s]=gre(n[s]).modulo(e).getLowBitsUnsigned();return t}const uce=Fo(((n,e)=>n-e)),MFe=O9(((n,e,t,s)=>({real:n-t,imag:e-s}))),F9=Sl(A_,uce,MFe),TFe={kernelName:A_,backendName:"cpu",kernelFunc:F9};function fce(n,e){const t=new Array(n.rank);for(let r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];const s=tr(t,n.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),o=new Array(n.rank);for(let c=0;c<o.length;c++)o[c]=a[c]%n.shape[c];const l=n.locToIndex(o);s.values[r]=n.values[l]}return s}const US=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function dce(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const l=s-t+1,c=e-t+1,u=Math.log(l),f=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*f*(l-f)/l)*Math.sign(c-l/2),h=Math.max(t,Math.floor(e-c*f/l+d)),p=Math.min(s,Math.floor(e+(l-c)*f/l+d));dce(n,e,h,p)}const r=n[e];let a=t,o=s;for(Sg(n,t,e),US(n[s],r)>0&&Sg(n,t,s);a<o;){for(Sg(n,a,o),a++,o--;US(n[a],r)<0;)a=a+1;for(;US(n[o],r)>0;)o=o-1}US(n[t],r)===0?Sg(n,t,o):(o=o+1,Sg(n,o,s)),o<=e&&(t=o+1),e<=o&&(s=o-1)}}function hce(n,e,t,s,r){const a=e[e.length-1],[o,l]=[n.length/a,a],c=Bl(t,o*s),u=Bl("int32",o*s);for(let d=0;d<o;d++){const h=d*l,p=n.subarray(h,h+l);let g=new Array(p.length);p.forEach((x,S)=>g[S]={value:x,index:S}),s<g.length&&(dce(g,s),g=g.slice(0,s)),r&&g.sort(US);const b=d*s,v=c.subarray(b,b+s),w=u.subarray(b,b+s);for(let x=0;x<s;x++)v[x]=g[x].value,w[x]=g[x].index}const f=e.slice();return f[f.length-1]=s,[tr(f,t,c),tr(f,"int32",u)]}function pce(n,e,t,s){const r=dr(e,t)[0],a=[1,t[0],1];for(let g=0;g<r;g++)a[0]*=t[g];a[1]=t[r];for(let g=r+1;g<t.length;g++)a[2]*=t[g];const o=new Map,l=new Int32Array(t[r]),c=new el(a,s,n),u=[],f=a[0]===1&&a[2]===1;for(let g=0;g<t[r];g++){let b;if(f)b=n[g].toString();else{const w=[];for(let x=0;x<a[0];x++)for(let S=0;S<a[2];S++)w.push(c.get(x,g,S));b=w.join(",")}const v=o.get(b);if(v!=null)l[g]=v;else{const w=o.size;o.set(b,w),l[g]=w,u.push(g)}}const d=a.slice();d[1]=o.size;const h=new el(d,s);u.forEach((g,b)=>{for(let v=0;v<a[0];v++)for(let w=0;w<a[2];w++)h.set(c.get(v,g,w),v,b,w)});const p=t.slice();return p[r]=d[1],{outputValues:h.values,outputShape:p,indices:l}}const mce=Object.freeze(Object.defineProperty({__proto__:null,addImpl:Cle,bincountImpl:P9,bincountReduceImpl:Sle,bitwiseAndImpl:Mle,castImpl:xle,ceilImpl:Tle,concatImpl:kle,equalImpl:Ele,expImpl:Ale,expm1Impl:Nle,floorDivImpl:Ole,floorImpl:Dle,gatherNdImpl:Ple,gatherV2Impl:$le,greaterEqualImpl:Rle,greaterImpl:jle,lessEqualImpl:zle,lessImpl:Fle,linSpaceImpl:Ble,logImpl:Ule,maxImpl:Vle,maximumImpl:Wle,minimumImpl:Gle,multiplyImpl:$9,negImpl:Hle,notEqualImpl:qle,prodImpl:Yle,raggedGatherImpl:Kle,raggedRangeImpl:Xle,raggedTensorToTensorImpl:Qle,rangeImpl:Jle,rsqrtImpl:Zle,scatterImpl:qy,sigmoidImpl:hFe,simpleAbsImpl:_le,sliceImpl:tce,sparseFillEmptyRowsImpl:nce,sparseReshapeImpl:sce,sparseSegmentReductionImpl:R9,sqrtImpl:gFe,squaredDifferenceImpl:rce,staticRegexReplaceImpl:ice,stridedSliceImpl:ace,stringNGramsImpl:oce,stringSplitImpl:lce,stringToHashBucketFastImpl:cce,subImpl:uce,tileImpl:fce,topKImpl:hce,transposeImpl:j9,uniqueImpl:pce},Symbol.toStringTag,{value:"Module"}));const gce="4.11.0";fz("cpu",()=>new aE,1);const yce=Fi(Z2,n=>n>=0?n:Math.exp(n)-1),kFe={kernelName:Z2,backendName:"cpu",kernelFunc:yce};function bce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:a}=s;es([r],"leakyRelu");const o=Ot(r.shape),l=t.data.get(r.dataId).values,c=Bl("float32",o);for(let u=0;u<l.length;u++)c[u]=l[u]<0?a*l[u]:l[u];return t.makeTensorInfo(r.shape,"float32",c)}const EFe={kernelName:HT,backendName:"cpu",kernelFunc:bce};const IFe=Fo((n,e)=>n<0?e*n:n);function wce(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e;es([s,r],"prelu");const a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,[l,c]=IFe(s.shape,r.shape,a,o,"float32");return t.makeTensorInfo(c,"float32",l)}const AFe={kernelName:fk,backendName:"cpu",kernelFunc:wce};const vce=Fi(b_,n=>Math.max(0,n)),LFe={kernelName:b_,backendName:"cpu",kernelFunc:vce};const _ce=Fi(w_,n=>Math.min(Math.max(0,n),6)),NFe={kernelName:w_,backendName:"cpu",kernelFunc:_ce};function GN(n,e,t,s,r){if(t==="linear")return $m({inputs:{x:e},backend:n});if(t==="relu")return vce({inputs:{x:e},backend:n});if(t==="elu")return yce({inputs:{x:e},backend:n});if(t==="relu6")return _ce({inputs:{x:e},backend:n});if(t==="prelu")return wce({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return bce({inputs:{x:e},backend:n,attrs:{alpha:r}});if(t==="sigmoid")return ece({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}function ba(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:a}=s,o=Ot(r.shape),l=XF(a,o),c=Ot(l);we(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),t.incRef(r.dataId);const u=t.data.get(r.dataId);if(u.complexTensorInfos!=null){const f=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;f.shape=l,d.shape=l}return{dataId:r.dataId,shape:l,dtype:r.dtype}}const DFe={kernelName:hk,backendName:"cpu",kernelFunc:ba};function xce(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a}=e,{transposeA:o,transposeB:l}=s;es([r,a],"matMul");const c=r.shape.length,u=a.shape.length,f=o?r.shape[c-2]:r.shape[c-1],d=l?a.shape[u-1]:a.shape[u-2],h=o?r.shape[c-1]:r.shape[c-2],p=l?a.shape[u-2]:a.shape[u-1],g=r.shape.slice(0,-2),b=a.shape.slice(0,-2),v=Ot(g),w=Ot(b),S=Gs(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([h,p]);we(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${o} and transposeB=${l} must match.`);const C=o?[v,f,h]:[v,h,f],M=l?[w,p,d]:[w,d,p],k=ba({inputs:{x:r},backend:t,attrs:{shape:C}}),E=ba({inputs:{x:a},backend:t,attrs:{shape:M}}),I=o?k.shape[1]:k.shape[2],A=o?k.shape[2]:k.shape[1],D=l?E.shape[1]:E.shape[2],L=Math.max(v,w),P=t.data.get(k.dataId).values,j=t.data.get(E.dataId).values,G=gs(k.shape),Q=gs(E.shape),[q,te,Z]=o?[G[0],1,G[1]]:[G[0],G[1],1],[ne,le,H]=l?[1,Q[1],Q[0]]:[Q[1],1,Q[0]],R=A*D,B=tr([L,A,D],k.dtype),W=B.values,se=t.blockSize;for(let ue=0;ue<L;ue++){const ge=ue%v,Ce=ue%w;for(let Se=0;Se<A;Se+=se){const Me=Math.min(Se+se,A);for(let pe=0;pe<D;pe+=se){const fe=Math.min(pe+se,D);for(let $e=0;$e<I;$e+=se){const We=Math.min($e+se,I);for(let de=Se;de<Me;de++)for(let Be=pe;Be<fe;Be++){let st=0;for(let He=$e;He<We;He++){const Xe=P[ge*q+de*te+He*Z],Ke=j[He*ne+Be*le+Ce*H];st+=Xe*Ke}W[ue*R+(de*D+Be)]+=st}}}}}return t.disposeIntermediateTensorInfo(k),t.disposeIntermediateTensorInfo(E),t.makeTensorInfo(S,B.dtype,B.values)}const OFe={kernelName:AT,backendName:"cpu",kernelFunc:xce};function PFe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a,bias:o,preluActivationWeights:l}=e,{transposeA:c,transposeB:u,activation:f,leakyreluAlpha:d}=s;let h,p,g;const b=[];h=xce({inputs:{a:r,b:a},attrs:{transposeA:c,transposeB:u},backend:t}),o&&(p=y2({inputs:{a:h,b:o},backend:t}),b.push(h),h=p),f&&(g=GN(t,h,f,l,d),b.push(h),h=g);for(const w of b)t.disposeIntermediateTensorInfo(w);return h}const $Fe={kernelName:AM,backendName:"cpu",kernelFunc:PFe};const jFe=Fi(z2,n=>Math.acos(n)),RFe={kernelName:z2,backendName:"cpu",kernelFunc:jFe};const FFe=Fi(B2,n=>Math.acosh(n)),zFe={kernelName:B2,backendName:"cpu",kernelFunc:FFe};function BFe(n){const{inputs:e,backend:t}=n,s=e;es(e,"addN");const r=s.map(l=>t.data.get(l.dataId).values),a=tr(s[0].shape,s[0].dtype),o=a.values;for(let l=0;l<s.length;l++){const c=r[l];for(let u=0;u<o.length;u++)o[u]+=c[u]}return t.makeTensorInfo(a.shape,a.dtype,a.values)}const UFe={kernelName:MT,backendName:"cpu",kernelFunc:BFe};function VFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s;es(r,"all");const l=dr(a,r.shape);let c=l;const u=no(c,r.shape.length);let f=r;u!=null&&(f=Qu({inputs:{x:r},backend:t,attrs:{perm:u}}),c=jo(c.length,r.shape.length)),yc("all",c,f.shape.length);const[d,h]=Wl(f.shape,c),p=Ot(h),g=hc(Ot(d),f.dtype),b=t.data.get(f.dataId).values;for(let w=0;w<g.length;++w){const x=w*p;let S=b[x];for(let C=0;C<p;++C){const M=b[x+C];S=S&&M}g[w]=S}u!=null&&t.disposeIntermediateTensorInfo(f);const v=t.makeTensorInfo(d,f.dtype,g);if(o){const w=$o(d,l),x=ba({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),x}return v}const WFe={kernelName:z4,backendName:"cpu",kernelFunc:VFe};function GFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s;es(r,"any");const l=dr(a,r.shape);let c=l;const u=no(c,r.shape.length);let f=r;u!=null&&(f=Qu({inputs:{x:r},backend:t,attrs:{perm:u}}),c=jo(c.length,r.shape.length)),yc("any",c,f.shape.length);const[d,h]=Wl(f.shape,c),p=Ot(h),g=hc(Ot(d),f.dtype),b=t.data.get(f.dataId).values;for(let w=0;w<g.length;++w){const x=w*p;let S=b[x];for(let C=0;C<p;++C){const M=b[x+C];S=S||M}g[w]=S}u!=null&&t.disposeIntermediateTensorInfo(f);const v=t.makeTensorInfo(d,f.dtype,g);if(o){const w=$o(d,l),x=ba({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),x}return v}const HFe={kernelName:B4,backendName:"cpu",kernelFunc:GFe};function qFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;es(r,"argMax");let o=dr(a,r.shape);const l=no(o,r.shape.length);let c=r;const u=[];l!=null&&(c=Qu({inputs:{x:r},backend:t,attrs:{perm:l}}),u.push(c),o=jo(o.length,c.shape.length)),o=[o[0]],yc("argMax",o,c.shape.length);const[f,d]=Wl(c.shape,o),h=Ot(f),p=hc(h,"int32"),g=Ot(d),b=t.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const w=v*g;let x=b[w],S=0;for(let C=0;C<g;++C){const M=b[w+C];M>x&&(x=M,S=C)}p[v]=S}return u.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(f,"int32",p)}const YFe={kernelName:TT,backendName:"cpu",kernelFunc:qFe};function KFe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;es(r,"argMin");let o=dr(a,r.shape);const l=no(o,r.shape.length);let c=r;const u=[];l!=null&&(c=Qu({inputs:{x:r},backend:t,attrs:{perm:l}}),u.push(c),o=jo(o.length,c.shape.length)),o=[o[0]],yc("argMin",o,c.shape.length);const[f,d]=Wl(c.shape,o),h=Ot(f),p=hc(h,"int32"),g=Ot(d),b=t.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const w=v*g;let x=b[w],S=0;for(let C=0;C<g;++C){const M=b[w+C];M<x&&(x=M,S=C)}p[v]=S}return u.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(f,"int32",p)}const XFe={kernelName:kT,backendName:"cpu",kernelFunc:KFe};const QFe=Fi(U2,n=>Math.asin(n)),JFe={kernelName:U2,backendName:"cpu",kernelFunc:QFe};const ZFe=Fi(V2,n=>Math.asinh(n)),eze={kernelName:V2,backendName:"cpu",kernelFunc:ZFe};const tze=Fi(W2,n=>Math.atan(n)),nze={kernelName:W2,backendName:"cpu",kernelFunc:tze};const sze=Fo((n,e)=>Math.atan2(n,e)),rze=Sl(H2,sze),ize={kernelName:H2,backendName:"cpu",kernelFunc:rze};const aze=Fi(G2,n=>Math.atanh(n)),oze={kernelName:G2,backendName:"cpu",kernelFunc:aze};function z9(n,e,t,s,r,a){const o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=tr(r.outShape,t),v=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],S=r.outShape[3];for(let C=0;C<r.batchSize;++C){const M=C*w,k=C*s[0];for(let E=0;E<r.inChannels;++E)for(let I=0;I<r.outHeight;++I){const A=I*o-h,D=Math.max(0,A),L=Math.min(r.inHeight,f+A),P=M+I*x;for(let j=0;j<r.outWidth;++j){const G=j*l-p,Q=Math.max(0,G),q=Math.min(r.inWidth,d+G);let te=g,Z=0,ne=0;for(let H=D;H<L;H+=c){const R=k+H*s[1];for(let B=Q;B<q;B+=u){const W=R+B*s[2],se=n[W+E];a==="max"&&se>te?te=se:a==="avg"&&(Z+=se,ne++)}if(isNaN(te))break}const le=P+j*S+E;v[le]=a==="avg"?Z/ne:te}}}return b}function Cce(n,e,t,s,r=!1,a=!1){const o=tr(s.outShape,"int32"),l=s.strideHeight,c=s.strideWidth,u=s.dilationHeight,f=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,p=s.padInfo.top,g=s.padInfo.left,b=tr(e,t,n);for(let v=0;v<s.batchSize;++v)for(let w=0;w<s.inChannels;++w)for(let x=0;x<s.outHeight;++x){const S=x*l-p;let C=S;for(;C<0;)C+=u;const M=Math.min(s.inHeight,d+S);for(let k=0;k<s.outWidth;++k){const E=k*c-g;let I=E;for(;I<0;)I+=f;const A=Math.min(s.inWidth,h+E);let D=Number.NEGATIVE_INFINITY,L=-1;for(let P=C;P<M;P+=u){const j=P-S;for(let G=I;G<A;G+=f){const Q=G-E,q=b.get(v,P,G,w);q>D&&(D=q,r?L=a?((v*s.inHeight+P)*s.inWidth+G)*s.inChannels+w:(P*s.inWidth+G)*s.inChannels+w:L=j*h+Q)}}o.set(L,v,x,k,w)}}return o}function Sce(n,e,t,s,r,a){const o=r.strideDepth,l=r.strideHeight,c=r.strideWidth,u=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,v=r.padInfo.top,w=r.padInfo.left,x=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,S=tr(r.outShape,t),C=S.values,M=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let A=0;A<r.batchSize;++A){const D=A*M,L=A*s[0];for(let P=0;P<r.inChannels;++P)for(let j=0;j<r.outDepth;++j){const G=j*o-b;let Q=G;for(;Q<0;)Q+=u;const q=Math.min(r.inDepth,h+G),te=D+j*k;for(let Z=0;Z<r.outHeight;++Z){const ne=Z*l-v;let le=ne;for(;le<0;)le+=f;const H=Math.min(r.inHeight,p+ne),R=te+Z*E;for(let B=0;B<r.outWidth;++B){const W=B*c-w;let se=W;for(;se<0;)se+=d;const ue=Math.min(r.inWidth,g+W),ge=R+B*I;let Ce=x,Se=0,Me=0;for(let fe=Q;fe<q;fe+=u){const $e=L+fe*s[1];for(let We=le;We<H;We+=f){const de=$e+We*s[2];for(let Be=se;Be<ue;Be+=d){const st=de+Be*s[3],He=n[st+P];if(a==="max"&&He>Ce?Ce=He:a==="avg"&&(Se+=He,Me++),isNaN(Ce))break}if(isNaN(Ce))break}if(isNaN(Ce))break}const pe=ge+P;C[pe]=a==="avg"?Se/Math.max(Me,1):Ce}}}}return S}function lze(n,e){const t=tr(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,g=e.padInfo.left;for(let b=0;b<e.batchSize;++b)for(let v=0;v<e.inChannels;++v)for(let w=0;w<e.outDepth;++w){const x=w*s-h;let S=x;for(;S<0;)S+=o;const C=Math.min(e.inDepth,u+x);for(let M=0;M<e.outHeight;++M){const k=M*r-p;let E=k;for(;E<0;)E+=l;const I=Math.min(e.inHeight,f+k);for(let A=0;A<e.outWidth;++A){const D=A*a-g;let L=D;for(;L<0;)L+=c;const P=Math.min(e.inWidth,d+D);let j=Number.NEGATIVE_INFINITY,G=-1;for(let Q=S;Q<C;Q+=o){const q=Q-x;for(let te=E;te<I;te+=l){const Z=te-k;for(let ne=L;ne<P;ne+=c){const le=ne-D,H=n.get(b,Q,te,ne,v);H>=j&&(j=H,G=q*f*d+Z*f+le)}}}t.set(G,b,w,M,A,v)}}}return t}function cze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;es(r,"avgPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;we(gc(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=vh(r.shape,a,o,u,l,c);let d;if(f.filterWidth===1&&f.filterHeight===1&&xr(f.inShape,f.outShape))d=$m({inputs:{x:r},backend:t});else{const h=t.data.get(r.dataId).values,p=gs(r.shape),g=z9(h,r.shape,r.dtype,p,f,"avg");d=t.makeTensorInfo(f.outShape,r.dtype,g.values)}return d}const uze={kernelName:ET,backendName:"cpu",kernelFunc:cze};function fze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=s;es(r,"avgPool3d");const f=Gg(r.shape,a,o,1,l,c,u),d=t.data.get(r.dataId).values,h=Sce(d,r.shape,r.dtype,gs(r.shape),f,"avg");return t.makeTensorInfo(h.shape,"float32",h.values)}const dze={kernelName:IT,backendName:"cpu",kernelFunc:fze};function hze(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=s;es([r,a],"avgPool3DGrad");const f=Gg(a.shape,o,l,1,c,u),d=f.strideDepth,h=f.strideHeight,p=f.strideWidth,g=f.filterDepth,b=f.filterHeight,v=f.filterWidth,w=f.dilationDepth,x=f.dilationHeight,S=f.dilationWidth,C=f.effectiveFilterDepth,M=f.effectiveFilterHeight,k=f.effectiveFilterWidth,E=C-1-f.padInfo.front,I=k-1-f.padInfo.left,A=M-1-f.padInfo.top,D=tr(a.shape,"float32"),L=1/(g*b*v),P=t.bufferSync(r);for(let j=0;j<f.batchSize;++j)for(let G=0;G<f.inChannels;++G)for(let Q=0;Q<f.inDepth;++Q)for(let q=0;q<f.inHeight;++q)for(let te=0;te<f.inWidth;++te){const Z=Q-E,ne=q-A,le=te-I;let H=0;for(let R=0;R<C;R+=w){const B=(Z+R)/d;if(!(B<0||B>=f.outDepth||Math.floor(B)!==B))for(let W=0;W<M;W+=x){const se=(ne+W)/h;if(!(se<0||se>=f.outHeight||Math.floor(se)!==se))for(let ue=0;ue<k;ue+=S){const ge=(le+ue)/p;if(ge<0||ge>=f.outWidth||Math.floor(ge)!==ge)continue;const Ce=P.get(j,B,se,ge,G);H+=Ce}}}D.set(H*L,j,Q,q,te,G)}return t.makeTensorInfo(D.shape,D.dtype,D.values)}const pze={kernelName:V4,backendName:"cpu",kernelFunc:hze};function mze(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,o=a;es([r,a],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=s,f=vh(o.shape,l,c,1,u),d=f.strideHeight,h=f.strideWidth,p=f.filterHeight,g=f.filterWidth,b=f.dilationHeight,v=f.dilationWidth,w=f.effectiveFilterHeight,x=f.effectiveFilterWidth,S=x-1-f.padInfo.left,C=w-1-f.padInfo.top,M=tr(o.shape,"float32"),k=1/(p*g),E=t.data.get(r.dataId).values,I=tr(r.shape,"float32",E);for(let A=0;A<f.batchSize;++A)for(let D=0;D<f.inChannels;++D)for(let L=0;L<f.inHeight;++L)for(let P=0;P<f.inWidth;++P){const j=L-C,G=P-S;let Q=0;for(let q=0;q<w;q+=b){const te=(j+q)/d;if(!(te<0||te>=f.outHeight||Math.floor(te)!==te))for(let Z=0;Z<x;Z+=v){const ne=(G+Z)/h;if(ne<0||ne>=f.outWidth||Math.floor(ne)!==ne)continue;const le=I.get(A,te,ne,D);Q+=le}}M.set(Q*k,A,L,P,D)}return t.makeTensorInfo(M.shape,M.dtype,M.values)}const gze={kernelName:U4,backendName:"cpu",kernelFunc:mze};function yze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,scale:a,offset:o,mean:l,variance:c}=e;we(l.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),we(o==null||l.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),we(a==null||l.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),es([r,l,c,a,o],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const f=t.data.get(r.dataId).values,d=t.data.get(l.dataId).values,h=t.data.get(c.dataId).values,p=a?t.data.get(a.dataId).values:new Float32Array([1]),g=o?t.data.get(o.dataId).values:new Float32Array([0]),b=new Float32Array(f.length),v=g.length,w=p.length,x=h.length,S=d.length;let C=0,M=0,k=0,E=0;for(let I=0;I<f.length;++I)b[I]=g[C++]+(f[I]-d[M++])*p[k++]/Math.sqrt(h[E++]+u),C>=v&&(C=0),M>=S&&(M=0),k>=w&&(k=0),E>=x&&(E=0);return t.makeTensorInfo(r.shape,r.dtype,b)}const bze={kernelName:VT,backendName:"cpu",kernelFunc:yze};function wze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,crops:o}=s;es([r],"batchToSpaceND");const l=a.reduce((w,x)=>w*x),c=qk(r.shape,a,l),u=Yk(c.length,a.length),f=Kk(r.shape,a,l),d=PB(o,a.length),h=$B(f,o,a.length),p=ba({inputs:{x:r},backend:t,attrs:{shape:c}}),g=Qu({inputs:{x:p},backend:t,attrs:{perm:u}}),b=ba({inputs:{x:g},backend:t,attrs:{shape:f}}),v=Eb({inputs:{x:b},backend:t,attrs:{begin:d,size:h}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),v}const vze={kernelName:LT,backendName:"cpu",kernelFunc:wze};function _ze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:o}=s,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,u=P9(l,c,a.dtype,a.shape,o);return t.makeTensorInfo([o],a.dtype,u)}const xze={kernelName:W4,backendName:"cpu",kernelFunc:_ze};function Cze(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=Gs(Array.from(a),Array.from(o));return t.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const Sze={kernelName:G4,backendName:"cpu",kernelFunc:Cze};const Mze=Fi(K2,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),Tze={kernelName:K2,backendName:"cpu",kernelFunc:Mze};const kze=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(Ot(e.shape)),r=t.data.get(e.dataId),a=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,l=t.data.get(a.dataId).values,c=t.data.get(o.dataId).values;for(let u=0;u<l.length;u++){const f=l[u],d=c[u];s[u]=Math.hypot(f,d)}return t.makeOutput(s,e.shape,"float32")},Eze={kernelName:DT,backendName:"cpu",kernelFunc:kze};function b2(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.imag,a=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,a)}const Ize={kernelName:fD,backendName:"cpu",kernelFunc:b2};function w2(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,a=dr(r,e[0].shape)[0],o=e.map(b=>b.shape);NB(o,a);let l=Mm(e.map(b=>b.shape),a);if(Ot(l)===0)return t.makeTensorInfo(l,e[0].dtype,[]);const c=e.filter(b=>Ot(b.shape)>0);if(c.length===1)return $m({inputs:{x:c[0]},backend:t});if(c[0].dtype==="complex64"){const b=c.map(C=>kb({inputs:{input:C},backend:t})),v=c.map(C=>b2({inputs:{input:C},backend:t})),w=w2({inputs:b,backend:t,attrs:{axis:a}}),x=w2({inputs:v,backend:t,attrs:{axis:a}}),S=_f({inputs:{real:w,imag:x},backend:t});return b.forEach(C=>t.disposeIntermediateTensorInfo(C)),v.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),S}const u=c.map(b=>{const w=[-1,Ot(b.shape.slice(a))];return ba({inputs:{x:b},backend:t,attrs:{shape:w}})}),f=u.map(b=>({vals:t.data.get(b.dataId).values,shape:b.shape}));l=Mm(u.map(b=>b.shape),1);const d=u[0].shape[0]===1,h=kle(f,l,e[0].dtype,d),p=Mm(c.map(b=>b.shape),a),g=t.makeTensorInfo(p,e[0].dtype,h);return u.forEach(b=>t.disposeIntermediateTensorInfo(b)),g}const Aze={kernelName:OT,backendName:"cpu",kernelFunc:w2};function Mce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:f}=s;es([r,a],"conv2d");const d=Hg(c),h=Vl(r.shape,a.shape,o,u,l,f,!1,d),p=h.filterHeight,g=h.filterWidth,b=h.dilationHeight,v=h.dilationWidth,w=h.padInfo.left,x=h.padInfo.top,S=h.dataFormat==="channelsLast",C=new el(h.outShape,r.dtype),M=gs(r.shape),k=gs(a.shape),E=M[0],I=S?M[1]:M[2],A=S?M[2]:1,D=S?1:M[1],L=C.strides[0],P=S?C.strides[1]:C.strides[2],j=S?C.strides[2]:1,G=S?1:C.strides[1],Q=t.data.get(r.dataId).values,q=t.data.get(a.dataId).values,te=C.values;for(let Z=0;Z<h.batchSize;++Z){const ne=Z*E,le=Z*L;for(let H=0;H<h.outHeight;++H){const R=le+H*P,B=H*h.strideHeight-x;for(let W=0;W<p;++W){const se=B+W*b;if(se<0||se>=h.inHeight)continue;const ue=W*k[0],ge=ne+se*I;for(let Ce=0;Ce<h.outWidth;++Ce){const Se=R+Ce*j,Me=Ce*h.strideWidth-w;for(let pe=0;pe<g;++pe){const fe=Me+pe*v;if(fe<0||fe>=h.inWidth)continue;const $e=ue+pe*k[1],We=ge+fe*A;let de=$e;for(let Be=0;Be<h.inChannels;++Be){const st=Q[We+Be*D];for(let He=0;He<h.outChannels;++He)te[Se+He*G]+=st*q[de+He];de+=h.outChannels}}}}}}return t.makeTensorInfo(C.shape,C.dtype,te)}const Lze={kernelName:PT,backendName:"cpu",kernelFunc:Mce};function Nze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:o,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:f}=s;es([r,a],"conv2dBackpropFilter");const d=Hg(c),h=Vl(r.shape,f,o,1,l,u,!1,d),{strideHeight:p,strideWidth:g,filterHeight:b,filterWidth:v}=h,w=h.dataFormat==="channelsLast",x=new el(h.filterShape,"float32"),S=h.padInfo.left,C=h.padInfo.top,M=t.data.get(r.dataId).values,k=t.data.get(a.dataId).values,E=new el(r.shape,r.dtype,M),I=new el(a.shape,a.dtype,k);for(let A=0;A<b;++A){const D=Math.max(0,Math.ceil((C-A)/p)),L=Math.min(h.outHeight,(h.inHeight+C-A)/p);for(let P=0;P<v;++P){const j=Math.max(0,Math.ceil((S-P)/g)),G=Math.min(h.outWidth,(h.inWidth+S-P)/g);for(let Q=0;Q<h.inChannels;++Q)for(let q=0;q<h.outChannels;++q){let te=0;for(let Z=0;Z<h.batchSize;++Z)for(let ne=D;ne<L;++ne){const le=A+ne*p-C;for(let H=j;H<G;++H){const R=P+H*g-S;w?te+=E.get(Z,le,R,Q)*I.get(Z,ne,H,q):te+=E.get(Z,Q,le,R)*I.get(Z,q,ne,H)}}x.set(te,A,P,Q,q)}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const Dze={kernelName:q4,backendName:"cpu",kernelFunc:Nze};function Oze(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{inputShape:o,strides:l,pad:c,dataFormat:u,dimRoundingMode:f}=s;es([r,a],"conv2dBackpropInput");const d=gs(a.shape),h=gs(r.shape);let p=Hg(u);const g=Vl(o,a.shape,l,1,c,f,!1,p),b=new el(g.inShape,"float32"),v=b.values,w=t.data.get(r.dataId).values,x=t.data.get(a.dataId).values,[S,C,M]=d,{batchSize:k,filterHeight:E,filterWidth:I,inChannels:A,inHeight:D,inWidth:L,outChannels:P,outHeight:j,outWidth:G,strideHeight:Q,strideWidth:q}=g;p=g.dataFormat;const te=E-1-g.padInfo.top,Z=I-1-g.padInfo.left,ne=p==="channelsLast",le=b.strides[0],H=ne?b.strides[1]:b.strides[2],R=ne?b.strides[2]:1,B=ne?1:b.strides[1],W=h[0],se=ne?h[1]:h[2],ue=ne?h[2]:1,ge=ne?1:h[1];for(let Ce=0;Ce<k;++Ce)for(let Se=0;Se<A;++Se)for(let Me=0;Me<D;++Me){const pe=Me-te,fe=Math.max(0,Math.ceil(pe/Q)),$e=Math.min(j,(E+pe)/Q);for(let We=0;We<L;++We){const de=We-Z,Be=Math.max(0,Math.ceil(de/q)),st=Math.min(G,(I+de)/q);let He=0;for(let Ke=fe;Ke<$e;++Ke){const Ze=Ke*Q-pe;for(let xt=Be;xt<st;++xt){const dt=xt*q-de,Ft=W*Ce+se*Ke+ue*xt,It=S*(E-1-Ze)+C*(I-1-dt)+M*Se;for(let Bt=0;Bt<P;++Bt){const Gt=w[Ft+ge*Bt],At=x[It+Bt];He+=Gt*At}}}const Xe=le*Ce+H*Me+R*We+B*Se;v[Xe]=He}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const Pze={kernelName:$T,backendName:"cpu",kernelFunc:Oze};function $ze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c}=s;es([r,a],"conv3d");const u=M1(r.shape,a.shape,o,c,l),{filterDepth:f,filterHeight:d,filterWidth:h,dilationDepth:p,dilationHeight:g,dilationWidth:b,padInfo:v}=u,w=v.front,x=v.left,S=v.top,C=new el(u.outShape,r.dtype),M=t.data.get(r.dataId).values,k=t.data.get(a.dataId).values,E=C.values,I=gs(r.shape),A=gs(a.shape);for(let D=0;D<u.batchSize;++D){const L=D*I[0],P=D*C.strides[0];for(let j=0;j<u.outDepth;++j){const G=P+j*C.strides[1],Q=j*u.strideDepth-w;for(let q=0;q<f;++q){const te=Q+q*p;if(te<0||te>=u.inDepth)continue;const Z=q*A[0],ne=L+te*I[1];for(let le=0;le<u.outHeight;++le){const H=G+le*C.strides[2],R=le*u.strideHeight-S;for(let B=0;B<d;++B){const W=R+B*g;if(W<0||W>=u.inHeight)continue;const se=Z+B*A[1],ue=ne+W*I[2];for(let ge=0;ge<u.outWidth;++ge){const Ce=H+ge*u.outChannels,Se=ge*u.strideWidth-x;for(let Me=0;Me<h;++Me){const pe=Se+Me*b;if(pe<0||pe>=u.inWidth)continue;const fe=se+Me*A[2],$e=ue+pe*u.inChannels;let We=fe;for(let de=0;de<u.inChannels;++de){const Be=M[$e+de];for(let st=0;st<u.outChannels;++st)E[Ce+st]+=Be*k[We+st];We+=u.outChannels}}}}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const jze={kernelName:jT,backendName:"cpu",kernelFunc:$ze};function Rze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:o,pad:l,filterShape:c}=s;es([r,a],"conv3dBackpropFilterV2");const u=gs(r.shape),f=gs(a.shape),d=M1(r.shape,c,o,1,l),h=d.strideDepth,p=d.strideHeight,g=d.strideWidth,b=d.filterDepth,v=d.filterHeight,w=d.filterWidth,x=new el(d.filterShape,"float32"),S=x.values,[C,M,k,E]=x.strides,I=t.data.get(a.dataId).values,[A,D,L,P]=f,j=t.data.get(r.dataId).values,[G,Q,q,te]=u,Z=d.padInfo.front,ne=d.padInfo.left,le=d.padInfo.top;for(let H=0;H<b;++H){const R=Math.max(0,Math.ceil((Z-H)/h)),B=Math.min(d.outDepth,(d.inDepth+Z-H)/h),W=H*C;for(let se=0;se<v;++se){const ue=Math.max(0,Math.ceil((le-se)/p)),ge=Math.min(d.outHeight,(d.inHeight+le-se)/p),Ce=se*M+W;for(let Se=0;Se<w;++Se){const Me=Math.max(0,Math.ceil((ne-Se)/g)),pe=Math.min(d.outWidth,(d.inWidth+ne-Se)/g),fe=Se*k+Ce;for(let $e=0;$e<d.inChannels;++$e){const We=$e*E+fe;for(let de=0;de<d.outChannels;++de){let Be=0;for(let st=0;st<d.batchSize;++st){const He=st*G,Xe=st*A;for(let Ke=R;Ke<B;++Ke){const xt=(H+Ke*h-Z)*Q+He,dt=Ke*D+Xe;for(let Ft=ue;Ft<ge;++Ft){const Bt=(se+Ft*p-le)*q+xt,Gt=Ft*L+dt;for(let At=Me;At<pe;++At){const Qt=(Se+At*g-ne)*te+Bt,Xt=At*P+Gt;Be+=j[Qt+$e]*I[Xt+de]}}}}S[We+de]=Be}}}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const Fze={kernelName:Y4,backendName:"cpu",kernelFunc:Rze};function zze(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{pad:o,strides:l,inputShape:c}=s;es([r],"conv3dBackpropInputV2");const u=gs(r.shape),f=gs(a.shape),d=M1(c,a.shape,l,1,o),h=new el(d.inShape,"float32"),p=h.values,[g,b,v,w]=h.strides,x=t.data.get(r.dataId).values,[S,C,M,k]=u,E=t.data.get(a.dataId).values,[I,A,D,L]=f,{batchSize:P,filterDepth:j,filterHeight:G,filterWidth:Q,inChannels:q,inDepth:te,inHeight:Z,inWidth:ne,outChannels:le,outDepth:H,outHeight:R,outWidth:B,strideDepth:W,strideHeight:se,strideWidth:ue}=d,ge=j-1-d.padInfo.front,Ce=G-1-d.padInfo.top,Se=Q-1-d.padInfo.left;for(let Me=0;Me<P;++Me)for(let pe=0;pe<q;++pe)for(let fe=0;fe<te;++fe){const $e=fe-ge,We=Math.max(0,Math.ceil($e/W)),de=Math.min(H,(j+$e)/W);for(let Be=0;Be<Z;++Be){const st=Be-Ce,He=Math.max(0,Math.ceil(st/se)),Xe=Math.min(R,(G+st)/se);for(let Ke=0;Ke<ne;++Ke){const Ze=Ke-Se,xt=Math.max(0,Math.ceil(Ze/ue)),dt=Math.min(B,(Q+Ze)/ue);let Ft=0;for(let It=We;It<de;++It){const Bt=It*W-$e;for(let Gt=He;Gt<Xe;++Gt){const At=Gt*se-st;for(let ht=xt;ht<dt;++ht){const Qt=ht*ue-Ze,Xt=S*Me+C*It+M*Gt+k*ht,us=I*(j-1-Bt)+A*(G-1-At)+D*(Q-1-Qt)+L*pe;for(let yn=0;yn<le;++yn){const En=x[Xt+yn],Vn=E[us+yn];Ft+=En*Vn}}}}p[g*Me+b*fe+v*Be+w*Ke+pe]=Ft}}}return t.makeTensorInfo(h.shape,h.dtype,h.values)}const Bze={kernelName:K4,backendName:"cpu",kernelFunc:zze};const Uze=Fi(X2,n=>Math.cos(n)),Vze={kernelName:X2,backendName:"cpu",kernelFunc:Uze};const Wze=Fi(Q2,n=>Math.cosh(n)),Gze={kernelName:Q2,backendName:"cpu",kernelFunc:Wze};function Hze(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:a,boxInd:o}=e,{cropSize:l,method:c,extrapolationValue:u}=s,[f,d,h,p]=r.shape,g=a.shape[0],[b,v]=l,w=tr([g,b,v,p],"float32"),x=t.data.get(a.dataId).values,S=t.data.get(o.dataId).values,C=t.data.get(r.dataId).values,M=gs(r.shape),k=gs(w.shape);for(let E=0;E<g;E++){const I=E*4,A=x[I],D=x[I+1],L=x[I+2],P=x[I+3],j=S[E];if(j>=f)continue;const G=b>1?(L-A)*(d-1)/(b-1):0,Q=v>1?(P-D)*(h-1)/(v-1):0;for(let q=0;q<b;q++){const te=b>1?A*(d-1)+q*G:.5*(A+L)*(d-1);if(te<0||te>d-1){for(let Z=0;Z<v;Z++)for(let ne=0;ne<p;ne++){const le=ne+Z*k[2]+q*k[1]+E*k[0];w.values[le]=u}continue}if(c==="bilinear"){const Z=Math.floor(te),ne=Math.ceil(te),le=te-Z;for(let H=0;H<v;H++){const R=v>1?D*(h-1)+H*Q:.5*(D+P)*(h-1);if(R<0||R>h-1){for(let ue=0;ue<p;ue++){const ge=ue+H*k[2]+q*k[1]+E*k[0];w.values[ge]=u}continue}const B=Math.floor(R),W=Math.ceil(R),se=R-B;for(let ue=0;ue<p;ue++){let ge=ue+B*M[2]+Z*M[1]+j*M[0];const Ce=C[ge];ge=ue+W*M[2]+Z*M[1]+j*M[0];const Se=C[ge];ge=ue+B*M[2]+ne*M[1]+j*M[0];const Me=C[ge];ge=ue+W*M[2]+ne*M[1]+j*M[0];const pe=C[ge],fe=Ce+(Se-Ce)*se,$e=Me+(pe-Me)*se;ge=ue+H*k[2]+q*k[1]+E*k[0],w.values[ge]=fe+($e-fe)*le}}}else for(let Z=0;Z<v;++Z){const ne=v>1?D*(h-1)+Z*Q:.5*(D+P)*(h-1);if(ne<0||ne>h-1){for(let R=0;R<p;R++){const B=R+Z*k[2]+q*k[1]+E*k[0];w.values[B]=u}continue}const le=Math.round(ne),H=Math.round(te);for(let R=0;R<p;R++){const B=R+le*M[2]+H*M[1]+j*M[0],W=R+Z*k[2]+q*k[1]+E*k[0];w.values[W]=C[B]}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const qze={kernelName:Q4,backendName:"cpu",kernelFunc:Hze};function Yze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;es(r,"cumprod");const c=no([a],r.shape.length);let u=r;c!=null&&(u=Qu({inputs:{x:r},backend:t,attrs:{perm:c}}));const f=jo(1,r.shape.length)[0];if(f!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${f}`);const d=Hu(u.dtype,"int32"),h=F4(Ot(u.shape),d),p=t.data.get(u.dataId).values,g=u.shape[u.shape.length-1],b=l?(w,x)=>w+g-x-1:(w,x)=>w+x;for(let w=0;w<p.length;w+=g)for(let x=0;x<g;x++){const S=b(w,x);if(x===0)h[S]=o?1:p[S];else{const C=b(w,x-1);h[S]=o?p[C]*h[C]:p[S]*h[C]}}const v=t.makeTensorInfo(u.shape,d,h);if(c!=null){const w=T1(c),x=Qu({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(u),x}return v}const Kze={kernelName:X4,backendName:"cpu",kernelFunc:Yze};function Xze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;es(r,"cumsum");const c=no([a],r.shape.length);let u=r;c!=null&&(u=Qu({inputs:{x:r},backend:t,attrs:{perm:c}}));const f=jo(1,r.shape.length)[0];if(f!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${f}`);const d=Hu(u.dtype,"int32"),h=hc(Ot(u.shape),d),p=t.data.get(u.dataId).values,g=u.shape[u.shape.length-1],b=l?(w,x)=>w+g-x-1:(w,x)=>w+x;for(let w=0;w<p.length;w+=g)for(let x=0;x<g;x++){const S=b(w,x);if(x===0)h[S]=o?0:p[S];else{const C=b(w,x-1);h[S]=o?p[C]+h[C]:p[S]+h[C]}}const v=t.makeTensorInfo(u.shape,d,h);if(c!=null){const w=T1(c),x=Qu({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(u),x}return v}const Qze={kernelName:RT,backendName:"cpu",kernelFunc:Xze};function Jze(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:o,binaryOutput:l}=s;if(r.shape.length===1){const c=t.data.get(r.dataId).values,u=t.data.get(a.dataId).values,f=P9(c,u,a.dtype,a.shape,o);return t.makeTensorInfo([o],a.dtype,f)}else if(r.shape.length===2){const c=t.bufferSync(r),u=t.bufferSync(a),f=Sle(c,u,o,l);return t.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Zze={kernelName:J4,backendName:"cpu",kernelFunc:Jze};function eBe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:a,dataFormat:o}=s;we(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const l=r.shape[0],c=r.shape[1],u=r.shape[2],f=r.shape[3],d=c*a,h=u*a,p=f/(a*a),g=t.data.get(r.dataId).values,b=new Float32Array(l*d*h*p);let v=0;for(let w=0;w<l;++w)for(let x=0;x<d;++x){const S=Math.floor(x/a),C=x%a;for(let M=0;M<h;++M){const k=Math.floor(M/a),E=M%a,I=(C*a+E)*p;for(let A=0;A<p;++A){const L=A+I+f*(k+u*(S+c*w));b[v++]=g[L]}}}return t.makeTensorInfo([l,d,h,p],r.dtype,b)}const tBe={kernelName:Z4,backendName:"cpu",kernelFunc:eBe};function Tce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=s;es([r,a],"depthwiseConv2DNative");const f=gs(r.shape),d=gs(a.shape);let h=c;h==null&&(h=[1,1]),we(gc(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const p=Vl(r.shape,a.shape,o,h,l,u,!0),{filterHeight:g,filterWidth:b,dilationHeight:v,dilationWidth:w,padInfo:x}=p,S=x.left,C=x.top,M=p.outChannels/p.inChannels,k=new el(p.outShape,r.dtype),E=t.data.get(r.dataId).values,I=t.data.get(a.dataId).values,A=k.values;for(let D=0;D<p.batchSize;++D){const L=D*f[0],P=D*k.strides[0];for(let j=0;j<p.outHeight;++j){const G=P+j*k.strides[1],Q=j*p.strideHeight-C;for(let q=0;q<g;++q){const te=Q+q*v;if(te<0||te>=p.inHeight)continue;const Z=q*d[0],ne=L+te*f[1];for(let le=0;le<p.outWidth;++le){const H=G+le*k.strides[2],R=le*p.strideWidth-S;for(let B=0;B<b;++B){const W=R+B*w;if(W<0||W>=p.inWidth)continue;const se=Z+B*d[1],ue=ne+W*p.inChannels;let ge=H,Ce=se;for(let Se=0;Se<p.inChannels;++Se){const Me=E[ue+Se];for(let pe=0;pe<M;++pe)A[ge+pe]+=Me*I[Ce+pe];ge+=M,Ce+=M}}}}}}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const nBe={kernelName:FT,backendName:"cpu",kernelFunc:Tce};function sBe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,filterShape:f}=s;es([r,a],"depthwiseConv2dNativeBackpropFilter");const d=Vl(r.shape,f,o,l,c,u,!0),{strideHeight:h,strideWidth:p,filterHeight:g,filterWidth:b}=d,v=new el(d.filterShape,"float32"),w=d.padInfo.left,x=d.padInfo.top,S=d.outChannels/d.inChannels,C=t.data.get(r.dataId).values,M=new el(r.shape,r.dtype,C),k=t.data.get(a.dataId).values,E=new el(a.shape,a.dtype,k);for(let I=0;I<g;++I){const A=Math.max(0,Math.ceil((x-I)/h)),D=Math.min(d.outHeight,(d.inHeight+x-I)/h);for(let L=0;L<b;++L){const P=Math.max(0,Math.ceil((w-L)/p)),j=Math.min(d.outWidth,(d.inWidth+w-L)/p);for(let G=0;G<d.outChannels;++G){const Q=Math.trunc(G/S),q=G%S;let te=0;for(let Z=0;Z<d.batchSize;++Z)for(let ne=A;ne<D;++ne){const le=I+ne*h-x;for(let H=P;H<j;++H){const R=L+H*p-w;te+=M.get(Z,le,R,Q)*E.get(Z,ne,H,G)}}v.set(te,I,L,Q,q)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const rBe={kernelName:eD,backendName:"cpu",kernelFunc:sBe};function iBe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,inputShape:f}=s;es([r,a],"depthwiseConv2DNativeBackpropInput");const d=gs(r.shape),h=gs(a.shape),p=Vl(f,a.shape,o,l,c,u,!0),g=new el(p.inShape,"float32"),b=g.values,[v,w,x]=g.strides,S=t.data.get(r.dataId).values,[C,M,k]=d,E=t.data.get(a.dataId).values,[I,A,D]=h,{batchSize:L,filterHeight:P,filterWidth:j,inChannels:G,inHeight:Q,inWidth:q,outChannels:te,outHeight:Z,outWidth:ne,strideHeight:le,strideWidth:H}=p,R=P-1-p.padInfo.top,B=j-1-p.padInfo.left,W=te/G;for(let se=0;se<L;++se)for(let ue=0;ue<G;++ue)for(let ge=0;ge<Q;++ge){const Ce=ge-R,Se=Math.max(0,Math.ceil(Ce/le)),Me=Math.min(Z,(P+Ce)/le);for(let pe=0;pe<q;++pe){const fe=pe-B,$e=Math.max(0,Math.ceil(fe/H)),We=Math.min(ne,(j+fe)/H);let de=0;for(let Be=Se;Be<Me;++Be){const st=Be*le-Ce;for(let He=$e;He<We;++He){const Xe=He*H-fe,Ke=C*se+M*Be+k*He,Ze=I*(P-1-st)+A*(j-1-Xe)+D*ue;for(let xt=0;xt<W;++xt){const dt=ue*W+xt,Ft=S[Ke+dt],It=E[Ze+xt];de+=Ft*It}}}b[v*se+w*ge+x*pe+ue]=de}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}const aBe={kernelName:tD,backendName:"cpu",kernelFunc:iBe};function oBe(n){const{inputs:e,backend:t}=n,{x:s}=e,r=Ot(s.shape),a=t.data.get(s.dataId).values,o=tr([r,r],s.dtype),l=o.values;for(let u=0;u<a.length;u++)l[u*r+u]=a[u];const c=[...s.shape,...s.shape];return t.makeTensorInfo(c,o.dtype,o.values)}const lBe={kernelName:nD,backendName:"cpu",kernelFunc:oBe};const cBe={kernelName:zT,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r}=n,{strides:a,pad:o,dilations:l}=t,c=e,u=c.data.get(s.dataId).values,f=s.shape.length,d=c.data.get(r.dataId).values,h=r.shape.length,{batchSize:p,inHeight:g,inWidth:b,inChannels:v,outHeight:w,outWidth:x,padInfo:S,strideHeight:C,strideWidth:M,filterHeight:k,filterWidth:E,dilationHeight:I,dilationWidth:A,outShape:D}=Ik(s.shape,r.shape,a,o,"NHWC",l),L=Ot(D),P=D.length,j=po(s.dtype,L);for(let Q=0;Q<p;++Q)for(let q=0;q<w;++q){const te=q*C-S.top;for(let Z=0;Z<x;++Z){const ne=Z*M-S.left;for(let le=0;le<v;++le){let H=Number.MIN_SAFE_INTEGER;for(let B=0;B<k;++B){const W=te+B*I;if(W>=0&&W<g)for(let se=0;se<E;++se){const ue=ne+se*A;if(ue>=0&&ue<b){const ge=op([Q,W,ue,le],f,gs(s.shape)),Ce=op([B,se,le],h,gs(r.shape)),Se=u[ge]+d[Ce];Se>H&&(H=Se)}}}const R=op([Q,q,Z,le],P,gs(D));j[R]=H}}}return{dataId:c.write(C1(j,s.dtype),D,s.dtype),shape:D,dtype:s.dtype}}};const uBe={kernelName:SN,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:a}=n,{strides:o,pad:l,dilations:c}=t,u=e,f=yd(s.shape,u.data.get(s.dataId).values),d=yd(r.shape,u.data.get(r.dataId).values),{batchSize:h,inHeight:p,inWidth:g,inChannels:b,outHeight:v,outWidth:w,padInfo:x,strideHeight:S,strideWidth:C,filterHeight:M,filterWidth:k,dilationHeight:E,dilationWidth:I,outShape:A}=Ik(s.shape,r.shape,o,l,"NHWC",c);we(a.rank===A.length,()=>`Error in ${SN}, dy must have the same rank as output ${A.length}, but got ${a.rank}`);const D=yd(A,u.data.get(a.dataId).values),L=JF(r.shape,r.dtype);for(let j=0;j<h;++j)for(let G=0;G<v;++G){const Q=G*S-x.top;for(let q=0;q<w;++q){const te=q*C-x.left;for(let Z=0;Z<b;++Z){let ne=Number.MIN_SAFE_INTEGER,le=0,H=0;for(let R=0;R<M;++R){const B=Q+R*E;if(B>=0&&B<p)for(let W=0;W<k;++W){const se=te+W*I;if(se>=0&&se<g){const ue=f[j][B][se][Z]+d[R][W][Z];ue>ne&&(ne=ue,le=R,H=W)}}}L[le][H][Z]+=D[j][G][q][Z]}}}return{dataId:u.write(C1(L,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};const fBe={kernelName:CN,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:a}=n,{strides:o,pad:l,dilations:c}=t,u=e,f=yd(s.shape,u.data.get(s.dataId).values),d=yd(r.shape,u.data.get(r.dataId).values),{batchSize:h,inHeight:p,inWidth:g,inChannels:b,outHeight:v,outWidth:w,padInfo:x,strideHeight:S,strideWidth:C,filterHeight:M,filterWidth:k,dilationHeight:E,dilationWidth:I,outShape:A}=Ik(s.shape,r.shape,o,l,"NHWC",c);we(a.rank===A.length,()=>`Error in ${CN}, dy must have the same rank as output ${A.length}, but got ${a.rank}`);const D=yd(A,u.data.get(a.dataId).values),L=JF(s.shape,s.dtype);for(let j=0;j<h;++j)for(let G=0;G<v;++G){const Q=G*S-x.top;for(let q=0;q<w;++q){const te=q*C-x.left;for(let Z=0;Z<b;++Z){let ne=Number.MIN_SAFE_INTEGER,le=Q<0?0:Q,H=te<0?0:te;for(let R=0;R<M;++R){const B=Q+R*E;if(B>=0&&B<p)for(let W=0;W<k;++W){const se=te+W*I;if(se>=0&&se<g){const ue=f[j][B][se][Z]+d[R][W][Z];ue>ne&&(ne=ue,le=B,H=se)}}}L[j][le][H][Z]+=D[j][G][q][Z]}}}return{dataId:u.write(C1(L,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};function dBe(n){const{inputs:e,backend:t,attrs:s}=n,{image:r}=e,{canvas:a,options:o}=s,{contextOptions:l,imageOptions:c}=o||{},u=c?.alpha||1,f=l?.contextType||"2d";if(f!=="2d")throw new Error(`Context type ${l.contextType} is not supported by the CPU backend.`);const d=a.getContext(f,l?.contextAttributes||{});if(d==null)throw new Error(`Could not get the context with ${f} type.`);const[h,p]=r.shape.slice(0,2),g=r.shape.length===2?1:r.shape[2],b=t.data.get(r.dataId).values,v=r.dtype==="float32"?255:1,w=new Uint8ClampedArray(p*h*4);for(let S=0;S<h*p;++S){const C=[0,0,0,255*u];for(let k=0;k<g;k++){const E=b[S*g+k];if(r.dtype==="float32"){if(E<0||E>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${E}.`)}else if(r.dtype==="int32"&&(E<0||E>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${E}.`);g===1?(C[0]=E*v,C[1]=E*v,C[2]=E*v):C[k]=E*v}const M=S*4;w[M+0]=Math.round(C[0]),w[M+1]=Math.round(C[1]),w[M+2]=Math.round(C[2]),w[M+3]=Math.round(C[3])}a.width=p,a.height=h;const x=new ImageData(w,p,h);return d.putImageData(x,0,0),r}const hBe={kernelName:sD,backendName:"cpu",kernelFunc:dBe};function oE(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s;es(r,"sum");let l;r.dtype==="bool"?l=b1({inputs:{x:r},backend:t,attrs:{dtype:"int32"}}):l=$m({inputs:{x:r},backend:t});const c=l.shape.length,u=dr(a,l.shape),f=no(u,c);let d=u,h=l;f!=null&&(h=Qu({inputs:{x:l},backend:t,attrs:{perm:f}}),d=jo(d.length,c)),yc("sum",d,h.shape.length);const[p,g]=Wl(h.shape,d),b=Hu(h.dtype,"int32");let v=VN(t,p,b);const w=Ot(g),x=t.data.get(v.dataId).values,S=t.data.get(h.dataId).values;for(let C=0;C<x.length;++C){const M=C*w;let k=0;for(let E=0;E<w;++E)k+=S[M+E];x[C]=k}if(o){const C=$o(v.shape,u),M=v;v=ba({inputs:{x:v},backend:t,attrs:{shape:C}}),t.disposeIntermediateTensorInfo(M)}return t.disposeIntermediateTensorInfo(l),f!=null&&t.disposeIntermediateTensorInfo(h),v}const pBe={kernelName:wk,backendName:"cpu",kernelFunc:oE};function mBe(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,a=e,{allDims:o,summedDims:l,idDims:c}=WB(r,a.length);HB(o.length,c,a);const{path:u,steps:f}=qB(l,c),d=f.length;let h=null,p=o.length;const g=[];for(let b=0;b<d;++b){for(const v of f[b]){const{permutationIndices:w,expandDims:x}=GB(p,c[v]);let S;YB(w)?S=a[v]:(S=Qu({inputs:{x:a[v]},backend:t,attrs:{perm:w}}),g.push(S));const C=S.shape.slice();for(let M=0;M<x.length;++M)C.splice(x[M],0,1);xr(S.shape,C)||(S=ba({inputs:{x:S},backend:t,attrs:{shape:C}}),g.push(S)),h===null?h=S:(h=tP({inputs:{a:S,b:h},backend:t}),g.push(h))}b<d-1&&(u[b]>=0&&(h=oE({inputs:{x:h},backend:t,attrs:{axis:u[b]-(o.length-p),keepDims:!1}}),g.push(h)),p--)}for(const b of g)b!==h&&t.disposeIntermediateTensorInfo(b);return h}const gBe={kernelName:rD,backendName:"cpu",kernelFunc:mBe};function yBe(n){const{inputs:e,backend:t}=n,{dy:s,y:r}=e;es([s,r],"eluGrad");const a=new Float32Array(Ot(r.shape)),o=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values;for(let c=0;c<o.length;++c){const u=o[c];u>=0?a[c]=l[c]:a[c]=l[c]*(u+1)}return t.makeTensorInfo(r.shape,"float32",a)}const bBe={kernelName:iD,backendName:"cpu",kernelFunc:yBe};const wBe=jB,vBe=RB,_Be=FB,xBe=zB,CBe=BB,SBe=UB,MBe=Fi(e_,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+wBe*t);return e*(1-((((SBe*s+CBe)*s+xBe)*s+_Be)*s+vBe)*s*Math.exp(-t*t))}),TBe={kernelName:e_,backendName:"cpu",kernelFunc:MBe};function HN(n){const{inputs:e,backend:t,attrs:s}=n,{input:r}=e,{dim:a}=s,o=r.shape.length,l=r.shape.slice();let c=a;return a<0&&(we(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+a+1),l.splice(c,0,1),ba({inputs:{x:r},backend:t,attrs:{shape:l}})}const kBe={kernelName:UT,backendName:"cpu",kernelFunc:HN};const EBe=Fo((n,e)=>n/e),B9=Sl(J2,EBe),a6={kernelName:J2,backendName:"cpu",kernelFunc:B9};function kce(n,e,t){const s=n.shape,r=s[0],a=s[1],o=t.data.get(n.dataId),l=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,u=[r,a],f=Ot(u),d=Bl("float32",f),h=Bl("float32",f);for(let v=0;v<r;v++){const w=Eb({inputs:{x:l},backend:t,attrs:{begin:[v,0],size:[1,a]}}),x=Eb({inputs:{x:c},backend:t,attrs:{begin:[v,0],size:[1,a]}}),S=_f({inputs:{real:w,imag:x},backend:t}),{real:C,imag:M}=IBe(S,e,t),k=Fg(C,M);for(let E=0;E<a;E++){const I=VB(k,E);d[v*a+E]=I.real,h[v*a+E]=I.imag}t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(S)}const p=t.makeTensorInfo(u,"float32",d),g=t.makeTensorInfo(u,"float32",h),b=_f({inputs:{real:p,imag:g},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),b}function IBe(n,e,t){const s=Ot(n.shape),r=t.data.get(n.dataId),a=t.data.get(r.complexTensorInfos.real.dataId).values,o=t.data.get(r.complexTensorInfos.imag.dataId).values;if(ABe(s)){const l=o6(a,o,s,e,t),c=[n.shape[0],n.shape[1]];if(e){const u=t.makeTensorInfo(c,"float32",l.real),f=t.makeTensorInfo(c,"float32",l.imag),d=t.makeTensorInfo([],"float32",Wg(s,"float32")),h=$m({inputs:{x:d},backend:t}),p=a6.kernelFunc({inputs:{a:u,b:d},backend:t}),g=a6.kernelFunc({inputs:{a:f,b:h},backend:t}),b=t.data.get(p.dataId).values,v=t.data.get(g.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),{real:b,imag:v}}return l}else{const l=Fg(a,o),c=LBe(l,s,e);return hae(c)}}function ABe(n){return(n&n-1)===0}function o6(n,e,t,s,r){if(t===1)return{real:n,imag:e};const a=Fg(n,e),o=t/2,l=pae(a),c=l.real,u=l.imag,f=[c.length],d=r.makeTensorInfo(f,"float32",c),h=r.makeTensorInfo(f,"float32",u),p=_f({inputs:{real:d,imag:h},backend:r}),g=mae(a),b=g.real,v=g.imag,w=[b.length],x=r.makeTensorInfo(w,"float32",b),S=r.makeTensorInfo(w,"float32",v),C=_f({inputs:{real:x,imag:S},backend:r}),M=o6(c,u,o,s,r),k=M.real,E=M.imag,I=[k.length],A=r.makeTensorInfo(I,"float32",k),D=r.makeTensorInfo(I,"float32",E),L=_f({inputs:{real:A,imag:D},backend:r}),P=o6(b,v,o,s,r),j=P.real,G=P.imag,Q=[j.length],q=r.makeTensorInfo(Q,"float32",j),te=r.makeTensorInfo(Q,"float32",G),Z=_f({inputs:{real:q,imag:te},backend:r}),ne=yae(t,s),le=[ne.real.length],H=r.makeTensorInfo(le,"float32",ne.real),R=r.makeTensorInfo(le,"float32",ne.imag),B=_f({inputs:{real:H,imag:R},backend:r}),W=tP({inputs:{a:B,b:Z},backend:r}),se=y2({inputs:{a:L,b:W},backend:r}),ue=F9({inputs:{a:L,b:W},backend:r}),ge=kb({inputs:{input:se},backend:r}),Ce=kb({inputs:{input:ue},backend:r}),Se=b2({inputs:{input:se},backend:r}),Me=b2({inputs:{input:ue},backend:r}),pe=w2({inputs:[ge,Ce],backend:r,attrs:{axis:0}}),fe=w2({inputs:[Se,Me],backend:r,attrs:{axis:0}}),$e=r.data.get(pe.dataId).values,We=r.data.get(fe.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(ue),r.disposeIntermediateTensorInfo(ge),r.disposeIntermediateTensorInfo(Se),r.disposeIntermediateTensorInfo(Ce),r.disposeIntermediateTensorInfo(Me),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(fe),{real:$e,imag:We}}function LBe(n,e,t){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let a=0,o=0;for(let l=0;l<e;l++){const c=bae(r*l,e,t),u=VB(n,l);a+=u.real*c.real-u.imag*c.imag,o+=u.real*c.imag+u.imag*c.real}t&&(a/=e,o/=e),gae(s,a,o,r)}return s}function NBe(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Ot(s.shape),a=s.shape[s.shape.length-1],o=r/a,l=ba({inputs:{x:s},backend:t,attrs:{shape:[o,a]}}),c=kce(l,!1,t),u=ba({inputs:{x:c},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(c),u}const DBe={kernelName:aD,backendName:"cpu",kernelFunc:NBe};function U9(n){const{backend:e,attrs:t}=n,{shape:s,value:r,dtype:a}=t,o=a||Hb(r),l=po(o,Ot(s));return PBe(l,r,o),e.makeTensorInfo(s,o,l)}const OBe={kernelName:oD,backendName:"cpu",kernelFunc:U9};function PBe(n,e,t){n.fill(e)}const $Be={kernelName:lD,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,r=t,a=Bl(s.dtype,Ot(s.shape)),[o,l,c,u]=s.shape,f=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const p=h*c*l*u;for(let g=0;g<l;g++){const b=g*(c*u);for(let v=0;v<c;v++){const w=v*u;for(let x=0;x<u;x++){const S=Math.round(c-v-1),C=p+b+w+x;let M=f[C];if(S>=0&&S<c){const k=S*u,E=p+b+k+x;M=f[E]}a[C]=M}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};function jBe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:f,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:g}=s;let b=Mce({inputs:{x:r,filter:a},backend:t,attrs:{strides:c,pad:u,dataFormat:f,dilations:d,dimRoundingMode:h}});if(o){const v=b;if(f==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const w=ba({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});b=y2({inputs:{a:b,b:w},backend:t}),t.disposeIntermediateTensorInfo(w)}else b=y2({inputs:{a:b,b:o},backend:t});t.disposeIntermediateTensorInfo(v)}if(p){const v=b;if(f==="NCHW"&&p==="prelu"&&l.shape.length===1&&l.shape[0]!==1){const w=ba({inputs:{x:l},backend:t,attrs:{shape:[l.shape[0],1,1]}});b=GN(t,b,p,w,g),t.disposeIntermediateTensorInfo(w)}else b=GN(t,b,p,l,g);t.disposeIntermediateTensorInfo(v)}return b}const RBe={kernelName:LM,backendName:"cpu",kernelFunc:jBe};function FBe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:f,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:g}=s;let b=Tce({inputs:{x:r,filter:a},backend:t,attrs:{strides:c,pad:u,dataFormat:f,dilations:d,dimRoundingMode:h}});if(o){const v=b;b=y2({inputs:{a:b,b:o},backend:t}),t.disposeIntermediateTensorInfo(v)}if(p){const v=b;b=GN(t,b,p,l,g),t.disposeIntermediateTensorInfo(v)}return b}const zBe={kernelName:NM,backendName:"cpu",kernelFunc:FBe};function BBe(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,a=Ot(s.shape),o=r.shape,l=o[o.length-1],[c,u,f,d]=IO(s,r);if(u===0)return t.makeTensorInfo(c,s.dtype,[]);const h=t.data.get(r.dataId).values,p=t.bufferSync(s),g=Ple(h,p,s.dtype,u,l,f,d,s.shape,a);return t.makeTensorInfo(c,s.dtype,g.values)}const UBe={kernelName:cD,backendName:"cpu",kernelFunc:BBe};function VBe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:a}=e,{axis:o,batchDims:l}=s;es([r,a],"gatherV2");const c=dr(o,r.shape)[0],u=t.data.get(a.dataId).values,f=r.shape[c];for(let C=0;C<u.length;++C){const M=u[C];we(M<=f-1&&M>=0,()=>`GatherV2: the index value ${M} is not in [0, ${f-1}]`)}let d=l;l==null&&(d=0);const h=Ot(a.shape),p=XB(r,a,c,d),g=ba({inputs:{x:r},backend:t,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),b=ba({inputs:{x:a},backend:t,attrs:{shape:[p.batchSize,h/p.batchSize]}}),v=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],w=t.bufferSync(b),x=t.bufferSync(g),S=$le(x,w,v);return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.makeTensorInfo(p.outputShape,S.dtype,S.values)}const WBe={kernelName:WT,backendName:"cpu",kernelFunc:VBe};function GBe(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Ot(s.shape),a=s.shape[s.shape.length-1],o=r/a,l=ba({inputs:{x:s},backend:t,attrs:{shape:[o,a]}}),c=kce(l,!0,t),u=ba({inputs:{x:c},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(c),u}const HBe={kernelName:uD,backendName:"cpu",kernelFunc:GBe};const qBe=Fi(o_,n=>Number.isFinite(n)?1:0,"bool"),YBe={kernelName:o_,backendName:"cpu",kernelFunc:qBe};const KBe=Fi(l_,n=>Math.abs(n)===1/0?1:0,"bool"),XBe={kernelName:l_,backendName:"cpu",kernelFunc:KBe};const QBe=Fi(c_,n=>Number.isNaN(n)?1:0,"bool"),JBe={kernelName:c_,backendName:"cpu",kernelFunc:QBe};function ZBe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:a}=t,o=Ble(s,r,a);return e.makeTensorInfo([o.length],"float32",o)}const e8e={kernelName:dD,backendName:"cpu",kernelFunc:ZBe};const t8e=Fi(f_,n=>Math.log1p(n)),n8e={kernelName:f_,backendName:"cpu",kernelFunc:t8e};const s8e=Fo((n,e)=>n&&e),r8e=Sl(KT,s8e,null,"bool"),i8e={kernelName:KT,backendName:"cpu",kernelFunc:r8e};const a8e=Fi(XT,n=>n?0:1,"bool"),o8e={kernelName:XT,backendName:"cpu",kernelFunc:a8e};const l8e=Fo((n,e)=>n||e),c8e=Sl(QT,l8e,null,"bool"),u8e={kernelName:QT,backendName:"cpu",kernelFunc:c8e};function f8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:a,bias:o,alpha:l,beta:c}=s;es(r,"LRN");const u=r.shape[3],f=u-1,d=t.data.get(r.dataId).values,h=Ot(r.shape),p=new Float32Array(h);function g(b){const v=b%u;let w=b-v+Math.max(0,v-a);const x=b-v+Math.min(v+a,f);let S=0;for(;w<=x;w++){const C=d[w];S+=C*C}return S}for(let b=0;b<h;b++){const v=g(b),w=d[b]*Math.pow(o+l*v,-c);p[b]=w}return t.makeTensorInfo(r.shape,r.dtype,p)}const d8e={kernelName:JT,backendName:"cpu",kernelFunc:f8e};function h8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,y:a,dy:o}=e,{depthRadius:l,bias:c,alpha:u,beta:f}=s;es(o,"LRNGrad");const d=Ot(o.shape),h=o.shape[3],p=t.data.get(o.dataId).values,g=t.data.get(r.dataId).values,b=t.data.get(a.dataId).values,v=new Float32Array(d),w=d;for(let x=0;x<w;x++){const S=x%h,C=x-S+Math.max(0,S-l),M=x-S+Math.min(h,S+l+1);let k=0;for(let E=C;E<M;E++)k+=Math.pow(g[E],2);k=u*k+c;for(let E=C;E<M;E++){let I=-2*u*f*g[E]*b[x]/k;x===E&&(I+=Math.pow(k,-f)),I*=p[x],v[E]+=I}}return t.makeTensorInfo(o.shape,r.dtype,v)}const p8e={kernelName:hD,backendName:"cpu",kernelFunc:h8e};function Ece(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:a,keepDims:o}=s,l=t;let c=r.shape;const u=c.length,f=dr(a,c);let d=f;const h=no(d,u);let p=l.data.get(r.dataId).values;if(h!=null){const C=new Array(u);for(let M=0;M<C.length;M++)C[M]=c[h[M]];p=j9(p,c,r.dtype,h,C),d=jo(d.length,u),c=C}es(r,"max"),yc("max",d,u);const[g,b]=Wl(c,d),v=Ot(b),w=Vle(p,v,g,r.dtype),x=l.write(w,g,r.dtype);let S=g;return o&&(S=$o(g,f)),{dataId:x,shape:S,dtype:r.dtype}}const m8e={kernelName:ZT,backendName:"cpu",kernelFunc:Ece};function g8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;es(r,"maxPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;we(gc(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=vh(r.shape,a,o,u,l,c);let d;if(f.filterWidth===1&&f.filterHeight===1&&xr(f.inShape,f.outShape))d=$m({inputs:{x:r},backend:t});else{const h=t.data.get(r.dataId).values,p=gs(r.shape),g=z9(h,r.shape,r.dtype,p,f,"max");d=t.makeTensorInfo(f.outShape,r.dtype,g.values)}return d}const y8e={kernelName:ek,backendName:"cpu",kernelFunc:g8e};function b8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=s;es(r,"maxPool3d");const f=Gg(r.shape,a,o,1,l,c,u),d=t.data.get(r.dataId).values,h=Sce(d,r.shape,r.dtype,gs(r.shape),f,"max");return t.makeTensorInfo(h.shape,"float32",h.values)}const w8e={kernelName:tk,backendName:"cpu",kernelFunc:b8e};function v8e(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=s;es([r,a],"maxPool3DGrad");const f=Gg(a.shape,o,l,1,c,u),d=t.bufferSync(a),h=lze(d,f),p=f.strideDepth,g=f.strideHeight,b=f.strideWidth,v=f.dilationDepth,w=f.dilationHeight,x=f.dilationWidth,S=f.effectiveFilterDepth,C=f.effectiveFilterHeight,M=f.effectiveFilterWidth,k=S-1-f.padInfo.front,E=M-1-f.padInfo.left,I=C-1-f.padInfo.top,A=tr(a.shape,"float32"),D=t.bufferSync(r);for(let L=0;L<f.batchSize;++L)for(let P=0;P<f.inChannels;++P)for(let j=0;j<f.inDepth;++j)for(let G=0;G<f.inHeight;++G)for(let Q=0;Q<f.inWidth;++Q){const q=j-k,te=G-I,Z=Q-E;let ne=0;for(let le=0;le<S;le+=v){const H=(q+le)/p;if(!(H<0||H>=f.outDepth||Math.floor(H)!==H))for(let R=0;R<C;R+=w){const B=(te+R)/g;if(!(B<0||B>=f.outHeight||Math.floor(B)!==B))for(let W=0;W<M;W+=x){const se=(Z+W)/b;if(se<0||se>=f.outWidth||Math.floor(se)!==se)continue;const ue=S*C*M-1-h.get(L,H,B,se,P),ge=le*C*M+R*M+W,Ce=ue===ge?1:0;if(Ce===0)continue;const Se=D.get(L,H,B,se,P);ne+=Se*Ce}}}A.set(ne,L,j,G,Q,P)}return t.makeTensorInfo(A.shape,A.dtype,A.values)}const _8e={kernelName:mD,backendName:"cpu",kernelFunc:v8e};function x8e(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a,output:o}=e,l=a;es([a,o],"maxPoolGrad");const{filterSize:c,strides:u,pad:f,dimRoundingMode:d}=s,h=vh(l.shape,c,u,1,f,d),p=t.data.get(l.dataId).values,g=tr(h.outShape,l.dtype,Cce(p,l.shape,l.dtype,h).values),b=h.strideHeight,v=h.strideWidth,w=h.dilationHeight,x=h.dilationWidth,S=h.effectiveFilterHeight,C=h.effectiveFilterWidth,M=C-1-h.padInfo.left,k=S-1-h.padInfo.top,E=tr(l.shape,"float32"),I=t.data.get(r.dataId).values,A=tr(r.shape,"float32",I);for(let D=0;D<h.batchSize;++D)for(let L=0;L<h.inChannels;++L)for(let P=0;P<h.inHeight;++P)for(let j=0;j<h.inWidth;++j){const G=P-k,Q=j-M;let q=0;for(let te=0;te<S;te+=w){const Z=(G+te)/b;if(!(Z<0||Z>=h.outHeight||Math.floor(Z)!==Z))for(let ne=0;ne<C;ne+=x){const le=(Q+ne)/v;if(le<0||le>=h.outWidth||Math.floor(le)!==le)continue;const H=S*C-1-g.get(D,Z,le,L),R=te*C+ne,B=H===R?1:0;if(B===0)continue;const W=A.get(D,Z,le,L);q+=W*B}}E.set(q,D,P,j,L)}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const C8e={kernelName:pD,backendName:"cpu",kernelFunc:x8e};function S8e(n,e,t,s,r){const a=gs(e),o=z9(n,e,t,a,r,"max"),l=Cce(n,e,t,r,!0,s);return[o.values,l.values]}const M8e={kernelName:gD,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:a,pad:o,includeBatchInIndex:l}=e,c=t;es(s,"MaxPoolWithArgmax");const u=c.data.get(s.dataId).values,f=vh(s.shape,r,a,[1,1],o),[d,h]=S8e(u,s.shape,s.dtype,l,f),p=c.write(d,f.outShape,s.dtype),g=c.write(h,f.outShape,s.dtype);return[{dataId:p,shape:f.outShape,dtype:s.dtype},{dataId:g,shape:f.outShape,dtype:"int32"}]}};function T8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s,l=dr(a,r.shape),u=Wl(r.shape,l)[1],f=Ot(u),d=[],h=t.makeTensorInfo([],"float32",new Float32Array([f]));d.push(h);const p=b1({inputs:{x:r},backend:t,attrs:{dtype:"float32"}});d.push(p);const g=B9({inputs:{a:p,b:h},backend:t});d.push(g);const b=oE({inputs:{x:g},backend:t,attrs:{axis:a,keepDims:o}});return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),b}const k8e={kernelName:nk,backendName:"cpu",kernelFunc:T8e};function E8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s;es(r,"min");const l=dr(a,r.shape);let c=l;const u=no(c,r.shape.length);let f=r;u!=null&&(f=Qu({inputs:{x:r},backend:t,attrs:{perm:u}}),c=jo(c.length,r.shape.length)),yc("min",c,f.shape.length);const[d,h]=Wl(f.shape,c),p=Ot(h),g=hc(Ot(d),f.dtype),b=t.data.get(f.dataId).values;for(let w=0;w<g.length;++w){const x=w*p;let S=b[x];for(let C=0;C<p;++C){const M=b[x+C];(Number.isNaN(M)||M<S)&&(S=M)}g[w]=S}u!=null&&t.disposeIntermediateTensorInfo(f);const v=t.makeTensorInfo(d,f.dtype,g);if(o){const w=$o(d,l),x=ba({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),x}return v}const I8e={kernelName:sk,backendName:"cpu",kernelFunc:E8e};function A8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:a,mode:o}=s;es(r,"mirrorPad");const l=a.map((S,C)=>S[0]+r.shape[C]+S[1]),c=a.map(S=>S[0]),u=a.map((S,C)=>S[0]+r.shape[C]),f=o==="reflect"?0:1,d=t.data.get(r.dataId).values,h=r.shape.length,p=gs(r.shape),g=Ot(l),b=l.length,v=gs(l),w=Bl(r.dtype,g);for(let S=0;S<g;S++){let C=qb(S,b,v);for(let k=0;k<b;k++)C[k]<c[k]?C[k]=c[k]*2-C[k]-f:C[k]>=u[k]&&(C[k]=(u[k]-1)*2-C[k]+f);C=C.map((k,E)=>k-c[E]);const M=op(C,h,p);w[S]=d[M]}return{dataId:t.write(w,l,r.dtype),shape:l,dtype:r.dtype}}const L8e={kernelName:rk,backendName:"cpu",kernelFunc:A8e};const N8e=Fo(((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e})),D8e=Sl(p_,N8e),O8e={kernelName:p_,backendName:"cpu",kernelFunc:D8e};function Ice(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:a}=s,o=r.shape.length;let l=a;if(l===-1&&(l=o-1),l!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${l}`);const c=dr([l],r.shape),u=Ece({inputs:{x:r},backend:t,attrs:{reductionIndices:c,keepDims:!1}}),f=$o(u.shape,c),d=ba({inputs:{x:u},backend:t,attrs:{shape:f}}),h=F9({inputs:{a:r,b:d},backend:t}),p=Lle({inputs:{x:h},backend:t}),g=oE({inputs:{x:p},backend:t,attrs:{axis:c,keepDims:!1}}),b=ba({inputs:{x:g},backend:t,attrs:{shape:f}}),v=B9({inputs:{a:p,b},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),v}const P8e={kernelName:xk,backendName:"cpu",kernelFunc:Ice};function $8e(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:a,seed:o,normalized:l}=s;es(r,"multinomial");const c=l?r:Ice({inputs:{logits:r},backend:t,attrs:{dim:-1}}),u=c.shape[0],f=c.shape[1],d=t.data.get(c.dataId).values,h=[u,a],p=hc(Ot(h),"int32");for(let g=0;g<u;++g){const b=g*f,v=new Float32Array(f-1);v[0]=d[b];for(let S=1;S<v.length;++S)v[S]=v[S-1]+d[b+S];const w=B_.alea(o.toString()),x=g*a;for(let S=0;S<a;++S){const C=w();p[x+S]=v.length;for(let M=0;M<v.length;M++)if(C<v[M]){p[x+S]=M;break}}}return l||t.disposeIntermediateTensorInfo(c),t.makeTensorInfo(h,"int32",p)}const j8e={kernelName:yD,backendName:"cpu",kernelFunc:$8e};const R8e=MO;function F8e(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=s;es(r,"NonMaxSuppression");const u=t.data.get(r.dataId).values,f=t.data.get(a.dataId).values,{selectedIndices:d}=R8e(u,f,o,l,c);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const z8e={kernelName:bD,backendName:"cpu",kernelFunc:F8e};const B8e=TO;function U8e(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=s;es(r,"NonMaxSuppressionPadded");const f=t.data.get(r.dataId).values,d=t.data.get(a.dataId).values,{selectedIndices:h,validOutputs:p}=B8e(f,d,o,l,c,u);return[t.makeTensorInfo([h.length],"int32",new Int32Array(h)),t.makeTensorInfo([],"int32",new Int32Array([p]))]}const V8e={kernelName:wD,backendName:"cpu",kernelFunc:U8e};const W8e=kO;function G8e(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=s;es(r,"NonMaxSuppressionWithScore");const f=t.data.get(r.dataId).values,d=t.data.get(a.dataId).values,h=o,p=l,g=c,b=u,{selectedIndices:v,selectedScores:w}=W8e(f,d,h,p,g,b);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const H8e={kernelName:vD,backendName:"cpu",kernelFunc:G8e};function q8e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:a,depth:o,onValue:l,offValue:c}=s;es(r,"oneHot");const u=Ot(r.shape),f=new Float32Array(u*o);f.fill(c);const d=t.data.get(r.dataId).values;for(let h=0;h<u;++h)d[h]>=0&&d[h]<o&&(f[h*o+d[h]]=l);return t.makeTensorInfo([...r.shape,o],a,f)}const Y8e={kernelName:lk,backendName:"cpu",kernelFunc:q8e};function qN(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=kb({inputs:{input:s},backend:t}),a=qN({inputs:{x:r},backend:t}),o=b2({inputs:{input:s},backend:t}),l=qN({inputs:{x:o},backend:t}),c=_f({inputs:{real:a,imag:l},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}else return U9({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const K8e={kernelName:Tk,backendName:"cpu",kernelFunc:qN};function Ace(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=kb({inputs:{input:s},backend:t}),a=Ace({inputs:{x:r},backend:t}),o=b2({inputs:{input:s},backend:t}),l=qN({inputs:{x:o},backend:t}),c=_f({inputs:{real:a,imag:l},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}else return U9({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const X8e={kernelName:ok,backendName:"cpu",kernelFunc:Ace};function Lce(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return HN({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const a=e[0].shape,o=e[0].dtype;e.forEach(f=>{mc(a,f.shape,"All tensors passed to stack must have matching shapes"),we(o===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],c=e.map(f=>{const d=HN({inputs:{input:f},backend:t,attrs:{dim:r}});return l.push(d),d}),u=w2({inputs:c,backend:t,attrs:{axis:r}});return l.forEach(f=>t.disposeIntermediateTensorInfo(f)),u}const Q8e={kernelName:ck,backendName:"cpu",kernelFunc:Lce};function J8e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:a,constantValue:o}=s;es(r,"pad");const l=a.map((x,S)=>x[0]+r.shape[S]+x[1]),c=a.map(x=>x[0]),u=t.data.get(r.dataId).values,f=Ot(r.shape),d=r.shape.length,h=gs(r.shape),p=Ot(l),g=l.length,b=gs(l),v=Bl(r.dtype,p);o!==0&&v.fill(o);for(let x=0;x<f;x++){const C=qb(x,d,h).map((k,E)=>k+c[E]),M=op(C,g,b);v[M]=u[x]}return{dataId:t.write(v,l,r.dtype),shape:l,dtype:r.dtype}}const Nce={kernelName:uk,backendName:"cpu",kernelFunc:J8e};const Z8e=Fo((n,e)=>Math.pow(n,e)),e9e=Sl(g_,Z8e),t9e={kernelName:g_,backendName:"cpu",kernelFunc:e9e};function n9e(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:o}=e,{outputRaggedRank:l}=s,c=r.map(w=>t.data.get(w.dataId).values),u=r.map(w=>w.shape),f=t.data.get(a.dataId).values,d=t.data.get(o.dataId).values,[h,p,g]=Kle(c,u,f,a.shape,a.dtype,d,o.shape),b=h.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(g,a.dtype,p);return b.concat([v])}const s9e={kernelName:_D,backendName:"cpu",kernelFunc:n9e};function r9e(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:a}=e,o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,[u,f]=Xle(o,s.shape,s.dtype,l,r.shape,c,a.shape),d=t.makeTensorInfo([u.length],"int32",u),h=t.makeTensorInfo([f.length],s.dtype,f);return[d,h]}const i9e={kernelName:xD,backendName:"cpu",kernelFunc:r9e};function a9e(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:a,defaultValue:o,rowPartitionTensors:l}=e,{rowPartitionTypes:c}=s,u=t.data.get(r.dataId).values,f=t.data.get(a.dataId).values,d=t.data.get(o.dataId).values,h=l.map(v=>t.data.get(v.dataId).values),p=l.map(v=>v.shape),[g,b]=Qle(u,r.shape,f,a.shape,a.dtype,d,o.shape,h,p,c);return t.makeTensorInfo(g,a.dtype,b)}const o9e={kernelName:CD,backendName:"cpu",kernelFunc:a9e};function l9e(n){const{backend:e,attrs:t}=n,{start:s,stop:r,dtype:a,step:o}=t,l=Jle(s,r,o,a);return e.makeTensorInfo([l.length],a,l)}const c9e={kernelName:SD,backendName:"cpu",kernelFunc:l9e};const u9e=Fi(y_,n=>1/n),f9e={kernelName:y_,backendName:"cpu",kernelFunc:u9e};function d9e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s;es(r,"resizeBilinear");const c=gs(r.shape),[u,f]=l,[d,h,p,g]=r.shape,b=t.data.get(r.dataId).values,v=new Float32Array(Ot([d,u,f,g])),w=[a&&u>1?h-1:h,a&&f>1?p-1:p],x=[a&&u>1?u-1:u,a&&f>1?f-1:f];let S=0;const C=w[0]/x[0],M=w[1]/x[1];for(let k=0;k<d;k++)for(let E=0;E<u;E++){let I;o?I=C*(E+.5)-.5:I=C*E;const A=Math.max(0,Math.floor(I)),D=I-A,L=Math.min(h-1,Math.ceil(I)),P=k*c[0]+A*c[1],j=k*c[0]+L*c[1];for(let G=0;G<f;G++){let Q;o?Q=M*(G+.5)-.5:Q=M*G;const q=Math.max(0,Math.floor(Q)),te=Q-q,Z=Math.min(p-1,Math.ceil(Q)),ne=P+q*c[2],le=j+q*c[2],H=P+Z*c[2],R=j+Z*c[2];for(let B=0;B<g;B++){const W=b[ne+B],se=b[le+B],ue=b[H+B],ge=b[R+B],Ce=W+(ue-W)*te,Se=se+(ge-se)*te,Me=Ce+(Se-Ce)*D;v[S++]=Me}}}return t.makeTensorInfo([d,u,f,g],"float32",v)}const h9e={kernelName:mk,backendName:"cpu",kernelFunc:d9e};function p9e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:o}=s;es([a,r],"resizeBilinearGrad");const l=gs(r.shape),[c,u,f,d]=r.shape,[,h,p]=a.shape,g=new Float32Array(c*u*f*d),b=[o&&h>1?u-1:u,o&&p>1?f-1:f],v=[o&&h>1?h-1:h,o&&p>1?p-1:p],w=b[0]/v[0],x=b[1]/v[1],S=t.data.get(a.dataId).values;let C=0;for(let M=0;M<c;M++){const k=M*l[0];for(let E=0;E<h;E++){const I=E*w,A=Math.floor(I),D=Math.min(Math.ceil(I),u-1),L=k+A*l[1],P=k+D*l[1],j=I-A,G=1-j;for(let Q=0;Q<p;Q++){const q=Q*x,te=Math.floor(q),Z=Math.min(Math.ceil(q),f-1),ne=q-te,le=1-ne,H=L+te*l[2],R=L+Z*l[2],B=P+te*l[2],W=P+Z*l[2],se=G*le,ue=G*ne,ge=j*le,Ce=j*ne;for(let Se=0;Se<d;Se++){const Me=S[C++];g[H+Se]+=Me*se,g[R+Se]+=Me*ue,g[B+Se]+=Me*ge,g[W+Se]+=Me*Ce}}}}return t.makeTensorInfo([c,f,u,d],"float32",g)}const m9e={kernelName:kD,backendName:"cpu",kernelFunc:p9e};function g9e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s;es(r,"resizeNearestNeighbor");const c=gs(r.shape),[u,f]=l,[d,h,p,g]=r.shape,b=t.data.get(r.dataId).values,v=new Float32Array(d*u*f*g),w=[a&&u>1?h-1:h,a&&f>1?p-1:p],x=[a&&u>1?u-1:u,a&&f>1?f-1:f],S=w[0]/x[0],C=w[1]/x[1];let M=0;for(let k=0;k<d;k++){const E=k*c[0];for(let I=0;I<u;I++){const A=o?S*(I+.5):S*I;let D=Math.min(h-1,a?Math.round(A):Math.floor(A));o&&(D=Math.max(0,D));const L=E+D*c[1];for(let P=0;P<f;P++){const j=o?C*(P+.5):C*P;let G=Math.min(p-1,a?Math.round(j):Math.floor(j));o&&(G=Math.max(0,G));const Q=L+G*c[2];for(let q=0;q<g;q++){const te=b[Q+q];v[M++]=te}}}}return t.makeTensorInfo([d,u,f,g],r.dtype,v)}const y9e={kernelName:pk,backendName:"cpu",kernelFunc:g9e};function b9e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:o}=s;es([a,r],"resizeNearestNeighborGrad");const l=gs(r.shape),c=gs(a.shape),[u,f,d,h]=r.shape,[,p,g]=a.shape,b=new Float32Array(u*f*d*h),v=t.data.get(a.dataId).values,w=[o&&p>1?f-1:f,o&&g>1?d-1:d],x=[o&&p>1?p-1:p,o&&g>1?g-1:g],S=w[0]/x[0],C=w[1]/x[1],M=1/S,k=1/C,E=Math.ceil(M)*2+2,I=Math.ceil(k)*2+2;for(let A=0;A<u;A++){const D=A*l[0];for(let L=0;L<f;L++){const P=D+L*l[1],j=Math.floor(L*M),G=Math.floor(j-E/2);for(let Q=0;Q<d;Q++){const q=P+Q*l[2],te=Math.floor(Q*k),Z=Math.floor(te-I/2);for(let ne=0;ne<h;ne++){let le=0;for(let H=0;H<E;H++){const R=H+G;if(R<0||R>=p)continue;const B=D+R*c[1],W=R*S,se=Math.min(f-1,o?Math.round(W):Math.floor(W));if(L===se)for(let ue=0;ue<I;ue++){const ge=ue+Z;if(ge<0||ge>=g)continue;const Ce=B+ge*c[2],Se=ge*C,Me=Math.min(d-1,o?Math.round(Se):Math.floor(Se));Q===Me&&(le+=v[Ce+ne])}}b[q+ne]=le}}}}return t.makeTensorInfo(r.shape,r.dtype,b)}const w9e={kernelName:TD,backendName:"cpu",kernelFunc:b9e};function v9e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:a}=s;es(r,"reverse");const o=r.shape.length,l=dr(a,r.shape);if(o===0)return $m({inputs:{x:r},backend:t});const c=new el(r.shape,r.dtype),u=t.bufferSync(r);for(let f=0;f<c.size;f++){const d=c.indexToLoc(f),h=d.slice();l.forEach(p=>h[p]=r.shape[p]-1-h[p]),c.set(u.get(...h),...d)}return t.makeTensorInfo(c.shape,c.dtype,c.values)}const _9e={kernelName:gk,backendName:"cpu",kernelFunc:v9e};const x9e={kernelName:WD,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:a,center:o}=e,l=t,c=Bl(s.dtype,Ot(s.shape)),[u,f,d,h]=s.shape,[p,g]=OB(o,f,d),b=255,v=Math.sin(r),w=Math.cos(r),x=l.data.get(s.dataId).values;for(let C=0;C<u;C++){const M=C*d*f*h;for(let k=0;k<f;k++){const E=k*(d*h);for(let I=0;I<d;I++){const A=I*h;for(let D=0;D<h;D++){const L=[u,k,I,D],P=L[2],j=L[1];let G=(P-p)*w-(j-g)*v,Q=(P-p)*v+(j-g)*w;G=Math.round(G+p),Q=Math.round(Q+g);let q=a;if(typeof a!="number"&&(D===3?q=b:q=a[D]),G>=0&&G<d&&Q>=0&&Q<f){const Z=Q*(d*h),ne=G*h,le=M+Z+ne+D;q=x[le]}const te=M+E+A+D;c[te]=q}}}}return{dataId:l.write(c,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};const C9e=Fi(v_,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),S9e={kernelName:v_,backendName:"cpu",kernelFunc:C9e};function M9e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:a}=e,{shape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:f,outputSize:d}=A1(a,r,o),h=!0,p=t.bufferSync(r),g=t.bufferSync(a),b=qy(p,g,o,d,u,c,l,f,0,h);return t.makeTensorInfo(o,b.dtype,b.values)}const T9e={kernelName:ED,backendName:"cpu",kernelFunc:M9e};function k9e(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<e?t=r+1:s=r;return s}function E9e(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<=e?t=r+1:s=r;return s}function I9e(n,e,t,s,r,a){const o=po("int32",t*r);for(let l=0;l<t;++l){const c=n.slice(l*s,(l+1)*s),u=l*r;for(let f=0;f<r;++f)o[u+f]=a==="left"?k9e(c,e[f+u]):E9e(c,e[f+u])}return o}function A9e(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:a}=e,{side:o}=s,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,u=I9e(l,c,r.shape[0],r.shape[1],a.shape[1],o);return t.makeTensorInfo(a.shape,"int32",u)}const L9e={kernelName:AD,backendName:"cpu",kernelFunc:A9e};function N9e(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:a}=e;es([s,r,a],"select");const o=s.shape.length,l=t.data.get(s.dataId).values,c=t.data.get(r.dataId).values,u=t.data.get(a.dataId).values,f=Hu(r.dtype,a.dtype),d=hc(Ot(r.shape),f);let h=0;const p=o===0||o>1||r.shape.length===1?1:Ot(r.shape.slice(1));for(let g=0;g<l.length;g++)for(let b=0;b<p;b++)l[g]===1?d[h++]=c[g]:d[h++]=u[g];return t.makeTensorInfo(r.shape,f,d)}const D9e={kernelName:yk,backendName:"cpu",kernelFunc:N9e};const O9e=NO,P9e=DO,$9e=Fi(x_,n=>n>=0?P9e*n:O9e*(Math.exp(n)-1)),j9e={kernelName:x_,backendName:"cpu",kernelFunc:$9e};const R9e=Fi(M_,n=>n<0?-1:n>0?1:0),F9e={kernelName:M_,backendName:"cpu",kernelFunc:R9e};const z9e=Fi(C_,n=>Math.sin(n)),B9e={kernelName:C_,backendName:"cpu",kernelFunc:z9e};const U9e=Fi(S_,n=>Math.sinh(n)),V9e={kernelName:S_,backendName:"cpu",kernelFunc:U9e};const W9e=11920928955078125e-23,oq=Math.log(W9e)+2,G9e=Fi(k_,n=>{const e=n>-oq,t=n<oq,s=Math.exp(n);let r;return t?r=s:e?r=n:r=Math.log(1+s),r}),H9e={kernelName:k_,backendName:"cpu",kernelFunc:G9e};function q9e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,paddings:o}=s;es([r],"spaceToBatchND");const l=Ot(a),c=[[0,0]];c.push(...o);for(let k=1+a.length;k<r.shape.length;++k)c.push([0,0]);const u=Nce.kernelFunc({inputs:{x:r},backend:t,attrs:{paddings:c,constantValue:0}}),f=qk(u.shape,a,l,!1),d=Yk(f.length,a.length,!1),h=Kk(u.shape,a,l,!1),b=ba({inputs:{x:u},backend:t,attrs:{shape:f}}),x=Qu({inputs:{x:b},backend:t,attrs:{perm:d}}),M=ba({inputs:{x},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(x),M}const Y9e={kernelName:vk,backendName:"cpu",kernelFunc:q9e};function K9e(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:a,defaultValue:o}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const l=t.data.get(s.dataId).values,c=t.data.get(r.dataId).values,u=t.data.get(a.dataId).values,f=t.data.get(o.dataId).values[0],[d,h,p,g,b]=nce(l,s.shape,s.dtype,c,r.dtype,u,f);return[t.makeTensorInfo(h,s.dtype,d),t.makeTensorInfo([h[0]],r.dtype,p),t.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(v=>Number(v)))),t.makeTensorInfo([b.length],s.dtype,new Int32Array(b))]}const X9e={kernelName:LD,backendName:"cpu",kernelFunc:K9e};function Q9e(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(t.data.get(r.dataId).values),l=t.data.get(s.dataId).values,c=Array.from(t.data.get(a.dataId).values),[u,f,d]=sce(l,s.shape,s.dtype,o,c);return[t.makeTensorInfo(f,s.dtype,u),t.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const J9e={kernelName:ND,backendName:"cpu",kernelFunc:Q9e};function Z9e(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,[u,f]=R9(o,s.shape,s.dtype,l,c,!0);return t.makeTensorInfo(f,s.dtype,u)}const eUe={kernelName:DD,backendName:"cpu",kernelFunc:Z9e};function tUe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,[u,f]=R9(o,s.shape,s.dtype,l,c);return t.makeTensorInfo(f,s.dtype,u)}const nUe={kernelName:OD,backendName:"cpu",kernelFunc:tUe};function sUe(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:o}=e,{outputShape:l}=s,{sliceRank:c,numUpdates:u,sliceSize:f,strides:d,outputSize:h}=A1(a,r,l),p=!1,g=t.bufferSync(r);let b;switch(a.dtype){case"bool":{const v=t.bufferSync(a),w=!!t.data.get(o.dataId).values[0];b=qy(g,v,l,h,f,u,c,d,w,p);break}case"float32":{const v=t.bufferSync(a),w=t.data.get(o.dataId).values[0];b=qy(g,v,l,h,f,u,c,d,w,p);break}case"int32":{const v=t.bufferSync(a),w=t.data.get(o.dataId).values[0];b=qy(g,v,l,h,f,u,c,d,w,p);break}case"string":{const v=t.bufferSync(a),w=Og(t.data.get(o.dataId).values[0]);b=qy(g,v,l,h,f,u,c,d,w,p);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return t.makeTensorInfo(l,b.dtype,b.values)}const rUe={kernelName:PD,backendName:"cpu",kernelFunc:sUe};function iUe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:a,axis:o}=s,l=dr(o,r.shape)[0],c=KB(r,a,l),u=new Array(r.shape.length).fill(0),f=r.shape.slice();return c.map(d=>{const h=[...f];h[l]=d;const p=Eb({inputs:{x:r},backend:t,attrs:{begin:u,size:h}});return u[l]+=d,p})}const aUe={kernelName:_k,backendName:"cpu",kernelFunc:iUe};const oUe={kernelName:$D,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;es(t,"square");const r=s.data.get(t.dataId).values,a=new Float32Array(r.length);for(let l=0;l<r.length;++l){const c=r[l];a[l]=c*c}return{dataId:s.write(a,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};const lUe=Fi(O_,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),cUe={kernelName:O_,backendName:"cpu",kernelFunc:lUe};function uUe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:f,newAxisMask:d,shrinkAxisMask:h}=s;es(r,"stridedSlice");const{finalShapeSparse:p,finalShape:g,isIdentity:b,sliceDim0:v,isSimpleSlice:w,begin:x,end:S,strides:C}=AB(r.shape,a,o,l,c,u,f,d,h);let M;if(b)M=ba({inputs:{x:r},backend:t,attrs:{shape:g}});else if(v||w){we(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=kB(x,S,C),E=Eb({inputs:{x:r},backend:t,attrs:{begin:x,size:k}});M=ba({inputs:{x:E},backend:t,attrs:{shape:g}}),t.disposeIntermediateTensorInfo(E)}else{const k=t.bufferSync(r),E=ace(p,k,C,x);M=t.makeTensorInfo(g,E.dtype,E.values)}return M}const fUe={kernelName:jD,backendName:"cpu",kernelFunc:uUe};function dUe(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:o,rightPad:l,padWidth:c,preserveShortSequences:u}=s,{data:f,dataSplits:d}=e,h=t.data.get(f.dataId).values,p=t.data.get(d.dataId).values,[g,b]=oce(h,p,r,a,o,l,c,u);return[t.makeTensorInfo([g.length],"string",g),t.makeTensorInfo(d.shape,"int32",b)]}const hUe={kernelName:RD,backendName:"cpu",kernelFunc:dUe};function pUe(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:o}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const l=t.data.get(a.dataId).values,c=t.data.get(o.dataId).values[0],[u,f,d]=lce(l,c,r),h=f.length;return[t.makeTensorInfo([h,2],"int32",u),t.makeTensorInfo([h],"string",f),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const mUe={kernelName:FD,backendName:"cpu",kernelFunc:pUe};function gUe(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=t.data.get(a.dataId).values,l=cce(o,r);return t.makeTensorInfo(a.shape,"int32",l)}const yUe={kernelName:zD,backendName:"cpu",kernelFunc:gUe};const bUe=Fi(L_,n=>Math.tan(n)),wUe={kernelName:L_,backendName:"cpu",kernelFunc:bUe};const vUe=Fi(N_,n=>Math.tanh(n)),_Ue={kernelName:N_,backendName:"cpu",kernelFunc:vUe};function xUe(n){const{inputs:e,backend:t}=n,{tensor:s,indices:r,updates:a}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:f}=A1(a,r,s.shape),d=!1,h=t.bufferSync(r),p=t.bufferSync(a),g=t.bufferSync(s),b=qy(h,p,s.shape,f,c,l,o,u,g,d);return t.makeTensorInfo(s.shape,b.dtype,b.values)}const CUe={kernelName:ID,backendName:"cpu",kernelFunc:xUe};function SUe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:a}=s;es(r,"tile");const o=fce(t.bufferSync(r),a);return t.makeTensorInfo(o.shape,o.dtype,o.values)}const MUe={kernelName:D_,backendName:"cpu",kernelFunc:SUe};function TUe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:a,sorted:o}=s;es(r,"topk");const l=t.data.get(r.dataId).values,[c,u]=hce(l,r.shape,r.dtype,a,o);return[t.makeTensorInfo(c.shape,c.dtype,c.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const kUe={kernelName:BD,backendName:"cpu",kernelFunc:TUe};function EUe(n){const{inputs:e,attrs:t,backend:s}=n,{image:r,transforms:a}=e,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=t,[f,d,h,p]=r.shape,[g,b]=u??[d,h],v=[f,g,b,p],w=gs(r.shape),x=w[0],S=w[1],C=w[2],M=gs(v),k=M[0],E=M[1],I=M[2],A=Bl(r.dtype,Ot(v));A.fill(c);const D=s.data.get(r.dataId).values,L=s.data.get(a.dataId).values;for(let j=0;j<f;++j){const G=a.shape[0]===1?L:L.subarray(j*8,j*8+8);for(let Q=0;Q<g;++Q)for(let q=0;q<b;++q)for(let te=0;te<p;++te){let Z;const ne=G[6]*q+G[7]*Q+1;if(ne===0)continue;const le=(G[0]*q+G[1]*Q+G[2])/ne,H=(G[3]*q+G[4]*Q+G[5])/ne,R=lq(le,h,l),B=lq(H,d,l);switch(o){case"nearest":Z=OUe(D,d,h,x,S,C,j,B,R,te,c);break;case"bilinear":Z=PUe(D,d,h,x,S,C,j,B,R,te,c);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const W=j*k+Q*E+q*I+te;A[W]=Z}return s.makeTensorInfo(v,r.dtype,A)}return{dataId:s.write(A,v,r.dtype),shape:r.shape,dtype:r.dtype}}const IUe={kernelName:UD,backendName:"cpu",kernelFunc:EUe};function lq(n,e,t){switch(t){case"reflect":return AUe(n,e);case"wrap":return LUe(n,e);case"nearest":return DUe(n,e);default:return NUe(n)}}function AUe(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return u1(0,t,e-1)}function LUe(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return u1(0,t,e-1)}function NUe(n,e){return n}function DUe(n,e){return u1(0,n,e-1)}function VS(n,e,t,s,r,a,o,l,c,u,f){const d=o*s+l*r+c*a+u;return 0<=l&&l<e&&0<=c&&c<t?n[d]:f}function OUe(n,e,t,s,r,a,o,l,c,u,f){const d=Math.round(l),h=Math.round(c);return VS(n,e,t,s,r,a,o,d,h,u,f)}function PUe(n,e,t,s,r,a,o,l,c,u,f){const d=Math.floor(l),h=Math.floor(c),p=d+1,g=h+1,b=(g-c)*VS(n,e,t,s,r,a,o,d,h,u,f)+(c-h)*VS(n,e,t,s,r,a,o,d,g,u,f),v=(g-c)*VS(n,e,t,s,r,a,o,p,h,u,f)+(c-h)*VS(n,e,t,s,r,a,o,p,g,u,f);return(p-l)*b+(l-d)*v}function $Ue(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:a}=e;es(a,"unique");const o=s.data.get(a.dataId).values,{outputValues:l,outputShape:c,indices:u}=pce(o,r,a.shape,a.dtype);return[s.makeTensorInfo(c,a.dtype,l),s.makeTensorInfo([u.length],"int32",u)]}const jUe={kernelName:VD,backendName:"cpu",kernelFunc:$Ue};function RUe(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const o=r.shape.length,l=r.shape[a],c=new Array(o-1);let u=0;for(let p=0;p<o;p++)p!==a&&(c[u++]=r.shape[p]);const f=new Array(o).fill(0),d=r.shape.slice();d[a]=1;const h=new Array(l);for(let p=0;p<h.length;p++){f[a]=p;const g=Eb({inputs:{x:r},backend:t,attrs:{begin:f,size:d}});h[p]=ba({inputs:{x:g},backend:t,attrs:{shape:c}}),t.disposeIntermediateTensorInfo(g)}return h}const FUe={kernelName:Sk,backendName:"cpu",kernelFunc:RUe};function zUe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:a}=e,{numSegments:o}=s;es(r,"unsortedSegmentSum");const l=r.shape.length,c=a.shape.length,u=[],f=[],d=l-c;let h=a;for(let g=0;g<d;++g){const b=HN({inputs:{input:h},backend:t,attrs:{dim:g+1}});h=b,f.push(b)}for(let g=0;g<o;++g){const b=Wg(g,"int32"),v=t.makeTensorInfo([],"int32",b),w=Ile({inputs:{a:v,b:h},backend:t}),x=b1({inputs:{x:w},backend:t,attrs:{dtype:"float32"}}),S=tP({inputs:{a:x,b:r},backend:t}),C=oE({inputs:{x:S},backend:t,attrs:{axis:0,keepDims:!1}});u.push(C),f.push(v),f.push(w),f.push(x),f.push(S),f.push(C)}const p=Lce({inputs:u,backend:t,attrs:{axis:0}});return f.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}const BUe={kernelName:Mk,backendName:"cpu",kernelFunc:zUe};const UUe=[$Fe,y6e,RFe,zFe,C6e,UFe,WFe,HFe,YFe,XFe,JFe,eze,nze,ize,oze,uze,dze,pze,gze,OFe,bze,vze,xze,M6e,Sze,_6e,k6e,Tze,b6e,Eze,Aze,Lze,Dze,Pze,jze,Fze,Bze,Vze,Gze,qze,Kze,Qze,Zze,tBe,nBe,rBe,aBe,lBe,cBe,uBe,fBe,hBe,gBe,kFe,bBe,E6e,TBe,I6e,kBe,L6e,DBe,OBe,$Be,D6e,P6e,RBe,zBe,UBe,WBe,j6e,F6e,w6e,HBe,Ize,YBe,XBe,JBe,EFe,B6e,V6e,e8e,G6e,n8e,i8e,o8e,u8e,d8e,p8e,m8e,q6e,y8e,w8e,_8e,C8e,M8e,k8e,I8e,K6e,L8e,O8e,j8e,Q6e,Z6e,z8e,V8e,H8e,tFe,Y8e,X8e,Q8e,Nce,t9e,AFe,rFe,s9e,i9e,o9e,c9e,v6e,a6,f9e,LFe,NFe,DFe,h9e,m9e,y9e,w9e,_9e,x9e,S9e,dFe,T9e,L9e,D9e,j9e,pFe,F9e,B9e,V9e,mFe,P8e,H9e,Y9e,X9e,J9e,eUe,nUe,rUe,aUe,bFe,oUe,vFe,xFe,cUe,fUe,hUe,mUe,yUe,TFe,pBe,wUe,_Ue,CUe,MUe,kUe,IUe,nFe,jUe,FUe,BUe,K8e];for(const n of UUe)GD(n);const By={},jI={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Dce(n,e){By[n]=e}function wp(n,e){if(!(n in By)||e!=null){const s=WUe(n,e);if(s!==null)By[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=By[n];return t==null||t.isContextLost()?(delete By[n],wp(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),By[n])}function VUe(n){if(!bt().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function WUe(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??VUe(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete By[n]},!1),bt().getBool("SOFTWARE_WEBGL_ENABLED")&&(jI.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",jI)||t.getContext("experimental-webgl",jI):t.getContext("webgl2",jI)}var WM;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(WM||(WM={}));var pd;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(pd||(pd={}));var uc;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(uc||(uc={}));function lE(n,e){return[e,n]}function GUe(n,e){return n*e}function RI(n){const e=Ot(n),t=Math.ceil(e/4);return vN(t)}function K_(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function HUe(n,e){const[t,s]=K_(n,e);return t*s*4}function V9(n,e){const t=n;let s,r,a,o,l,c,u,f,d,h;return bt().getNumber("WEBGL_VERSION")===2?(s=t.R32F,r=t.R16F,a=t.RGBA16F,o=t.RGBA32F,l=t.RED,u=4,f=1,d=t.HALF_FLOAT,h=t.FLOAT,c=t.RGBA8):(s=n.RGBA,r=n.RGBA,a=n.RGBA,o=t.RGBA,l=n.RGBA,u=4,f=4,d=e!=null?e.HALF_FLOAT_OES:null,h=n.FLOAT,c=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:l,downloadTextureFormat:c,downloadUnpackNumChannels:u,defaultNumChannels:f,textureTypeHalfFloat:d,textureTypeFloat:h}}function kn(n,e){const t=e();return bt().getBool("DEBUG")&&qUe(n),t}function qUe(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+Pce(n,e))}const YUe=596e-10,KUe=65504;function Oce(n){return!!(bt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||YUe<Math.abs(n)&&Math.abs(n)<KUe)}function Pce(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function WS(n,e){return Qg(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function $ce(n,e){const t=Qg(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(kn(n,()=>n.shaderSource(t,e)),kn(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function jce(n,e){const t=Qg(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(kn(n,()=>n.shaderSource(t,e)),kn(n,()=>n.compileShader(t)),bt().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw W9(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const XUe=/ERROR: [0-9]+:([0-9]+):/g;function W9(n,e){const t=XUe.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],r=n.split(`
`),a=r.length.toString().length+2,o=r.map((d,h)=>tb((h+1).toString(),a)+d);let l=0;for(let d=0;d<o.length;d++)l=Math.max(o[d].length,l);const c=o.slice(0,s-1),u=o.slice(s-1,s),f=o.slice(s);console.log(c.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${tb(u[0],l)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join(`
`))}function Rce(n){return Qg(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function Fce(n,e){if(kn(n,()=>n.linkProgram(e)),!bt().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function kL(n,e){if(kn(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function zce(n,e){const t=Qg(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return kn(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),kn(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function Bce(n,e){const t=Qg(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return kn(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),kn(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function QUe(){return bt().getNumber("WEBGL_VERSION")===2?1:4}function Uce(n){return Qg(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function Vce(n,e){const t=bt().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,r=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function Wce(n){return Qg(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function l6(n,e,t,s,r,a,o){const l=n.getAttribLocation(e,t);return l===-1?!1:(kn(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),kn(n,()=>n.vertexAttribPointer(l,r,n.FLOAT,!1,a,o)),kn(n,()=>n.enableVertexAttribArray(l)),!0)}function Gce(n,e,t){Xce(n,t),kn(n,()=>n.activeTexture(n.TEXTURE0+t)),kn(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function JUe(n,e){Xce(n,e),kn(n,()=>n.activeTexture(n.TEXTURE0+e)),kn(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Hce(n,e,t){return Qg(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function qce(n,e,t){return n.getUniformLocation(e,t)}function Yce(n,e,t,s){kn(n,()=>Gce(n,e,s)),kn(n,()=>n.uniform1i(t,s))}function ZUe(n){kn(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,null)),kn(n,()=>n.viewport(0,0,n.canvas.width,n.canvas.height)),kn(n,()=>n.scissor(0,0,n.canvas.width,n.canvas.height))}function EL(n,e,t){kn(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),kn(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function c6(n,e){kn(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),kn(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function GS(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Kce(n,e))}function Kce(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Qg(n,e,t){const s=kn(n,()=>e());if(s==null)throw new Error(t);return s}function Xce(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const r=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Ib(n,e=2){return Ot(n.slice(0,n.length-e))}function Ab(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function HS(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Ib(n),...Ab(n)]),e}function Qce(n,e=!1){let t=bt().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=bt().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&bt().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((l,c)=>c>=n.length-2?R4(n[c]):n[c]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Vg(n).newShape);let r=Ot(n),a=null;n.length<=1&&r<=t?a=[1,r]:n.length===2&&n[0]<=t&&n[1]<=t?a=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?a=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?a=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?a=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(a=[n[0],n[1]*n[2]*n[3]]);const o=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||o)if(e){const l=Ib(n);let c=2,u=2;n.length&&([c,u]=Ab(n)),r=l*(c/2)*(u/2),a=vN(r).map(f=>f*2)}else a=vN(r);return a}function FI(n){return n%2===0}function GM(n,e){if(n=n.slice(-2),e=e.slice(-2),xr(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||FI(t)&&FI(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&FI(n[0])&&FI(e[0])}let IL,AL;function Jce(n){if(IL==null){const e=wp(n);IL=e.getParameter(e.MAX_TEXTURE_SIZE)}return IL}function e7e(){IL=null}function t7e(){AL=null}function Zce(n){if(AL==null){const e=wp(n);AL=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,AL)}function eue(n){if(n===0)return 0;let e;const t=wp(n);return md(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:md(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function md(n,e){return n.getExtension(e)!=null}function u6(n){try{if(wp(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function tue(n){if(n===0)return!1;const e=wp(n);if(n===1){if(!md(e,"OES_texture_float"))return!1}else if(!md(e,"EXT_color_buffer_float"))return!1;return f6(e)}function nue(n){if(n===0)return!1;const e=wp(n);if(n===1){if(!md(e,"OES_texture_float")||!md(e,"WEBGL_color_buffer_float"))return!1}else{if(md(e,"EXT_color_buffer_float"))return f6(e);const s="EXT_color_buffer_half_float";if(md(e,s)){const r=e.getExtension(s);return n7e(e,r)}return!1}return f6(e)}function f6(n){const e=V9(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(a),o}function n7e(n,e){const t=V9(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const l=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(o),l}function sue(n){return n!==2?!1:wp(n).fenceSync!=null}function X_(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&we(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const s7e=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:X_,bindCanvasToFramebuffer:ZUe,bindColorTextureToFramebuffer:EL,bindTextureToProgramUniformSampler:Yce,bindTextureUnit:Gce,bindVertexBufferToProgramAttribute:l6,callAndCheck:kn,canBeRepresented:Oce,createFragmentShader:jce,createFramebuffer:Wce,createProgram:Rce,createStaticIndexBuffer:Bce,createStaticVertexBuffer:zce,createTexture:Uce,createVertexShader:$ce,getBatchDim:Ib,getExtensionOrThrow:WS,getFramebufferErrorMessage:Kce,getMaxTexturesInShader:Zce,getNumChannels:QUe,getProgramUniformLocation:qce,getProgramUniformLocationOrThrow:Hce,getRowsCols:Ab,getShapeAs3D:HS,getTextureShapeFromLogicalShape:Qce,getWebGLDisjointQueryTimerVersion:eue,getWebGLErrorMessage:Pce,getWebGLMaxTextureSize:Jce,hasExtension:md,isCapableOfRenderingToFloatTexture:tue,isDownloadFloatTextureEnabled:nue,isReshapeFree:GM,isWebGLFenceEnabled:sue,isWebGLVersionEnabled:u6,linkProgram:Fce,logShaderSourceAndInfoLog:W9,resetMaxTextureSize:e7e,resetMaxTexturesInShader:t7e,unbindColorTextureFromFramebuffer:c6,unbindTextureUnit:JUe,validateFramebuffer:GS,validateProgram:kL,validateTextureSize:Vce},Symbol.toStringTag,{value:"Module"}));const ns=bt();ns.registerFlag("HAS_WEBGL",()=>ns.getNumber("WEBGL_VERSION")>0);ns.registerFlag("WEBGL_VERSION",()=>u6(2)?2:u6(1)?1:0);ns.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ns.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ns.get("WEBGL_VERSION")===2);ns.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ns.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ns.registerFlag("WEBGL_PACK",()=>ns.getBool("HAS_WEBGL"));ns.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_CLIP",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_REDUCE",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_LAZILY_UNPACK",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_CONV_IM2COL",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>ns.getBool("WEBGL_PACK"));ns.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Jce(ns.getNumber("WEBGL_VERSION")));ns.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Zce(ns.getNumber("WEBGL_VERSION")));ns.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=ns.getNumber("WEBGL_VERSION");return n===0?0:eue(n)});ns.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ns.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!nz());ns.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>tue(ns.getNumber("WEBGL_VERSION")));ns.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ns.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ns.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ns.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>nue(ns.getNumber("WEBGL_VERSION")));ns.registerFlag("WEBGL_FENCE_API_ENABLED",()=>sue(ns.getNumber("WEBGL_VERSION")));ns.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ns.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ns.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});ns.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>nz()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});ns.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ns.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ns.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ns.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ns.registerFlag("WEBGL_EXP_CONV",()=>!1);ns.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ns.getBool("IS_TEST"));ns.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ns.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ns.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);ns.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function Mu(){let n,e,t,s,r,a,o,l,c,u;return bt().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",r="texture",a="outputColor",o="out vec4 outputColor;",l=bt().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",c="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",r="texture2D",a="gl_FragColor",o="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:r,output:a,defineOutput:o,defineSpecialNaN:l,defineSpecialInf:c,defineRound:u}}function nw(n,e,t="index"){const s=gs(e);return s.map((r,a)=>{const o=`int ${n[a]} = ${t} / ${r}`,l=a===s.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${r}`:`index -= ${n[a]} * ${r}`;return`${o}; ${l};`}).join("")}function nP(n,e,t="index"){const s=gs(e);return s.map((r,a)=>{const o=`int ${n[a]} = ${t} / outShapeStrides[${a}]`,l=a===s.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * outShapeStrides[${a}]`:`index -= ${n[a]} * outShapeStrides[${a}]`;return`${o}; ${l};`}).join("")}function r7e(n,e){const t=n.length,s=n.map(a=>`${e}[${a}]`),r=new Array(t-1);r[t-2]=s[t-1];for(let a=t-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function i7e(n,e,t="index"){const s=n.map((a,o)=>o),r=r7e(s,e);return r.map((a,o)=>{const l=`int ${n[o]} = ${t} / ${r[o]}`,c=o===r.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${r[o]}`:`index -= ${n[o]} * ${r[o]}`;return`${l}; ${c};`}).join("")}function G9(n){const e=gs(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function H9(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const rue=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;const{getBroadcastDims:iue}=Dae;function a7e(n,e,t){const s=[];if(n.forEach(p=>{const g=Ot(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?s.push(`uniform float ${p.name}${g>1?`[${g}]`:""};`):(s.push(`uniform sampler2D ${p.name};`),s.push(`uniform int offset${p.name};`)),t.enableShapeUniforms){const{uniformShape:b}=q9(t.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(b.length){case 1:s.push(`uniform int ${p.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${p.name}Shape;`);break}s.push(`uniform ivec2 ${p.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(p=>{s.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const r=s.join(`
`),a=n.map(p=>o7e(p,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),o=e.texShape,l=Mu(),c=u7e(l);let u,f,d=h7e(l);return e.isPacked?(u=l7e(e.logicalShape,o,t.enableShapeUniforms),f=d7e(l)):(u=c7e(e.logicalShape,o,t.enableShapeUniforms),f=f7e(l)),t.packedInputs&&(d+=y7e),[d,c,f,r,u,a,t.userCode].join(`
`)}function Q_(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return I7e(n,e);case 1:return L7e(n,e);case 2:return D7e(n,e);case 3:return P7e(n,e);case 4:return j7e(n,e);case 5:return R7e(n);case 6:return F7e(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function aue(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return E7e(n);case 1:return A7e(n,e);case 2:return N7e(n,e);case 3:return O7e(n,e);default:return $7e(n,e)}}function o7e(n,e,t=!1,s){let r="";t?r+=aue(n,s):r+=Q_(n,s);const a=n.shapeInfo.logicalShape,o=e.logicalShape;return a.length<=o.length&&(t?r+=z7e(n,e):r+=B7e(n,e)),r}function l7e(n,e,t){switch(n.length){case 0:return oue();case 1:return b7e(n,e,t);case 2:return T7e(n,e,t);case 3:return v7e(n,e,t);default:return x7e(n,e,t)}}function c7e(n,e,t){switch(n.length){case 0:return oue();case 1:return w7e(n,e,t);case 2:return k7e(n,e,t);case 3:return _7e(n,e,t);case 4:return C7e(n,e,t);case 5:return S7e(n,e);case 6:return M7e(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function u7e(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function f7e(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function d7e(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function h7e(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${p7e}
    ${m7e}
    ${g7e}
  `}const p7e=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,m7e=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,g7e=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,y7e=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function oue(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function b7e(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function w7e(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function v7e(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[2]/2),a=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function _7e(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${nP(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=nw(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function x7e(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[n.length-1]/2),a=r*Math.ceil(n[n.length-2]/2);let o=a,l="",c="b, r, c";for(let u=2;u<n.length-1;u++)o*=n[n.length-u-1],l=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+l,c=`b${u}, `+c;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${l}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${c});
    }
  `}function C7e(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${nP(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=nw(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function S7e(n,e){const t=nw(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function M7e(n,e){const t=nw(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function T7e(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(xr(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function k7e(n,e,t){return xr(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function sw(n){return`offset${n}`}function E7e(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Mu();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function I7e(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[r,a]=n.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=sw(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${o});
      return sampleTexture(${t}, uv);
    }
  `;const[l,c]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${l}, ${c}, ${o});
      return sampleTexture(${t}, uv);
    }
  `}function A7e(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,a=Mu();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${t}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${a.texture2D}(${t}, uv);
    }
  `}function L7e(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${J_(n)}
      }
    `;const r=n.shapeInfo.texShape,a=r[0],o=r[1];if(o===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const l=sw(t);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / ${a}.0);
        return sampleTexture(${t}, uv);
      }
    `:a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${l});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${o}, index + ${l});
      return sampleTexture(${t}, uv);
    }
  `}function N7e(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,o=a[0],l=a[1],c=Mu();if(a!=null&&xr(t,a))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${c.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${o}.0);

        return ${c.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],f=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${f}, ${u[0]}, ${u[1]}, row, col);
      return ${c.texture2D}(${s}, uv);
    }
  `}function D7e(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape;if(a!=null&&xr(t,a)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=a[0],p=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:l}=Vg(t),c=o;if(c.length<t.length){const h=Z_(n,c),p=["row","col"];return`
      ${Q_(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${ex(p,l)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${J_(n)}
      }
    `;const u=a[0],f=a[1],d=sw(s);return f===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${f}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${f}, index);
    return sampleTexture(${s}, uv);
  }
`}function O7e(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(t[0]===1){const h=t.slice(1),p=[1,2],g=Z_(n,h),b=["b","row","col"];return`
        ${aue(g,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${ex(b,p)});
        }
      `}const l=Mu();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=o[0],u=o[1],f=Math.ceil(t[2]/2),d=f*Math.ceil(t[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${u}, ${d}, ${f}, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function P7e(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t[1]*t[2],o=t[2],{newShape:l,keptDims:c}=Vg(t),u=l;if(u.length<t.length){const b=Z_(n,u),v=["row","col","depth"];return`
        ${Q_(b,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${ex(v,c)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${o}, 1)));
        ${J_(n)}
      }
    `;const f=n.shapeInfo.texShape,d=f[0],h=f[1],p=n.shapeInfo.flatOffset;if(h===a&&p==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&p==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const g=sw(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${g};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${o} + depth + ${g};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function $7e(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Mu();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${t}, uv);
    }
  `;const a=n.shapeInfo.logicalShape,o=a.length,l=n.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],u=c[0],f=c[1],d=Math.ceil(a[o-1]/2);let h=d*Math.ceil(a[o-2]/2),p="int b, int row, int col",g=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let b=2;b<o-1;b++)p=`int b${b}, `+p,h*=a[o-b-1],g=`b${b} * ${h} + `+g;return`
    vec4 ${s}(${p}) {
      int index = ${g};
      int texR = index / ${f};
      int texC = index - texR * ${f};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}, ${u});
      return ${r.texture2D}(${t}, uv);
    }
  `}function j7e(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t[3],o=t[2]*a,l=t[1]*o,{newShape:c,keptDims:u}=Vg(t);if(c.length<t.length){const x=Z_(n,c),S=["row","col","depth","depth2"];return`
      ${Q_(x,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${ex(S,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${l}, ${o}, ${a}, 1)));
        ${J_(n)}
      }
    `;const f=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,h=d[0],p=d[1],g=`int stride2 = ${s}Shape[3];`,b=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(p===l&&f==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${g}
        ${b}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(p===a&&f==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=sw(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${g}
      ${b}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${o} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${h}, ${p}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function R7e(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e[4],a=e[3]*r,o=e[2]*a,l=e[1]*o,{newShape:c,keptDims:u}=Vg(e);if(c.length<e.length){const b=Z_(n,c),v=["row","col","depth","depth2","depth3"];return`
      ${Q_(b)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${ex(v,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${l}, ${o}, ${a}, ${r})) +
          depth3;
        ${J_(n)}
      }
    `;const f=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,h=d[0],p=d[1];if(p===l&&f==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(p===r&&f==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${t}, uv);
      }
    `;const g=sw(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${o} + depth * ${a} +
          depth2 * ${r} + depth3 + ${g};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${t}, uv);
    }
  `}function F7e(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:r,keptDims:a}=Vg(e);if(r.length<e.length){const v=Z_(n,r),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${Q_(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${ex(w,a)});
      }
    `}const o=e[5],l=e[4]*o,c=e[3]*l,u=e[2]*c,f=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${f}, ${u}, ${c}, ${l})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${J_(n)}
      }
    `;const d=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,p=h[0],g=h[1];if(g===f&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${c}, ${l}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(g===o&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;const b=sw(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${f} + col * ${u} + depth * ${c} +
          depth2 * ${l} + depth3 * ${o} + depth4 + ${b};
      vec2 uv = uvFromFlat(${p}, ${g}, index);
      return sampleTexture(${t}, uv);
    }
  `}function J_(n){const e=n.name,t=Ot(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function z7e(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",a=n.shapeInfo.logicalShape.length,o=e.logicalShape.length,l=iue(n.shapeInfo.logicalShape,e.logicalShape),c=qi(o),u=o-a;let f;const d=["x","y","z","w","u","v"];a===0?f="":o<2&&l.length>=1?f="coords = 0;":f=l.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let h="";o<2&&a>0?h="coords":h=n.shapeInfo.logicalShape.map((x,S)=>`coords.${d[S+u]}`).join(", ");let p="return outputValue;";const b=Ot(n.shapeInfo.logicalShape)===1,w=Ot(e.logicalShape)===1;if(a===1&&!b&&!w)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(b&&!w)o===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(l.length){const x=a-2,S=a-1;l.indexOf(x)>-1&&l.indexOf(S)>-1?p="return vec4(outputValue.x);":l.indexOf(x)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(S)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${c} coords = getOutputCoords();
      ${f}
      vec4 outputValue = get${s}(${h});
      ${p}
    }
  `}function B7e(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",a=e.texShape,o=n.shapeInfo.texShape,l=n.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!n.shapeInfo.isUniform&&l===c&&n.shapeInfo.flatOffset==null&&xr(o,a))return`
      float ${r}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=qi(c),f=iue(n.shapeInfo.logicalShape,e.logicalShape),d=c-l;let h;const p=["x","y","z","w","u","v"];l===0?h="":c<2&&f.length>=1?h="coords = 0;":h=f.map(b=>`coords.${p[b+d]} = 0;`).join(`
`);let g="";return c<2&&l>0?g="coords":g=n.shapeInfo.logicalShape.map((b,v)=>`coords.${p[v+d]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${s}(${g});
    }
  `}function qi(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function q9(n,e,t){const{newShape:s,keptDims:r}=Vg(e),a=e.length,o=n&&a===3&&e[0]===1,l=o?e.slice(1):s,c=!n&&a>1&&!xr(e,t)&&s.length<a||o;return{useSqueezeShape:c,uniformShape:c?l:e,keptDims:r}}function Z_(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function ex(n,e){return e.map(t=>n[t]).join(", ")}function U7e(n,e,t,s){const r=t.map((f,d)=>{const h={logicalShape:f.shape,texShape:f.isUniform?null:f.texData.texShape,isUniform:f.isUniform,isPacked:f.isUniform?!1:f.texData.isPacked,flatOffset:null};return f.texData!=null&&f.texData.slice!=null&&f.texData.slice.flatOffset>0&&(h.flatOffset=f.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),a=r.map(f=>f.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},l=a7e(r,o,e),c=jce(n.gl,l),u=n.createProgram(c);return bt().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:a,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(u),Object.assign({program:e,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:a,outShapeInfo:o},lue(n,e,u)))}function lue(n,e,t){const s=[],r=[];let a,o,l,c=null,u=null;u=n.getUniformLocation(t,"NAN",!1),bt().getNumber("WEBGL_VERSION")===1&&(c=n.getUniformLocation(t,"INFINITY",!1));const f=!1;for(const d of e.variableNames){const h={name:d,uniform:n.getUniformLocation(t,d,f),offset:n.getUniformLocation(t,`offset${d}`,f)};e.enableShapeUniforms&&(h.shape=n.getUniformLocation(t,`${d}Shape`,f),h.texShape=n.getUniformLocation(t,`${d}TexShape`,f)),s.push(h)}if(e.enableShapeUniforms&&(a=n.getUniformLocation(t,"outShape",f),l=n.getUniformLocation(t,"outShapeStrides",f),o=n.getUniformLocation(t,"outTexShape",f)),e.customUniforms)for(const d of e.customUniforms)r.push(n.getUniformLocation(t,d.name,f));return{variablesLocations:s,customUniformLocations:r,infLoc:c,nanLoc:u,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:o}}function cq(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const r=t.logicalShape,a=e[s],o=a.shape;if(!xr(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(t.isUniform&&a.isUniform)return;const l=t.texShape,c=a.isUniform?null:a.texData.texShape;if(!xr(l,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${l} and ${c} must match`)})}function V7e(n,e,t,s,r){e.program.enableShapeUniforms||(cq(e.inShapeInfos,t),cq([e.outShapeInfo],[s]));const a=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(a.texture,o[0],o[1]):n.setOutputMatrixTexture(a.texture,o[0],o[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),bt().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<t.length;++c){const u=t[c],{uniform:f,offset:d,shape:h,texShape:p}=e.variablesLocations[c];if(h){const{uniformShape:g}=q9(e.program.packedInputs,u.shape,u.texData.texShape);switch(g.length){case 1:n.gl.uniform1iv(h,new Int32Array(g));break;case 2:n.gl.uniform2iv(h,new Int32Array(g));break;case 3:n.gl.uniform3iv(h,new Int32Array(g));break;case 4:n.gl.uniform4iv(h,new Int32Array(g));break}}if(p&&n.gl.uniform2i(p,u.texData.texShape[0],u.texData.texShape[1]),f!=null){if(u.isUniform){if(Ot(u.shape)<2)n.gl.uniform1f(f,u.uniformValues[0]);else{let g=u.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),n.gl.uniform1fv(f,g)}continue}u.texData.slice!=null&&d!=null&&n.gl.uniform1i(d,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,f,c)}}const l=e.outShapeLocation;if(l)switch(s.shape.length){case 1:n.gl.uniform1iv(l,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(l,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(l,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(l,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const c=gs(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(c));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(c));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(c));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let c=0;c<e.program.customUniforms.length;++c){const u=e.program.customUniforms[c],f=e.customUniformLocations[c],d=r[c];if(u.type==="float")n.gl.uniform1fv(f,d);else if(u.type==="vec2")n.gl.uniform2fv(f,d);else if(u.type==="vec3")n.gl.uniform3fv(f,d);else if(u.type==="vec4")n.gl.uniform4fv(f,d);else if(u.type==="int")n.gl.uniform1iv(f,d);else if(u.type==="ivec2")n.gl.uniform2iv(f,d);else if(u.type==="ivec3")n.gl.uniform3iv(f,d);else if(u.type==="ivec4")n.gl.uniform4iv(f,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}n.executeProgram()}function W7e(n,e,t){let s="";e.concat(t).forEach(o=>{const l=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const c=o.texData.texShape,{useSqueezeShape:u,uniformShape:f,keptDims:d}=q9(n.packedInputs,o.shape,c);let h="",p="",g="";if(f.length===1&&n.packedInputs){const M=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];h=`${M[0]>1}_${M[1]>1}`}else if(f.length===2&&!n.packedInputs)p=`${f[0]>1}_${f[1]>1}`;else if(f.length>2&&!n.packedInputs){const M=gs(f);g=`${M[0]===c[1]}_${M[M.length-1]===c[1]}`}const b=o.shape.length,v=f.length===2&&xr(o.shape,c),w=Ot(o.shape)===1,x=vb(o.shape,t.shape),S=!n.packedInputs&&b===t.shape.length&&xr(c,t.texData.texShape),C=n.packedInputs||f.length>2?"":`${c[0]>1}_${c[1]>1}`;s+=`${b}_${S}_${u?d:""}_${f.length}_${w}_${x}_${v}_${h}_${p}_${g}_${C}_${l}`}else{const c=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${c}_${l}`}});const r=n.userCode;let a=n.constructor.name;return a+="_"+s+"_"+r+`${bt().getNumber("WEBGL_VERSION")}`,a}function Wc(n){return bt().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}class G7e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=WM.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Mu();this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?nP(["r","c","d"],e):nw(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}class H7e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=WM.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Mu();this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?nP(["r","c","d"],e):nw(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}class q7e{constructor(e){this.variableNames=["A"],this.outTexUsage=pd.DOWNLOAD;const t=Mu();this.outputShape=e,this.userCode=`
      ${rue}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}class Y7e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=pd.DOWNLOAD;const t=Mu();this.outputShape=e,this.userCode=`
      ${rue}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}const K7e={R:0,G:1,B:2,A:3};class uq{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Mu();this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let o="";for(let l=0;l<s.length;l++){const c=s[l];o+=`
          if(offset == ${l}) {
            result = values[${K7e[c]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?H9():G9(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}class X7e{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Mu();this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let l=0;l<=1;l++){const c=o*2+l;r+=`
          localCoords = coords;
          if(localCoords[2] + ${l} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${l};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${c}] = values[0];
            } else if (offset == 1) {
              result[${c}] = values[1];
            } else if (offset == 2) {
              result[${c}] = values[2];
            } else {
              result[${c}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?H9():G9(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}function cue(n){const e=Mu(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return $ce(n,t)}function uue(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return zce(n,e)}function fue(n){const e=new Uint16Array([0,1,2,2,1,3]);return Bce(n,e)}function cE(n,e,t,s,r,a){Vce(e,t);const o=Uce(n),l=n.TEXTURE_2D;return kn(n,()=>n.bindTexture(l,o)),kn(n,()=>n.texParameteri(l,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),kn(n,()=>n.texParameteri(l,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),kn(n,()=>n.texParameteri(l,n.TEXTURE_MIN_FILTER,n.NEAREST)),kn(n,()=>n.texParameteri(l,n.TEXTURE_MAG_FILTER,n.NEAREST)),bt().getNumber("WEBGL_VERSION")===1?kn(n,()=>n.texImage2D(l,0,s,e,t,0,r,a,null)):kn(n,()=>n.texStorage2D(l,1,s,e,t)),kn(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[t,e]}}function Y9(n){return n.internalFormatFloat}function due(n,e,t,s){const[r,a]=lE(e,t);return cE(n,r,a,Y9(s),s.textureFormatFloat,n.FLOAT)}function K9(n){return n.internalFormatHalfFloat}function hue(n,e,t,s){const[r,a]=lE(e,t);return cE(n,r,a,K9(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function X9(n){return n.downloadTextureFormat}function pue(n,e,t,s){const[r,a]=lE(e,t);return cE(n,r,a,X9(s),n.RGBA,n.UNSIGNED_BYTE)}function Q9(n){return n.internalFormatPackedFloat}function mue(n,e,t,s){const[r,a]=K_(e,t);return cE(n,r,a,Q9(s),n.RGBA,n.FLOAT)}function J9(n){return n.internalFormatPackedHalfFloat}function gue(n,e,t,s){const[r,a]=K_(e,t);return cE(n,r,a,J9(s),n.RGBA,s.textureTypeHalfFloat)}function yue(n,e,t){return kn(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),l6(n,e,"clipSpacePos",t,3,20,0)&&l6(n,e,"uv",t,2,20,12)}function bue(n,e,t,s,r,a){kn(n,()=>n.bindTexture(n.TEXTURE_2D,e));let o,l,c;r instanceof Uint8Array?(o=new Uint8Array(t*s*4),l=n.UNSIGNED_BYTE,c=n.RGBA):(o=new Float32Array(t*s*4),l=n.FLOAT,c=a.internalFormatPackedFloat),o.set(r),bt().getNumber("WEBGL_VERSION")===2?kn(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,l,o)):kn(n,()=>n.texImage2D(n.TEXTURE_2D,0,c,t,s,0,n.RGBA,l,o)),kn(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function wue(n,e,t){kn(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?bt().getNumber("WEBGL_VERSION")===2?kn(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):kn(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):bt().getNumber("WEBGL_VERSION")===2?kn(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):kn(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),kn(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function vue(n,e,t,s){const r=n.createBuffer();kn(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const l=4*4*e*t;return kn(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,l,n.STREAM_READ)),kn(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),kn(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function _ue(n,e,t){const s=n,r=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function xue(n,e,t,s){const[r,a]=lE(e,t),o=4,l=new Uint8Array(GUe(e*t,o));return kn(n,()=>n.readPixels(0,0,r,a,s.downloadTextureFormat,n.UNSIGNED_BYTE,l)),new Float32Array(l.buffer)}function Cue(n,e,t,s,r,a,o,l){const c=n,u=new Float32Array(HUe(a,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}function Sue(n,e,t){const s=new Float32Array(e*t*4);return kn(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}const Q7e=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:yue,createBufferFromOutputTexture:vue,createFloat16MatrixTexture:hue,createFloat16PackedMatrixTexture:gue,createFloat32MatrixTexture:due,createIndexBuffer:fue,createPackedMatrixTexture:mue,createUnsignedBytesMatrixTexture:pue,createVertexBuffer:uue,createVertexShader:cue,downloadByteEncodedFloatMatrixFromOutputTexture:xue,downloadFloat32MatrixFromBuffer:_ue,downloadMatrixFromPackedOutputTexture:Sue,downloadPackedMatrixFromBuffer:Cue,getInternalFormatForFloat16MatrixTexture:K9,getInternalFormatForFloat16PackedMatrixTexture:J9,getInternalFormatForFloat32MatrixTexture:Y9,getInternalFormatForPackedMatrixTexture:Q9,getInternalFormatForUnsignedBytesMatrixTexture:X9,uploadDenseMatrixToTexture:bue,uploadPixelDataToTexture:wue},Symbol.toStringTag,{value:"Module"}));class LL{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=bt().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Dce(t,e)):this.gl=wp(t),e=this.gl,bt().getNumber("WEBGL_VERSION")===2){const a=e;this.createVertexArray=()=>kn(a,()=>a.createVertexArray()),this.bindVertexArray=o=>kn(a,()=>a.bindVertexArray(o)),this.deleteVertexArray=o=>kn(a,()=>a.deleteVertexArray(o)),this.getVertexArray=()=>kn(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){const a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>kn(e,()=>a.createVertexArrayOES()),this.bindVertexArray=o=>kn(e,()=>a.bindVertexArrayOES(o)),this.deleteVertexArray=o=>kn(e,()=>a.deleteVertexArrayOES(o)),this.getVertexArray=()=>kn(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),bt().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=WS(this.gl,a),md(this.gl,o))this.textureHalfFloatExtension=WS(this.gl,o);else if(bt().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),md(this.gl,r))this.colorBufferHalfFloatExtension=WS(this.gl,r);else if(bt().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",md(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(md(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=uue(this.gl),this.indexBuffer=fue(this.gl),this.framebuffer=Wce(this.gl),this.textureConfig=V9(this.gl,this.textureHalfFloatExtension)}get debug(){return bt().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;kn(e,()=>e.finish()),kn(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),kn(e,()=>e.deleteFramebuffer(this.framebuffer)),kn(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),kn(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),kn(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),due(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),hue(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),pue(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),wue(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,r){this.throwIfDisposed(),bue(this.gl,e,t,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),gue(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),mue(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(c6(this.gl,this.framebuffer),this.outputTexture=null),kn(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>xue(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,r,a,o){return Cue(this.gl,e,t,s,r,a,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return _ue(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const r=vue(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(bt().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(a,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},t=a}else bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>Sue(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=cue(t));const s=Rce(t);kn(t,()=>t.attachShader(s,this.vertexShader)),kn(t,()=>t.attachShader(s,e)),Fce(t,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&kL(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;kn(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),yue(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(kn(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&kL(this.gl,this.program),kn(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?Hce(this.gl,e,t):qce(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),kn(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),Yce(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[r,a]=K_(t,s);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&kL(this.gl,this.program),GS(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}kn(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),kn(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=WS(this.gl,bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await gR(()=>this.disposed||this.isQueryAvailable(e,bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=J7e(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in bt().platform&&(s=bt().platform.setTimeoutCustom.bind(bt().platform)),gR(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),EL(this.gl,e,this.framebuffer),this.debug&&GS(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(EL(this.gl,this.outputTexture,this.framebuffer),this.debug&&GS(this.gl)):c6(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const r=this.gl;EL(r,e,this.framebuffer),this.debug&&GS(r),this.outputTexture=e,kn(r,()=>r.viewport(0,0,t,s)),kn(r,()=>r.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,r){this.throwIfDisposed(),kn(this.gl,()=>this.gl.scissor(e,t,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function J7e(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}const{addImpl:Z7e,bincountImpl:Mue,bincountReduceImpl:eVe,bitwiseAndImpl:tVe,castImpl:nVe,ceilImpl:sVe,concatImpl:rVe,equalImpl:iVe,expImpl:aVe,expm1Impl:oVe,floorImpl:lVe,gatherNdImpl:cVe,gatherV2Impl:uVe,greaterImpl:fVe,greaterEqualImpl:dVe,lessImpl:hVe,lessEqualImpl:pVe,linSpaceImpl:mVe,logImpl:gVe,maxImpl:yVe,maximumImpl:bVe,minimumImpl:wVe,multiplyImpl:vVe,negImpl:_Ve,notEqualImpl:xVe,prodImpl:CVe,raggedGatherImpl:SVe,raggedRangeImpl:MVe,raggedTensorToTensorImpl:TVe,rangeImpl:kVe,rsqrtImpl:EVe,scatterImpl:IVe,sigmoidImpl:AVe,simpleAbsImpl:Tue,sliceImpl:LVe,sparseFillEmptyRowsImpl:NVe,sparseReshapeImpl:DVe,sparseSegmentReductionImpl:kue,sqrtImpl:OVe,staticRegexReplaceImpl:PVe,stridedSliceImpl:$Ve,stringNGramsImpl:jVe,stringSplitImpl:RVe,stringToHashBucketFastImpl:FVe,subImpl:zVe,tileImpl:BVe,topKImpl:UVe,transposeImpl:Z9,uniqueImpl:VVe}=mce;function Eue(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function gu(n,e){return e===1?[n]:Eue(n,e)}function WVe(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}class GVe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Wc(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=gu("rc",this.rank),s=qi(this.rank),r=this.getOutOfBoundsCondition(t),a=this.getSetup(t),o=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)a=`${e[e.length-1-o]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}class Iue{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${HVe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?H9():G9(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function HVe(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?i7e(["r","c","d"],"inputShape"):nw(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}class qVe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const r=dq(t,s),a=hq(e,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const o=fq(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const c=this.freeTextures[a].pop();return this.usedTextures[a].push(c),c}let l;return r===uc.PACKED_2X2_FLOAT32?l=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===uc.PACKED_2X2_FLOAT16?l=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===uc.UNPACKED_FLOAT32?l=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===uc.UNPACKED_FLOAT16?l=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===uc.PACKED_4X1_UNSIGNED_BYTE&&(l=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(l),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),l}releaseTexture(e,t,s,r){if(this.freeTextures==null)return;const a=dq(s,r),o=hq(t,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);const l=fq(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=bt().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=l):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=l),this.numUsedTextures--;const u=this.usedTextures[o],f=u&&u.indexOf(e);if(f==null||f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[f]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function YVe(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function fq(n,e,t,s,r){const a=KVe(e,s);let o;if(r){const[c,u]=K_(n[0],n[1]);o=c*u}else{const[c,u]=lE(n[0],n[1]);o=c*u}const l=YVe(t,a);return o*l}function KVe(n,e){switch(n){case uc.PACKED_2X2_FLOAT32:return Q9(e);case uc.PACKED_2X2_FLOAT16:return J9(e);case uc.UNPACKED_FLOAT32:return Y9(e);case uc.UNPACKED_FLOAT16:return K9(e);case uc.PACKED_4X1_UNSIGNED_BYTE:return X9(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function XVe(n){return bt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?uc.PACKED_2X2_FLOAT32:uc.UNPACKED_FLOAT32:n?uc.PACKED_2X2_FLOAT16:uc.UNPACKED_FLOAT16}function dq(n,e){if(n===pd.UPLOAD)return uc.PACKED_2X2_FLOAT32;if(n===pd.RENDER||n==null)return XVe(e);if(n===pd.DOWNLOAD||n===pd.PIXELS)return uc.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function hq(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}class vm{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const xh="if (isnan(x)) return x;",QVe="return x;",pq="return abs(x);",JVe="return (x >= 0.0) ? x : (exp(x) - 1.0);",ZVe=xh+`
  return (x < 0.0) ? 0.0 : x;
`,eWe=xh+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,U0="return x;",tWe="return 1.0 / (1.0 + exp(-1.0 * x));";const nWe="return x;",sWe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,rWe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,iWe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,aWe="return 1.0 / (1.0 + exp(-1.0 * x));";class Q0{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}class oWe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length);const t=e.length,s=gu("rc",t),r=qi(t),a=WVe(t,s),o=s.slice(-2),l=t<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${l}));
      }
    `}}const lWe=wO,cWe=1e-7,uWe=1e-4,zI={};function fWe(n){return n in zI||(zI[n]={}),zI[n]}const dWe=bt().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),hWe=600;function pWe(){return bt().global.screen==null?1024:bt().global.screen.height*bt().global.screen.width*window.devicePixelRatio*hWe/1024/1024}class uE extends j4{nextDataId(){return uE.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!bt().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof LL)t=e;else{const s=wp(bt().getNumber("WEBGL_VERSION"),e);t=new LL(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=wp(bt().getNumber("WEBGL_VERSION"));t=new LL(s),this.binaryCache=fWe(bt().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new qVe(this.gpgpu),this.numMBBeforeWarning=pWe(),this.texData=new YF(this,Xh())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,r,a,o){const l=this.makeTensorInfo(t,s),c=this.texData.get(l.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[r,a]},c.texShape=[r,a];const u=HS(t),f=new uq(u,!1,o),d=this.runWebGLProgram(f,[l],s,[[r,a]]);return d.shape=t,c.texture=null,this.disposeIntermediateTensorInfo(l),d.dataId}write(e,t,s){if((bt().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||bt().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:s,values:e,usage:pd.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,r,a){if(bt().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:t,usage:pd.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:a,slice:o,shape:l,isPacked:c}=t;if(o!=null){let h;c?h=new Q0(l,U0):h=new vm(l,U0);const p=this.runWebGLProgram(h,[{dataId:e,shape:l,dtype:r}],r),g=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),g}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let f;u&&(f=oc());let d;if(r==="complex64"){const h=this.readSync(a.real.dataId),p=this.readSync(a.imag.dataId);d=Fg(h,p)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=oc()-f),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const g=this.pendingRead.get(e);return new Promise(b=>g.push(b))}const t=this.texData.get(e),{values:s,shape:r,slice:a,dtype:o,complexTensorInfos:l,isPacked:c}=t;if(a!=null){let g;c?g=new Q0(r,U0):g=new vm(r,U0);const b=this.runWebGLProgram(g,[{dataId:e,shape:r,dtype:o}],o),v=this.read(b.dataId);return this.disposeIntermediateTensorInfo(b),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(bt().getBool("DEBUG")&&!bt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&bt().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,f;if(o!=="complex64"&&bt().get("WEBGL_BUFFER_SUPPORTED")){f=this.decode(e);const g=this.texData.get(f.dataId);u=this.gpgpu.createBufferFromTexture(g.texture.texture,...RI(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const g=await Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),b=g[0],v=g[1];d=Fg(b,v)}else if(u==null)d=this.getValuesFromTexture(e);else{const g=Ot(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,g)}if(f!=null&&this.disposeIntermediateTensorInfo(f),u!=null){const g=this.gpgpu.gl;kn(g,()=>g.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,d),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(g=>g(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Xh().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,t={}){const s=this.texData.get(e),{values:r,shape:a,slice:o,dtype:l,isPacked:c,texture:u}=s;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let p;c?p=new Q0(a,U0):p=new vm(a,U0);const g=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:l}],l),b=this.readToGPU(g,t);return this.disposeIntermediateTensorInfo(g),b}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const f=this.decode(e,t.customTexShape),d=Xh().makeTensorFromTensorInfo(f),h=this.texData.get(f.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>Og(r));return tr(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return tr(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!Oce(s))throw bt().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:r}=this.texData.get(e),a=Ot(t);if(bt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),p=this.texData.get(h.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...RI(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(h),g}const o=bt().getBool("WEBGL_PACK")&&r===!0,l=o?HS(t):t,c=o?new Y7e(l):new q7e(l),u=this.runWebGLProgram(c,[{shape:l,dtype:s,dataId:e}],"float32"),f=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture.texture,f.texShape[0],f.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const a=Dm(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),o=Dm(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=t,r&&(this.programTimersStack=null);const l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const c=await Promise.all(a);l.kernelMs=Jse(c),l.getExtraProfileInfo=()=>c.map((u,f)=>({name:o[f],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:oc(),endMs:null}}endTimer(e){return bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=oc(),e)}async getQueryTime(e){if(bt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:r,usage:a,isPacked:o,slice:l}=this.texData.get(e),c=l&&l.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(t,r,a,o)));const f=this.texData.get(e);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=dWe){return bt().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Ot(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){cd("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return lWe(e.shape,t)}packedUnaryOp(e,t,s){const r=new Q0(e.shape,t),a=this.compileAndRun(r,[e],s);return Xh().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=Tue(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(bt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,pq,e.dtype);const t=new vm(e.shape,pq),s=this.compileAndRun(t,[e]);return Xh().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&wm(s[0])){const a=s.map(o=>Cm(o));r=this.write(a,e,t)}else r=this.write(s,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,s){return Xh().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new oWe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new GVe(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[Ib(e.shape),...Ab(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},a=[Ib(t),...Ab(t)],o=new Iue(a,s),l=!0,c=[s],u=this.runWebGLProgram(o,[r],e.dtype,c,l);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:r,shape:a,dtype:o}=s;if(t!=null){const h=Ot(a),p=t[0]*t[1]*4;we(h<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const l=HS(a);let c;r?c=new H7e(l):c=new G7e(l);const u=!0,f=[t??RI(l)],d=this.runWebGLProgram(c,[{shape:l,dtype:o,dataId:e}],o,f,u,t);return{dtype:o,shape:a,dataId:d.dataId}}runWebGLProgram(e,t,s,r,a=!1,o){const l=this.makeTensorInfo(e.outputShape,s),c=this.texData.get(l.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===WM.DENSE){const w=o??RI(e.outputShape);c.texShape=w.map(x=>x*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),Ot(l.shape)===0)return c.values=Bl(l.dtype,0),l;const u=[],f=t.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(w.dataId);if(x.texture==null){if(!e.packedInputs&&Ot(w.shape)<=bt().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!x.isPacked!=!!e.packedInputs)w=x.isPacked?this.unpackTensor(w):this.packTensor(w),u.push(w),x=this.texData.get(w.dataId);else if(x.isPacked&&!GM(x.shape,w.shape)){const S=w,C=w.shape;w.shape=x.shape,w=this.packedReshape(w,C),u.push(w),x=this.texData.get(w.dataId),S.shape=C}return{shape:w.shape,texData:x,isUniform:!1}});this.uploadToGPU(l.dataId);const d={shape:l.shape,texData:c,isUniform:!1},h=W7e(e,f,d),p=this.getAndSaveBinary(h,()=>U7e(this.gpgpu,e,f,d)),g=this.activeTimers!=null;let b;g&&(b=this.startTimer()),bt().get("ENGINE_COMPILE_ONLY")||V7e(this.gpgpu,p,f,d,r),u.forEach(w=>this.disposeIntermediateTensorInfo(w)),g&&(b=this.endTimer(b),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(b)}));const v=bt().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const w=oc();w-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!bt().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&a===!1){const w=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),w}return l}compileAndRun(e,t,s,r,a=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(bt().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=wt(()=>{if(!bt().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=bt().getBool("DEBUG");bt().set("DEBUG",!1);const t=this.abs(ws(1e-8)).dataSync()[0];if(bt().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?cWe:uWe}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:r,values:a,texture:o,usage:l,isPacked:c}=t;if(o!=null)return;const u=this.activeTimers!=null;let f;u&&(f=oc());let d=t.texShape;if(d==null&&(d=Qce(s,c),t.texShape=d),a!=null){const h=HS(s);let p,g=d[1],b=d[0];const v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(c||!v)&&([g,b]=K_(d[0],d[1])),c?p=new X7e(h,v):p=new uq(h,v);const w=v?[b,g]:d,x=this.makeTensorInfo(w,r),S=this.texData.get(x.dataId);v?S.usage=pd.PIXELS:S.usage=pd.UPLOAD,S.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,b,a);const C=[[b,g]],k=this.runWebGLProgram(p,[x],r,C,!0),E=this.texData.get(k.dataId);t.texShape=E.texShape,t.isPacked=E.isPacked,t.usage=E.usage,bt().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(t.texture=E.texture,t.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(x),u&&(this.uploadWaitMs+=oc()-f)}else{const h=this.acquireTexture(d,l,r,c);t.texture=h}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:r}=s;return t!=null&&(s.values=mWe(t,r)),s.values}acquireTexture(e,t,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*IM(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(a){throw a}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await LB(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(W9(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:o,outShapeStridesLocation:l,outTexShapeLocation:c}=lue(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=o,e.outShapeStridesLocation=l,e.outTexShapeLocation=c}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:o,channels:l}=e,c=Xh().backend;if(!c.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=c.writeTexture(r,t,s,a,o,l);return Xh().makeTensorFromDataId(u,t,s,c)}}uE.nextDataId=0;function mWe(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}const Aue="4.11.0";function Lue(){bt().set("WEBGL_FORCE_F16_TEXTURES",!0)}sz()&&fz("webgl",()=>new uE,2);const gWe={forceHalfFloat:Lue};const eU=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Lb{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=Gs(t,s),this.enableShapeUniforms=Wc(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}const rw=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class tx{constructor(e,t,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Gs(t,s);const a=this.outputShape.length;this.enableShapeUniforms=Wc(a);let o="";if(r)if(a===0||Ot(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${qi(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const c=gu("coords",a);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${c[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${c[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${c[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${c[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}function Lf(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const yWe={kernelName:a_,backendName:"webgl",kernelFunc:Lf};function N1(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,a=t.makeTensorInfo(s.shape,"complex64"),o=t.texData.get(a.dataId),l=Lf({inputs:{x:s},backend:t}),c=Lf({inputs:{x:r},backend:t});return o.complexTensorInfos={real:l,imag:c},a}const bWe={kernelName:H4,backendName:"webgl",kernelFunc:N1};const Nue="return (a < 0.) ? b * a : a;",Due=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function wWe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:a}=s,o=t.makeTensorInfo([],"float32",Wg(a,"float32")),l=bt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new tx(Due,r.shape,o.shape):new Lb(Nue,r.shape,o.shape),c=t.runWebGLProgram(l,[r,o],"float32");return t.disposeIntermediateTensorInfo(o),c}const vWe={kernelName:HT,backendName:"webgl",kernelFunc:wWe};const Oue="return (a < 0.) ? b * a : a;",Pue=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function _We(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e,a=bt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new tx(Pue,s.shape,r.shape):new Lb(Oue,s.shape,r.shape);return t.runWebGLProgram(a,[s,r],"float32")}const xWe={kernelName:fk,backendName:"webgl",kernelFunc:_We};const nx="if (isnan(x)) return x;";function qr({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:r,backend:a})=>{const{x:o}=r,l=a,c=s||o.dtype;if(l.shouldExecuteOnCPU([o])&&t!=null){const d=l.texData.get(o.dataId),h=t(d.values,c);return l.makeTensorInfo(o.shape,c,h)}const u=bt().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let f;return u?f=new Q0(o.shape,e):f=new vm(o.shape,n),l.runWebGLProgram(f,[o],c)}}function wc({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:o,backend:l})=>{const{a:c,b:u}=o,f=l;if(s&&c.dtype==="complex64"){const g=f.texData.get(c.dataId),b=f.texData.get(u.dataId),[v,w]=[[g.complexTensorInfos.real,b.complexTensorInfos.real],[g.complexTensorInfos.imag,b.complexTensorInfos.imag]].map(S=>{const[C,M]=S,k={dataId:C.dataId,dtype:C.dtype,shape:c.shape},E={dataId:M.dataId,dtype:M.dtype,shape:u.shape},I=new Lb(n,c.shape,u.shape);return f.runWebGLProgram(I,[k,E],Hu(C.dtype,M.dtype))}),x=N1({inputs:{real:v,imag:w},backend:f});return f.disposeIntermediateTensorInfo(v),f.disposeIntermediateTensorInfo(w),x}const d=a||Hu(c.dtype,u.dtype);if((c.dtype==="string"||u.dtype==="string"||f.shouldExecuteOnCPU([c,u]))&&r!=null){const g=f.texData.get(c.dataId).values,b=f.texData.get(u.dataId).values,v=c.dtype==="string"?zg(g):g,w=c.dtype==="string"?zg(b):b,[x,S]=r(c.shape,u.shape,v,w,d),C=f.makeTensorInfo(S,d),M=f.texData.get(C.dataId);return M.values=x,C}const h=bt().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return h?p=new tx(e,c.shape,u.shape,t):p=new Lb(n,c.shape,u.shape),f.runWebGLProgram(p,[c,u],d)}}function HM(n,e=!1){if(n==="linear")return e?nWe:QVe;if(n==="relu")return e?rWe:ZVe;if(n==="elu")return e?sWe:JVe;if(n==="relu6")return e?iWe:eWe;if(n==="prelu")return e?Pue:Oue;if(n==="leakyrelu")return e?Due:Nue;if(n==="sigmoid")return e?aWe:tWe;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}class $ue{constructor(e,t,s,r=!1,a=!1,o=!1,l=null,c=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Wc(this.outputShape.length);const f=r?e[1]:e[2],d=Math.ceil(f/2),h=r?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",g=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],b=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",w="";l&&(c?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${l}
        }`:u?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${l}
        }`:v=`vec4 activation(vec4 x) {
          ${l}
        }`,w="result = activation(result);");const x=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let S="rc.x",C="rc.x";e[0]<t[0]?S=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(C=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${S};
        int batchB = ${C};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${g[0]} * ${b[0]});
          result += (${g[1]} * ${b[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${w}

        setOutput(result);
      }
    `}}const mq={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class gq{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Gs(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}const yq="return a * b;";function tU(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,a=Hu(s.dtype,r.dtype);if(s.dtype==="complex64"){const l=t.texData.get(s.dataId),c=t.texData.get(r.dataId),u=new gq(mq.REAL,s.shape,r.shape),f=new gq(mq.IMAG,s.shape,r.shape),d=[{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:r.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:r.shape}],h=t.runWebGLProgram(u,d,"float32"),p=t.runWebGLProgram(f,d,"float32"),g=N1({inputs:{real:h,imag:p},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),g}if(t.shouldExecuteOnCPU([s,r])){const l=t.texData.get(s.dataId),c=t.texData.get(r.dataId),[u,f]=vVe(s.shape,r.shape,l.values,c.values,a),d=t.makeTensorInfo(f,a),h=t.texData.get(d.dataId);return h.values=u,d}let o;return bt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new tx(yq,s.shape,r.shape):o=new Lb(yq,s.shape,r.shape),t.runWebGLProgram(o,[s,r],a)}const CWe={kernelName:m_,backendName:"webgl",kernelFunc:tU};function SWe(n,e,t){const s=[Ib(n.shape),...Ab(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},a=[Ib(e),...Ab(e)],o=new Iue(a,s),l=!0,c=[s],u=t.runWebGLProgram(o,[r],n.dtype,c,l);return{dataId:u.dataId,shape:e,dtype:u.dtype}}function Mn(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:a}=s,o=t,l=Ot(r.shape),c=XF(a,l),u=Ot(c);we(l===u,()=>`The new shape (${c}) has ${u} elements and the old shape (${r.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`);const f=o.texData.get(r.dataId);return f.isPacked&&!GM(r.shape,c)&&!(f.texture!==null&&GM(f.shape,c))?SWe(r,c,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:c,dtype:r.dtype})}const MWe={kernelName:hk,backendName:"webgl",kernelFunc:Mn};class bq{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:o}=e;this.outputShape=[r,o];const l=Math.floor(s/4)*4,c=s%4;let u="sumValue += dot(values, ones);";if(t!=null){const d=1/t;u=`sumValue += dot(values * ${pb(d)?d.toPrecision(2):d}, ones);`}let f="";a%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${l};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}class TWe{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:o}=e;this.outputShape=[r,o];let l="0.0",c="";t==="prod"?l="1.0":t==="min"?(l="1.0 / 1e-20",c="min"):t==="max"&&(l="-1.0 / 1e-20",c="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const f=Math.floor(s/4)*4,d=s%4;let h=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${c}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";t==="all"?(l="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(l="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let g="";a%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${l};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${l});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${f};
        if (${d===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}function kWe(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=LO(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function iw(n,e,t,s){const r=kWe(n.shape);let a=n;for(let o=0;o<r.length;o++){const{inSize:l,windowSize:c,outSize:u}=r[o];let f,d;t==="mean"?f=o===0?new bq({windowSize:c,inSize:l,batchSize:n.shape[0],outSize:u},l):new bq({windowSize:c,inSize:l,batchSize:n.shape[0],outSize:u}):f=new TWe({windowSize:c,inSize:l,batchSize:n.shape[0],outSize:u},t),d=a,a=s.runWebGLProgram(f,[a],e),d.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(d)}return a}class EWe{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[t[o]];this.outputShape=s,this.rank=s.length;const r=qi(this.rank),a=IWe(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function IWe(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<n.length;r++)s[n[r]]=t[r];return s.join()}class AWe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let f=0;f<s.length;f++)s[f]=e[t[f]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=qi(this.rank),a=Eue("rc",this.rank),o=new Array(this.rank);for(let f=0;f<t.length;f++)o[t[f]]=a[f];const l=`vec2(${o.slice(-2).join()})`,c=`++${a[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${l})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${c}) {
        result[1] = ${u};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${c}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}function sP(n,e,t){const s=bt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new AWe(n.shape,e):new EWe(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}function LWe(n,e,t,s){const r=e,a=n.shape.length,o=dr(r,n.shape);let l=o;const c=no(l,a),u=c!=null;let f=n;u&&(f=sP(n,c,s),l=jo(l.length,a)),yc("sum",l,a);const[d,h]=Wl(f.shape,l);let p=d;t&&(p=$o(d,o));const g=Ot(h),v=Ot(n.shape)/g,w=Mn({inputs:{x:f},attrs:{shape:[v,g]},backend:s}),x=HD(n.dtype),S=iw(w,x,"sum",s),C=Mn({inputs:{x:S},attrs:{shape:p},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(S),u&&s.disposeIntermediateTensorInfo(f),C}function rP(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s;return LWe(r,a,o,t)}const NWe={kernelName:wk,backendName:"webgl",kernelFunc:rP};function xu(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{perm:a}=s,o=t,l=r.shape.length,c=new Array(l);for(let f=0;f<c.length;f++)c[f]=r.shape[a[f]];let u;if(o.shouldExecuteOnCPU([r])){const d=o.texData.get(r.dataId).values,h=Z9(d,r.shape,r.dtype,a,c);u=o.makeTensorInfo(c,r.dtype);const p=o.texData.get(u.dataId);p.values=h}else u=sP(r,a,o);return u}const DWe={kernelName:nb,backendName:"webgl",kernelFunc:xu};const jue=1e3;function YN({a:n,b:e,transposeA:t,transposeB:s,backend:r,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}){const u=n.shape.length,f=e.shape.length,d=t?n.shape[u-2]:n.shape[u-1],h=s?e.shape[f-1]:e.shape[f-2],p=t?n.shape[u-1]:n.shape[u-2],g=s?e.shape[f-2]:e.shape[f-1],b=n.shape.slice(0,-2),v=e.shape.slice(0,-2),w=Ot(b),x=Ot(v),C=Gs(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,g]);we(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const M=t?[w,d,p]:[w,p,d],k=s?[x,g,h]:[x,h,g],E=Mn({inputs:{x:n},backend:r,attrs:{shape:M}}),I=Mn({inputs:{x:e},backend:r,attrs:{shape:k}}),A=[E,I],D=Math.max(w,x),L=t?E.shape[1]:E.shape[2],P=a!=null,j=o!=null,G=c==="leakyrelu",Q=c!=null?HM(c,!0):null,q=P||j||G||Q!=null;let te;if((p===1||g===1)&&L>jue&&q===!1){let ne=E,le=I;t&&(ne=xu({inputs:{x:E},backend:r,attrs:{perm:[0,2,1]}}),A.push(ne)),s&&(le=xu({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),A.push(le));const H=g!==1,R=g===1;let B=ne;H&&(B=Mn({inputs:{x:ne},backend:r,attrs:{shape:[D,L,1]}}),A.push(B));const W=g===1?2:1;let se=le;R&&(se=Mn({inputs:{x:le},backend:r,attrs:{shape:[D,1,L]}}),A.push(se));const ue=tU({inputs:{a:B,b:se},backend:r});te=rP({inputs:{x:ue},backend:r,attrs:{axis:W,keepDims:!0}}),A.push(ue)}else{const ne=Hu(n.dtype,e.dtype),le=new $ue(M,k,[D,p,g],t,s,P,Q,j,G),H=[E,I];if(a!=null&&H.push(a),j&&H.push(o),G){const R=r.makeTensorInfo([],"float32",Wg(l,"float32"));H.push(R),A.push(R)}te=r.runWebGLProgram(le,H,ne)}const Z=Mn({inputs:{x:te},backend:r,attrs:{shape:C}});A.push(te);for(const ne of A)r.disposeIntermediateTensorInfo(ne);return Z}function OWe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a,bias:o,preluActivationWeights:l}=e,{transposeA:c,transposeB:u,activation:f,leakyreluAlpha:d}=s;return YN({a:r,b:a,transposeA:c,transposeB:u,backend:t,bias:o,preluActivationWeights:l,leakyreluAlpha:d,activation:f})}const PWe={kernelName:AM,backendName:"webgl",kernelFunc:OWe};const wq="return abs(x);";function $We(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=t.texData.get(s.dataId),o=Tue(a.values);return t.makeTensorInfo(s.shape,s.dtype,o)}let r;return bt().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Q0(s.shape,wq):r=new vm(s.shape,wq),t.runWebGLProgram(r,[s],s.dtype)}const jWe={kernelName:ST,backendName:"webgl",kernelFunc:$We};const RWe=xh+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,FWe=qr({opSnippet:RWe}),zWe={kernelName:z2,backendName:"webgl",kernelFunc:FWe};const BWe=xh+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,UWe=qr({opSnippet:BWe}),VWe={kernelName:B2,backendName:"webgl",kernelFunc:UWe};const vq="return a + b;",WWe=wc({opSnippet:vq,packedOpSnippet:vq,supportsComplex:!0,cpuKernelImpl:Z7e}),GWe={kernelName:Yb,backendName:"webgl",kernelFunc:WWe};class HWe{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,o)=>`T${o}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}class qWe{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,o)=>`T${o}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}function NL(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return Lf({inputs:{x:s[0]},backend:t});if(s.length>bt().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(s.length/2),u=NL({inputs:s.slice(0,c),backend:t}),f=NL({inputs:s.slice(c),backend:t});return NL({inputs:[u,f],backend:t})}const r=s.map(c=>c.dtype).reduce((c,u)=>Hu(c,u)),a=s.map(c=>c.shape),l=bt().getBool("WEBGL_PACK")?new qWe(s[0].shape,a):new HWe(s[0].shape,a);return t.runWebGLProgram(l,s,r)}const YWe={kernelName:MT,backendName:"webgl",kernelFunc:NL};function KWe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=dr(a,r.shape);let u=c;const f=no(u,l);let d=r;f!=null&&(d=xu({inputs:{x:r},backend:t,attrs:{perm:f}}),u=jo(u.length,l)),yc("all",u,l);const[h,p]=Wl(d.shape,u),g=Ot(p),b=Mn({inputs:{x:d},backend:t,attrs:{shape:[-1,g]}}),v=iw(b,b.dtype,"all",t);let w;if(o){const x=$o(h,c);w=Mn({inputs:{x:v},backend:t,attrs:{shape:x}})}else w=Mn({inputs:{x:v},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),f!=null&&t.disposeIntermediateTensorInfo(d),w}const XWe={kernelName:z4,backendName:"webgl",kernelFunc:KWe};function QWe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=dr(a,r.shape);let u=c;const f=no(u,l);let d=r;f!=null&&(d=xu({inputs:{x:r},backend:t,attrs:{perm:f}}),u=jo(u.length,l)),yc("any",u,l);const[h,p]=Wl(d.shape,u),g=Ot(p),b=Mn({inputs:{x:d},backend:t,attrs:{shape:[-1,g]}}),v=iw(b,b.dtype,"any",t);let w;if(o){const x=$o(h,c);w=Mn({inputs:{x:v},backend:t,attrs:{shape:x}})}else w=Mn({inputs:{x:v},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),f!=null&&t.disposeIntermediateTensorInfo(d),w}const JWe={kernelName:B4,backendName:"webgl",kernelFunc:QWe};class ZWe{constructor(e,t,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];const l=t==="max"?">":"<",c=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${l} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}class eGe{constructor(e,t,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,we(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],o=Math.ceil(a/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const l=this.outputShape,c=l.length,u=qi(c),f=gu("coords",c);let d,h;if(o===1){h=c+1;const I=qi(h);d=`
        ${I} sourceLocR = ${I}(${f.join()}, 0);
        ++${f[c-1]};
        ${I} sourceLocG = ${I}(${f.join()}, 0);
        ++${f[c-2]};
        ${I} sourceLocA = ${I}(${f.join()}, 0);
        --${f[c-1]};
        ${I} sourceLocB = ${I}(${f.join()}, 0);
        --${f[c-2]};`}else h=c,d=`
        ${u} sourceLocR = coords;
        ++${f[c-1]};
        ${u} sourceLocG = coords;
        ++${f[c-2]};
        ${u} sourceLocA = coords;
        --${f[c-1]};
        ${u} sourceLocB = coords;
        --${f[c-2]};`;const p=["x","y","z","w","u","v"].slice(0,h),g="."+p[h-1],b=p.map(I=>"int "+I),v=gu("sourceLocR",h-1).concat("inIdx.r"),w=gu("sourceLocG",h-1).concat("inIdx.g"),x=gu("sourceLocB",h-1).concat("inIdx.b"),S=gu("sourceLocA",h-1).concat("inIdx.a"),C=s==="max"?"greaterThan":"lessThan",M=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${S.join()})));`,k=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${S.join()}) : 0.)`,E=r?"":`
      float getBestIndicesAChannel(${b.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${b.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${E}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${f[c-1]} < ${l[c-1]-1};
        bool hasNextRow = ${f[c-2]} < ${l[c-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${g}, sourceLocG${g},
          sourceLocB${g}, sourceLocA${g}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${M}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${C}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}function Rue(n,e,t,s=null){let r=e.shape[0],a=e.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const o=LO(a),l={windowSize:o,inSize:a,batchSize:r,outSize:Math.ceil(a/o)},c=new ZWe(l,t,s==null),u=[e];s!=null&&u.push(s);const f=n.runWebGLProgram(c,u,"int32");if(f.shape[1]===1)return f;const d=Rue(n,e,t,f);return n.disposeIntermediateTensorInfo(f),d}function Fue(n,e,t,s=null){const r=s!=null?s.shape:e.shape,a=r[r.length-1],o=LO(a),l=new eGe(r,o,t,s==null),c=s==null?[e]:[e,s],u=n.runWebGLProgram(l,c,"int32");if(u.shape.length===e.shape.length){const f=Fue(n,e,t,u);return n.disposeIntermediateTensorInfo(u),f}return u}function zue(n,e,t,s){const r=[t];if(yc("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!bt().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],o=n.texData.get(e.dataId),l=o!==null&&o.isPacked;let c=e;l&&(c=n.unpackTensor(e),a.push(c));const[u,f]=Wl(c.shape,r),d=Ot(f),h=Mn({inputs:{x:c},backend:n,attrs:{shape:[-1,d]}});a.push(h);const p=Rue(n,h,s);a.push(p);const g=Mn({inputs:{x:p},backend:n,attrs:{shape:u}});return a.forEach(b=>n.disposeIntermediateTensorInfo(b)),g}return Fue(n,e,s)}function tGe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;let o=dr(a,r.shape);const l=no(o,r.shape.length);let c=r;const u=[];l!=null&&(c=xu({inputs:{x:r},backend:t,attrs:{perm:l}}),u.push(c),o=jo(o.length,c.shape.length)),yc("argMax",[o[0]],c.shape.length);const f=zue(t,c,o[0],"max");return u.forEach(d=>t.disposeIntermediateTensorInfo(d)),f}const nGe={kernelName:TT,backendName:"webgl",kernelFunc:tGe};function sGe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;let o=dr(a,r.shape);const l=no(o,r.shape.length);let c=r;const u=[];l!=null&&(c=xu({inputs:{x:r},backend:t,attrs:{perm:l}}),u.push(c),o=jo(o.length,c.shape.length)),yc("argMin",[o[0]],c.shape.length);const f=zue(t,c,o[0],"min");return u.forEach(d=>t.disposeIntermediateTensorInfo(d)),f}const rGe={kernelName:kT,backendName:"webgl",kernelFunc:sGe};const iGe=xh+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,aGe=qr({opSnippet:iGe}),oGe={kernelName:U2,backendName:"webgl",kernelFunc:aGe};const lGe=xh+"return log(x + sqrt(x * x + 1.0));",cGe=qr({opSnippet:lGe}),uGe={kernelName:V2,backendName:"webgl",kernelFunc:cGe};const fGe=xh+`
  return atan(x);
`,dGe=qr({opSnippet:fGe}),hGe={kernelName:W2,backendName:"webgl",kernelFunc:dGe};const pGe=eU+`
  return atan(a, b);
`,mGe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+rw+`
  return result;
`,gGe=wc({opSnippet:pGe,packedOpSnippet:mGe}),yGe={kernelName:H2,backendName:"webgl",kernelFunc:gGe};const bGe=xh+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,wGe=qr({opSnippet:bGe}),vGe={kernelName:G2,backendName:"webgl",kernelFunc:wGe};class qM{constructor(e,t,s,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;const b=t==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(b||(x="-1.0 / 1e-20"),s){this.userCode=`
        const ivec2 strides = ivec2(${l}, ${c});
        const ivec2 pads = ivec2(${p}, ${g});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${f}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?v:w:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let C=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(C="avgValue / max(count, 1.0)");const M=Math.floor(o/4)*4,k=o%4,E=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${p}, ${g});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${M}; wC += 4) {
            int xC = xCCorner + wC * ${f};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              getValue(batch, xR, xC + 3 * ${f}, d)
            );

            ${E}
          }

          int xC = xCCorner + ${M};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              initializationValue
            );

            ${E}
          }
        }
        setOutput(${C});
      }
    `}}class nU{constructor(e,t,s,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,l=e.strideDepth,c=e.strideHeight,u=e.strideWidth,f=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,g=e.effectiveFilterHeight,b=e.effectiveFilterWidth,v=e.padInfo.front,w=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const S=t==="avg";let C="0.0";if(S||(C="-1.0 / 1e-20"),s){this.userCode=`
        const ivec3 strides =
            ivec3(${l}, ${c}, ${u});
        const ivec3 pads = ivec3(${v}, ${w}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${f}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${g};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${b};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${g} * ${b} +
                      wR * ${b} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const M="max";let k=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(k="avgValue / max(count, 1.0)");const E=Math.floor(o/4)*4,I=o%4,A=`
      if (${S}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${M}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${l}, ${c}, ${u});
      const ivec3 pads = ivec3(${v}, ${w}, ${x});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${f}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${g};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${E}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${E};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${A}
            }
          }
        }
        setOutput(${k});
      }
    `}}function _Ge(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;X_(r,"avgPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;we(gc(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=vh(r.shape,a,o,u,l,c);if(f.filterWidth===1&&f.filterHeight===1&&xr(f.inShape,f.outShape))return Lf({inputs:{x:r},backend:t});const d=new qM(f,"avg",!1);return t.runWebGLProgram(d,[r],"float32")}const xGe={kernelName:ET,backendName:"webgl",kernelFunc:_Ge};function CGe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=s,f=[1,1,1],d=Gg(r.shape,a,o,f,l,c,u),h=new nU(d,"avg",!1);return t.runWebGLProgram(h,[r],"float32")}const SGe={kernelName:IT,backendName:"webgl",kernelFunc:CGe};class MGe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,f=c-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${f}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${l}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class TGe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=d-1-e.padInfo.front,b=h-1-e.padInfo.top,v=p-1-e.padInfo.left,w=1/(t*s*r);this.userCode=`
      const ivec3 pads = ivec3(${g}, ${b}, ${v});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${f}) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function kGe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,o=a,{filterSize:l,strides:c,pad:u,dimRoundingMode:f}=s,d=[1,1,1],h=Gg(o.shape,l,c,d,u,f),p=new TGe(h);return t.runWebGLProgram(p,[r],o.dtype)}const EGe={kernelName:V4,backendName:"webgl",kernelFunc:kGe};function IGe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,o=a;X_([r,a],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=s,f=vh(o.shape,l,c,1,u),d=new MGe(f);return t.runWebGLProgram(d,[r],o.dtype)}const AGe={kernelName:U4,backendName:"webgl",kernelFunc:IGe};function LGe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a}=e,{transposeA:o,transposeB:l}=s;return YN({a:r,b:a,transposeA:o,transposeB:l,backend:t})}const NGe={kernelName:AT,backendName:"webgl",kernelFunc:LGe};class DGe{constructor(e,t,s,r,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Gs(e,t),Gs(e,s);let l="0.0";r!=null&&(Gs(e,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="1.0";a!=null&&(Gs(e,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${l};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}class OGe{constructor(e,t,s,r,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Gs(e,t),Gs(e,s);let l="vec4(0.0)";r!=null&&(Gs(e,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="vec4(1.0)";a!=null&&(Gs(e,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${l};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}const PGe=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:r,variance:a,offset:o,scale:l}=n;we(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),we(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),we(l==null||r.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=t;c==null&&(c=.001);const u=[s,r,a];let f=null;o!=null&&(f=o.shape,u.push(o));let d=null;l!=null&&(d=l.shape,u.push(l));const h=bt().getBool("WEBGL_PACK_NORMALIZATION")?new OGe(s.shape,r.shape,a.shape,f,d,c):new DGe(s.shape,r.shape,a.shape,f,d,c);return e.runWebGLProgram(h,u,u[0].dtype)},$Ge={kernelName:VT,backendName:"webgl",kernelFunc:PGe};class jGe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=qi(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=RGe(this.rank);let r;const a=e.map((o,l)=>`sourceLoc.${d6[l]} = start[${l}] + coords.${d6[l]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const d6=["x","y","z","w","u","v"];function RGe(n){if(n===1)return"sourceLoc";if(n<=6)return d6.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}class FGe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=qi(this.rank),s=gu("coords",this.rank),r=gu("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${a})`,l=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((f,d)=>`start[${d}]`).join()});`:e.map((f,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${l}
        ${c}
        setOutput(result);
      }
    `}}function zGe(n,e,t,s){const r=s.texData.get(n.dataId),a=s.makeTensorInfo(t,n.dtype),o=s.texData.get(a.dataId);Object.assign(o,r),o.refCount=1,o.shape=t,o.dtype=n.dtype;let l=IB(e,gs(n.shape));r.slice&&(l+=r.slice.flatOffset),o.slice={flatOffset:l,origDataId:r.slice&&r.slice.origDataId||n.dataId};const c=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,c+1),a}function sx(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,size:o}=s,[l,c]=AO(r,a,o);if(TB(r,l,c),Ot(c)===0)return t.makeTensorInfo(c,r.dtype,[]);if(t.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=t.texData.get(r.dataId),h=LVe(d.values,l,c,r.shape,r.dtype);return t.makeTensorInfo(c,r.dtype,h)}const{isPacked:u}=t.texData.get(r.dataId),f=EB(r.shape,l,c);if(u||!f){const d=bt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FGe(c):new jGe(c),h=[l];return t.runWebGLProgram(d,[r],r.dtype,h)}return t.uploadToGPU(r.dataId),zGe(r,l,c,t)}const BGe={kernelName:bk,backendName:"webgl",kernelFunc:sx};const UGe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,crops:o}=s;we(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((x,S)=>x*S),c=qk(r.shape,a,l),u=Yk(c.length,a.length),f=Kk(r.shape,a,l),d=PB(o,a.length),h=$B(f,o,a.length),p=[],g=Mn({inputs:{x:r},backend:t,attrs:{shape:c}}),b=xu({inputs:{x:g},backend:t,attrs:{perm:u}}),v=Mn({inputs:{x:b},backend:t,attrs:{shape:f}}),w=sx({inputs:{x:v},backend:t,attrs:{begin:d,size:h}});return p.push(g),p.push(b),p.push(v),p.forEach(x=>t.disposeIntermediateTensorInfo(x)),w},VGe={kernelName:LT,backendName:"webgl",kernelFunc:UGe};function WGe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:o}=s,l=t.readSync(r.dataId),c=t.readSync(a.dataId),u=Mue(l,c,a.dtype,a.shape,o);return t.makeTensorInfo([o],a.dtype,u)}const GGe={kernelName:W4,backendName:"webgl",kernelFunc:WGe};const HGe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,qGe=`
  return float(int(a.r) & int(b.r));
`;function YGe(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,a=bt().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=bt().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,r])||o===1){const c=t.texData.get(s.dataId).values,u=t.texData.get(r.dataId).values,[f,d]=tVe(s.shape,r.shape,c,u,s.dtype),h=t.makeTensorInfo(d,s.dtype),p=t.texData.get(h.dataId);return p.values=f,h}let l;return a?l=new tx(HGe,s.shape,r.shape,!1):l=new Lb(qGe,s.shape,r.shape),t.runWebGLProgram(l,[s,r],s.dtype)}const KGe={kernelName:NT,backendName:"webgl",kernelFunc:YGe};function XGe(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=Gs(Array.from(a),Array.from(o));return t.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const QGe={kernelName:G4,backendName:"webgl",kernelFunc:XGe};const JGe="return float(a != b);",Bue=wc({opSnippet:JGe,cpuKernelImpl:xVe,dtype:"bool"}),ZGe={kernelName:ak,backendName:"webgl",kernelFunc:Bue};function fE(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return Lf({inputs:{x:r.complexTensorInfos.real},backend:t})}const eHe={kernelName:MD,backendName:"webgl",kernelFunc:fE};const tHe="return float(int(x));";function nHe(n,e){const t=new vm(n.shape,tHe),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}function h6(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Lf({inputs:{x:r},backend:t});const o=Xo(r.shape),l=h6({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),c=N1({inputs:{real:l,imag:o},backend:t});return o.dispose(),t.disposeIntermediateTensorInfo(l),c}if(r.dtype==="complex64"){const o=fE({inputs:{input:r},backend:t}),l=h6({inputs:{x:o},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(o),l}if(!QF(r.dtype,a)){const o=Lf({inputs:{x:r},backend:t});return{dataId:o.dataId,shape:o.shape,dtype:a}}if(t.shouldExecuteOnCPU([r])){const o=t.texData.get(r.dataId).values,[l,c,u]=nVe(o,r.shape,r.dtype,a);return t.makeTensorInfo(l,c,u)}if(a==="int32")return nHe(r,t);if(a==="bool"){const o=t.makeTensorInfo([],"bool",Bl("bool",1)),c=Bue({inputs:{a:r,b:o},backend:t});return t.disposeIntermediateTensorInfo(o),c}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const sHe={kernelName:q2,backendName:"webgl",kernelFunc:h6};const _q="return ceil(x);",rHe=qr({opSnippet:_q,packedOpSnippet:_q,cpuKernelImpl:sVe}),iHe={kernelName:Y2,backendName:"webgl",kernelFunc:rHe};class aHe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}class oHe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}function lHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{clipValueMin:a,clipValueMax:o}=s;let l;bt().getBool("WEBGL_PACK_CLIP")?l=new oHe(r.shape):l=new aHe(r.shape);const c=[[a],[o]];return t.runWebGLProgram(l,[r],r.dtype,c)}const cHe={kernelName:K2,backendName:"webgl",kernelFunc:lHe};class uHe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}function xq(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function fHe(n){const{inputs:e,backend:t}=n,{x:s}=e,r=t.texData.get(s.dataId),a=new uHe(s.shape),o=[xq(s,r.complexTensorInfos.real),xq(s,r.complexTensorInfos.imag)];return t.runWebGLProgram(a,o,o[0].dtype)}const dHe={kernelName:DT,backendName:"webgl",kernelFunc:fHe};class hHe{constructor(e){this.outputShape=[],this.outputShape=Mm(e,1),this.variableNames=e.map((o,l)=>`T${l}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let o=1;o<t.length;o++)t[o]=t[o-1]+e[o][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<t.length;o++){const l=t[o-1];s.push(`else if (yC < ${t[o]}) setOutput(getT${o}(yR, yC-${l}));`)}const r=t.length,a=t[t.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}class pHe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Mm(e,t);const s=this.outputShape,r=s.length,a=qi(r),o=gu("coords",r),l=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((b,v)=>`T${v}`);const c=new Array(e.length-1);c[0]=e[0][t];for(let b=1;b<c.length;b++)c[b]=c[b-1]+e[b][t];const u=l[t],f=l.slice(-2),d=l.join();let h=`if (${u} < ${c[0]}) {
        return getChannel(
            getT0(${d}), vec2(${f.join()}));
        }`;for(let b=1;b<c.length;b++){const v=c[b-1];h+=`
        if (${u} < ${c[b]}  && ${u} >= ${c[b-1]}) {
          return getChannel(
            getT${b}(${BI(l,u,v)}),
            vec2(${BI(f,u,v)}));
        }`}const p=c.length,g=c[c.length-1];h+=`
        return getChannel(
          getT${p}(${BI(l,u,g)}),
          vec2(${BI(f,u,g)}));`,this.userCode=`
      float getValue(${l.map(b=>"int "+b)}) {
        ${h}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function BI(n,e,t){const s=n.indexOf(e);return n.map((a,o)=>o===s?`${a} - ${t}`:a).join()}function iP(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return Lf({inputs:{x:r.complexTensorInfos.imag},backend:t})}const mHe={kernelName:fD,backendName:"webgl",kernelFunc:iP};function qS(n,e,t){const s=n[0].dtype;if(s==="complex64"){const p=n.map(x=>fE({inputs:{input:x},backend:t})),g=n.map(x=>iP({inputs:{input:x},backend:t})),b=qS(p,e,t),v=qS(g,e,t),w=N1({inputs:{real:b,imag:v},backend:t});return p.forEach(x=>t.disposeIntermediateTensorInfo(x)),g.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),w}let r=t.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const p=n.map(C=>{const k=[-1,Ot(C.shape.slice(e))];return Mn({inputs:{x:C},backend:t,attrs:{shape:k}})}),g=p.map(C=>({vals:t.readSync(C.dataId),shape:C.shape})),b=Mm(p.map(C=>C.shape),1),v=p[0].shape[0]===1,w=rVe(g,b,s,v),x=Mm(n.map(C=>C.shape),e),S=t.makeTensorInfo(x,s,w);return p.forEach(C=>t.disposeIntermediateTensorInfo(C)),S}const a=n.filter(p=>Ot(p.shape)>0),o=bt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const p=o?new vm(n[0].shape,U0):new Q0(n[0].shape,U0);return t.runWebGLProgram(p,n,s)}const l=bt().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>l){const p=[];for(let b=0;b<a.length;b+=l){const v=a.slice(b,b+l);p.push(qS(v,e,t))}const g=qS(p,e,t);for(const b of p)t.disposeIntermediateTensorInfo(b);return g}if(o){const p=new pHe(a.map(g=>g.shape),e);return t.runWebGLProgram(p,a,s)}const{tensors2D:c,outShape:u}=gHe(a,e,t),f=new hHe(c.map(p=>p.shape)),d=t.runWebGLProgram(f,c,s);c.forEach(p=>t.disposeIntermediateTensorInfo(p));const h=Mn({inputs:{x:d},attrs:{shape:u},backend:t});return t.disposeIntermediateTensorInfo(d),h}function gHe(n,e,t){const s=Mm(n.map(a=>a.shape),e);return{tensors2D:n.map(a=>Mn({inputs:{x:a},attrs:{shape:[-1,Ot(a.shape.slice(e))]},backend:t})),outShape:s}}function Uue(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,a=dr(r,e[0].shape)[0],o=e.map(u=>u.shape);NB(o,a);const l=Mm(e.map(u=>u.shape),a);if(Ot(l)===0)return t.makeTensorInfo(l,e[0].dtype,[]);const c=e.filter(u=>Ot(u.shape)>0);return c.length===1?Lf({inputs:{x:c[0]},backend:t}):qS(c,a,t)}const yHe={kernelName:OT,backendName:"webgl",kernelFunc:Uue};class Vue{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,f=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,g=Math.floor(e.inChannels/4)*4,b=e.inChannels%4,v=e.dataFormat==="channelsLast",w=v?1:2,x=v?2:3,S=v?3:1;let C="",M="";s&&(r?C=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?C=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:C=`
          float activation(float x) {
            ${s}
          }
        `,M="result = activation(result);");const k=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${C}

      const ivec2 strides = ivec2(${c}, ${u});
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${S}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${f};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${g}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${b===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${g}) *
                    getW(wR, wC, ${g}, d2);
              } else {
                dotProd +=
                    getX(batch, ${g}, xR, xC) *
                    getW(wR, wC, ${g}, d2);
              }

            } else if (${b===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${b===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2),
                getW(wR, wC, ${g} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1),
                  getX(batch, xR, xC, ${g} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC),
                  getX(batch, ${g} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${M}
        setOutput(result);
      }
    `}}class bHe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,f=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,g=Math.floor(e.inChannels/4)*4,b=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${o}, ${l});
      const ivec3 pads = ivec3(${t}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${f};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${g}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${b===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${g}) *
                  getW(wF, wR, wC, ${g}, d2);
              } else if (${b===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${b===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1),
                  getX(batch, xF, xR, xC, ${g} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2),
                  getW(wF, wR, wC, ${g} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Wue{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wc(this.outputShape.length);const o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,f=e.filterWidth,d=f;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<f;v++)h+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<f;v++)h+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(d+1)/2;v++){const w=v*2;if(h+=`
           xC = xCCorner + ${w*c};
           `,l===1){if(w<f&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,c===1&&w>0?h+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<f)){const x=o%2===0?R4(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,c>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:h+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):x===1?h+=`
                     xC${w+1} = xTexelC${w};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<f&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<f&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<f&&(h+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<f&&(h+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<f&&(h+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",g="";s&&(r?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:p=`vec4 activation(vec4 x) {
           ${s}
         }`,g="result = activation(result);");const b=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${b}
         ${g}
         setOutput(result);
       }
     `}}class wHe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Wc(this.outputShape.length);const{dataFormat:s}=t,r=Mu(),a=s==="channelsLast",o=a?1:2,l=a?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let f=0;f<=1;f++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${f};

          ${c}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${l}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${f*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${f*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}function KN(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function Gue({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const c=n.shape,u=s.texData.get(n.dataId),f=t.inChannels,d=c[0]*c[1]*c[2],h=t.outChannels,p=t.dataFormat==="channelsLast",g=!1,b=!1;let v;const w=[];if(a!=null){const C=KN(a.shape,p);C!=null&&(a=Mn({inputs:{x:a},backend:s,attrs:{shape:C}}),w.push(a))}if(r!=null){const C=KN(r.shape,p);C!=null&&(r=Mn({inputs:{x:r},backend:s,attrs:{shape:C}}),w.push(r))}if(!((d===1||h===1)&&f>jue)&&u.isPacked&&p&&u.texture!=null&&c[2]%2!==0&&xr(u.shape.slice(-3),c.slice(-3))){const C=c[0]*c[1]*(c[2]+1),M={dataId:n.dataId,shape:[1,C,t.inChannels],dtype:n.dtype},k=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,we(GM(u.shape,M.shape),()=>`packed reshape ${u.shape} to ${M.shape} isn't free`);const E=Mn({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});w.push(E);const I=YN({a:M,b:E,backend:s,transposeA:g,transposeB:b,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:o}),A=s.texData.get(I.dataId);we(A.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=k,A.shape=t.outShape,v=Lf({inputs:{x:I},backend:s}),v.shape=t.outShape,w.push(I)}else{const C=t.outHeight*t.outWidth,M=Mn({inputs:{x:n},backend:s,attrs:{shape:p?[t.batchSize,C,t.inChannels]:[t.batchSize,t.inChannels,C]}}),k=Mn({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),E=YN({a:p?M:k,b:p?k:M,transposeA:!p,transposeB:b,backend:s,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:o});v=Mn({inputs:{x:E},backend:s,attrs:{shape:t.outShape}}),w.push(M),w.push(k),w.push(E)}for(const C of w)s.disposeIntermediateTensorInfo(C);return v}function Hue({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const{filterWidth:c,filterHeight:u,inChannels:f,outWidth:d,outHeight:h,dataFormat:p}=t,g=p==="channelsLast",b=c*u*f,v=h*d,w=[t.batchSize,b,v],x=!0,S=!1,C=[];if(a!=null){const Z=KN(a.shape,g);Z!=null&&(a=Mn({inputs:{x:a},backend:s,attrs:{shape:Z}}),C.push(a))}if(r!=null){const Z=KN(r.shape,g);Z!=null&&(r=Mn({inputs:{x:r},backend:s,attrs:{shape:Z}}),C.push(r))}const M=Mn({inputs:{x:e},backend:s,attrs:{shape:[1,b,Ot(e.shape)/b]}});C.push(M);const k=new wHe(w,t),E=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],I=s.runWebGLProgram(k,[n],"float32",E),A=Mn({inputs:{x:I},backend:s,attrs:{shape:w}});C.push(I),C.push(A);const D=r!=null,L=a!=null,P=l==="leakyrelu",j=l?HM(l,!0):null,G=new $ue(g?A.shape:M.shape,g?M.shape:A.shape,g?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],x,S,D,j,L,P),Q=g?[A,M]:[M,A];if(r&&Q.push(r),L&&Q.push(a),P){const Z=s.makeTensorInfo([],"float32",Wg(o,"float32"));Q.push(Z),C.push(Z)}const q=s.runWebGLProgram(G,Q,"float32"),te=Mn({inputs:{x:q},backend:s,attrs:{shape:t.outShape}});C.push(q);for(const Z of C)s.disposeIntermediateTensorInfo(Z);return te}function vHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:f}=s,d=Hg(c),h=Vl(r.shape,a.shape,o,u,l,f,!1,d);let p;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))p=Gue({x:r,filter:a,convInfo:h,backend:t});else if(h.strideWidth<=2&&d==="channelsLast"&&bt().getBool("WEBGL_EXP_CONV")){const b=new Wue(h),v=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=t.runWebGLProgram(b,[r,a],"float32",v)}else if(bt().getBool("WEBGL_CONV_IM2COL"))p=Hue({x:r,filter:a,convInfo:h,backend:t});else{const b=new Vue(h);p=t.runWebGLProgram(b,[r,a],"float32")}const g=Mn({inputs:{x:p},backend:t,attrs:{shape:h.outShape}});return t.disposeIntermediateTensorInfo(p),g}const _He={kernelName:PT,backendName:"webgl",kernelFunc:vHe};class xHe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class CHe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dataFormat==="channelsLast",l=t-1-e.padInfo.top,c=s-1-e.padInfo.left,u=o?1:2,f=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${f}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class SHe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,o=e.padInfo.top,l=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${l};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class MHe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=t-1-e.padInfo.front,u=s-1-e.padInfo.top,f=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${u}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function THe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:o,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:f}=s,d=Hg(c),h=Vl(r.shape,f,o,1,l,u,!1,d),p=new xHe(h);return t.runWebGLProgram(p,[r,a],"float32")}const kHe={kernelName:q4,backendName:"webgl",kernelFunc:THe};class EHe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Wc(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,r=t-1-e.padInfo.top,a=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}function IHe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{inputShape:o,strides:l,pad:c,dataFormat:u,dimRoundingMode:f}=s,d=Hg(u),h=Vl(o,a.shape,l,1,c,f,!1,d);if(bt().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const p=[[h.strideHeight,h.strideWidth]],g=new EHe(h);return t.runWebGLProgram(g,[r,a],"float32",p)}else{const p=new CHe(h);return t.runWebGLProgram(p,[r,a],"float32")}}const AHe={kernelName:$T,backendName:"webgl",kernelFunc:IHe};function LHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c}=s,u=M1(r.shape,a.shape,o,c,l),f=new bHe(u);return t.runWebGLProgram(f,[r,a],"float32")}const NHe={kernelName:jT,backendName:"webgl",kernelFunc:LHe};function DHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:o,pad:l,filterShape:c}=s,u=M1(r.shape,c,o,1,l),f=new SHe(u);return t.runWebGLProgram(f,[r,a],"float32")}const OHe={kernelName:Y4,backendName:"webgl",kernelFunc:DHe};function PHe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{pad:o,strides:l,inputShape:c}=s,u=M1(c,a.shape,l,1,o),f=new MHe(u);return t.runWebGLProgram(f,[r,a],"float32")}const $He={kernelName:K4,backendName:"webgl",kernelFunc:PHe};const jHe=nx+`
  return cos(x);
`,RHe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${rw}
  return result;
`,FHe=qr({opSnippet:jHe,packedOpSnippet:RHe}),zHe={kernelName:X2,backendName:"webgl",kernelFunc:FHe};const BHe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,UHe=qr({opSnippet:BHe}),VHe={kernelName:Q2,backendName:"webgl",kernelFunc:UHe};class WHe{constructor(e,t,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,l,c,u]=e,[f]=t,[d,h]=s;this.outputShape=[f,d,h,u];const p=r==="bilinear"?1:0,[g,b]=[`${l-1}.0`,`${c-1}.0`],[v,w,x]=d>1?[`${(l-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${g} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${g}`],[S,C,M]=h>1?[`${(c-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${b} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${b}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${S});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${C};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${g} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${M};
        if( in_x < 0.0 || in_x > ${b} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}const GHe=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:a,boxInd:o}=e,{cropSize:l,method:c,extrapolationValue:u}=s,f=new WHe(r.shape,a.shape,l,c,u);return t.runWebGLProgram(f,[r,a,o],"float32")},HHe={kernelName:Q4,backendName:"webgl",kernelFunc:GHe};var YM;(function(n){n.Prod="*",n.Sum="+"})(YM||(YM={}));class Cq{constructor(e,t,s,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,o=this.op===YM.Prod?"1.0":"0.0",l=s?o:`getX(${Sq(a,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let u="",f="";s?(u=r?`end != ${c-1}`:"end != 0",f=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${c}`:"end >= pow2",f=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${qi(a)} coords = getOutputCoords();
        int end = ${Mq(a,"coords",this.op)};
        float val = ${l};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${f};
          ${Mq(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${Sq(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Sq(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function Mq(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function que(n,e,t,s,r,a){const o=e.shape.length,l=no([s],o);let c=e;l!=null&&(c=xu({inputs:{x:e},backend:t,attrs:{perm:l}}));const u=jo(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const f=c.shape[u];let d=Lf({inputs:{x:c},backend:t});for(let h=0;h<=Math.ceil(Math.log2(f))-1;h++){const p=new Cq(n,c.shape,!1,a),g=[[h]],b=d;d=t.runWebGLProgram(p,[d],d.dtype,g),t.disposeIntermediateTensorInfo(b)}if(r){const h=new Cq(n,c.shape,r,a),p=d;d=t.runWebGLProgram(h,[d],d.dtype),t.disposeIntermediateTensorInfo(p)}if(l!=null){const h=T1(l),p=xu({inputs:{x:d},backend:t,attrs:{perm:h}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(c),p}return d}function qHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;return que(YM.Prod,r,t,a,o,l)}const YHe={kernelName:X4,backendName:"webgl",kernelFunc:qHe};function KHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;return que(YM.Sum,r,t,a,o,l)}const XHe={kernelName:RT,backendName:"webgl",kernelFunc:KHe};function QHe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:o,binaryOutput:l}=s;if(r.shape.length===1){const c=t.readSync(r.dataId),u=t.readSync(a.dataId),f=Mue(c,u,a.dtype,a.shape,o);return t.makeTensorInfo([o],a.dtype,f)}else if(r.shape.length===2){const c=t.bufferSync(r),u=t.bufferSync(a),f=eVe(c,u,o,l);return t.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const JHe={kernelName:J4,backendName:"webgl",kernelFunc:QHe};class ZHe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}function eqe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:a,dataFormat:o}=s,l=r.shape[0],c=o==="NHWC"?r.shape[1]:r.shape[2],u=o==="NHWC"?r.shape[2]:r.shape[3],f=o==="NHWC"?r.shape[3]:r.shape[1],d=c*a,h=u*a,p=f/(a*a),g=o==="NHWC"?[l,d,h,p]:[l,p,d,h],b=new ZHe(g,a,o);return t.runWebGLProgram(b,[r],r.dtype)}const tqe={kernelName:Z4,backendName:"webgl",kernelFunc:eqe};class Yue{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wc(this.outputShape.length);const o=e.filterHeight,l=e.filterWidth,c=e.outChannels/e.inChannels;let u="",f="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,f="result = activation(result);");const d=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${c};
        int q = d2 - d1 * ${c};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${l}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${f}
        setOutput(result);
      }
    `}}class Kue{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wc(this.outputShape.length);const o=e.outChannels/e.inChannels,l=e.padInfo.left,c=e.strideWidth,u=e.dilationWidth,f=e.filterHeight,d=e.filterWidth,h=d;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<d;w++)p+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;p+=`
    for (int r = 0; r < ${f}; r++) {
      `;for(let w=0;w<d;w++)p+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(h+1)/2;w++){const x=w*2;if(p+=`
          xC = xCCorner + ${x*u};
          `,c===1){if(x<d&&(l%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,u===1&&x>0?p+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const S=l%2===0?R4(u):u;u%2===0&&l%2===1||u%2!==0&&l%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${S};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:p+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):S===1?p+=`
                    xC${x+1} = xTexelC${x};
                    `:p+=`
                    xCOffset = xC + ${S};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(l%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(p+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(p+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(p+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let g="",b="";s&&(r?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:g=`vec4 activation(vec4 x) {
          ${s}
        }`,b="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${b}
        setOutput(result);
      }
    `}}function nqe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=s;let f=c;f==null&&(f=[1,1]),we(gc(o,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${f}'`);const d=Vl(r.shape,a.shape,o,f,l,u,!0);let h;bt().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new Kue(d):h=new Yue(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return t.runWebGLProgram(h,[r,a],"float32",p)}const sqe={kernelName:FT,backendName:"webgl",kernelFunc:nqe};class rqe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class iqe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=t-1-e.padInfo.top,l=s-1-e.padInfo.left,c=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function aqe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,filterShape:f}=s,d=Vl(r.shape,f,o,l,c,u,!0),h=new rqe(d);return t.runWebGLProgram(h,[r,a],"float32")}const oqe={kernelName:eD,backendName:"webgl",kernelFunc:aqe};function lqe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,inputShape:f}=s,d=Vl(f,a.shape,o,l,c,u,!0),h=new iqe(d);return t.runWebGLProgram(h,[r,a],"float32")}const cqe={kernelName:tD,backendName:"webgl",kernelFunc:lqe};class uqe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}function fqe(n){const{inputs:e,backend:t}=n,{x:s}=e,r=[...s.shape,...s.shape],a=Ot(s.shape),o=Mn({inputs:{x:s},backend:t,attrs:{shape:[a]}}),l=new uqe(a),c=t.runWebGLProgram(l,[o],o.dtype),u=Mn({inputs:{x:c},backend:t,attrs:{shape:r}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(c),u}const dqe={kernelName:nD,backendName:"webgl",kernelFunc:fqe};class hqe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:r,strideHeight:a,strideWidth:o,filterHeight:l,filterWidth:c,dilationHeight:u,dilationWidth:f}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${l}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${f};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}function pqe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c}=s,u=Ik(r.shape,a.shape,o,l,"NHWC",c);let f;const d=new hqe(u);f=t.runWebGLProgram(d,[r,a],"float32");const h=Mn({inputs:{x:f},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(f),h}const mqe={kernelName:zT,backendName:"webgl",kernelFunc:pqe};function gqe(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,a=e,{allDims:o,summedDims:l,idDims:c}=WB(r,a.length);HB(o.length,c,a);const{path:u,steps:f}=qB(l,c),d=f.length;let h=null,p=o.length;const g=[];for(let b=0;b<d;++b){for(const v of f[b]){const{permutationIndices:w,expandDims:x}=GB(p,c[v]);let S;YB(w)?S=a[v]:(S=xu({inputs:{x:a[v]},backend:t,attrs:{perm:w}}),g.push(S));const C=S.shape.slice();for(let M=0;M<x.length;++M)C.splice(x[M],0,1);xr(S.shape,C)||(S=Mn({inputs:{x:S},backend:t,attrs:{shape:C}}),g.push(S)),h===null?h=S:(h=tU({inputs:{a:S,b:h},backend:t}),g.push(h))}b<d-1&&(u[b]>=0&&(h=rP({inputs:{x:h},backend:t,attrs:{axis:u[b]-(o.length-p),keepDims:!1}}),g.push(h)),p--)}for(const b of g)b!==h&&t.disposeIntermediateTensorInfo(b);return h}const yqe={kernelName:rD,backendName:"webgl",kernelFunc:gqe};const bqe="return (x >= 0.0) ? x : (exp(x) - 1.0);",wqe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,vqe=qr({opSnippet:bqe,packedOpSnippet:wqe}),_qe={kernelName:Z2,backendName:"webgl",kernelFunc:vqe};const xqe="return (b >= 0.0) ? a : a * (b + 1.0);",Cqe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Sqe=n=>{const{inputs:e,backend:t}=n,{dy:s,y:r}=e,a=bt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new tx(Cqe,s.shape,r.shape):new Lb(xqe,s.shape,r.shape);return t.runWebGLProgram(a,[s,r],s.dtype)},Mqe={kernelName:iD,backendName:"webgl",kernelFunc:Sqe};const Tqe=`
  return vec4(equal(a, b));
`,kqe="return float(a == b);",Eqe=wc({opSnippet:kqe,packedOpSnippet:Tqe,dtype:"bool",cpuKernelImpl:iVe}),Iqe={kernelName:BT,backendName:"webgl",kernelFunc:Eqe};const Aqe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${jB};
  float a1 = ${RB};
  float a2 = ${FB};
  float a3 = ${zB};
  float a4 = ${BB};
  float a5 = ${UB};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Lqe=qr({opSnippet:Aqe}),Nqe={kernelName:e_,backendName:"webgl",kernelFunc:Lqe};const Dqe=nx+`
  return exp(x);
`,Oqe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Xue=qr({opSnippet:Dqe,packedOpSnippet:Oqe,cpuKernelImpl:aVe,dtype:"float32"}),Pqe={kernelName:t_,backendName:"webgl",kernelFunc:Xue};function p6(n){const{inputs:e,attrs:t,backend:s}=n,{dim:r}=t,{input:a}=e,o=a.shape.length,l=a.shape.slice();let c=r;return r<0&&(we(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+r+1),l.splice(c,0,1),Mn({inputs:{x:a},backend:s,attrs:{shape:l}})}const $qe={kernelName:UT,backendName:"webgl",kernelFunc:p6};const Tq="return exp(x) - 1.0;",jqe=qr({opSnippet:Tq,packedOpSnippet:Tq,cpuKernelImpl:oVe}),Rqe={kernelName:n_,backendName:"webgl",kernelFunc:jqe};class kq{constructor(e,t,s){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let l;if(e==="real")l="return real * expR - imag * expI;";else if(e==="imag")l="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${l}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}function Que(n,e,t){const s=t.texData.get(n.dataId),r=Ot(n.shape),a=n.shape[n.shape.length-1],o=r/a,l=Mn({inputs:{x:n},backend:t,attrs:{shape:[o,a]}}),c=l.shape,u=new kq("real",c,e),f=new kq("imag",c,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:c},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:c}],h=t.runWebGLProgram(u,d,"float32"),p=t.runWebGLProgram(f,d,"float32"),g=N1({inputs:{real:h,imag:p},backend:t});t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p);const b=Mn({inputs:{x:g},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(g),b}function Fqe(n){const{inputs:e,backend:t}=n,{input:s}=e;return Que(s,!1,t)}const zqe={kernelName:aD,backendName:"webgl",kernelFunc:Fqe};class Bqe{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}function dE(n){const{backend:e,attrs:t}=n,{shape:s,value:r}=t;let{dtype:a}=t;if(a=a||Hb(r),a==="string"){const o=po(a,Ot(s));return o.fill(r),e.makeTensorInfo(s,a,o)}else{const o=new Bqe(s,r),l=[[r]];return e.runWebGLProgram(o,[],a,l)}}const Uqe={kernelName:oD,backendName:"webgl",kernelFunc:dE};class Vqe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}const Wqe={kernelName:lD,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,r=new Vqe(t.shape);return s.runWebGLProgram(r,[t],t.dtype)}};const Eq="return floor(x);",Gqe=qr({opSnippet:Eq,packedOpSnippet:Eq,cpuKernelImpl:lVe}),Hqe={kernelName:s_,backendName:"webgl",kernelFunc:Gqe};const qqe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Yqe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Kqe=wc({opSnippet:qqe,packedOpSnippet:Yqe,dtype:"int32"}),Xqe={kernelName:r_,backendName:"webgl",kernelFunc:Kqe};class Qqe{constructor(e){this.variableNames=["A"];const t=Mu(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}class Jqe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Mu(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}const Zqe={kernelName:MN,backendName:"webgl",kernelFunc:eYe};let gv,P5=bt().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function eYe(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:r}=e;const{numChannels:a}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[c,u]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],f=[u,c],d=[u,c,a];if(l||o){const b=bt().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(gv==null||b!==P5)&&(P5=b,gv=document.createElement("canvas").getContext("2d",{willReadFrequently:P5})),gv.canvas.width=c,gv.canvas.height=u,gv.drawImage(r,0,0,c,u),r=gv.canvas}const h=t.makeTensorInfo(f,"int32");t.texData.get(h.dataId).usage=pd.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(h.dataId),r);const p=bt().getBool("WEBGL_PACK")?new Jqe(d):new Qqe(d),g=t.runWebGLProgram(p,[h],"int32");return t.disposeData(h.dataId),g}function tYe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:f,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:g}=s,b=Hg(f),v=Vl(r.shape,a.shape,c,d,u,h,!1,b);let w;const x=[],S=o!=null,C=l!=null,M=p==="leakyrelu",k=()=>{const I=[r,a],A=(D,L)=>{if(L==="NCHW"&&D.shape.length===1&&D.shape[0]!==1){const P=Mn({inputs:{x:D},backend:t,attrs:{shape:[D.shape[0],1,1]}});return x.push(P),P}return D};if(S&&I.push(A(o,f)),C&&I.push(A(l,f)),M){const D=t.makeTensorInfo([],"float32",Wg(g,"float32"));I.push(D),x.push(D)}return I};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))w=Gue({x:r,filter:a,convInfo:v,backend:t,bias:o,activation:p,preluActivationWeights:l,leakyreluAlpha:g});else if(v.strideWidth<=2&&b==="channelsLast"&&bt().getBool("WEBGL_EXP_CONV")){const I=p?HM(p,!0):null,A=new Wue(v,S,I,C,M),D=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],L=k();w=t.runWebGLProgram(A,L,"float32",D)}else if(bt().getBool("WEBGL_CONV_IM2COL"))w=Hue({x:r,filter:a,convInfo:v,backend:t,bias:o,activation:p,preluActivationWeights:l,leakyreluAlpha:g});else{const I=p?HM(p,!1):null,A=new Vue(v,S,I,C,M),D=k();w=t.runWebGLProgram(A,D,"float32")}const E=Mn({inputs:{x:w},backend:t,attrs:{shape:v.outShape}});return x.push(w),x.forEach(I=>t.disposeIntermediateTensorInfo(I)),E}const nYe={kernelName:LM,backendName:"webgl",kernelFunc:tYe};function sYe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=s,g=[];let b=f;b==null&&(b=[1,1]),we(gc(c,b),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${b}'`);const v=Vl(r.shape,a.shape,c,b,u,d,!0),w=bt().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,x=h?HM(h,w):null,S=[r,a],C=o!=null,M=l!=null,k=h==="leakyrelu";if(C&&S.push(o),M&&S.push(l),k){const D=t.makeTensorInfo([],"float32",Wg(p,"float32"));S.push(D),g.push(D)}let E;w?E=new Kue(v,C,x,M,k):E=new Yue(v,C,x,M,k);const I=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],A=t.runWebGLProgram(E,S,"float32",I);return g.forEach(D=>t.disposeIntermediateTensorInfo(D)),A}const rYe={kernelName:NM,backendName:"webgl",kernelFunc:sYe};class iYe{constructor(e,t,s,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=qi(s.length);let o=`
    int index;`;for(let l=0;l<this.sliceDim;l++)o+=`
          index = round(getIndices(coords[0], ${l}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[l]};
          flattenIndex += index * ${this.strides[l]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}function aYe(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,a=r.shape,o=a[a.length-1],l=Ot(s.shape),[c,u,f,d]=IO(s,r),h=Mn({inputs:{x:r},backend:t,attrs:{shape:[u,o]}}),p=Mn({inputs:{x:s},backend:t,attrs:{shape:[Ot(s.shape)/f,f]}});if(t.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const w=t.readSync(r.dataId),x=t.bufferSync(s),S=cVe(w,x,s.dtype,u,o,f,d,s.shape,l);return t.makeTensorInfo(c,s.dtype,S.values)}const g=new iYe(o,d,[u,f],s.shape),b=t.runWebGLProgram(g,[p,h],p.dtype),v=Mn({inputs:{x:b},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(b),v}const oYe={kernelName:cD,backendName:"webgl",kernelFunc:aYe};class lYe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=qi(this.rank),r=cYe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function cYe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${t[r]}`);return s.join()}function Jue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:a}=e,{axis:o,batchDims:l}=s,c=dr(o,r.shape)[0];if(bt().get("DEBUG")){const x=t.readSync(a.dataId),S=r.shape[c];for(let C=0;C<x.length;++C){const M=x[C];we(M<=S-1&&M>=0,()=>`GatherV2: the index value ${M} is not in [0, ${S-1}]`)}}const u=XB(r,a,c,l),f=Ot(a.shape),d=[],h=Mn({inputs:{x:r},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=Mn({inputs:{x:a},backend:t,attrs:{shape:[u.batchSize,f/u.batchSize]}});d.push(h),d.push(p);const g=[u.batchSize,u.outerSize,f/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const x=t.bufferSync(p),S=t.bufferSync(h),C=uVe(S,x,g);return d.forEach(M=>t.disposeIntermediateTensorInfo(M)),t.makeTensorInfo(u.outputShape,C.dtype,C.values)}const b=new lYe(h.shape,g),v=t.runWebGLProgram(b,[h,p],h.dtype);d.push(v);const w=Mn({inputs:{x:v},backend:t,attrs:{shape:u.outputShape}});return d.forEach(x=>t.disposeIntermediateTensorInfo(x)),w}const uYe={kernelName:WT,backendName:"webgl",kernelFunc:Jue};const fYe="return float(a > b);",dYe=`
  return vec4(greaterThan(a, b));
`,hYe=wc({opSnippet:fYe,packedOpSnippet:dYe,cpuKernelImpl:fVe,dtype:"bool"}),pYe={kernelName:GT,backendName:"webgl",kernelFunc:hYe};const mYe="return float(a >= b);",gYe=`
  return vec4(greaterThanEqual(a, b));
`,yYe=wc({opSnippet:mYe,packedOpSnippet:gYe,dtype:"bool",cpuKernelImpl:dVe}),bYe={kernelName:i_,backendName:"webgl",kernelFunc:yYe};function wYe(n){const{inputs:e,backend:t}=n,{input:s}=e;return Que(s,!0,t)}const vYe={kernelName:uD,backendName:"webgl",kernelFunc:wYe};const _Ye="return float(!isnan(x) && !isinf(x));",xYe=qr({opSnippet:_Ye,dtype:"bool"}),CYe={kernelName:o_,backendName:"webgl",kernelFunc:xYe};const SYe="return float(isinf(x));",MYe=qr({opSnippet:SYe,dtype:"bool"}),TYe={kernelName:l_,backendName:"webgl",kernelFunc:MYe};const kYe="return float(isnan(x));",EYe=qr({opSnippet:kYe,dtype:"bool"}),IYe={kernelName:c_,backendName:"webgl",kernelFunc:EYe};const AYe="return float(a < b);",LYe=`
  return vec4(lessThan(a, b));
`,NYe=wc({opSnippet:AYe,packedOpSnippet:LYe,cpuKernelImpl:hVe,dtype:"bool"}),DYe={kernelName:qT,backendName:"webgl",kernelFunc:NYe};const OYe="return float(a <= b);",PYe=`
  return vec4(lessThanEqual(a, b));
`,$Ye=wc({opSnippet:OYe,packedOpSnippet:PYe,cpuKernelImpl:pVe,dtype:"bool"}),jYe={kernelName:YT,backendName:"webgl",kernelFunc:$Ye};function RYe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:a}=t,o=mVe(s,r,a);return e.makeTensorInfo([o.length],"float32",o)}const FYe={kernelName:dD,backendName:"webgl",kernelFunc:RYe};const zYe=nx+`
  return x < 0.0 ? 0./0. : log(x);
`,BYe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,UYe=qr({opSnippet:zYe,packedOpSnippet:BYe,cpuKernelImpl:gVe}),VYe={kernelName:u_,backendName:"webgl",kernelFunc:UYe};const WYe=nx+`
  return log(1.0 + x);
`,GYe=qr({opSnippet:WYe}),HYe={kernelName:f_,backendName:"webgl",kernelFunc:GYe};const qYe="return float(a >= 1.0 && b >= 1.0);",YYe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,KYe=wc({opSnippet:qYe,packedOpSnippet:YYe,dtype:"bool"}),XYe={kernelName:KT,backendName:"webgl",kernelFunc:KYe};const QYe="return float(!(x >= 1.0));",JYe=qr({opSnippet:QYe}),ZYe={kernelName:XT,backendName:"webgl",kernelFunc:JYe};const eKe="return float(a >= 1.0 || b >= 1.0);",tKe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,nKe=wc({opSnippet:eKe,packedOpSnippet:tKe,dtype:"bool"}),sKe={kernelName:QT,backendName:"webgl",kernelFunc:nKe};class rKe{constructor(e,t,s,r,a){this.variableNames=["x"],this.outputShape=[];const o=t,l=e[3]-1;this.outputShape=e;let c;const u=`float(${s}) + float(${r}) * sum`;a===.5?c=`inversesqrt(${u})`:a===1?c=`1.0/(${u})`:c=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${l}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}class iKe{constructor(e,t,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=t,l=e[3]-1;this.outputShape=e;let c;const u=`float(${s}) + float(${r}) * sum`;a===.5?c=`inversesqrt(${u})`:a===1?c=`1.0/(${u})`:c=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${l}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}const aKe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:a,bias:o,alpha:l,beta:c}=s,u=bt().getBool("WEBGL_PACK_NORMALIZATION")?new iKe(r.shape,a,o,l,c):new rKe(r.shape,a,o,l,c);return t.runWebGLProgram(u,[r],r.dtype)},oKe={kernelName:JT,backendName:"webgl",kernelFunc:aKe};class lKe{constructor(e,t,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}const cKe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r,y:a,dy:o}=e,{depthRadius:l,bias:c,alpha:u,beta:f}=s,d=new lKe(r.shape,l,c,u,f);return t.runWebGLProgram(d,[r,a,o],r.dtype)},uKe={kernelName:hD,backendName:"webgl",kernelFunc:cKe};function fKe(n,e,t,s){const r=Ot(e),o=Ot(n.shape)/r,l=Mn({inputs:{x:n},attrs:{shape:[o,r]},backend:s}),c=iw(l,n.dtype,"max",s),u=Mn({inputs:{x:c},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(c),u}function Zue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:a,keepDims:o}=s,l=r.shape.length,c=dr(a,r.shape);let u=c;const f=no(u,l),d=f!=null,h=t.shouldExecuteOnCPU([r]);let p=r;if(d){if(h){const S=t.texData.get(p.dataId).values,C=new Array(l);for(let E=0;E<C.length;E++)C[E]=r.shape[f[E]];const M=Z9(S,r.shape,r.dtype,f,C);p=t.makeTensorInfo(C,r.dtype);const k=t.texData.get(p.dataId);k.values=M}else p=sP(r,f,t);u=jo(u.length,l)}yc("max",u,l);const[g,b]=Wl(p.shape,u);let v=g;o&&(v=$o(g,c));let w;if(h){const S=t.texData.get(p.dataId).values,C=yVe(S,Ot(b),v,r.dtype);w=t.makeTensorInfo(v,r.dtype);const M=t.texData.get(w.dataId);M.values=C}else w=fKe(p,b,v,t);return d&&t.disposeIntermediateTensorInfo(p),w}const dKe={kernelName:ZT,backendName:"webgl",kernelFunc:Zue};const hKe=eU+`
  return max(a, b);
`,pKe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+rw+`
  return result;
`,mKe=wc({opSnippet:hKe,packedOpSnippet:pKe,cpuKernelImpl:bVe}),gKe={kernelName:d_,backendName:"webgl",kernelFunc:mKe};function yKe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;X_(r,"maxPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;we(gc(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=vh(r.shape,a,o,u,l,c);if(f.filterWidth===1&&f.filterHeight===1&&xr(f.inShape,f.outShape))return Lf({inputs:{x:r},backend:t});const d=new qM(f,"max",!1);return t.runWebGLProgram(d,[r],r.dtype)}const bKe={kernelName:ek,backendName:"webgl",kernelFunc:yKe};function wKe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=s,f=[1,1,1],d=Gg(r.shape,a,o,f,l,u,c),h=new nU(d,"max",!1);return t.runWebGLProgram(h,[r],r.dtype)}const vKe={kernelName:tk,backendName:"webgl",kernelFunc:wKe};class _Ke{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,o=e.effectiveFilterWidth,l=a-1-e.padInfo.top,c=o-1-e.padInfo.left,u=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class xKe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=c-1-e.padInfo.front,h=u-1-e.padInfo.top,p=f-1-e.padInfo.left,g=c*u*f-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${g} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${f} +
                  wR * ${f} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function CKe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,o=a,{filterSize:l,strides:c,pad:u,dimRoundingMode:f}=s,d=[1,1,1],h=Gg(o.shape,l,c,d,u,f),p=new nU(h,"max",!0),g=t.runWebGLProgram(p,[o],o.dtype),b=new xKe(h),v=t.runWebGLProgram(b,[r,g],o.dtype);return t.disposeIntermediateTensorInfo(g),v}const SKe={kernelName:mD,backendName:"webgl",kernelFunc:CKe};function MKe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a,output:o}=e,l=a;X_([a,o],"maxPoolGrad");const{filterSize:c,strides:u,pad:f,dimRoundingMode:d}=s,h=vh(l.shape,c,u,1,f,d),p=!0,g=new qM(h,"max",p),b=t.runWebGLProgram(g,[l],l.dtype),v=new _Ke(h),w=t.runWebGLProgram(v,[r,b],l.dtype);return t.disposeIntermediateTensorInfo(b),w}const TKe={kernelName:pD,backendName:"webgl",kernelFunc:MKe};function kKe(n,e,t,s){let r=new qM(t,"max",!1);const a=s.runWebGLProgram(r,[n],"float32");r=new qM(t,"max",!0,!0,e);const o=s.runWebGLProgram(r,[n],"float32");return[a,o]}const EKe={kernelName:gD,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:a,pad:o,includeBatchInIndex:l}=e,c=t;we(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];we(gc(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const f=vh(s.shape,r,a,u,o),[d,h]=kKe(s,l,f,c);return[d,h]}};function IKe(n,e,t,s){const r=Ot(e),o=Ot(n.shape)/r,l=Mn({inputs:{x:n},attrs:{shape:[o,r]},backend:s}),c=iw(l,"float32","mean",s),u=Mn({inputs:{x:c},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(c),u}const AKe={kernelName:nk,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:r,axis:a}=e,o=t,l=s.shape.length,c=dr(a,s.shape);let u=c;const f=no(u,l),d=f!=null,h=o.shouldExecuteOnCPU([s]),p=[];let g=s;if(d){if(h){const C=o.texData.get(g.dataId).values,M=new Array(l);for(let I=0;I<M.length;I++)M[I]=s.shape[f[I]];const k=Z9(C,s.shape,s.dtype,f,M);g=o.makeTensorInfo(M,s.dtype);const E=o.texData.get(g.dataId);E.values=k}else g=sP(s,f,o);p.push(g),u=jo(u.length,l)}yc("sum",u,l);const[b,v]=Wl(g.shape,u);let w=b;r&&(w=$o(b,c));const x=IKe(g,v,w,o);for(const S of p)o.disposeIntermediateTensorInfo(S);return x}};function LKe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=dr(a,r.shape);let u=c;const f=no(u,l);let d=r;f!=null&&(d=xu({inputs:{x:r},backend:t,attrs:{perm:f}}),u=jo(u.length,r.shape.length)),yc("min",u,l);const[h,p]=Wl(d.shape,u),g=Ot(p),b=Mn({inputs:{x:d},backend:t,attrs:{shape:[-1,g]}}),v=iw(b,b.dtype,"min",t);let w;if(o){const x=$o(h,c);w=Mn({inputs:{x:v},backend:t,attrs:{shape:x}})}else w=Mn({inputs:{x:v},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),f!=null&&t.disposeIntermediateTensorInfo(d),w}const NKe={kernelName:sk,backendName:"webgl",kernelFunc:LKe};const DKe=eU+`
  return min(a, b);
`,OKe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+rw+`
  return result;
`,PKe=wc({opSnippet:DKe,packedOpSnippet:OKe,cpuKernelImpl:wVe}),$Ke={kernelName:h_,backendName:"webgl",kernelFunc:PKe};class jKe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((f,d)=>f[0]+e[d]+f[1]);const r=e.length,a=qi(r),o=t.map(f=>f[0]).join(","),l=t.map((f,d)=>f[0]+e[d]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}class RKe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((g,b)=>g[0]+e[b]+g[1]);const r=e.length,a=qi(r),o=t.map(g=>g[0]).join(","),l=t.map((g,b)=>g[0]+e[b]).join(","),c=gu("rc",r),u=gu("source",r),f=`${c[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${u.slice(-2).join()})`,h=s==="reflect"?0:1;let p="";if(r===1){const g=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${c[r-1]} += 1;
        if(${f}) {
          ${g}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const g=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${c[r-1]} += 1;
        if(${f}) {
          ${g}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${c[r-2]} += 1;
        if(${c[r-2]} < ${this.outputShape[r-2]}) {
          ${g}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${c[r-1]} += 1;
          if(${f}) {
            ${g}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}const FKe=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:r,mode:a}=t,o=bt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RKe(s.shape,r,a):new jKe(s.shape,r,a);return e.runWebGLProgram(o,[s],s.dtype)},zKe={kernelName:rk,backendName:"webgl",kernelFunc:FKe};const BKe=`if (b == 0.0) return NAN;
  return mod(a, b);`,UKe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+rw+`
  return result;
`,VKe=wc({opSnippet:BKe,packedOpSnippet:UKe}),WKe={kernelName:p_,backendName:"webgl",kernelFunc:VKe};class GKe{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}const HKe=`
if (a == b) {
  return 1.0;
};
return a / b;`,qKe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,efe=wc({opSnippet:HKe,packedOpSnippet:qKe,checkOutOfBounds:!0}),YKe={kernelName:J2,backendName:"webgl",kernelFunc:efe};const Iq="return a - b;",tfe=wc({opSnippet:Iq,packedOpSnippet:Iq,supportsComplex:!0,cpuKernelImpl:zVe}),KKe={kernelName:A_,backendName:"webgl",kernelFunc:tfe};function nfe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:a}=s,o=dr([a],r.shape),l=Zue({inputs:{x:r},backend:t,attrs:{reductionIndices:o,keepDims:!1}}),c=$o(l.shape,o),u=Mn({inputs:{x:l},backend:t,attrs:{shape:c}}),f=tfe({inputs:{a:r,b:u},backend:t}),d=Xue({inputs:{x:f},backend:t}),h=rP({inputs:{x:d},backend:t,attrs:{axis:o,keepDims:!1}}),p=Mn({inputs:{x:h},backend:t,attrs:{shape:c}}),g=efe({inputs:{a:d,b:p},backend:t});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),g}const XKe={kernelName:xk,backendName:"webgl",kernelFunc:nfe};function QKe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:a,seed:o,normalized:l}=s,c=l?r:nfe({inputs:{logits:r},backend:t,attrs:{dim:r.shape.length-1}}),u=c.shape[0],f=c.shape[1],d=new GKe(u,f,a),h=[[o]],p=t.runWebGLProgram(d,[c],"int32",h);return l||t.disposeIntermediateTensorInfo(c),p}const JKe={kernelName:yD,backendName:"webgl",kernelFunc:QKe};const ZKe=xh+`
  return -x;
`,eXe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function tXe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const a=t.texData.get(s.dataId),[o,l]=_Ve(a.values,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,o)}let r;return bt().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Q0(s.shape,eXe):r=new vm(s.shape,ZKe),t.runWebGLProgram(r,[s],s.dtype)}const nXe={kernelName:ik,backendName:"webgl",kernelFunc:tXe};const sXe=MO;function rXe(n){cd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=s,u=t.readSync(r.dataId),f=t.readSync(a.dataId),{selectedIndices:d}=sXe(u,f,o,l,c);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const iXe={kernelName:bD,backendName:"webgl",kernelFunc:rXe};const aXe=TO;function oXe(n){cd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=s,f=t.readSync(r.dataId),d=t.readSync(a.dataId),{selectedIndices:h,validOutputs:p}=aXe(f,d,o,l,c,u);return[t.makeTensorInfo([h.length],"int32",new Int32Array(h)),t.makeTensorInfo([],"int32",new Int32Array([p]))]}const lXe={kernelName:wD,backendName:"webgl",kernelFunc:oXe};const cXe=kO;function uXe(n){cd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=s,f=t.readSync(r.dataId),d=t.readSync(a.dataId),h=o,p=l,g=c,b=u,{selectedIndices:v,selectedScores:w}=cXe(f,d,h,p,g,b);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const fXe={kernelName:vD,backendName:"webgl",kernelFunc:uXe};class dXe{constructor(e,t,s,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}const hXe=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:a,depth:o,onValue:l,offValue:c}=s,u=Ot(r.shape),f=new dXe(u,o,l,c),d=Mn({inputs:{x:r},backend:t,attrs:{shape:[u]}}),h=t.runWebGLProgram(f,[d],a);t.disposeIntermediateTensorInfo(d);const p=[...r.shape,o],g=Mn({inputs:{x:h},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(h),g},pXe={kernelName:lk,backendName:"webgl",kernelFunc:hXe};function XN(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const r=fE({inputs:{input:s},backend:t}),a=XN({inputs:{x:r},backend:t}),o=iP({inputs:{input:s},backend:t}),l=XN({inputs:{x:o},backend:t}),c=N1({inputs:{real:a,imag:l},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}else return dE({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const mXe={kernelName:Tk,backendName:"webgl",kernelFunc:XN};function sfe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=fE({inputs:{input:s},backend:t}),a=sfe({inputs:{x:r},backend:t}),o=iP({inputs:{input:s},backend:t}),l=XN({inputs:{x:o},backend:t}),c=N1({inputs:{real:a,imag:l},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}else return dE({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const gXe={kernelName:ok,backendName:"webgl",kernelFunc:sfe};function yXe(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return p6({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const a=e[0].shape,o=e[0].dtype;e.forEach(f=>{mc(a,f.shape,"All tensors passed to stack must have matching shapes"),we(o===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],c=e.map(f=>{const d=p6({inputs:{input:f},backend:t,attrs:{dim:r}});return l.push(d),d}),u=Uue({inputs:c,backend:t,attrs:{axis:r}});return l.forEach(f=>t.disposeIntermediateTensorInfo(f)),u}const bXe={kernelName:ck,backendName:"webgl",kernelFunc:yXe};class wXe{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,f)=>u[0]+e[f]+u[1]);const r=e.length,a=qi(r),o=t.map(u=>u[0]).join(","),l=t.map((u,f)=>u[0]+e[f]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}class vXe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((b,v)=>b[0]+e[v]+b[1]);const r=e.length,a=qi(r),o=t.map(b=>b[0]).join(","),l=t.map((b,v)=>b[0]+e[v]).join(","),c=gu("rc",r),u=gu("source",r),f=`${c[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${a} rc = outputLoc;`,`${c[r-1]} += 1;
       if(${f}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${c[r-2]} += 1;
       if(${c[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${c[r-1]} += 1;
         if(${f}) {`],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let g="";for(let b=0,v=r===1?2:4;b<v;b++)g+=`
        ${h[b]}
        if (${p}) {
          result[${b}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${b}] = getChannel(getX(${u.join()}), ${d});
        }
      `;g+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}const rfe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:a,constantValue:o}=s;if(Ot(r.shape)===0){const u=a.map((f,d)=>f[0]+r.shape[d]+f[1]);return dE({backend:t,attrs:{shape:u,value:o,dtype:r.dtype}})}const l=bt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vXe(r.shape,a,o):new wXe(r.shape,a,o),c=[[o]];return t.runWebGLProgram(l,[r],r.dtype,c)},_Xe={kernelName:uk,backendName:"webgl",kernelFunc:rfe};const xXe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,CXe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+rw+`
  return result;
`,SXe=wc({opSnippet:xXe,packedOpSnippet:CXe}),MXe={kernelName:g_,backendName:"webgl",kernelFunc:SXe};function TXe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=[],u=dr(a,r.shape);let f=u;const d=no(f,l);let h=r;d!=null&&(h=xu({inputs:{x:r},backend:t,attrs:{perm:d}}),f=jo(f.length,l),c.push(h)),yc("prod",f,l);let p;if(t.shouldExecuteOnCPU([h])){const g=t.texData.get(h.dataId).values,{outVals:b,outShape:v,outDtype:w}=CVe(h.shape,h.dtype,g,f);p=t.makeTensorInfo(v,w,b)}else{const[g,b]=Wl(h.shape,f),v=Ot(b),w=Mn({inputs:{x:h},backend:t,attrs:{shape:[-1,v]}}),x=HD(r.dtype),S=iw(w,x,"prod",t);p=Mn({inputs:{x:S},backend:t,attrs:{shape:g}}),c.push(w),c.push(S)}if(o){c.push(p);const g=$o(p.shape,u);p=Mn({inputs:{x:p},backend:t,attrs:{shape:g}})}return c.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}const kXe={kernelName:dk,backendName:"webgl",kernelFunc:TXe};function EXe(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:o}=e,{outputRaggedRank:l}=s,c=r.map(w=>t.readSync(w.dataId)),u=r.map(w=>w.shape),f=t.readSync(a.dataId),d=t.readSync(o.dataId),[h,p,g]=SVe(c,u,f,a.shape,a.dtype,d,o.shape,l),b=h.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(g,a.dtype,p);return b.concat([v])}const IXe={kernelName:_D,backendName:"webgl",kernelFunc:EXe};function AXe(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:a}=e,o=t.readSync(s.dataId),l=t.readSync(r.dataId),c=t.readSync(a.dataId),[u,f]=MVe(o,s.shape,s.dtype,l,r.shape,c,a.shape),d=t.makeTensorInfo([u.length],"int32",u),h=t.makeTensorInfo([f.length],s.dtype,f);return[d,h]}const LXe={kernelName:xD,backendName:"webgl",kernelFunc:AXe};function NXe(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:a,defaultValue:o,rowPartitionTensors:l}=e,{rowPartitionTypes:c}=s,u=t.readSync(r.dataId),f=t.readSync(a.dataId),d=t.readSync(o.dataId),h=l.map(v=>t.readSync(v.dataId)),p=l.map(v=>v.shape),[g,b]=TVe(u,r.shape,f,a.shape,a.dtype,d,o.shape,h,p,c);return t.makeTensorInfo(g,a.dtype,b)}const DXe={kernelName:CD,backendName:"webgl",kernelFunc:NXe};const ife=n=>{const{backend:e,attrs:t}=n,{start:s,stop:r,step:a,dtype:o}=t,l=kVe(s,r,a,o);return e.makeTensorInfo([l.length],o,l)},OXe={kernelName:SD,backendName:"webgl",kernelFunc:ife};const PXe="return 1.0 / x;",$Xe=qr({opSnippet:PXe}),jXe={kernelName:y_,backendName:"webgl",kernelFunc:$Xe};const RXe=xh+`
  return (x < 0.0) ? 0.0 : x;
`,FXe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zXe=qr({opSnippet:RXe,packedOpSnippet:FXe}),BXe={kernelName:b_,backendName:"webgl",kernelFunc:zXe};const UXe=xh+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,VXe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,WXe=qr({opSnippet:UXe,packedOpSnippet:VXe}),GXe={kernelName:w_,backendName:"webgl",kernelFunc:WXe};class HXe{constructor(e,t,s,r,a){this.variableNames=["A"],this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,t,s,u];const f=[r&&t>1?l-1:l,r&&s>1?c-1:c],d=[r&&t>1?t-1:t,r&&s>1?s-1:s];let h;a?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/d[0]},
          ${f[1]/d[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}class qXe{constructor(e,t,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,t,s,u];const f=[r&&t>1?l-1:l,r&&s>1?c-1:c],d=[r&&t>1?t-1:t,r&&s>1?s-1:s];let h;a?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/d[0]},
          ${f[1]/d[1]},
          ${f[1]/d[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}function YXe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s,[c,u]=l,f=bt().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qXe(r.shape,c,u,a,o):new HXe(r.shape,c,u,a,o);return t.runWebGLProgram(f,[r],"float32")}const KXe={kernelName:mk,backendName:"webgl",kernelFunc:YXe};class XXe{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,o,l]=e,c=[s&&o>1?r-1:r,s&&l>1?a-1:a],u=[s&&o>1?o-1:o,s&&l>1?l-1:l],f=c[0]/u[0],d=c[1]/u[1],h=1/f,p=1/d,g=Math.ceil(h)*2+2,b=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${g});
        const int winWidth = int(${b});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}function QXe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:o}=s,l=new XXe(a.shape,r.shape,o);return t.runWebGLProgram(l,[a],a.dtype)}const JXe={kernelName:kD,backendName:"webgl",kernelFunc:QXe};class ZXe{constructor(e,t,s,r,a){this.variableNames=["A"],this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,t,s,u];const f=[r&&t>1?l-1:l,r&&s>1?c-1:c],d=[r&&t>1?t-1:t,r&&s>1?s-1:s],h=r?"0.5":"0.0";let p;a?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/d[0]},
          ${f[1]/d[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}class eQe{constructor(e,t,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,t,s,u];const f=[r&&t>1?l-1:l,r&&s>1?c-1:c],d=[r&&t>1?t-1:t,r&&s>1?s-1:s],h=r?"0.5":"0.0";let p;a?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/d[0]},
          ${f[1]/d[1]},
          ${f[1]/d[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}function tQe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s,[c,u]=l,f=bt().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eQe(r.shape,c,u,a,o):new ZXe(r.shape,c,u,a,o);return t.runWebGLProgram(f,[r],r.dtype)}const nQe={kernelName:pk,backendName:"webgl",kernelFunc:tQe};class sQe{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,o,l]=e,c=[s&&o>1?r-1:r,s&&l>1?a-1:a],u=[s&&o>1?o-1:o,s&&l>1?l-1:l],f=c[0]/u[0],d=c[1]/u[1],h=1/f,p=1/d,g=Math.ceil(h)*2+2,b=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${g});
        const int winWidth = int(${b});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}function rQe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:o}=s,l=new sQe(a.shape,r.shape,o);return t.runWebGLProgram(l,[a],a.dtype)}const iQe={kernelName:TD,backendName:"webgl",kernelFunc:rQe};class aQe{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=l=>t.indexOf(l)!==-1&&e[l]!==1?`${e[l]} - coords[${l}] - 1`:`coords[${l}]`,a=e.map((l,c)=>r(c)).join(","),o=qi(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}class oQe{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=gu("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,l=qi(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${l} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(r.slice())};
          if(${a}){
            result.g = ${u(r.slice())};
          }
          if(${o}) {
            result.b = ${f(r.slice())};
            if(${a}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(g){return h(g)}function u(g){return g[s-1]="("+g[s-1]+" + 1)",h(g)}function f(g){return g[s-2]="("+g[s-2]+" + 1)",h(g)}function d(g){return g[s-1]="("+g[s-1]+" + 1)",g[s-2]="("+g[s-2]+" + 1)",h(g)}function h(g){const b=e.map((x,S)=>p(S,g)),v=b.join(","),w=b.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${w}))`}function p(g,b){return t.indexOf(g)!==-1&&e[g]!==1?`${e[g]} - ${b[g]} - 1`:`${b[g]}`}}}function lQe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:a}=s,o=r.shape.length,l=dr(a,r.shape);if(o===0)return Lf({inputs:{x:r},backend:t});const c=bt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new oQe(r.shape,l):new aQe(r.shape,l);return t.runWebGLProgram(c,[r],r.dtype)}const cQe={kernelName:gk,backendName:"webgl",kernelFunc:lQe};class uQe{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}const fQe={kernelName:WD,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:a,center:o}=e,l=t,c=new uQe(s.shape,a),[u,f]=OB(o,s.shape[1],s.shape[2]),d=[[u,f,Math.sin(r),Math.cos(r)]];return l.runWebGLProgram(c,[s],s.dtype,d)}};const dQe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,hQe=qr({opSnippet:dQe}),pQe={kernelName:v_,backendName:"webgl",kernelFunc:hQe};const mQe="return inversesqrt(x);",gQe=qr({opSnippet:mQe,cpuKernelImpl:EVe}),yQe={kernelName:__,backendName:"webgl",kernelFunc:gQe};class sU{constructor(e,t,s,r,a,o,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=qi(a.length),f=qi(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const g=`getUpdates(${p})`;let b="";c&&(b="coords[0], coords[1]");const v=`getDefaultValue(${b})`,w=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${f} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${g};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}class bQe{constructor(e,t,s,r,a,o,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=qi(a.length),f=qi(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const g=`getUpdates(${p})`;let b="";c&&(b="coords[0], coords[1]");const v=`getDefaultValue(${b})`,w=t>1?"strides[j]":"strides",x=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${f} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${g};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}function wQe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:a}=e,{shape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:f,outputSize:d}=A1(a,r,o),h=[d/u,u];if(d===0)return t.makeTensorInfo(o,r.dtype);const p=Mn({inputs:{x:r},backend:t,attrs:{shape:[c,l]}}),g=Mn({inputs:{x:a},backend:t,attrs:{shape:[c,u]}}),b=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;bt().getBool("WEBGL_PACK")?v=new bQe(c,l,p.shape.length,g.shape.length,f,h):v=new sU(c,l,p.shape.length,g.shape.length,f,h);const w=t.runWebGLProgram(v,[g,p,b],g.dtype),x=Mn({inputs:{x:w},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(b),x}const vQe={kernelName:ED,backendName:"webgl",kernelFunc:wQe};class _Qe{constructor(e,t,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const a="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,l=bt().getNumber("WEBGL_VERSION")===2?a:o,c=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${l}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${c} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}function xQe(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:a}=e,{side:o}=s,l=new _Qe(r.shape[0],r.shape[1],a.shape[1],o),c=[[r.shape[1]]];return t.runWebGLProgram(l,[r,a],"int32",c)}const CQe={kernelName:AD,backendName:"webgl",kernelFunc:xQe};class SQe{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],u=[];for(let f=0;f<t.length;f++)u.push(`${l[f]}`),f<e&&c.push(`${l[f]}`);r=c.join(),a=u.join()}const o=qi(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}function MQe(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:a}=e,o=new SQe(s.shape.length,r.shape,r.shape.length);return t.runWebGLProgram(o,[s,r,a],Hu(r.dtype,a.dtype))}const TQe={kernelName:yk,backendName:"webgl",kernelFunc:MQe};const kQe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${NO};
  float scale = ${DO};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,EQe=qr({opSnippet:kQe}),IQe={kernelName:x_,backendName:"webgl",kernelFunc:EQe};const AQe=nx+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,LQe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,NQe=qr({opSnippet:AQe,packedOpSnippet:LQe,cpuKernelImpl:AVe}),DQe={kernelName:T_,backendName:"webgl",kernelFunc:NQe};const OQe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,PQe=qr({opSnippet:OQe}),$Qe={kernelName:M_,backendName:"webgl",kernelFunc:PQe};const jQe=nx+`
  return sin(x);
`,RQe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${rw}
  return result;
`,FQe=qr({opSnippet:jQe,packedOpSnippet:RQe}),zQe={kernelName:C_,backendName:"webgl",kernelFunc:FQe};const BQe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,UQe=qr({opSnippet:BQe}),VQe={kernelName:S_,backendName:"webgl",kernelFunc:UQe};const WQe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,GQe=qr({opSnippet:WQe}),HQe={kernelName:k_,backendName:"webgl",kernelFunc:GQe};const qQe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,paddings:o}=s;we(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((w,x)=>w*x),c=[[0,0]];c.push(...o);for(let w=1+a.length;w<r.shape.length;++w)c.push([0,0]);const u=[],f=rfe({inputs:{x:r},backend:t,attrs:{paddings:c,constantValue:0}}),d=qk(f.shape,a,l,!1),h=Yk(d.length,a.length,!1),p=Kk(f.shape,a,l,!1),g=Mn({inputs:{x:f},backend:t,attrs:{shape:d}}),b=xu({inputs:{x:g},backend:t,attrs:{perm:h}}),v=Mn({inputs:{x:b},backend:t,attrs:{shape:p}});return u.push(f),u.push(g),u.push(b),u.forEach(w=>t.disposeIntermediateTensorInfo(w)),v},YQe={kernelName:vk,backendName:"webgl",kernelFunc:qQe};function KQe(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:a,defaultValue:o}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const l=t.readSync(s.dataId),c=t.readSync(r.dataId),u=t.readSync(a.dataId),f=t.readSync(o.dataId)[0],[d,h,p,g,b]=NVe(l,s.shape,s.dtype,c,r.dtype,u,f);return[t.makeTensorInfo(h,s.dtype,d),t.makeTensorInfo([h[0]],r.dtype,p),t.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(v=>Number(v)))),t.makeTensorInfo([b.length],s.dtype,new Int32Array(b))]}const XQe={kernelName:LD,backendName:"webgl",kernelFunc:KQe};function QQe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(t.readSync(r.dataId)),l=t.readSync(s.dataId),c=Array.from(t.readSync(a.dataId)),[u,f,d]=DVe(l,s.shape,s.dtype,o,c);return[t.makeTensorInfo(f,s.dtype,u),t.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const JQe={kernelName:ND,backendName:"webgl",kernelFunc:QQe};function ZQe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const o=t.readSync(s.dataId),l=t.readSync(r.dataId),c=t.readSync(a.dataId),[u,f]=kue(o,s.shape,s.dtype,l,c,!0);return t.makeTensorInfo(f,s.dtype,u)}const eJe={kernelName:DD,backendName:"webgl",kernelFunc:ZQe};function tJe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const o=t.readSync(s.dataId),l=t.readSync(r.dataId),c=t.readSync(a.dataId),[u,f]=kue(o,s.shape,s.dtype,l,c);return t.makeTensorInfo(f,s.dtype,u)}const nJe={kernelName:OD,backendName:"webgl",kernelFunc:tJe};function sJe(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:o}=e,{outputShape:l}=s,{sliceRank:c,numUpdates:u,sliceSize:f,strides:d,outputSize:h}=A1(a,r,l),p=!1;if(a.dtype==="string"){const w=t.bufferSync(r),x=t.bufferSync(a),S=Og(t.readSync(o.dataId)[0]),C=IVe(w,x,l,h,f,u,c,d,S,p);return t.makeTensorInfo(l,C.dtype,C.values)}const g=new sU(u,c,r.shape.length,a.shape.length,d,[h,1],p),b=t.runWebGLProgram(g,[a,r,o],a.dtype),v=Mn({inputs:{x:b},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(b),v}const rJe={kernelName:PD,backendName:"webgl",kernelFunc:sJe};function iJe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:a,axis:o}=s,l=dr(o,r.shape)[0],c=KB(r,a,l),u=r.shape.length,f=new Array(u).fill(0),d=r.shape.slice();return c.map(h=>{const p=[...d];p[l]=h;const g=sx({inputs:{x:r},backend:t,attrs:{begin:f,size:p}});return f[l]+=h,g})}const aJe={kernelName:_k,backendName:"webgl",kernelFunc:iJe};const Aq="return sqrt(x);",oJe=qr({opSnippet:Aq,packedOpSnippet:Aq,cpuKernelImpl:OVe}),lJe={kernelName:E_,backendName:"webgl",kernelFunc:oJe};const cJe="return x * x;",uJe=qr({opSnippet:cJe}),fJe={kernelName:$D,backendName:"webgl",kernelFunc:uJe};const Lq="return (a - b) * (a - b);",dJe=wc({opSnippet:Lq,packedOpSnippet:Lq}),hJe={kernelName:I_,backendName:"webgl",kernelFunc:dJe};function pJe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=t.readSync(r.dataId),o=zg(a),l=PVe(o,"string",s);return t.makeTensorInfo(r.shape,"string",l)}const mJe={kernelName:Ck,backendName:"webgl",kernelFunc:pJe};function gJe({inputs:n,attrs:e,backend:t}){const{x:s}=n,r=xh+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new vm(s.shape,r);return t.runWebGLProgram(a,[s],s.dtype)}const yJe={kernelName:O_,backendName:"webgl",kernelFunc:gJe};class bJe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=qi(s.length),o=qi(s.length);let l="";if(r===1)l="coords * strides + begin";else{let c=0;l=s.map((u,f)=>(c++,s.length===1?`coords * strides[${f}] + begin[${f}]`:`coords[${c-1}] * strides[${f}] + begin[${f}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${l}));
      }
    `}}function wJe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:f,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:p,finalShape:g,isIdentity:b,sliceDim0:v,isSimpleSlice:w,begin:x,end:S,strides:C}=AB(r.shape,a,o,l,c,u,f,d,h);let M;if(b)M=Mn({inputs:{x:r},backend:t,attrs:{shape:g}});else if(v||w){we(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const E=kB(x,S,C),I=sx({inputs:{x:r},backend:t,attrs:{begin:x,size:E}});M=Mn({inputs:{x:I},backend:t,attrs:{shape:g}}),t.disposeIntermediateTensorInfo(I)}else if(t.shouldExecuteOnCPU([r])){const I=t.readSync(r.dataId),A=tr(r.shape,r.dtype,I),D=$Ve(p,A,C,x);M=t.makeTensorInfo(g,r.dtype,D.values)}else{const I=new bJe(x,C,p);M=t.runWebGLProgram(I,[r],r.dtype)}const k=Mn({inputs:{x:M},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(M),k}const vJe={kernelName:jD,backendName:"webgl",kernelFunc:wJe};function _Je(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:o,rightPad:l,padWidth:c,preserveShortSequences:u}=s,{data:f,dataSplits:d}=e,h=t.readSync(f.dataId),p=t.readSync(d.dataId),[g,b]=jVe(h,p,r,a,o,l,c,u);return[t.makeTensorInfo([g.length],"string",g),t.makeTensorInfo(d.shape,"int32",b)]}const xJe={kernelName:RD,backendName:"webgl",kernelFunc:_Je};function CJe(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:o}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const l=t.readSync(a.dataId),c=t.readSync(o.dataId)[0],[u,f,d]=RVe(l,c,r),h=f.length;return[t.makeTensorInfo([h,2],"int32",u),t.makeTensorInfo([h],"string",f),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const SJe={kernelName:FD,backendName:"webgl",kernelFunc:CJe};function MJe(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=t.readSync(a.dataId),l=FVe(o,r);return t.makeTensorInfo(a.shape,"int32",l)}const TJe={kernelName:zD,backendName:"webgl",kernelFunc:MJe};const kJe="return tan(x);",EJe=qr({opSnippet:kJe}),IJe={kernelName:L_,backendName:"webgl",kernelFunc:EJe};const AJe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,LJe=qr({opSnippet:AJe}),NJe={kernelName:N_,backendName:"webgl",kernelFunc:LJe};function DJe(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:r,indices:a,updates:o}=e,{sliceRank:l,numUpdates:c,sliceSize:u,strides:f,outputSize:d}=A1(o,a,r.shape),h=[d/u,u];if(d===0)return t.makeTensorInfo(r.shape,a.dtype);const p=Mn({inputs:{x:a},backend:t,attrs:{shape:[c,l]}}),g=Mn({inputs:{x:o},backend:t,attrs:{shape:[c,u]}}),b=Mn({inputs:{x:r},backend:t,attrs:{shape:h}}),v=new sU(c,l,p.shape.length,g.shape.length,f,h,!1,!0),w=t.runWebGLProgram(v,[g,p,b],b.dtype),x=Mn({inputs:{x:w},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),x}const OJe={kernelName:ID,backendName:"webgl",kernelFunc:DJe};class PJe{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*t[o];this.outputShape=s,this.rank=s.length;const r=qi(this.rank),a=$Je(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function $Je(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${t[r]}, ${n[r]})`);return s.join()}function afe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const c=t.readSync(r.dataId),u=r.dtype==="string"?c.map(h=>Og(h)):c,f=tr(r.shape,r.dtype,u),d=BVe(f,a);return t.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new PJe(r.shape,a);return t.runWebGLProgram(o,[r],r.dtype)}const jJe={kernelName:D_,backendName:"webgl",kernelFunc:afe};class RJe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class FJe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}function gy(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function Nq(n){let e=1;for(;e<n;)e*=2;return e}function zJe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:a,sorted:o}=s,l=bt().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=bt().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,f=u[u.length-1];if(t.shouldExecuteOnCPU([r])||f<l||a>c){const D=t.readSync(r.dataId),[L,P]=UVe(D,u,r.dtype,a,o);return[t.makeTensorInfo(L.shape,L.dtype,L.values),t.makeTensorInfo(P.shape,P.dtype,P.values)]}if(a===0)return u[u.length-1]=0,[t.makeTensorInfo(u,r.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(f===1)return[r,dE({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const d=t.texData.get(r.dataId),h=d!==null&&d.isPacked,p=h?t.unpackTensor(r):r,b=Ot(u)/f,v=Mn({inputs:{x:p},attrs:{shape:[b,f]},backend:t});h&&gy(t,p);const w=Nq(a),x=Nq(f);let S=null;const C=()=>S===null?[v,v]:[v,S],M=(D,L,P)=>{const j=C(),G=new RJe(P),q=[[f],[S===null?1:0],[Number.NEGATIVE_INFINITY],[D],[L]],te=S;S=t.runWebGLProgram(G,j,"int32",q),gy(t,te)};for(let D=1;D<w;D*=2){const L=D*2;for(let P=D;P>=1;P/=2)M(L,P,[b,x])}for(let D=x;D>w;D/=2){const L=C(),P=new FJe([b,D/2]),G=[[f],[S===null?1:0],[w]],Q=S;S=t.runWebGLProgram(P,L,"int32",G),gy(t,Q);const q=w/2,te=q*2;for(let Z=q;Z>=1;Z/=2)M(te,Z,S.shape)}let k=S;S=sx({inputs:{x:S},backend:t,attrs:{begin:0,size:[b,a]}}),gy(t,k);let E=Jue({inputs:{x:v,indices:S},backend:t,attrs:{axis:1,batchDims:1}});gy(t,v);const I=u.slice(0,-1);I.push(a),k=S,S=Mn({inputs:{x:S},attrs:{shape:I},backend:t}),gy(t,k);const A=E;return E=Mn({inputs:{x:E},attrs:{shape:I},backend:t}),gy(t,A),[E,S]}const BJe={kernelName:BD,backendName:"webgl",kernelFunc:zJe};class UJe{constructor(e,t,s,r,a,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const l=s==="nearest"?1:2;let c;switch(r){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${c} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${l} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}function VJe(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,transforms:a}=e,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=s,[f,d,h,p]=r.shape,[g,b]=u??[d,h],v=[f,g,b,p],w=new UJe(d,h,o,l,c,v);return t.runWebGLProgram(w,[r,a],"float32")}const WJe={kernelName:UD,backendName:"webgl",kernelFunc:VJe};function GJe(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:a}=e;X_(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(a.dataId),{outputValues:l,outputShape:c,indices:u}=VVe(o,r,a.shape,a.dtype);return[s.makeTensorInfo(c,a.dtype,l),s.makeTensorInfo([u.length],"int32",u)]}const HJe={kernelName:VD,backendName:"webgl",kernelFunc:GJe};function qJe(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const o=r,l=o.shape.length,c=r.shape[a],u=new Array(l-1);let f=0;for(let b=0;b<l;b++)b!==a&&(u[f++]=o.shape[b]);const d=[],h=new Array(l).fill(0),p=o.shape.slice();p[a]=1;const g=new Array(c);for(let b=0;b<g.length;b++){h[a]=b;const v=sx({inputs:{x:o},backend:t,attrs:{begin:h,size:p}}),w=Mn({inputs:{x:v},backend:t,attrs:{shape:u}});g[b]=w,d.push(v)}return d.forEach(b=>t.disposeIntermediateTensorInfo(b)),g}const YJe={kernelName:Sk,backendName:"webgl",kernelFunc:qJe};class KJe{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,a=e.inSize,o=e.numSegments,l=o*Math.ceil(a/s);this.outputShape=[r,l];const c="0.0",u="sumValue",f=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let p="";a%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let g="";a%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${g}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${f};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}function XJe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:a}=e,{numSegments:o}=s,l=r.shape.length,c=[];let u=0;const f=no([u],l);let d=r;f!=null&&(d=xu({inputs:{x:r},backend:t,attrs:{perm:f}}),c.push(d),u=jo(1,l)[0]);const h=Lae(d.shape,u,o),p=Ot([d.shape[u]]),g=Mn({inputs:{x:d},backend:t,attrs:{shape:[-1,p]}});c.push(g);const b=HD(r.dtype),v=(C,M,k,E,I)=>{const A=C.shape[0],D=C.shape[1],L=Aae(D,I),P={windowSize:L,inSize:D,batchSize:A,numSegments:I},j=new KJe(P,M),G=t.compileAndRun(j,[C,k],E);if(c.push(G),G.shape[1]===I)return G;const Q=ife({backend:t,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),q=afe({inputs:{x:Q},backend:t,attrs:{reps:[D/L]}});return c.push(Q),c.push(q),v(G,M,q,E,I)},w=v(g,"unsortedSegmentSum",a,b,o),x=Mn({inputs:{x:w},backend:t,attrs:{shape:h}});let S=x;if(f!=null){c.push(x);const C=T1(f);S=xu({inputs:{x:S},backend:t,attrs:{perm:C}})}return c.forEach(C=>t.disposeIntermediateTensorInfo(C)),S}const QJe={kernelName:Mk,backendName:"webgl",kernelFunc:XJe};const JJe=[PWe,jWe,zWe,VWe,GWe,YWe,XWe,JWe,nGe,rGe,oGe,uGe,hGe,yGe,vGe,xGe,SGe,EGe,AGe,NGe,$Ge,VGe,GGe,KGe,QGe,sHe,iHe,cHe,bWe,dHe,yHe,_He,kHe,AHe,NHe,OHe,$He,zHe,VHe,HHe,YHe,XHe,JHe,tqe,sqe,oqe,cqe,dqe,mqe,yqe,_qe,Mqe,Iqe,Nqe,Pqe,$qe,Rqe,zqe,Uqe,Wqe,Hqe,Xqe,Zqe,nYe,rYe,oYe,uYe,pYe,bYe,yWe,vYe,mHe,CYe,TYe,IYe,vWe,DYe,jYe,FYe,VYe,HYe,XYe,ZYe,sKe,oKe,uKe,dKe,gKe,bKe,vKe,SKe,TKe,EKe,AKe,NKe,$Ke,zKe,WKe,JKe,CWe,nXe,iXe,lXe,fXe,ZGe,pXe,gXe,bXe,_Xe,MXe,xWe,kXe,IXe,LXe,DXe,OXe,eHe,YKe,jXe,BXe,GXe,MWe,KXe,JXe,nQe,iQe,cQe,fQe,pQe,yQe,vQe,CQe,TQe,IQe,DQe,$Qe,zQe,VQe,BGe,XKe,HQe,YQe,XQe,JQe,eJe,nJe,rJe,aJe,lJe,fJe,hJe,mJe,yJe,vJe,xJe,SJe,TJe,KKe,NWe,IJe,NJe,OJe,jJe,BJe,WJe,DWe,HJe,YJe,QJe,mXe];for(const n of JJe)GD(n);const ZJe="4.11.0";const eZe={"tfjs-core":oae,"tfjs-backend-cpu":gce,"tfjs-backend-webgl":Aue,"tfjs-data":vle,"tfjs-layers":HO,"tfjs-converter":rle,tfjs:ZJe},tZe=Object.freeze(Object.defineProperty({__proto__:null,Abs:ST,Acos:z2,Acosh:B2,AdadeltaOptimizer:yB,AdagradOptimizer:bB,AdamOptimizer:wB,AdamaxOptimizer:vB,Add:Yb,AddN:MT,All:z4,Any:B4,ArgMax:TT,ArgMin:kT,Asin:U2,Asinh:V2,Atan:W2,Atan2:H2,Atanh:G2,AvgPool:ET,AvgPool3D:IT,AvgPool3DGrad:V4,AvgPoolGrad:U4,BatchMatMul:AT,BatchToSpaceND:LT,Bincount:W4,BitwiseAnd:NT,BroadcastArgs:G4,BroadcastTo:lre,Callback:Zoe,CallbackList:roe,Cast:q2,Ceil:Y2,ClipByValue:K2,Complex:H4,ComplexAbs:DT,Concat:OT,Conv2D:PT,Conv2DBackpropFilter:q4,Conv2DBackpropInput:$T,Conv3D:jT,Conv3DBackpropFilterV2:Y4,Conv3DBackpropInputV2:K4,Cos:X2,Cosh:Q2,CropAndResize:Q4,Cumprod:X4,Cumsum:RT,CustomCallback:aoe,DataStorage:YF,DenseBincount:J4,DepthToSpace:Z4,DepthwiseConv2dNative:FT,DepthwiseConv2dNativeBackpropFilter:eD,DepthwiseConv2dNativeBackpropInput:tD,Diag:nD,Dilation2D:zT,Dilation2DBackpropFilter:SN,Dilation2DBackpropInput:CN,Draw:sD,get ENV(){return ZF},EarlyStopping:ele,Einsum:rD,Elu:Z2,EluGrad:iD,Environment:are,Equal:BT,Erf:e_,Exp:t_,ExpandDims:UT,Expm1:n_,FFT:aD,Fill:oD,FlipLeftRight:lD,Floor:s_,FloorDiv:r_,FromPixels:MN,FusedBatchNorm:VT,FusedConv2D:LM,FusedDepthwiseConv2D:NM,GPGPUContext:LL,GatherNd:cD,GatherV2:WT,GraphModel:I9,Greater:GT,GreaterEqual:i_,History:ioe,IFFT:uD,Identity:a_,Imag:fD,InputSpec:Jo,IsFinite:o_,IsInf:l_,IsNan:c_,KernelBackend:j4,LRN:JT,LRNGrad:hD,LayerVariable:eoe,LayersModel:Ag,LeakyRelu:HT,Less:qT,LessEqual:YT,LinSpace:dD,Log:u_,Log1p:f_,LogSoftmax:cre,LogicalAnd:KT,LogicalNot:XT,LogicalOr:QT,LogicalXor:FSe,LowerBound:zSe,MathBackendCPU:aE,MathBackendWebGL:uE,MatrixBandPart:BSe,Max:ZT,MaxPool:ek,MaxPool3D:tk,MaxPool3DGrad:mD,MaxPoolGrad:pD,MaxPoolWithArgmax:gD,Maximum:d_,Mean:nk,Min:sk,Minimum:h_,MirrorPad:rk,Mod:p_,MomentumOptimizer:_B,Multinomial:yD,Multiply:m_,Neg:ik,NonMaxSuppressionV3:bD,NonMaxSuppressionV4:wD,NonMaxSuppressionV5:vD,NotEqual:ak,OP_SCOPE_SUFFIX:rz,OneHot:lk,OnesLike:ok,Optimizer:Xg,OptimizerConstructors:lae,Pack:ck,PadV2:uk,Pool:USe,Pow:g_,Prelu:fk,Prod:dk,RMSPropOptimizer:xB,RNN:Tp,RaggedGather:_D,RaggedRange:xD,RaggedTensorToTensor:CD,Range:SD,get Rank(){return wR},Real:MD,RealDiv:J2,Reciprocal:y_,get Reduction(){return mu},Relu:b_,Relu6:w_,Reshape:hk,ResizeBilinear:mk,ResizeBilinearGrad:kD,ResizeNearestNeighbor:pk,ResizeNearestNeighborGrad:TD,Reverse:gk,RotateWithOffset:WD,Round:v_,Rsqrt:__,SGDOptimizer:EO,ScatterNd:ED,SearchSorted:AD,Select:yk,Selu:x_,Sequential:Mb,Sigmoid:T_,Sign:M_,Sin:C_,Sinh:S_,Slice:bk,Softmax:xk,Softplus:k_,SpaceToBatchND:vk,SparseFillEmptyRows:LD,SparseReshape:ND,SparseSegmentMean:DD,SparseSegmentSum:OD,SparseToDense:PD,SplitV:_k,Sqrt:E_,Square:$D,SquaredDifference:I_,StaticRegexReplace:Ck,Step:O_,StridedSlice:jD,StringNGrams:RD,StringSplit:FD,StringToHashBucketFast:zD,Sub:A_,Sum:wk,SymbolicTensor:bp,Tan:L_,Tanh:N_,Tensor:jr,TensorBuffer:el,TensorScatterUpdate:ID,Tile:D_,TopK:BD,Transform:UD,Transpose:nb,Unique:VD,Unpack:Sk,UnsortedSegmentSum:Mk,UpperBound:VSe,Variable:PM,ZerosLike:Tk,_FusedMatMul:AM,abs:Go,acos:dz,acosh:hz,add:ln,addN:jre,all:KD,any:jM,argMax:yb,argMin:pz,asin:mz,asinh:gz,atan:yz,atan2:bz,atanh:wz,avgPool:Ak,avgPool3d:_z,backend:$re,backend_util:Dae,basicLSTMCell:Rre,batchNorm:P_,batchNorm2d:xz,batchNorm3d:Cz,batchNorm4d:Sz,batchToSpaceND:Lk,bincount:Mz,bitwiseAnd:Fre,booleanMaskAsync:Cie,broadcastArgs:zre,broadcastTo:sb,broadcast_util:wke,browser:PNe,buffer:tr,callbacks:tje,cast:Cn,ceil:Tz,clipByValue:Yu,clone:Sm,complex:$g,concat:Po,concat1d:kz,concat2d:Ez,concat3d:Iz,concat4d:Az,constraints:UPe,conv1d:XD,conv2d:jg,conv2dTranspose:QD,conv3d:Nz,conv3dTranspose:Dz,copyRegisteredKernels:qSe,cos:Nk,cosh:JD,cosineWindow:vO,cumprod:zM,cumsum:ZD,customGrad:Pm,data:p6e,denseBincount:EN,deprecationWarn:eTe,depthToSpace:Oz,depthwiseConv2d:$_,deregisterOp:rje,device_util:bMe,diag:Ure,dilation2d:Pz,disableDeprecationWarnings:ZMe,dispose:Ws,disposeVariables:tTe,div:cs,divNoNan:$z,dot:jz,dropout:dB,einsum:Ry,elu:j_,enableDebugMode:JMe,enableProdMode:QMe,enclosingPowerOfTwo:hB,engine:Xh,ensureShape:Vre,env:bt,equal:Ef,erf:Rz,euclideanNorm:zz,exp:Ku,expandDims:lc,expm1:Bz,eye:eO,fft:Gk,fill:Kb,findBackend:lTe,findBackendFactory:cTe,floor:F_,floorDiv:YD,forceHalfFloat:Lue,fused:Nie,gather:z_,gatherND:kie,gather_util:$Ne,getBackend:aTe,getGradient:yR,getKernel:OM,getKernelsForBackend:TN,gpgpu_util:Q7e,grad:nEe,grads:sEe,greater:Su,greaterEqual:qg,ifft:h2,imag:Dk,image:ch,inTopKAsync:Eie,initializers:r3e,input:voe,io:MB,irfft:pO,isFinite:Uz,isInf:Vz,isNaN:Wz,keep:bl,kernel_impls:GNe,layers:N$e,leakyRelu:Ok,less:c2,lessEqual:k1,linalg:gB,linspace:Hre,loadGraphModel:IRe,loadGraphModelSync:ARe,loadLayersModel:q3e,localResponseNormalization:Gz,log:If,log1p:Pk,logSigmoid:Hz,logSoftmax:nO,logSumExp:$k,logicalAnd:gh,logicalNot:jk,logicalOr:sO,logicalXor:qz,losses:Fie,lowerBound:Yre,matMul:fr,math:kNe,max:bd,maxPool:Rk,maxPool3d:Yz,maxPoolWithArgmax:Kre,maximum:Fm,mean:Ja,memory:AR,meshgrid:Xre,metrics:Y$e,min:l2,minimum:h1,mirrorPad:Kz,mod:Xz,model:X3e,models:K$e,moments:Fk,movingAverage:Sie,mul:et,multiRNNCell:Qre,multinomial:Jre,neg:ya,nextFrame:LB,norm:R_,notEqual:_b,oneHot:u2,ones:Fu,onesLike:Af,op:Ye,outerProduct:Zre,pad:Yg,pad1d:eie,pad2d:tie,pad3d:nie,pad4d:sie,pool:Qz,pow:Rg,prelu:Bk,print:uz,prod:Jz,profile:nTe,raggedGather:rie,raggedRange:iie,raggedTensorToTensor:aie,rand:oie,randomGamma:uie,randomNormal:iO,randomStandardNormal:fie,randomUniform:E1,randomUniformInt:die,range:xb,ready:iTe,real:f2,reciprocal:nB,registerBackend:fz,registerCallbackConstructor:J3e,registerGradient:ure,registerKernel:GD,registerOp:sje,regularizers:Z$e,relu:Sp,relu6:aO,removeBackend:oTe,reshape:nt,reverse:Cd,reverse1d:hie,reverse2d:pie,reverse3d:mie,reverse4d:gie,rfft:Hk,round:oO,rsqrt:lO,scalar:ws,scatterND:Mie,scatter_util:oAe,searchSorted:rO,selu:cO,separableConv2d:uO,sequential:Q3e,serialization:lNe,setBackend:rTe,setPlatform:uTe,setWebGLContext:Dce,setdiff1dAsync:yie,shared:mce,sigmoid:lp,sign:sB,signal:Rie,sin:fO,sinh:dO,slice:Pr,slice1d:Uk,slice2d:hO,slice3d:Vk,slice4d:d2,slice_util:aae,softmax:Wk,softplus:Xb,spaceToBatchND:zk,sparse:zie,sparseToDense:Tie,spectral:jie,split:Uu,sqrt:pc,square:Hi,squaredDifference:mO,squeeze:I1,stack:_u,step:Qb,stridedSlice:rB,string:Bie,sub:Bn,sum:Xn,sumOutType:HD,tan:iB,tanh:wb,tensor:Tf,tensor1d:fc,tensor2d:s1,tensor3d:aB,tensor4d:bie,tensor5d:wie,tensor6d:vie,tensorScatterUpdate:_ie,tensor_util:hMe,test_util:vIe,tidy:wt,tile:hd,time:sTe,topk:lB,train:Ay,transpose:Ir,truncatedNormal:yO,unique:cB,unregisterGradient:HSe,unregisterKernel:GSe,unsortedSegmentSum:bO,unstack:Sd,upcastType:Hu,upperBound:xie,util:tMe,valueAndGrad:rEe,valueAndGrads:iEe,variable:uB,variableGrads:qre,version:eZe,version_converter:rle,version_core:oae,version_cpu:gce,version_layers:HO,version_webgl:Aue,webgl:gWe,webgl_util:s7e,where:Fl,whereAsync:fB,zeros:Xo,zerosLike:Rr},Symbol.toStringTag,{value:"Module"})),Dq=n=>n==="tensor"?"tensor":"base64",nZe=({output:n,progressOutput:e,...t}={})=>({...t,output:Dq(n),progressOutput:Dq(e||n)}),sZe={jsdelivr:(n,e,t)=>`https://cdn.jsdelivr.net/npm/${n}@${e}/${t}`,unpkg:(n,e,t)=>`https://unpkg.com/${n}@${e}/${t}`},rZe=["jsdelivr","unpkg"],iZe=(n,e,t)=>new Error([`Could not resolve URL ${e} for package ${t?.name}@${t?.version}`,"Errors include:",...n.map(([s,r])=>`- ${s}: ${r.message}`)].join(`
`));async function aZe(n,e){const{modelType:t,_internals:s,path:r}=e;if(r)return await uH(n,r,t);if(!s)throw new Error(JB);const a=[];for(const o of rZe){const l=sZe[o];try{const c=l(s.name,s.version,s.path);return await uH(n,c,t)}catch(c){a.push([o,c instanceof Error?c:new Error(`There was an unknown error: ${JSON.stringify(c)}`)])}}throw iZe(a,r||s.path,s)}const oZe=async(n,e)=>{const t=await e;try{KNe(t)}catch(a){throw e4e(a)?T4e(a.type,t):new Error(JB)}const s=D4e(t);return{model:await aZe(n,s),modelDefinition:s}},lZe="https://upscalerjs.com/documentation/troubleshooting#environment-disallows-base64",cZe="https://upscalerjs.com/documentation/troubleshooting#environment-disallows-string-input",uZe=()=>new Error(["Environment does not support a string URL as an input format.",`For more information, see ${cZe}.`].join(`
`)),fZe=()=>new Error(["Environment does not support base64 as an output format.",`For more information, see ${lZe}.`].join(`
`)),dZe=n=>new Error([`Unsupported dimensions for incoming pixels: ${n.shape.length}.`,"Only 3 or 4 rank tensors are supported."].join(`
`)),hZe=()=>new Error(["Failed to load image"].join(" ")),pZe=n=>new Promise((e,t)=>{const s=new Image;s.src=n,s.crossOrigin="anonymous",s.onload=()=>e(s),s.onerror=()=>t(hZe())}),Oq=n=>Kie(n),mZe=async(n,e)=>{if(Xk(n))return n;if(qNe(n)){const t=await pZe(n);return Oq(t)}return Oq(n)},gZe=async(n,e)=>{const t=await mZe(e);if(HNe(t)){const s=t.expandDims(0);return t.dispose(),s}if(jae(t))return t;throw dZe(t)},yZe=(n,e)=>{const t=U4e(n,e),[s,r]=e.shape,a=new ImageData(r,s);a.data.set(t);const o=document.createElement("canvas");o.width=r,o.height=s;const l=o.getContext("2d");if(!l)throw new Error("No context found");return l.putImageData(a,0,0),o.toDataURL()},Pq=n=>{try{if((new Image&&"createElement"in document)!==!0)throw n()}catch{throw n()}},bZe=(n,{output:e="base64",progressOutput:t})=>{typeof n=="string"&&Pq(uZe),(t==="base64"||e==="base64")&&Pq(fZe)},wZe=X4e({tf:tZe,getUpscaleOptions:nZe,loadModel:oZe,getImageAsTensor:gZe,tensorAsBase64:yZe,checkValidEnvironment:bZe}),YS={upscaler:null,init:()=>{YS.upscaler||(YS.upscaler=new wZe({}))},upscale:async(n,e={})=>{YS.init();try{let t=n;return typeof n=="string"&&(t=await new Promise((r,a)=>{const o=new Image;o.crossOrigin="Anonymous",o.onload=()=>r(o),o.onerror=a,o.src=n})),await YS.upscaler.upscale(t,{patchSize:64,padding:2,...e})}catch(t){throw console.error("Upscaling failed:",t),t}}};class vZe{constructor(e,t={}){this.canvas=new zj(e,{width:800,height:600,backgroundColor:"#18191b",preserveObjectStacking:!0,...t}),this.originalWidth=800,this.originalHeight=600,this.projectProperties=["name","id","selectable","evented","subTargetCheck","interactive","lockMovementX","lockMovementY","lockScalingX","lockScalingY","lockRotation"],this.initWorkspace(),this.viewport=new GCe(this),this.events=new HCe(this),this.layoutManager=new qCe(this),this.clipboardManager=new YCe(this),this.guideManager=new KCe(this),this.objectManager=new XCe(this),this.shapeManager=new JCe(this),this.filterManager=new PG(this),this.filterManager=new PG(this),this.fontManager=new ZCe(this),this.historyManager=new pSe(this),setTimeout(()=>this.fitToScreen(),100),this.initSmartFrames()}initSmartFrames(){this.canvas&&(this.canvas.on("object:moving",e=>{const t=e.target;if(!t||t.type!=="image"&&t.type!=="fabric-image")return;this.canvas.getObjects().forEach(o=>{o.isSmartFrameHighlight&&(o.set("opacity",o.originalOpacity||1),o.set("stroke",o.originalStroke||null),o.set("strokeWidth",o.originalStrokeWidth||0),delete o.isSmartFrameHighlight)});const s=this.canvas.getObjects().filter(o=>["rect","circle","triangle","polygon","path"].includes(o.type)&&o!==t&&o!==this.workspace&&o.visible),r=t.getCenterPoint(),a=s.find(o=>o.containsPoint(r));a&&(a.isSmartFrameHighlight||(a.originalOpacity=a.opacity,a.originalStroke=a.stroke,a.originalStrokeWidth=a.strokeWidth,a.isSmartFrameHighlight=!0,a.set({opacity:.8,stroke:"#3498db",strokeWidth:3}),this.canvas.requestRenderAll()))}),this.canvas.on("object:modified",e=>{const t=e.target;if(e.action!=="drag"||!t||t.type!=="image"&&t.type!=="fabric-image")return;const r=this.canvas.getObjects().find(a=>a.isSmartFrameHighlight);r&&(r.set({opacity:r.originalOpacity||1,stroke:r.originalStroke||null,strokeWidth:r.originalStrokeWidth||0}),delete r.isSmartFrameHighlight,this.clipImageToShape(t,r))}))}async clipImageToShape(e,t){if(!(!e||!t))try{const s=await t.clone();s.set({absolutePositioned:!1,originX:"center",originY:"center",left:0,top:0,strokeWidth:0,stroke:null,opacity:1,fill:"black"});const r=t.getCenterPoint(),a=e.width/e.height,o=t.width/t.height;let l=t.width*t.scaleX/e.width,c=t.height*t.scaleY/e.height,u=Math.max(l,c);e.set({scaleX:u,scaleY:u,left:r.x,top:r.y,originY:"center",angle:0}),e.setCoords();const f=t.scaleX/e.scaleX,d=t.scaleY/e.scaleY,h=t.angle-e.angle;s.set({scaleX:f,scaleY:d,angle:h}),e.set("clipPath",s),e.set("dirty",!0),this.canvas.remove(t),this.canvas.requestRenderAll(),this.historyManager.saveState("Smart Frame"),$s.success("Image snapped to frame!")}catch(s){console.error("Smart Frame operations failed:",s)}}dispose(){this.events&&typeof this.events.dispose=="function"&&this.events.dispose(),this.viewport&&typeof this.viewport.dispose=="function"&&this.viewport.dispose(),this.canvas&&(this.canvas.dispose(),this.canvas=null)}async duplicateActiveObject(){await this.clipboardManager.duplicate()}toggleLockActiveObject(){this.objectManager.toggleLock()}getActiveObject(){return this.canvas?this.canvas.getActiveObject():null}enableDrawingMode(){this.canvas&&(this.canvas.isDrawingMode=!0,this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.canvas.freeDrawingBrush||(this.canvas.freeDrawingBrush=new nbe(this.canvas)),this.canvas.freeDrawingBrush.width=5,this.canvas.freeDrawingBrush.color="#000000")}disableDrawingMode(){this.canvas&&(this.canvas.isDrawingMode=!1)}setBrushColor(e){this.canvas&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.color=e)}setBrushWidth(e){this.canvas&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.width=parseInt(e,10))}initWorkspace(){const e=new dm({left:0,top:0,width:this.originalWidth,height:this.originalHeight,fill:"#ffffff",selectable:!1,evented:!1,stroke:"#cccccc",strokeWidth:1,originX:"left",originY:"top",shadow:{color:"rgba(0, 0, 0, 0.15)",blur:10,offsetX:0,offsetY:5}});this.canvas.backgroundImage=e,this.canvas.requestRenderAll(),this.canvas.backgroundColor="#18191b",this.workspace=e}setBackgroundColor(e){this.workspace&&(this.workspace.set("fill",e),this.canvas.requestRenderAll())}onSelectionChange(e){this.selectionCallback=e}onZoomChange(e){this.viewport.onZoomChange(e)}updateActiveObject(e,t){const s=this.getActiveObject();if(s){if(e.startsWith("shadow.")){const r=e.split(".")[1];let a=s.shadow;a||(s.set("shadow",{color:"#000000",blur:10,offsetX:5,offsetY:5}),a=s.shadow),s.shadow instanceof Object&&(r==="color"&&!t?s.set("shadow",null):s.shadow[r]=t),s.set("shadow",s.shadow)}else if(e.startsWith("filter.")){if(s.type==="image"||s instanceof ih){const r=e.split(".")[1];this.filterManager.applyImageFilter(s,r,parseFloat(t))}}else if(e==="fill")if(s.type==="image"||s instanceof ih)this.filterManager.applyImageFilter(s,"tint",t);else if(s.type==="group"||s.type==="path-group"){const r=a=>{a.forEach(o=>{o.type==="group"?r(o._objects):o.set&&o.set("fill",t)})};s._objects&&r(s._objects),s.set("fill",t)}else s.set("fill",t);else e==="width"?s.scaleToWidth(parseInt(t)):e==="height"?s.scaleToHeight(parseInt(t)):s.set(e,t);s.setCoords(),this.canvas.requestRenderAll()}}flipActiveObject(e){this.objectManager.flip(e)}layerActiveObject(e){this.objectManager.layer(e)}bringForward(){this.objectManager.bringForward()}sendBackward(){this.objectManager.sendBackward()}bringToFront(){this.objectManager.bringToFront()}bringToFront(){this.objectManager.bringToFront()}sendToBack(){this.objectManager.sendToBack()}async undo(){await this.historyManager.undo()}async redo(){await this.historyManager.redo()}setZoom(e){this.viewport.setZoom(e)}zoomIn(){this.viewport.zoomIn()}zoomOut(){this.viewport.zoomOut()}resetZoom(){this.viewport.resetZoom()}fitToScreen(){this.viewport.fitToScreen()}resize(e,t){this.viewport.resizePage(e,t)}toggleHandMode(){return this.viewport.toggleHandMode()}alignObjects(e,t=!1){this.layoutManager.align(e,t)}distributeObjects(e){console.log(`[CanvasManager] Proxying distributeObjects: ${e}`),this.layoutManager.distribute(e)}toggleGrid(){return this.guideManager.toggleGrid()}snapToGrid(e){this.guideManager.snapToGrid(e)}addGuide(e,t){return this.guideManager.addGuide(e,t)}handleObjectMoving(e){this.guideManager.handleObjectMoving(e)}clearGuidelines(){this.guideManager.clearGuidelines()}removeActiveObject(){this.objectManager.remove()}async copy(){await this.clipboardManager.copy()}async paste(){await this.clipboardManager.paste()}group(){this.objectManager.group()}async ungroup(){await this.objectManager.ungroup()}selectAll(){const e=this.canvas.getObjects().filter(t=>t.name!=="Background"&&t!==this.workspace&&t.selectable&&t.evented&&!t.excludeFromExport);if(e.length>0){this.canvas.discardActiveObject();const t=new ip(e,{canvas:this.canvas});this.canvas.setActiveObject(t),this.canvas.requestRenderAll()}}setBackgroundColor(e){this.workspace&&(this.workspace.set("fill",e),this.canvas.requestRenderAll())}setBackgroundGradient(e,t,s,r,a){const o=this.originalWidth,l=this.originalHeight;let c={x1:0,y1:0,x2:o,y2:0};s==="vertical"&&(c={x1:0,y1:0,x2:0,y2:l}),s==="diagonal"&&(c={x1:0,y1:0,x2:o,y2:l});const u=new Ov({type:"linear",coords:c,colorStops:[{offset:0,color:e},{offset:1,color:t}]});this.workspace&&(this.workspace.set("fill",u),this.canvas.requestRenderAll())}addText(e="Double click to edit",t={}){this.shapeManager.addText(e,t)}async addImage(e,t={}){await this.shapeManager.addImage(e,t)}async replaceImage(e,t){if(!(!e||e.type!=="image"&&e.type!=="fabric-image"))try{const s=await Qa.loadImage(t);e.setElement(s),e.setCoords(),this.canvas.requestRenderAll()}catch(s){console.error("Failed to replace image:",s)}}async vectorizeActiveImage(){const e=this.getActiveObject();if(!e||e.type!=="image"&&e.type!=="fabric-image"){$s.warning("Select an image to vectorize.");return}$s.info("Vectorizing image. This may take a moment...");try{const t=e.getSrc(),s=await bSe.trace(t),{objects:r,options:a}=await sne(s),o=Qa.groupSVGElements(r,a),l=e.calcTransformMatrix(),c=Qa.qrDecompose(l);o.set({left:c.translateX,top:c.translateY,angle:c.angle,scaleX:c.scaleX*(e.width/o.width),scaleY:c.scaleY*(e.height/o.height),flipX:c.flipX,flipY:c.flipY,originX:"center",originY:"center",selectable:!0,evented:!0}),this.canvas.add(o),this.canvas.remove(e),this.canvas.setActiveObject(o),this.canvas.requestRenderAll(),this.historyManager.saveState("Vectorize Image"),$s.success("Image vectorized successfully!")}catch(t){console.error("Vectorization failed:",t),$s.error("Failed to vectorize image.")}}async extractPaletteFromActiveImage(){const e=this.getActiveObject();if(!e||e.type!=="image"&&e.type!=="fabric-image")return $s.warning("Select an image to extract colors."),null;$s.info("Extracting color palette...");try{const t=e.getSrc(),s=await mR.extractColors(t);return $s.success("Colors extracted!"),s}catch(t){return console.error("Color extraction failed:",t),$s.error("Failed to extract colors."),null}}async upscaleActiveImage(){const e=this.getActiveObject();if(!e||e.type!=="image"&&e.type!=="fabric-image"){$s.warning("Select an image to enhance.");return}$s.info("Enhancing image quality. This may take a minute...");try{const t=e.getSrc(),s=await YS.upscale(t);await this.replaceImage(e,s),this.historyManager.saveState("Upscale Image"),$s.success("Image enhanced successfully!")}catch(t){console.error("Upscaling failed:",t),$s.error("Failed to enhance image.")}}addShape(e,t={}){this.shapeManager.addShape(e,t)}async addSVG(e,t={}){await this.shapeManager.addSVG(e,t)}async addSVGString(e,t={}){await this.shapeManager.addSVGString(e,t)}loadGoogleFont(e){this.fontManager.loadGoogleFont(e)}setTextStyle(e,t){this.fontManager.setTextStyle(e,t)}applyImageFilter(e,t,s){this.filterManager.applyImageFilter(e,t,s)}toggleTextDecoration(e){return this.fontManager.toggleTextDecoration(e)}async maskObject(){const e=this.getActiveObject();if(!e||e.type!=="activeSelection"&&e.type!=="activeselection")return;const t=e.getObjects();if(t.length!==2)return;let s=t.find(d=>d.type==="image"),r=t.find(d=>["rect","circle","triangle","polygon","path"].includes(d.type));if(!s||!r)return;const a=await r.clone(),o=s.calcTransformMatrix(),l=Qa.invertTransform(o),c=r.calcTransformMatrix(),u=Qa.multiplyTransformMatrices(l,c),f=Qa.qrDecompose(u);a.set({flipX:!1,flipY:!1,scaleX:f.scaleX,scaleY:f.scaleY,angle:f.angle,skewX:f.skewX,skewY:f.skewY,left:f.translateX,top:f.translateY,originX:"center",originY:"center",absolutePositioned:!1}),s.clipPath=a,this.canvas.discardActiveObject(),this.canvas.remove(r),s.dirty=!0,this.canvas.requestRenderAll(),this.canvas.setActiveObject(s)}async exportImage(e={}){const{format:t="png",filename:s="design",quality:r=1,multiplier:a=2}=e,o=this.workspace.stroke;this.workspace.set({stroke:"transparent"});const l=this.canvas.getObjects().filter(u=>u.excludeFromExport);l.forEach(u=>u.set({opacity:0}));const c=this.canvas.viewportTransform.slice();this.canvas.setViewportTransform([1,0,0,1,0,0]);try{if(t==="pdf"){const u=this.canvas.toDataURL({format:"png",multiplier:a,left:0,top:0,width:this.originalWidth,height:this.originalHeight,enableRetinaScaling:!1}),f=new bs({orientation:this.originalWidth>this.originalHeight?"landscape":"portrait",unit:"px",format:[this.originalWidth,this.originalHeight]});f.addImage(u,"PNG",0,0,this.originalWidth,this.originalHeight),f.save(`${s}.pdf`)}else if(t==="json")this.exportProject();else{const u=this.canvas.toDataURL({format:t,quality:r,multiplier:a,left:0,top:0,width:this.originalWidth,height:this.originalHeight,enableRetinaScaling:!1}),f=document.createElement("a");f.href=u,f.download=`${s}.${t}`,document.body.appendChild(f),f.click(),document.body.removeChild(f)}$s.success("Export successful")}catch(u){console.error(u),$s.error("Export failed")}finally{this.canvas.setViewportTransform(c),this.workspace.set({stroke:o}),l.forEach(u=>u.set({opacity:1})),this.canvas.requestRenderAll()}}startCropMode(){const e=this.getActiveObject();if(!e||e.type!=="image"&&e.type!=="fabric-image"){$s.warning("Select an image to crop.");return}this.isCropping||(this.isCropping=!0,this.cropTarget=e,this._originalControls=e.controls,this._originalBorders={borderColor:e.borderColor,cornerColor:e.cornerColor,cornerStyle:e.cornerStyle,transparentCorners:e.transparentCorners},e.controls=O2e(),e.set({borderColor:"#ff9900",cornerColor:"#ff9900",cornerStyle:"circle",transparentCorners:!1,lockRotation:!0,lockScalingX:!0,lockScalingY:!0}),e.setCoords(),this.canvas.requestRenderAll(),this.onCropModeChange&&this.onCropModeChange(!0),$s.info("Drag handles to crop image."))}applyCrop(){this.cancelCrop(),$s.success("Crop applied.")}cancelCrop(){if(!this.isCropping||!this.cropTarget)return;const e=this.cropTarget;this._originalControls&&(e.controls=this._originalControls,this._originalControls=null),this._originalBorders&&(e.set(this._originalBorders),this._originalBorders=null),e.set({lockRotation:!1,lockScalingX:!1,lockScalingY:!1}),this.isCropping=!1,this.cropTarget=null,e.setCoords(),this.canvas.requestRenderAll(),this.onCropModeChange&&this.onCropModeChange(!1)}async loadProject(e){if(e)try{e.width&&e.height&&(this.originalWidth=e.width,this.originalHeight=e.height),await this.canvas.loadFromJSON(e);const t=this.canvas.getObjects().find(s=>s.name==="Background");t?(this.canvas.remove(t),t.set({selectable:!1,evented:!1,stroke:"#cccccc",strokeWidth:1}),this.canvas.backgroundImage=t,this.canvas.requestRenderAll(),this.workspace=t):this.canvas.backgroundImage?this.workspace=this.canvas.backgroundImage:this.initWorkspace(),this.viewport&&this.viewport.handleWindowResize&&this.viewport.handleWindowResize(),this.canvas.requestRenderAll(),$s.success("Project loaded")}catch(t){console.error("Load Error:",t),$s.error("Failed to load project")}}saveProject(){const e=this.canvas.toJSON(this.projectProperties);return e.width=this.originalWidth,e.height=this.originalHeight,e}exportProject(){const e=this.saveProject();e.timestamp=Date.now();const t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(s),o=`project-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,l=document.createElement("a");l.href=r,l.download=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)}async extractTextFromActiveImage(){const e=this.canvas.getActiveObject();if(!e||e.type!=="image"&&e.type!=="fabric-image"){$s.warning("Please select an image to extract text.");return}try{$s.info("Scanning image for text... (Supports Lao/English)",4e3);const t=e.getSrc(),s=await WCe.extractText(t,"lao+eng",a=>{console.log(`OCR Progress: ${Math.round(a*100)}%`)});if(!s||s.trim().length===0){$s.warning("No text found in the image.");return}const r=new lh(s,{left:e.left+20,top:e.top+20,fontSize:20,fontFamily:"Phetsarath OT",fill:"#000000"});return this.canvas.add(r),this.canvas.setActiveObject(r),this.canvas.renderAll(),$s.success("Text extracted successfully!"),s}catch(t){return console.error("Text extraction failed:",t),$s.error("Failed to extract text."),null}}}const ofe=Ie.createContext(null);function aP(){const n=Ie.useContext(ofe);if(!n)throw new Error("useCanvas must be used within a CanvasProvider");return n}function _Ze({children:n}){const[e,t]=Ie.useState(null),[s,r]=Ie.useState(null),[a,o]=Ie.useState("#000000");Ie.useEffect(()=>{const c=new vZe("c",{width:800,height:600,backgroundColor:"#ffffff"});return t(c),window.canvasManager=c,()=>{c.dispose()}},[]),Ie.useEffect(()=>{if(!e)return;const c=()=>{const u=e.getActiveObject();r(u),u&&u.fill&&typeof u.fill=="string"&&o(u.fill)};return e.canvas.on("selection:created",c),e.canvas.on("selection:updated",c),e.canvas.on("selection:cleared",()=>{r(null)}),e.canvas.on("object:updated",c),()=>{e.canvas&&(e.canvas.off("selection:created",c),e.canvas.off("selection:updated",c),e.canvas.off("selection:cleared",c),e.canvas.off("object:updated",c))}},[e]);const l={canvasManager:e,activeObject:s,currentColor:a,setCurrentColor:o};return V.jsx(ofe.Provider,{value:l,children:n})}const xZe=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),CZe=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),$q=n=>{const e=CZe(n);return e.charAt(0).toUpperCase()+e.slice(1)},lfe=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),SZe=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var MZe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const TZe=Ie.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:r="",children:a,iconNode:o,...l},c)=>Ie.createElement("svg",{ref:c,...MZe,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:lfe("lucide",r),...!a&&!SZe(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,f])=>Ie.createElement(u,f)),...Array.isArray(a)?a:[a]]));const Un=(n,e)=>{const t=Ie.forwardRef(({className:s,...r},a)=>Ie.createElement(TZe,{ref:a,iconNode:e,className:lfe(`lucide-${xZe($q(n))}`,`lucide-${n}`,s),...r}));return t.displayName=$q(n),t};const kZe=[["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"M10 16v4a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-4",key:"11f1s0"}],["path",{d:"M10 8V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v4",key:"t14dx9"}],["path",{d:"M20 16v1a2 2 0 0 1-2 2h-2a2 2 0 0 1-2-2v-1",key:"1w07xs"}],["path",{d:"M14 8V7c0-1.1.9-2 2-2h2a2 2 0 0 1 2 2v1",key:"1apec2"}]],EZe=Un("align-center-horizontal",kZe);const IZe=[["rect",{width:"6",height:"14",x:"4",y:"5",rx:"2",key:"1wwnby"}],["rect",{width:"6",height:"10",x:"14",y:"7",rx:"2",key:"1fe6j6"}],["path",{d:"M17 22v-5",key:"4b6g73"}],["path",{d:"M17 7V2",key:"hnrr36"}],["path",{d:"M7 22v-3",key:"1r4jpn"}],["path",{d:"M7 5V2",key:"liy1u9"}]],AZe=Un("align-horizontal-distribute-center",IZe);const LZe=[["path",{d:"M22 17h-3",key:"1lwga1"}],["path",{d:"M22 7h-5",key:"o2endc"}],["path",{d:"M5 17H2",key:"1gx9xc"}],["path",{d:"M7 7H2",key:"6bq26l"}],["rect",{x:"5",y:"14",width:"14",height:"6",rx:"2",key:"1qrzuf"}],["rect",{x:"7",y:"4",width:"10",height:"6",rx:"2",key:"we8e9z"}]],NZe=Un("align-vertical-distribute-center",LZe);const DZe=[["rect",{width:"14",height:"6",x:"5",y:"16",rx:"2",key:"1i8z2d"}],["rect",{width:"10",height:"6",x:"7",y:"2",rx:"2",key:"ypihtt"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],OZe=Un("align-vertical-justify-center",DZe);const PZe=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],$Ze=Un("arrow-down-to-line",PZe);const jZe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],rU=Un("arrow-down",jZe);const RZe=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],cfe=Un("arrow-left-right",RZe);const FZe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],yv=Un("arrow-left",FZe);const zZe=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ufe=Un("arrow-up-down",zZe);const BZe=[["path",{d:"M5 3h14",key:"7usisc"}],["path",{d:"m18 13-6-6-6 6",key:"1kf1n9"}],["path",{d:"M12 7v14",key:"1akyts"}]],UZe=Un("arrow-up-to-line",BZe);const VZe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],iU=Un("arrow-up",VZe);const WZe=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],ffe=Un("bold",WZe);const GZe=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],HZe=Un("box",GZe);const qZe=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],YZe=Un("chart-pie",qZe);const KZe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],dfe=Un("check",KZe);const XZe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],QZe=Un("chevron-down",XZe);const JZe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],hfe=Un("chevron-left",JZe);const ZZe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],pfe=Un("chevron-right",ZZe);const eet=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],tet=Un("circle",eet);const net=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],aU=Un("copy",net);const set=[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]],oU=Un("crop",set);const ret=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],mfe=Un("download",ret);const iet=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],aet=Un("eye-off",iet);const oet=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cet=Un("eye",oet);const uet=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],fet=Un("file-image",uet);const det=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]],het=Un("file-type",det);const pet=[["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],met=Un("folder-minus",pet);const get=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],yet=Un("folder-open",get);const bet=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],wet=Un("folder-plus",bet);const vet=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],_et=Un("folder",vet);const xet=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Cet=Un("grid-3x3",xet);const Met=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Tet=Un("grip-vertical",Met);const ket=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],Eet=Un("hand",ket);const Iet=[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19 3 3v-5.5",key:"9ldu5r"}],["path",{d:"m17 22 3-3",key:"1nkfve"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Aet=Un("image-down",Iet);const Let=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Net=Un("image",Let);const Det=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],gfe=Un("italic",Det);const Oet=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Pet=Un("key",Oet);const $et=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],jet=Un("keyboard",$et);const Ret=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],pM=Un("layers",Ret);const Fet=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],yfe=Un("layout-grid",Fet);const zet=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],bfe=Un("lock-open",zet);const Bet=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],lU=Un("lock",Bet);const Uet=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],Vet=Un("maximize",Uet);const Wet=[["path",{d:"M5 12h14",key:"1ays0h"}]],Get=Un("minus",Wet);const Het=[["path",{d:"M11 7 6 2",key:"1jwth8"}],["path",{d:"M18.992 12H2.041",key:"xw1gg"}],["path",{d:"M21.145 18.38A3.34 3.34 0 0 1 20 16.5a3.3 3.3 0 0 1-1.145 1.88c-.575.46-.855 1.02-.855 1.595A2 2 0 0 0 20 22a2 2 0 0 0 2-2.025c0-.58-.285-1.13-.855-1.595",key:"1nkol4"}],["path",{d:"m8.5 4.5 2.148-2.148a1.205 1.205 0 0 1 1.704 0l7.296 7.296a1.205 1.205 0 0 1 0 1.704l-7.592 7.592a3.615 3.615 0 0 1-5.112 0l-3.888-3.888a3.615 3.615 0 0 1 0-5.112L5.67 7.33",key:"1nk1rd"}]],qet=Un("paint-bucket",Het);const Yet=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Ket=Un("palette",Yet);const Xet=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Qet=Un("pencil",Xet);const Jet=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wfe=Un("plus",Jet);const Zet=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],ett=Un("qr-code",Zet);const ttt=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ntt=Un("rotate-ccw",ttt);const stt=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],rtt=Un("rotate-cw",stt);const itt=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],att=Un("ruler",itt);const ott=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ltt=Un("save",ott);const ctt=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]],vfe=Un("scaling",ctt);const utt=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],ftt=Un("scan-barcode",utt);const dtt=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}]],htt=Un("scan-text",dtt);const ptt=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],DL=Un("search",ptt);const mtt=[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]],_fe=Un("shapes",mtt);const gtt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],ytt=Un("smile",gtt);const btt=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],xfe=Un("sparkles",btt);const wtt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],vtt=Un("square",wtt);const _tt=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],xtt=Un("text-align-center",_tt);const Ctt=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],Cfe=Un("text-align-end",Ctt);const Stt=[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]],Mtt=Un("text-align-justify",Stt);const Ttt=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],Sfe=Un("text-align-start",Ttt);const ktt=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],oP=Un("trash-2",ktt);const Ett=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Mfe=Un("type",Ett);const Itt=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],Tfe=Un("underline",Itt);const Att=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ltt=Un("upload",Att);const Ntt=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],cU=Un("wand-sparkles",Ntt);const Dtt=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],hE=Un("x",Dtt),jq=n=>{let e;const t=new Set,s=(u,f)=>{const d=typeof u=="function"?u(e):u;if(!Object.is(d,e)){const h=e;e=f??(typeof d!="object"||d===null)?d:Object.assign({},e,d),t.forEach(p=>p(e,h))}},r=()=>e,l={setState:s,getState:r,getInitialState:()=>c,subscribe:u=>(t.add(u),()=>t.delete(u))},c=e=n(s,r,l);return l},Ott=(n=>n?jq(n):jq),Ptt=n=>n;function $tt(n,e=Ptt){const t=Hr.useSyncExternalStore(n.subscribe,Hr.useCallback(()=>e(n.getState()),[n,e]),Hr.useCallback(()=>e(n.getInitialState()),[n,e]));return Hr.useDebugValue(t),t}const Rq=n=>{const e=Ott(n),t=s=>$tt(e,s);return Object.assign(t,e),t},jtt=(n=>n?Rq(n):Rq),Nb=jtt(n=>({activeTab:"elements",setActiveTab:e=>n({activeTab:e}),showRulers:!0,setShowRulers:e=>n({showRulers:e}),showShortcuts:!1,setShowShortcuts:e=>n({showShortcuts:e}),showExport:!1,setShowExport:e=>n({showExport:e}),showResize:!1,setShowResize:e=>n({showResize:e}),colorPickerVisible:!1,setColorPickerVisible:e=>n({colorPickerVisible:e}),colorPickerAnchor:null,setColorPickerAnchor:e=>n({colorPickerAnchor:e}),activeColorProp:"fill",setActiveColorProp:e=>n({activeColorProp:e}),colorPickerAlign:"left",setColorPickerAlign:e=>n({colorPickerAlign:e}),extractedPalette:null,setExtractedPalette:e=>n({extractedPalette:e})}));function Rtt({canvasManager:n}){const[e,t]=Ie.useState(100),[s,r]=Ie.useState(!1),[a,o]=Ie.useState(!1),[l,c]=Ie.useState(!1),u=Ie.useRef(null);Ie.useEffect(()=>{if(!n)return;const w=x=>t(Math.round(x*100));n.onZoomChange(w),n.canvas&&t(Math.round(n.canvas.getZoom()*100))},[n]),Ie.useEffect(()=>{function w(x){u.current&&!u.current.contains(x.target)&&c(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[u]);const f=()=>{n&&(s?(n.disableDrawingMode(),r(!1)):(n.enableDrawingMode(),r(!0),o(!1)))},d=()=>{if(!n)return;const w=n.toggleHandMode();o(w),w&&r(!1)},h=()=>n?.zoomIn(),p=()=>n?.zoomOut(),g=()=>n?.resetZoom(),b=w=>{n?.setZoom(w/100),c(!1)},v=()=>{n?.fitToScreen(),c(!1)};return V.jsxs("div",{className:"zoom-toolbar-nav navbar-group",children:[V.jsx("button",{className:`icon-btn ${s?"active":""}`,onClick:f,title:"Free Drawing",children:V.jsx(Qet,{size:18})}),V.jsx("div",{className:"separator-vertical"}),V.jsx("button",{className:`icon-btn ${a?"active":""}`,onClick:d,title:"Hand Tool (Space)",children:V.jsx(Eet,{size:18})}),V.jsx("div",{className:"separator-vertical"}),V.jsx("button",{className:"icon-btn",onClick:p,title:"Zoom Out",children:V.jsx(Get,{size:18})}),V.jsxs("div",{className:"zoom-dropdown-container",ref:u,style:{position:"relative"},children:[V.jsxs("button",{className:"zoom-display-btn",onClick:()=>c(!l),style:{display:"flex",alignItems:"center",gap:"4px",background:"transparent",border:"none",color:"white",fontSize:"14px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",minWidth:"70px",justifyContent:"center"},children:[e,"% ",V.jsx(QZe,{size:12})]}),l&&V.jsxs("div",{className:"zoom-dropdown-menu",style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"8px",background:"#2b2d30",border:"1px solid #3e4042",borderRadius:"6px",padding:"4px 0",minWidth:"120px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",zIndex:1e3,display:"flex",flexDirection:"column",whiteSpace:"nowrap"},children:[[25,50,75,100,150,200,300].map(w=>V.jsxs("button",{onClick:()=>b(w),style:{background:"transparent",border:"none",color:"#e0e0e0",padding:"6px 16px",textAlign:"left",cursor:"pointer",fontSize:"13px",width:"100%"},onMouseEnter:x=>x.target.style.background="#3e4042",onMouseLeave:x=>x.target.style.background="transparent",children:[w,"%"]},w)),V.jsx("div",{style:{height:"1px",background:"#3e4042",margin:"4px 0"}}),V.jsx("button",{onClick:v,style:{background:"transparent",border:"none",color:"#e0e0e0",padding:"6px 16px",textAlign:"left",cursor:"pointer",fontSize:"13px",width:"100%"},onMouseEnter:w=>w.target.style.background="#3e4042",onMouseLeave:w=>w.target.style.background="transparent",children:"Fit to Screen"})]})]}),V.jsx("button",{className:"icon-btn",onClick:h,title:"Zoom In",children:V.jsx(wfe,{size:18})}),V.jsx("button",{className:"icon-btn",onClick:g,title:"Reset Zoom",children:V.jsx(Vet,{size:18})})]})}function Ftt({canvasManager:n,showRulers:e,setShowRulers:t}){const[s,r]=Ie.useState(!1),a=()=>{t&&t(!e)},o=()=>{if(n){const l=n.toggleGrid();r(l)}};return V.jsxs("div",{className:"nav-action-group",children:[V.jsx("button",{className:`icon-btn ${e?"active":""}`,onClick:a,title:"Toggle Rulers",children:V.jsx(att,{size:16})}),V.jsx("button",{className:`icon-btn ${s?"active":""}`,onClick:o,title:"Toggle Grid",children:V.jsx(Cet,{size:16})})]})}function ztt({canvasManager:n}){const[e,t]=Ie.useState(!1),[s,r]=Ie.useState(!1);return Ie.useEffect(()=>{const a=o=>{t(o.detail.canUndo),r(o.detail.canRedo)};return window.addEventListener("historyUpdate",a),n&&n.historyManager&&(t(n.historyManager.canUndo()),r(n.historyManager.canRedo())),()=>window.removeEventListener("historyUpdate",a)},[n]),Ie.useEffect(()=>{const a=o=>{(o.ctrlKey||o.metaKey)&&o.key.toLowerCase()==="z"?(o.preventDefault(),o.shiftKey?n?.redo():n?.undo()):(o.ctrlKey||o.metaKey)&&o.key.toLowerCase()==="y"&&(o.preventDefault(),n?.redo())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n]),V.jsxs("div",{className:"navbar-group",children:[V.jsx("button",{className:"icon-btn",title:"Undo (Ctrl+Z)",onClick:()=>n?.undo(),disabled:!e,children:V.jsx(ntt,{size:16})}),V.jsx("button",{className:"icon-btn",title:"Redo (Ctrl+Y)",onClick:()=>n?.redo(),disabled:!s,children:V.jsx(rtt,{size:16})})]})}function Btt({canvasManager:n,onExport:e}){const t=Ie.useRef(null),s=()=>{n?.duplicateActiveObject()},r=()=>{n?.toggleLockActiveObject()},a=()=>{t.current?.click()},o=()=>{n?.exportProject()},l=c=>{const u=c.target.files[0];if(!u)return;const f=new FileReader;f.onload=d=>{try{const h=JSON.parse(d.target.result);n.loadProject(h)}catch(h){console.error("Failed to load JSON",h),alert("Failed to load project file.")}},f.readAsText(u),c.target.value=""};return V.jsxs("div",{className:"nav-actions navbar-group",children:[V.jsx("input",{type:"file",ref:t,accept:".json,application/json",style:{display:"none"},onChange:l}),V.jsx("button",{className:"icon-btn",onClick:a,title:"Import JSON Project",children:V.jsx(yet,{size:16})}),V.jsx("button",{className:"icon-btn",onClick:o,title:"Save Project (JSON)",children:V.jsx(ltt,{size:16})}),V.jsx("button",{className:"icon-btn",onClick:e,title:"Export Design",children:V.jsx(mfe,{size:16})}),V.jsx("div",{style:{width:"1px",height:"24px",background:"var(--border-color)",margin:"0 4px"}}),V.jsx("button",{id:"btn-duplicate",className:"icon-btn",onClick:s,title:"Duplicate",children:V.jsx(aU,{size:16})}),V.jsx("button",{id:"btn-lock",className:"icon-btn",onClick:r,title:"Lock/Unlock",children:V.jsx(lU,{size:16})})]})}function lP(){return(lP=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n}).apply(this,arguments)}function kfe(n,e){if(n==null)return{};var t,s,r={},a=Object.keys(n);for(s=0;s<a.length;s++)e.indexOf(t=a[s])>=0||(r[t]=n[t]);return r}function m6(n){var e=Ie.useRef(n),t=Ie.useRef(function(s){e.current&&e.current(s)});return e.current=n,t.current}var KM=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n<e?e:n},mM=function(n){return"touches"in n},g6=function(n){return n&&n.ownerDocument.defaultView||self},Fq=function(n,e,t){var s=n.getBoundingClientRect(),r=mM(e)?(function(a,o){for(var l=0;l<a.length;l++)if(a[l].identifier===o)return a[l];return a[0]})(e.touches,t):e;return{left:KM((r.pageX-(s.left+g6(n).pageXOffset))/s.width),top:KM((r.pageY-(s.top+g6(n).pageYOffset))/s.height)}},zq=function(n){!mM(n)&&n.preventDefault()},Efe=Hr.memo(function(n){var e=n.onMove,t=n.onKey,s=kfe(n,["onMove","onKey"]),r=Ie.useRef(null),a=m6(e),o=m6(t),l=Ie.useRef(null),c=Ie.useRef(!1),u=Ie.useMemo(function(){var p=function(v){zq(v),(mM(v)?v.touches.length>0:v.buttons>0)&&r.current?a(Fq(r.current,v,l.current)):b(!1)},g=function(){return b(!1)};function b(v){var w=c.current,x=g6(r.current),S=v?x.addEventListener:x.removeEventListener;S(w?"touchmove":"mousemove",p),S(w?"touchend":"mouseup",g)}return[function(v){var w=v.nativeEvent,x=r.current;if(x&&(zq(w),!(function(C,M){return M&&!mM(C)})(w,c.current)&&x)){if(mM(w)){c.current=!0;var S=w.changedTouches||[];S.length&&(l.current=S[0].identifier)}x.focus(),a(Fq(x,w,l.current)),b(!0)}},function(v){var w=v.which||v.keyCode;w<37||w>40||(v.preventDefault(),o({left:w===39?.05:w===37?-.05:0,top:w===40?.05:w===38?-.05:0}))},b]},[o,a]),f=u[0],d=u[1],h=u[2];return Ie.useEffect(function(){return h},[h]),Hr.createElement("div",lP({},s,{onTouchStart:f,onMouseDown:f,className:"react-colorful__interactive",ref:r,onKeyDown:d,tabIndex:0,role:"slider"}))}),uU=function(n){return n.filter(Boolean).join(" ")},Ife=function(n){var e=n.color,t=n.left,s=n.top,r=s===void 0?.5:s,a=uU(["react-colorful__pointer",n.className]);return Hr.createElement("div",{className:a,style:{top:100*r+"%",left:100*t+"%"}},Hr.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Uc=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t},Utt=function(n){return qtt(y6(n))},y6=function(n){return n[0]==="#"&&(n=n.substring(1)),n.length<6?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?Uc(parseInt(n[3]+n[3],16)/255,2):1}:{r:parseInt(n.substring(0,2),16),g:parseInt(n.substring(2,4),16),b:parseInt(n.substring(4,6),16),a:n.length===8?Uc(parseInt(n.substring(6,8),16)/255,2):1}},Vtt=function(n){return Htt(Gtt(n))},Wtt=function(n){var e=n.s,t=n.v,s=n.a,r=(200-e)*t/100;return{h:Uc(n.h),s:Uc(r>0&&r<200?e*t/100/(r<=100?r:200-r)*100:0),l:Uc(r/2),a:Uc(s,2)}},b6=function(n){var e=Wtt(n);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Gtt=function(n){var e=n.h,t=n.s,s=n.v,r=n.a;e=e/360*6,t/=100,s/=100;var a=Math.floor(e),o=s*(1-t),l=s*(1-(e-a)*t),c=s*(1-(1-e+a)*t),u=a%6;return{r:Uc(255*[s,l,o,o,c,s][u]),g:Uc(255*[c,s,s,l,o,o][u]),b:Uc(255*[o,o,c,s,s,l][u]),a:Uc(r,2)}},UI=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},Htt=function(n){var e=n.r,t=n.g,s=n.b,r=n.a,a=r<1?UI(Uc(255*r)):"";return"#"+UI(e)+UI(t)+UI(s)+a},qtt=function(n){var e=n.r,t=n.g,s=n.b,r=n.a,a=Math.max(e,t,s),o=a-Math.min(e,t,s),l=o?a===e?(t-s)/o:a===t?2+(s-e)/o:4+(e-t)/o:0;return{h:Uc(60*(l<0?l+6:l)),s:Uc(a?o/a*100:0),v:Uc(a/255*100),a:r}},Ytt=Hr.memo(function(n){var e=n.hue,t=n.onChange,s=uU(["react-colorful__hue",n.className]);return Hr.createElement("div",{className:s},Hr.createElement(Efe,{onMove:function(r){t({h:360*r.left})},onKey:function(r){t({h:KM(e+360*r.left,0,360)})},"aria-label":"Hue","aria-valuenow":Uc(e),"aria-valuemax":"360","aria-valuemin":"0"},Hr.createElement(Ife,{className:"react-colorful__hue-pointer",left:e/360,color:b6({h:e,s:100,v:100,a:1})})))}),Ktt=Hr.memo(function(n){var e=n.hsva,t=n.onChange,s={backgroundColor:b6({h:e.h,s:100,v:100,a:1})};return Hr.createElement("div",{className:"react-colorful__saturation",style:s},Hr.createElement(Efe,{onMove:function(r){t({s:100*r.left,v:100-100*r.top})},onKey:function(r){t({s:KM(e.s+100*r.left,0,100),v:KM(e.v-100*r.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Uc(e.s)+"%, Brightness "+Uc(e.v)+"%"},Hr.createElement(Ife,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:b6(e)})))}),Afe=function(n,e){if(n===e)return!0;for(var t in n)if(n[t]!==e[t])return!1;return!0},Xtt=function(n,e){return n.toLowerCase()===e.toLowerCase()||Afe(y6(n),y6(e))};function Qtt(n,e,t){var s=m6(t),r=Ie.useState(function(){return n.toHsva(e)}),a=r[0],o=r[1],l=Ie.useRef({color:e,hsva:a});Ie.useEffect(function(){if(!n.equal(e,l.current.color)){var u=n.toHsva(e);l.current={hsva:u,color:e},o(u)}},[e,n]),Ie.useEffect(function(){var u;Afe(a,l.current.hsva)||n.equal(u=n.fromHsva(a),l.current.color)||(l.current={hsva:a,color:u},s(u))},[a,n,s]);var c=Ie.useCallback(function(u){o(function(f){return Object.assign({},f,u)})},[]);return[a,c]}var Jtt=typeof window<"u"?Ie.useLayoutEffect:Ie.useEffect,Ztt=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Bq=new Map,ent=function(n){Jtt(function(){var e=n.current?n.current.ownerDocument:document;if(e!==void 0&&!Bq.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Bq.set(e,t);var s=Ztt();s&&t.setAttribute("nonce",s),e.head.appendChild(t)}},[])},tnt=function(n){var e=n.className,t=n.colorModel,s=n.color,r=s===void 0?t.defaultColor:s,a=n.onChange,o=kfe(n,["className","colorModel","color","onChange"]),l=Ie.useRef(null);ent(l);var c=Qtt(t,r,a),u=c[0],f=c[1],d=uU(["react-colorful",e]);return Hr.createElement("div",lP({},o,{ref:l,className:d}),Hr.createElement(Ktt,{hsva:u,onChange:f}),Hr.createElement(Ytt,{hue:u.h,onChange:f,className:"react-colorful__last-control"}))},nnt={defaultColor:"000",toHsva:Utt,fromHsva:function(n){return Vtt({h:n.h,s:n.s,v:n.v,a:1})},equal:Xtt},snt=function(n){return Hr.createElement(tnt,lP({},n,{colorModel:nnt}))};function Lfe({color:n,onChange:e,onClose:t,anchorEl:s,align:r="left"}){const a=Ie.useRef(null),[o,l]=Ie.useState({top:100,left:100,right:0}),[c,u]=Ie.useState(n);Ie.useEffect(()=>{if(s){const h=s.getBoundingClientRect();l({top:h.bottom+10,left:h.left,right:window.innerWidth-h.right})}},[s]),Ie.useEffect(()=>{const h=p=>{a.current&&!a.current.contains(p.target)&&!s?.contains(p.target)&&t()};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[t,s]),Ie.useEffect(()=>{u(n==="transparent"?"":n.toUpperCase())},[n]);const f=h=>{const p=h.target.value;u(p),/^#([0-9A-F]{3}){1,2}$/i.test(p)?e(p):/^([0-9A-F]{3}){1,2}$/i.test(p)&&e("#"+p)},d=n==="transparent";return V.jsxs("div",{ref:a,style:{position:"fixed",top:`${o.top}px`,left:r==="left"?`${o.left}px`:"auto",right:r==="right"?`${o.right}px`:"auto",zIndex:99999,background:"white",padding:"12px",borderRadius:"8px",boxShadow:"0 4px 16px rgba(0,0,0,0.2)",border:"1px solid #e5e5e5",width:"200px"},children:[V.jsx(snt,{color:d?"#FFFFFF":n,onChange:e,style:{width:"100%",height:"150px"}}),V.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"12px"},children:[V.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",background:"#f3f4f6",border:"1px solid #e5e5e5",borderRadius:"4px",padding:"0 8px"},children:[V.jsx("span",{style:{color:"#9ca3af",fontSize:"13px",marginRight:"4px"},children:"#"}),V.jsx("input",{type:"text",value:d?"TRANSPARENT":c.replace("#",""),onChange:f,placeholder:"HEX",style:{border:"none",background:"transparent",width:"100%",padding:"6px 0",fontSize:"13px",fontFamily:"monospace",outline:"none",color:"#374151",textTransform:"uppercase"}})]}),V.jsx("button",{onClick:()=>e("transparent"),title:"No Color",style:{width:"32px",height:"32px",borderRadius:"4px",border:`1px solid ${d?"#6366f1":"#e5e5e5"}`,background:"conic-gradient(from 180deg at 50% 50%, #fff 0deg, #fff 90deg, #e5e5e5 90deg, #e5e5e5 180deg, #fff 180deg, #fff 270deg, #e5e5e5 270deg, #e5e5e5 360deg)",backgroundSize:"10px 10px",backgroundPosition:"center",cursor:"pointer",padding:0,position:"relative",flexShrink:0},children:V.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",width:"120%",height:"2px",background:"#ef4444",transform:"translate(-50%, -50%) rotate(-45deg)"}})})]})]})}function rnt({canvasManager:n}){const[e,t]=Ie.useState(!1),[s,r]=Ie.useState("#ffffff"),a=Ie.useRef(null),o=l=>{r(l),n&&n.setBackgroundColor(l)};return V.jsxs("div",{className:"nav-action-group",children:[V.jsx("button",{ref:a,className:`icon-btn ${e?"active":""}`,onClick:()=>t(!e),title:"Canvas Background Color",children:V.jsx(qet,{size:18})}),e&&V.jsx(Lfe,{color:s,onChange:o,onClose:()=>t(!1),anchorEl:a.current,align:"right"})]})}function int({canvasManager:n,onOpenShortcuts:e,onOpenExport:t,onOpenResize:s}){const{showRulers:r,setShowRulers:a}=Nb();return V.jsxs("nav",{className:"navbar",children:[V.jsxs("div",{className:"nav-left",children:[V.jsx("a",{href:"index.html",className:"icon-btn nav-link-btn",title:"Back to Dashboard",children:V.jsx(yfe,{size:20})}),V.jsx("a",{href:"index.html",className:"logo nav-brand",children:"CanvasPro"}),V.jsx("div",{style:{borderRight:"1px solid var(--border-color)",paddingRight:"12px",marginRight:"12px"},children:V.jsxs("button",{id:"btn-open-resize",className:"btn btn-sm",title:"Resize Canvas",onClick:s,children:[V.jsx(vfe,{size:16}),V.jsx("span",{children:"Resize"})]})})]}),V.jsxs("div",{className:"nav-center",children:[V.jsx("div",{className:"separator-vertical"}),V.jsx(Btt,{canvasManager:n,onExport:t}),V.jsx("div",{className:"separator-vertical"}),V.jsx(ztt,{canvasManager:n}),V.jsx("div",{className:"separator-vertical"}),V.jsx(Rtt,{canvasManager:n})]}),V.jsxs("div",{className:"nav-right nav-right-group",children:[V.jsx("button",{className:"icon-btn",onClick:e,title:"Keyboard Shortcuts",children:V.jsx(jet,{size:18})}),V.jsx("div",{className:"separator-vertical"}),V.jsx(rnt,{canvasManager:n}),V.jsx("div",{className:"separator-vertical"}),V.jsx(Ftt,{canvasManager:n,showRulers:r,setShowRulers:a})]})]})}const OL=new Map,Ly=[],ant=(n,e,t)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){const s=OL.get(n);if(s===void 0)OL.set(n,{backend:e,priority:t});else{if(s.priority>t)return;if(s.priority===t&&s.backend!==e)throw new Error(`cannot register backend "${n}" using priority ${t}`)}if(t>=0){const r=Ly.indexOf(n);r!==-1&&Ly.splice(r,1);for(let a=0;a<Ly.length;a++)if(OL.get(Ly[a]).priority<=t){Ly.splice(a,0,n);return}Ly.push(n)}return}throw new TypeError("not a valid backend")},ont=async n=>{const e=OL.get(n);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{const t=!!e.initPromise;try{return t||(e.initPromise=e.backend.init(n)),await e.initPromise,e.initialized=!0,e.backend}catch(s){return t||(e.error=`${s}`,e.aborted=!0),e.error}finally{delete e.initPromise}}},lnt=async n=>{const e=n.executionProviders||[],t=e.map(c=>typeof c=="string"?c:c.name),s=t.length===0?Ly:t;let r;const a=[],o=new Set;for(const c of s){const u=await ont(c);typeof u=="string"?a.push({name:c,err:u}):(r||(r=u),r===u&&o.add(c))}if(!r)throw new Error(`no available backend found. ERR: ${a.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(const{name:c,err:u}of a)t.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${u}`);const l=e.filter(c=>o.has(typeof c=="string"?c:c.name));return[r,new Proxy(n,{get:(c,u)=>u==="executionProviders"?l:Reflect.get(c,u)})]},cnt="1.21.0";let Uq="warning";const fp={wasm:{},webgl:{},webgpu:{},versions:{common:cnt},set logLevel(n){if(n!==void 0){if(typeof n!="string"||["verbose","info","warning","error","fatal"].indexOf(n)===-1)throw new Error(`Unsupported logging level: ${n}`);Uq=n}},get logLevel(){return Uq}};Object.defineProperty(fp,"logLevel",{enumerable:!0});const unt=fp,fnt=(n,e)=>{const t=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);t.width=n.dims[3],t.height=n.dims[2];const s=t.getContext("2d");if(s!=null){let r,a;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(r=n.dims[2],a=n.dims[3]):(r=n.dims[3],a=n.dims[2]);const o=e?.format!==void 0?e.format:"RGB",l=e?.norm;let c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],0],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));const f=a*r;let d=0,h=f,p=f*2,g=-1;o==="RGBA"?(d=0,h=f,p=f*2,g=f*3):o==="RGB"?(d=0,h=f,p=f*2):o==="RBG"&&(d=0,p=f,h=f*2);for(let b=0;b<a;b++)for(let v=0;v<r;v++){const w=(n.data[d++]-u[0])*c[0],x=(n.data[h++]-u[1])*c[1],S=(n.data[p++]-u[2])*c[2],C=g===-1?255:(n.data[g++]-u[3])*c[3];s.fillStyle="rgba("+w+","+x+","+S+","+C+")",s.fillRect(v,b,1,1)}if("toDataURL"in t)return t.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},dnt=(n,e)=>{const t=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let s;if(t!=null){let r,a,o;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(r=n.dims[2],a=n.dims[1],o=n.dims[3]):(r=n.dims[3],a=n.dims[2],o=n.dims[1]);const l=e!==void 0&&e.format!==void 0?e.format:"RGB",c=e?.norm;let u,f;c===void 0||c.mean===void 0?u=[255,255,255,255]:typeof c.mean=="number"?u=[c.mean,c.mean,c.mean,c.mean]:(u=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(u[3]=c.mean[3])),c===void 0||c.bias===void 0?f=[0,0,0,0]:typeof c.bias=="number"?f=[c.bias,c.bias,c.bias,c.bias]:(f=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(f[3]=c.bias[3]));const d=a*r;if(e!==void 0&&(e.format!==void 0&&o===4&&e.format!=="RGBA"||o===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const h=4;let p=0,g=1,b=2,v=3,w=0,x=d,S=d*2,C=-1;l==="RGBA"?(w=0,x=d,S=d*2,C=d*3):l==="RGB"?(w=0,x=d,S=d*2):l==="RBG"&&(w=0,S=d,x=d*2),s=t.createImageData(r,a);for(let M=0;M<a*r;p+=h,g+=h,b+=h,v+=h,M++)s.data[p]=(n.data[w++]-f[0])*u[0],s.data[g]=(n.data[x++]-f[1])*u[1],s.data[b]=(n.data[S++]-f[2])*u[2],s.data[v]=C===-1?255:(n.data[C++]-f[3])*u[3]}else throw new Error("Can not access image data");return s},$5=(n,e)=>{if(n===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:t,width:s}=e,r=e.norm??{mean:255,bias:0};let a,o;typeof r.mean=="number"?a=[r.mean,r.mean,r.mean,r.mean]:a=[r.mean[0],r.mean[1],r.mean[2],r.mean[3]??255],typeof r.bias=="number"?o=[r.bias,r.bias,r.bias,r.bias]:o=[r.bias[0],r.bias[1],r.bias[2],r.bias[3]??0];const l=e.format!==void 0?e.format:"RGBA",c=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",u=t*s,f=c==="RGBA"?new Float32Array(u*4):new Float32Array(u*3);let d=4,h=0,p=1,g=2,b=3,v=0,w=u,x=u*2,S=-1;l==="RGB"&&(d=3,h=0,p=1,g=2,b=-1),c==="RGBA"?S=u*3:c==="RBG"?(v=0,x=u,w=u*2):c==="BGR"&&(x=0,w=u,v=u*2);for(let M=0;M<u;M++,h+=d,g+=d,p+=d,b+=d)f[v++]=(n[h]+o[0])/a[0],f[w++]=(n[p]+o[1])/a[1],f[x++]=(n[g]+o[2])/a[2],S!==-1&&b!==-1&&(f[S++]=(n[b]+o[3])/a[3]);return c==="RGBA"?new oh("float32",f,[1,4,t,s]):new oh("float32",f,[1,3,t,s])},hnt=async(n,e)=>{const t=typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement,s=typeof ImageData<"u"&&n instanceof ImageData,r=typeof ImageBitmap<"u"&&n instanceof ImageBitmap,a=typeof n=="string";let o,l=e??{};const c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},u=f=>typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement||f instanceof OffscreenCanvas?f.getContext("2d"):null;if(t){const f=c();f.width=n.width,f.height=n.height;const d=u(f);if(d!=null){let h=n.height,p=n.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,p=e.resizedWidth),e!==void 0){if(l=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=h,l.width=p}else l.tensorFormat="RGBA",l.height=h,l.width=p;d.drawImage(n,0,0),o=d.getImageData(0,0,p,h).data}else throw new Error("Can not access image data")}else if(s){let f,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(f=e.resizedHeight,d=e.resizedWidth):(f=n.height,d=n.width),e!==void 0&&(l=e),l.format="RGBA",l.height=f,l.width=d,e!==void 0){const h=c();h.width=d,h.height=f;const p=u(h);if(p!=null)p.putImageData(n,0,0),o=p.getImageData(0,0,d,f).data;else throw new Error("Can not access image data")}else o=n.data}else if(r){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");const f=c();f.width=n.width,f.height=n.height;const d=u(f);if(d!=null){const h=n.height,p=n.width;return d.drawImage(n,0,0,p,h),o=d.getImageData(0,0,p,h).data,l.height=h,l.width=p,$5(o,l)}else throw new Error("Can not access image data")}else{if(a)return new Promise((f,d)=>{const h=c(),p=u(h);if(!n||!p)return d();const g=new Image;g.crossOrigin="Anonymous",g.src=n,g.onload=()=>{h.width=g.width,h.height=g.height,p.drawImage(g,0,0,h.width,h.height);const b=p.getImageData(0,0,h.width,h.height);l.height=h.height,l.width=h.width,f($5(b.data,l))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(o!==void 0)return $5(o,l);throw new Error("Input data provided is not supported - aborted tensor creation")},pnt=(n,e)=>{const{width:t,height:s,download:r,dispose:a}=e,o=[1,s,t,4];return new oh({location:"texture",type:"float32",texture:n,dims:o,download:r,dispose:a})},mnt=(n,e)=>{const{dataType:t,dims:s,download:r,dispose:a}=e;return new oh({location:"gpu-buffer",type:t??"float32",gpuBuffer:n,dims:s,download:r,dispose:a})},gnt=(n,e)=>{const{dataType:t,dims:s,download:r,dispose:a}=e;return new oh({location:"ml-tensor",type:t??"float32",mlTensor:n,dims:s,download:r,dispose:a})},ynt=(n,e,t)=>new oh({location:"cpu-pinned",type:n,data:e,dims:t??[e.length]}),jv=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),PL=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let Vq=!1;const bnt=()=>{if(!Vq){Vq=!0;const n=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,t=globalThis.Float16Array,s=typeof t<"u"&&t.from;n&&(jv.set("int64",BigInt64Array),PL.set(BigInt64Array,"int64")),e&&(jv.set("uint64",BigUint64Array),PL.set(BigUint64Array,"uint64")),s?(jv.set("float16",t),PL.set(t,"float16")):jv.set("float16",Uint16Array)}},wnt=n=>{let e=1;for(let t=0;t<n.length;t++){const s=n[t];if(typeof s!="number"||!Number.isSafeInteger(s))throw new TypeError(`dims[${t}] must be an integer, got: ${s}`);if(s<0)throw new RangeError(`dims[${t}] must be a non-negative integer, got: ${s}`);e*=s}return e},vnt=(n,e)=>{switch(n.location){case"cpu":return new oh(n.type,n.data,e);case"cpu-pinned":return new oh({location:"cpu-pinned",data:n.data,type:n.type,dims:e});case"texture":return new oh({location:"texture",texture:n.texture,type:n.type,dims:e});case"gpu-buffer":return new oh({location:"gpu-buffer",gpuBuffer:n.gpuBuffer,type:n.type,dims:e});case"ml-tensor":return new oh({location:"ml-tensor",mlTensor:n.mlTensor,type:n.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${n.location} is not supported`)}};let oh=class{constructor(e,t,s){bnt();let r,a;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,r=e.type,a=e.dims,e.location){case"cpu-pinned":{const l=jv.get(r);if(!l)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(e.data instanceof l))throw new TypeError(`buffer should be of type ${l.name}`);this.cpuData=e.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint64"&&r!=="int8"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let l,c;if(typeof e=="string")if(r=e,c=s,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");l=t}else{const u=jv.get(e);if(u===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&u===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${u.name} as data.`);e==="uint64"||e==="int64"?l=u.from(t,BigInt):l=u.from(t)}else if(t instanceof u)l=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")l=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&t instanceof Uint16Array&&u!==Uint16Array)l=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw new TypeError(`A ${r} tensor's data must be type of ${u}`)}else if(c=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const u=typeof e[0];if(u==="string")r="string",l=e;else if(u==="boolean")r="bool",l=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${u}.`)}else if(e instanceof Uint8ClampedArray)r="uint8",l=Uint8Array.from(e);else{const u=PL.get(e.constructor);if(u===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);r=u,l=e}if(c===void 0)c=[l.length];else if(!Array.isArray(c))throw new TypeError("A tensor's dims must be a number array");a=c,this.cpuData=l,this.dataLocation="cpu"}const o=wnt(a);if(this.cpuData&&o!==this.cpuData.length&&!((r==="uint4"||r==="int4")&&Math.ceil(o/2)===this.cpuData.length))throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=a,this.size=o}static async fromImage(e,t){return hnt(e,t)}static fromTexture(e,t){return pnt(e,t)}static fromGpuBuffer(e,t){return mnt(e,t)}static fromMLTensor(e,t){return gnt(e,t)}static fromPinnedBuffer(e,t,s){return ynt(e,t,s)}toDataURL(e){return fnt(this,e)}toImageData(e){return dnt(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return vnt(this,e)}};const Av=oh,Nfe=(n,e)=>{(typeof fp.trace>"u"?!fp.wasm.trace:!fp.trace)||console.timeStamp(`${n}::ORT::${e}`)},Dfe=(n,e)=>{const t=new Error().stack?.split(/\r\n|\r|\n/g)||[];let s=!1;for(let r=0;r<t.length;r++){if(s&&!t[r].includes("TRACE_FUNC")){let a=`FUNC_${n}::${t[r].trim().split(" ")[1]}`;e&&(a+=`::${e}`),Nfe("CPU",a);return}t[r].includes("TRACE_FUNC")&&(s=!0)}},w6=n=>{(typeof fp.trace>"u"?!fp.wasm.trace:!fp.trace)||Dfe("BEGIN",n)},v6=n=>{(typeof fp.trace>"u"?!fp.wasm.trace:!fp.trace)||Dfe("END",n)};let _nt=class Ofe{constructor(e){this.handler=e}async run(e,t,s){w6();const r={};let a={};if(typeof e!="object"||e===null||e instanceof Av||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if(typeof t=="object"){if(t===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof Av)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(t.length===0)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(const u of t){if(typeof u!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(u)===-1)throw new RangeError(`'fetches' contains invalid output name: ${u}.`);r[u]=null}if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else{let u=!1;const f=Object.getOwnPropertyNames(t);for(const d of this.outputNames)if(f.indexOf(d)!==-1){const h=t[d];(h===null||h instanceof Av)&&(u=!0,o=!1,r[d]=h)}if(u){if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else a=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const u of this.inputNames)if(typeof e[u]>"u")throw new Error(`input '${u}' is missing in 'feeds'.`);if(o)for(const u of this.outputNames)r[u]=null;const l=await this.handler.run(e,r,a),c={};for(const u in l)if(Object.hasOwnProperty.call(l,u)){const f=l[u];f instanceof Av?c[u]=f:c[u]=new Av(f.type,f.data,f.dims)}return v6(),c}async release(){return this.handler.dispose()}static async create(e,t,s,r){w6();let a,o={};if(typeof e=="string"){if(a=e,typeof t=="object"&&t!==null)o=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(a=e,typeof t=="object"&&t!==null)o=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){const f=e;let d=0,h=e.byteLength;if(typeof t=="object"&&t!==null)o=t;else if(typeof t=="number"){if(d=t,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=f.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${f.byteLength}).`);if(h=e.byteLength-d,typeof s=="number"){if(h=s,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>f.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${f.byteLength-d}].`);if(typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(typeof s<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof t<"u")throw new TypeError("'options' must be an object.");a=new Uint8Array(f,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[l,c]=await lnt(o),u=await l.createInferenceSessionHandler(a,c);return v6(),new Ofe(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const xnt=_nt,Cnt=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession:xnt,TRACE:Nfe,TRACE_FUNC_BEGIN:w6,TRACE_FUNC_END:v6,Tensor:Av,env:unt,registerBackend:ant},Symbol.toStringTag,{value:"Module"}));var fU=Object.defineProperty,Snt=Object.getOwnPropertyDescriptor,Mnt=Object.getOwnPropertyNames,Tnt=Object.prototype.hasOwnProperty,knt=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')}),pn=(n,e)=>()=>(n&&(e=n(n=0)),e),rx=(n,e)=>{for(var t in e)fU(n,t,{get:e[t],enumerable:!0})},Ent=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Mnt(e))!Tnt.call(n,r)&&r!==t&&fU(n,r,{get:()=>e[r],enumerable:!(s=Snt(e,r))||s.enumerable});return n},XM=n=>Ent(fU({},"__esModule",{value:!0}),n),QC,P0,Yy,Wq,Pfe,$fe=pn(()=>{QC=new Map,P0=[],Yy=(n,e,t)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){let s=QC.get(n);if(s===void 0)QC.set(n,{backend:e,priority:t});else{if(s.priority>t)return;if(s.priority===t&&s.backend!==e)throw new Error(`cannot register backend "${n}" using priority ${t}`)}if(t>=0){let r=P0.indexOf(n);r!==-1&&P0.splice(r,1);for(let a=0;a<P0.length;a++)if(QC.get(P0[a]).priority<=t){P0.splice(a,0,n);return}P0.push(n)}return}throw new TypeError("not a valid backend")},Wq=async n=>{let e=QC.get(n);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{let t=!!e.initPromise;try{return t||(e.initPromise=e.backend.init(n)),await e.initPromise,e.initialized=!0,e.backend}catch(s){return t||(e.error=`${s}`,e.aborted=!0),e.error}finally{delete e.initPromise}}},Pfe=async n=>{let e=n.executionProviders||[],t=e.map(c=>typeof c=="string"?c:c.name),s=t.length===0?P0:t,r,a=[],o=new Set;for(let c of s){let u=await Wq(c);typeof u=="string"?a.push({name:c,err:u}):(r||(r=u),r===u&&o.add(c))}if(!r)throw new Error(`no available backend found. ERR: ${a.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(let{name:c,err:u}of a)t.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${u}`);let l=e.filter(c=>o.has(typeof c=="string"?c:c.name));return[r,new Proxy(n,{get:(c,u)=>u==="executionProviders"?l:Reflect.get(c,u)})]}}),Int=pn(()=>{$fe()}),jfe,Ant=pn(()=>{jfe="1.22.0-dev.20250409-89f8206ba4"}),j5,nh,Rfe=pn(()=>{Ant(),j5="warning",nh={wasm:{},webgl:{},webgpu:{},versions:{common:jfe},set logLevel(n){if(n!==void 0){if(typeof n!="string"||["verbose","info","warning","error","fatal"].indexOf(n)===-1)throw new Error(`Unsupported logging level: ${n}`);j5=n}},get logLevel(){return j5}},Object.defineProperty(nh,"logLevel",{enumerable:!0})}),pa,Lnt=pn(()=>{Rfe(),pa=nh}),Ffe,zfe,Nnt=pn(()=>{Ffe=(n,e)=>{let t=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);t.width=n.dims[3],t.height=n.dims[2];let s=t.getContext("2d");if(s!=null){let r,a;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(r=n.dims[2],a=n.dims[3]):(r=n.dims[3],a=n.dims[2]);let o=e?.format!==void 0?e.format:"RGB",l=e?.norm,c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],0],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));let f=a*r,d=0,h=f,p=f*2,g=-1;o==="RGBA"?(d=0,h=f,p=f*2,g=f*3):o==="RGB"?(d=0,h=f,p=f*2):o==="RBG"&&(d=0,p=f,h=f*2);for(let b=0;b<a;b++)for(let v=0;v<r;v++){let w=(n.data[d++]-u[0])*c[0],x=(n.data[h++]-u[1])*c[1],S=(n.data[p++]-u[2])*c[2],C=g===-1?255:(n.data[g++]-u[3])*c[3];s.fillStyle="rgba("+w+","+x+","+S+","+C+")",s.fillRect(v,b,1,1)}if("toDataURL"in t)return t.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},zfe=(n,e)=>{let t=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),s;if(t!=null){let r,a,o;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(r=n.dims[2],a=n.dims[1],o=n.dims[3]):(r=n.dims[3],a=n.dims[2],o=n.dims[1]);let l=e!==void 0&&e.format!==void 0?e.format:"RGB",c=e?.norm,u,f;c===void 0||c.mean===void 0?u=[255,255,255,255]:typeof c.mean=="number"?u=[c.mean,c.mean,c.mean,c.mean]:(u=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(u[3]=c.mean[3])),c===void 0||c.bias===void 0?f=[0,0,0,0]:typeof c.bias=="number"?f=[c.bias,c.bias,c.bias,c.bias]:(f=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(f[3]=c.bias[3]));let d=a*r;if(e!==void 0&&(e.format!==void 0&&o===4&&e.format!=="RGBA"||o===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,p=0,g=1,b=2,v=3,w=0,x=d,S=d*2,C=-1;l==="RGBA"?(w=0,x=d,S=d*2,C=d*3):l==="RGB"?(w=0,x=d,S=d*2):l==="RBG"&&(w=0,S=d,x=d*2),s=t.createImageData(r,a);for(let M=0;M<a*r;p+=h,g+=h,b+=h,v+=h,M++)s.data[p]=(n.data[w++]-f[0])*u[0],s.data[g]=(n.data[x++]-f[1])*u[1],s.data[b]=(n.data[S++]-f[2])*u[2],s.data[v]=C===-1?255:(n.data[C++]-f[3])*u[3]}else throw new Error("Can not access image data");return s}}),VI,Bfe,Ufe,Vfe,Wfe,Gfe,Dnt=pn(()=>{dU(),VI=(n,e)=>{if(n===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:t,width:s}=e,r=e.norm??{mean:255,bias:0},a,o;typeof r.mean=="number"?a=[r.mean,r.mean,r.mean,r.mean]:a=[r.mean[0],r.mean[1],r.mean[2],r.mean[3]??255],typeof r.bias=="number"?o=[r.bias,r.bias,r.bias,r.bias]:o=[r.bias[0],r.bias[1],r.bias[2],r.bias[3]??0];let l=e.format!==void 0?e.format:"RGBA",c=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",u=t*s,f=c==="RGBA"?new Float32Array(u*4):new Float32Array(u*3),d=4,h=0,p=1,g=2,b=3,v=0,w=u,x=u*2,S=-1;l==="RGB"&&(d=3,h=0,p=1,g=2,b=-1),c==="RGBA"?S=u*3:c==="RBG"?(v=0,x=u,w=u*2):c==="BGR"&&(x=0,w=u,v=u*2);for(let C=0;C<u;C++,h+=d,g+=d,p+=d,b+=d)f[v++]=(n[h]+o[0])/a[0],f[w++]=(n[p]+o[1])/a[1],f[x++]=(n[g]+o[2])/a[2],S!==-1&&b!==-1&&(f[S++]=(n[b]+o[3])/a[3]);return c==="RGBA"?new ld("float32",f,[1,4,t,s]):new ld("float32",f,[1,3,t,s])},Bfe=async(n,e)=>{let t=typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement,s=typeof ImageData<"u"&&n instanceof ImageData,r=typeof ImageBitmap<"u"&&n instanceof ImageBitmap,a=typeof n=="string",o,l=e??{},c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},u=f=>typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement||f instanceof OffscreenCanvas?f.getContext("2d"):null;if(t){let f=c();f.width=n.width,f.height=n.height;let d=u(f);if(d!=null){let h=n.height,p=n.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,p=e.resizedWidth),e!==void 0){if(l=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=h,l.width=p}else l.tensorFormat="RGBA",l.height=h,l.width=p;d.drawImage(n,0,0),o=d.getImageData(0,0,p,h).data}else throw new Error("Can not access image data")}else if(s){let f,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(f=e.resizedHeight,d=e.resizedWidth):(f=n.height,d=n.width),e!==void 0&&(l=e),l.format="RGBA",l.height=f,l.width=d,e!==void 0){let h=c();h.width=d,h.height=f;let p=u(h);if(p!=null)p.putImageData(n,0,0),o=p.getImageData(0,0,d,f).data;else throw new Error("Can not access image data")}else o=n.data}else if(r){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");let f=c();f.width=n.width,f.height=n.height;let d=u(f);if(d!=null){let h=n.height,p=n.width;return d.drawImage(n,0,0,p,h),o=d.getImageData(0,0,p,h).data,l.height=h,l.width=p,VI(o,l)}else throw new Error("Can not access image data")}else{if(a)return new Promise((f,d)=>{let h=c(),p=u(h);if(!n||!p)return d();let g=new Image;g.crossOrigin="Anonymous",g.src=n,g.onload=()=>{h.width=g.width,h.height=g.height,p.drawImage(g,0,0,h.width,h.height);let b=p.getImageData(0,0,h.width,h.height);l.height=h.height,l.width=h.width,f(VI(b.data,l))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(o!==void 0)return VI(o,l);throw new Error("Input data provided is not supported - aborted tensor creation")},Ufe=(n,e)=>{let{width:t,height:s,download:r,dispose:a}=e,o=[1,s,t,4];return new ld({location:"texture",type:"float32",texture:n,dims:o,download:r,dispose:a})},Vfe=(n,e)=>{let{dataType:t,dims:s,download:r,dispose:a}=e;return new ld({location:"gpu-buffer",type:t??"float32",gpuBuffer:n,dims:s,download:r,dispose:a})},Wfe=(n,e)=>{let{dataType:t,dims:s,download:r,dispose:a}=e;return new ld({location:"ml-tensor",type:t??"float32",mlTensor:n,dims:s,download:r,dispose:a})},Gfe=(n,e,t)=>new ld({location:"cpu-pinned",type:n,data:e,dims:t??[e.length]})}),Uy,KS,R5,Hfe,Ont=pn(()=>{Uy=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),KS=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),R5=!1,Hfe=()=>{if(!R5){R5=!0;let n=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,t=globalThis.Float16Array,s=typeof t<"u"&&t.from;n&&(Uy.set("int64",BigInt64Array),KS.set(BigInt64Array,"int64")),e&&(Uy.set("uint64",BigUint64Array),KS.set(BigUint64Array,"uint64")),s?(Uy.set("float16",t),KS.set(t,"float16")):Uy.set("float16",Uint16Array)}}}),qfe,Yfe,Pnt=pn(()=>{dU(),qfe=n=>{let e=1;for(let t=0;t<n.length;t++){let s=n[t];if(typeof s!="number"||!Number.isSafeInteger(s))throw new TypeError(`dims[${t}] must be an integer, got: ${s}`);if(s<0)throw new RangeError(`dims[${t}] must be a non-negative integer, got: ${s}`);e*=s}return e},Yfe=(n,e)=>{switch(n.location){case"cpu":return new ld(n.type,n.data,e);case"cpu-pinned":return new ld({location:"cpu-pinned",data:n.data,type:n.type,dims:e});case"texture":return new ld({location:"texture",texture:n.texture,type:n.type,dims:e});case"gpu-buffer":return new ld({location:"gpu-buffer",gpuBuffer:n.gpuBuffer,type:n.type,dims:e});case"ml-tensor":return new ld({location:"ml-tensor",mlTensor:n.mlTensor,type:n.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${n.location} is not supported`)}}}),ld,dU=pn(()=>{Nnt(),Dnt(),Ont(),Pnt(),ld=class{constructor(n,e,t){Hfe();let s,r;if(typeof n=="object"&&"location"in n)switch(this.dataLocation=n.location,s=n.type,r=n.dims,n.location){case"cpu-pinned":{let o=Uy.get(s);if(!o)throw new TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(n.data instanceof o))throw new TypeError(`buffer should be of type ${o.name}`);this.cpuData=n.data;break}case"texture":{if(s!=="float32")throw new TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=n.texture,this.downloader=n.download,this.disposer=n.dispose;break}case"gpu-buffer":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="uint8"&&s!=="bool"&&s!=="uint4"&&s!=="int4")throw new TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=n.gpuBuffer,this.downloader=n.download,this.disposer=n.dispose;break}case"ml-tensor":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="uint64"&&s!=="int8"&&s!=="uint8"&&s!=="bool"&&s!=="uint4"&&s!=="int4")throw new TypeError(`unsupported type "${s}" to create tensor from MLTensor`);this.mlTensorData=n.mlTensor,this.downloader=n.download,this.disposer=n.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,l;if(typeof n=="string")if(s=n,l=t,n==="string"){if(!Array.isArray(e))throw new TypeError("A string tensor's data must be a string array.");o=e}else{let c=Uy.get(n);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${n}.`);if(Array.isArray(e)){if(n==="float16"&&c===Uint16Array||n==="uint4"||n==="int4")throw new TypeError(`Creating a ${n} tensor from number array is not supported. Please use ${c.name} as data.`);n==="uint64"||n==="int64"?o=c.from(e,BigInt):o=c.from(e)}else if(e instanceof c)o=e;else if(e instanceof Uint8ClampedArray)if(n==="uint8")o=Uint8Array.from(e);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(n==="float16"&&e instanceof Uint16Array&&c!==Uint16Array)o=new globalThis.Float16Array(e.buffer,e.byteOffset,e.length);else throw new TypeError(`A ${s} tensor's data must be type of ${c}`)}else if(l=e,Array.isArray(n)){if(n.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let c=typeof n[0];if(c==="string")s="string",o=n;else if(c==="boolean")s="bool",o=Uint8Array.from(n);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else if(n instanceof Uint8ClampedArray)s="uint8",o=Uint8Array.from(n);else{let c=KS.get(n.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${n.constructor}.`);s=c,o=n}if(l===void 0)l=[o.length];else if(!Array.isArray(l))throw new TypeError("A tensor's dims must be a number array");r=l,this.cpuData=o,this.dataLocation="cpu"}let a=qfe(r);if(this.cpuData&&a!==this.cpuData.length&&!((s==="uint4"||s==="int4")&&Math.ceil(a/2)===this.cpuData.length))throw new Error(`Tensor's size(${a}) does not match data length(${this.cpuData.length}).`);this.type=s,this.dims=r,this.size=a}static async fromImage(n,e){return Bfe(n,e)}static fromTexture(n,e){return Ufe(n,e)}static fromGpuBuffer(n,e){return Vfe(n,e)}static fromMLTensor(n,e){return Wfe(n,e)}static fromPinnedBuffer(n,e,t){return Gfe(n,e,t)}toDataURL(n){return Ffe(this,n)}toImageData(n){return zfe(this,n)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(n){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let e=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=e,n&&this.disposer&&(this.disposer(),this.disposer=void 0),e}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(n){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Yfe(this,n)}}}),sp,Kfe=pn(()=>{dU(),sp=ld}),QM,F5,vp,hh,Xfe=pn(()=>{Rfe(),QM=(n,e)=>{(typeof nh.trace>"u"?!nh.wasm.trace:!nh.trace)||console.timeStamp(`${n}::ORT::${e}`)},F5=(n,e)=>{let t=new Error().stack?.split(/\r\n|\r|\n/g)||[],s=!1;for(let r=0;r<t.length;r++){if(s&&!t[r].includes("TRACE_FUNC")){let a=`FUNC_${n}::${t[r].trim().split(" ")[1]}`;e&&(a+=`::${e}`),QM("CPU",a);return}t[r].includes("TRACE_FUNC")&&(s=!0)}},vp=n=>{(typeof nh.trace>"u"?!nh.wasm.trace:!nh.trace)||F5("BEGIN",n)},hh=n=>{(typeof nh.trace>"u"?!nh.wasm.trace:!nh.trace)||F5("END",n)}}),Qfe,$nt=pn(()=>{$fe(),Kfe(),Xfe(),Qfe=class Jfe{constructor(e){this.handler=e}async run(e,t,s){vp();let r={},a={};if(typeof e!="object"||e===null||e instanceof sp||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if(typeof t=="object"){if(t===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof sp)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(t.length===0)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let u of t){if(typeof u!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(u)===-1)throw new RangeError(`'fetches' contains invalid output name: ${u}.`);r[u]=null}if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else{let u=!1,f=Object.getOwnPropertyNames(t);for(let d of this.outputNames)if(f.indexOf(d)!==-1){let h=t[d];(h===null||h instanceof sp)&&(u=!0,o=!1,r[d]=h)}if(u){if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else a=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let u of this.inputNames)if(typeof e[u]>"u")throw new Error(`input '${u}' is missing in 'feeds'.`);if(o)for(let u of this.outputNames)r[u]=null;let l=await this.handler.run(e,r,a),c={};for(let u in l)if(Object.hasOwnProperty.call(l,u)){let f=l[u];f instanceof sp?c[u]=f:c[u]=new sp(f.type,f.data,f.dims)}return hh(),c}async release(){return this.handler.dispose()}static async create(e,t,s,r){vp();let a,o={};if(typeof e=="string"){if(a=e,typeof t=="object"&&t!==null)o=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(a=e,typeof t=="object"&&t!==null)o=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){let f=e,d=0,h=e.byteLength;if(typeof t=="object"&&t!==null)o=t;else if(typeof t=="number"){if(d=t,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=f.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${f.byteLength}).`);if(h=e.byteLength-d,typeof s=="number"){if(h=s,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>f.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${f.byteLength-d}].`);if(typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(typeof s<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof t<"u")throw new TypeError("'options' must be an object.");a=new Uint8Array(f,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[l,c]=await Pfe(o),u=await l.createInferenceSessionHandler(a,c);return hh(),new Jfe(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),hU,jnt=pn(()=>{$nt(),hU=Qfe}),Rnt=pn(()=>{}),Fnt=pn(()=>{}),znt=pn(()=>{}),Bnt=pn(()=>{}),Zfe={};rx(Zfe,{InferenceSession:()=>hU,TRACE:()=>QM,TRACE_FUNC_BEGIN:()=>vp,TRACE_FUNC_END:()=>hh,Tensor:()=>sp,env:()=>pa,registerBackend:()=>Yy});var kp=pn(()=>{Int(),Lnt(),jnt(),Kfe(),Rnt(),Fnt(),Xfe(),znt(),Bnt()}),pU=pn(()=>{}),ede={};rx(ede,{default:()=>tde});var z5,B5,tde,Unt=pn(()=>{ame(),aw(),mU(),z5="ort-wasm-proxy-worker",B5=globalThis.self?.name===z5,B5&&(self.onmessage=n=>{let{type:e,in:t}=n.data;try{switch(e){case"init-wasm":gU(t.wasm).then(()=>{OU(t).then(()=>{postMessage({type:e})},s=>{postMessage({type:e,err:s})})},s=>{postMessage({type:e,err:s})});break;case"init-ep":{let{epName:s,env:r}=t;PU(r,s).then(()=>{postMessage({type:e})},a=>{postMessage({type:e,err:a})});break}case"copy-from":{let{buffer:s}=t,r=s4(s);postMessage({type:e,out:r});break}case"create":{let{model:s,options:r}=t;$U(s,r).then(a=>{postMessage({type:e,out:a})},a=>{postMessage({type:e,err:a})});break}case"release":jU(t),postMessage({type:e});break;case"run":{let{sessionId:s,inputIndices:r,inputs:a,outputIndices:o,options:l}=t;RU(s,r,a,o,new Array(o.length).fill(null),l).then(c=>{c.some(u=>u[3]!=="cpu")?postMessage({type:e,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:e,out:c},zU([...a,...c]))},c=>{postMessage({type:e,err:c})});break}case"end-profiling":FU(t),postMessage({type:e});break;default:}}catch(s){postMessage({type:e,err:s})}}),tde=B5?null:n=>new Worker(n??ad,{type:"module",name:z5})}),nde={};rx(nde,{default:()=>sde});var U5,V5,sde,Gq,Vnt=pn(()=>{V5=(U5=import.meta.url,async function(n={}){var e,t,s=n,r=new Promise((F,ee)=>{e=F,t=ee}),a=typeof window=="object",o=typeof WorkerGlobalScope<"u",l=o&&self.name?.startsWith("em-pthread");s.mountExternalData=(F,ee)=>{F.startsWith("./")&&(F=F.substring(2)),(s.Eb||(s.Eb=new Map)).set(F,ee)},s.unmountExternalData=()=>{delete s.Eb};var c=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let u=F=>async(...ee)=>{try{if(s.Fb)throw Error("Session already started");let he=s.Fb={dc:ee[0],errors:[]},be=await F(...ee);if(s.Fb!==he)throw Error("Session mismatch");s.Jb?.flush();let Le=he.errors;if(0<Le.length){let rt=await Promise.all(Le);if(rt=rt.filter($t=>$t),0<rt.length)throw Error(rt.join(`
`))}return be}finally{s.Fb=null}};s.jsepInit=(F,ee)=>{if(F==="webgpu"){[s.Jb,s.Ub,s.Yb,s.Kb,s.Xb,s.jb,s.Zb,s.ac,s.Vb,s.Wb,s.$b]=ee;let he=s.Jb;s.jsepRegisterBuffer=(be,Le,rt,$t)=>he.registerBuffer(be,Le,rt,$t),s.jsepGetBuffer=be=>he.getBuffer(be),s.jsepCreateDownloader=(be,Le,rt)=>he.createDownloader(be,Le,rt),s.jsepOnCreateSession=be=>{he.onCreateSession(be)},s.jsepOnReleaseSession=be=>{he.onReleaseSession(be)},s.jsepOnRunStart=be=>he.onRunStart(be),s.bc=(be,Le)=>{he.upload(be,Le)}}else if(F==="webnn"){let he=ee[0];[s.nc,s.Nb,s.webnnEnsureTensor,s.Ob,s.webnnDownloadTensor]=ee.slice(1),s.webnnReleaseTensorId=s.Nb,s.webnnUploadTensor=s.Ob,s.webnnOnRunStart=be=>he.onRunStart(be),s.webnnOnRunEnd=he.onRunEnd.bind(he),s.webnnRegisterMLContext=(be,Le)=>{he.registerMLContext(be,Le)},s.webnnOnReleaseSession=be=>{he.onReleaseSession(be)},s.webnnCreateMLTensorDownloader=(be,Le)=>he.createMLTensorDownloader(be,Le),s.webnnRegisterMLTensor=(be,Le,rt,$t)=>he.registerMLTensor(be,Le,rt,$t),s.webnnCreateMLContext=be=>he.createMLContext(be),s.webnnRegisterMLConstant=(be,Le,rt,$t,an,vn)=>he.registerMLConstant(be,Le,rt,$t,an,s.Eb,vn),s.webnnRegisterGraphInput=he.registerGraphInput.bind(he),s.webnnIsGraphInput=he.isGraphInput.bind(he),s.webnnCreateTemporaryTensor=he.createTemporaryTensor.bind(he),s.webnnIsInt64Supported=he.isInt64Supported.bind(he)}};let f=()=>{let F=(ee,he,be)=>(...Le)=>{let rt=Lr,$t=he?.();Le=ee(...Le);let an=he?.();return $t!==an&&(ee=an,be($t),he=be=null),Lr!=rt?new Promise((vn,Rn)=>{mi={resolve:vn,reject:Rn}}):Le};(()=>{for(let ee of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])s[ee]=F(s[ee],()=>s[ee],he=>s[ee]=he)})(),u!==void 0&&(s._OrtRun=u(s._OrtRun),s._OrtRunWithBinding=u(s._OrtRunWithBinding)),f=void 0};s.asyncInit=()=>{f?.()};var d,h,p=Object.assign({},s),g=(F,ee)=>{throw ee},b="";(a||o)&&(o?b=self.location.href:typeof document<"u"&&document.currentScript&&(b=document.currentScript.src),U5&&(b=U5),b=b.startsWith("blob:")?"":b.slice(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1),o&&(h=F=>{var ee=new XMLHttpRequest;return ee.open("GET",F,!1),ee.responseType="arraybuffer",ee.send(null),new Uint8Array(ee.response)}),d=async F=>{if(ne(F))return new Promise((he,be)=>{var Le=new XMLHttpRequest;Le.open("GET",F,!0),Le.responseType="arraybuffer",Le.onload=()=>{Le.status==200||Le.status==0&&Le.response?he(Le.response):be(Le.status)},Le.onerror=be,Le.send(null)});var ee=await fetch(F,{credentials:"same-origin"});if(ee.ok)return ee.arrayBuffer();throw Error(ee.status+" : "+ee.url)});var v=console.log.bind(console),w=console.error.bind(console),x=v,S=w;Object.assign(s,p),p=null;var C,M,k,E,I,A,D,L,P,j,G,Q,q,te=s.wasmBinary,Z=!1,ne=F=>F.startsWith("file://");function le(){return C.buffer!=E.buffer&&Me(),E}function H(){return C.buffer!=E.buffer&&Me(),I}function R(){return C.buffer!=E.buffer&&Me(),A}function B(){return C.buffer!=E.buffer&&Me(),D}function W(){return C.buffer!=E.buffer&&Me(),L}function se(){return C.buffer!=E.buffer&&Me(),P}function ue(){return C.buffer!=E.buffer&&Me(),j}function ge(){return C.buffer!=E.buffer&&Me(),q}if(l){let F=function(ee){try{var he=ee.data,be=he.Bb;if(be==="load"){let Le=[];self.onmessage=rt=>Le.push(rt),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let rt of Le)F(rt);self.onmessage=F};for(let rt of he.Rb)s[rt]&&!s[rt].proxy||(s[rt]=(...$t)=>{postMessage({Bb:"callHandler",Qb:rt,args:$t})},rt=="print"&&(x=s[rt]),rt=="printErr"&&(S=s[rt]));C=he.kc,Me(),Ce(he.lc)}else if(be==="run"){gr(he.Ab),ll(he.Ab,0,0,1,0,0),Vn(),Ue(he.Ab),Se||(Qc(),Se=!0);try{os(he.fc,he.Hb)}catch(Le){if(Le!="unwind")throw Le}}else he.target!=="setimmediate"&&(be==="checkMailbox"?Se&&Ve():be&&(S(`worker: received unknown command ${be}`),S(he)))}catch(Le){throw Ql(),Le}};var Ce,Se=!1;S=function(...ee){ee=ee.join(" "),console.error(ee)},self.alert=function(...ee){postMessage({Bb:"alert",text:ee.join(" "),ic:Jc()})},self.onunhandledrejection=ee=>{throw ee.reason||ee},self.onmessage=F}function Me(){var F=C.buffer;s.HEAP8=E=new Int8Array(F),s.HEAP16=A=new Int16Array(F),s.HEAPU8=I=new Uint8Array(F),s.HEAPU16=D=new Uint16Array(F),s.HEAP32=L=new Int32Array(F),s.HEAPU32=P=new Uint32Array(F),s.HEAPF32=j=new Float32Array(F),s.HEAPF64=q=new Float64Array(F),s.HEAP64=G=new BigInt64Array(F),s.HEAPU64=Q=new BigUint64Array(F)}function pe(){l?startWorker(s):Pn.Ca()}l||(C=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),Me());var fe,$e=0,We=null;function de(){if(--$e==0&&We){var F=We;We=null,F()}}function Be(F){throw S(F="Aborted("+F+")"),Z=!0,F=new WebAssembly.RuntimeError(F+". Build with -sASSERTIONS for more info."),t(F),F}function st(){return{a:{L:Ke,Aa:Xe,b:Ss,$:On,A:ai,pa:ir,X:ro,Z:re,qa:Pe,na:ve,ga:Oe,ma:ze,J:ut,Y:Et,V:rn,oa:xn,W:un,va:vs,E:sl,Q:Xr,O:Gc,D:bo,u:Wa,r:Us,P:Ga,z:Of,R:ft,ja:oe,T:Ct,aa:wn,M:bn,F:_n,ia:Ue,sa:mn,t:Ar,Ba:Ci,w:Ha,o:aa,l:Qs,c:wa,n:Oi,j:Hc,v:qc,p:ef,f:Nd,s:al,m:Yc,e:Ch,k:Kc,i:Sh,g:Y,d:me,da:Fe,ea:nn,fa:zn,ba:qn,ca:xs,N:gi,xa:Ki,ua:Ea,h:vc,C:ol,G:Xc,ta:Jr,x:Dd,ra:Pf,U:_c,q:pr,y:Hl,K:tf,S:xc,za:$f,ya:El,ka:Yl,la:zo,_:ht,B:Kl,I:Sc,ha:Od,H:Mc,a:C,wa:Gt}}}var He={829644:(F,ee,he,be,Le)=>{if(s===void 0||!s.Eb)return 1;if((F=Tn(Number(F>>>0))).startsWith("./")&&(F=F.substring(2)),!(F=s.Eb.get(F)))return 2;if(ee=Number(ee>>>0),he=Number(he>>>0),be=Number(be>>>0),ee+he>F.byteLength)return 3;try{let rt=F.subarray(ee,ee+he);switch(Le){case 0:H().set(rt,be>>>0);break;case 1:s.mc?s.mc(be,rt):s.bc(be,rt);break;default:return 4}return 0}catch{return 4}},830468:(F,ee,he)=>{s.Ob(F,H().subarray(ee>>>0,ee+he>>>0))},830532:()=>s.nc(),830574:F=>{s.Nb(F)},830611:()=>{s.Vb()},830642:()=>{s.Wb()},830671:()=>{s.$b()},830696:F=>s.Ub(F),830729:F=>s.Yb(F),830761:(F,ee,he)=>{s.Kb(Number(F),Number(ee),Number(he),!0)},830824:(F,ee,he)=>{s.Kb(Number(F),Number(ee),Number(he))},830881:()=>typeof wasmOffsetConverter<"u",830938:F=>{s.jb("Abs",F,void 0)},830989:F=>{s.jb("Neg",F,void 0)},831040:F=>{s.jb("Floor",F,void 0)},831093:F=>{s.jb("Ceil",F,void 0)},831145:F=>{s.jb("Reciprocal",F,void 0)},831203:F=>{s.jb("Sqrt",F,void 0)},831255:F=>{s.jb("Exp",F,void 0)},831306:F=>{s.jb("Erf",F,void 0)},831357:F=>{s.jb("Sigmoid",F,void 0)},831412:(F,ee,he)=>{s.jb("HardSigmoid",F,{alpha:ee,beta:he})},831491:F=>{s.jb("Log",F,void 0)},831542:F=>{s.jb("Sin",F,void 0)},831593:F=>{s.jb("Cos",F,void 0)},831644:F=>{s.jb("Tan",F,void 0)},831695:F=>{s.jb("Asin",F,void 0)},831747:F=>{s.jb("Acos",F,void 0)},831799:F=>{s.jb("Atan",F,void 0)},831851:F=>{s.jb("Sinh",F,void 0)},831903:F=>{s.jb("Cosh",F,void 0)},831955:F=>{s.jb("Asinh",F,void 0)},832008:F=>{s.jb("Acosh",F,void 0)},832061:F=>{s.jb("Atanh",F,void 0)},832114:F=>{s.jb("Tanh",F,void 0)},832166:F=>{s.jb("Not",F,void 0)},832217:(F,ee,he)=>{s.jb("Clip",F,{min:ee,max:he})},832286:F=>{s.jb("Clip",F,void 0)},832338:(F,ee)=>{s.jb("Elu",F,{alpha:ee})},832396:F=>{s.jb("Gelu",F,void 0)},832448:F=>{s.jb("Relu",F,void 0)},832500:(F,ee)=>{s.jb("LeakyRelu",F,{alpha:ee})},832564:(F,ee)=>{s.jb("ThresholdedRelu",F,{alpha:ee})},832634:(F,ee)=>{s.jb("Cast",F,{to:ee})},832692:F=>{s.jb("Add",F,void 0)},832743:F=>{s.jb("Sub",F,void 0)},832794:F=>{s.jb("Mul",F,void 0)},832845:F=>{s.jb("Div",F,void 0)},832896:F=>{s.jb("Pow",F,void 0)},832947:F=>{s.jb("Equal",F,void 0)},833e3:F=>{s.jb("Greater",F,void 0)},833055:F=>{s.jb("GreaterOrEqual",F,void 0)},833117:F=>{s.jb("Less",F,void 0)},833169:F=>{s.jb("LessOrEqual",F,void 0)},833228:(F,ee,he,be,Le)=>{s.jb("ReduceMean",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},833403:(F,ee,he,be,Le)=>{s.jb("ReduceMax",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},833577:(F,ee,he,be,Le)=>{s.jb("ReduceMin",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},833751:(F,ee,he,be,Le)=>{s.jb("ReduceProd",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},833926:(F,ee,he,be,Le)=>{s.jb("ReduceSum",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},834100:(F,ee,he,be,Le)=>{s.jb("ReduceL1",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},834273:(F,ee,he,be,Le)=>{s.jb("ReduceL2",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},834446:(F,ee,he,be,Le)=>{s.jb("ReduceLogSum",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},834623:(F,ee,he,be,Le)=>{s.jb("ReduceSumSquare",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},834803:(F,ee,he,be,Le)=>{s.jb("ReduceLogSumExp",F,{keepDims:!!ee,noopWithEmptyAxes:!!he,axes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},834983:F=>{s.jb("Where",F,void 0)},835036:(F,ee,he)=>{s.jb("Transpose",F,{perm:ee?Array.from(W().subarray(Number(ee)>>>0,Number(he)>>>0)):[]})},835160:(F,ee,he,be)=>{s.jb("DepthToSpace",F,{blocksize:ee,mode:Tn(he),format:be?"NHWC":"NCHW"})},835293:(F,ee,he,be)=>{s.jb("DepthToSpace",F,{blocksize:ee,mode:Tn(he),format:be?"NHWC":"NCHW"})},835426:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr,Lc)=>{s.jb("ConvTranspose",F,{format:vn?"NHWC":"NCHW",autoPad:ee,dilations:[he],group:be,kernelShape:[Le],pads:[rt,$t],strides:[an],wIsConst:()=>!!le()[Rn>>>0],outputPadding:Es?Array.from(W().subarray(Number(Es)>>>0,Number(Js)>>>0)):[],outputShape:sr?Array.from(W().subarray(Number(sr)>>>0,Number(zr)>>>0)):[],activation:Tn(Lc)})},835859:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr)=>{s.jb("ConvTranspose",F,{format:an?"NHWC":"NCHW",autoPad:ee,dilations:Array.from(W().subarray(Number(he)>>>0,2+(Number(he)>>>0)>>>0)),group:be,kernelShape:Array.from(W().subarray(Number(Le)>>>0,2+(Number(Le)>>>0)>>>0)),pads:Array.from(W().subarray(Number(rt)>>>0,4+(Number(rt)>>>0)>>>0)),strides:Array.from(W().subarray(Number($t)>>>0,2+(Number($t)>>>0)>>>0)),wIsConst:()=>!!le()[vn>>>0],outputPadding:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],outputShape:Js?Array.from(W().subarray(Number(Js)>>>0,Number(sr)>>>0)):[],activation:Tn(zr)})},836520:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr,Lc)=>{s.jb("ConvTranspose",F,{format:vn?"NHWC":"NCHW",autoPad:ee,dilations:[he],group:be,kernelShape:[Le],pads:[rt,$t],strides:[an],wIsConst:()=>!!le()[Rn>>>0],outputPadding:Es?Array.from(W().subarray(Number(Es)>>>0,Number(Js)>>>0)):[],outputShape:sr?Array.from(W().subarray(Number(sr)>>>0,Number(zr)>>>0)):[],activation:Tn(Lc)})},836953:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr)=>{s.jb("ConvTranspose",F,{format:an?"NHWC":"NCHW",autoPad:ee,dilations:Array.from(W().subarray(Number(he)>>>0,2+(Number(he)>>>0)>>>0)),group:be,kernelShape:Array.from(W().subarray(Number(Le)>>>0,2+(Number(Le)>>>0)>>>0)),pads:Array.from(W().subarray(Number(rt)>>>0,4+(Number(rt)>>>0)>>>0)),strides:Array.from(W().subarray(Number($t)>>>0,2+(Number($t)>>>0)>>>0)),wIsConst:()=>!!le()[vn>>>0],outputPadding:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],outputShape:Js?Array.from(W().subarray(Number(Js)>>>0,Number(sr)>>>0)):[],activation:Tn(zr)})},837614:(F,ee)=>{s.jb("GlobalAveragePool",F,{format:ee?"NHWC":"NCHW"})},837705:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr)=>{s.jb("AveragePool",F,{format:zr?"NHWC":"NCHW",auto_pad:ee,ceil_mode:he,count_include_pad:be,storage_order:Le,dilations:rt?Array.from(W().subarray(Number(rt)>>>0,Number($t)>>>0)):[],kernel_shape:an?Array.from(W().subarray(Number(an)>>>0,Number(vn)>>>0)):[],pads:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],strides:Js?Array.from(W().subarray(Number(Js)>>>0,Number(sr)>>>0)):[]})},838184:(F,ee)=>{s.jb("GlobalAveragePool",F,{format:ee?"NHWC":"NCHW"})},838275:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr)=>{s.jb("AveragePool",F,{format:zr?"NHWC":"NCHW",auto_pad:ee,ceil_mode:he,count_include_pad:be,storage_order:Le,dilations:rt?Array.from(W().subarray(Number(rt)>>>0,Number($t)>>>0)):[],kernel_shape:an?Array.from(W().subarray(Number(an)>>>0,Number(vn)>>>0)):[],pads:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],strides:Js?Array.from(W().subarray(Number(Js)>>>0,Number(sr)>>>0)):[]})},838754:(F,ee)=>{s.jb("GlobalMaxPool",F,{format:ee?"NHWC":"NCHW"})},838841:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr)=>{s.jb("MaxPool",F,{format:zr?"NHWC":"NCHW",auto_pad:ee,ceil_mode:he,count_include_pad:be,storage_order:Le,dilations:rt?Array.from(W().subarray(Number(rt)>>>0,Number($t)>>>0)):[],kernel_shape:an?Array.from(W().subarray(Number(an)>>>0,Number(vn)>>>0)):[],pads:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],strides:Js?Array.from(W().subarray(Number(Js)>>>0,Number(sr)>>>0)):[]})},839316:(F,ee)=>{s.jb("GlobalMaxPool",F,{format:ee?"NHWC":"NCHW"})},839403:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr)=>{s.jb("MaxPool",F,{format:zr?"NHWC":"NCHW",auto_pad:ee,ceil_mode:he,count_include_pad:be,storage_order:Le,dilations:rt?Array.from(W().subarray(Number(rt)>>>0,Number($t)>>>0)):[],kernel_shape:an?Array.from(W().subarray(Number(an)>>>0,Number(vn)>>>0)):[],pads:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],strides:Js?Array.from(W().subarray(Number(Js)>>>0,Number(sr)>>>0)):[]})},839878:(F,ee,he,be,Le)=>{s.jb("Gemm",F,{alpha:ee,beta:he,transA:be,transB:Le})},839982:F=>{s.jb("MatMul",F,void 0)},840036:(F,ee,he,be)=>{s.jb("ArgMax",F,{keepDims:!!ee,selectLastIndex:!!he,axis:be})},840144:(F,ee,he,be)=>{s.jb("ArgMin",F,{keepDims:!!ee,selectLastIndex:!!he,axis:be})},840252:(F,ee)=>{s.jb("Softmax",F,{axis:ee})},840315:(F,ee)=>{s.jb("Concat",F,{axis:ee})},840375:(F,ee,he,be,Le)=>{s.jb("Split",F,{axis:ee,numOutputs:he,splitSizes:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},840531:F=>{s.jb("Expand",F,void 0)},840585:(F,ee)=>{s.jb("Gather",F,{axis:Number(ee)})},840656:(F,ee)=>{s.jb("GatherElements",F,{axis:Number(ee)})},840735:(F,ee)=>{s.jb("GatherND",F,{batch_dims:Number(ee)})},840814:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es)=>{s.jb("Resize",F,{antialias:ee,axes:he?Array.from(W().subarray(Number(he)>>>0,Number(be)>>>0)):[],coordinateTransformMode:Tn(Le),cubicCoeffA:rt,excludeOutside:$t,extrapolationValue:an,keepAspectRatioPolicy:Tn(vn),mode:Tn(Rn),nearestMode:Tn(Es)})},841176:(F,ee,he,be,Le,rt,$t)=>{s.jb("Slice",F,{starts:ee?Array.from(W().subarray(Number(ee)>>>0,Number(he)>>>0)):[],ends:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[],axes:rt?Array.from(W().subarray(Number(rt)>>>0,Number($t)>>>0)):[]})},841440:F=>{s.jb("Tile",F,void 0)},841492:(F,ee,he)=>{s.jb("InstanceNormalization",F,{epsilon:ee,format:he?"NHWC":"NCHW"})},841606:(F,ee,he)=>{s.jb("InstanceNormalization",F,{epsilon:ee,format:he?"NHWC":"NCHW"})},841720:F=>{s.jb("Range",F,void 0)},841773:(F,ee)=>{s.jb("Einsum",F,{equation:Tn(ee)})},841854:(F,ee,he,be,Le)=>{s.jb("Pad",F,{mode:ee,value:he,pads:be?Array.from(W().subarray(Number(be)>>>0,Number(Le)>>>0)):[]})},841997:(F,ee,he,be,Le,rt)=>{s.jb("BatchNormalization",F,{epsilon:ee,momentum:he,spatial:!!Le,trainingMode:!!be,format:rt?"NHWC":"NCHW"})},842166:(F,ee,he,be,Le,rt)=>{s.jb("BatchNormalization",F,{epsilon:ee,momentum:he,spatial:!!Le,trainingMode:!!be,format:rt?"NHWC":"NCHW"})},842335:(F,ee,he)=>{s.jb("CumSum",F,{exclusive:Number(ee),reverse:Number(he)})},842432:(F,ee,he)=>{s.jb("DequantizeLinear",F,{axis:ee,blockSize:he})},842522:(F,ee,he,be,Le)=>{s.jb("GridSample",F,{align_corners:ee,mode:Tn(he),padding_mode:Tn(be),format:Le?"NHWC":"NCHW"})},842692:(F,ee,he,be,Le)=>{s.jb("GridSample",F,{align_corners:ee,mode:Tn(he),padding_mode:Tn(be),format:Le?"NHWC":"NCHW"})},842862:(F,ee)=>{s.jb("ScatterND",F,{reduction:Tn(ee)})},842947:(F,ee,he,be,Le,rt,$t,an,vn)=>{s.jb("Attention",F,{numHeads:ee,isUnidirectional:he,maskFilterValue:be,scale:Le,doRotary:rt,qkvHiddenSizes:$t?Array.from(W().subarray(Number(an)>>>0,Number(an)+$t>>>0)):[],pastPresentShareBuffer:!!vn})},843219:F=>{s.jb("BiasAdd",F,void 0)},843274:F=>{s.jb("BiasSplitGelu",F,void 0)},843335:F=>{s.jb("FastGelu",F,void 0)},843391:(F,ee,he,be,Le,rt,$t,an,vn,Rn,Es,Js,sr,zr,Lc,fl)=>{s.jb("Conv",F,{format:Js?"NHWC":"NCHW",auto_pad:ee,dilations:he?Array.from(W().subarray(Number(he)>>>0,Number(be)>>>0)):[],group:Le,kernel_shape:rt?Array.from(W().subarray(Number(rt)>>>0,Number($t)>>>0)):[],pads:an?Array.from(W().subarray(Number(an)>>>0,Number(vn)>>>0)):[],strides:Rn?Array.from(W().subarray(Number(Rn)>>>0,Number(Es)>>>0)):[],w_is_const:()=>!!le()[Number(sr)>>>0],activation:Tn(zr),activation_params:Lc?Array.from(ue().subarray(Number(Lc)>>>0,Number(fl)>>>0)):[]})},843975:F=>{s.jb("Gelu",F,void 0)},844027:(F,ee,he,be,Le,rt,$t,an,vn)=>{s.jb("GroupQueryAttention",F,{numHeads:ee,kvNumHeads:he,scale:be,softcap:Le,doRotary:rt,rotaryInterleaved:$t,smoothSoftmax:an,localWindowSize:vn})},844244:(F,ee,he,be)=>{s.jb("LayerNormalization",F,{axis:ee,epsilon:he,simplified:!!be})},844355:(F,ee,he,be)=>{s.jb("LayerNormalization",F,{axis:ee,epsilon:he,simplified:!!be})},844466:(F,ee,he,be,Le,rt)=>{s.jb("MatMulNBits",F,{k:ee,n:he,accuracyLevel:be,bits:Le,blockSize:rt})},844593:(F,ee,he,be,Le,rt)=>{s.jb("MultiHeadAttention",F,{numHeads:ee,isUnidirectional:he,maskFilterValue:be,scale:Le,doRotary:rt})},844752:(F,ee)=>{s.jb("QuickGelu",F,{alpha:ee})},844816:(F,ee,he,be,Le)=>{s.jb("RotaryEmbedding",F,{interleaved:!!ee,numHeads:he,rotaryEmbeddingDim:be,scale:Le})},844955:(F,ee,he)=>{s.jb("SkipLayerNormalization",F,{epsilon:ee,simplified:!!he})},845057:(F,ee,he)=>{s.jb("SkipLayerNormalization",F,{epsilon:ee,simplified:!!he})},845159:(F,ee,he,be)=>{s.jb("GatherBlockQuantized",F,{gatherAxis:ee,quantizeAxis:he,blockSize:be})},845280:F=>{s.Zb(F)},845314:(F,ee)=>s.ac(Number(F),Number(ee),s.Fb.dc,s.Fb.errors)};function Xe(F,ee,he){return io(async()=>{await s.Xb(Number(F),Number(ee),Number(he))})}function Ke(){return typeof wasmOffsetConverter<"u"}class Ze{name="ExitStatus";constructor(ee){this.message=`Program terminated with exit(${ee})`,this.status=ee}}var xt=F=>{F.terminate(),F.onmessage=()=>{}},dt=[],Ft=F=>{Qt.length==0&&(Dn(),Nn(Qt[0]));var ee=Qt.pop();if(!ee)return 6;Xt.push(ee),yn[F.Ab]=ee,ee.Ab=F.Ab;var he={Bb:"run",fc:F.ec,Hb:F.Hb,Ab:F.Ab};return ee.postMessage(he,F.Mb),0},It=0,Bt=(F,ee,...he)=>{for(var be=2*he.length,Le=_o(),rt=Ic(8*be),$t=rt>>>3,an=0;an<he.length;an++){var vn=he[an];typeof vn=="bigint"?(G[$t+2*an]=1n,G[$t+2*an+1]=vn):(G[$t+2*an]=0n,ge()[$t+2*an+1>>>0]=vn)}return F=La(F,0,be,rt,ee),cl(Le),F};function Gt(F){if(l)return Bt(0,1,F);if(k=F,!(0<It)){for(var ee of Xt)xt(ee);for(ee of Qt)xt(ee);Qt=[],Xt=[],yn={},Z=!0}g(0,new Ze(F))}function At(F){if(l)return Bt(1,0,F);ht(F)}var ht=F=>{if(k=F,l)throw At(F),"unwind";Gt(F)},Qt=[],Xt=[],us=[],yn={},En=F=>{var ee=F.Ab;delete yn[ee],Qt.push(F),Xt.splice(Xt.indexOf(F),1),F.Ab=0,Jl(ee)};function Vn(){us.forEach(F=>F())}var Nn=F=>new Promise(ee=>{F.onmessage=Le=>{var rt=(Le=Le.data).Bb;if(Le.Gb&&Le.Gb!=Jc()){var $t=yn[Le.Gb];$t?$t.postMessage(Le,Le.Mb):S(`Internal error! Worker sent a message "${rt}" to target pthread ${Le.Gb}, but that thread no longer exists!`)}else rt==="checkMailbox"?Ve():rt==="spawnThread"?Ft(Le):rt==="cleanupThread"?En(yn[Le.hc]):rt==="loaded"?(F.loaded=!0,ee(F)):rt==="alert"?alert(`Thread ${Le.ic}: ${Le.text}`):Le.target==="setimmediate"?F.postMessage(Le):rt==="callHandler"?s[Le.Qb](...Le.args):rt&&S(`worker sent an unknown command ${rt}`)},F.onerror=Le=>{throw S(`worker sent an error! ${Le.filename}:${Le.lineno}: ${Le.message}`),Le};var he,be=[];for(he of[])s.propertyIsEnumerable(he)&&be.push(he);F.postMessage({Bb:"load",Rb:be,kc:C,lc:M})});function Dn(){var F=new Worker((()=>{let ee=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new ee("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});Qt.push(F)}var gr=F=>{Me();var ee=se()[F+52>>>2>>>0];F=se()[F+56>>>2>>>0],Ec(ee,ee-F),cl(ee)},os=(F,ee)=>{It=0,F=Ac(F,ee),0<It?k=F:Eu(F)};class ps{constructor(ee){this.Ib=ee-24}}function Ss(F,ee,he){var be=new ps(F>>>=0);throw ee>>>=0,he>>>=0,se()[be.Ib+16>>>2>>>0]=0,se()[be.Ib+4>>>2>>>0]=ee,se()[be.Ib+8>>>2>>>0]=he,F}function Qn(F,ee,he,be){return l?Bt(2,1,F,ee,he,be):On(F,ee,he,be)}function On(F,ee,he,be){if(F>>>=0,he>>>=0,be>>>=0,c===void 0)return 6;var Le=[];return l&&Le.length===0?Qn(F,ee>>>=0,he,be):(F={ec:he,Ab:F,Hb:be,Mb:Le},l?(F.Bb="spawnThread",postMessage(F,Le),0):Ft(F))}var Mt=typeof TextDecoder<"u"?new TextDecoder:void 0,sn=(F,ee=0,he=NaN)=>{var be=(ee>>>=0)+he;for(he=ee;F[he]&&!(he>=be);)++he;if(16<he-ee&&F.buffer&&Mt)return Mt.decode(F.buffer instanceof ArrayBuffer?F.subarray(ee,he):F.slice(ee,he));for(be="";ee<he;){var Le=F[ee++];if(128&Le){var rt=63&F[ee++];if((224&Le)==192)be+=String.fromCharCode((31&Le)<<6|rt);else{var $t=63&F[ee++];65536>(Le=(240&Le)==224?(15&Le)<<12|rt<<6|$t:(7&Le)<<18|rt<<12|$t<<6|63&F[ee++])?be+=String.fromCharCode(Le):(Le-=65536,be+=String.fromCharCode(55296|Le>>10,56320|1023&Le))}}else be+=String.fromCharCode(Le)}return be},Tn=(F,ee)=>(F>>>=0)?sn(H(),F,ee):"";function ai(F,ee,he){return l?Bt(3,1,F,ee,he):0}function ir(F,ee){if(l)return Bt(4,1,F,ee)}var Fn=F=>{for(var ee=0,he=0;he<F.length;++he){var be=F.charCodeAt(he);127>=be?ee++:2047>=be?ee+=2:55296<=be&&57343>=be?(ee+=4,++he):ee+=3}return ee},fs=(F,ee,he)=>{var be=H();if(ee>>>=0,0<he){var Le=ee;he=ee+he-1;for(var rt=0;rt<F.length;++rt){var $t=F.charCodeAt(rt);if(55296<=$t&&57343>=$t&&($t=65536+((1023&$t)<<10)|1023&F.charCodeAt(++rt)),127>=$t){if(ee>=he)break;be[ee++>>>0]=$t}else{if(2047>=$t){if(ee+1>=he)break;be[ee++>>>0]=192|$t>>6}else{if(65535>=$t){if(ee+2>=he)break;be[ee++>>>0]=224|$t>>12}else{if(ee+3>=he)break;be[ee++>>>0]=240|$t>>18,be[ee++>>>0]=128|$t>>12&63}be[ee++>>>0]=128|$t>>6&63}be[ee++>>>0]=128|63&$t}}be[ee>>>0]=0,F=ee-Le}else F=0;return F};function ro(F,ee){if(l)return Bt(5,1,F,ee)}function re(F,ee,he){if(l)return Bt(6,1,F,ee,he)}function Pe(F,ee,he){return l?Bt(7,1,F,ee,he):0}function ve(F,ee){if(l)return Bt(8,1,F,ee)}function Oe(F,ee,he){if(l)return Bt(9,1,F,ee,he)}function ze(F,ee,he,be){if(l)return Bt(10,1,F,ee,he,be)}function ut(F,ee,he,be){if(l)return Bt(11,1,F,ee,he,be)}function Et(F,ee,he,be){if(l)return Bt(12,1,F,ee,he,be)}function rn(F){if(l)return Bt(13,1,F)}function xn(F,ee){if(l)return Bt(14,1,F,ee)}function un(F,ee,he){if(l)return Bt(15,1,F,ee,he)}var Gn,hn,vs=()=>Be(""),_s=F=>{for(var ee="";H()[F>>>0];)ee+=Gn[H()[F++>>>0]];return ee},Vr={},Yr={};function Cr(F,ee,he={}){return(function(be,Le,rt={}){var $t=Le.name;if(!be)throw new hn(`type "${$t}" must have a positive integer typeid pointer`);if(Yr.hasOwnProperty(be)){if(rt.Sb)return;throw new hn(`Cannot register type '${$t}' twice`)}Yr[be]=Le,Vr.hasOwnProperty(be)&&(Le=Vr[be],delete Vr[be],Le.forEach(an=>an()))})(F,ee,he)}var Kr=(F,ee,he)=>{switch(ee){case 1:return he?be=>le()[be>>>0]:be=>H()[be>>>0];case 2:return he?be=>R()[be>>>1>>>0]:be=>B()[be>>>1>>>0];case 4:return he?be=>W()[be>>>2>>>0]:be=>se()[be>>>2>>>0];case 8:return he?be=>G[be>>>3]:be=>Q[be>>>3];default:throw new TypeError(`invalid integer width (${ee}): ${F}`)}};function sl(F,ee,he){he>>>=0,Cr(F>>>=0,{name:ee=_s(ee>>>0),fromWireType:be=>be,toWireType:function(be,Le){if(typeof Le!="bigint"&&typeof Le!="number")throw Le=Le===null?"null":(be=typeof Le)=="object"||be==="array"||be==="function"?Le.toString():""+Le,new TypeError(`Cannot convert "${Le}" to ${this.name}`);return typeof Le=="number"&&(Le=BigInt(Le)),Le},Cb:Ni,readValueFromPointer:Kr(ee,he,ee.indexOf("u")==-1),Db:null})}var Ni=8;function Xr(F,ee,he,be){Cr(F>>>=0,{name:ee=_s(ee>>>0),fromWireType:function(Le){return!!Le},toWireType:function(Le,rt){return rt?he:be},Cb:Ni,readValueFromPointer:function(Le){return this.fromWireType(H()[Le>>>0])},Db:null})}var ka=[],oi=[];function wa(F){9<(F>>>=0)&&--oi[F+1]==0&&(oi[F]=void 0,ka.push(F))}var li=F=>{if(!F)throw new hn("Cannot use deleted val. handle = "+F);return oi[F]},pi=F=>{switch(F){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let ee=ka.pop()||oi.length;return oi[ee]=F,oi[ee+1]=1,ee}};function yo(F){return this.fromWireType(se()[F>>>2>>>0])}var rl={name:"emscripten::val",fromWireType:F=>{var ee=li(F);return wa(F),ee},toWireType:(F,ee)=>pi(ee),Cb:Ni,readValueFromPointer:yo,Db:null};function Gc(F){return Cr(F>>>0,rl)}var va=(F,ee)=>{switch(ee){case 4:return function(he){return this.fromWireType(ue()[he>>>2>>>0])};case 8:return function(he){return this.fromWireType(ge()[he>>>3>>>0])};default:throw new TypeError(`invalid float width (${ee}): ${F}`)}};function bo(F,ee,he){he>>>=0,Cr(F>>>=0,{name:ee=_s(ee>>>0),fromWireType:be=>be,toWireType:(be,Le)=>Le,Cb:Ni,readValueFromPointer:va(ee,he),Db:null})}function Wa(F,ee,he,be,Le){if(F>>>=0,he>>>=0,ee=_s(ee>>>0),Le===-1&&(Le=4294967295),Le=an=>an,be===0){var rt=32-8*he;Le=an=>an<<rt>>>rt}var $t=ee.includes("unsigned")?function(an,vn){return vn>>>0}:function(an,vn){return vn};Cr(F,{name:ee,fromWireType:Le,toWireType:$t,Cb:Ni,readValueFromPointer:Kr(ee,he,be!==0),Db:null})}function Us(F,ee,he){function be(rt){var $t=se()[rt>>>2>>>0];return rt=se()[rt+4>>>2>>>0],new Le(le().buffer,rt,$t)}var Le=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][ee];Cr(F>>>=0,{name:he=_s(he>>>0),fromWireType:be,Cb:Ni,readValueFromPointer:be},{Sb:!0})}function Ga(F,ee){Cr(F>>>=0,{name:ee=_s(ee>>>0),fromWireType:function(he){for(var be,Le=se()[he>>>2>>>0],rt=he+4,$t=rt,an=0;an<=Le;++an){var vn=rt+an;an!=Le&&H()[vn>>>0]!=0||($t=Tn($t,vn-$t),be===void 0?be=$t:(be+="\0",be+=$t),$t=vn+1)}return Dr(he),be},toWireType:function(he,be){be instanceof ArrayBuffer&&(be=new Uint8Array(be));var Le=typeof be=="string";if(!(Le||be instanceof Uint8Array||be instanceof Uint8ClampedArray||be instanceof Int8Array))throw new hn("Cannot pass non-string to std::string");var rt=Le?Fn(be):be.length,$t=nf(4+rt+1),an=$t+4;if(se()[$t>>>2>>>0]=rt,Le)fs(be,an,rt+1);else if(Le)for(Le=0;Le<rt;++Le){var vn=be.charCodeAt(Le);if(255<vn)throw Dr($t),new hn("String has UTF-16 code units that do not fit in 8 bits");H()[an+Le>>>0]=vn}else for(Le=0;Le<rt;++Le)H()[an+Le>>>0]=be[Le];return he!==null&&he.push(Dr,$t),$t},Cb:Ni,readValueFromPointer:yo,Db(he){Dr(he)}})}var Zt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,cn=(F,ee)=>{for(var he=F>>1,be=he+ee/2;!(he>=be)&&B()[he>>>0];)++he;if(32<(he<<=1)-F&&Zt)return Zt.decode(H().slice(F,he));for(he="",be=0;!(be>=ee/2);++be){var Le=R()[F+2*be>>>1>>>0];if(Le==0)break;he+=String.fromCharCode(Le)}return he},In=(F,ee,he)=>{if(he??=2147483647,2>he)return 0;var be=ee;he=(he-=2)<2*F.length?he/2:F.length;for(var Le=0;Le<he;++Le){var rt=F.charCodeAt(Le);R()[ee>>>1>>>0]=rt,ee+=2}return R()[ee>>>1>>>0]=0,ee-be},Rs=F=>2*F.length,xi=(F,ee)=>{for(var he=0,be="";!(he>=ee/4);){var Le=W()[F+4*he>>>2>>>0];if(Le==0)break;++he,65536<=Le?(Le-=65536,be+=String.fromCharCode(55296|Le>>10,56320|1023&Le)):be+=String.fromCharCode(Le)}return be},ci=(F,ee,he)=>{if(ee>>>=0,he??=2147483647,4>he)return 0;var be=ee;he=be+he-4;for(var Le=0;Le<F.length;++Le){var rt=F.charCodeAt(Le);if(55296<=rt&&57343>=rt&&(rt=65536+((1023&rt)<<10)|1023&F.charCodeAt(++Le)),W()[ee>>>2>>>0]=rt,(ee+=4)+4>he)break}return W()[ee>>>2>>>0]=0,ee-be},Gl=F=>{for(var ee=0,he=0;he<F.length;++he){var be=F.charCodeAt(he);55296<=be&&57343>=be&&++he,ee+=4}return ee};function Of(F,ee,he){if(F>>>=0,ee>>>=0,he=_s(he>>>=0),ee===2)var be=cn,Le=In,rt=Rs,$t=an=>B()[an>>>1>>>0];else ee===4&&(be=xi,Le=ci,rt=Gl,$t=an=>se()[an>>>2>>>0]);Cr(F,{name:he,fromWireType:an=>{for(var vn,Rn=se()[an>>>2>>>0],Es=an+4,Js=0;Js<=Rn;++Js){var sr=an+4+Js*ee;Js!=Rn&&$t(sr)!=0||(Es=be(Es,sr-Es),vn===void 0?vn=Es:(vn+="\0",vn+=Es),Es=sr+ee)}return Dr(an),vn},toWireType:(an,vn)=>{if(typeof vn!="string")throw new hn(`Cannot pass non-string to C++ string type ${he}`);var Rn=rt(vn),Es=nf(4+Rn+ee);return se()[Es>>>2>>>0]=Rn/ee,Le(vn,Es+4,Rn+ee),an!==null&&an.push(Dr,Es),Es},Cb:Ni,readValueFromPointer:yo,Db(an){Dr(an)}})}function ft(F,ee){Cr(F>>>=0,{Tb:!0,name:ee=_s(ee>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function oe(F){ll(F>>>0,!o,1,!a,131072,!1),Vn()}var Ne=F=>{if(!Z)try{if(F(),!(0<It))try{l?Eu(k):ht(k)}catch(ee){ee instanceof Ze||ee=="unwind"||g(0,ee)}}catch(ee){ee instanceof Ze||ee=="unwind"||g(0,ee)}};function Ue(F){F>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(W(),F>>>2,F).value.then(Ve),F+=128,Atomics.store(W(),F>>>2,1))}var Ve=()=>{var F=Jc();F&&(Ue(F),Ne(Zl))};function Ct(F,ee){(F>>>=0)==ee>>>0?setTimeout(Ve):l?postMessage({Gb:F,Bb:"checkMailbox"}):(F=yn[F])&&F.postMessage({Bb:"checkMailbox"})}var Rt=[];function wn(F,ee,he,be,Le){for(ee>>>=0,be/=2,Rt.length=be,he=Le>>>0>>>3,Le=0;Le<be;Le++)Rt[Le]=G[he+2*Le]?G[he+2*Le+1]:ge()[he+2*Le+1>>>0];return(ee?He[ee]:Tc[F])(...Rt)}var bn=()=>{It=0};function _n(F){F>>>=0,l?postMessage({Bb:"cleanupThread",hc:F}):En(yn[F])}function mn(F){}var ls=(F,ee)=>{var he=Yr[F];if(he===void 0)throw F=kc(F),he=_s(F),Dr(F),new hn(`${ee} has unknown type ${he}`);return he},ds=(F,ee,he)=>{var be=[];return F=F.toWireType(be,he),be.length&&(se()[ee>>>2>>>0]=pi(be)),F};function Ar(F,ee,he){return ee>>>=0,he>>>=0,F=li(F>>>0),ee=ls(ee,"emval::as"),ds(ee,he,F)}function Ci(F,ee){return ee>>>=0,F=li(F>>>0),(ee=ls(ee,"emval::as")).toWireType(null,F)}var Sr=F=>{try{F()}catch(ee){Be(ee)}},An=0,Lr=null,wo=0,Ml=[],Fr={},Si={},Qr=0,mi=null,Wr=[];function io(F){return(function(ee){if(!Z){if(An===0){var he=!1,be=!1;ee((Le=0)=>{if(!Z&&(wo=Le,he=!0,be)){An=2,Sr(()=>yr(Lr)),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),Le=!1;try{var rt=(function(){var vn=W()[Lr+8>>>2>>>0];return vn=Pn[Si[vn]],--It,vn()})()}catch(vn){rt=vn,Le=!0}var $t=!1;if(!Lr){var an=mi;an&&(mi=null,(Le?an.reject:an.resolve)(rt),$t=!0)}if(Le&&!$t)throw rt}}),be=!0,he||(An=1,Lr=(function(){var Le=nf(65548),rt=Le+12;se()[Le>>>2>>>0]=rt,se()[Le+4>>>2>>>0]=rt+65536,rt=Ml[0];var $t=Fr[rt];return $t===void 0&&($t=Qr++,Fr[rt]=$t,Si[$t]=rt),rt=$t,W()[Le+8>>>2>>>0]=rt,Le})(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),Sr(()=>Na(Lr)))}else An===2?(An=0,Sr(nr),Dr(Lr),Lr=null,Wr.forEach(Ne)):Be(`invalid state: ${An}`);return wo}})(ee=>{F().then(ee)})}function Ha(F){return F>>>=0,io(async()=>{var ee=await li(F);return pi(ee)})}var Yi=[];function aa(F,ee,he,be){return he>>>=0,be>>>=0,(F=Yi[F>>>0])(null,ee=li(ee>>>0),he,be)}var Di={},Gr=F=>{var ee=Di[F];return ee===void 0?_s(F):ee};function Qs(F,ee,he,be,Le){return he>>>=0,be>>>=0,Le>>>=0,(F=Yi[F>>>0])(ee=li(ee>>>0),ee[he=Gr(he)],be,Le)}var Nr=()=>typeof globalThis=="object"?globalThis:Function("return this")();function Oi(F){return(F>>>=0)==0?pi(Nr()):(F=Gr(F),pi(Nr()[F]))}var il=F=>{var ee=Yi.length;return Yi.push(F),ee},Tl=(F,ee)=>{for(var he=Array(F),be=0;be<F;++be)he[be]=ls(se()[ee+4*be>>>2>>>0],"parameter "+be);return he},Tu=(F,ee)=>Object.defineProperty(ee,"name",{value:F});function Hc(F,ee,he){var be=(ee=Tl(F,ee>>>0)).shift();F--;var Le=`return function (obj, func, destructorsRef, args) {
`,rt=0,$t=[];he===0&&$t.push("obj");for(var an=["retType"],vn=[be],Rn=0;Rn<F;++Rn)$t.push("arg"+Rn),an.push("argType"+Rn),vn.push(ee[Rn]),Le+=`  var arg${Rn} = argType${Rn}.readValueFromPointer(args${rt?"+"+rt:""});
`,rt+=ee[Rn].Cb;return Le+=`  var rv = ${he===1?"new func":"func.call"}(${$t.join(", ")});
`,be.Tb||(an.push("emval_returnValue"),vn.push(ds),Le+=`  return emval_returnValue(retType, destructorsRef, rv);
`),an.push(Le+`};
`),F=(function(Es){var Js=Function;if(!(Js instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof Js} which is not a function`);var sr=Tu(Js.name||"unknownFunctionName",function(){});return sr.prototype=Js.prototype,sr=new sr,(Es=Js.apply(sr,Es))instanceof Object?Es:sr})(an)(...vn),he=`methodCaller<(${ee.map(Es=>Es.name).join(", ")}) => ${be.name}>`,il(Tu(he,F))}function qc(F){return F=Gr(F>>>0),pi(s[F])}function ef(F,ee){return ee>>>=0,F=li(F>>>0),ee=li(ee),pi(F[ee])}function Nd(F){9<(F>>>=0)&&(oi[F+1]+=1)}function al(){return pi([])}function Yc(F){F=li(F>>>0);for(var ee=Array(F.length),he=0;he<F.length;he++)ee[he]=F[he];return pi(ee)}function Ch(F){return pi(Gr(F>>>0))}function Kc(){return pi({})}function Sh(F){for(var ee=li(F>>>=0);ee.length;){var he=ee.pop();ee.pop()(he)}wa(F)}function Y(F,ee,he){ee>>>=0,he>>>=0,F=li(F>>>0),ee=li(ee),he=li(he),F[ee]=he}function me(F,ee){return ee>>>=0,F=(F=ls(F>>>0,"_emval_take_value")).readValueFromPointer(ee),pi(F)}function Fe(F,ee){F=-9007199254740992>F||9007199254740992<F?NaN:Number(F),ee>>>=0,F=new Date(1e3*F),W()[ee>>>2>>>0]=F.getUTCSeconds(),W()[ee+4>>>2>>>0]=F.getUTCMinutes(),W()[ee+8>>>2>>>0]=F.getUTCHours(),W()[ee+12>>>2>>>0]=F.getUTCDate(),W()[ee+16>>>2>>>0]=F.getUTCMonth(),W()[ee+20>>>2>>>0]=F.getUTCFullYear()-1900,W()[ee+24>>>2>>>0]=F.getUTCDay(),F=(F.getTime()-Date.UTC(F.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,W()[ee+28>>>2>>>0]=F}var Je=F=>F%4==0&&(F%100!=0||F%400==0),pt=[0,31,60,91,121,152,182,213,244,274,305,335],Ht=[0,31,59,90,120,151,181,212,243,273,304,334];function nn(F,ee){F=-9007199254740992>F||9007199254740992<F?NaN:Number(F),ee>>>=0,F=new Date(1e3*F),W()[ee>>>2>>>0]=F.getSeconds(),W()[ee+4>>>2>>>0]=F.getMinutes(),W()[ee+8>>>2>>>0]=F.getHours(),W()[ee+12>>>2>>>0]=F.getDate(),W()[ee+16>>>2>>>0]=F.getMonth(),W()[ee+20>>>2>>>0]=F.getFullYear()-1900,W()[ee+24>>>2>>>0]=F.getDay();var he=(Je(F.getFullYear())?pt:Ht)[F.getMonth()]+F.getDate()-1|0;W()[ee+28>>>2>>>0]=he,W()[ee+36>>>2>>>0]=-60*F.getTimezoneOffset(),he=new Date(F.getFullYear(),6,1).getTimezoneOffset();var be=new Date(F.getFullYear(),0,1).getTimezoneOffset();F=0|(he!=be&&F.getTimezoneOffset()==Math.min(be,he)),W()[ee+32>>>2>>>0]=F}function zn(F){F>>>=0;var ee=new Date(W()[F+20>>>2>>>0]+1900,W()[F+16>>>2>>>0],W()[F+12>>>2>>>0],W()[F+8>>>2>>>0],W()[F+4>>>2>>>0],W()[F>>>2>>>0],0),he=W()[F+32>>>2>>>0],be=ee.getTimezoneOffset(),Le=new Date(ee.getFullYear(),6,1).getTimezoneOffset(),rt=new Date(ee.getFullYear(),0,1).getTimezoneOffset(),$t=Math.min(rt,Le);return 0>he?W()[F+32>>>2>>>0]=+(Le!=rt&&$t==be):0<he!=($t==be)&&(Le=Math.max(rt,Le),ee.setTime(ee.getTime()+6e4*((0<he?$t:Le)-be))),W()[F+24>>>2>>>0]=ee.getDay(),he=(Je(ee.getFullYear())?pt:Ht)[ee.getMonth()]+ee.getDate()-1|0,W()[F+28>>>2>>>0]=he,W()[F>>>2>>>0]=ee.getSeconds(),W()[F+4>>>2>>>0]=ee.getMinutes(),W()[F+8>>>2>>>0]=ee.getHours(),W()[F+12>>>2>>>0]=ee.getDate(),W()[F+16>>>2>>>0]=ee.getMonth(),W()[F+20>>>2>>>0]=ee.getYear(),F=ee.getTime(),BigInt(isNaN(F)?-1:F/1e3)}function qn(F,ee,he,be,Le,rt,$t){return l?Bt(16,1,F,ee,he,be,Le,rt,$t):-52}function xs(F,ee,he,be,Le,rt){if(l)return Bt(17,1,F,ee,he,be,Le,rt)}var ks={},pr=()=>performance.timeOrigin+performance.now();function gi(F,ee){if(l)return Bt(18,1,F,ee);if(ks[F]&&(clearTimeout(ks[F].id),delete ks[F]),!ee)return 0;var he=setTimeout(()=>{delete ks[F],Ne(()=>sf(F,performance.timeOrigin+performance.now()))},ee);return ks[F]={id:he,qc:ee},0}function Ki(F,ee,he,be){F>>>=0,ee>>>=0,he>>>=0,be>>>=0;var Le=new Date().getFullYear(),rt=new Date(Le,0,1).getTimezoneOffset();Le=new Date(Le,6,1).getTimezoneOffset();var $t=Math.max(rt,Le);se()[F>>>2>>>0]=60*$t,W()[ee>>>2>>>0]=+(rt!=Le),F=(ee=an=>{var vn=Math.abs(an);return`UTC${0<=an?"-":"+"}${String(Math.floor(vn/60)).padStart(2,"0")}${String(vn%60).padStart(2,"0")}`})(rt),ee=ee(Le),Le<rt?(fs(F,he,17),fs(ee,be,17)):(fs(F,be,17),fs(ee,he,17))}var Jr=()=>Date.now();function Ea(F,ee,he){return 0<=F&&3>=F?(F===0?F=Date.now():F=performance.timeOrigin+performance.now(),G[he>>>0>>>3]=BigInt(Math.round(1e6*F)),0):28}var zi=[],_a=(F,ee)=>{zi.length=0;for(var he;he=H()[F++>>>0];){var be=he!=105;ee+=(be&=he!=112)&&ee%8?4:0,zi.push(he==112?se()[ee>>>2>>>0]:he==106?G[ee>>>3]:he==105?W()[ee>>>2>>>0]:ge()[ee>>>3>>>0]),ee+=be?8:4}return zi};function vc(F,ee,he){return F>>>=0,ee=_a(ee>>>0,he>>>0),He[F](...ee)}function ol(F,ee,he){return F>>>=0,ee=_a(ee>>>0,he>>>0),He[F](...ee)}var Xc=()=>{};function Dd(F,ee){return S(Tn(F>>>0,ee>>>0))}var Pf=()=>{throw It+=1,"unwind"};function _c(){return 4294901760}var Hl=()=>navigator.hardwareConcurrency;function tf(){return Be("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function xc(F){F>>>=0;var ee=H().length;if(F<=ee||4294901760<F)return!1;for(var he=1;4>=he;he*=2){var be=ee*(1+.2/he);be=Math.min(be,F+100663296);e:{be=(Math.min(4294901760,65536*Math.ceil(Math.max(F,be)/65536))-C.buffer.byteLength+65535)/65536|0;try{C.grow(be),Me();var Le=1;break e}catch{}Le=void 0}if(Le)return!0}return!1}var Xi=()=>(Be("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),kl={},Cc=F=>{F.forEach(ee=>{Xi()})};function $f(){var F=Error().stack.toString().split(`
`);return F[0]=="Error"&&F.shift(),Cc(F),kl.Lb=Xi(),kl.cc=F,kl.Lb}function El(F,ee,he){if(F>>>=0,ee>>>=0,kl.Lb==F)var be=kl.cc;else(be=Error().stack.toString().split(`
`))[0]=="Error"&&be.shift(),Cc(be);for(var Le=3;be[Le]&&Xi()!=F;)++Le;for(F=0;F<he&&be[F+Le];++F)W()[ee+4*F>>>2>>>0]=Xi();return F}var Ia,ql={},ku=()=>{if(!Ia){var F,ee={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(F in ql)ql[F]===void 0?delete ee[F]:ee[F]=ql[F];var he=[];for(F in ee)he.push(`${F}=${ee[F]}`);Ia=he}return Ia};function Yl(F,ee){if(l)return Bt(19,1,F,ee);F>>>=0,ee>>>=0;var he=0;return ku().forEach((be,Le)=>{var rt=ee+he;for(Le=se()[F+4*Le>>>2>>>0]=rt,rt=0;rt<be.length;++rt)le()[Le++>>>0]=be.charCodeAt(rt);le()[Le>>>0]=0,he+=be.length+1}),0}function zo(F,ee){if(l)return Bt(20,1,F,ee);F>>>=0,ee>>>=0;var he=ku();se()[F>>>2>>>0]=he.length;var be=0;return he.forEach(Le=>be+=Le.length+1),se()[ee>>>2>>>0]=be,0}function Kl(F){return l?Bt(21,1,F):52}function Sc(F,ee,he,be){return l?Bt(22,1,F,ee,he,be):52}function Od(F,ee,he,be){return l?Bt(23,1,F,ee,he,be):70}var Xl=[null,[],[]];function Mc(F,ee,he,be){if(l)return Bt(24,1,F,ee,he,be);ee>>>=0,he>>>=0,be>>>=0;for(var Le=0,rt=0;rt<he;rt++){var $t=se()[ee>>>2>>>0],an=se()[ee+4>>>2>>>0];ee+=8;for(var vn=0;vn<an;vn++){var Rn=H()[$t+vn>>>0],Es=Xl[F];Rn===0||Rn===10?((F===1?x:S)(sn(Es)),Es.length=0):Es.push(Rn)}Le+=an}return se()[be>>>2>>>0]=Le,0}l||(function(){for(var F=s.numThreads-1;F--;)Dn();dt.unshift(()=>{$e++,(function(ee){l?ee():Promise.all(Qt.map(Nn)).then(ee)})(()=>de())})})();for(var vo=Array(256),Aa=0;256>Aa;++Aa)vo[Aa]=String.fromCharCode(Aa);Gn=vo,hn=s.BindingError=class extends Error{constructor(F){super(F),this.name="BindingError"}},s.InternalError=class extends Error{constructor(F){super(F),this.name="InternalError"}},oi.push(0,1,void 0,1,null,1,!0,1,!1,1),s.count_emval_handles=()=>oi.length/2-5-ka.length;var Pn,Tc=[Gt,At,Qn,ai,ir,ro,re,Pe,ve,Oe,ze,ut,Et,rn,xn,un,qn,xs,gi,Yl,zo,Kl,Sc,Od,Mc];(async function(){function F(be,Le){return Pn=be.exports,Pn=(function(){var rt=Pn,$t={};for(let[an,vn]of Object.entries(rt))$t[an]=typeof vn=="function"?(...Rn)=>{Ml.push(an);try{return vn(...Rn)}finally{Z||(Ml.pop(),Lr&&An===1&&Ml.length===0&&(An=0,It+=1,Sr(ul),typeof Fibers<"u"&&Fibers.rc()))}}:vn;return $t})(),Pn=(function(){var rt=Pn,$t=vn=>Rn=>vn(Rn)>>>0,an=vn=>()=>vn()>>>0;return(rt=Object.assign({},rt)).Da=$t(rt.Da),rt.fb=an(rt.fb),rt.hb=$t(rt.hb),rt.tb=$t(rt.tb),rt.ub=an(rt.ub),rt.__cxa_get_exception_ptr=$t(rt.__cxa_get_exception_ptr),rt})(),us.push(Pn.ib),M=Le,de(),Pn}$e++;var ee=st();if(s.instantiateWasm)return new Promise(be=>{s.instantiateWasm(ee,(Le,rt)=>{F(Le,rt),be(Le.exports)})});if(l)return new Promise(be=>{Ce=Le=>{var rt=new WebAssembly.Instance(Le,st());be(F(rt,Le))}});fe??=s.locateFile?s.locateFile?s.locateFile("ort-wasm-simd-threaded.jsep.wasm",b):b+"ort-wasm-simd-threaded.jsep.wasm":new URL(""+new URL("ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href,import.meta.url).href;try{var he=await(async function(be){var Le=fe;if(!te&&typeof WebAssembly.instantiateStreaming=="function"&&!ne(Le))try{var rt=fetch(Le,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(rt,be)}catch($t){S(`wasm streaming compile failed: ${$t}`),S("falling back to ArrayBuffer instantiation")}return(async function($t,an){try{var vn=await(async function(Rn){if(!te)try{var Es=await d(Rn);return new Uint8Array(Es)}catch{}if(Rn==fe&&te)Rn=new Uint8Array(te);else{if(!h)throw"both async and sync fetching of the wasm failed";Rn=h(Rn)}return Rn})($t);return await WebAssembly.instantiate(vn,an)}catch(Rn){S(`failed to asynchronously prepare wasm: ${Rn}`),Be(Rn)}})(Le,be)})(ee);return F(he.instance,he.module)}catch(be){return t(be),Promise.reject(be)}})();var kc=F=>(kc=Pn.Da)(F),Qc=()=>(Qc=Pn.Ea)();s._OrtInit=(F,ee)=>(s._OrtInit=Pn.Fa)(F,ee),s._OrtGetLastError=(F,ee)=>(s._OrtGetLastError=Pn.Ga)(F,ee),s._OrtCreateSessionOptions=(F,ee,he,be,Le,rt,$t,an,vn,Rn)=>(s._OrtCreateSessionOptions=Pn.Ha)(F,ee,he,be,Le,rt,$t,an,vn,Rn),s._OrtAppendExecutionProvider=(F,ee,he,be,Le)=>(s._OrtAppendExecutionProvider=Pn.Ia)(F,ee,he,be,Le),s._OrtAddFreeDimensionOverride=(F,ee,he)=>(s._OrtAddFreeDimensionOverride=Pn.Ja)(F,ee,he),s._OrtAddSessionConfigEntry=(F,ee,he)=>(s._OrtAddSessionConfigEntry=Pn.Ka)(F,ee,he),s._OrtReleaseSessionOptions=F=>(s._OrtReleaseSessionOptions=Pn.La)(F),s._OrtCreateSession=(F,ee,he)=>(s._OrtCreateSession=Pn.Ma)(F,ee,he),s._OrtReleaseSession=F=>(s._OrtReleaseSession=Pn.Na)(F),s._OrtGetInputOutputCount=(F,ee,he)=>(s._OrtGetInputOutputCount=Pn.Oa)(F,ee,he),s._OrtGetInputOutputMetadata=(F,ee,he,be)=>(s._OrtGetInputOutputMetadata=Pn.Pa)(F,ee,he,be),s._OrtFree=F=>(s._OrtFree=Pn.Qa)(F),s._OrtCreateTensor=(F,ee,he,be,Le,rt)=>(s._OrtCreateTensor=Pn.Ra)(F,ee,he,be,Le,rt),s._OrtGetTensorData=(F,ee,he,be,Le)=>(s._OrtGetTensorData=Pn.Sa)(F,ee,he,be,Le),s._OrtReleaseTensor=F=>(s._OrtReleaseTensor=Pn.Ta)(F),s._OrtCreateRunOptions=(F,ee,he,be)=>(s._OrtCreateRunOptions=Pn.Ua)(F,ee,he,be),s._OrtAddRunConfigEntry=(F,ee,he)=>(s._OrtAddRunConfigEntry=Pn.Va)(F,ee,he),s._OrtReleaseRunOptions=F=>(s._OrtReleaseRunOptions=Pn.Wa)(F),s._OrtCreateBinding=F=>(s._OrtCreateBinding=Pn.Xa)(F),s._OrtBindInput=(F,ee,he)=>(s._OrtBindInput=Pn.Ya)(F,ee,he),s._OrtBindOutput=(F,ee,he,be)=>(s._OrtBindOutput=Pn.Za)(F,ee,he,be),s._OrtClearBoundOutputs=F=>(s._OrtClearBoundOutputs=Pn._a)(F),s._OrtReleaseBinding=F=>(s._OrtReleaseBinding=Pn.$a)(F),s._OrtRunWithBinding=(F,ee,he,be,Le)=>(s._OrtRunWithBinding=Pn.ab)(F,ee,he,be,Le),s._OrtRun=(F,ee,he,be,Le,rt,$t,an)=>(s._OrtRun=Pn.bb)(F,ee,he,be,Le,rt,$t,an),s._OrtEndProfiling=F=>(s._OrtEndProfiling=Pn.cb)(F),s._JsepOutput=(F,ee,he)=>(s._JsepOutput=Pn.db)(F,ee,he),s._JsepGetNodeName=F=>(s._JsepGetNodeName=Pn.eb)(F);var Jc=()=>(Jc=Pn.fb)(),Dr=s._free=F=>(Dr=s._free=Pn.gb)(F),nf=s._malloc=F=>(nf=s._malloc=Pn.hb)(F),ll=(F,ee,he,be,Le,rt)=>(ll=Pn.kb)(F,ee,he,be,Le,rt),Ql=()=>(Ql=Pn.lb)(),La=(F,ee,he,be,Le)=>(La=Pn.mb)(F,ee,he,be,Le),Jl=F=>(Jl=Pn.nb)(F),Eu=F=>(Eu=Pn.ob)(F),sf=(F,ee)=>(sf=Pn.pb)(F,ee),Zl=()=>(Zl=Pn.qb)(),Ec=(F,ee)=>(Ec=Pn.rb)(F,ee),cl=F=>(cl=Pn.sb)(F),Ic=F=>(Ic=Pn.tb)(F),_o=()=>(_o=Pn.ub)(),Ac=s.dynCall_ii=(F,ee)=>(Ac=s.dynCall_ii=Pn.vb)(F,ee),Na=F=>(Na=Pn.wb)(F),ul=()=>(ul=Pn.xb)(),yr=F=>(yr=Pn.yb)(F),nr=()=>(nr=Pn.zb)();return s.stackSave=()=>_o(),s.stackRestore=F=>cl(F),s.stackAlloc=F=>Ic(F),s.setValue=function(F,ee,he="i8"){switch(he.endsWith("*")&&(he="*"),he){case"i1":case"i8":le()[F>>>0]=ee;break;case"i16":R()[F>>>1>>>0]=ee;break;case"i32":W()[F>>>2>>>0]=ee;break;case"i64":G[F>>>3]=BigInt(ee);break;case"float":ue()[F>>>2>>>0]=ee;break;case"double":ge()[F>>>3>>>0]=ee;break;case"*":se()[F>>>2>>>0]=ee;break;default:Be(`invalid type for setValue: ${he}`)}},s.getValue=function(F,ee="i8"){switch(ee.endsWith("*")&&(ee="*"),ee){case"i1":case"i8":return le()[F>>>0];case"i16":return R()[F>>>1>>>0];case"i32":return W()[F>>>2>>>0];case"i64":return G[F>>>3];case"float":return ue()[F>>>2>>>0];case"double":return ge()[F>>>3>>>0];case"*":return se()[F>>>2>>>0];default:Be(`invalid type for getValue: ${ee}`)}},s.UTF8ToString=Tn,s.stringToUTF8=fs,s.lengthBytesUTF8=Fn,(function F(){if(0<$e)We=F;else if(l)e(s),pe();else{for(;0<dt.length;)dt.shift()(s);0<$e?We=F:(s.calledRun=!0,Z||(pe(),e(s)))}})(),s.PTR_SIZE=4,r}),sde=V5,Gq=globalThis.self?.name?.startsWith("em-pthread"),Gq&&V5()}),W5,_6,Hq,ad,rde,WI,qq,Yq,G5,Kq,H5,ide,q5,ade,mU=pn(()=>{pU(),W5=typeof location>"u"?void 0:location.origin,_6=import.meta.url>"file:"&&import.meta.url<"file;",Hq=()=>{{if(_6){let n=URL;return new URL(new n("ort.bundle.min.mjs",import.meta.url).href,W5).href}return import.meta.url}},ad=Hq(),rde=()=>{if(ad&&!ad.startsWith("blob:"))return ad.substring(0,ad.lastIndexOf("/")+1)},WI=(n,e)=>{try{let t=e??ad;return(t?new URL(n,t):new URL(n)).origin===W5}catch{return!1}},qq=(n,e)=>{let t=e??ad;try{return(t?new URL(n,t):new URL(n)).href}catch{return}},Yq=(n,e)=>`${e??"./"}${n}`,G5=async n=>{let e=await(await fetch(n,{credentials:"same-origin"})).blob();return URL.createObjectURL(e)},Kq=async n=>(await import(n)).default,H5=(Unt(),XM(ede)).default,ide=async()=>{if(!ad)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(WI(ad))return[void 0,H5()];let n=await G5(ad);return[n,H5(n)]},q5=(Vnt(),XM(nde)).default,ade=async(n,e,t)=>{if(!n&&!e&&q5&&ad&&WI(ad))return[void 0,q5];{let s="ort-wasm-simd-threaded.jsep.mjs",r=n??qq(s,e),a=t&&r&&!WI(r,e),o=a?await G5(r):r??Yq(s,e);return[a?o:void 0,await Kq(o)]}}}),Y5,GI,JC,K5,Xq,Qq,Jq,gU,ra,aw=pn(()=>{mU(),GI=!1,JC=!1,K5=!1,Xq=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Qq=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Jq=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},gU=async n=>{if(GI)return Promise.resolve();if(JC)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(K5)throw new Error("previous call to 'initializeWebAssembly()' failed.");JC=!0;let e=n.initTimeout,t=n.numThreads;if(n.simd!==!1){if(n.simd==="relaxed"){if(!Jq())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!Qq())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let s=Xq();t>1&&!s&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+t+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),n.numThreads=t=1);let r=n.wasmPaths,a=typeof r=="string"?r:void 0,o=r?.mjs,l=o?.href??o,c=r?.wasm,u=c?.href??c,f=n.wasmBinary,[d,h]=await ade(l,a,t>1),p=!1,g=[];if(e>0&&g.push(new Promise(b=>{setTimeout(()=>{p=!0,b()},e)})),g.push(new Promise((b,v)=>{let w={numThreads:t};if(f)w.wasmBinary=f;else if(u||a)w.locateFile=x=>u??a+x;else if(l&&l.indexOf("blob:")!==0)w.locateFile=x=>new URL(x,l).href;else if(d){let x=rde();x&&(w.locateFile=S=>x+S)}h(w).then(x=>{JC=!1,GI=!0,Y5=x,b(),d&&URL.revokeObjectURL(d)},x=>{JC=!1,K5=!0,v(x)})})),await Promise.race(g),p)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)},ra=()=>{if(GI&&Y5)return Y5;throw new Error("WebAssembly is not initialized yet.")}}),ep,QN,Ai,yU=pn(()=>{aw(),ep=(n,e)=>{let t=ra(),s=t.lengthBytesUTF8(n)+1,r=t._malloc(s);return t.stringToUTF8(n,r,s),e.push(r),r},QN=(n,e,t,s)=>{if(typeof n=="object"&&n!==null){if(t.has(n))throw new Error("Circular reference in options");t.add(n)}Object.entries(n).forEach(([r,a])=>{let o=e?e+r:r;if(typeof a=="object")QN(a,o+".",t,s);else if(typeof a=="string"||typeof a=="number")s(o,a.toString());else if(typeof a=="boolean")s(o,a?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof a}`)})},Ai=n=>{let e=ra(),t=e.stackSave();try{let s=e.PTR_SIZE,r=e.stackAlloc(2*s);e._OrtGetLastError(r,r+s);let a=Number(e.getValue(r,s===4?"i32":"i64")),o=e.getValue(r+s,"*"),l=o?e.UTF8ToString(o):"";throw new Error(`${n} ERROR_CODE: ${a}, ERROR_MESSAGE: ${l}`)}finally{e.stackRestore(t)}}}),ode,Wnt=pn(()=>{aw(),yU(),ode=n=>{let e=ra(),t=0,s=[],r=n||{};try{if(n?.logSeverityLevel===void 0)r.logSeverityLevel=2;else if(typeof n.logSeverityLevel!="number"||!Number.isInteger(n.logSeverityLevel)||n.logSeverityLevel<0||n.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${n.logSeverityLevel}`);if(n?.logVerbosityLevel===void 0)r.logVerbosityLevel=0;else if(typeof n.logVerbosityLevel!="number"||!Number.isInteger(n.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${n.logVerbosityLevel}`);n?.terminate===void 0&&(r.terminate=!1);let a=0;return n?.tag!==void 0&&(a=ep(n.tag,s)),t=e._OrtCreateRunOptions(r.logSeverityLevel,r.logVerbosityLevel,!!r.terminate,a),t===0&&Ai("Can't create run options."),n?.extra!==void 0&&QN(n.extra,"",new WeakSet,(o,l)=>{let c=ep(o,s),u=ep(l,s);e._OrtAddRunConfigEntry(t,c,u)!==0&&Ai(`Can't set a run config entry: ${o} - ${l}.`)}),[t,s]}catch(a){throw t!==0&&e._OrtReleaseRunOptions(t),s.forEach(o=>e._free(o)),a}}}),Zq,eY,tY,ZC,nY,lde,Gnt=pn(()=>{aw(),yU(),Zq=n=>{switch(n){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${n}`)}},eY=n=>{switch(n){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${n}`)}},tY=n=>{n.extra||(n.extra={}),n.extra.session||(n.extra.session={});let e=n.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1"),n.executionProviders&&n.executionProviders.some(t=>(typeof t=="string"?t:t.name)==="webgpu")&&(n.enableMemPattern=!1)},ZC=(n,e,t,s)=>{let r=ep(e,s),a=ep(t,s);ra()._OrtAddSessionConfigEntry(n,r,a)!==0&&Ai(`Can't set a session config entry: ${e} - ${t}.`)},nY=async(n,e,t)=>{for(let s of e){let r=typeof s=="string"?s:s.name,a=[];switch(r){case"webnn":if(r="WEBNN",typeof s!="string"){let f=s?.deviceType;f&&ZC(n,"deviceType",f,t)}break;case"webgpu":if(r="JS",typeof s!="string"){let f=s;if(f?.preferredLayout){if(f.preferredLayout!=="NCHW"&&f.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${f.preferredLayout}`);ZC(n,"preferredLayout",f.preferredLayout,t)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${r}`)}let o=ep(r,t),l=a.length,c=0,u=0;if(l>0){c=ra()._malloc(l*ra().PTR_SIZE),t.push(c),u=ra()._malloc(l*ra().PTR_SIZE),t.push(u);for(let f=0;f<l;f++)ra().setValue(c+f*ra().PTR_SIZE,a[f][0],"*"),ra().setValue(u+f*ra().PTR_SIZE,a[f][1],"*")}await ra()._OrtAppendExecutionProvider(n,o,c,u,l)!==0&&Ai(`Can't append execution provider: ${r}.`)}},lde=async n=>{let e=ra(),t=0,s=[],r=n||{};tY(r);try{let a=Zq(r.graphOptimizationLevel??"all"),o=eY(r.executionMode??"sequential"),l=typeof r.logId=="string"?ep(r.logId,s):0,c=r.logSeverityLevel??2;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log serverity level is not valid: ${c}`);let u=r.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let f=typeof r.optimizedModelFilePath=="string"?ep(r.optimizedModelFilePath,s):0;if(t=e._OrtCreateSessionOptions(a,!!r.enableCpuMemArena,!!r.enableMemPattern,o,!!r.enableProfiling,0,l,c,u,f),t===0&&Ai("Can't create session options."),r.executionProviders&&await nY(t,r.executionProviders,s),r.enableGraphCapture!==void 0){if(typeof r.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${r.enableGraphCapture}`);ZC(t,"enableGraphCapture",r.enableGraphCapture.toString(),s)}if(r.freeDimensionOverrides)for(let[d,h]of Object.entries(r.freeDimensionOverrides)){if(typeof d!="string")throw new Error(`free dimension override name must be a string: ${d}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let p=ep(d,s);e._OrtAddFreeDimensionOverride(t,p,h)!==0&&Ai(`Can't set a free dimension override: ${d} - ${h}.`)}return r.extra!==void 0&&QN(r.extra,"",new WeakSet,(d,h)=>{ZC(t,d,h,s)}),[t,s]}catch(a){throw t!==0&&e._OrtReleaseSessionOptions(t)!==0&&Ai("Can't release session options."),s.forEach(o=>e._free(o)),a}}}),Lv,Tg,Vy,bU,JN,wU,vU,x6,Ns=pn(()=>{Lv=n=>{switch(n){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${n}`)}},Tg=n=>{switch(n){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${n}`)}},Vy=(n,e)=>{let t=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][n],s=typeof e=="number"?e:e.reduce((r,a)=>r*a,1);return t>0?Math.ceil(s*t):void 0},bU=n=>{switch(n){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${n}`)}},JN=n=>{switch(n){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${n}`)}},wU=n=>n==="float32"||n==="float16"||n==="int32"||n==="int64"||n==="uint32"||n==="uint8"||n==="bool"||n==="uint4"||n==="int4",vU=n=>n==="float32"||n==="float16"||n==="int32"||n==="int64"||n==="uint32"||n==="uint64"||n==="int8"||n==="uint8"||n==="bool"||n==="uint4"||n==="int4",x6=n=>{switch(n){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${n}`)}}}),_U,cde=pn(()=>{pU(),_U=async n=>{if(typeof n=="string"){let e=await fetch(n);if(!e.ok)throw new Error(`failed to load external data file: ${n}`);let t=e.headers.get("Content-Length"),s=t?parseInt(t,10):0;if(s<1073741824)return new Uint8Array(await e.arrayBuffer());{if(!e.body)throw new Error(`failed to load external data file: ${n}, no response body.`);let r=e.body.getReader(),a;try{a=new ArrayBuffer(s)}catch(l){if(l instanceof RangeError){let c=Math.ceil(s/65536);a=new WebAssembly.Memory({initial:c,maximum:c}).buffer}else throw l}let o=0;for(;;){let{done:l,value:c}=await r.read();if(l)break;let u=c.byteLength;new Uint8Array(a,o,u).set(c),o+=u}return new Uint8Array(a,0,s)}}else return n instanceof Blob?new Uint8Array(await n.arrayBuffer()):n instanceof Uint8Array?n:new Uint8Array(n)}}),sY,rY,iY,aY,xU,oY,$r,Jg=pn(()=>{Ns(),sY=["V","I","W","E","F"],rY=(n,e)=>{console.log(`[${sY[n]},${new Date().toISOString()}]${e}`)},xU=(n,e)=>{iY=n,aY=e},oY=(n,e)=>{let t=JN(n),s=JN(iY);t>=s&&rY(t,typeof e=="function"?e():e)},$r=(...n)=>{aY&&oY(...n)}}),lY,v2,Nt,ZN,ude,fde,dde,Bs=pn(()=>{lY=class{static calcMatMulShape(n,e){return n[1]!==e[0]?void 0:[n[0],e[1]]}},v2=class{static calcShape(n,e,t=!1){let s=n.length,r=e.length;if(s===0)return e;if(r===0)return n;let a=Math.max(n.length,e.length),o=new Array(a);if(t){if(s<2||r<2)return;let l=lY.calcMatMulShape([n[s-2],n[s-1]],[e[r-2],e[r-1]]);if(l===void 0)return;[o[a-2],o[a-1]]=l}for(let l=t?3:1;l<=a;l++){let c=s-l<0?1:n[s-l],u=r-l<0?1:e[r-l];if(c!==u&&c>1&&u>1)return;let f=Math.max(c,u);if(c&&u)o[a-l]=Math.max(c,u);else{if(f>1)return;o[a-l]=0}}return o}static isValidBroadcast(n,e){let t=n.length,s=e.length;if(t>s)return!1;for(let r=1;r<=t;r++)if(n[t-r]!==1&&n[t-r]!==e[s-r])return!1;return!0}},Nt=class $L{static size(e){return $L.getSizeFromDimensionRange(e,0,e.length)}static convertShape(e,t=4){let s=e.length;if(s===0)return[];let r=new Array(s),a=s-1;for(;a>=0;){if(e[a]%t===0){r[a]=e[a]/t;break}if(t%e[a]!==0)throw new Error("cannot convert shape");r[a]=1,t/=e[a],a--}for(a--;a>=0;a--)r[a]=e[a];return r}static sizeFromDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return $L.getSizeFromDimensionRange(e,t,e.length)}static sizeToDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeToDimension as Tensor has ${e.length} dimensions.`);return $L.getSizeFromDimensionRange(e,0,t)}static getSizeFromDimensionRange(e,t,s){let r=1;for(let a=t;a<s;a++){if(e[a]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");r*=Number(e[a])}return r}static computeStrides(e){let t=e.length;if(t===0)return[];if(t===1)return[1];let s=new Array(t);s[t-1]=1,s[t-2]=e[t-1];for(let r=t-3;r>=0;--r)s[r]=s[r+1]*e[r+1];return s}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map(s=>this.normalizeAxis(s,t??e.length))}static sortBasedOnPerm(e,t){return t?t.map(s=>e[s]):e.slice().reverse()}static padShape(e,t){let s=e.length;return e.map((r,a)=>r+t[a]+t[a+s])}static areEqual(e,t){return e.length!==t.length?!1:e.every((s,r)=>s===t[r])}},ZN=class XS{static adjustPoolAttributes(e,t,s,r,a,o){if(!e&&s.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let l=0;l<t.length-2;l++)l>=s.length?s.push(t[l+2]):s[l]=t[l+2];for(let l=0;l<s.length;l++)if(l<r.length){if(r[l]<0)throw new Error("strides should be greater than or equal to 1")}else r.push(1);for(let l=0;l<s.length;l++)if(l<a.length){if(a[l]<0)throw new Error("dilations should be greater than or equal to 1")}else a.push(1);for(let l=0;l<s.length*2;l++)if(l<o.length){if(o[l]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let l=0;l<s.length;l++){if(s[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[l]>=s[l]||o[l+s.length]>=s[l])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,t,s,r,a,o,l){if(l){if(a.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(t.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(r.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let c=0;c<e.length-2;c++)XS.adjustPadAndReturnShape(e[c+(o?1:2)],t[c],s[c],r[c],a,c,c+e.length-2,l)}}static computePoolOutputShape(e,t,s,r,a,o,l){if(t.length<=0)throw new Error("input shape must be of size greater than 0");let c=[t[0],t[1]];return XS.computeShapeHelper(e,t,c,s,r,a,o,l),c}static computeConvOutputShape(e,t,s,r,a,o,l){if(e.length<=0||t.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let c=[e[0],t[0]];return XS.computeShapeHelper(!1,e,c,s,r,a,o,l),c}static computeShapeHelper(e,t,s,r,a,o,l,c){if(e)for(let u=0;u<t.length-2;u++)s.push(1);else for(let u=0;u<t.length-2;u++)s.push(XS.adjustPadAndReturnShape(t[u+2],r[u],a[u],o[u],l,u,u+t.length-2,c))}static adjustPadAndReturnShape(e,t,s,r,a,o,l,c){let u=s*(r-1)+1;if(c&&c!=="NOTSET")switch(c){case"VALID":return a[o]=0,a[l]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(s!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let f=((e+t-1)/t-1)*t+r-e;return a[o]=Math.floor(c==="SAME_LOWER"?(f+1)/2:f/2),a[l]=f-a[o],Math.floor((e+f-r)/t+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((e+a[o]+a[l]-u)/t+1)}},ude=class{static getShapeOfGemmResult(n,e,t,s,r){if(n.length!==2||t.length!==2)throw new Error("shape need to be of size 2");let a,o,l;e?(a=n[1],o=n[0]):(a=n[0],o=n[1]);let c=-1;if(s?(l=t[0],c=1):(l=t[1],c=0),t[c]!==o)throw new Error("dimension mismatch");if(a<=0||l<=0||o<=0)throw new Error("invalid shape specified");if(r&&!v2.isValidBroadcast(r,[a,l]))throw new Error("gemm: invalid bias shape for broadcast");return[a,l,o]}},fde=-34028234663852886e22,dde=34028234663852886e22}),CU,hde=pn(()=>{Ns(),CU=(n,e)=>new(bU(e))(n)}),C6,X5,cY,Q5,uY,J5,Z5,e$,fY,pde,Hnt=pn(()=>{Jg(),C6=(n,e=!0)=>{if(n.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let t=n.byteLength/8,s=new BigInt64Array(n.buffer,n.byteOffset,t),r=new Int32Array(t);for(let a=0;a<t;a++){let o=s[a];if(o>2147483647n||o<-2147483648n)throw new Error(`Overflow occurred when converting BigInt to Int32 at index ${a}: ${o}`);r[a]=Number(o)}return e?new Uint8Array(r.buffer):r},X5=(n,e=!0)=>{if(n.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let t=n.byteLength/4,s=new Int32Array(n.buffer,n.byteOffset,t),r=BigInt64Array.from(s,BigInt);return e?new Uint8Array(r.buffer):r},cY=1,Q5=()=>cY++,uY=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),J5=(n,e)=>{let t=uY.get(n);if(!t)throw new Error("Unsupported data type.");return e.length>0?Math.ceil(e.reduce((s,r)=>s*r)*t/8):0},Z5=class{constructor(n){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:e,context:t,tensor:s,dataType:r,shape:a,shouldConvertInt64toInt32:o=!1}=n;this.sessionId=e,this.mlContext=t,this.mlTensor=s,this.dataType=r,this.tensorShape=a,this.shouldConvertInt64toInt32=o}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return J5(this.dataType,this.tensorShape)}destroy(){$r("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(n){this.mlContext.writeTensor(this.mlTensor,n)}async read(n,e){if(n){let t=await this.mlContext.readTensor(this.mlTensor),s=X5(new Uint8Array(t));if(e){(e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).set(s);return}else return s.buffer}else return e?this.mlContext.readTensor(this.mlTensor,e):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(n,e,t){return this.mlContext===n&&this.dataType===e&&this.tensorShape.length===t.length&&this.tensorShape.every((s,r)=>s===t[r])}setIsInt64ToInt32Converted(n){this.isInt64ToInt32Converted=n}},e$=class{constructor(n,e){this.tensorManager=n,this.wrapper=e}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(n,e,t,s){let r=e,a=this.tensorManager.getMLContext(n),o=r==="int64"&&!a.opSupportLimits().input.dataTypes.includes("int64");if(o&&(r="int32",$r("verbose",()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32")),this.wrapper){if(this.wrapper.canReuseTensor(a,r,t))return this.wrapper.tensor;if(s){if(this.wrapper.byteLength!==J5(r,t))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let l=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(n,r,t,l,!0,!0,o),s&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(n){let e=n;if(this.wrapper)if(this.wrapper.shouldConvertInt64toInt32&&(e=C6(n,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),e.byteLength===this.wrapper.byteLength){this.wrapper.write(e);return}else $r("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(e):this.activeUpload=new Uint8Array(e)}async download(n){if(this.activeUpload){let e=this.wrapper?.isInt64ToInt32Converted?X5(this.activeUpload):this.activeUpload;if(n){n instanceof ArrayBuffer?new Uint8Array(n).set(e):new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e);return}else return e.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return n?this.wrapper.read(this.wrapper?.shouldConvertInt64toInt32,n):this.wrapper.read(this.wrapper?.shouldConvertInt64toInt32)}},fY=class{constructor(n){this.backend=n,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(n){let e=this.backend.getMLContext(n);if(!e)throw new Error("MLContext not found for session.");return e}reserveTensorId(){let n=Q5();return this.tensorTrackersById.set(n,new e$(this)),n}releaseTensorId(n){let e=this.tensorTrackersById.get(n);e&&(this.tensorTrackersById.delete(n),e.tensorWrapper&&this.releaseTensor(e.tensorWrapper))}async ensureTensor(n,e,t,s,r){$r("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${e}, dataType: ${t}, shape: ${s}, copyOld: ${r}}`);let a=this.tensorTrackersById.get(e);if(!a)throw new Error("Tensor not found.");return a.ensureTensor(n,t,s,r)}upload(n,e){let t=this.tensorTrackersById.get(n);if(!t)throw new Error("Tensor not found.");t.upload(e)}async download(n,e){$r("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${n}, dstBuffer: ${e?.byteLength}}`);let t=this.tensorTrackersById.get(n);if(!t)throw new Error("Tensor not found.");return t.download(e)}releaseTensorsForSession(n){for(let e of this.freeTensors)e.sessionId===n&&e.destroy();this.freeTensors=this.freeTensors.filter(e=>e.sessionId!==n)}registerTensor(n,e,t,s){let r=this.getMLContext(n),a=Q5(),o=new Z5({sessionId:n,context:r,tensor:e,dataType:t,shape:s});return this.tensorTrackersById.set(a,new e$(this,o)),this.externalTensors.add(o),a}async getCachedTensor(n,e,t,s,r,a,o=!1){let l=this.getMLContext(n);for(let[u,f]of this.freeTensors.entries())if(f.canReuseTensor(l,e,t)){$r("verbose",()=>`[WebNN] Reusing tensor {dataType: ${e}, shape: ${t}}`);let d=this.freeTensors.splice(u,1)[0];return d.sessionId=n,d}$r("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${e}, shape: ${t}}`);let c=await l.createTensor({dataType:e,shape:t,dimensions:t,usage:s,writable:r,readable:a});return new Z5({sessionId:n,context:l,tensor:c,dataType:e,shape:t,shouldConvertInt64toInt32:o})}releaseTensor(n){this.externalTensors.has(n)&&this.externalTensors.delete(n),this.freeTensors.push(n)}},pde=(...n)=>new fY(...n)}),HI,dY,mde,qnt=pn(()=>{Ns(),aw(),hde(),Hnt(),Jg(),HI=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),dY=(n,e)=>{if(n===e)return!0;if(n===void 0||e===void 0)return!1;let t=Object.keys(n).sort(),s=Object.keys(e).sort();return t.length===s.length&&t.every((r,a)=>r===s[a]&&n[r]===e[r])},mde=class{constructor(n){this.tensorManager=pde(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,xU(n.logLevel,!!n.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(n){$r("verbose",()=>`[WebNN] onRunStart {sessionId: ${n}}`),this.activeSessionId=n}onRunEnd(n){$r("verbose",()=>`[WebNN] onRunEnd {sessionId: ${n}}`);let e=this.temporarySessionTensorIds.get(n);if(e){for(let t of e)$r("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${t}}`),this.tensorManager.releaseTensorId(t);this.temporarySessionTensorIds.delete(n),this.activeSessionId=void 0}}async createMLContext(n){if(n instanceof GPUDevice){let t=this.mlContextCache.findIndex(s=>s.gpuDevice===n);if(t!==-1)return this.mlContextCache[t].mlContext;{let s=await navigator.ml.createContext(n);return this.mlContextCache.push({gpuDevice:n,mlContext:s}),s}}else if(n===void 0){let t=this.mlContextCache.findIndex(s=>s.options===void 0&&s.gpuDevice===void 0);if(t!==-1)return this.mlContextCache[t].mlContext;{let s=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:s}),s}}let e=this.mlContextCache.findIndex(t=>dY(t.options,n));if(e!==-1)return this.mlContextCache[e].mlContext;{let t=await navigator.ml.createContext(n);return this.mlContextCache.push({options:n,mlContext:t}),t}}registerMLContext(n,e){this.mlContextBySessionId.set(n,e);let t=this.sessionIdsByMLContext.get(e);t||(t=new Set,this.sessionIdsByMLContext.set(e,t)),t.add(n),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(n,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(n){this.sessionGraphInputs.delete(n);let e=this.mlContextBySessionId.get(n);if(!e)return;this.tensorManager.releaseTensorsForSession(n),this.mlContextBySessionId.delete(n);let t=this.sessionIdsByMLContext.get(e);if(t.delete(n),t.size===0){this.sessionIdsByMLContext.delete(e);let s=this.mlContextCache.findIndex(r=>r.mlContext===e);s!==-1&&this.mlContextCache.splice(s,1)}}getMLContext(n){return this.mlContextBySessionId.get(n)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(n){$r("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${n}}`),this.tensorManager.releaseTensorId(n)}async ensureTensor(n,e,t,s,r){let a=HI.get(t);if(!a)throw new Error(`Unsupported ONNX data type: ${t}`);return this.tensorManager.ensureTensor(n??this.currentSessionId,e,a,s,r)}async createTemporaryTensor(n,e,t){$r("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${e}, shape: ${t}}`);let s=HI.get(e);if(!s)throw new Error(`Unsupported ONNX data type: ${e}`);let r=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(n,r,s,t,!1);let a=this.temporarySessionTensorIds.get(n);return a?a.push(r):this.temporarySessionTensorIds.set(n,[r]),r}uploadTensor(n,e){if(!ra().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");$r("verbose",()=>`[WebNN] uploadTensor {tensorId: ${n}, data: ${e.byteLength}}`),this.tensorManager.upload(n,e)}async downloadTensor(n,e){return this.tensorManager.download(n,e)}createMLTensorDownloader(n,e){return async()=>{let t=await this.tensorManager.download(n);return CU(t,e)}}registerMLTensor(n,e,t,s){let r=HI.get(t);if(!r)throw new Error(`Unsupported ONNX data type: ${t}`);let a=this.tensorManager.registerTensor(n,e,r,s);return $r("verbose",()=>`[WebNN] registerMLTensor {tensor: ${e}, dataType: ${r}, dimensions: ${s}} -> {tensorId: ${a}}`),a}registerMLConstant(n,e,t,s,r,a,o=!1){if(!a)throw new Error("External mounted files are not available.");let l=n;n.startsWith("./")&&(l=n.substring(2));let c=a.get(l);if(!c)throw new Error(`File with name ${l} not found in preloaded files.`);if(e+t>c.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let u=c.slice(e,e+t).buffer,f;switch(r.dataType){case"float32":f=new Float32Array(u);break;case"float16":f=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(u):new Uint16Array(u);break;case"int32":f=new Int32Array(u);break;case"uint32":f=new Uint32Array(u);break;case"int64":o?(f=C6(new Uint8Array(u),!1),r.dataType="int32"):f=new BigInt64Array(u);break;case"uint64":f=new BigUint64Array(u);break;case"int8":f=new Int8Array(u);break;case"int4":case"uint4":case"uint8":f=new Uint8Array(u);break;default:throw new Error(`Unsupported data type: ${r.dataType} in creating WebNN Constant from external data.`)}return $r("verbose",()=>`[WebNN] registerMLConstant {dataType: ${r.dataType}, shape: ${r.shape}}} ${o?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),s.constant(r,f)}registerGraphInput(n){this.temporaryGraphInputs.push(n)}isGraphInput(n,e){let t=this.sessionGraphInputs.get(n);return t?t.includes(e):!1}isInt64Supported(n){return!!this.mlContextBySessionId.get(n)?.opSupportLimits().input.dataTypes.includes("int64")}flush(){}}}),SU=pn(()=>{}),t$,qI,YI,hY,pY,n$,S6,mY,gde,Ynt=pn(()=>{Jg(),SU(),t$=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),qI=[],YI=n=>Math.ceil(Number(n)/16)*16,hY=n=>{for(let e=0;e<qI.length;e++){let t=qI[e];if(n<=t)return t}return Math.ceil(n/16)*16},pY=1,n$=()=>pY++,S6=async(n,e,t,s)=>{let r=YI(t),a=n.device.createBuffer({size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let o=n.getCommandEncoder();n.endComputePass(),o.copyBufferToBuffer(e,0,a,0,r),n.flush(),await a.mapAsync(GPUMapMode.READ);let l=a.getMappedRange();if(s){let c=s();return c.set(new Uint8Array(l,0,t)),c}else return new Uint8Array(l.slice(0,t))}finally{a.destroy()}},mY=class{constructor(n){this.backend=n,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[e]of t$)qI.push(e),this.freeBuffers.set(e,[]),this.freeUniformBuffers.set(e,[]);this.sessionCount=0}upload(n,e){let t=e.buffer,s=e.byteOffset,r=e.byteLength,a=YI(r),o=this.storageCache.get(n);if(!o)throw new Error("gpu data for uploading does not exist");if(Number(o.originalSize)!==r)throw new Error(`inconsistent data size. gpu data size=${o.originalSize}, data size=${r}`);let l=this.backend.device.createBuffer({mappedAtCreation:!0,size:a,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),c=l.getMappedRange();new Uint8Array(c).set(new Uint8Array(t,s,r)),l.unmap();let u=this.backend.device.createCommandEncoder();u.copyBufferToBuffer(l,0,o.gpuData.buffer,0,a),this.backend.device.queue.submit([u.finish()]),l.destroy(),$r("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${n})`)}memcpy(n,e){let t=this.storageCache.get(n);if(!t)throw new Error("source gpu data for memcpy does not exist");let s=this.storageCache.get(e);if(!s)throw new Error("destination gpu data for memcpy does not exist");if(t.originalSize!==s.originalSize)throw new Error("inconsistent source and destination gpu data size");let r=YI(t.originalSize),a=this.backend.getCommandEncoder();this.backend.endComputePass(),a.copyBufferToBuffer(t.gpuData.buffer,0,s.gpuData.buffer,0,r)}registerExternalBuffer(n,e,t){let s;if(t){if(s=t[0],n===t[1])return $r("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${e}) => id=${s}, buffer is the same, skip.`),s;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else s=n$();return this.storageCache.set(s,{gpuData:{id:s,type:0,buffer:n},originalSize:e}),$r("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${e}) => id=${s}, registered.`),s}unregisterExternalBuffer(n){n!==void 0&&(this.storageCache.delete(n),$r("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${n}`))}create(n,e=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let t=hY(n),s,r=(e&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,a=(e&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(r||a){let l=(r?this.freeBuffers:this.freeUniformBuffers).get(t);l?l.length>0?s=l.pop():s=this.backend.device.createBuffer({size:t,usage:e}):s=this.backend.device.createBuffer({size:t,usage:e})}else s=this.backend.device.createBuffer({size:t,usage:e});let o={id:n$(),type:0,buffer:s};return this.storageCache.set(o.id,{gpuData:o,originalSize:Number(n)}),$r("verbose",()=>`[WebGPU] GpuDataManager.create(size=${n}) => id=${o.id}`),o}get(n){return this.storageCache.get(n)?.gpuData}release(n){let e=typeof n=="bigint"?Number(n):n,t=this.storageCache.get(e);if(!t){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return $r("verbose",()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${t.gpuData.id}`),this.storageCache.delete(e),this.buffersPending.push(t.gpuData.buffer),t.originalSize}async download(n,e){let t=this.storageCache.get(Number(n));if(!t)throw new Error("data does not exist");await S6(this.backend,t.gpuData.buffer,t.originalSize,e)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let n of this.buffersPending){let e=t$.get(n.size);if((n.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let t=this.freeBuffers.get(n.size)||[];e===void 0||t.length>=e?n.destroy():t.push(n)}else if((n.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let t=this.freeUniformBuffers.get(n.size)||[];e===void 0||t.length>=e?n.destroy():t.push(n)}else n.destroy()}this.buffersPending=[]}else{let n=this.capturedPendingBuffers.get(this.backend.currentSessionId);n||(n=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,n));for(let e of this.buffersPending)n.push(e);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(n=>{n.forEach(e=>{e.destroy()})}),this.freeUniformBuffers.forEach(n=>{n.forEach(e=>{e.destroy()})}),this.storageCache.forEach(n=>{n.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(n=>{n.forEach(e=>{e.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(n){let e=this.capturedPendingBuffers.get(n);e&&(e.forEach(t=>{t.destroy()}),this.capturedPendingBuffers.delete(n)),this.sessionCount-=1,this.sessionCount===0&&($r("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.storageCache=new Map)}},gde=(...n)=>new mY(...n)}),gY,hi,mo=pn(()=>{gY=class{constructor(n){Object.assign(this,n)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(n=>`${this[n]}`).join(";")),this.key}},hi=n=>new gY(n)}),_2,KI,zl,fu,as,Za,M6,Rv,w1,Zn,eS,qt,Kn,yde,MU,yY,bde,Hs=pn(()=>{Ns(),Bs(),_2=64,KI=(n,e)=>{if(e===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(n)){case 10:return e>1?`vec${e}<f16>`:"f16";case 1:return e>1?`vec${e}<f32>`:"f32";case 6:return e>1?`vec${e}<i32>`:"i32";case 12:return e>1?`vec${e}<u32>`:"u32";case 7:if(e>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(e>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(e!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${n}`)}},zl=(n,e=1)=>{let t=KI(n,e);return typeof t=="string"?t:t[0]},fu=(n,e=1)=>{let t=KI(n,e);return typeof t=="string"?t:t[1]},as=(...n)=>{let e=[];return n.forEach(t=>{t.length!==0&&e.push({type:12,data:t},{type:12,data:Nt.computeStrides(t)})}),e},Za=n=>n%4===0?4:n%2===0?2:1,M6=(n="f32",e,t="0")=>!e||e===1?`${n}(${t})`:`vec${e}<${n}>(${t})`,Rv=(n,e,t)=>n==="f32"?t:e===1?`f32(${t})`:`vec${e}<f32>(${t})`,w1=(n,e)=>e===4?`(${n}.x + ${n}.y + ${n}.z + ${n}.w)`:e===2?`(${n}.x + ${n}.y)`:e===3?`(${n}.x + ${n}.y + ${n}.z)`:n,Zn=(n,e,t,s)=>n.startsWith("uniforms.")&&t>4?typeof e=="string"?s==="f16"?`${n}[(${e}) / 8][(${e}) % 8 / 4][(${e}) % 8 % 4]`:`${n}[(${e}) / 4][(${e}) % 4]`:s==="f16"?`${n}[${Math.floor(e/8)}][${Math.floor(e%8/4)}][${e%8%4}]`:`${n}[${Math.floor(e/4)}][${e%4}]`:t>1?`${n}[${e}]`:n,eS=(n,e,t,s,r)=>{let a=typeof t=="number",o=a?t:t.length,l=[...new Array(o).keys()],c=o<2?"u32":o<=4?`vec${o}<u32>`:`array<u32, ${o}>`,u=KI(e,r),f=typeof u=="string"?u:u[1],d=typeof u=="string"?u:u[0],h={indices:c,value:f,storage:d,tensor:e},p=H=>typeof H=="string"?H:`${H}u`,g={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},b=a?"uniforms.":"",v=`${b}${n}_shape`,w=`${b}${n}_strides`,x="";for(let H=0;H<o-1;H++)x+=`
    let dim${H} = current / ${Zn(w,H,o)};
    let rest${H} = current % ${Zn(w,H,o)};
    indices[${H}] = dim${H};
    current = rest${H};
    `;x+=`indices[${o-1}] = current;`;let S=o<2?"":`
  fn o2i_${n}(offset: u32) -> ${h.indices} {
    var indices: ${h.indices};
    var current = offset;
    ${x}
    return indices;
  }`,C=H=>(g.offsetToIndices=!0,o<2?H:`o2i_${n}(${H})`),M=[];if(o>=2)for(let H=o-1;H>=0;H--)M.push(`${Zn(w,H,o)} * (indices[${H}])`);let k=o<2?"":`
  fn i2o_${n}(indices: ${h.indices}) -> u32 {
    return ${M.join("+")};
  }`,E=H=>(g.indicesToOffset=!0,o<2?H:`i2o_${n}(${H})`),I=(...H)=>o===0?"0u":`${h.indices}(${H.map(p).join(",")})`,A=(H,R)=>o<2?`${H}`:`${Zn(H,R,o)}`,D=(H,R,B)=>o<2?`${H}=${B};`:`${Zn(H,R,o)}=${B};`,L={},P=(H,R)=>{g.broadcastedIndicesToOffset=!0;let B=`${R.name}broadcastedIndicesTo${n}Offset`;if(B in L)return`${B}(${H})`;let W=[];for(let se=o-1;se>=0;se--){let ue=R.indicesGet("outputIndices",se+R.rank-o);W.push(`${A(w,se)} * (${ue} % ${A(v,se)})`)}return L[B]=`fn ${B}(outputIndices: ${R.type.indices}) -> u32 {
             return ${W.length>0?W.join("+"):"0u"};
           }`,`${B}(${H})`},j=(H,R)=>(()=>{if(h.storage===h.value)return`${n}[${H}]=${R};`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`${n}[${H}]=vec2<u32>(u32(${R}), select(0u, 0xFFFFFFFFu, ${R} < 0));`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`${n}[${H}]=vec2<u32>(u32(${R}), 0u);`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`${n}[${H}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${R}));`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),G=H=>(()=>{if(h.storage===h.value)return`${n}[${H}]`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`i32(${n}[${H}].x)`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`u32(${n}[${H}].x)`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`vec4<bool>(bool(${n}[${H}] & 0xFFu), bool(${n}[${H}] & 0xFF00u), bool(${n}[${H}] & 0xFF0000u), bool(${n}[${H}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),Q=o<2?"":`
  fn get_${n}ByIndices(indices: ${h.indices}) -> ${f} {
    return ${G(`i2o_${n}(indices)`)};
  }`,q=o<2?"":(()=>{let H=l.map(B=>`d${B}: u32`).join(", "),R=l.map(B=>`d${B}`).join(", ");return`
  fn get_${n}(${H}) -> ${f} {
    return get_${n}ByIndices(${I(R)});
  }`})(),te=(...H)=>{if(H.length!==o)throw new Error(`indices length must be ${o}`);let R=H.map(p).join(",");return o===0?G("0u"):o===1?G(R[0]):(g.get=!0,g.getByIndices=!0,g.indicesToOffset=!0,`get_${n}(${R})`)},Z=H=>o<2?G(H):(g.getByIndices=!0,g.indicesToOffset=!0,`get_${n}ByIndices(${H})`),ne=o<2?"":`
  fn set_${n}ByIndices(indices: ${h.indices}, value: ${f}) {
    ${j(`i2o_${n}(indices)`,"value")}
  }`,le=o<2?"":(()=>{let H=l.map(B=>`d${B}: u32`).join(", "),R=l.map(B=>`d${B}`).join(", ");return`
  fn set_${n}(${H}, value: ${f}) {
    set_${n}ByIndices(${I(R)}, value);
  }`})();return{impl:()=>{let H=[],R=!1;return g.offsetToIndices&&(H.push(S),R=!0),g.indicesToOffset&&(H.push(k),R=!0),g.broadcastedIndicesToOffset&&(Object.values(L).forEach(B=>H.push(B)),R=!0),g.set&&(H.push(le),R=!0),g.setByIndices&&(H.push(ne),R=!0),g.get&&(H.push(q),R=!0),g.getByIndices&&(H.push(Q),R=!0),!a&&R&&H.unshift(`const ${v} = ${h.indices}(${t.join(",")});`,`const ${w} = ${h.indices}(${Nt.computeStrides(t).join(",")});`),H.join(`
`)},type:h,offsetToIndices:C,indicesToOffset:E,broadcastedIndicesToOffset:P,indices:I,indicesGet:A,indicesSet:D,set:(...H)=>{if(H.length!==o+1)throw new Error(`indices length must be ${o}`);let R=H[o];if(typeof R!="string")throw new Error("value must be string");let B=H.slice(0,o).map(p).join(",");return o===0?j("0u",R):o===1?j(B[0],R):(g.set=!0,g.setByIndices=!0,g.indicesToOffset=!0,`set_${n}(${B}, ${R})`)},setByOffset:j,setByIndices:(H,R)=>o<2?j(H,R):(g.setByIndices=!0,g.indicesToOffset=!0,`set_${n}ByIndices(${H}, ${R});`),get:te,getByOffset:G,getByIndices:Z,usage:s,name:n,strides:w,shape:v,rank:o}},qt=(n,e,t,s=1)=>eS(n,e,t,"input",s),Kn=(n,e,t,s=1)=>eS(n,e,t,"output",s),yde=(n,e,t)=>eS(n,e,t,"atomicOutput",1),MU=(n,e,t,s=1)=>eS(n,e,t,"internal",s),yY=class{constructor(n,e){this.normalizedDispatchGroup=n,this.limits=e,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(n){return`if (global_idx >= ${typeof n=="number"?`${n}u`:n}) { return; }`}mainStart(n=_2){let e=typeof n=="number"?n:n[0],t=typeof n=="number"?1:n[1],s=typeof n=="number"?1:n[2];if(e>this.limits.maxComputeWorkgroupSizeX||t>this.limits.maxComputeWorkgroupSizeY||s>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${e}, ${t}, ${s}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(e*t*s>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${e}, ${t}, ${s}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let r=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,a=r?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,o=r?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${e*t*s}u + local_idx;`;return`@compute @workgroup_size(${e}, ${t}, ${s})
  fn main(${a}) {
    ${o}
  `}appendVariableUniforms(n){n.rank!==0&&(n.shape.startsWith("uniforms.")&&this.uniforms.push({name:n.shape.replace("uniforms.",""),type:"u32",length:n.rank}),n.strides.startsWith("uniforms.")&&this.uniforms.push({name:n.strides.replace("uniforms.",""),type:"u32",length:n.rank}))}declareVariable(n,e){if(n.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(n),this.appendVariableUniforms(n);let t=n.usage==="input"?"read":"read_write",s=n.usage==="atomicOutput"?"atomic<i32>":n.type.storage;return`@group(0) @binding(${e}) var<storage, ${t}> ${n.name}: array<${s}>;`}declareVariables(...n){return n.map(e=>this.declareVariable(e,this.variableIndex++)).join(`
`)}registerInternalVariable(n){if(n.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(n),this.appendVariableUniforms(n)}registerInternalVariables(...n){return n.forEach(e=>this.registerInternalVariable(e)),this}registerUniform(n,e,t=1){return this.uniforms.push({name:n,type:e,length:t}),this}registerUniforms(n){return this.uniforms=this.uniforms.concat(n),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let n=[];for(let{name:e,type:t,length:s}of this.uniforms)if(s&&s>4)t==="f16"?n.push(`@align(16) ${e}:array<mat2x4<${t}>, ${Math.ceil(s/8)}>`):n.push(`${e}:array<vec4<${t}>, ${Math.ceil(s/4)}>`);else{let r=s==null||s===1?t:`vec${s}<${t}>`;n.push(`${e}:${r}`)}return`
      struct Uniforms { ${n.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(n=>n.impl()).join(`
`)+this.internalVariables.map(n=>n.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let n=e=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(e)];return this.uniforms.map(e=>[n(e.type),e.length??1])}},bde=(n,e)=>new yY(n,e)}),bY,s$,wY,vY,_Y,xY,wd,wde,vde,D1=pn(()=>{Ns(),Bs(),mo(),Hs(),bY=(n,e)=>{if(!n||n.length!==1)throw new Error("Transpose requires 1 input.");if(e.length!==0&&e.length!==n[0].dims.length)throw new Error(`perm size ${e.length} does not match input rank ${n[0].dims.length}`)},s$=(n,e)=>e.length!==0?e:[...new Array(n).keys()].reverse(),wY=(n,e)=>Nt.sortBasedOnPerm(n,s$(n.length,e)),vY=(n,e,t,s)=>{let r=`fn perm(i: ${s.type.indices}) -> ${t.type.indices} {
    var a: ${t.type.indices};`;for(let a=0;a<e;++a)r+=`a[${n[a]}]=i[${a}];`;return r+="return a;}"},_Y=(n,e)=>{let t=[],s=[];for(let r=0;r<n.length;++r)n[r]!==1&&t.push(n[r]),n[e[r]]!==1&&s.push(e[r]);return{newShape:t,newPerm:s}},xY=(n,e)=>{let t=0;for(let s=0;s<n.length;++s)if(e[n[s]]!==1){if(n[s]<t)return!1;t=n[s]}return!0},wd=(n,e)=>{let t=n.dataType,s=n.dims.length,r=s$(s,e),a=wY(n.dims,r),o=n.dims,l=a,c=s<2||xY(r,n.dims),u;if(c)return u=g=>{let b=qt("input",t,o,4),v=Kn("output",t,l,4);return`
  ${g.registerUniform("output_size","u32").declareVariables(b,v)}
  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let g=Nt.size(a);return{outputs:[{dims:a,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(g/64/4)},programUniforms:[{type:12,data:Math.ceil(g/4)}]}},getShaderSource:u};let{newShape:f,newPerm:d}=_Y(n.dims,r),h=Nt.areEqual(d,[2,3,1]),p=Nt.areEqual(d,[3,1,2]);if(f.length===2||h||p){o=h?[f[0],f[1]*f[2]]:p?[f[0]*f[1],f[2]]:f,l=[o[1],o[0]];let g=16;return u=b=>{let v=qt("a",t,o.length),w=Kn("output",t,l.length);return`
  ${b.registerUniform("output_size","u32").declareVariables(v,w)}
  var<workgroup> tile : array<array<${w.type.value}, ${g+1}>, ${g}>;
  ${b.mainStart([g,g,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${g} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${g}u + local_id.x;
    let input_row = workgroup_id_x * ${g}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${v.getByIndices(`${v.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${g}u + local_id.x;
    let output_row = workgroup_id_y * ${g}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${w.setByIndices(`${w.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let b=Nt.size(a);return{outputs:[{dims:a,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(l[1]/g),y:Math.ceil(l[0]/g)},programUniforms:[{type:12,data:b},...as(o,l)]}},getShaderSource:u}}return u=g=>{let b=qt("a",t,o.length),v=Kn("output",t,l.length);return`
  ${g.registerUniform("output_size","u32").declareVariables(b,v)}

  ${vY(r,s,b,v)}

  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${v.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${v.setByOffset("global_idx",b.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${e}`,inputDependencies:["rank"]},getRunData:()=>{let g=Nt.size(a);return{outputs:[{dims:a,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:[{type:12,data:g},...as(o,l)]}},getShaderSource:u}},wde=(n,e)=>{bY(n.inputs,e.perm),n.compute(wd(n.inputs[0],e.perm))},vde=n=>hi({perm:n.perm})}),CY,SY,MY,TY,kY,EY,IY,AY,LY,NY,Vh,_de,xde,Cde,Sde,Mde,Tde,kde,Ede,Ide,Ade,Knt=pn(()=>{Ns(),Bs(),Hs(),TU(),D1(),CY={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},SY={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},MY={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},TY={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},kY=(n,e)=>{let t=[];for(let s=e-n;s<e;++s)t.push(s);return t},EY=(n,e)=>{let t=[],s=n.length;for(let a=0;a<s;a++)e.indexOf(a)===-1&&t.push(n[a]);let r=e.map(a=>n[a]);return[t,r]},IY=(n,e)=>{let t=n.length+e.length,s=[],r=0;for(let a=0;a<t;a++)e.indexOf(a)===-1?s.push(n[r++]):s.push(1);return s},AY=(n,e)=>{for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0},LY=(n,e)=>{let t=[];if(!AY(n,e)){for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);n.forEach(s=>t.push(s))}return t},NY=(n,e,t,s,r,a,o)=>{let l=t[0].dims,c=Nt.size(a),u=Nt.size(o),f=qt("_A",t[0].dataType,l),d=Kn("output",r,a),h=64;c===1&&(h=256);let p=`
          var<workgroup> aBestValues : array<f32, ${h}>;
       `,g=b=>`
        ${b.registerUniform("reduceSize","u32").declareVariables(f,d)}
        ${p}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${b.mainStart(h)}

          let outputIndex = global_idx / ${h};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${MY[s]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${h}) {
           let candidate = f32(${f.getByOffset("offset + k")});
           bestValue = ${CY[s]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${h}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${SY[s]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${d.setByOffset("outputIndex",`${s==="mean"?`${d.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${d.type.storage}(${TY[s]})`}`)};
         }
        }`;return{name:n,shaderCache:{hint:`${e};${h}`,inputDependencies:["type"]},getShaderSource:g,getRunData:()=>({outputs:[{dims:a,dataType:r}],dispatchGroup:{x:c},programUniforms:[{type:12,data:u}]})}},Vh=(n,e,t,s)=>{let r=n.inputs.length===1?t:T6(n.inputs,t),a=r.axes;a.length===0&&!r.noopWithEmptyAxes&&(a=n.inputs[0].dims.map((p,g)=>g));let o=Nt.normalizeAxes(a,n.inputs[0].dims.length),l=o,c=n.inputs[0],u=LY(l,n.inputs[0].dims.length);u.length>0&&(c=n.compute(wd(n.inputs[0],u),{inputs:[0],outputs:[-1]})[0],l=kY(l.length,c.dims.length));let[f,d]=EY(c.dims,l),h=f;r.keepDims&&(h=IY(f,o)),n.compute(NY(e,r.cacheKey,[c],s,n.inputs[0].dataType,h,d),{inputs:[c]})},_de=(n,e)=>{Vh(n,"ReduceMeanShared",e,"mean")},xde=(n,e)=>{Vh(n,"ReduceL1Shared",e,"l1")},Cde=(n,e)=>{Vh(n,"ReduceL2Shared",e,"l2")},Sde=(n,e)=>{Vh(n,"ReduceLogSumExpShared",e,"logSumExp")},Mde=(n,e)=>{Vh(n,"ReduceMaxShared",e,"max")},Tde=(n,e)=>{Vh(n,"ReduceMinShared",e,"min")},kde=(n,e)=>{Vh(n,"ReduceProdShared",e,"prod")},Ede=(n,e)=>{Vh(n,"ReduceSumShared",e,"sum")},Ide=(n,e)=>{Vh(n,"ReduceSumSquareShared",e,"sumSquare")},Ade=(n,e)=>{Vh(n,"ReduceLogSumShared",e,"logSum")}}),Wh,DY,e4,T6,Gh,OY,PY,$Y,jY,RY,FY,zY,BY,UY,VY,Hh,Lde,Nde,Dde,Ode,Pde,$de,jde,Rde,Fde,zde,TU=pn(()=>{Ns(),Bs(),mo(),Hs(),Knt(),Wh=n=>{if(!n||n.length===0||n.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(n.length===2&&n[1].dims.length!==1)throw new Error("Invalid axes input dims.")},DY=n=>["","",`var value = ${n.getByIndices("input_indices")};`,""],e4=(n,e,t,s,r,a,o=!1,l=!1)=>{let c=[],u=t[0].dims,f=u.length,d=Nt.normalizeAxes(r,f),h=!l&&d.length===0;u.forEach((b,v)=>{h||d.indexOf(v)>=0?o&&c.push(1):c.push(b)});let p=c.length,g=Nt.size(c);return{name:n,shaderCache:e,getShaderSource:b=>{let v=[],w=qt("_A",t[0].dataType,f),x=Kn("output",a,p),S=s(w,x,d),C=S[2];for(let M=0,k=0;M<f;M++)h||d.indexOf(M)>=0?(o&&k++,C=`for(var j${M}: u32 = 0; j${M} < ${u[M]}; j${M}++) {
                  ${S[2].includes("last_index")?`let last_index = j${M};`:""}
                  ${w.indicesSet("input_indices",M,`j${M}`)}
                  ${C}
                }`):(v.push(`${w.indicesSet("input_indices",M,x.indicesGet("output_indices",k))};`),k++);return`

        ${b.registerUniform("output_size","u32").declareVariables(w,x)}

        ${b.mainStart()}
          ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${w.type.indices};
          let output_indices = ${x.offsetToIndices("global_idx")};

          ${v.join(`
`)}
          ${S[0]}       // init ops for reduce max/min
          ${S[1]}
          ${C}
          ${S[3]}
          ${S.length===4?x.setByOffset("global_idx","value"):S.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:c,dataType:a}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:[{type:12,data:g},...as(u,c)]})}},T6=(n,e)=>{let t=[];return n[1].dims[0]>0&&n[1].getBigInt64Array().forEach(s=>t.push(Number(s))),hi({axes:t,keepDims:e.keepDims,noopWithEmptyAxes:e.noopWithEmptyAxes})},Gh=(n,e,t,s)=>{let r=n.inputs,a=r.length===1?t:T6(r,t);n.compute(e4(e,{hint:a.cacheKey,inputDependencies:["rank"]},[r[0]],a.noopWithEmptyAxes&&a.axes.length===0?DY:s,a.axes,r[0].dataType,a.keepDims,a.noopWithEmptyAxes),{inputs:[0]})},OY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceLogSum",e,(t,s)=>[`var value = ${s.type.storage}(0);`,"",`value += ${t.getByIndices("input_indices")};`,"value = log(value);"])},PY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceL1",e,(t,s)=>[`var value = ${s.type.storage}(0);`,"",`value += abs(${t.getByIndices("input_indices")});`,""])},$Y=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceL2",e,(t,s)=>[`var t = ${s.type.value}(0); var value = ${s.type.value}(0);`,"",`t = ${t.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},jY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceLogSumExp",e,(t,s)=>[`var value = ${s.type.storage}(0);`,"",`value += exp(${t.getByIndices("input_indices")});`,"value = log(value);"])},RY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceMax",e,(t,s,r)=>{let a=[];for(let o=0;o<t.rank;o++)(r.indexOf(o)>=0||r.length===0)&&a.push(t.indicesSet("input_indices",o,0));return[`${a.join(`
`)}`,`var value = ${t.getByIndices("input_indices")};`,`value = max(value, ${t.getByIndices("input_indices")});`,""]})},FY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceMean",e,(t,s,r)=>{let a=1;for(let o=0;o<t.rank;o++)(r.indexOf(o)>=0||r.length===0)&&(a*=n.inputs[0].dims[o]);return["var sum = f32(0);","",`sum += f32(${t.getByIndices("input_indices")});`,`let value = ${s.type.value}(sum / ${a});`]})},zY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceMin",e,(t,s,r)=>{let a=[];for(let o=0;o<t.rank;o++)(r.indexOf(o)>=0||r.length===0)&&a.push(`input_indices[${o}] = 0;`);return[`${a.join(`
`)}`,`var value = ${t.getByIndices("input_indices")};`,`value = min(value, ${t.getByIndices("input_indices")});`,""]})},BY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceProd",e,(t,s)=>[`var value = ${s.type.storage}(1);`,"",`value *= ${t.getByIndices("input_indices")};`,""])},UY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceSum",e,(t,s)=>[`var value = ${s.type.storage}(0);`,"",`value += ${t.getByIndices("input_indices")};`,""])},VY=(n,e)=>{Wh(n.inputs),Gh(n,"ReduceSumSquare",e,(t,s)=>[`var t = ${s.type.value}(0); var value = ${s.type.value}(0);`,"",`t = ${t.getByIndices("input_indices")}; value += t * t;`,""])},Hh=(n,e,t)=>{if(e.length===0)return t;let s=1,r=1;for(let a=0;a<e.length;a++)e.indexOf(a)===-1?s*=n[a]:r*=n[a];return r<32&&s>1024},Lde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?FY(n,e):_de(n,e)},Nde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?PY(n,e):xde(n,e)},Dde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?$Y(n,e):Cde(n,e)},Ode=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?jY(n,e):Sde(n,e)},Pde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?RY(n,e):Mde(n,e)},$de=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?zY(n,e):Tde(n,e)},jde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?BY(n,e):kde(n,e)},Rde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?UY(n,e):Ede(n,e)},Fde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?VY(n,e):Ide(n,e)},zde=(n,e)=>{Hh(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?OY(n,e):Ade(n,e)}}),r$,Bde,Ude,k6,Xnt=pn(()=>{Ns(),mo(),TU(),r$=n=>{if(!n||n.length===0||n.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(n[0].dataType!==1)throw new Error("Invalid input type.")},Bde=(n,e)=>{r$(n.inputs);let t=(s,r,a)=>{let o=[];for(let l=0;l<s.rank;l++)(a.indexOf(l)>=0||a.length===0)&&o.push(`input_indices[${l}] = 0;`);return[`${o.join(`
`)}`,`var value = ${s.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${s.getByIndices("input_indices")} ${e.selectLastIndex>0?"<=":"<"} value) {
         value = ${s.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",r.setByOffset("global_idx","best_index")]};n.compute(e4("ArgMin",{hint:e.cacheKey,inputDependencies:["rank"]},[n.inputs[0]],t,[e.axis],7,e.keepDims),{inputs:[0]})},Ude=(n,e)=>{r$(n.inputs);let t=(s,r,a)=>{let o=[];for(let l=0;l<s.rank;l++)(a.indexOf(l)>=0||a.length===0)&&o.push(`input_indices[${l}] = 0;`);return[`${o.join(`
`)}`,`var value = ${s.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${s.getByIndices("input_indices")} ${e.selectLastIndex>0?">=":">"} value) {
         value = ${s.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",r.setByOffset("global_idx","best_index")]};n.compute(e4("argMax",{hint:e.cacheKey,inputDependencies:["rank"]},[n.inputs[0]],t,[e.axis],7,e.keepDims),{inputs:[0]})},k6=n=>hi(n)}),WY,XI,GY,HY,qY,JM,YY,Vde,kU=pn(()=>{Ns(),Bs(),SU(),Hs(),WY=(n,e)=>{let t=n[0],s=n[1],r=n[2],a=n[3],o=n[4],l=n[5];if(o&&l)throw new Error("Attention cannot have both past and attention_bias");if(t.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let c=t.dims[0],u=t.dims[1],f=t.dims[2];if(r.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(s.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(s.dims[0]!==f)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(r.dims[0]!==s.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let d=r.dims[0]/3,h=d,p=h;if(e.qkvHiddenSizes.length>0){if(e.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let S of e.qkvHiddenSizes)if(S%e.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");d=e.qkvHiddenSizes[0],h=e.qkvHiddenSizes[1],p=e.qkvHiddenSizes[2]}let g=u;if(d!==h)throw new Error("qkv_hidden_sizes first element should be same as the second");if(r.dims[0]!==d+h+p)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let b=0;if(o){if(h!==p)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(o.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(o.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(o.dims[1]!==c)throw new Error('Input "past" second dimension must be batch_size');if(o.dims[2]!==e.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(o.dims[4]!==h/e.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');e.pastPresentShareBuffer||(b=o.dims[3])}let v=g+b,w=-1,x=0;if(a)throw new Error("Mask not supported");if(o)throw new Error("past is not supported");if(l){if(l.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(l.dims[0]!==c||l.dims[1]!==e.numHeads||l.dims[2]!==u||l.dims[3]!==v)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:c,sequenceLength:u,pastSequenceLength:b,kvSequenceLength:g,totalSequenceLength:v,maxSequenceLength:w,inputHiddenSize:f,hiddenSize:d,vHiddenSize:p,headSize:Math.floor(d/e.numHeads),vHeadSize:Math.floor(p/e.numHeads),numHeads:e.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:e.maskFilterValue,maskType:x,scale:e.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},XI=(n,e,t)=>e&&n?`
      let total_sequence_length_input = u32(${e.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${n?.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${t?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,GY=(n,e,t,s,r,a,o,l)=>{let c=Za(o?1:a),u=64,f=a/c;f<u&&(u=32);let d=Math.ceil(a/c/u),h=[{type:12,data:e},{type:12,data:t},{type:12,data:s},{type:12,data:r},{type:12,data:f},{type:12,data:d}],p=zl(n.dataType,c),g=fu(1,c),b=["type"];o&&b.push("type"),l&&b.push("type");let v=w=>{let x=Kn("x",n.dataType,n.dims,c),S=[x],C=o?qt("seq_lens",o.dataType,o.dims):void 0;C&&S.push(C);let M=l?qt("total_sequence_length_input",l.dataType,l.dims):void 0;M&&S.push(M);let k=fu(n.dataType),E=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${u}>;
  var<workgroup> thread_sum: array<f32, ${u}>;
  ${w.registerUniforms(E).declareVariables(...S)}
  ${w.mainStart([u,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${XI(C,M,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${u}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${o?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${g}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${g}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(c){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${c}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${u}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${g}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${g}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(c){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${c}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${u}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${x.type.value}(${k}(1.0) / ${k}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${g}(x[offset + i]);
        x[offset + i] = ${x.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${o?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${x.type.value}(${k}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${u};${p};${c}`,inputDependencies:b},getShaderSource:v,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:r,z:e*t},programUniforms:h})}},HY=(n,e,t,s,r,a,o,l,c)=>{let u=o+a.kvSequenceLength,f=[a.batchSize,a.numHeads,a.sequenceLength,u],d=n>1&&s,h=a.kvNumHeads?a.kvNumHeads:a.numHeads,p=d?[a.batchSize,h,u,a.headSize]:void 0,g=a.nReps?a.nReps:1,b=a.scale===0?1/Math.sqrt(a.headSize):a.scale,v=Za(a.headSize),w=a.headSize/v,x=12,S={x:Math.ceil(u/x),y:Math.ceil(a.sequenceLength/x),z:a.batchSize*a.numHeads},C=[{type:12,data:a.sequenceLength},{type:12,data:w},{type:12,data:u},{type:12,data:a.numHeads},{type:12,data:a.headSize},{type:1,data:b},{type:12,data:o},{type:12,data:a.kvSequenceLength},{type:12,data:g}],M=d&&s&&Nt.size(s.dims)>0,k=["type","type"];M&&k.push("type"),r&&k.push("type"),l&&k.push("type"),c&&k.push("type");let E=[{dims:f,dataType:e.dataType,gpuDataType:0}];d&&E.push({dims:p,dataType:e.dataType,gpuDataType:0});let I=A=>{let D=qt("q",e.dataType,e.dims,v),L=qt("key",t.dataType,t.dims,v),P=[D,L];if(M){let ne=qt("past_key",s.dataType,s.dims,v);P.push(ne)}r&&P.push(qt("attention_bias",r.dataType,r.dims));let j=l?qt("seq_lens",l.dataType,l.dims):void 0;j&&P.push(j);let G=c?qt("total_sequence_length_input",c.dataType,c.dims):void 0;G&&P.push(G);let Q=Kn("output",e.dataType,f),q=[Q];d&&q.push(Kn("present_key",e.dataType,p,v));let te=fu(1,v),Z=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${x}u;

  var<workgroup> tileQ: array<${D.type.storage}, ${x*x}>;
  var<workgroup> tileK: array<${D.type.storage}, ${x*x}>;
  ${A.registerUniforms(Z).declareVariables(...P,...q)}
  ${A.mainStart([x,x,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${g===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${g===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${XI(j,G,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${M&&d?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${d?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${te}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${M&&d?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${d?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${te}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(v){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${v}`)}})()};
        output[outputIdx] = ${Q.type.value} (sum * uniforms.alpha) + ${r?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${v};${r!==void 0};${s!==void 0};${n}`,inputDependencies:k},getRunData:()=>({outputs:E,dispatchGroup:S,programUniforms:C}),getShaderSource:I}},qY=(n,e,t,s,r,a,o=void 0,l=void 0)=>{let c=a+r.kvSequenceLength,u=r.nReps?r.nReps:1,f=r.vHiddenSize*u,d=n>1&&s,h=r.kvNumHeads?r.kvNumHeads:r.numHeads,p=d?[r.batchSize,h,c,r.headSize]:void 0,g=[r.batchSize,r.sequenceLength,f],b=12,v={x:Math.ceil(r.vHeadSize/b),y:Math.ceil(r.sequenceLength/b),z:r.batchSize*r.numHeads},w=[{type:12,data:r.sequenceLength},{type:12,data:c},{type:12,data:r.vHeadSize},{type:12,data:r.numHeads},{type:12,data:r.headSize},{type:12,data:f},{type:12,data:a},{type:12,data:r.kvSequenceLength},{type:12,data:u}],x=d&&s&&Nt.size(s.dims)>0,S=["type","type"];x&&S.push("type"),o&&S.push("type"),l&&S.push("type");let C=[{dims:g,dataType:e.dataType,gpuDataType:0}];d&&C.push({dims:p,dataType:e.dataType,gpuDataType:0});let M=k=>{let E=qt("probs",e.dataType,e.dims),I=qt("v",t.dataType,t.dims),A=[E,I];x&&A.push(qt("past_value",s.dataType,s.dims));let D=o?qt("seq_lens",o.dataType,o.dims):void 0;o&&A.push(D);let L=l?qt("total_sequence_length_input",l.dataType,l.dims):void 0;l&&A.push(L);let P=[Kn("output",e.dataType,g)];d&&P.push(Kn("present_value",e.dataType,p));let j=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${b}u;
  var<workgroup> tileQ: array<${E.type.value}, ${b*b}>;
  var<workgroup> tileV: array<${E.type.value}, ${b*b}>;
  ${k.registerUniforms(j).declareVariables(...A,...P)}
  ${k.mainStart([b,b,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${u===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${u===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${XI(D,L,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${x&&d?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${d?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${E.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${x&&d?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${d?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${s!==void 0};${n}`,inputDependencies:S},getRunData:()=>({outputs:C,dispatchGroup:v,programUniforms:w}),getShaderSource:M}},JM=(n,e,t,s,r,a,o,l,c,u,f=void 0,d=void 0)=>{let h=Math.min(n.outputCount,1+(o?1:0)+(l?1:0)),p=h>1?u.pastSequenceLength:0,g=p+u.kvSequenceLength,b=c&&Nt.size(c.dims)>0?c:void 0,v=[e,t];h>1&&o&&Nt.size(o.dims)>0&&v.push(o),b&&v.push(b),f&&v.push(f),d&&v.push(d);let w=n.compute(HY(h,e,t,o,b,u,p,f,d),{inputs:v,outputs:h>1?[-1,1]:[-1]})[0];n.compute(GY(w,u.batchSize,u.numHeads,p,u.sequenceLength,g,f,d),{inputs:f&&d?[w,f,d]:[w],outputs:[]});let x=[w,s];h>1&&l&&Nt.size(l.dims)>0&&x.push(l),f&&x.push(f),d&&x.push(d),n.compute(qY(h,w,s,l,u,p,f,d),{inputs:x,outputs:h>1?[0,2]:[0]})},YY=(n,e)=>{let t=[e.batchSize,e.numHeads,e.sequenceLength,e.headSize],s=e.sequenceLength,r=e.inputHiddenSize,a=e.headSize,o=12,l={x:Math.ceil(e.headSize/o),y:Math.ceil(e.sequenceLength/o),z:e.batchSize*e.numHeads},c=[n.inputs[0],n.inputs[1],n.inputs[2]],u=[{type:12,data:s},{type:12,data:r},{type:12,data:a},{type:12,data:e.numHeads},{type:12,data:e.headSize},{type:12,data:e.hiddenSize},{type:12,data:e.hiddenSize+e.hiddenSize+e.vHiddenSize}],f=d=>{let h=Kn("output_q",c[0].dataType,t),p=Kn("output_k",c[0].dataType,t),g=Kn("output_v",c[0].dataType,t),b=qt("input",c[0].dataType,c[0].dims),v=qt("weight",c[1].dataType,c[1].dims),w=qt("bias",c[2].dataType,c[2].dims),x=b.type.storage,S=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${o}u;
  var<workgroup> tileInput: array<${x}, ${o*o}>;
  var<workgroup> tileWeightQ: array<${x}, ${o*o}>;
  var<workgroup> tileWeightK: array<${x}, ${o*o}>;
  var<workgroup> tileWeightV: array<${x}, ${o*o}>;
  ${d.registerUniforms(S).declareVariables(b,v,w,h,p,g)}
  ${d.mainStart([o,o,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${x}(0);
    var valueK = ${x}(0);
    var valueV = ${x}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return n.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:t,dataType:n.inputs[0].dataType,gpuDataType:0},{dims:t,dataType:n.inputs[0].dataType,gpuDataType:0},{dims:t,dataType:n.inputs[0].dataType,gpuDataType:0}],dispatchGroup:l,programUniforms:u}),getShaderSource:f},{inputs:c,outputs:[-1,-1,-1]})},Vde=(n,e)=>{let t=WY(n.inputs,e),[s,r,a]=YY(n,t);return JM(n,s,r,a,n.inputs[4],void 0,void 0,void 0,n.inputs[5],t)}}),KY,XY,QY,Wde,Qnt=pn(()=>{kp(),Ns(),Bs(),mo(),Hs(),KY=(n,e)=>{if(!n||n.length!==5)throw new Error("BatchNormalization requires 5 inputs");let t=(s,r,a)=>{let o=r.length;if(o!==s.length)throw new Error(`${a}: num dimensions != ${o}`);r.forEach((l,c)=>{if(l!==s[c])throw new Error(`${a}: dim[${c}] do not match`)})};if(n[0].dims.length>1){let s=e.format==="NHWC"?e.spatial?n[0].dims.slice(-1):n[0].dims.slice(-1).concat(n[0].dims.slice(1,n[0].dims.length-1)):n[0].dims.slice(1,e.spatial?2:void 0);t(n[1].dims,s,"Invalid input scale"),t(n[2].dims,s,"Invalid input B"),t(n[3].dims,s,"Invalid input mean"),t(n[4].dims,s,"Invalid input var")}else t(n[1].dims,[1],"Invalid input scale"),t(n[2].dims,[1],"Invalid input B"),t(n[3].dims,[1],"Invalid input mean"),t(n[4].dims,[1],"Invalid input var")},XY=(n,e)=>{let{epsilon:t,spatial:s,format:r}=e,a=n[0].dims,o=s?Za(a[a.length-1]):1,l=r==="NHWC"&&a.length>1?o:1,c=Nt.size(a)/o,u=s,f=u?a.length:a,d=qt("x",n[0].dataType,n[0].dims,o),h=qt("scale",n[1].dataType,n[1].dims,l),p=qt("bias",n[2].dataType,n[2].dims,l),g=qt("inputMean",n[3].dataType,n[3].dims,l),b=qt("inputVar",n[4].dataType,n[4].dims,l),v=Kn("y",n[0].dataType,f,o),w=()=>{let S="";if(s)S=`let cOffset = ${a.length===1?"0u":r==="NHWC"?`outputIndices[${a.length-1}] / ${o}`:"outputIndices[1]"};`;else if(r==="NCHW")S=`
            ${v.indicesSet("outputIndices","0","0")}
            let cOffset = ${v.indicesToOffset("outputIndices")};`;else{S=`var cIndices = ${h.type.indices}(0);
                       cIndices[0] = outputIndices[${a.length-1}];`;for(let C=1;C<h.rank;C++)S+=`cIndices[${C}] = outputIndices[${C}];`;S+=`let cOffset = ${h.indicesToOffset("cIndices")};`}return S},x=S=>`
  const epsilon = ${t};
  ${S.registerUniform("outputSize","u32").declareVariables(d,h,p,g,b,v)}
  ${S.mainStart()}
  ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${v.offsetToIndices(`global_idx * ${o}`)};
    ${w()}
    let scale = ${h.getByOffset("cOffset")};
    let bias = ${p.getByOffset("cOffset")};
    let inputMean = ${g.getByOffset("cOffset")};
    let inputVar = ${b.getByOffset("cOffset")};
    let x = ${d.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${v.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${e.epsilon}_${e.format}_${s}_${o}`,inputDependencies:u?["rank","type","type","type","type"]:void 0},getShaderSource:x,getRunData:()=>({outputs:[{dims:n[0].dims,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u?[{type:12,data:c},...as(a)]:[{type:12,data:c}]})}},QY=n=>hi(n),Wde=(n,e)=>{let{inputs:t,outputCount:s}=n,r=QY({...e,outputCount:s});if(pa.webgpu.validateInputContent&&KY(t,r),e.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");n.compute(XY(t,r))}}),JY,ZY,Gde,Jnt=pn(()=>{Bs(),Hs(),JY=n=>{if(n[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(n[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(n[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(n[0].dims[2]!==n[1].dims[0])throw new Error("last dimension of input and bias are not the same")},ZY=n=>{let e=n[0].dims,t=n[0].dims[2],s=Nt.size(e)/4,r=n[0].dataType,a=qt("input",r,e,4),o=qt("bias",r,[t],4),l=qt("residual",r,e,4),c=Kn("output",r,e,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:e,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:u=>`
  const channels = ${t}u / 4;
  ${u.declareVariables(a,o,l,c)}

  ${u.mainStart()}
    ${u.guardAgainstOutOfBoundsWorkgroupSizes(s)}
    let value = ${a.getByOffset("global_idx")}
      + ${o.getByOffset("global_idx % channels")} + ${l.getByOffset("global_idx")};
    ${c.setByOffset("global_idx","value")}
  }`}},Gde=n=>{JY(n.inputs),n.compute(ZY(n.inputs))}}),eK,si,Hde,qde,Yde,Kde,Xde,Qde,Jde,Zde,ehe,tK,the,nhe,she,rhe,QS,ihe,jL,ahe,ohe,lhe,che,uhe,fhe,dhe,hhe,phe,mhe,ghe,yhe,bhe,whe,vhe,_he,i$,xhe,E6,I6,Che,She,Mhe,nK,sK,The,EU=pn(()=>{Ns(),Bs(),mo(),Hs(),eK=(n,e,t,s,r,a,o)=>{let l=Math.ceil(e/4),c="";typeof r=="string"?c=`${r}(a)`:c=r("a");let u=qt("inputData",t,[l],4),f=Kn("outputData",s,[l],4),d=[{name:"vec_size",type:"u32"}];return o&&d.push(...o),`
      ${n.registerUniforms(d).declareVariables(u,f)}

  ${a??""}

  ${n.mainStart()}
    ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${u.getByOffset("global_idx")};
    ${f.setByOffset("global_idx",c)}
  }`},si=(n,e,t,s,r,a=n.dataType,o,l)=>{let c=[{type:12,data:Math.ceil(Nt.size(n.dims)/4)}];return o&&c.push(...o),{name:e,shaderCache:{hint:r,inputDependencies:["type"]},getShaderSource:u=>eK(u,Nt.size(n.dims),n.dataType,a,t,s,l),getRunData:u=>({outputs:[{dims:n.dims,dataType:a}],dispatchGroup:{x:Math.ceil(Nt.size(u[0].dims)/64/4)},programUniforms:c})}},Hde=n=>{n.compute(si(n.inputs[0],"Abs","abs"))},qde=n=>{n.compute(si(n.inputs[0],"Acos","acos"))},Yde=n=>{n.compute(si(n.inputs[0],"Acosh","acosh"))},Kde=n=>{n.compute(si(n.inputs[0],"Asin","asin"))},Xde=n=>{n.compute(si(n.inputs[0],"Asinh","asinh"))},Qde=n=>{n.compute(si(n.inputs[0],"Atan","atan"))},Jde=n=>{n.compute(si(n.inputs[0],"Atanh","atanh"))},Zde=n=>hi(n),ehe=(n,e)=>{let t;switch(e.to){case 10:t="vec4<f16>";break;case 1:t="vec4<f32>";break;case 12:t="vec4<u32>";break;case 6:t="vec4<i32>";break;case 9:t="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${e.to}`)}n.compute(si(n.inputs[0],"Cast",t,void 0,e.cacheKey,e.to))},tK=n=>{let e,t,s=n.length>=2&&n[1].data!==0,r=n.length>=3&&n[2].data!==0;switch(n[0].dataType){case 1:e=s?n[1].getFloat32Array()[0]:-34028234663852886e22,t=r?n[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:e=s?n[1].getUint16Array()[0]:64511,t=r?n[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return hi({min:e,max:t})},the=(n,e)=>{let t=e||tK(n.inputs),s=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"Clip",r=>`clamp(${r}, vec4<${s}>(uniforms.min), vec4<${s}>(uniforms.max))`,void 0,t.cacheKey,void 0,[{type:n.inputs[0].dataType,data:t.min},{type:n.inputs[0].dataType,data:t.max}],[{name:"min",type:s},{name:"max",type:s}]),{inputs:[0]})},nhe=n=>{n.compute(si(n.inputs[0],"Ceil","ceil"))},she=n=>{n.compute(si(n.inputs[0],"Cos","cos"))},rhe=n=>{n.compute(si(n.inputs[0],"Cosh","cosh"))},QS=n=>hi(n),ihe=(n,e)=>{let t=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"Elu",s=>`elu_vf32(${s})`,`
  const elu_alpha_ = ${t}(${e.alpha});

  fn elu_f32(a: ${t}) -> ${t} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${t}>) -> vec4<${t}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,e.cacheKey))},jL=(n="f32")=>`
const r0: ${n} = 0.3275911;
const r1: ${n} = 0.254829592;
const r2: ${n} = -0.284496736;
const r3: ${n} = 1.421413741;
const r4: ${n} = -1.453152027;
const r5: ${n} = 1.061405429;

fn erf_vf32(v: vec4<${n}>) -> vec4<${n}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,ahe=n=>{let e=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"Erf",t=>`erf_vf32(${t})`,jL(e)))},ohe=n=>{n.compute(si(n.inputs[0],"Exp","exp"))},lhe=n=>{n.compute(si(n.inputs[0],"Floor","floor"))},che=n=>{let e=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"Gelu",t=>`0.5 * ${t} * (1.0 + erf_vf32(${t} * 0.7071067811865475))`,jL(e)))},uhe=(n,e)=>{let t=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"LeakyRelu",s=>`select(leaky_relu_alpha_ * ${s}, ${s}, ${s} >= vec4<${t}>(0.0))`,`const leaky_relu_alpha_ = ${t}(${e.alpha});`,e.cacheKey))},fhe=n=>{n.compute(si(n.inputs[0],"Not",e=>`!${e}`))},dhe=n=>{n.compute(si(n.inputs[0],"Neg",e=>`-${e}`))},hhe=n=>{n.compute(si(n.inputs[0],"Reciprocal",e=>`1.0/${e}`))},phe=n=>{let e=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"Relu",t=>`select(vec4<${e}>(0.0), ${t}, ${t} > vec4<${e}>(0.0))`))},mhe=n=>{n.compute(si(n.inputs[0],"Sigmoid",e=>`(1.0 / (1.0 + exp(-${e})))`))},ghe=n=>hi(n),yhe=(n,e)=>{let t=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"HardSigmoid",s=>`max(vec4<${t}>(0.0), min(vec4<${t}>(1.0), ${e.alpha} * ${s} + vec4<${t}>(${e.beta})))`,void 0,e.cacheKey))},bhe=n=>{n.compute(si(n.inputs[0],"Sin","sin"))},whe=n=>{n.compute(si(n.inputs[0],"Sinh","sinh"))},vhe=n=>{n.compute(si(n.inputs[0],"Sqrt","sqrt"))},_he=n=>{n.compute(si(n.inputs[0],"Tan","tan"))},i$=n=>`sign(${n}) * (1 - exp(-2 * abs(${n}))) / (1 + exp(-2 * abs(${n})))`,xhe=n=>{n.compute(si(n.inputs[0],"Tanh",i$))},E6=(n="f32")=>`
const fast_gelu_a: ${n} = 0.5;
const fast_gelu_b: ${n} = 0.7978845608028654;
const fast_gelu_c: ${n} = 0.035677408136300125;

fn tanh_v(v: vec4<${n}>) -> vec4<${n}> {
  return ${i$("v")};
}
`,I6=n=>`(fast_gelu_a + fast_gelu_a * tanh_v(${n} * (fast_gelu_c * ${n} * ${n} + fast_gelu_b))) * ${n}`,Che=n=>{let e=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"FastGelu",I6,E6(e),void 0,n.inputs[0].dataType))},She=(n,e)=>{let t=fu(n.inputs[0].dataType);return n.compute(si(n.inputs[0],"ThresholdedRelu",s=>`select(vec4<${t}>(0.0), ${s}, ${s} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${t}>(${e.alpha});`,e.cacheKey)),0},Mhe=n=>{n.compute(si(n.inputs[0],"Log","log"))},nK=(n,e)=>`
const alpha = vec4<${n}>(${e});
const one = ${n}(1.0);
const zero = ${n}(0.0);

fn quick_gelu_impl(x: vec4<${n}>) -> vec4<${n}> {
  let v = x *alpha;
  var x1 : vec4<${n}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,sK=n=>`quick_gelu_impl(${n})`,The=(n,e)=>{let t=fu(n.inputs[0].dataType);n.compute(si(n.inputs[0],"QuickGelu",sK,nK(t,e.alpha),e.cacheKey,n.inputs[0].dataType))}}),rK,iK,khe,Znt=pn(()=>{Bs(),Hs(),EU(),rK=n=>{if(n[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(n[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(n[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(n[0].dims[2]!==n[1].dims[0])throw new Error("last dimension of input and bias are not the same")},iK=n=>{let e=n[0].dims.slice();e[2]=e[2]/2;let t=qt("input",n[0].dataType,n[0].dims,4),s=qt("bias",n[0].dataType,[n[0].dims[2]],4),r=Kn("output",n[0].dataType,e,4),a=Nt.size(e)/4,o=zl(n[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:e,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)}}),getShaderSource:l=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${n[0].dims[2]/4/2}u;

  ${l.declareVariables(t,s,r)}

  ${jL(o)}

  ${l.mainStart()}
    ${l.guardAgainstOutOfBoundsWorkgroupSizes(a)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${r.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},khe=n=>{rK(n.inputs),n.compute(iK(n.inputs))}}),aK,oK,qh,Ehe,Ihe,Ahe,Lhe,Nhe,Dhe,Ohe,Phe,$he,jhe,est=pn(()=>{Ns(),Bs(),Hs(),aK=(n,e,t,s,r,a,o,l,c,u,f,d)=>{let h,p;typeof l=="string"?h=p=(x,S)=>`${l}((${x}),(${S}))`:typeof l=="function"?h=p=l:(h=l.scalar,p=l.vector);let g=Kn("outputData",f,s.length,4),b=qt("aData",c,e.length,4),v=qt("bData",u,t.length,4),w;if(r)if(a){let x=Nt.size(e)===1,S=Nt.size(t)===1,C=e.length>0&&e[e.length-1]%4===0,M=t.length>0&&t[t.length-1]%4===0;x||S?w=g.setByOffset("global_idx",p(x?`${b.type.value}(${b.getByOffset("0")}.x)`:b.getByOffset("global_idx"),S?`${v.type.value}(${v.getByOffset("0")}.x)`:v.getByOffset("global_idx"))):w=`
            let outputIndices = ${g.offsetToIndices("global_idx * 4u")};
            let offsetA = ${b.broadcastedIndicesToOffset("outputIndices",g)};
            let offsetB = ${v.broadcastedIndicesToOffset("outputIndices",g)};
            ${g.setByOffset("global_idx",p(o||C?b.getByOffset("offsetA / 4u"):`${b.type.value}(${b.getByOffset("offsetA / 4u")}[offsetA % 4u])`,o||M?v.getByOffset("offsetB / 4u"):`${v.type.value}(${v.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else w=g.setByOffset("global_idx",p(b.getByOffset("global_idx"),v.getByOffset("global_idx")));else{if(!a)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let x=(S,C,M="")=>{let k=`aData[indexA${C}][componentA${C}]`,E=`bData[indexB${C}][componentB${C}]`;return`
            let outputIndices${C} = ${g.offsetToIndices(`global_idx * 4u + ${C}u`)};
            let offsetA${C} = ${b.broadcastedIndicesToOffset(`outputIndices${C}`,g)};
            let offsetB${C} = ${v.broadcastedIndicesToOffset(`outputIndices${C}`,g)};
            let indexA${C} = offsetA${C} / 4u;
            let indexB${C} = offsetB${C} / 4u;
            let componentA${C} = offsetA${C} % 4u;
            let componentB${C} = offsetB${C} % 4u;
            ${S}[${C}] = ${M}(${h(k,E)});
          `};f===9?w=`
            var data = vec4<u32>(0);
            ${x("data",0,"u32")}
            ${x("data",1,"u32")}
            ${x("data",2,"u32")}
            ${x("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:w=`
            ${x("outputData[global_idx]",0)}
            ${x("outputData[global_idx]",1)}
            ${x("outputData[global_idx]",2)}
            ${x("outputData[global_idx]",3)}
          `}return`
        ${n.registerUniform("vec_size","u32").declareVariables(b,v,g)}

        ${d??""}

        ${n.mainStart()}
        ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${w}
      }`},oK=(n,e,t,s,r,a,o=t.dataType)=>{let l=t.dims.map(b=>Number(b)??1),c=s.dims.map(b=>Number(b)??1),u=!Nt.areEqual(l,c),f=l,d=Nt.size(l),h=!1,p=!1,g=[u];if(u){let b=v2.calcShape(l,c,!1);if(!b)throw new Error("Can't perform binary op on the given tensors");f=b.slice(),d=Nt.size(f);let v=Nt.size(l)===1,w=Nt.size(c)===1,x=l.length>0&&l[l.length-1]%4===0,S=c.length>0&&c[c.length-1]%4===0;g.push(v),g.push(w),g.push(x),g.push(S);let C=1;for(let M=1;M<f.length;M++){let k=l[l.length-M],E=c[c.length-M];if(k===E)C*=k;else break}C%4===0?(p=!0,h=!0):(v||w||x||S)&&(h=!0)}else h=!0;return g.push(h),{name:n,shaderCache:{hint:e+g.map(b=>b.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:b=>aK(b,l,c,f,h,u,p,r,t.dataType,s.dataType,o,a),getRunData:()=>({outputs:[{dims:f,dataType:o}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:12,data:Math.ceil(Nt.size(f)/4)},...as(l,c,f)]})}},qh=(n,e,t,s,r,a)=>{n.compute(oK(e,r??"",n.inputs[0],n.inputs[1],t,s,a))},Ehe=n=>{qh(n,"Add",(e,t)=>`${e}+${t}`)},Ihe=n=>{qh(n,"Div",(e,t)=>`${e}/${t}`)},Ahe=n=>{qh(n,"Equal",{scalar:(e,t)=>`u32(${e}==${t})`,vector:(e,t)=>`vec4<u32>(${e}==${t})`},void 0,void 0,9)},Lhe=n=>{qh(n,"Mul",(e,t)=>`${e}*${t}`)},Nhe=n=>{let e=qt("input",n.inputs[0].dataType,n.inputs[0].dims).type.value;qh(n,"Pow",{scalar:(t,s)=>`pow_custom(${t},${s})`,vector:(t,s)=>`pow_vector_custom(${t},${s})`},`
    fn pow_custom(a : ${e}, b : ${e}) -> ${e} {
      if (b == ${e}(0.0)) {
        return ${e}(1.0);
      } else if (a < ${e}(0.0) && f32(b) != floor(f32(b))) {
        return ${e}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${e}(1.0), round(f32(abs(b) % ${e}(2.0))) != 1.0) * ${e}(${e==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${e}>, b : vec4<${e}>) -> vec4<${e}> {
      // TODO: implement vectorized pow
      return vec4<${e}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},Dhe=n=>{qh(n,"Sub",(e,t)=>`${e}-${t}`)},Ohe=n=>{qh(n,"Greater",{scalar:(e,t)=>`u32(${e}>${t})`,vector:(e,t)=>`vec4<u32>(${e}>${t})`},void 0,void 0,9)},Phe=n=>{qh(n,"Less",{scalar:(e,t)=>`u32(${e}<${t})`,vector:(e,t)=>`vec4<u32>(${e}<${t})`},void 0,void 0,9)},$he=n=>{qh(n,"GreaterOrEqual",{scalar:(e,t)=>`u32(${e}>=${t})`,vector:(e,t)=>`vec4<u32>(${e}>=${t})`},void 0,void 0,9)},jhe=n=>{qh(n,"LessOrEqual",{scalar:(e,t)=>`u32(${e}<=${t})`,vector:(e,t)=>`vec4<u32>(${e}<=${t})`},void 0,void 0,9)}}),lK,cK,uK,fK,Rhe,Fhe,tst=pn(()=>{Ns(),Bs(),mo(),Hs(),lK=(n,e)=>{if(!n||n.length<1)throw new Error("too few inputs");let t=0,s=n[t],r=s.dataType,a=s.dims.length;n.forEach((o,l)=>{if(l!==t){if(o.dataType!==r)throw new Error("input tensors should be one type");if(o.dims.length!==a)throw new Error("input tensors should have the same shape");o.dims.forEach((c,u)=>{if(u!==e&&c!==s.dims[u])throw new Error("non concat dimensions must match")})}})},cK=(n,e)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${n}u>(${e});
    for (var i: u32 = 0u; i < ${n}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${n}u;
  }`,uK=(n,e)=>{let t=n.length,s=[];for(let r=0;r<t;++r){let a=e.setByOffset("global_idx",n[r].getByIndices("indices"));t===1?s.push(a):r===0?s.push(`if (inputIndex == ${r}u) { ${a} }`):r===t-1?s.push(`else { ${a} }`):s.push(`else if (inputIndex == ${r}) { ${a} }`)}return s.join(`
`)},fK=(n,e,t,s)=>{let r=Nt.size(t),a=new Array(n.length),o=new Array(n.length),l=0,c=[],u=[],f=[{type:12,data:r}];for(let b=0;b<n.length;++b)l+=n[b].dims[e],a[b]=l,u.push(n[b].dims.length),o[b]=qt(`input${b}`,s,u[b]),c.push("rank"),f.push({type:12,data:a[b]});for(let b=0;b<n.length;++b)f.push(...as(n[b].dims));f.push(...as(t));let d=Kn("output",s,t.length),h=d.indicesGet("indices",e),p=Array.from(Array(a.length).keys()).map(b=>`uniforms.sizeInConcatAxis${b}`).join(","),g=b=>`

  ${(()=>{b.registerUniform("outputSize","u32");for(let v=0;v<n.length;v++)b.registerUniform(`sizeInConcatAxis${v}`,"u32");return b.declareVariables(...o,d)})()}

  ${cK(a.length,p)}

  ${b.mainStart()}
    ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${d.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${h});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${a.length}u>(${p});
      ${h} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${uK(o,d)}
  }`;return{name:"Concat",shaderCache:{hint:`${e}`,inputDependencies:c},getRunData:()=>({outputs:[{dims:t,dataType:s}],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:f}),getShaderSource:g}},Rhe=(n,e)=>{let t=n.inputs,s=t[0].dims,r=Nt.normalizeAxis(e.axis,s.length);lK(t,r);let a=s.slice();a[r]=t.reduce((l,c)=>l+(c.dims.length>r?c.dims[r]:0),0);let o=t.filter(l=>Nt.size(l.dims)>0);n.compute(fK(o,r,a,t[0].dataType),{inputs:o})},Fhe=n=>hi({axis:n.axis})}),Db,Ob,Pb,IU,ow=pn(()=>{Ns(),Bs(),Db=(n,e,t="f32")=>{switch(n.activation){case"Relu":return`value = max(value, ${e}(0.0));`;case"Sigmoid":return`value = (${e}(1.0) / (${e}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${e}(${t}(uniforms.clip_min)), ${e}(${t}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${e}(0.0), min(${e}(1.0), ${t}(uniforms.alpha) * value + ${t}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${t}(uniforms.alpha) * value, value, value >= ${e}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${n.activation}`)}},Ob=(n,e)=>{n.activation==="Clip"?e.push({type:1,data:n.clipMax},{type:1,data:n.clipMin}):n.activation==="HardSigmoid"?e.push({type:1,data:n.alpha},{type:1,data:n.beta}):n.activation==="LeakyRelu"&&e.push({type:1,data:n.alpha})},Pb=(n,e)=>{n.activation==="Clip"?e.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):n.activation==="HardSigmoid"?e.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):n.activation==="LeakyRelu"&&e.push({name:"alpha",type:"f32"})},IU=n=>{let e=n?.activation||"";if(e==="HardSigmoid"){let[t,s]=n?.activation_params||[.2,.5];return{activation:e,alpha:t,beta:s}}else if(e==="Clip"){let[t,s]=n?.activation_params||[fde,dde];return{activation:e,clipMax:s,clipMin:t}}else if(e==="LeakyRelu"){let[t]=n?.activation_params||[.01];return{activation:e,alpha:t}}return{activation:e}}}),ic,zhe,AU=pn(()=>{ic=(n,e)=>{switch(n){case 1:return e;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${n}-component is not supported.`)}},zhe=n=>`
      ${n?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Bhe,nst=pn(()=>{Bhe=n=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${n}.x), i32(${n}.y), i32(${n}.z), 1));
}
`}),gM,LU,NU=pn(()=>{Ns(),Bs(),Hs(),ow(),gM=(n,e,t,s,r)=>{let a=s-t;return`
      ${Array.from({length:t}).map((o,l)=>`
      if (${Zn(e.shape,l,e.rank)} != 1) {
        ${e.indicesSet(n,l,Zn(r,l+a,s))}
      } else {
        ${e.indicesSet(n,l,0)}
      }`).join("")}
`},LU=(n,e,t,s,r=!1,a)=>{let o=n[0].dims,l=n[1].dims,c=o[o.length-2],u=l[l.length-1],f=o[o.length-1],d=Za(u),h=Za(f),p=Za(c),g=Nt.size(t)/d/p,b=n.length>2,v=s?s.slice(0,-2):t.slice(0,-2),w=[Nt.size(v),c,u],x=[{type:12,data:g},{type:12,data:c},{type:12,data:u},{type:12,data:f}];Ob(e,x),x.push(...as(v,o,l)),b&&x.push(...as(n[2].dims)),x.push(...as(w));let S=C=>{let M=MU("batch_dims",n[0].dataType,v.length),k=qt("a",n[0].dataType,o.length,h),E=qt("b",n[1].dataType,l.length,d),I=Kn("output",n[0].dataType,w.length,d),A=zl(I.type.tensor),D=Db(e,I.type.value,A),L=[k,E],P="";if(b){let Q=r?d:1;L.push(qt("bias",n[2].dataType,n[2].dims.length,Q)),P=`${r?`value += bias[col / ${Q}];`:`value += ${I.type.value}(bias[row + i]);`}`}let j=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Pb(e,j);let G=()=>{let Q=`var a_data: ${k.type.value};`;for(let q=0;q<h;q++)Q+=`
              let b_data${q} = b[(b_offset + (k + ${q}) * uniforms.N + col) / ${d}];`;for(let q=0;q<p;q++){Q+=`a_data = a[(a_offset + (row + ${q}) * uniforms.K + k) / ${h}];`;for(let te=0;te<h;te++)Q+=`
            values[${q}] = fma(${E.type.value}(a_data${h===1?"":`[${te}]`}), b_data${te}, values[${q}]);
`}return Q};return`
  ${C.registerUniforms(j).registerInternalVariables(M).declareVariables(...L,I)}
  ${C.mainStart()}
    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${d})) * ${d};
    var index1 = global_idx / (uniforms.N / ${d});
    let stride1 = uniforms.M / ${p};
    let row = (index1 % stride1) * ${p};
    let batch = index1 / stride1;

    ${t.length===2?"":`let batch_indices = ${M.offsetToIndices("batch")};`}

    var a_indices: ${k.type.indices};
    ${gM("a_indices",k,k.rank-2,M.rank,"batch_indices")}
    ${k.indicesSet("a_indices",k.rank-2,0)}
    ${k.indicesSet("a_indices",k.rank-1,0)}
    let a_offset = ${k.indicesToOffset("a_indices")};

    var b_indices: ${E.type.indices};
    ${gM("b_indices",E,E.rank-2,M.rank,"batch_indices")}
    ${E.indicesSet("b_indices",E.rank-2,0)}
    ${E.indicesSet("b_indices",E.rank-1,0)}
    let b_offset = ${E.indicesToOffset("b_indices")};
    var values: array<${I.type.value}, ${p}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${h}) {
      ${G()}
    }
    for (var i = 0u; i < ${p}u; i++) {
      var value = values[i];
      ${P}
      ${D}
      let cur_indices = ${I.type.indices}(batch, row + i, col);
      let offset = ${I.indicesToOffset("cur_indices")};
      ${I.setByOffset(`offset / ${d}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${e.activation};${d};${h};${p};${r}`,inputDependencies:b?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:a?a(t):t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:x}),getShaderSource:S}}}),dK,hK,A6,a$,pK,L6,mK,t4,DU=pn(()=>{Ns(),Bs(),Hs(),ow(),NU(),AU(),dK=(n,e)=>n?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${e?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${e?", batchIndices":""});
        `,hK=(n,e)=>n?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${e===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${e===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${e===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,A6=(n,e,t="f32",s,r=!1,a=32,o=!1,l=32)=>{let c=e[1]*n[1],u=e[0]*n[0],f=r?c:a,d=r?a:c,h=f/e[0],p=a/e[1];if(!((r&&h===4&&n[1]===4||!r&&(h===3||h===4))&&f%e[0]===0&&a%e[1]===0&&n[0]===4))throw new Error(`If transposeA ${r} is true, innerElementSize ${h} and workPerThread[1] ${n[1]} must be 4.
      Otherwise, innerElementSize ${h} must be 3 or 4.
  tileAWidth ${f} must be divisible by workgroupSize[0]${e[0]}. tileInner ${a} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${n[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${h}<${t}>, ${f/h}>, ${d}>;
var<workgroup> mm_Bsub: array<array<vec4<${t}>, ${u/n[0]}>, ${a}>;

const rowPerThread = ${n[1]};
const colPerThread = ${n[0]};
const innerElementSize = ${h};
const tileInner = ${a};

@compute @workgroup_size(${e[0]}, ${e[1]}, ${e[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${o?"0":"i32(globalId.z)"};
  ${s?`let batchIndices = ${s.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${c};

  let num_tiles = ${o?`${Math.ceil(l/a)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${o?`i32(globalId.z) * ${l}`:"0"};

  var acc: array<vec4<${t}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${p};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${dK(r,s)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${p}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${s?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${h===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${hK(r,h)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},a$=(n,e)=>n?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${e?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${e?", batchIndices":""});
            `,pK=n=>n?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",L6=(n,e,t="f32",s,r=!1,a=32,o=!1,l=32,c=!1)=>{let u=n[1]*e[1],f=n[0]*e[0],d=r?u:a,h=r?a:u;if(!(h%e[1]===0&&d%e[0]===0&&a%e[1]===0))throw new Error(`tileAHight ${h} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${d} must be divisible by workgroupSize[0]${e[0]}, tileInner ${a} must be divisible by workgroupSize[1]${e[1]}`);let p=h/e[1],g=d/e[0],b=a/e[1],v=c?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${u};
    let globalColStart = i32(workgroupId.x) * ${f};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${e[1]}) {
        for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${e[0]}) {
          ${a$(r,s)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${a}; inputRow = inputRow + ${e[1]}) {
            for (var inputCol = localCol; inputCol < ${f}; inputCol = inputCol + ${e[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${s?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${t}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${r?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${e[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${e[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${u};

let tileRowA = i32(localId.y) * ${p};
let tileColA = i32(localId.x) * ${g};
let tileRowB = i32(localId.y) * ${b};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${p}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${g}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${a$(r,s)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${b}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${s?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${t}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${pK(r)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${t}, ${d}>, ${h}>;
  var<workgroup> mm_Bsub : array<array<${t}, ${f}>, ${a}>;
  const rowPerThread = ${n[1]};
  const colPerThread = ${n[0]};
  const tileInner = ${a};

@compute @workgroup_size(${e[0]}, ${e[1]}, ${e[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${o?"0":"i32(globalId.z)"};
    ${s?`let batchIndices = ${s.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${o?`${Math.ceil(l/a)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${o?`i32(globalId.z) * ${l}`:"0"};

    var acc : array<array<${t}, colPerThread>, rowPerThread>;
    ${v}
  }
`},mK=(n,e,t,s,r=!1)=>{let[a,o,l,c]=s,u=zl(s[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${a.type.indices}) -> ${ic(n,u)} {
      var value = ${ic(n,u)}(0.0);
      let col = colIn * ${n};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${o.type.indices};
        ${gM("aIndices",o,o.rank-2,a.rank,"batchIndices")}
        ${o.indicesSet("aIndices",o.rank-2,"u32(row)")}
        ${o.indicesSet("aIndices",o.rank-1,"u32(colIn)")}
        value = ${o.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${a.type.indices}) -> ${ic(n,u)} {
      var value = ${ic(n,u)}(0.0);
      let col = colIn * ${n};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${l.type.indices};
        ${gM("bIndices",l,l.rank-2,a.rank,"batchIndices")}
        ${l.indicesSet("bIndices",l.rank-2,"u32(row)")}
        ${l.indicesSet("bIndices",l.rank-1,"u32(colIn)")}
        value = ${l.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${ic(n,u)}) {
      let col = colIn * ${n};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${e?`value = value + ${r?"bias[colIn]":`${ic(n,u)}(bias[row])`};`:""}
        ${t}
        ${c.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},t4=(n,e,t,s,r=!1,a)=>{let o=n[0].dims,l=n[1].dims,c=o.slice(0,-2),u=l.slice(0,-2),f=s?s.slice(0,-2):t.slice(0,-2),d=Nt.size(f),h=o[o.length-2],p=o[o.length-1],g=l[l.length-1],b=p%4===0&&g%4===0,v=h<=8?[4,1,1]:[4,4,1],w=[8,8,1],x=[Math.ceil(g/w[0]/v[0]),Math.ceil(h/w[1]/v[1]),Math.ceil(d/w[2]/v[2])],S=b?4:1,C=[...c,h,p/S],M=C.length,k=[...u,p,g/S],E=k.length,I=[d,h,g/S],A=[{type:6,data:h},{type:6,data:g},{type:6,data:p}];Ob(e,A),A.push(...as(f,C,k));let D=["rank","rank"],L=n.length>2;L&&(A.push(...as(n[2].dims)),D.push("rank")),A.push(...as(I));let P=j=>{let G=f.length,Q=MU("batchDims",n[0].dataType,G,1),q=zl(n[0].dataType),te=qt("a",n[0].dataType,M,S),Z=qt("b",n[1].dataType,E,S),ne=Kn("result",n[0].dataType,I.length,S),le=[te,Z];if(L){let se=r?S:1;le.push(qt("bias",n[2].dataType,n[2].dims.length,se))}let H=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Pb(e,H);let R=zl(ne.type.tensor),B=Db(e,ne.type.value,R),W=mK(S,L,B,[Q,te,Z,ne],r);return`
  ${j.registerUniforms(H).registerInternalVariables(Q).declareVariables(...le,ne)}
  ${W}
  ${b?A6(v,w,q,Q):L6(v,w,q,Q)}
                   `};return{name:"MatMul",shaderCache:{hint:`${v};${e.activation};${b};${r}`,inputDependencies:D},getRunData:()=>({outputs:[{dims:a?a(t):t,dataType:n[0].dataType}],dispatchGroup:{x:x[0],y:x[1],z:x[2]},programUniforms:A}),getShaderSource:P}}}),gK,Uhe,sst=pn(()=>{Ns(),Jg(),Hs(),ow(),AU(),nst(),DU(),gK=(n,e,t,s,r=!1,a,o=4,l=4,c=4,u="f32")=>{let f=A=>{switch(A){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${u}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${A} is not supported.`)}},d=A=>{switch(A){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${A} is not supported.`)}},h=n?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,p=n?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,g=n?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",b=n?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",v=n?"row":"col",w=n?"col":"row",x=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${n?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${v} / outWidth;
    let outCol = ${v} % outWidth;

    let WRow = ${w} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${w} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${w} % inChannels;
    var resData = ${ic(o,u)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${g} && xCol >= 0 && xCol < ${b}) {
      ${h}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${f(o)}
    }
    return resData;`,S=n?e&&s?`
    let col = colIn * ${o};
    ${x}`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${x}
    }
    return ${ic(o,u)}(0.0);`:s&&t?`
    let col = colIn * ${o};
    ${x}`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${x}
    }
    return ${ic(o,u)}(0.0);`,C=n?s&&t?d(l):`
    let col = colIn * ${l};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${d(l)}
    }
    return ${ic(l,u)}(0.0);`:`
    let col = colIn * ${l};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${d(l)}
    }
    return ${ic(l,u)}(0.0);`,M=ic(c,u),k=ic(n?o:l,u),E=ic(n?l:o,u),I=Db(a,M,u);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${k} {
      ${n?S:C}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${E} {
      ${n?C:S}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${M}) {
      let col = colIn * ${c};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${n?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${p}
      ${zhe(r)}
      ${I}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Uhe=(n,e,t,s,r,a,o,l,c)=>{let u=e.format==="NHWC",f=u?n[0].dims[3]:n[0].dims[1],d=t[0],h=u?t[2]:t[3],p=u?t[1]:t[2],g=u?t[3]:t[1],b=u&&(f%4===0||f%3===0)&&g%4===0,v=u?g:h*p,w=u?h*p:g,x=[8,8,1],S=s<=8?[4,1,1]:[4,4,1],C=[Math.ceil(v/x[0]/S[0]),Math.ceil(w/x[1]/S[1]),Math.ceil(d/x[2]/S[2])];$r("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${C}`);let M=b?u&&f%4!==0?3:4:1,k=x[1]*S[1],E=x[0]*S[0],I=Math.max(x[0]*M,x[1]),A=s%k===0,D=r%E===0,L=a%I===0,P=b?[M,4,4]:[1,1,1],j=[{type:6,data:s},{type:6,data:r},{type:6,data:a},{type:6,data:[e.pads[0],e.pads[1]]},{type:6,data:e.strides},{type:6,data:e.dilations}];Ob(e,j),j.push(...as(n[0].dims,n[1].dims));let G=["rank","rank"];o&&(j.push(...as(n[2].dims)),G.push("rank")),j.push(...as(t));let Q=q=>{let te=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Pb(e,te);let Z=b?4:1,ne=zl(n[0].dataType),le=`
      fn setOutputAtIndex(flatIndex : i32, value : ${b?`vec4<${ne}>`:ne}) {
        result[flatIndex] = ${b?`vec4<${ne}>`:ne}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${b?`vec4<${ne}>`:ne}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${b?"/ 4":""}, value);
      }`,H=qt("x",n[0].dataType,n[0].dims.length,M===3?1:M),R=qt("w",n[1].dataType,n[1].dims.length,Z),B=[H,R],W=Kn("result",n[0].dataType,t.length,Z);if(o){let se=qt("bias",n[2].dataType,n[2].dims.length,Z);B.push(se),le+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${b?`vec4<${ne}>`:ne} {
          return bias[coords.${u?"w":"y"}${b?"/ 4":""}];
        }`}return`
        ${Bhe("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${q.registerUniforms(te).declareVariables(...B,W)}
        ${le}
        ${gK(u,A,D,L,o,e,P[0],P[1],P[2],ne)}
        ${b?A6(S,x,ne,void 0,!u,I):L6(S,x,ne,void 0,!u,I,!1,void 0,l)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${e.cacheKey};${M};${b};${A};${D};${L};${k};${E};${I}`,inputDependencies:G},getRunData:()=>({outputs:[{dims:c?c(t):t,dataType:n[0].dataType}],dispatchGroup:{x:C[0],y:C[1],z:C[2]},programUniforms:j}),getShaderSource:Q}}}),yK,o$,tS,bK,l$,wK,Vhe,Whe,rst=pn(()=>{Ns(),Jg(),Bs(),Hs(),ow(),AU(),yK=n=>{let e=1;for(let t=0;t<n.length;t++)e*=n[t];return e},o$=n=>typeof n=="number"?[n,n,n]:n,tS=(n,e)=>e<=1?n:n+(n-1)*(e-1),bK=(n,e,t,s=1)=>{let r=tS(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)},l$=(n,e,t,s,r)=>{r==null&&(r=bK(n,e[0],s[0]));let a=[0,0,0,t];for(let o=0;o<3;o++)n[o]+2*r>=e[o]&&(a[o]=Math.trunc((n[o]-e[o]+2*r)/s[o]+1));return a},wK=(n,e,t,s,r,a,o,l,c,u)=>{let f,d,h,p;if(n==="VALID"&&(n=0),typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n};let g=l$([e,t,s,1],[l,c,u],1,[r,a,o],n);d=g[0],h=g[1],p=g[2]}else if(Array.isArray(n)){if(!n.every((b,v,w)=>b===w[0]))throw Error(`Unsupported padding parameter: ${n}`);f={top:n[0],bottom:n[1],left:n[2],right:n[3],front:n[4],back:n[5]};let g=l$([e,t,s,1],[l,c,u],1,[r,a,o],n[0]);d=g[0],h=g[1],p=g[2]}else if(n==="SAME_UPPER"){d=Math.ceil(e/r),h=Math.ceil(t/a),p=Math.ceil(s/o);let g=(d-1)*r+l-e,b=(h-1)*a+c-t,v=(p-1)*o+u-s,w=Math.floor(g/2),x=g-w,S=Math.floor(b/2),C=b-S,M=Math.floor(v/2),k=v-M;f={top:S,bottom:C,left:M,right:k,front:w,back:x}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:d,outHeight:h,outWidth:p}},Vhe=(n,e,t,s,r,a=!1,o="channelsLast")=>{let l,c,u,f,d;if(o==="channelsLast")[l,c,u,f,d]=n;else if(o==="channelsFirst")[l,d,c,u,f]=n;else throw new Error(`Unknown dataFormat ${o}`);let[h,,p,g,b]=e,[v,w,x]=o$(t),[S,C,M]=o$(s),k=tS(p,S),E=tS(g,C),I=tS(b,M),{padInfo:A,outDepth:D,outHeight:L,outWidth:P}=wK(r,c,u,f,v,w,x,k,E,I),j=a?h*d:h,G=[0,0,0,0,0];return o==="channelsFirst"?G=[l,j,D,L,P]:o==="channelsLast"&&(G=[l,D,L,P,j]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:f,inChannels:d,outDepth:D,outHeight:L,outWidth:P,outChannels:j,padInfo:A,strideDepth:v,strideHeight:w,strideWidth:x,filterDepth:p,filterHeight:g,filterWidth:b,effectiveFilterDepth:k,effectiveFilterHeight:E,effectiveFilterWidth:I,dilationDepth:S,dilationHeight:C,dilationWidth:M,inShape:n,outShape:G,filterShape:e}},Whe=(n,e,t,s,r,a)=>{let o=a==="channelsLast";o?n[0].dims[3]:n[0].dims[1];let l=[64,1,1],c={x:t.map((v,w)=>w)},u=[Math.ceil(yK(c.x.map(v=>t[v]))/l[0]),1,1];$r("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${u}`);let f=1,d=Nt.size(t),h=[{type:12,data:d},{type:12,data:s},{type:12,data:r},{type:12,data:e.strides},{type:12,data:e.dilations}];Ob(e,h),h.push(...as(n[0].dims,n[1].dims));let p=["rank","rank"],g=n.length===3;g&&(h.push(...as(n[2].dims)),p.push("rank")),h.push(...as(t));let b=v=>{let w=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:s.length},{name:"pads",type:"u32",length:r.length},{name:"strides",type:"u32",length:e.strides.length},{name:"dilations",type:"u32",length:e.dilations.length}];Pb(e,w);let x=1,S=zl(n[0].dataType),C=qt("x",n[0].dataType,n[0].dims.length,f),M=qt("W",n[1].dataType,n[1].dims.length,x),k=[C,M],E=Kn("result",n[0].dataType,t.length,x),I="";if(g){let L=qt("bias",n[2].dataType,n[2].dims.length,x);k.push(L),I+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${S} {
          return bias[${o?Zn("coords",4,5):Zn("coords",1,5)}];
        }`}let A=ic(f,S),D=Db(e,A,S);return`
            ${I}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${C.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${M.getByIndices("aIndices")};
            }
          ${v.registerUniforms(w).declareVariables(...k,E)}
          ${v.mainStart()}
          ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${E.offsetToIndices("global_idx")};
              let batch = ${Zn("coords",0,C.rank)};
              let d2 = ${o?Zn("coords",C.rank-1,C.rank):Zn("coords",1,C.rank)};
              let xFRCCorner = vec3<u32>(${o?Zn("coords",1,C.rank):Zn("coords",2,C.rank)},
              ${o?Zn("coords",2,C.rank):Zn("coords",3,C.rank)},
              ${o?Zn("coords",3,C.rank):Zn("coords",4,C.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${o?Zn("uniforms.x_shape",1,C.rank):Zn("uniforms.x_shape",2,C.rank)};
              let xShapeZ = ${o?Zn("uniforms.x_shape",2,C.rank):Zn("uniforms.x_shape",3,C.rank)};
              let xShapeW = ${o?Zn("uniforms.x_shape",3,C.rank):Zn("uniforms.x_shape",4,C.rank)};
              let xShapeU = ${o?Zn("uniforms.x_shape",4,C.rank):Zn("uniforms.x_shape",1,C.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${o?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${o?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${o?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${o?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${g?"value = value + getBiasByOutputCoords(coords)":""};
              ${D}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${e.cacheKey};${o};${f};${g}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:t,dataType:n[0].dataType}],dispatchGroup:{x:u[0],y:u[1],z:u[2]},programUniforms:h}),getShaderSource:b}}}),Ghe,Hhe,ist=pn(()=>{Ns(),Bs(),Hs(),ow(),Ghe=(n,e,t,s)=>{let r=n.length>2,a=r?"value += b[output_channel];":"",o=n[0].dims,l=n[1].dims,c=e.format==="NHWC",u=c?t[3]:t[1],f=u/e.group,d=c&&f>=4?Za(u):1,h=Nt.size(t)/d,p=[{type:12,data:h},{type:12,data:e.dilations},{type:12,data:[e.strides[0],e.strides[1]]},{type:12,data:[e.pads[0],e.pads[1]]},{type:12,data:f}];Ob(e,p),p.push(...as(o,[l[0],l[1],l[2],l[3]/d]));let g=r?["rank","rank","rank"]:["rank","rank"];p.push(...as([t[0],t[1],t[2],t[3]/d]));let b=v=>{let w=Kn("output",n[0].dataType,t.length,d),x=zl(w.type.tensor),S=Db(e,w.type.value,x),C=qt("x",n[0].dataType,o.length),M=qt("w",n[1].dataType,l.length,d),k=[C,M];r&&k.push(qt("b",n[2].dataType,n[2].dims,d));let E=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:e.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];Pb(e,E);let I=c?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${C.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${M.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${C.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${M.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${v.registerUniforms(E).declareVariables(...k,w)}

  ${v.mainStart()}
    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${w.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${c?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${c?1:2}], outputIndices[${c?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${d} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${c?2:1}];

    var value: ${w.type.value} = ${w.type.value}(0);
    ${I}
    ${a}
    ${S}
    ${w.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${e.cacheKey}_${d}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:s?s(t):t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:p}),getShaderSource:b}},Hhe=(n,e,t,s)=>{let r=n.length>2,a=Za(t[3]),o=Za(t[2]),l=Nt.size(t)/a/o,c=[n[0].dims[0],n[0].dims[1],n[0].dims[2],n[0].dims[3]/a],u=[n[1].dims[0],n[1].dims[1],n[1].dims[2],n[1].dims[3]/a],f=[t[0],t[1],t[2],t[3]/a],d=[{type:12,data:l},{type:6,data:[e.strides[0],e.strides[1]]},{type:6,data:[e.pads[0],e.pads[1]]}];Ob(e,d),d.push(...as(c,u,f));let h=(o-1)*e.strides[1]+u[1],p=g=>{let b=Kn("output",n[0].dataType,f.length,a),v=zl(b.type.tensor),w=Db(e,b.type.value,v),x=qt("x",n[0].dataType,c.length,a),S=qt("w",n[1].dataType,u.length,a),C=[x,S];r&&C.push(qt("b",n[2].dataType,n[2].dims,a));let M=r?"value += b[output_channel];":"",k=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Pb(e,k),`
  ${g.registerUniforms(k).declareVariables(...C,b)}
  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${o}u;
    let col = (index1 % width1) * ${o}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${x.type.value}, ${h}>;
    var values: array<${b.type.value}, ${o}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${u[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${h}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${x.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${x.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${u[1]}; w_width++) {
          let w_val = ${S.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${o}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${o}u; i++) {
      var value = values[i];
      ${M}
      ${w}
      ${b.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${e.cacheKey};${a};${o};${h};${u[0]};${u[1]}`,inputDependencies:r?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:s?s(t):t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:d}),getShaderSource:p}}}),vK,QI,_K,JI,N6,c$,xK,CK,D6,ast=pn(()=>{Bs(),sst(),rst(),DU(),ist(),ow(),NU(),D1(),vK=(n,e,t,s,r,a)=>{let o=n[0],l=n.slice(a?1:2,a?3:4),c=l.length,u=e[0],f=e.slice(2).map((h,p)=>h+(h-1)*(t[p]-1)),d=l.map((h,p)=>h+s[p]+s[p+c]).map((h,p)=>Math.floor((h-f[p]+r[p])/r[p]));return d.splice(0,0,o),d.splice(a?3:1,0,u),d},QI=[2,3,1,0],_K=(n,e)=>{if(!n||n.length!==2&&n.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(n[0].dims.length>5)throw new Error("greater than 5D is not supported");if(n[0].dims.length!==n[1].dims.length)throw new Error("filter does not have same dimension as input");let t=n[0].dims[e.format==="NHWC"?n[0].dims.length-1:1],s=n[1].dims[1]*e.group;if(t!==s)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(n.length===3&&(n[2].dims.length!==1||n[1].dims[0]!==n[2].dims[0]))throw new Error("invalid bias");let r=n[0].dims.length-2;if(e.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(e.strides.length!==r)throw new Error(`strides should be ${r}D`);if(e.pads.length!==r*2)throw new Error(`pads should be ${r*2}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==n[1].dims.length-2)throw new Error("invalid kernel shape")},JI=(n,e)=>{let t=n.kernelShape.slice();t.length<e[1].dims.length-2&&t.push(...Array(e[1].dims.length-2-t.length).fill(0));for(let a=2;a<e[1].dims.length;++a)t[a-2]===0&&(t[a-2]=e[1].dims[a]);let s=n.pads.slice();ZN.adjustPadsBasedOnAutoPad(e[0].dims,n.strides,n.dilations,t,s,n.format==="NHWC",n.autoPad);let r=Object.assign({},n);return Object.assign(r,{kernelShape:t,pads:s}),r},N6=n=>{let e=IU(n),t=n.format,s=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][n.auto_pad],r=n.dilations,a=n.group,o=n.kernel_shape,l=n.pads,c=n.strides,u=n.w_is_const();return{autoPad:s,format:t,dilations:r,group:a,kernelShape:o,pads:l,strides:c,wIsConst:u,...e,cacheKey:`${n.format};${e.activation};`}},c$=(n,e,t,s)=>{let r=t.format==="NHWC",a=vK(e[0].dims,e[1].dims,t.dilations,t.pads,t.strides,r);if(t.group!==1){let k=[e[0]];if(r){let E=n.kernelCustomData.wT??n.compute(wd(e[1],QI),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=E),k.push(E)}else k.push(e[1]);e.length===3&&k.push(e[2]),!n.adapterInfo.isArchitecture("ampere")&&r&&e[1].dims[0]===t.group&&e[1].dims[1]===1&&t.dilations[0]===1&&t.dilations[1]===1?n.compute(Hhe(k,t,a,s),{inputs:k}):n.compute(Ghe(k,t,a,s),{inputs:k});return}let o=e.length===3,l=e[0].dims[r?1:2],c=e[0].dims[r?2:3],u=e[0].dims[r?3:1],f=e[1].dims[2],d=e[1].dims[3],h=a[r?1:2],p=a[r?2:3],g=a[r?3:1],b=r&&f===l&&d===c&&t.pads[0]===0&&t.pads[1]===0;if(b||f===1&&d===1&&t.dilations[0]===1&&t.dilations[1]===1&&t.strides[0]===1&&t.strides[1]===1&&t.pads[0]===0&&t.pads[1]===0){let k=a[0],E,I,A,D=[];if(r){let j=n.kernelCustomData.wT??n.compute(wd(e[1],QI),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];if(t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=j),b){let G=l*c*u;E=e[0].reshape([1,k,G]),I=j.reshape([1,G,g]),A=[1,k,g]}else E=e[0].reshape([k,l*c,u]),I=j.reshape([1,u,g]),A=[k,h*p,g];D.push(E),D.push(I)}else E=e[0].reshape([k,u,l*c]),I=e[1].reshape([1,g,u]),A=[k,g,h*p],D.push(I),D.push(E);o&&D.push(e[2]);let L=A[2],P=D[0].dims[D[0].dims.length-1];L<8&&P<8?n.compute(LU(D,t,a,A,r,s),{inputs:D}):n.compute(t4(D,t,a,A,r,s),{inputs:D});return}let v=!0,w=n.kernelCustomData.wT??n.compute(wd(e[1],QI),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=w);let x=[e[0],w];o&&x.push(e[2]);let S=r?h*p:g,C=r?g:h*p,M=f*d*u;n.compute(Uhe(x,t,a,S,C,M,o,v,s),{inputs:x})},xK=(n,e)=>{let t=e.format==="NHWC",s=[n.inputs[0].reshape(t?[n.inputs[0].dims[0],1,n.inputs[0].dims[1],n.inputs[0].dims[2]]:[n.inputs[0].dims[0],n.inputs[0].dims[1],1,n.inputs[0].dims[2]]),n.inputs[1].reshape([n.inputs[1].dims[0],n.inputs[1].dims[1],1,n.inputs[1].dims[2]])];n.inputs.length===3&&s.push(n.inputs[2]);let r=[0,e.pads[0],0,e.pads[1]],a=[1].concat(e.strides),o=[1].concat(e.dilations),l=[1].concat(e.kernelShape),c=JI({...e,pads:r,strides:a,dilations:o,kernelShape:l},s);c$(n,s,c,u=>t?[u[0],u[2],u[3]]:[u[0],u[1],u[3]])},CK=(n,e,t)=>{let s=t.format==="NHWC"?"channelsLast":"channelsFirst",r=JI(t,e),a=t.autoPad==="NOTSET"?t.pads:t.autoPad,o=Vhe(e[0].dims,e[1].dims,t.strides,t.dilations,a,!1,s);n.compute(Whe(e,r,o.outShape,[o.filterDepth,o.filterHeight,o.filterWidth],[o.padInfo.front,o.padInfo.top,o.padInfo.left],s))},D6=(n,e)=>{if(_K(n.inputs,e),n.inputs[0].dims.length===3)xK(n,e);else if(n.inputs[0].dims.length===5)CK(n,n.inputs,e);else{let t=JI(e,n.inputs);c$(n,n.inputs,t)}}}),qhe,ost=pn(()=>{Ns(),Jg(),Bs(),Hs(),qhe=(n,e,t)=>{let s=n.length>2,r=e.outputShape,a=e.format==="NHWC",o=e.group,l=n[1].dims,c=l[2]/o,u=l[3],f=a?Za(c):1,d=a&&u===1&&c>=4,h=d?Math.floor(c/4)*4:Math.floor(c/f)*f,p=c-h,g=a?Za(u):1,b=a?u===1?f:g:1,v=Nt.size(r)/g,w=[Math.ceil(v/64),1,1];$r("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${w}`);let x=["rank","rank"],S=[e.strides[0],e.strides[1]],C=[e.kernelShape[a?1:2],e.kernelShape[a?2:3]],M=[e.dilations[0],e.dilations[1]],k=[C[0]+(e.dilations[0]<=1?0:(e.kernelShape[a?1:2]-1)*(e.dilations[0]-1)),C[1]+(e.dilations[1]<=1?0:(e.kernelShape[a?2:3]-1)*(e.dilations[1]-1))],E=[k[0]-1-Math.floor((e.pads[0]+e.pads[2])/2),k[1]-1-Math.floor((e.pads[1]+e.pads[3])/2)],I=[{type:12,data:v},{type:12,data:S},{type:12,data:C},{type:12,data:M},{type:12,data:k},{type:6,data:E},{type:12,data:h},{type:12,data:c},{type:12,data:u},...as(n[0].dims,n[1].dims)];s&&(I.push(...as(n[2].dims)),x.push("rank")),I.push(...as(r));let A=D=>{let L=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:S.length},{name:"filter_dims",type:"u32",length:C.length},{name:"dilations",type:"u32",length:C.length},{name:"effective_filter_dims",type:"u32",length:k.length},{name:"pads",type:"i32",length:E.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],P=zl(n[0].dataType),j=a?1:2,G=a?2:3,Q=a?3:1,q=qt("W",n[1].dataType,n[1].dims.length,b),te=qt("Dy",n[0].dataType,n[0].dims.length,f),Z=[te,q];s&&Z.push(qt("bias",n[2].dataType,[r[Q]].length,g));let ne=Kn("result",n[0].dataType,r.length,g),le=()=>{let B="";if(d)f===4?B+=`
        let xValue = ${te.getByOffset("x_offset")};
        let wValue = ${q.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:f===2?B+=`
          dotProd = dotProd + dot(vec4<${P}>(${te.getByOffset("x_offset")}, ${te.getByOffset("x_offset + 1u")}), vec4<${P}>(${q.getByOffset("w_offset")}, ${q.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:f===1&&(B+=`
          dotProd = dotProd + dot(vec4<${P}>(${te.getByOffset("x_offset")}, ${te.getByOffset("x_offset + 1u")}, ${te.getByOffset("x_offset + 2u")}, ${te.getByOffset("x_offset + 3u")}), vec4<${P}>(${q.getByOffset("w_offset")}, ${q.getByOffset("w_offset + 1u")}, ${q.getByOffset("w_offset + 2u")}, ${q.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(B+=`
                  let xValue = ${a?te.getByOffset(`${te.indicesToOffset(`${te.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${f}`):te.get("batch","inputChannel","idyR","idyC")};
        `,f===1)B+=`
          let w_offset = ${q.indicesToOffset(`${q.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${q.getByOffset(`w_offset / ${b}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let W=0;W<f;W++)B+=`
            let wValue${W} = ${q.getByOffset(`${q.indicesToOffset(`${q.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${W}, wOutChannel)`)} / ${b}`)};
            dotProd = dotProd + xValue[${W}] * wValue${W};`;return B},H=()=>{if(p===0)return"";if(!d)throw new Error(`packInputAs4 ${d} is not true.`);let B="";if(f===1){B+="dotProd = dotProd";for(let W=0;W<p;W++)B+=`
            + ${te.getByOffset(`x_offset + ${W}`)} * ${q.getByOffset(`w_offset + ${W}`)}`;B+=";"}else if(f===2){if(p!==2)throw new Error(`Invalid inputChannelsRemainder ${p}.`);B+=`
          let xValue = ${te.getByOffset("x_offset")};
          let wValue = ${q.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return B},R=`
            let outputIndices = ${ne.offsetToIndices(`global_idx * ${g}`)};
            let batch = ${ne.indicesGet("outputIndices",0)};
            let d1 = ${ne.indicesGet("outputIndices",Q)};
            let r = ${ne.indicesGet("outputIndices",j)};
            let c = ${ne.indicesGet("outputIndices",G)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${ne.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${P}(dyRCorner) + ${P}(wR)) / ${P}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${P}(uniforms.Dy_shape[${j}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${P}(dyCCorner) + ${P}(wC)) / ${P}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${P}(uniforms.Dy_shape[${G}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${d?`
                var x_offset = ${te.indicesToOffset(`${te.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${f};
                var w_offset = ${q.indicesToOffset(`${q.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${b};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${d?4:f}) {
                  ${le()}
                  inputChannel = inputChannel + ${d?4:f};
                }
                ${H()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${s?` + bias[d1 / ${g}]`:""};
            ${ne.setByOffset("global_idx","value")};
          `;return`
    ${D.registerUniforms(L).declareVariables(...Z,ne)}
      ${D.mainStart()}
      ${D.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${R}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${e.cacheKey};${f}${b}${g}${d}${p}`,inputDependencies:x},getRunData:()=>({dispatchGroup:{x:w[0],y:w[1],z:w[2]},outputs:[{dims:t?t(r):r,dataType:n[0].dataType}],programUniforms:I}),getShaderSource:A}}}),SK,MK,TK,u$,Yhe,kK,f$,EK,Khe,lst=pn(()=>{ost(),ow(),D1(),SK=(n,e,t,s,r,a)=>(n-1)*e+t+(s-1)*r+1-a,MK=(n,e,t,s,r)=>{let a=Math.floor(n/2);e==="SAME_UPPER"?(t[s]=a,t[r]=n-a):e==="SAME_LOWER"&&(t[s]=n-a,t[r]=a)},TK=(n,e,t,s,r,a,o,l,c,u)=>{let f=n.length-2,d=u.length===0;c.length<f&&c.push(...Array(f-c.length).fill(0));let h=n[0],p=e[l?3:1]*r;for(let g=0,b=n.length-f-(l?1:0);g<f;++g,++b){let v=n[b],w=d?v*o[g]:u[g],x=SK(v,o[g],a[g],e[b],t[g],w);MK(x,s,a,g,g+f),d&&u.push(o[g]*(v-1)+c[g]+(e[b]-1)*t[g]+1-a[g]-a[g+f])}u.splice(0,0,h),u.splice(l?3:1,0,p)},u$=(n,e)=>{let t=n.kernelShape.slice();if(n.kernelShape.length===0||n.kernelShape.reduce((d,h)=>d*h,1)===0){t.length=0;for(let d=2;d<e[1].dims.length;++d)t.push(e[1].dims[d])}let s=n.format==="NHWC";t.splice(0,0,e[1].dims[0]),t.splice(s?3:1,0,e[1].dims[1]);let r=n.pads.slice(),a=n.outputShape.slice(),o=n.outputPadding.slice(),l=e[0].dims,c=n.dilations.slice();if(c.reduce((d,h)=>d+h,0)===0){let d=e[0].dims.length-2;c=new Array(d).fill(1)}let u=n.strides.slice();if(u.reduce((d,h)=>d+h,0)===0){let d=e[0].dims.length-2;u=new Array(d).fill(1)}TK(l,t,c,n.autoPad,n.group,r,u,s,o,a);let f=Object.assign({},n);return Object.assign(f,{kernelShape:t,pads:r,outputPadding:o,outputShape:a,dilations:c,strides:u}),f},Yhe=n=>{let e=IU(n),t=n.format,s=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof n.autoPad>"u"?0:n.autoPad],r=n.dilations,a=n.group,o=n.kernelShape,l=n.pads,c=n.strides,u=n.wIsConst(),f=n.outputPadding,d=n.outputShape;return{autoPad:s,format:t,dilations:r,group:a,kernelShape:o,outputPadding:f,outputShape:d,pads:l,strides:c,wIsConst:u,...e,cacheKey:`${n.format};${e.activation};`}},kK=(n,e)=>{if(!n||n.length!==2&&n.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(n[0].dims.length!==4&&n[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(n[0].dims.length!==n[1].dims.length)throw new Error("filter does not have same dimension as input");let t=n[0].dims[e.format==="NHWC"?n[0].dims.length-1:1],s=n[1].dims[0];if(t!==s)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let r=n[1].dims[1]*e.group;if(n.length===3&&(n[2].dims.length!==1||n[2].dims[0]!==r))throw new Error("invalid bias");let a=n[0].dims.length-2;if(e.dilations.reduce((o,l)=>o+l,0)>0&&e.dilations.length!==a)throw new Error(`dilations should be ${a}D`);if(e.strides.reduce((o,l)=>o+l,0)>0&&e.strides.length!==a)throw new Error(`strides should be ${a}D`);if(e.pads.reduce((o,l)=>o+l,0)>0&&e.pads.length!==a*2)throw new Error(`pads should be ${a*2}D`);if(e.outputPadding.length!==a&&e.outputPadding.length!==0)throw new Error(`output_padding should be ${a}D`);if(e.kernelShape.reduce((o,l)=>o+l,0)>0&&e.kernelShape.length!==0&&e.kernelShape.length!==n[1].dims.length-2)throw new Error("invalid kernel shape");if(e.outputShape.length!==0&&e.outputShape.length!==n[0].dims.length-2)throw new Error("invalid output shape")},f$=(n,e,t,s)=>{let r=n.kernelCustomData.wT??n.compute(wd(e[1],[2,3,0,1]),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=r);let a=[e[0],r];e.length===3&&a.push(e[2]),n.compute(qhe(a,t,s),{inputs:a})},EK=(n,e)=>{let t=e.format==="NHWC",s=[n.inputs[0].reshape(t?[n.inputs[0].dims[0],1,n.inputs[0].dims[1],n.inputs[0].dims[2]]:[n.inputs[0].dims[0],n.inputs[0].dims[1],1,n.inputs[0].dims[2]]),n.inputs[1].reshape([n.inputs[1].dims[0],n.inputs[1].dims[1],1,n.inputs[1].dims[2]])];n.inputs.length===3&&s.push(n.inputs[2]);let r=e.kernelShape;(r.length===0||r[0]===0)&&(r=[n.inputs[1].dims[2]]);let a=e.dilations;(a.length===0||a[0]===0)&&(a=[1]);let o=e.strides;(o.length===0||o[0]===0)&&(o=[1]);let l=e.pads;l.length===0&&(l=[0,0]),l=[0,l[0],0,l[1]],o=[1].concat(o),a=[1].concat(a),r=[1].concat(r);let c=e.outputPadding;c=[0].concat(c);let u=u$({...e,pads:l,strides:o,dilations:a,kernelShape:r,outputPadding:c},s);f$(n,s,u,f=>t?[f[0],f[2],f[3]]:[f[0],f[1],f[3]])},Khe=(n,e)=>{if(kK(n.inputs,e),n.inputs[0].dims.length===3)EK(n,e);else{let t=u$(e,n.inputs);f$(n,n.inputs,t)}}}),IK,Xhe,Qhe,cst=pn(()=>{Ns(),Bs(),mo(),Hs(),IK=(n,e,t,s)=>{let r=Nt.size(e),a=e.length,o=qt("input",n,a),l=Kn("output",n,a),c=t.dataType===6?t.getInt32Array()[0]:Number(t.getBigInt64Array()[0]),u=Nt.normalizeAxis(c,a),f=d=>{let h=` i32(${o.indicesGet("inputIndices","uniforms.axis")}) `,p=Zn("uniforms.input_shape","uniforms.axis",a),g=s.reverse?h+(s.exclusive?" + 1":""):"0",b=s.reverse?p:h+(s.exclusive?"":" + 1");return`
                ${d.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(o,l)}
                ${d.mainStart()}
                  ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${l.offsetToIndices("global_idx")};
                  var sum = ${l.type.value}(0);
                  let first : i32 = ${g};
                  let last : i32 = ${b};
                  for (var i : i32 = first; i < last; i++) {
                    ${o.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${o.getByIndices("inputIndices")};
                  }
                  ${l.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:s.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:e,dataType:n}],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:[{type:12,data:r},{type:12,data:u},...as(e,e)]}),getShaderSource:f}},Xhe=(n,e)=>{let t=n.inputs[0].dims,s=n.inputs[0].dataType,r=n.inputs[1];n.compute(IK(s,t,r,e),{inputs:[0]})},Qhe=n=>{let e=n.exclusive===1,t=n.reverse===1;return hi({exclusive:e,reverse:t})}}),AK,LK,NK,Jhe,Zhe,ust=pn(()=>{Ns(),Bs(),mo(),Hs(),AK=n=>{if(!n||n.length!==1)throw new Error("DepthToSpace requires 1 input.");if(n[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},LK=(n,e,t,s)=>{let r=[];r.push(`fn perm(i: ${s.type.indices}) -> ${t.type.indices} {
    var a: ${t.type.indices};`);for(let a=0;a<e;++a)r.push(t.indicesSet("a",n[a],`i[${a}]`));return r.push("return a;}"),r.join(`
`)},NK=(n,e)=>{let t,s,r,a,o,l,c=e.format==="NHWC",u=e.blocksize,f=e.mode==="DCR";c?([t,s,r,a]=n.dims,o=f?[t,s,r,u,u,a/u**2]:[t,s,r,a/u**2,u,u],l=f?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([t,s,r,a]=[n.dims[0],n.dims[2],n.dims[3],n.dims[1]],o=f?[t,u,u,a/u**2,s,r]:[t,a/u**2,u,u,s,r],l=f?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let d=n.reshape(o),h=d.dims.length,p=n.dataType,g=qt("a",p,h),b=Kn("output",p,h),v=w=>`
  ${w.registerUniform("output_size","u32").declareVariables(g,b)}

  ${LK(l,h,g,b)}

  ${w.mainStart()}
    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${b.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${b.setByOffset("global_idx",g.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${n.dims};${e.blocksize};${e.mode}`,inputDependencies:["rank"]},getRunData:w=>{let x=c?[t,s*u,r*u,a/u**2]:[t,a/u**2,s*u,r*u],S=Nt.size(x),C=d.dims,M=Nt.sortBasedOnPerm(C,l);return{outputs:[{dims:x,dataType:w[0].dataType}],dispatchGroup:{x:Math.ceil(S/64)},programUniforms:[{type:12,data:S},...as(C,M)]}},getShaderSource:v}},Jhe=(n,e)=>{AK(n.inputs),n.compute(NK(n.inputs[0],e))},Zhe=n=>hi({blocksize:n.blocksize,mode:n.mode,format:n.format})}),ZI,nS,d$,DK,OK,PK,$K,h$,jK,epe,tpe,fst=pn(()=>{Ns(),Bs(),mo(),Hs(),ZI="[a-zA-Z]|\\.\\.\\.",nS="("+ZI+")+",d$="^"+nS+"$",DK="("+nS+",)*"+nS,OK="^"+DK+"$",PK=class{constructor(n=-1){this.symbolToIndices=new Map,this.inputIndex=n}addSymbol(n,e){let t=this.symbolToIndices.get(n);t===void 0?t=[e]:t.push(e),this.symbolToIndices.set(n,t)}},$K=class{constructor(n,e){this.equation=e,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[t,s]=e.includes("->")?e.split("->",2):[e,""];if(!t.match(RegExp(OK)))throw new Error("Invalid LHS term");if(t.split(",").forEach((r,a)=>{let o=n[a].dims.slice();if(!r.match(RegExp(d$)))throw new Error("Invalid LHS term");let l=this.processTerm(r,!0,o,a);this.lhs.push(l)}),s==="")s+=[...this.symbolToInfo.entries()].filter(([r,a])=>a.count===1||r==="...").map(([r])=>r).join("");else if(!s.match(RegExp(nS)))throw new Error("Invalid RHS");s.match(RegExp(ZI,"g"))?.forEach(r=>{if(r==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let a=this.symbolToInfo.get(r);if(a===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(a.dimValue)}}),this.rhs=this.processTerm(s,!1,this.outputDims)}addSymbol(n,e,t){let s=this.symbolToInfo.get(n);if(s!==void 0){if(s.dimValue!==e&&s.count!==1)throw new Error("Dimension mismatch");s.count++,s.inputIndices.push(t)}else s={count:1,dimValue:e,inputIndices:[t]};this.symbolToInfo.set(n,s)}processTerm(n,e,t,s=-1){let r=t.length,a=!1,o=[],l=0;if(!n.match(RegExp(d$))&&!e&&n!=="")throw new Error("Invalid LHS term");let c=n.match(RegExp(ZI,"g")),u=new PK(s);return c?.forEach((f,d)=>{if(f==="..."){if(a)throw new Error("Only one ellipsis is allowed per input term");a=!0;let h=r-c.length+1;if(h<0)throw new Error("Ellipsis out of bounds");if(o=t.slice(l,l+h),this.hasEllipsis){if(this.ellipsisDims.length!==o.length||this.ellipsisDims.toString()!==o.toString())throw new Error("Ellipsis dimensions mismatch")}else if(e)this.hasEllipsis=!0,this.ellipsisDims=o;else throw new Error("Ellipsis must be specified in the LHS");for(let p=0;p<o.length;p++){let g=String.fromCharCode(48+p);u.addSymbol(g,d+p),this.addSymbol(g,t[l++],s)}}else u.addSymbol(f,d+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(f,t[l++],s)}),u}},h$=n=>n+"_max",jK=(n,e,t,s)=>{let r=n.map(u=>u.length).map((u,f)=>qt(`input${f}`,e,u)),a=Nt.size(s),o=Kn("output",e,s.length),l=[...t.symbolToInfo.keys()].filter(u=>!t.rhs.symbolToIndices.has(u)),c=u=>{let f=[],d="var prod = 1.0;",h="var sum = 0.0;",p="sum += prod;",g=[],b=[],v=[],w=[],x=t.symbolToInfo.size===t.rhs.symbolToIndices.size;t.symbolToInfo.forEach((C,M)=>{if(t.rhs.symbolToIndices.has(M)){let k=t.rhs.symbolToIndices.get(M)?.[0];k!==void 0&&t.lhs.forEach((E,I)=>{if(C.inputIndices.includes(I)){let A=E.symbolToIndices.get(M);if(A===void 0)throw new Error("Invalid symbol error");A.forEach(D=>{f.push(`${r[I].indicesSet(`input${I}Indices`,D,o.indicesGet("outputIndices",k))}`)})}})}else t.lhs.forEach((k,E)=>{if(C.inputIndices.includes(E)){let I=k.symbolToIndices.get(M);if(I===void 0)throw new Error("Invalid symbol error");I.forEach(A=>{g.push(`${r[E].indicesSet(`input${E}Indices`,A,`${M}`)}`)}),w.push(`prod *= ${r[E].getByIndices(`input${E}Indices`)};`)}}),b.push(`for(var ${M}: u32 = 0; ${M} < uniforms.${h$(M)}; ${M}++) {`),v.push("}")});let S=x?[...f,`let sum = ${r.map((C,M)=>C.getByIndices(`input${M}Indices`)).join(" * ")};`]:[...f,h,...b,...g,d,...w,p,...v];return`
            ${u.registerUniforms(l.map(C=>({name:`${h$(C)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...r,o)}

            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${o.offsetToIndices("global_idx")};
            ${r.map((C,M)=>`var input${M}Indices: ${r[M].type.indices};`).join(`
`)}
            ${S.join(`
`)};
            ${o.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:t.equation,inputDependencies:n.map(()=>"rank")},getRunData:()=>{let u=l.filter(d=>t.symbolToInfo.has(d)).map(d=>({type:12,data:t.symbolToInfo.get(d)?.dimValue||0}));u.push({type:12,data:a});let f=n.map((d,h)=>[...as(d)]).reduce((d,h)=>d.concat(h),u);return f.push(...as(s)),{outputs:[{dims:s,dataType:e}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:f}},getShaderSource:c}},epe=(n,e)=>{let t=new $K(n.inputs,e.equation),s=t.outputDims,r=n.inputs.map((a,o)=>a.dims);n.compute(jK(r,n.inputs[0].dataType,t,s))},tpe=n=>{let e=n.equation.replace(/\s+/g,"");return hi({equation:e})}}),RK,p$,FK,zK,npe,dst=pn(()=>{Ns(),Bs(),Hs(),RK=n=>{if(!n||n.length!==2)throw new Error("Expand requires 2 input.");let e=n[0].dims,t=Array.from(n[1].getBigInt64Array(),Number),s=t.length<e.length?0:t.length-e.length,r=e.length<t.length?0:e.length-t.length;for(;s<t.length&&r<e.length;++s,++r)if(t[s]!==e[r]&&t[s]!==1&&e[r]!==1)throw new Error("Expand requires shape to be broadcastable to input")},p$=(n,e)=>{let t=n.length-e.length,s=[];for(let r=0;r<t;++r)s.push(n[r]);for(let r=0;r<e.length;++r)s.push(e[r]===1?n[r+t]:e[r]);return s},FK=(n,e)=>n.length>e.length?p$(n,e):p$(e,n),zK=n=>{let e=n[0].dims,t=Array.from(n[1].getBigInt64Array(),Number),s=FK(e,t),r=n[0].dataType,a=r===9||Nt.size(e)===1,o=r===9||e.length>0&&e[e.length-1]%4===0?4:1,l=a||s.length>0&&s[s.length-1]%4===0?4:1,c=Math.ceil(Nt.size(s)/l),u=d=>{let h=qt("input",r,e.length,o),p=Kn("output",r,s.length,l),g;if(r===9){let b=(v,w,x="")=>`
          let outputIndices${w} = ${p.offsetToIndices(`outputOffset + ${w}u`)};
          let offset${w} = ${h.broadcastedIndicesToOffset(`outputIndices${w}`,p)};
          let index${w} = offset${w} / 4u;
          let component${w} = offset${w} % 4u;
          ${v}[${w}] = ${x}(${h.getByOffset(`index${w}`)}[component${w}]);
        `;g=`
        let outputOffset = global_idx * ${l};
        var data = vec4<u32>(0);
        ${b("data",0,"u32")}
        ${b("data",1,"u32")}
        ${b("data",2,"u32")}
        ${b("data",3,"u32")}
        ${p.setByOffset("global_idx","data")}
      }`}else g=`
        let outputIndices = ${p.offsetToIndices(`global_idx * ${l}`)};
        let inputOffset = ${h.broadcastedIndicesToOffset("outputIndices",p)};
        let data = ${p.type.value}(${h.getByOffset(`inputOffset / ${o}`)});
        ${p.setByOffset("global_idx","data")}
      }`;return`
    ${d.registerUniform("vec_size","u32").declareVariables(h,p)}
    ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${g}`},f=[{type:12,data:c},...as(e,s)];return{name:"Expand",shaderCache:{hint:`${s.length};${o}${l}`,inputDependencies:["rank"]},getShaderSource:u,getRunData:()=>({outputs:[{dims:s,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:f})}},npe=n=>{RK(n.inputs),n.compute(zK(n.inputs),{inputs:[0]})}}),BK,spe,hst=pn(()=>{Ns(),Bs(),Hs(),EU(),BK=n=>{let e=n[0].dataType,t=Nt.size(n[0].dims),s=Nt.size(n[1].dims),r=s%4===0,a=o=>{let l=qt("x",e,[1],4),c=qt("bias",e,[1],4),u=Kn("y",e,[1],4),f=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],d=p=>`
      let bias${p}_offset: u32 = (global_idx * 4 + ${p}) % uniforms.bias_size;
      let bias${p} = ${c.getByOffset(`bias${p}_offset / 4`)}[bias${p}_offset % 4];`,h=r?`
      let bias = ${c.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${d(0)}${d(1)}${d(2)}${d(3)}
      let bias = ${l.type.value}(bias0, bias1, bias2, bias3);`;return`${o.registerUniforms(f).declareVariables(l,c,u)}

    ${E6(fu(e))}

    ${o.mainStart(_2)}
      ${o.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${l.getByOffset("global_idx")};
      ${h}
      let x_in = x + bias;
      ${u.setByOffset("global_idx",I6("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${r}`,inputDependencies:["type","type"]},getShaderSource:a,getRunData:o=>({outputs:[{dims:o[0].dims,dataType:o[0].dataType}],programUniforms:[{type:12,data:Math.ceil(t/4)},{type:12,data:s}],dispatchGroup:{x:Math.ceil(t/_2/4)}})}},spe=n=>{n.inputs.length<2||Nt.size(n.inputs[1].dims)===0?Che(n):n.compute(BK(n.inputs))}}),UK,VK,rpe,ipe,pst=pn(()=>{Ns(),Bs(),mo(),Hs(),UK=n=>{if(!n||n.length!==2)throw new Error("Gather requires 2 inputs.")},VK=(n,e)=>{let t=n[0].dims,s=n[1].dims,r=t.length,a=Nt.normalizeAxis(e.axis,r),o=t.slice(0);o.splice(a,1,...s);let l=t[a],c=n[0].dataType===9?4:1,u=Math.ceil(Nt.size(o)/c),f=[{type:12,data:u},{type:6,data:l},{type:12,data:a},...as(n[0].dims,n[1].dims,o)],d=h=>{let p=qt("data",n[0].dataType,n[0].dims.length,c),g=qt("inputIndices",n[1].dataType,n[1].dims.length),b=Kn("output",n[0].dataType,o.length,c),v=x=>{let S=s.length,C=`var indicesIndices${x}  = ${g.type.indices}(0);`;for(let M=0;M<S;M++)C+=`${S>1?`indicesIndices${x}[${M}]`:`indicesIndices${x}`} = ${o.length>1?`outputIndices${x}[uniforms.axis + ${M}]`:`outputIndices${x}`};`;C+=`
          var idx${x} = ${g.getByIndices(`indicesIndices${x}`)};
          if (idx${x} < 0) {
            idx${x} = idx${x} + uniforms.axisDimLimit;
          }
          var dataIndices${x} : ${p.type.indices};
        `;for(let M=0,k=0;M<r;M++)M===a?(C+=`${r>1?`dataIndices${x}[${M}]`:`dataIndices${x}`} = u32(idx${x});`,k+=S):(C+=`${r>1?`dataIndices${x}[${M}]`:`dataIndices${x}`} = ${o.length>1?`outputIndices${x}[${k}]`:`outputIndices${x}`};`,k++);return C},w;if(n[0].dataType===9){let x=(S,C,M="")=>`
          let outputIndices${C} = ${b.offsetToIndices(`outputOffset + ${C}u`)};
          ${v(C)};
          let offset${C} = ${p.indicesToOffset(`dataIndices${C}`)};
          let index${C} = offset${C} / 4u;
          let component${C} = offset${C} % 4u;
          ${S}[${C}] = ${M}(${p.getByOffset(`index${C}`)}[component${C}]);
        `;w=`
        let outputOffset = global_idx * ${c};
        var value = vec4<u32>(0);
        ${x("value",0,"u32")}
        ${x("value",1,"u32")}
        ${x("value",2,"u32")}
        ${x("value",3,"u32")}
        ${b.setByOffset("global_idx","value")}
      `}else w=`
      let outputIndices = ${b.offsetToIndices("global_idx")};
      ${v("")};
      let value = ${p.getByIndices("dataIndices")};
      ${b.setByOffset("global_idx","value")};
      `;return`
      ${h.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(p,g,b)}
      ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${w}
      }`};return{name:"Gather",shaderCache:{hint:e.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:o,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:f}),getShaderSource:d}},rpe=n=>hi({axis:n.axis}),ipe=(n,e)=>{let t=n.inputs;UK(t),n.compute(VK(n.inputs,e))}}),WK,ape,ope,mst=pn(()=>{Ns(),Bs(),Hs(),WK=(n,e,t,s,r,a,o,l,c)=>{let u=[{type:12,data:a},{type:12,data:s},{type:12,data:r},{type:12,data:t},{type:12,data:o},{type:12,data:l},{type:12,data:c}],f=[a];u.push(...as(e.dims,f));let d=h=>{let p=qt("indices_data",e.dataType,e.dims.length),g=Kn("input_slice_offsets_data",12,1,1),b=[p,g],v=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:r.length},{name:"sizes_from_slice_dims_data",type:"u32",length:t.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${h.registerUniforms(v).declareVariables(...b)}
  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${r.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${t.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return n.compute({name:"computeSliceOffsets",shaderCache:{hint:`${r.length}_${t.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:f,dataType:n.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}),getShaderSource:d},{inputs:[e],outputs:[-1]})[0]},ape=(n,e)=>{let t=n.inputs,s=t[0].dims,r=t[0].dataType,a=t[1].dims,o=a[a.length-1],l=Nt.sizeToDimension(a,a.length-1),c=Nt.sizeFromDimension(s,e.batchDims+o),u=Nt.sizeToDimension(s,e.batchDims),f=Nt.sizeFromDimension(s,e.batchDims),d=l/u,h=new Array(o),p=c;for(let C=0;C<o;++C)h[o-1-C]=p,p*=s[e.batchDims+o-1-C];let g=WK(n,t[1],h,e.batchDims,s,l,d,f,o),b=e.batchDims+o;if(b>s.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let v=a.slice(0,-1).concat(s.slice(b)),w=Nt.size(v),x=[{type:12,data:w},{type:12,data:c},...as(t[0].dims,g.dims,v)],S=C=>{let M=qt("data",t[0].dataType,t[0].dims.length),k=qt("slice_offsets",12,g.dims.length),E=Kn("output",t[0].dataType,v.length);return`
          ${C.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(M,k,E)}
            ${C.mainStart()}
            ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};n.compute({name:"GatherND",shaderCache:{hint:e.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:v,dataType:r}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:x}),getShaderSource:S},{inputs:[t[0],g]})},ope=n=>({batchDims:n.batch_dims,cacheKey:""})}),GK,HK,lpe,cpe,gst=pn(()=>{Ns(),Bs(),mo(),Hs(),GK=(n,e)=>{if(n.length<3||n.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let t=Nt.normalizeAxis(e.quantizeAxis,n[0].dims.length),s=e.blockSize,r=n[0],a=n[2],o=n.length===4?n[3]:void 0;if(a.dims.length!==r.dims.length||!r.dims.map((l,c)=>c===t?Math.ceil(l/s)===a.dims[c]:l===a.dims[c]).reduce((l,c)=>l&&c,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(o){if(o.dataType!==r.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(o.dims.length!==a.dims.length||!o.dims.map((l,c)=>l===a.dims[c]).reduce((l,c)=>l&&c,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},HK=(n,e)=>{let t=n[0].dims,s=n[1].dims,r=t.length,a=Nt.normalizeAxis(e.gatherAxis,r),o=Nt.normalizeAxis(e.quantizeAxis,r),l=t.slice(0);l.splice(a,1,...s);let c=Nt.size(l),u=n[2].dataType,f=n[0].dataType===22,d=[{type:12,data:c},{type:12,data:o},{type:12,data:a},{type:12,data:e.blockSize},...as(...n.map((p,g)=>p.dims),l)],h=p=>{let g=qt("data",n[0].dataType,n[0].dims.length),b=qt("inputIndices",n[1].dataType,n[1].dims.length),v=qt("scales",n[2].dataType,n[2].dims.length),w=n.length>3?qt("zeroPoint",n[3].dataType,n[3].dims.length):void 0,x=Kn("output",u,l.length),S=[g,b,v];w&&S.push(w);let C=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${p.registerUniforms(C).declareVariables(...S,x)}
        ${p.mainStart()}
        let output_indices = ${x.offsetToIndices("global_idx")};
        var indices_indices = ${b.type.indices}(0);
        ${s.length>1?`
          for (var i: u32 = 0; i < ${s.length}; i++) {
            let index = ${x.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${b.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${x.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${g.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${x.indicesGet("output_indices","i")};
          ${g.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${b.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${t[a]};
        }
        ${g.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${l.length}; i++) {
          let index = ${x.indicesGet("output_indices",`i + ${s.length} - 1`)};
          ${g.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${g.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${g.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${f?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${v.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${v.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${v.getByIndices("scale_indices")};
        ${w?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${w.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${w.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${f?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${fu(u)}(quantized_data - zero_point) * scale;
        ${x.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${e.cacheKey};${n.filter((p,g)=>g!==1).map(p=>p.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:n.length},(p,g)=>"rank")},getRunData:()=>({outputs:[{dims:l,dataType:u}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:d}),getShaderSource:h}},lpe=(n,e)=>{let t=n.inputs;GK(t,e),n.compute(HK(n.inputs,e))},cpe=n=>hi({blockSize:n.blockSize,gatherAxis:n.gatherAxis,quantizeAxis:n.quantizeAxis})}),qK,YK,upe,fpe,yst=pn(()=>{Ns(),Bs(),mo(),Hs(),qK=n=>{if(!n||n.length!==2)throw new Error("GatherElements requires 2 inputs.");if(n[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(n[0].dims.length!==n[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},YK=(n,e)=>{let t=n[0].dims,s=n[0].dataType,r=t.length,a=n[1].dims,o=n[1].dataType,l=Nt.normalizeAxis(e.axis,r),c=t[l],u=a.slice(0),f=Nt.size(u),d=qt("input",s,r),h=qt("indicesInput",o,a.length),p=Kn("output",s,u.length),g=[{type:12,data:f},{type:6,data:c},{type:12,data:l}];return g.push(...as(t,a,u)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:u,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:g}),getShaderSource:b=>`
      ${b.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(d,h,p)}
      ${b.mainStart()}
      ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${p.offsetToIndices("global_idx")};

      var idx = ${h.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${d.type.indices}(outputIndices);
      ${d.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${d.getByIndices("inputIndices")};

      ${p.setByOffset("global_idx","value")};
  }`}},upe=n=>hi({axis:n.axis}),fpe=(n,e)=>{let t=n.inputs;qK(t),n.compute(YK(n.inputs,e))}}),KK,XK,dpe,hpe,bst=pn(()=>{Ns(),Bs(),Hs(),KK=n=>{if(!n)throw new Error("Input is missing");if(n.length<2||n.length>3)throw new Error("Invaid input number.");if(n.length===3&&n[2].dims.length>2)throw new Error("Invalid input shape of C");if(n[0].dataType!==n[1].dataType||n.length===3&&n[0].dataType!==n[2].dataType)throw new Error("Input types are mismatched")},XK=(n,e)=>{let t=n[0].dims.slice(),s=n[1].dims.slice(),[r,a,o]=ude.getShapeOfGemmResult(t,e.transA,s,e.transB,n.length===3?n[2].dims:void 0),l=[r,a];if(!l)throw new Error("Can't use gemm on the given tensors");let c=16,u=Math.ceil(a/c),f=Math.ceil(r/c),d=!0,h=Nt.size(l),p=[{type:12,data:d?u:h},{type:12,data:r},{type:12,data:a},{type:12,data:o},{type:1,data:e.alpha},{type:1,data:e.beta}],g=["type","type"];n.length===3&&(p.push(...as(n[2].dims)),g.push("rank")),p.push(...as(l));let b=w=>{let x="";e.transA&&e.transB?x="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":e.transA&&!e.transB?x="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!e.transA&&e.transB?x="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!e.transA&&!e.transB&&(x="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let S=e.alpha===1?"":"value *= uniforms.alpha;",C=qt("a",n[0].dataType,n[0].dims),M=qt("b",n[1].dataType,n[1].dims),k=C.type.value,E=null,I=[C,M];n.length===3&&(E=qt("c",n[2].dataType,n[2].dims.length),I.push(E));let A=Kn("output",n[0].dataType,l.length);I.push(A);let D=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${w.registerUniforms(D).declareVariables(...I)}

  ${w.mainStart()}
    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${k}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${x}
    }

    ${S}
    ${E!=null?`let cOffset = ${E.broadcastedIndicesToOffset("vec2(m, n)",A)}; value += ${k}(uniforms.beta) * ${E.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},v=w=>{let x=qt("a",n[0].dataType,n[0].dims),S=qt("b",n[1].dataType,n[1].dims),C=null,M=[x,S];n.length===3&&(C=qt("c",n[2].dataType,n[2].dims.length),M.push(C));let k=Kn("output",n[0].dataType,l.length);M.push(k);let E=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],I="",A="";e.transA&&e.transB?(A=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${x.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):e.transA&&!e.transB?(A=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${x.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!e.transA&&e.transB?(A=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${x.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!e.transA&&!e.transB&&(A=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${x.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${S.type.value}(0);
      }
      `,I="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let D=e.alpha===1?"":"value *= uniforms.alpha;";return`
  ${w.registerUniforms(E).declareVariables(...M)}
  var<workgroup> tile_a: array<array<${x.type.storage}, ${c}>, ${c}>;
  var<workgroup> tile_b: array<array<${S.type.storage}, ${c}>, ${c}>;
  ${w.mainStart([c,c,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${c};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${c};
    let num_tiles = (uniforms.K - 1) / ${c} + 1;
    var k_start = 0u;
    var value = ${k.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${A}
      k_start = k_start + ${c};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${c}; k++) {
        ${I}
      }
      workgroupBarrier();
    }

    ${D}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${C!=null?`let cOffset = ${C.broadcastedIndicesToOffset("vec2(m, n)",k)}; value += ${k.type.value}(uniforms.beta) * ${C.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return d?{name:"GemmShared",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:l,dataType:n[0].dataType}],dispatchGroup:{x:u*f},programUniforms:p}),getShaderSource:v}:{name:"Gemm",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:l,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:p}),getShaderSource:b}},dpe=n=>{let e=n.transA,t=n.transB,s=n.alpha,r=n.beta;return{transA:e,transB:t,alpha:s,beta:r,cacheKey:`${n.transA};${n.transB};${n.alpha===1}`}},hpe=(n,e)=>{KK(n.inputs),n.compute(XK(n.inputs,e))}}),rm,dg,yy,by,QK,JK,ZK,eX,tX,nX,sX,rX,ppe,mpe,wst=pn(()=>{Ns(),Bs(),mo(),Hs(),[rm,dg,yy,by]=[0,1,2,3],QK=n=>{if(n[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(n[0].dims.length!==n[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(n[0].dims.length-2!==n[1].dims[n[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${n[0].dims.length-2}`);if(n[0].dims[0]!==n[1].dims[0])throw new Error("grid batch size must match input batch size")},JK=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,ZK=n=>`
  fn gs_bicubic_interpolate(p: mat4x4<${n}>, x: f32, y: f32) -> ${n} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${n}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,eX=n=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${n.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,tX=n=>`
  ${n.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,nX=(n,e,t)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${e} {
     var pixel = ${e}(0);
     var indices = vec4<u32>(0);
     indices[${rm}] = batch;
     indices[${dg}] = channel;`+(()=>{switch(t.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${yy}] = u32(r);
            indices[${by}] = u32(c);
          } else {
            return ${e}(0);
          }
        `;case"border":return`
          indices[${yy}] = u32(clamp(r, 0, H - 1));
          indices[${by}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${yy}] = gs_reflect(r, border[1], border[3]);
          indices[${by}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${t.paddingMode} is not supported`)}})()+`
    return ${n.getByIndices("indices")};
  }
`,sX=(n,e,t)=>(()=>{switch(t.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${rm}], indices[${dg}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${rm}], indices[${dg}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${rm}], indices[${dg}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${rm}], indices[${dg}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${rm}], indices[${dg}], border);

          let dx2 = ${e}(f32(x2) - x);
          let dx1 = ${e}(x - f32(x1));
          let dy2 = ${e}(f32(y2) - y);
          let dy1 = ${e}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${e}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${rm}], indices[${dg}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${t.mode} is not supported`)}})()+`${n.setByOffset("global_idx","result")}`,rX=(n,e)=>{let t=qt("x",n[0].dataType,n[0].dims.length),s=[n[1].dims[0],n[1].dims[1],n[1].dims[2]],r=qt("grid",n[1].dataType,s.length,2),a=[n[0].dims[0],n[0].dims[1],n[1].dims[1],n[1].dims[2]];e.format==="NHWC"&&(a=[n[0].dims[0],n[1].dims[1],n[1].dims[2],n[0].dims[3]],[rm,dg,yy,by]=[0,3,1,2]);let o=Kn("output",n[0].dataType,a.length),l=t.type.value,c=Nt.size(a),u=[{type:12,data:c},...as(n[0].dims,s,a)],f=d=>`
  ${d.registerUniform("output_size","u32").declareVariables(t,r,o)}
  ${JK}
  ${ZK(l)}
  ${eX(e)}
  ${tX(e)}
  ${nX(t,l,e)}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${yy}]);
      let W_in = i32(uniforms.x_shape[${by}]);

      ${e.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${o.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${rm}], indices[${yy}], indices[${by}]);
      let nxy = ${r.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${sX(o,l,e)}
  }`;return{name:"GridSample",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:["type","type"]},getRunData:d=>{let h=Nt.size(a);return{outputs:[{dims:a,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:u}},getShaderSource:f}},ppe=(n,e)=>{QK(n.inputs),n.compute(rX(n.inputs,e))},mpe=n=>hi({alignCorners:n.align_corners,mode:n.mode,paddingMode:n.padding_mode,format:n.format})}),Nu,iX,gpe,m$,aX,JS,ype,bpe=pn(()=>{Ns(),Bs(),mo(),SU(),kU(),Hs(),D1(),Nu=(n,e)=>n.length>e&&n[e].dims.length>0?n[e]:void 0,iX=(n,e)=>{let t=n[0],s=Nu(n,1),r=Nu(n,2),a=Nu(n,3),o=Nu(n,4),l=Nu(n,5),c=Nu(n,6),u=Nu(n,7);if(t.dims.length!==3&&t.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let f=t.dims[0],d=t.dims[1],h=t.dims.length===3?t.dims[2]:e.numHeads*t.dims[4],p=d,g=0,b=0,v=Math.floor(h/e.numHeads);if(c&&u&&Nt.size(c.dims)&&Nt.size(u.dims)){if(c.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(c.dims[0]!==f||c.dims[1]!==e.numHeads||c.dims[3]!==v)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(u.dims[0]!==f||u.dims[1]!==e.numHeads||u.dims[3]!==v)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(c.dims[2]!==u.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(u.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');g=c.dims[2],b=c.dims[2]}else if(c&&Nt.size(c.dims)||u&&Nt.size(u.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let w;if(s&&Nt.size(s.dims)>0){if(t.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(s.dims.length<3||s.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(t.dims[0]!==s.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(s.dims.length===3){if(s.dims[2]!==t.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');w=2,p=s.dims[1]}else if(s.dims.length===5){if(s.dims[2]!==e.numHeads||s.dims[3]!==2||s.dims[4]!==v)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(r)throw new Error('Expect "value" be none when "key" has packed kv format.');w=5,p=s.dims[1]}else{if(s.dims[1]!==e.numHeads||s.dims[3]!==v)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');w=0,p=s.dims[2]}}else{if(t.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(t.dims[2]!==e.numHeads||t.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');w=3}if(a&&Nt.size(a.dims)>0){if(a.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(s&&s.dims.length===5&&s.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let x=g+p,S=0;if(o&&Nt.size(o.dims)>0){S=8;let E=o.dims;throw E.length===1?E[0]===f?S=1:E[0]===3*f+2&&(S=3):E.length===2&&E[0]===f&&E[1]===x&&(S=5),S===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let C=!1,M=h;if(r&&Nt.size(r.dims)>0){if(r.dims.length!==3&&r.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(t.dims[0]!==r.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(r.dims.length===3){if(p!==r.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');M=r.dims[2]}else{if(p!==r.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');M=r.dims[1]*r.dims[3],C=!0}}let k=!1;if(o&&Nt.size(o.dims)>0)throw new Error("Key padding mask is not supported");if(l&&Nt.size(l.dims)>0){if(l.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(l.dims[0]!==f||l.dims[1]!==e.numHeads||l.dims[2]!==d||l.dims[3]!==x)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:f,sequenceLength:d,pastSequenceLength:g,kvSequenceLength:p,totalSequenceLength:x,maxSequenceLength:b,inputHiddenSize:0,hiddenSize:h,vHiddenSize:M,headSize:v,vHeadSize:Math.floor(M/e.numHeads),numHeads:e.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:e.maskFilterValue,maskType:S,scale:e.scale,broadcastResPosBias:k,passPastInKv:C,qkvFormat:w}},gpe=n=>hi({...n}),m$=hi({perm:[0,2,1,3]}),aX=(n,e,t,s,r,a,o)=>{let l=[s,r,a],c=Nt.size(l),u=[{type:12,data:c},{type:12,data:o},{type:12,data:a}],f=d=>{let h=Kn("qkv_with_bias",e.dataType,l),p=qt("qkv",e.dataType,l),g=qt("bias",t.dataType,l),b=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${d.registerUniforms(b).declareVariables(p,g,h)}
  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return n.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:l,dataType:e.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:f},{inputs:[e,t],outputs:[-1]})[0]},JS=(n,e,t,s,r,a,o,l)=>{let c=a;if(o&&Nt.size(o.dims)>0){if(s===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return c=aX(n,a,o,e,s,t*r,l),c=c.reshape([e,s,t,r]),t===1||s===1?c:n.compute(wd(c,m$.perm),{inputs:[c],outputs:[-1]})[0]}else return a.dims.length===3&&(c=a.reshape([e,s,t,r])),t===1||s===1?c:n.compute(wd(c,m$.perm),{inputs:[c],outputs:[-1]})[0]},ype=(n,e)=>{let t=iX(n.inputs,e),s=n.inputs[0],r=Nu(n.inputs,1),a=Nu(n.inputs,2),o=Nu(n.inputs,3),l=Nu(n.inputs,4),c=Nu(n.inputs,5),u=Nu(n.inputs,6),f=Nu(n.inputs,7);if(s.dims.length===5)throw new Error("Packed QKV is not implemented");if(r?.dims.length===5)throw new Error("Packed KV is not implemented");let d=r&&a&&r.dims.length===4&&a.dims.length===4,h=JS(n,t.batchSize,t.numHeads,t.sequenceLength,t.headSize,s,o,0);if(d)return JM(n,h,r,a,l,void 0,u,f,c,t);if(!r||!a)throw new Error("key and value must be provided");let p=JS(n,t.batchSize,t.numHeads,t.kvSequenceLength,t.headSize,r,o,t.hiddenSize),g=JS(n,t.batchSize,t.numHeads,t.kvSequenceLength,t.vHeadSize,a,o,2*t.hiddenSize);JM(n,h,p,g,l,void 0,u,f,c,t)}}),oX,lX,cX,uX,O6,wpe,vpe,_pe=pn(()=>{Ns(),Bs(),mo(),Hs(),oX=n=>{if(!n||n.length<1)throw new Error("too few inputs")},lX=(n,e)=>{let t=[],s=e.numOutputs;return n[1].dims[0]>0&&(n[1].getBigInt64Array().forEach(r=>t.push(Number(r))),s=t.length),hi({numOutputs:s,axis:e.axis,splitSizes:t})},cX=n=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${n}u; i += 1u ) {
    if (index < ${Zn("uniforms.size_in_split_axis","i",n)}) {
        return i;
    }
    }
    return ${n}u;
}`,uX=n=>{let e=n.length,t=[];for(let s=0;s<e;++s){let r=n[s].setByIndices("indices","input[global_idx]");e===1?t.push(r):s===0?t.push(`if (output_number == ${s}u) { ${r} }`):s===e-1?t.push(`else { ${r} }`):t.push(`else if (output_number == ${s}) { ${r} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${n[0].type.indices}, global_idx: u32) {
        ${t.join(`
`)}
      }`},O6=(n,e)=>{let t=n[0].dims,s=Nt.size(t),r=n[0].dataType,a=Nt.normalizeAxis(e.axis,t.length),o=new Array(e.numOutputs),l=qt("input",r,t.length),c=new Array(e.numOutputs),u=[],f=[],d=0,h=[{type:12,data:s}];for(let g=0;g<e.numOutputs;g++){d+=e.splitSizes[g],c[g]=d;let b=t.slice();b[a]=e.splitSizes[g],f.push(b),o[g]=Kn(`output${g}`,r,b.length),u.push({dims:f[g],dataType:n[0].dataType})}h.push({type:12,data:c},...as(t,...f));let p=g=>`
  ${g.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",c.length).declareVariables(l,...o)}
  ${cX(c.length)}
  ${uX(o)}

  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${l.offsetToIndices("global_idx")};
    var index = ${l.indicesGet("indices",a)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${Zn("uniforms.size_in_split_axis","output_number - 1u",c.length)};
      ${l.indicesSet("indices",a,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:e.cacheKey,inputDependencies:["rank"]},getShaderSource:p,getRunData:()=>({outputs:u,dispatchGroup:{x:Math.ceil(s/64)},programUniforms:h})}},wpe=(n,e)=>{oX(n.inputs);let t=n.inputs.length===1?e:lX(n.inputs,e);n.compute(O6(n.inputs,t),{inputs:[0]})},vpe=n=>{let e=n.axis,t=n.splitSizes,s=n.numOutputs<0?t.length:n.numOutputs;if(s!==t.length)throw new Error("numOutputs and splitSizes lengh must be equal");return hi({axis:e,numOutputs:s,splitSizes:t})}}),fX,n4,xpe,Cpe=pn(()=>{Ns(),Bs(),mo(),Hs(),fX=(n,e)=>{let[t,s,r,a]=n,{numHeads:o,rotaryEmbeddingDim:l}=e;if(t.dims.length!==3&&t.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${t.dims.length}`);if(!Nt.areEqual(s.dims,[])&&!Nt.areEqual(s.dims,[1])&&s.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${s.dims.length}`);if(r.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${r.dims.length}`);if(a.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${a.dims.length}`);if(!Nt.areEqual(r.dims,a.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(l>0&&o===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let c=t.dims[0],u=t.dims[t.dims.length-2],f=r.dims[0],d=Nt.sizeFromDimension(t.dims,1)/u,h=l===0?r.dims[1]*2:d/o;if(l>h)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(s.dims.length===2){if(c!==s.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${s.dims[0]}`);if(u!==s.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${s.dims[1]}`)}if(h/2!==r.dims[1]&&l/2!==r.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${r.dims[1]}`);if(u>f)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},n4=(n,e)=>{let{interleaved:t,numHeads:s,rotaryEmbeddingDim:r,scale:a}=e,o=n[0].dims[0],l=Nt.sizeFromDimension(n[0].dims,1),c=n[0].dims[n[0].dims.length-2],u=l/c,f=n[2].dims[1],d=r===0?f*2:u/s,h=new Array(o,c,u/d,d-f),p=Nt.computeStrides(h),g=[{type:1,data:a},{type:12,data:h},{type:12,data:p},...n[0].dims.length===3?new Array({type:12,data:[l,u,d,1]}):[],...n[0].dims.length===4?new Array({type:12,data:[l,d,c*d,1]}):[],...as(n[0].dims,n[1].dims,n[2].dims,n[3].dims,n[0].dims)],b=v=>{let w=qt("input",n[0].dataType,n[0].dims.length),x=qt("position_ids",n[1].dataType,n[1].dims.length),S=qt("cos_cache",n[2].dataType,n[2].dims.length),C=qt("sin_cache",n[3].dataType,n[3].dims.length),M=Kn("output",n[0].dataType,n[0].dims.length);return v.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:h.length},{name:"global_strides",type:"u32",length:p.length},{name:"input_output_strides",type:"u32",length:p.length}]),`
        ${v.declareVariables(w,x,S,C,M)}

        ${v.mainStart(_2)}
          let half_rotary_emb_dim = uniforms.${S.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${v.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${x.broadcastedIndicesToOffset("bsnh.xy",Kn("",x.type.tensor,2))};
            let position_id =
                u32(${x.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${t});
            let j = i + select(half_rotary_emb_dim, 1, ${t});
            let re = ${w.getByOffset("i")} * ${S.get("position_id","bsnh[3]")} -
                ${w.getByOffset("j")} * ${C.get("position_id","bsnh[3]")};
            ${M.setByOffset("i","re")}
            let im = ${w.getByOffset("i")} * ${C.get("position_id","bsnh[3]")} +
                ${w.getByOffset("j")} * ${S.get("position_id","bsnh[3]")};
            ${M.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${M.setByOffset("k",w.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:hi({interleaved:t}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:b,getRunData:()=>({outputs:[{dims:n[0].dims,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(Nt.size(h)/_2)},programUniforms:g})}},xpe=(n,e)=>{fX(n.inputs,e),n.compute(n4(n.inputs,e))}}),dX,hX,g$,pX,Spe,vst=pn(()=>{mo(),Ns(),kU(),bpe(),_pe(),D1(),Cpe(),Hs(),dX=(n,e)=>{if(e.doRotary&&n.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let t=n[0],s=n[1],r=n[2],a=n[3],o=n[4];if(e.doRotary!==0&&n.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(e.localWindowSize!==-1)throw new Error("Local attention is not supported");if(e.softcap!==0)throw new Error("Softcap is not supported");if(e.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(e.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(t.dims.length!==3&&t.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let l=!1,c=t.dims[0],u=t.dims[1],f=t.dims.length===3?l?t.dims[2]/3:t.dims[2]:e.numHeads*t.dims[4],d=u,h=0,p=!s||s.dims.length===0,g=Math.floor(p?f/(e.numHeads+2*e.kvNumHeads):f/e.numHeads);p&&(f=g*e.numHeads);let b=a&&a.dims.length!==0,v=o&&o.dims.length!==0;if(b&&a.dims.length===4&&a.dims[0]===c&&a.dims[1]!==e.kvNumHeads&&a.dims[2]===e.kvNumHeads&&a.dims[3]===g)throw new Error("BSNH pastKey/pastValue is not supported");if(b&&v){if(a.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(o.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');h=a.dims[2]}else if(b||v)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let w=1;if(s&&s.dims.length>0){if(t.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(s.dims.length<3||s.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(t.dims[0]!==s.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(s.dims.length===3){if(t.dims[2]%s.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');d=s.dims[1]}else if(s.dims.length===5){if(s.dims[2]!==e.numHeads||s.dims[3]!==2||s.dims[4]!==g)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(r)throw new Error('Expect "value" be none when "key" has packed kv format.');d=s.dims[1]}else{if(s.dims[1]!==e.numHeads||s.dims[3]!==g)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');d=s.dims[2]}}else{if(t.dims.length!==3&&t.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(t.dims.length===5&&(t.dims[2]!==e.numHeads||t.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');w=3}let x=0,S=!1,C=e.kvNumHeads?g*e.kvNumHeads:f;if(r&&r.dims.length>0){if(r.dims.length!==3&&r.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(t.dims[0]!==r.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(r.dims.length===3){if(d!==r.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');C=r.dims[2]}else{if(d!==r.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');C=r.dims[1]*r.dims[3],S=!0}}let M=n.length>4?n[5]:void 0;if(M&&M.dims.length!==1&&M.dims[0]!==c)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:c,sequenceLength:u,pastSequenceLength:h,kvSequenceLength:d,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:f,vHiddenSize:C,headSize:g,vHeadSize:Math.floor(C/e.kvNumHeads),numHeads:e.numHeads,kvNumHeads:e.kvNumHeads,nReps:e.numHeads/e.kvNumHeads,pastPresentShareBuffer:!1,maskType:x,scale:e.scale,broadcastResPosBias:!1,passPastInKv:S,qkvFormat:w}},hX=hi({perm:[0,2,1,3]}),g$=(n,e,t)=>{let s=e,r=t.kvNumHeads;return e.dims.length===3&&t.kvSequenceLength!==0&&(s=e.reshape([t.batchSize,t.kvSequenceLength,r,t.headSize]),s=n.compute(wd(s,hX.perm),{inputs:[s],outputs:[-1]})[0]),s},pX=(n,e,t,s)=>{let r=7,a=["type","type"],o=[n*e],l=n*e,c=[{type:12,data:l},{type:12,data:e},{type:12,data:n}],u=f=>{let d=qt("seq_lens",t.dataType,t.dims),h=qt("total_seq_lens",s.dataType,s.dims),p=Kn("pos_ids",r,o),g=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${f.registerUniforms(g).declareVariables(d,h,p)}
  ${f.mainStart()}
    ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${h.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${d.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${p.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${p.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${p.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${n};${e}`,inputDependencies:a},getRunData:()=>({outputs:[{dims:o,dataType:r}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c}),getShaderSource:u}},Spe=(n,e)=>{let t=dX(n.inputs,e);if(n.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(n.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let s=n.inputs[0],r=n.inputs[1]&&n.inputs[1].dims.length>0?n.inputs[1]:void 0,a=n.inputs[2]&&n.inputs[2].dims.length>0?n.inputs[2]:void 0,o=n.inputs[3]&&n.inputs[3].dims.length!==0?n.inputs[3]:void 0,l=n.inputs[4]&&n.inputs[4].dims.length!==0?n.inputs[4]:void 0,c=n.inputs.length>4?n.inputs[5]:void 0,u=n.inputs.length>5?n.inputs[6]:void 0,f=t.kvNumHeads?t.kvNumHeads:t.numHeads,d=hi({axis:2,numOutputs:3,splitSizes:[t.numHeads*t.headSize,f*t.headSize,f*t.headSize]}),[h,p,g]=!r&&!a?n.compute(O6([s],d),{inputs:[s],outputs:[-1,-1,-1]}):[s,r,a],b,v;if(e.doRotary){let C=n.compute(pX(t.batchSize,t.sequenceLength,c,u),{inputs:[c,u],outputs:[-1]})[0],M=n.inputs[7],k=n.inputs[8],E=hi({interleaved:e.rotaryInterleaved!==0,numHeads:t.numHeads,rotaryEmbeddingDim:0,scale:e.scale}),I=[h,C,M,k],A=[-1];b=n.compute(n4(I,E),{inputs:I,outputs:A})[0],I.splice(0,1,p);let D=hi({interleaved:e.rotaryInterleaved!==0,numHeads:t.kvNumHeads,rotaryEmbeddingDim:0,scale:e.scale});v=n.compute(n4(I,D),{inputs:I,outputs:A})[0]}let w=JS(n,t.batchSize,t.numHeads,t.sequenceLength,t.headSize,e.doRotary?b:h,void 0,0),x=g$(n,e.doRotary?v:p,t),S=g$(n,g,t);JM(n,w,x,S,void 0,void 0,o,l,void 0,t,c,u)}}),y$,mX,gX,Mpe,_st=pn(()=>{Ns(),Bs(),D1(),Hs(),y$=(n,e,t,s,r,a,o,l)=>{let c=Za(a),u=c===1?"f32":`vec${c}f`,f=c===1?"vec2f":`mat2x${c}f`,d=r*o,h=64;d===1&&(h=256);let p=[r,o,a/c],g=[r,o,2],b=["rank","type","type"],v=[];v.push(...as(p,g));let w=x=>{let S=qt("x",e.dataType,3,c),C=qt("scale",t.dataType,t.dims),M=qt("bias",s.dataType,s.dims),k=Kn("output",1,3,2),E=[S,C,M,k];return`
  var<workgroup> workgroup_shared : array<${f}, ${h}>;
  const workgroup_size = ${h}u;
  ${x.declareVariables(...E)}
  ${x.mainStart(h)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${u}(0);
    var squared_sum = ${u}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${u}(${S.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${f}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${w1("workgroup_shared[0][0]",c)} / f32(hight * ${c});
      let squared_sum_final = ${w1("workgroup_shared[0][1]",c)} / f32(hight * ${c});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${l}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return n.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${c};${l};${h}`,inputDependencies:b},getRunData:()=>({outputs:[{dims:g,dataType:1}],dispatchGroup:{x:d},programUniforms:v}),getShaderSource:w},{inputs:[e,t,s],outputs:[-1]})[0]},mX=(n,e,t)=>{let s=e[0].dims,r=s,a=2,o=s[0],l=s[1],c=Nt.sizeFromDimension(s,a),u=Za(c),f=Nt.size(r)/u,d=y$(n,e[0],e[1],e[2],o,c,l,t.epsilon),h=[o,l,c/u],p=[o,l],g=["type","none"],b=v=>{let w=qt("x",e[0].dataType,h.length,u),x=qt("scale_shift",1,p.length,2),S=Kn("output",e[0].dataType,h.length,u),C=[w,x,S];return`
  ${v.registerUniform("output_size","u32").declareVariables(...C)}
  ${v.mainStart()}
  ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${S.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${x.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${w.getByOffset("global_idx")} * ${S.type.value}(scale_shift.x) + ${S.type.value}(scale_shift.y);
      ${S.setByOffset("global_idx","value")};
  }`};n.compute({name:"InstanceNormalization",shaderCache:{hint:`${u}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:[{type:12,data:f},...as(h,p,h)]}),getShaderSource:b},{inputs:[e[0],d]})},gX=(n,e,t)=>{let s=e[0].dims,r=s,a=s[0],o=s[s.length-1],l=Nt.sizeFromDimension(s,1)/o,c=Za(o),u=Nt.size(r)/c,f=[{type:12,data:l},{type:12,data:Math.floor(o/c)}],d=["type","type"],h=!1,p=[0,s.length-1];for(let w=0;w<s.length-2;w++)h=h||s[w+1]!==1,p.push(w+1);h=h&&s[s.length-1]!==1;let g=h?n.compute(wd(n.inputs[0],p),{inputs:[n.inputs[0]],outputs:[-1]})[0]:n.inputs[0].reshape(Array.from({length:s.length},(w,x)=>s[p[x]])),b=y$(n,g,e[1],e[2],a,l,o,t.epsilon),v=w=>{let x=zl(e[0].dataType),S=c===1?"vec2f":`mat${c}x2f`,C=E=>{let I=E===0?"x":"y",A=c===1?"f32":`vec${c}f`;switch(c){case 1:return`${x}(${A}(scale.${I}))`;case 2:return`vec2<${x}>(${A}(scale[0].${I}, scale[1].${I}))`;case 4:return`vec4<${x}>(${A}(scale[0].${I}, scale[1].${I}, scale[2].${I}, scale[3].${I}))`;default:throw new Error(`Not supported compoents ${c}`)}},M=qt("input",e[0].dataType,e[0].dims,c),k=Kn("output",e[0].dataType,r,c);return`
  @group(0) @binding(0) var<storage, read> input : array<${M.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${S}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${k.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${w.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${C(0)}, ${C(1)});
  }`};n.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${c}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:f}),getShaderSource:v},{inputs:[e[0],b]})},Mpe=(n,e)=>{e.format==="NHWC"?gX(n,n.inputs,e):mX(n,n.inputs,e)}}),yX,bX,Tpe,xst=pn(()=>{Ns(),Bs(),Hs(),yX=n=>{if(!n||n.length<2)throw new Error("layerNorm requires at least 2 inputs.")},bX=(n,e,t)=>{let s=e.simplified,r=n[0].dims,a=n[1],o=!s&&n[2],l=r,c=Nt.normalizeAxis(e.axis,r.length),u=Nt.sizeToDimension(r,c),f=Nt.sizeFromDimension(r,c),d=Nt.size(a.dims),h=o?Nt.size(o.dims):0;if(d!==f||o&&h!==f)throw new Error(`Size of X.shape()[axis:] == ${f}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${d} and bias size of ${h}`);let p=[];for(let M=0;M<r.length;++M)M<c?p.push(r[M]):p.push(1);let g=Za(f),b=["type","type"],v=[{type:12,data:u},{type:1,data:f},{type:12,data:Math.floor(f/g)},{type:1,data:e.epsilon}];o&&b.push("type");let w=t>1,x=t>2,S=M=>{let k=zl(n[0].dataType),E=[qt("x",n[0].dataType,n[0].dims,g),qt("scale",a.dataType,a.dims,g)];o&&E.push(qt("bias",o.dataType,o.dims,g)),E.push(Kn("output",n[0].dataType,l,g)),w&&E.push(Kn("mean_data_output",1,p)),x&&E.push(Kn("inv_std_output",1,p));let I=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${M.registerUniforms(I).declareVariables(...E)}
  ${M.mainStart()}
    ${M.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${M6("f32",g)};
    var mean_square_vector = ${M6("f32",g)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Rv(k,g,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${w1("mean_vector",g)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${w1("mean_square_vector",g)} / uniforms.norm_size ${s?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Rv(k,g,"x[j + offset]")};
      let f32scale = ${Rv(k,g,"scale[j]")};
      output[j + offset] = ${E[0].type.value}((f32input ${s?"":"- mean"}) * inv_std_dev * f32scale
        ${o?`+ ${Rv(k,g,"bias[j]")}`:""}
      );
    }

    ${w?"mean_data_output[global_idx] = mean":""};
    ${x?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},C=[{dims:l,dataType:n[0].dataType}];return w&&C.push({dims:p,dataType:1}),x&&C.push({dims:p,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${g};${t};${s}`,inputDependencies:b},getRunData:()=>({outputs:C,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:v}),getShaderSource:S}},Tpe=(n,e)=>{yX(n.inputs),n.compute(bX(n.inputs,e,n.outputCount))}}),wX,kpe,Cst=pn(()=>{Bs(),NU(),DU(),wX=n=>{if(!n||n.length!==2)throw new Error("MatMul requires 2 inputs.");if(n[0].dims[n[0].dims.length-1]!==n[1].dims[n[1].dims.length-2])throw new Error("shared dimension does not match.")},kpe=n=>{wX(n.inputs);let e=v2.calcShape(n.inputs[0].dims,n.inputs[1].dims,!0);if(!e)throw new Error("Can't use matmul on the given tensors");let t=e[e.length-1],s=n.inputs[0].dims[n.inputs[0].dims.length-1];if(t<8&&s<8)n.compute(LU(n.inputs,{activation:""},e));else{let r=e[e.length-2],a=Nt.size(n.inputs[0].dims.slice(0,-2)),o=Nt.size(n.inputs[1].dims.slice(0,-2));if(a!==1&&r===1&&o===1){let l=n.inputs[0].reshape([1,a,s]),c=n.inputs[1].reshape([1,s,t]),u=[1,a,t],f=[l,c];n.compute(t4(f,{activation:""},e,u),{inputs:f})}else n.compute(t4(n.inputs,{activation:""},e))}}}),vX,_X,xX,Epe,Ipe,Sst=pn(()=>{Ns(),Bs(),mo(),Hs(),vX=(n,e)=>{if(n.length<3||n.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let t=n[0],s=t.dims.length;if(t.dims[s-1]!==e.k)throw new Error("The last dim of input shape does not match the k value");let r=Math.floor((e.k+e.blockSize-1)/e.blockSize),a=e.blockSize/8*e.bits,o=n[1];if(!Nt.areEqual(o.dims,[e.n,r,a]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let l=n[2].dims;if(Nt.size(l)!==e.n*r)throw new Error("scales input size error.");if(n.length===4){let c=n[3].dims,u=e.bits>4?e.n*r:e.n*Math.floor((r+1)/2);if(Nt.size(c)!==u)throw new Error("zeroPoints input size error.")}},_X=(n,e)=>{let t=n[0].dims,s=t.length,r=t[s-2],a=e.k,o=e.n,l=t.slice(0,s-2),c=Nt.size(l),u=n[1].dims[2]/4,f=n[0].dataType,d=Za(e.k),h=Za(u),p=Za(o),g=l.concat([r,o]),b=r>1&&o/p%2===0?2:1,v=Nt.size(g)/p/b,w=64,x=[],S=[c,r,a/d],C=Nt.convertShape(n[1].dims).slice();C.splice(-1,1,u/h),x.push(...as(S)),x.push(...as(C)),x.push(...as(n[2].dims)),n.length===4&&x.push(...as(Nt.convertShape(n[3].dims)));let M=[c,r,o/p];x.push(...as(M));let k=E=>{let I=S.length,A=qt("a",n[0].dataType,I,d),D=qt("b",12,C.length,h),L=qt("scales",n[2].dataType,n[2].dims.length),P=[A,D,L],j=n.length===4?qt("zero_points",12,n[3].dims.length):void 0;j&&P.push(j);let G=M.length,Q=Kn("output",n[0].dataType,G,p),q=zl(n[0].dataType),te=(()=>{switch(d){case 1:return`array<${q}, 8>`;case 2:return`mat4x2<${q}>`;case 4:return`mat2x4<${q}>`;default:throw new Error(`${d}-component is not supported.`)}})(),Z=()=>{let H=`
          // reuse a data
            var input_offset = ${A.indicesToOffset(`${A.type.indices}(batch, row, word_offset)`)};
            var a_data: ${te};
            for (var j: u32 = 0; j < ${8/d}; j++) {
              a_data[j] = ${A.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let R=0;R<p*b;R++)H+=`
            b_value = ${h===1?`b${R}_data`:`b${R}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${te}(${Array.from({length:4},(B,W)=>`${q}(b_value_lower[${W}]), ${q}(b_value_upper[${W}])`).join(", ")});
            b_dequantized_values = ${d===1?`${te}(${Array.from({length:8},(B,W)=>`(b_quantized_values[${W}] - ${j?`zero_point${R}`:"zero_point"}) * scale${R}`).join(", ")});`:`(b_quantized_values - ${te}(${Array(8).fill(`${j?`zero_point${R}`:"zero_point"}`).join(",")})) * scale${R};`};
            workgroup_shared[local_id.x * ${b} + ${Math.floor(R/p)}]${p>1?`[${R%p}]`:""} += ${Array.from({length:8/d},(B,W)=>`${d===1?`a_data[${W}] * b_dequantized_values[${W}]`:`dot(a_data[${W}], b_dequantized_values[${W}])`}`).join(" + ")};
          `;return H},ne=()=>{let H=`
            var col_index = col * ${p};
            ${j?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${q}(8);`}
            `;for(let R=0;R<p*b;R++)H+=`
            let scale${R} = ${L.getByOffset("col_index * nBlocksPerCol + block")};
            ${j?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${j.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${R} = ${q}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return H},le=()=>{let H=`col_index = col * ${p};`;for(let R=0;R<p*b;R++)H+=`
            let b${R}_data = ${D.getByIndices(`${D.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return H+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${te};
            var b_dequantized_values: ${te};`,H};return`
        var<workgroup> workgroup_shared: array<${Q.type.value}, ${b*w}>;
        ${E.declareVariables(...P,Q)}
        ${E.mainStart([w,1,1])}
          let output_indices = ${Q.offsetToIndices(`(global_idx / ${w}) * ${b}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${w}) {
            //process one block
            var word_offset: u32 = block * ${e.blockSize/d};
            ${ne()}
            for (var word: u32 = 0; word < ${u}; word += ${h}) {
              ${le()}
              for (var i: u32 = 0; i < ${h}; i++) {
                ${Z()}
                word_offset += ${8/d};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${b}) {
            var output_value: ${Q.type.value} = ${Q.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${w}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${b};
            }
            ${Q.setByIndices(`${Q.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${e.blockSize};${e.bits};${d};${h};${p};${b};${w}`,inputDependencies:Array(n.length).fill("rank")},getRunData:()=>({outputs:[{dims:g,dataType:f}],dispatchGroup:{x:v},programUniforms:x}),getShaderSource:k}},xX=(n,e)=>{let t=n[0].dims,s=t.length,r=t[s-2],a=e.k,o=e.n,l=t.slice(0,s-2),c=Nt.size(l),u=n[1].dims[2]/4,f=n[0].dataType,d=Za(e.k),h=Za(u),p=l.concat([r,o]),g=128,b=o%8===0?8:o%4===0?4:1,v=g/b,w=v*h*8,x=w/d,S=w/e.blockSize,C=Nt.size(p)/b,M=[],k=[c,r,a/d],E=Nt.convertShape(n[1].dims).slice();E.splice(-1,1,u/h),M.push(...as(k)),M.push(...as(E)),M.push(...as(n[2].dims)),n.length===4&&M.push(...as(Nt.convertShape(n[3].dims)));let I=[c,r,o];M.push(...as(I));let A=D=>{let L=k.length,P=qt("a",n[0].dataType,L,d),j=qt("b",12,E.length,h),G=qt("scales",n[2].dataType,n[2].dims.length),Q=[P,j,G],q=n.length===4?qt("zero_points",12,n[3].dims.length):void 0;q&&Q.push(q);let te=I.length,Z=Kn("output",n[0].dataType,te),ne=zl(n[0].dataType),le=()=>{switch(d){case 1:return`
          let a_data0 = vec4<${ne}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${ne}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${ne}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${ne}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${d}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${P.type.value}, ${x}>;
        var<workgroup> inter_results: array<array<${Z.type.value}, ${v}>, ${b}>;
        ${D.declareVariables(...Q,Z)}
        ${D.mainStart([v,b,1])}
          let output_indices = ${Z.offsetToIndices(`workgroup_index * ${b}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${S} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${x};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${x}; a_offset += ${g})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${P.getByIndices(`${P.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${P.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${S} + local_id.x;
            ${q?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${q.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${ne}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${ne}(8);`}
            let scale = ${G.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${j.getByIndices(`${j.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${e.blockSize/d};
            for (var i: u32 = 0; i < ${h}; i++) {
              ${le()}
              let b_value = ${h===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${ne}>(${Array.from({length:4},(H,R)=>`${ne}(b_value_lower[${R}]), ${ne}(b_value_upper[${R}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${ne}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(H,R)=>`${`dot(a_data${R}, b_dequantized_values[${R}])`}`).join(" + ")};
              word_offset += ${8/d};
            }
            workgroupBarrier();
          }

          if (local_idx < ${b}) {
            var output_value: ${Z.type.value} = ${Z.type.value}(0);
            for (var b = 0u; b < ${v}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${Z.setByIndices(`${Z.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${e.blockSize};${d};${h};${v};${b}`,inputDependencies:Array(n.length).fill("rank")},getRunData:()=>({outputs:[{dims:p,dataType:f}],dispatchGroup:{x:C},programUniforms:M}),getShaderSource:A}},Epe=(n,e)=>{vX(n.inputs,e),e.blockSize===32&&n.adapterInfo.isVendor("intel")&&n.adapterInfo.isArchitecture("gen-12lp")?n.compute(xX(n.inputs,e)):n.compute(_X(n.inputs,e))},Ipe=n=>hi(n)}),CX,SX,MX,TX,kX,EX,IX,AX,Ape,Mst=pn(()=>{Ns(),Bs(),Hs(),CX=n=>{if(!n||n.length<1)throw new Error("Too few inputs");if(n[0].dataType!==1&&n[0].dataType!==10)throw new Error("Input type must be float or float16.");if(n.length>=2){let e=n[0].dims.length*2===n[1].dims[0];if(n.length===4&&(e=n[3].dims[0]*2===n[1].dims[0]),!e)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},SX=(n,e,t)=>{let s="";for(let r=e-1;r>=0;--r)s+=`
            k = i32(${n.indicesGet("indices",r)}) - ${Zn("uniforms.pads",r,t)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${Zn("uniforms.x_shape",r,e)})) {
              break;
            }
            offset += k * i32(${Zn("uniforms.x_strides",r,e)});
        `;return`
          value = ${n.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${s}
            value = x[offset];
          }
      `},MX=(n,e,t)=>{let s="";for(let r=e-1;r>=0;--r)s+=`
                k = i32(${n.indicesGet("indices",r)}) - ${Zn("uniforms.pads",r,t)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${Zn("uniforms.x_shape",r,e)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${Zn("uniforms.x_shape",r,e)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${Zn("uniforms.x_strides",r,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${s}
              value = x[offset];
          `},TX=(n,e,t)=>{let s="";for(let r=e-1;r>=0;--r)s+=`
                k = i32(${n.indicesGet("indices",r)}) - ${Zn("uniforms.pads",r,t)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${Zn("uniforms.x_shape",r,e)})) {
                  k = i32(${Zn("uniforms.x_shape",r,e)}) - 1;
                }
                offset += k * i32(${Zn("uniforms.x_strides",r,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${s}
              value = x[offset];
          `},kX=(n,e,t)=>{let s="";for(let r=e-1;r>=0;--r)s+=`
                k = i32(${n.indicesGet("indices",r)}) - ${Zn("uniforms.pads",r,t)};
                if (k < 0)  {
                  k += i32(${Zn("uniforms.x_shape",r,e)}]);
                }
                if (k >= i32(${Zn("uniforms.x_shape",r,e)})) {
                  k -= i32(${Zn("uniforms.x_shape",r,e)});
                }
                offset += k * i32(${Zn("uniforms.x_strides",r,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${s}
              value = x[offset];
          `},EX=(n,e,t)=>{switch(t.mode){case 0:return SX(n,e,t.pads.length);case 1:return MX(n,e,t.pads.length);case 2:return TX(n,e,t.pads.length);case 3:return kX(n,e,t.pads.length);default:throw new Error("Invalid mode")}},IX=(n,e)=>{let t=Nt.padShape(n[0].dims.slice(),e.pads),s=n[0].dims,r=Nt.size(t),a=[{type:12,data:r},{type:6,data:e.pads}],o=n.length>=3&&n[2].data;e.mode===0&&a.push({type:o?n[2].dataType:1,data:e.value}),a.push(...as(n[0].dims,t));let l=["rank"],c=u=>{let f=Kn("output",n[0].dataType,t.length),d=qt("x",n[0].dataType,s.length),h=d.type.value,p=EX(f,s.length,e),g=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:e.pads.length}];return e.mode===0&&g.push({name:"constant_value",type:o?h:"f32"}),`
            ${u.registerUniforms(g).declareVariables(d,f)}
            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${f.offsetToIndices("global_idx")};

            var value = ${h}(0);
            ${p}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${e.mode}${o}`,inputDependencies:l},getRunData:()=>({outputs:[{dims:t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(Nt.size(t)/64)},programUniforms:a}),getShaderSource:c}},AX=(n,e)=>{if(n.length>1){let t=n[1].getBigInt64Array(),s=n.length>=3&&n[2].data?n[2].dataType===10?n[2].getUint16Array()[0]:n[2].getFloat32Array()[0]:0,r=n[0].dims.length,a=new Int32Array(2*r).fill(0);if(n.length>=4){let l=n[3].getBigInt64Array();for(let c=0;c<l.length;c++)a[Number(l[c])]=Number(t[c]),a[Number(l[c])+r]=Number(t[c+l.length])}else t.forEach((l,c)=>a[Number(c)]=Number(l));let o=[];return a.forEach(l=>o.push(l)),{mode:e.mode,value:s,pads:o}}else return e},Ape=(n,e)=>{CX(n.inputs);let t=AX(n.inputs,e);n.compute(IX(n.inputs,t),{inputs:[0]})}}),sS,b$,w$,v$,_$,LX,NX,x$,C$,Lpe,Npe,S$,Dpe,Ope,M$,Ppe,$pe,jpe,Rpe,Tst=pn(()=>{kp(),Ns(),Bs(),Hs(),sS=n=>{if(pa.webgpu.validateInputContent&&(!n||n.length!==1))throw new Error("Pool ops requires 1 input.")},b$=(n,e,t)=>{let s=e.format==="NHWC",r=n.dims.slice();s&&r.splice(1,0,r.pop());let a=Object.hasOwnProperty.call(e,"dilations"),o=e.kernelShape.slice(),l=e.strides.slice(),c=a?e.dilations.slice():[],u=e.pads.slice();ZN.adjustPoolAttributes(t,r,o,l,c,u);let f=ZN.computePoolOutputShape(t,r,l,c,o,u,e.autoPad),d=Object.assign({},e);a?Object.assign(d,{kernelShape:o,strides:l,pads:u,dilations:c,cacheKey:e.cacheKey}):Object.assign(d,{kernelShape:o,strides:l,pads:u,cacheKey:e.cacheKey});let h=f.slice();return h.push(h.splice(1,1)[0]),[d,s?h:f]},w$=(n,e)=>{let t=e.format==="NHWC",s=Nt.size(n),r=Nt.size(e.kernelShape),a=[{type:12,data:s},{type:12,data:r}],o=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(e.kernelShape.length<=2){let l=e.kernelShape[e.kernelShape.length-1],c=e.strides[e.strides.length-1],u=e.pads[e.pads.length/2-1],f=e.pads[e.pads.length-1],d=!!(u+f);a.push({type:12,data:l},{type:12,data:c},{type:12,data:u},{type:12,data:f}),o.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let h=!1;if(e.kernelShape.length===2){let p=e.kernelShape[e.kernelShape.length-2],g=e.strides[e.strides.length-2],b=e.pads[e.pads.length/2-2],v=e.pads[e.pads.length-2];h=!!(b+v),a.push({type:12,data:p},{type:12,data:g},{type:12,data:b},{type:12,data:v}),o.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[a,o,!0,d,h]}else{if(t)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let l=Nt.computeStrides(e.kernelShape);a.push({type:12,data:l},{type:12,data:e.pads},{type:12,data:e.strides}),o.push({name:"kernelStrides",type:"u32",length:l.length},{name:"pads",type:"u32",length:e.pads.length},{name:"strides",type:"u32",length:e.strides.length});let c=e.pads.reduce((u,f)=>u+f);return[a,o,!!c,!1,!1]}},v$=(n,e,t,s,r,a,o,l,c,u,f,d)=>{let h=r.format==="NHWC",p=e.type.value,g=Kn("output",e.type.tensor,s);if(r.kernelShape.length<=2){let b="",v="",w="",x=t-(h?2:1);if(f?b=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${x}] = indices[${x}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${x}] < 0 || xIndices[${x}]
                      >= uniforms.x_shape[${x}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${e.indicesToOffset("xIndices")}];
                  ${a}
                }`:b=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${x}] = indices[${x}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${e.indicesToOffset("xIndices")}];
                  ${a}
                }`,r.kernelShape.length===2){let S=t-(h?3:2);d?v=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${S}] = indices[${S}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${S}] < 0 || xIndices[${S}] >= uniforms.x_shape[${S}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:v=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${S}] = indices[${S}] * uniforms.sh - uniforms.phStart + j;
                `,w=`
              }
            `}return`
            ${n.registerUniforms(c).declareVariables(e,g)}

            ${n.mainStart()}
              ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${g.offsetToIndices("global_idx")};
              var xIndices = ${g.offsetToIndices("global_idx")};

              var value = ${p}(${l});
              var pad = 0;
              ${v}
              ${b}
              ${w}
              ${o}

              output[global_idx] = value;
            }`}else{if(h)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let b=r.kernelShape.length,v=r.pads.length,w="";return u?w=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${e.indicesToOffset("xIndices")}];
                ${a}
              }`:w=`
              }
              let x_val = x[${e.indicesToOffset("xIndices")}];
              ${a}
            `,`
            ${n.registerUniforms(c).declareVariables(e,g)}

            ${n.mainStart()}
              ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${g.offsetToIndices("global_idx")};
              var xIndices = ${g.offsetToIndices("global_idx")};

              var offsets: array<u32, ${b}>;

              var value = ${p}(${l});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${b-1}u; j++) {
                  offsets[j] = offset / ${Zn("uniforms.kernelStrides","j",b)};
                  offset -= offsets[j] * ${Zn("uniforms.kernelStrides","j",b)};
                }
                offsets[${b-1}] = offset;

                isPad = false;
                for (var j = ${t-b}u; j < ${t}u; j++) {
                  xIndices[j] = indices[j] * ${Zn("uniforms.strides",`j - ${t-b}u`,b)}
                    + offsets[j - ${t-b}u] - ${Zn("uniforms.pads","j - 2u",v)};
                  ${w}
              }
              ${o}

              output[global_idx] = value;
            }`}},_$=n=>`${n.format};${n.ceilMode};${n.autoPad};${n.kernelShape.length}`,LX=n=>`${_$(n)};${n.countIncludePad}`,NX=n=>`${_$(n)};${n.storageOrder};${n.dilations}`,x$=n=>({format:n.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][n.auto_pad],ceilMode:n.ceil_mode,kernelShape:n.kernel_shape,strides:n.strides,pads:n.pads}),C$=(n,e,t,s)=>{let[r,a]=b$(e,s,t),o=qt("x",e.dataType,e.dims.length),l=o.type.value,c="value += x_val;",u="";r.countIncludePad?u+=`value /= ${l}(uniforms.kernelSize);`:u+=`value /= ${l}(i32(uniforms.kernelSize) - pad);`;let[f,d,h,p,g]=w$(a,r);f.push(...as(e.dims,a));let b=["rank"];return{name:n,shaderCache:{hint:`${s.cacheKey};${h};${p};${g}`,inputDependencies:b},getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(Nt.size(a)/64)},programUniforms:f}),getShaderSource:v=>v$(v,o,e.dims.length,a.length,r,c,u,0,d,h,p,g)}},Lpe=n=>{let e=n.count_include_pad!==0,t=x$(n);if(t.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let s={countIncludePad:e,...t,cacheKey:""};return{...s,cacheKey:LX(s)}},Npe=(n,e)=>{sS(n.inputs),n.compute(C$("AveragePool",n.inputs[0],!1,e))},S$={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Dpe=n=>{let e=n.format;return{format:e,...S$,cacheKey:e}},Ope=(n,e)=>{sS(n.inputs),n.compute(C$("GlobalAveragePool",n.inputs[0],!0,e))},M$=(n,e,t,s)=>{let[r,a]=b$(e,s,t),o=`
      value = max(x_val, value);
    `,l="",c=qt("x",e.dataType,e.dims.length),u=["rank"],[f,d,h,p,g]=w$(a,r);return f.push(...as(e.dims,a)),{name:n,shaderCache:{hint:`${s.cacheKey};${h};${p};${g}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(Nt.size(a)/64)},programUniforms:f}),getShaderSource:b=>v$(b,c,e.dims.length,a.length,r,o,l,e.dataType===10?-65504:-1e5,d,h,p,g)}},Ppe=(n,e)=>{sS(n.inputs),n.compute(M$("MaxPool",n.inputs[0],!1,e))},$pe=n=>{let e=n.storage_order,t=n.dilations,s=x$(n);if(e!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(s.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let r={storageOrder:e,dilations:t,...s,cacheKey:""};return{...r,cacheKey:NX(r)}},jpe=n=>{let e=n.format;return{format:e,...S$,cacheKey:e}},Rpe=(n,e)=>{sS(n.inputs),n.compute(M$("GlobalMaxPool",n.inputs[0],!0,e))}}),DX,OX,Fpe,zpe,kst=pn(()=>{Ns(),Bs(),mo(),Hs(),DX=(n,e)=>{if(n.length<2||n.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(n.length===3&&n[1].dims===n[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(n.length===3&&n[0].dataType!==n[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(n[0].dataType===6&&n.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(n[1].dims.length!==0&&n[1].dims.length!==1&&n[1].dims.length!==n[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(n.length>2){if(n[0].dataType!==n[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(n[1].dims.length!==n[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!n[1].dims.map((t,s)=>t===n[2].dims[s]).reduce((t,s)=>t&&s,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(e.blockSize>0){if(n[1].dims.length===0||n[1].dims.length===1&&n[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!n[1].dims.map((r,a)=>a===e.axis||r===n[0].dims[a]).reduce((r,a)=>r&&a,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(n[1].dims.length!==n[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let t=n[0].dims[e.axis],s=n[1].dims[e.axis];if(e.blockSize<Math.ceil(t/s)||e.blockSize>Math.ceil(t/(s-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},OX=(n,e)=>{let t=Nt.normalizeAxis(e.axis,n[0].dims.length),s=n[0].dataType,r=s===3,a=n[0].dims,o=n[1].dataType,l=Nt.size(a),c=s===3||s===2,u=c?[Math.ceil(Nt.size(n[0].dims)/4)]:n[0].dims,f=n[1].dims,d=n.length>2?n[2]:void 0,h=d?c?[Math.ceil(Nt.size(d.dims)/4)]:d.dims:void 0,p=f.length===0||f.length===1&&f[0]===1,g=p===!1&&f.length===1,b=Za(l),v=p&&(!c||b===4),w=v?b:1,x=v&&!c?b:1,S=qt("input",c?12:s,u.length,x),C=qt("scale",o,f.length),M=d?qt("zero_point",c?12:s,h.length):void 0,k=Kn("output",o,a.length,w),E=[S,C];M&&E.push(M);let I=[u,f];d&&I.push(h);let A=[{type:12,data:l/w},{type:12,data:t},{type:12,data:e.blockSize},...as(...I,a)],D=L=>{let P=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${L.registerUniforms(P).declareVariables(...E,k)}
      ${L.mainStart()}
          ${L.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${k.offsetToIndices("global_idx")};

          // Set input x
          ${c?`
            let input = ${S.getByOffset("global_idx / 4")};
            let x_vec = ${r?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${w===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${S.getByOffset("global_idx")};`};

          // Set scale input
          ${p?`let scale_value= ${C.getByOffset("0")}`:g?`
            let scale_index = ${k.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${C.getByOffset("scale_index")};`:`
            var scale_indices: ${C.type.indices} = output_indices;
            let index = ${C.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${C.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${C.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${M?p?c?`
                let zero_point_input = ${M.getByOffset("0")};
                let zero_point_vec =  ${r?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${M.getByOffset("0")}`:g?c?`
                let zero_point_index = ${k.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${M.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${r?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${k.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${M.getByOffset("zero_point_index")};`:c?`
                let zero_point_offset = ${C.indicesToOffset("scale_indices")};
                let zero_point_input = ${M.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${r?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${M.getByIndices("scale_indices")};`:`let zero_point_value = ${c?r?"i32":"u32":S.type.value}(0);`};
      // Compute and write output
      ${k.setByOffset("global_idx",`${k.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:e.cacheKey,inputDependencies:M?["rank","rank","rank"]:["rank","rank"]},getShaderSource:D,getRunData:()=>({outputs:[{dims:a,dataType:o}],dispatchGroup:{x:Math.ceil(l/w/64),y:1,z:1},programUniforms:A})}},Fpe=(n,e)=>{DX(n.inputs,e),n.compute(OX(n.inputs,e))},zpe=n=>hi({axis:n.axis,blockSize:n.blockSize})}),PX,$X,Bpe,Est=pn(()=>{kp(),Ns(),Hs(),PX=(n,e,t)=>{let s=n===e,r=n<e&&t<0,a=n>e&&t>0;if(s||r||a)throw new Error("Range these inputs' contents are invalid.")},$X=(n,e,t,s)=>{let r=Math.abs(Math.ceil((e-n)/t)),a=[r],o=r,l=[{type:12,data:o},{type:s,data:n},{type:s,data:t},...as(a)],c=u=>{let f=Kn("output",s,a.length),d=f.type.value,h=[{name:"outputSize",type:"u32"},{name:"start",type:d},{name:"delta",type:d}];return`
        ${u.registerUniforms(h).declareVariables(f)}
        ${u.mainStart()}
        ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${d}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${s}`},getShaderSource:c,getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:l})}},Bpe=n=>{let e=0,t=0,s=0;n.inputs[0].dataType===6?(e=n.inputs[0].getInt32Array()[0],t=n.inputs[1].getInt32Array()[0],s=n.inputs[2].getInt32Array()[0]):n.inputs[0].dataType===1&&(e=n.inputs[0].getFloat32Array()[0],t=n.inputs[1].getFloat32Array()[0],s=n.inputs[2].getFloat32Array()[0]),pa.webgpu.validateInputContent&&PX(e,t,s),n.compute($X(e,t,s,n.inputs[0].dataType),{inputs:[]})}}),jX,T$,k$,RX,Upe,Vpe,Ist=pn(()=>{Ns(),Bs(),mo(),Hs(),jX=(n,e,t,s)=>{if(n!=="none"&&s!=="i32"&&s!=="u32"&&s!=="f32")throw new Error(`Input ${s} is not supported with reduction ${n}.`);let r=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,a=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${e}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(n){case"none":return`${e}=${t};`;case"add":return s==="i32"||s==="u32"?`atomicAdd(&${e}, bitcast<${s}>(${t}));`:`
              ${r}bitcast<${s}>(oldValue) + (${t})${a}`;case"max":return s==="i32"||s==="u32"?`atomicMax(&${e}, bitcast<${s}>(${t}));`:`
                ${r}max(bitcast<f32>(oldValue), (${t}))${a}`;case"min":return s==="i32"||s==="u32"?`atomicMin(&${e}, bitcast<${s}>(${t}));`:`${r}min(bitcast<${s}>(oldValue), (${t}))${a}`;case"mul":return`${r}(bitcast<${s}>(oldValue) * (${t}))${a}`;default:throw new Error(`Reduction ${n} is not supported.`)}},T$=(n,e)=>`${n===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[${e?"i - indices_start":"i"}];
    let dim_value = uniforms.output_shape[${e?"i - indices_start":"i"} + uniforms.last_index_dimension];`}
    
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));`,k$=(n,e,t)=>`for (var i = 0u; i < uniforms.num_updates_elements; i++) {
        let value = updates[uniforms.num_updates_elements * ${t?"global_idx":"idx"} + i];
        ${jX(n.reduction,"output[data_offset + i]","value",e)}
      }`,RX=(n,e)=>{let t=n[0].dims,s=n[1].dims,r=t,a=1,o=Math.ceil(Nt.size(s)/a),l=s[s.length-1],c=Nt.sizeFromDimension(t,l),u=Nt.sizeFromDimension(s,0)/l,f=[{type:12,data:o},{type:12,data:l},{type:12,data:c},...as(n[1].dims,n[2].dims,r)],d=h=>{let p=qt("indices",n[1].dataType,n[1].dims.length),g=qt("updates",n[2].dataType,n[2].dims.length,a),b=e.reduction!=="none"&&e.reduction!==""?yde("output",n[0].dataType,r.length):Kn("output",n[0].dataType,r.length,a);return`
      ${h.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(p,g,b)}
      ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${e.reduction==="none"}) {
    for (var i = 0; i < ${u}; i = i + 1) {
      for (var j = i + 1; j < ${u}; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  if (${e.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    // Process each index-update pair individually when duplicates exist
    for (var idx = 0u; idx < ${u}u; idx++) {
      var data_offset = 0u;
      for (var i = 0u; i < uniforms.last_index_dimension; i++) {
        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);
        ${T$(t.length,!1)}
      }
      ${k$(e,b.type.value,!1)}
    }
    return;
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  var indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${T$(t.length,!0)}
  }
  ${k$(e,b.type.value,!0)}
  }`};return{name:"ScatterND",shaderCache:{hint:`${e.cacheKey}_${e.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:f}),getShaderSource:d}},Upe=n=>hi({reduction:n.reduction}),Vpe=(n,e)=>{n.compute(RX(n.inputs,e),{inputs:[n.inputs[1],n.inputs[2]],outputs:[]})}}),FX,zX,BX,E$,UX,VX,WX,GX,HX,qX,YX,KX,I$,XX,QX,JX,ZX,eQ,Wpe,Gpe,Ast=pn(()=>{Ns(),Bs(),mo(),Hs(),FX=(n,e)=>{if(n.every(t=>t>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),n.length>0){if(e.mode==="linear"){if(!(n.length===2||n.length===3||n.length===4&&n[0]===1&&n[1]===1||n.length===4&&n[0]===1&&n[3]===1||n.length===5&&n[0]===1&&n[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(e.mode==="cubic"&&!(n.length===2||n.length===4&&n[0]===1&&n[1]===1||n.length===4&&n[0]===1&&n[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},zX=(n,e,t)=>{e.every(r=>r>=0&&r<t||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let s=new Array(t).fill(1);return e.forEach((r,a)=>s[r]=n[a]),s},BX=(n,e,t,s,r,a)=>{let[o,l,c]=t>10?[1,2,3]:[-1,n.length>1?1:-1,-1],u=n[0].dims.length;if(o>0&&n.length>o&&n[o].dims.length>0)n[o].getFloat32Array().forEach(f=>a.push(f));else if(e.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(l>0&&n.length>l&&n[l].dims.length===1&&n[l].dims[0]>0){if(n[l].getFloat32Array().forEach(f=>s.push(f)),s.length!==0&&s.length!==u&&t>=18&&s.length!==e.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");FX(s,e),e.axes.length>0&&zX(s,e.axes,u).forEach((f,d)=>s[d]=f)}if(c>0&&n.length>c&&n[c].dims.length===1&&n[c].dims[0]>0&&(n[c].getBigInt64Array().forEach(f=>r.push(Number(f))),r.length!==0&&r.length!==u&&t>=18&&r.length!==e.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(e.axes.length>0){if(s.length!==0&&s.length!==e.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(r.length!==0&&r.length!==e.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof s<"u"&&typeof r<"u"&&s.length>0&&r.length>u)throw new Error("Resize requires only of scales or sizes to be specified")},E$=(n,e,t,s)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${n}) * (${e});
  let whole = ${s}(big / (${t}));
  let fract = ${s}(big % (${t})) / ${s}(${t});
  return whole + fract;
`,UX=(n,e)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${e} { `+(()=>{switch(n){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${e}(xResized) / ${e}(xScale);
          } else {
            ${E$("xResized","lengthOriginal","lengthResized",e)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${e}(xResized) + 0.5) / ${e}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${e}(xResized) + 0.5) / ${e}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${E$("xResized","lengthOriginal - 1","lengthResized - 1",e)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${e}(roiStart) * ${e}(lengthOriginal - 1) +
                        (${e}(xResized) * ${e}(roiEnd - roiStart) * ${e}(lengthOriginal - 1)) /
                        ${e}(lengthResized - 1);
                  } else {
                    return 0.5 * ${e}(roiStart + roiEnd) * ${e}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${e}xScale * ${e}(lengthResized);
                  const adjustment = ${e}(lengthResized) / outputWidth;
                  const center = ${e}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${e}(xResized) + 0.5) / ${e}(xScale)) - 0.5;`;case"half_pixel":return`return ((${e}(xResized) + 0.5) / ${e}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${n} is not supported`)}})()+"}",VX=(n,e,t)=>`fn getNearestPixelFromOriginal(xOriginal: ${t}, isDownSample: bool) -> ${t} {`+(()=>{switch(n){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(e<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${n} is not supported`)}})()+"}",WX=(n,e,t)=>{let s=new Array(t).fill(0).concat(new Array(t).fill(1)),r=n.length===0?s:n.slice();return e.length>0?(e.forEach((a,o)=>{s[a]=r[o],s[o+t]=r[e.length+o]}),s):r},GX=(n,e,t,s)=>{let r=[];if(t.length>0)if(s.length>0){if(n.forEach(a=>r.push(a)),Math.max(...s)>n.length)throw new Error("axes is out of bound");s.forEach((a,o)=>r[a]=t[o])}else t.forEach(a=>r.push(a));else{if(e.length===0)throw new Error("Resize requires either scales or sizes.");r=n.map((a,o)=>Math.round(a*e[o]))}return r},HX=(n,e,t)=>{let s=(()=>{switch(t.keepAspectRatioPolicy){case"not_larger":return t.axes.length>0?Math.min(...t.axes.map(a=>e[a]),Number.MAX_VALUE):Math.min(...e,Number.MAX_VALUE);case"not_smaller":return t.axes.length>0?Math.max(...t.axes.map(a=>e[a]),Number.MIN_VALUE):Math.max(...e,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${t.keepAspectRatioPolicy} is not supported`)}})();e.fill(1,0,e.length);let r=n.slice();return t.axes.length>0?(t.axes.forEach(a=>e[a]=s),t.axes.forEach(a=>r[a]=Math.round(n[a]*e[a]))):(e.fill(s,0,e.length),r.forEach((a,o)=>r[o]=Math.round(a*e[o]))),r},qX=(n,e,t,s,r)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${n.type.indices}) -> array<${n.type.value}, ${t.length}> {
      var original_indices: array<${n.type.value}, ${t.length}>;
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var output_index = ${n.indicesGet("output_indices","i")};
        var scale = ${Zn("uniforms.scales","i",s)};
        var roi_low = ${Zn("uniforms.roi","i",r)};
        var roi_hi = ${Zn("uniforms.roi",`i + ${e.length}`,r)};
        if (scale == 1.0) {
          original_indices[i] = ${n.type.value}(output_index);
        } else {
          var input_shape_i = ${Zn("uniforms.input_shape","i",e.length)};
          var output_shape_i = ${Zn("uniforms.output_shape","i",t.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,YX=(n,e,t,s,r,a,o)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> ${n.type.indices} {
      var input_indices: ${n.type.indices};
      for (var i:u32 = 0; i < ${s.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${Zn("uniforms.scales","i",r)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${Zn("uniforms.roi","i",a)};
          var roi_hi = ${Zn("uniforms.roi",`i + ${t.length}`,a)};
          var input_shape_i = ${Zn("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${Zn("uniforms.output_shape","i",s.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${o} || (original_idx >= 0 && original_idx < ${e.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${e.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${n.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,KX=(n,e)=>`
    fn checkInputIndices(input_indices: ${n.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${e.length}; i++) {
        var input_index = ${n.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${Zn("uniforms.input_shape","i",e.length)}) {
          return false;
        }
      }
      return true;
    }`,I$=(n,e,t,s)=>n.rank>s?`
    ${n.indicesSet("input_indices",e,"channel")};
    ${n.indicesSet("input_indices",t,"batch")};
`:"",XX=(n,e,t,s,r)=>{let[a,o,l,c]=t.length===2?[-1,0,1,-1]:[0,2,3,1],u=n.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${u} {
      var input_indices: ${n.type.indices};
      ${n.indicesSet("input_indices",o,`max(0, min(row, ${t[o]} - 1))`)};
      ${n.indicesSet("input_indices",l,`max(0, min(col, ${t[l]} - 1))`)};
      ${I$(n,c,a,2)}
      return ${n.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${e.type.indices}) -> ${u} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${u} = originalIndices[${o}];
      var col:${u} = originalIndices[${l}];
      ${s?`if (row < 0 || row > (${t[o]} - 1) || col < 0 || col > (${t[l]} - 1)) {
        return ${r};
      }`:""};
      row = max(0, min(row, ${t[o]} - 1));
      col = max(0, min(col, ${t[l]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${t.length>2?`u32(originalIndices[${c}])`:"0"};
      var batch: u32 =  ${t.length>2?`u32(originalIndices[${a}])`:"0"};
      var x11: ${u} = getInputValue(batch, channel, row1, col1);
      var x12: ${u} = getInputValue(batch, channel, row1, col2);
      var x21: ${u} = getInputValue(batch, channel, row2, col1);
      var x22: ${u} = getInputValue(batch, channel, row2, col2);
      var dx1: ${u} = abs(row - ${u}(row1));
      var dx2: ${u} = abs(${u}(row2) - row);
      var dy1: ${u} = abs(col - ${u}(col1));
      var dy2: ${u} = abs(${u}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},QX=(n,e,t,s,r,a,o,l,c,u)=>{let f=t.length===2,[d,h]=f?[0,1]:[2,3],p=n.type.value,g=b=>{let v=b===d?"row":"col";return`
      fn ${v}CubicInterpolation(input_indices: ${n.type.indices}, output_indices: ${e.type.indices}) -> ${p} {
        var output_index = ${e.indicesGet("output_indices",b)};
        var originalIdx: ${p} = getOriginalCoordinateFromResizedCoordinate(output_index, ${r[b]},
        ${s[b]}, ${t[b]}, ${a[b]}, ${a[b]} + ${t.length});
        var fractOriginalIdx: ${p} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${l} && (originalIdx < 0 || originalIdx > (${t[b]} - 1))) {
          return ${c};
        }
        var data: array<${p}, 4> = array<${p}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${v}: ${p} = originalIdx + ${p}(i);
          if (${v} < 0 || ${v} >= ${t[b]}) {
            ${u?`coefs[i + 1] = 0.0;
                        continue;`:l?`return ${c};`:`${v} = max(0, min(${v}, ${t[b]} - 1));`};
          }
        var input_indices_copy: ${n.type.indices} = input_indices;
          ${n.indicesSet("input_indices_copy",b,`u32(${v})`)};
          data[i + 1] = ${b===d?n.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${g(d)};
    ${g(h)};
  fn getCubicInterpolationCoefs(s: ${p}) -> array<${p}, 4> {
    var absS = abs(s);
    var coeffs: array<${p}, 4> = array<${p}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${p} = 1.0 - absS;
    var twoMinusAbsS: ${p} = 2.0 - absS;
    var onePlusAbsS: ${p} = 1.0 + absS;
    coeffs[0] = ((${o} * onePlusAbsS - 5 * ${o}) * onePlusAbsS + 8 * ${o}) * onePlusAbsS - 4 * ${o};
    coeffs[1] = ((${o} + 2) * absS - (${o} + 3)) * absS * absS + 1;
    coeffs[2] = ((${o} + 2) * oneMinusAbsS - (${o} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${o} * twoMinusAbsS - 5 * ${o}) * twoMinusAbsS + 8 * ${o}) * twoMinusAbsS - 4 * ${o};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${p}, 4>, coefs: array<${p}, 4>) -> ${p} {
    var coefsSum: ${p} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${e.type.indices}) -> ${p} {
    var input_indices: ${n.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},JX=(n,e,t,s,r)=>{let[a,o,l,c,u]=t.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],f=n.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${f} {
      var input_indices: ${n.type.indices};
      ${n.indicesSet("input_indices",o,`max(0, min(depth, ${t[o]} - 1))`)};
      ${n.indicesSet("input_indices",l,`max(0, min(height, ${t[l]} - 1))`)};
      ${n.indicesSet("input_indices",c,`max(0, min(width, ${t[c]} - 1))`)};
      ${I$(n,u,a,3)}
      return ${n.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${e.type.indices}) -> ${f} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${f} = originalIndices[${o}];
      var height:${f} = originalIndices[${l}];
      var width:${f} = originalIndices[${c}];
      ${s?`if (depth < 0 || depth > (${t[o]} - 1) || height < 0 || height > (${t[l]} - 1) || width < 0 || (width > ${t[c]} - 1)) {
      return ${r};
        }`:""};

    depth = max(0, min(depth, ${t[o]} - 1));
      height = max(0, min(height, ${t[l]} - 1));
      width = max(0, min(width, ${t[c]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${t.length>3?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${t.length>3?`u32(originalIndices[${a}])`:"0"};

      var x111: ${f} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${f} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${f} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${f} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${f} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${f} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${f} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${f} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${f} = abs(depth - ${f}(depth1));
      var dx2: ${f} = abs(${f}(depth2) - depth);
      var dy1: ${f} = abs(height - ${f}(height1));
      var dy2: ${f} = abs(${f}(height2) - height);
      var dz1: ${f} = abs(width - ${f}(width1));
      var dz2: ${f} = abs(${f}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},ZX=(n,e,t,s,r,a)=>{let o=n.dims,l=WX(a,e.axes,o.length),c=GX(o,s,r,e.axes),u=s.slice();s.length===0&&(u=o.map((x,S)=>x===0?1:c[S]/x),e.keepAspectRatioPolicy!=="stretch"&&(c=HX(o,u,e)));let f=Kn("output",n.dataType,c.length),d=qt("input",n.dataType,o.length),h=Nt.size(c),p=o.length===c.length&&o.every((x,S)=>x===c[S]),g=e.coordinateTransformMode==="tf_crop_and_resize",b=e.extrapolationValue,v=d.type.value,w=x=>`
      ${p?"":`
      ${UX(e.coordinateTransformMode,v)};
      ${(()=>{switch(e.mode){case"nearest":return`
              ${KX(d,o)};
              ${VX(e.nearestMode,t,v)};
              ${YX(d,f,o,c,u.length,l.length,g)};
              `;case"linear":return`
              ${qX(f,o,c,u.length,l.length)};
              ${(()=>{if(o.length===2||o.length===4)return`${XX(d,f,o,g,b)}`;if(o.length===3||o.length===5)return`${JX(d,f,o,g,b)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(o.length===2||o.length===4)return`${QX(d,f,o,c,u,l,e.cubicCoeffA,g,e.extrapolationValue,e.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${x.registerUniform("output_size","u32").registerUniform("scales","f32",u.length).registerUniform("roi","f32",l.length).declareVariables(d,f)}
      ${x.mainStart()}
        ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${p?"output[global_idx] = input[global_idx];":`
        let output_indices = ${f.offsetToIndices("global_idx")};
        var input_indices: ${d.type.indices};
        ${(()=>{switch(e.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${d.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${e.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${o.length===2||o.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${e.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${e.cacheKey}|${t}|${u.length>0?e.mode==="cubic"?u:u.length:""}|${r.length>0?r:""}|${l.length>0?l:""}|${p}|${e.mode==="nearest"?o.length:o}`,inputDependencies:["rank"]},getShaderSource:w,getRunData:()=>({outputs:[{dims:c,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},{type:1,data:u},{type:1,data:l},...as(o,c)]})}},eQ=n=>{let e=n.customDataBuffer;return new Uint32Array(e,e.byteOffset,1)[0]},Wpe=(n,e)=>{let t=[],s=[],r=[],a=eQ(n);if(e.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");BX(n.inputs,e,a,t,s,r),n.compute(ZX(n.inputs[0],e,a,t,s,r),{inputs:[0]})},Gpe=n=>{let e=n.antialias,t=n.axes,s=n.coordinateTransformMode,r=n.cubicCoeffA,a=n.excludeOutside!==0,o=n.extrapolationValue,l=n.keepAspectRatioPolicy,c=n.mode,u=n.nearestMode===""?"simple":n.nearestMode;return hi({antialias:e,axes:t,coordinateTransformMode:s,cubicCoeffA:r,excludeOutside:a,extrapolationValue:o,keepAspectRatioPolicy:l,mode:c,nearestMode:u})}}),tQ,nQ,Hpe,Lst=pn(()=>{Ns(),Bs(),Hs(),tQ=n=>{if(!n||n.length<3)throw new Error("layerNorm requires at least 3 inputs.");let e=n[0],t=n[1],s=n[2];if(e.dataType!==t.dataType||e.dataType!==s.dataType)throw new Error("All inputs must have the same data type");if(e.dims.length!==3&&e.dims.length!==2)throw new Error("Input must be 2D or 3D");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Skip must be 2D or 3D");let r=e.dims[e.dims.length-1],a=e.dims[e.dims.length-2];if(t.dims[t.dims.length-1]!==r)throw new Error("Skip must have the same hidden size as input");if(t.dims[t.dims.length-2]!==a)throw new Error("Skip must have the same sequence length as input");if(s.dims.length!==1)throw new Error("Gamma must be 1D");if(s.dims[s.dims.length-1]!==r)throw new Error("Gamma must have the same hidden size as input");if(n.length>3){let o=n[3];if(o.dims.length!==1)throw new Error("Beta must be 1D");if(o.dims[o.dims.length-1]!==r)throw new Error("Beta must have the same hidden size as input")}if(n.length>4){let o=n[4];if(o.dims.length!==1)throw new Error("Bias must be 1D");if(o.dims[o.dims.length-1]!==r)throw new Error("Bias must have the same hidden size as input")}},nQ=(n,e,t,s)=>{let r=e.simplified,a=n[0].dims,o=Nt.size(a),l=a,c=o,u=a.slice(-1)[0],f=s?a.slice(0,-1).concat(1):[],d=!r&&n.length>3,h=n.length>4,p=s&&t>1,g=s&&t>2,b=t>3,v=64,w=Za(u),x=[{type:12,data:c},{type:12,data:w},{type:12,data:u},{type:1,data:e.epsilon}],S=M=>{let k=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],E=[qt("x",n[0].dataType,n[0].dims,w),qt("skip",n[1].dataType,n[1].dims,w),qt("gamma",n[2].dataType,n[2].dims,w)];d&&E.push(qt("beta",n[3].dataType,n[3].dims,w)),h&&E.push(qt("bias",n[4].dataType,n[4].dims,w)),E.push(Kn("output",n[0].dataType,l,w)),p&&E.push(Kn("mean_output",1,f)),g&&E.push(Kn("inv_std_output",1,f)),b&&E.push(Kn("input_skip_bias_sum",n[0].dataType,l,w));let I=zl(n[0].dataType),A=zl(1,w);return`

      ${M.registerUniforms(k).declareVariables(...E)}
      var<workgroup> sum_shared : array<${A}, ${v}>;
      var<workgroup> sum_squared_shared : array<${A}, ${v}>;

      ${M.mainStart([v,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${v};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${v};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${v-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${h?"bias[offset1d + i]":I+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${b?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Rv(I,w,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${v};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${w1("sum",w)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${w1("square_sum",w)} / f32(uniforms.hidden_size) ${r?"":"- mean * mean"} + uniforms.epsilon);
        ${p?"mean_output[global_idx] = mean;":""}
        ${g?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${r?"":`- ${I}(mean)`}) *
            ${I}(inv_std_dev) * gamma[offset1d + i]
            ${d?"+ beta[offset1d + i]":""};
        }
      }`},C=[{dims:l,dataType:n[0].dataType}];return t>1&&C.push({dims:f,dataType:1}),t>2&&C.push({dims:f,dataType:1}),t>3&&C.push({dims:a,dataType:n[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${w};${p};${g};${b}`,inputDependencies:n.map((M,k)=>"type")},getShaderSource:S,getRunData:()=>({outputs:C,dispatchGroup:{x:Math.ceil(c/u)},programUniforms:x})}},Hpe=(n,e)=>{tQ(n.inputs);let t=[0];n.outputCount>1&&t.push(-3),n.outputCount>2&&t.push(-3),n.outputCount>3&&t.push(3),n.compute(nQ(n.inputs,e,n.outputCount,!1),{outputs:t})}}),sQ,rS,rQ,A$,iQ,aQ,qpe,Ype,Nst=pn(()=>{Ns(),Bs(),mo(),Hs(),sQ=(n,e)=>{if(!n||n.length<1)throw new Error("too few inputs");if(e.axes.length!==0){if(e.axes.length!==e.starts.length||e.axes.length!==e.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(e.starts.length!==e.ends.length)throw new Error("starts and ends must have the same length");n.slice(1).forEach((t,s)=>{if(n[s+1].dataType!==6&&n[s+1].dataType!==7)throw new Error(`Input ${s} must be an array of int32 or int64`)})},rS=(n,e)=>{let t=[];if(n.length>e)if(n[e].dataType===7)n[e].getBigInt64Array().forEach(s=>t.push(Number(s)));else if(n[e].dataType===6)n[e].getInt32Array().forEach(s=>t.push(Number(s)));else throw new Error(`Input ${e} must be an array of int32 or int64`);return t},rQ=(n,e)=>{if(n.length>1){let t=rS(n,1),s=rS(n,2),r=rS(n,3);return r.length===0&&(r=[...Array(n[0].dims.length).keys()]),hi({starts:t,ends:s,axes:r})}else return e},A$=(n,e,t,s,r)=>{let a=n;return n<0&&(a+=t[s[e]]),r[e]<0?Math.max(0,Math.min(a,t[s[e]]-1)):Math.max(0,Math.min(a,t[s[e]]))},iQ=(n,e,t)=>`fn calculateInputIndices(output_indices: ${e.type.indices}) -> ${n.type.indices} {
          var input_indices: ${n.type.indices};
          var carry = 0u;
          for (var i = ${t.length}; i >= 0; i--) {
            let input_shape_i = ${Zn("uniforms.input_shape","i",t.length)};
            let steps_i = ${Zn("uniforms.steps","i",t.length)};
            let signs_i = ${Zn("uniforms.signs","i",t.length)};
            let starts_i = ${Zn("uniforms.starts","i",t.length)};
            var output_index = ${e.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${n.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,aQ=(n,e)=>{let t=n[0].dims,s=Nt.size(t),r=e.axes.length>0?Nt.normalizeAxes(e.axes,t.length):[...Array(t.length).keys()],a=rS(n,4);a.forEach(w=>w!==0||(()=>{throw new Error("step cannot be 0")})),a.length===0&&(a=Array(r.length).fill(1));let o=e.starts.map((w,x)=>A$(w,x,t,r,a)),l=e.ends.map((w,x)=>A$(w,x,t,r,a));if(r.length!==o.length||r.length!==l.length)throw new Error("start, ends and axes should have the same number of elements");if(r.length!==t.length)for(let w=0;w<t.length;++w)r.includes(w)||(o.splice(w,0,0),l.splice(w,0,t[w]),a.splice(w,0,1));let c=a.map(w=>Math.sign(w));a.forEach((w,x,S)=>{if(w<0){let C=(l[x]-o[x])/w,M=o[x],k=M+C*a[x];o[x]=k,l[x]=M,S[x]=-w}});let u=t.slice(0);r.forEach((w,x)=>{u[w]=Math.ceil((l[w]-o[w])/a[w])});let f={dims:u,dataType:n[0].dataType},d=Kn("output",n[0].dataType,u.length),h=qt("input",n[0].dataType,n[0].dims.length),p=Nt.size(u),g=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:o.length},{name:"signs",type:"i32",length:c.length},{name:"steps",type:"u32",length:a.length}],b=[{type:12,data:p},{type:12,data:o},{type:6,data:c},{type:12,data:a},...as(n[0].dims,u)],v=w=>`
      ${w.registerUniforms(g).declareVariables(h,d)}
        ${iQ(h,d,t)}
        ${w.mainStart()}
          ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${d.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${d.setByOffset("global_idx",h.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${c.length}_${o.length}_${a.length}`,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:[f],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:b})}},qpe=(n,e)=>{sQ(n.inputs,e);let t=rQ(n.inputs,e);n.compute(aQ(n.inputs,t),{inputs:[0]})},Ype=n=>{let e=n.starts,t=n.ends,s=n.axes;return hi({starts:e,ends:t,axes:s})}}),oQ,lQ,Kpe,Xpe,Dst=pn(()=>{Ns(),Bs(),mo(),D1(),Hs(),oQ=n=>{if(!n||n.length!==1)throw new Error("Softmax op requires 1 input.")},lQ=(n,e)=>{let t=n.inputs[0],s=t.dims,r=Nt.size(s),a=s.length,o=Nt.normalizeAxis(e.axis,a),l=o<s.length-1,c,u=[];l?(u=Array.from({length:a},(E,I)=>I),u[o]=a-1,u[a-1]=o,c=n.compute(wd(t,u),{inputs:[t],outputs:[-1]})[0]):c=t;let f=c.dims,d=f[a-1],h=r/d,p=Za(d),g=d/p,b=64;h===1&&(b=256);let v=(E,I)=>I===4?`max(max(${E}.x, ${E}.y), max(${E}.z, ${E}.w))`:I===2?`max(${E}.x, ${E}.y)`:I===3?`max(max(${E}.x, ${E}.y), ${E}.z)`:E,w=qt("x",c.dataType,c.dims,p),x=Kn("result",c.dataType,c.dims,p),S=w.type.value,C=zl(c.dataType)==="f32"?`var threadMax = ${S}(-3.402823e+38f);`:`var threadMax = ${S}(-65504.0h);`,M=E=>`
      var<workgroup> rowMaxShared : ${S};
      var<workgroup> rowSumShared : ${S};
      var<workgroup> threadShared : array<${S}, ${b}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${S} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${S}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${E.registerUniform("packedCols","i32").declareVariables(w,x)}
      ${E.mainStart(b)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${b};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${C}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${S}(${v("threadShared[0]",p)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${S}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${S}(${w1("threadShared[0]",p)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,k=n.compute({name:"Softmax",shaderCache:{hint:`${p};${b}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:f,dataType:c.dataType}],dispatchGroup:{x:h},programUniforms:[{type:6,data:g}]}),getShaderSource:M},{inputs:[c],outputs:[l?-1:0]})[0];l&&n.compute(wd(k,u),{inputs:[k]})},Kpe=(n,e)=>{oQ(n.inputs),lQ(n,e)},Xpe=n=>hi({axis:n.axis})}),L$,cQ,uQ,fQ,Qpe,Ost=pn(()=>{Ns(),Bs(),Hs(),L$=n=>Array.from(n.getBigInt64Array(),Number),cQ=n=>{if(!n||n.length!==2)throw new Error("Tile requires 2 inputs.");if(n[0].dataType!==1&&n[0].dataType!==10&&n[0].dataType!==6&&n[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(n[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(n[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(L$(n[1]).length!==n[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},uQ=(n,e)=>{let t=[];for(let s=0;s<n.length;++s)t.push(n[s]*e[s]);return t},fQ=(n,e)=>{let t=n[0].dims,s=e??L$(n[1]),r=uQ(t,s),a=Nt.size(r),o=n[0].dataType,l=qt("input",o,t.length),c=Kn("output",o,r.length),u=f=>`
      const inputShape = ${l.indices(...t)};
      ${f.registerUniform("output_size","u32").declareVariables(l,c)}
      ${f.mainStart()}
      ${f.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${c.offsetToIndices("global_idx")};
      var input_indices: ${l.type.indices};
      for (var i = 0; i < ${t.length}; i++) {
        let input_dim_i = ${l.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${c.indicesGet("output_indices","i")}  % input_dim_i;

        ${l.indicesSet("input_indices","i","input_dim_value")}
      }
      ${c.setByOffset("global_idx",l.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${s}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:r,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:[{type:12,data:a},...as(n[0].dims,r)]}),getShaderSource:u}},Qpe=n=>{cQ(n.inputs),n.compute(fQ(n.inputs),{inputs:[0]})}}),dQ,hQ,Jpe,Pst=pn(()=>{Ns(),Bs(),Hs(),dQ=(n,e,t,s,r)=>{let a=Kn("output_data",r,t.length,4),o=qt("a_data",e[1].dataType,e[1].dims.length,4),l=qt("b_data",e[2].dataType,e[2].dims.length,4),c=qt("c_data",e[0].dataType,e[0].dims.length,4),u,f=(d,h,p)=>`select(${h}, ${d}, ${p})`;if(!s)u=a.setByOffset("global_idx",f(o.getByOffset("global_idx"),l.getByOffset("global_idx"),c.getByOffset("global_idx")));else{let d=(h,p,g="")=>{let b=`a_data[index_a${p}][component_a${p}]`,v=`b_data[index_b${p}][component_b${p}]`,w=`bool(c_data[index_c${p}] & (0xffu << (component_c${p} * 8)))`;return`
            let output_indices${p} = ${a.offsetToIndices(`global_idx * 4u + ${p}u`)};
            let offset_a${p} = ${o.broadcastedIndicesToOffset(`output_indices${p}`,a)};
            let offset_b${p} = ${l.broadcastedIndicesToOffset(`output_indices${p}`,a)};
            let offset_c${p} = ${c.broadcastedIndicesToOffset(`output_indices${p}`,a)};
            let index_a${p} = offset_a${p} / 4u;
            let index_b${p} = offset_b${p} / 4u;
            let index_c${p} = offset_c${p} / 4u;
            let component_a${p} = offset_a${p} % 4u;
            let component_b${p} = offset_b${p} % 4u;
            let component_c${p} = offset_c${p} % 4u;
            ${h}[${p}] = ${g}(${f(b,v,w)});
          `};r===9?u=`
            var data = vec4<u32>(0);
            ${d("data",0,"u32")}
            ${d("data",1,"u32")}
            ${d("data",2,"u32")}
            ${d("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:u=`
            ${d("output_data[global_idx]",0)}
            ${d("output_data[global_idx]",1)}
            ${d("output_data[global_idx]",2)}
            ${d("output_data[global_idx]",3)}
          `}return`
        ${n.registerUniform("vec_size","u32").declareVariables(c,o,l,a)}
        ${n.mainStart()}
        ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${u}
      }`},hQ=n=>{let e=n[1].dims,t=n[2].dims,s=n[0].dims,r=n[1].dataType,a=!(Nt.areEqual(e,t)&&Nt.areEqual(t,s)),o=e,l=Nt.size(e);if(a){let u=v2.calcShape(v2.calcShape(e,t,!1),s,!1);if(!u)throw new Error("Can't perform where op on the given tensors");o=u,l=Nt.size(o)}let c=Math.ceil(l/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:u=>dQ(u,n,o,a,r),getRunData:()=>({outputs:[{dims:o,dataType:r}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:[{type:12,data:c},...as(s,e,t,o)]})}},Jpe=n=>{n.compute(hQ(n.inputs))}}),Zpe,$st=pn(()=>{Xnt(),kU(),Qnt(),Jnt(),Znt(),est(),tst(),ast(),lst(),cst(),ust(),fst(),dst(),hst(),pst(),mst(),gst(),yst(),bst(),wst(),vst(),_st(),xst(),Cst(),Sst(),bpe(),Mst(),Tst(),kst(),Est(),Ist(),TU(),Ast(),Cpe(),Lst(),Nst(),Dst(),_pe(),Ost(),D1(),EU(),Pst(),Zpe=new Map([["Abs",[Hde]],["Acos",[qde]],["Acosh",[Yde]],["Add",[Ehe]],["ArgMax",[Ude,k6]],["ArgMin",[Bde,k6]],["Asin",[Kde]],["Asinh",[Xde]],["Atan",[Qde]],["Atanh",[Jde]],["Attention",[Vde]],["AveragePool",[Npe,Lpe]],["BatchNormalization",[Wde]],["BiasAdd",[Gde]],["BiasSplitGelu",[khe]],["Cast",[ehe,Zde]],["Ceil",[nhe]],["Clip",[the]],["Concat",[Rhe,Fhe]],["Conv",[D6,N6]],["ConvTranspose",[Khe,Yhe]],["Cos",[she]],["Cosh",[rhe]],["CumSum",[Xhe,Qhe]],["DepthToSpace",[Jhe,Zhe]],["DequantizeLinear",[Fpe,zpe]],["Div",[Ihe]],["Einsum",[epe,tpe]],["Elu",[ihe,QS]],["Equal",[Ahe]],["Erf",[ahe]],["Exp",[ohe]],["Expand",[npe]],["FastGelu",[spe]],["Floor",[lhe]],["FusedConv",[D6,N6]],["Gather",[ipe,rpe]],["GatherElements",[fpe,upe]],["GatherBlockQuantized",[lpe,cpe]],["GatherND",[ape,ope]],["Gelu",[che]],["Gemm",[hpe,dpe]],["GlobalAveragePool",[Ope,Dpe]],["GlobalMaxPool",[Rpe,jpe]],["Greater",[Ohe]],["GreaterOrEqual",[$he]],["GridSample",[ppe,mpe]],["GroupQueryAttention",[Spe]],["HardSigmoid",[yhe,ghe]],["InstanceNormalization",[Mpe]],["LayerNormalization",[Tpe]],["LeakyRelu",[uhe,QS]],["Less",[Phe]],["LessOrEqual",[jhe]],["Log",[Mhe]],["MatMul",[kpe]],["MatMulNBits",[Epe,Ipe]],["MaxPool",[Ppe,$pe]],["Mul",[Lhe]],["MultiHeadAttention",[ype,gpe]],["Neg",[dhe]],["Not",[fhe]],["Pad",[Ape]],["Pow",[Nhe]],["QuickGelu",[The,QS]],["Range",[Bpe]],["Reciprocal",[hhe]],["ReduceMin",[$de]],["ReduceMean",[Lde]],["ReduceMax",[Pde]],["ReduceSum",[Rde]],["ReduceProd",[jde]],["ReduceL1",[Nde]],["ReduceL2",[Dde]],["ReduceLogSum",[zde]],["ReduceLogSumExp",[Ode]],["ReduceSumSquare",[Fde]],["Relu",[phe]],["Resize",[Wpe,Gpe]],["RotaryEmbedding",[xpe]],["ScatterND",[Vpe,Upe]],["Sigmoid",[mhe]],["Sin",[bhe]],["Sinh",[whe]],["Slice",[qpe,Ype]],["SkipLayerNormalization",[Hpe]],["Split",[wpe,vpe]],["Sqrt",[vhe]],["Softmax",[Kpe,Xpe]],["Sub",[Dhe]],["Tan",[_he]],["Tanh",[xhe]],["ThresholdedRelu",[She,QS]],["Tile",[Qpe]],["Transpose",[wde,vde]],["Where",[Jpe]]])}),eme,jst=pn(()=>{kp(),Jg(),Hs(),eme=class{constructor(n){this.backend=n,this.repo=new Map,this.attributesBound=!1}getArtifact(n){return this.repo.get(n)}setArtifact(n,e){this.repo.set(n,e)}run(n,e,t,s,r){vp(n.programInfo.name);let a=this.backend.device,o=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let l=[];for(let u of e)l.push({binding:l.length,resource:{buffer:u.buffer}});for(let u of t)l.push({binding:l.length,resource:{buffer:u.buffer}});r&&l.push({binding:l.length,resource:r});let c=a.createBindGroup({layout:n.computePipeline.getBindGroupLayout(0),entries:l,label:n.programInfo.name});if(this.backend.sessionStatus==="capturing"){let u={kernelId:this.backend.currentKernelId,computePipeline:n.computePipeline,bindGroup:c,dispatchGroup:s};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(u)}o.setPipeline(n.computePipeline),o.setBindGroup(0,c),o.dispatchWorkgroups(...s),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),hh(n.programInfo.name)}dispose(){}build(n,e){vp(n.name);let t=this.backend.device,s=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(u=>{t.features.has(u.feature)&&s.push(`enable ${u.extension};`)});let r=bde(e,this.backend.device.limits),a=n.getShaderSource(r),o=`${s.join(`
`)}
${r.additionalImplementations}
${a}`,l=t.createShaderModule({code:o,label:n.name});$r("verbose",()=>`[WebGPU] ${n.name} shader code: ${o}`);let c=t.createComputePipeline({compute:{module:l,entryPoint:"main"},layout:"auto",label:n.name});return hh(n.name),{programInfo:n,computePipeline:c,uniformVariablesInfo:r.variablesInfo}}normalizeDispatchGroupSize(n){let e=typeof n=="number"?n:n.x,t=typeof n=="number"?1:n.y||1,s=typeof n=="number"?1:n.z||1,r=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(e<=r&&t<=r&&s<=r)return[e,t,s];let a=e*t*s,o=Math.ceil(Math.sqrt(a));if(o>r){if(o=Math.ceil(Math.cbrt(a)),o>r)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[o,o,o]}else return[o,o,1]}}}),tme={};rx(tme,{WebGpuBackend:()=>nme});var pQ,mQ,gQ,nme,Rst=pn(()=>{kp(),Ns(),Jg(),hde(),Ynt(),$st(),jst(),pQ=(n,e)=>{if(e.length!==n.length)throw new Error(`inputDependencies length ${e.length} is not equal to inputTensors length ${n.length}.`);let t=[];for(let s=0;s<n.length;++s){let r=n[s].dataType;switch(e[s]){case"none":{t.push("");break}case"type":{t.push(`${r}`);break}case"rank":{let a=n[s].dims.length;t.push(`${r};${a}`);break}case"dims":{let a=n[s].dims.join(",");t.push(`${r};${a}`);break}default:throw new Error(`unsupported input dependency: ${e[s]}`)}}return t.join("|")},mQ=(n,e,t)=>{let s=n.name;return n.shaderCache?.hint&&(s+="["+n.shaderCache.hint+"]"),s+=":"+t+`:${pQ(e,n.shaderCache?.inputDependencies??new Array(e.length).fill("dims"))}`,s},gQ=class{constructor(n){n&&(this.architecture=n.architecture,this.vendor=n.vendor)}isArchitecture(n){return this.architecture===n}isVendor(n){return this.vendor===n}},nme=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let n=this.kernelCustomData.get(this.currentKernelId);return n||(n={},this.kernelCustomData.set(this.currentKernelId,n)),n}async initialize(n,e){this.env=n;let t=[],s={requiredLimits:{maxComputeWorkgroupStorageSize:e.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:e.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:e.limits.maxStorageBufferBindingSize,maxBufferSize:e.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:e.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:e.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:e.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:e.limits.maxComputeWorkgroupSizeZ},requiredFeatures:t},r=a=>e.features.has(a)&&t.push(a)&&!0;r("chromium-experimental-timestamp-query-inside-passes")||r("timestamp-query"),r("shader-f16"),r("subgroups"),this.device=await e.requestDevice(s),this.adapterInfo=new gQ(e.info||await e.requestAdapterInfo()),this.gpuDataManager=gde(this),this.programManager=new eme(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,xU(n.logLevel,!!n.debug),this.device.onuncapturederror=a=>{a.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${a.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:e,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let n=this.getCommandEncoder(),e={};this.queryType==="at-passes"&&(e.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=n.beginComputePass(e)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;vp(),this.endComputePass();let n;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),n=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(n,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,n,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&n.mapAsync(GPUMapMode.READ).then(()=>{let e=new BigUint64Array(n.getMappedRange()),t=this.pendingQueries.get(n);for(let s=0;s<e.length/2;s++){let r=t[s],a=r.kernelId,o=this.kernels.get(a),l=o.kernelType,c=o.kernelName,u=r.programName,f=r.inputTensorViews,d=r.outputTensorViews,h=e[s*2],p=e[s*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=h);let g=Number(h-this.queryTimeBase),b=Number(p-this.queryTimeBase);if(!Number.isSafeInteger(g)||!Number.isSafeInteger(b))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:f.map(v=>({dims:v.dims,dataType:Tg(v.dataType)})),outputsMetadata:d.map(v=>({dims:v.dims,dataType:Tg(v.dataType)})),kernelId:a,kernelType:l,kernelName:c,programName:u,startTime:g,endTime:b});else{let v="";f.forEach((x,S)=>{v+=`input[${S}]: [${x.dims}] | ${Tg(x.dataType)}, `});let w="";d.forEach((x,S)=>{w+=`output[${S}]: [${x.dims}] | ${Tg(x.dataType)}, `}),console.log(`[profiling] kernel "${a}|${l}|${c}|${u}" ${v}${w}execution time: ${b-g} ns`)}QM("GPU",`${u}::${h}::${p}`)}n.unmap(),this.pendingQueries.delete(n)}),hh()}run(n,e,t,s,r,a){vp(n.name);let o=[];for(let x=0;x<e.length;++x){let S=e[x].data;if(S===0)continue;let C=this.gpuDataManager.get(S);if(!C)throw new Error(`no GPU data for input: ${S}`);o.push(C)}let{outputs:l,dispatchGroup:c,programUniforms:u}=n.getRunData(e),f=t.length===0?l.map((x,S)=>S):t;if(f.length!==l.length)throw new Error(`Output size ${f.length} must be equal to ${l.length}.`);let d=[],h=[];for(let x=0;x<l.length;++x){if(!Number.isInteger(f[x])||f[x]<-3||f[x]>=a)throw new Error(`Invalid output index: ${f[x]}`);if(f[x]===-3)continue;let S=f[x]===-1,C=f[x]===-2,M=S||C?r(l[x].dataType,l[x].dims):s(f[x],l[x].dataType,l[x].dims);if(d.push(M),M.data===0)continue;let k=this.gpuDataManager.get(M.data);if(!k)throw new Error(`no GPU data for output: ${M.data}`);if(S&&this.temporaryData.push(k),C){let E=this.kernelPersistentData.get(this.currentKernelId);E||(E=[],this.kernelPersistentData.set(this.currentKernelId,E)),E.push(k)}h.push(k)}if(o.length!==e.length||h.length!==d.length){if(h.length===0)return hh(n.name),d;throw new Error(`Program ${n.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let p;if(u){let x=0,S=[];u.forEach(E=>{let I=typeof E.data=="number"?[E.data]:E.data;if(I.length===0)return;let A=E.type===10?2:4,D,L;E.type===10?(L=I.length>4?16:I.length>2?8:I.length*A,D=I.length>4?16:A*I.length):(L=I.length<=2?I.length*A:16,D=16),x=Math.ceil(x/L)*L,S.push(x);let P=E.type===10?8:4;x+=I.length>4?Math.ceil(I.length/P)*D:I.length*A});let C=16;x=Math.ceil(x/C)*C;let M=new ArrayBuffer(x);u.forEach((E,I)=>{let A=S[I],D=typeof E.data=="number"?[E.data]:E.data;if(E.type===6)new Int32Array(M,A,D.length).set(D);else if(E.type===12)new Uint32Array(M,A,D.length).set(D);else if(E.type===10)new Uint16Array(M,A,D.length).set(D);else if(E.type===1)new Float32Array(M,A,D.length).set(D);else throw new Error(`Unsupported uniform type: ${Tg(E.type)}`)});let k=this.gpuDataManager.create(x,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(k.buffer,0,M,0,x),this.gpuDataManager.release(k.id),p={offset:0,size:x,buffer:k.buffer}}let g=this.programManager.normalizeDispatchGroupSize(c),b=g[1]===1&&g[2]===1,v=mQ(n,e,b),w=this.programManager.getArtifact(v);if(w||(w=this.programManager.build(n,g),this.programManager.setArtifact(v,w),$r("info",()=>`[artifact] key: ${v}, programName: ${n.name}`)),u&&w.uniformVariablesInfo){if(u.length!==w.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${w.uniformVariablesInfo.length}, got ${u.length} in program "${w.programInfo.name}".`);for(let x=0;x<u.length;x++){let S=u[x],C=S.type,M=typeof S.data=="number"?1:S.data.length,[k,E]=w.uniformVariablesInfo[x];if(C!==k||M!==E)throw new Error(`Uniform variable ${x} mismatch: expect type ${k} with size ${E}, got type ${C} with size ${M} in program "${w.programInfo.name}".`)}}if($r("info",()=>`[ProgramManager] run "${n.name}" (key=${v}) with ${g[0]}x${g[1]}x${g[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let x={kernelId:this.currentKernelId,programName:w.programInfo.name,inputTensorViews:e,outputTensorViews:d};this.pendingKernels.push(x),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(x)}return this.programManager.run(w,o,h,g,p),hh(n.name),d}upload(n,e){this.gpuDataManager.upload(n,e)}memcpy(n,e){this.gpuDataManager.memcpy(n,e)}async download(n,e){await this.gpuDataManager.download(n,e)}alloc(n){return this.gpuDataManager.create(n).id}free(n){return this.gpuDataManager.release(n)}createKernel(n,e,t,s){let r=Zpe.get(n);if(!r)throw new Error(`kernel not implemented: ${n}`);let a={kernelType:n,kernelName:s,kernelEntry:r[0],attributes:[r[1],t]};this.kernels.set(e,a)}releaseKernel(n){let e=this.kernelPersistentData.get(n);if(e){for(let t of e)this.gpuDataManager.release(t.id);this.kernelPersistentData.delete(n)}this.kernelCustomData.delete(n),this.kernels.delete(n)}computeKernel(n,e,t){let s=this.kernels.get(n);if(!s)throw new Error(`kernel not created: ${n}`);let r=s.kernelType,a=s.kernelName,o=s.kernelEntry,l=s.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${r}] ${a}" is not allowed to be called recursively`);this.currentKernelId=n,l[0]&&(l[1]=l[0](l[1]),l[0]=void 0),$r("info",()=>`[WebGPU] Start to run kernel "[${r}] ${a}"...`);let c=this.env.debug;this.temporaryData=[];try{return c&&this.device.pushErrorScope("validation"),o(e,l[1]),0}catch(u){return t.push(Promise.resolve(`[WebGPU] Kernel "[${r}] ${a}" failed. ${u}`)),1}finally{c&&t.push(this.device.popErrorScope().then(u=>u?`GPU validation error for kernel "[${r}] ${a}": ${u.message}`:null));for(let u of this.temporaryData)this.gpuDataManager.release(u.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(n,e,t,s){let r=this.sessionExternalDataMapping.get(n);r||(r=new Map,this.sessionExternalDataMapping.set(n,r));let a=r.get(e),o=this.gpuDataManager.registerExternalBuffer(t,s,a);return r.set(e,[o,t]),o}unregisterBuffers(n){let e=this.sessionExternalDataMapping.get(n);e&&(e.forEach(t=>this.gpuDataManager.unregisterExternalBuffer(t[0])),this.sessionExternalDataMapping.delete(n))}getBuffer(n){let e=this.gpuDataManager.get(n);if(!e)throw new Error(`no GPU data for buffer: ${n}`);return e.buffer}createDownloader(n,e,t){return async()=>{let s=await S6(this,n,e);return CU(s.buffer,t)}}writeTimestamp(n){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,n)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){$r("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){$r("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){$r("info","replay"),this.sessionStatus="replaying";let n=this.capturedCommandList.get(this.currentSessionId),e=this.capturedPendingKernels.get(this.currentSessionId),t=n.length;this.pendingKernels=[];for(let s=0;s<t;s++){let r=this.getComputePassEncoder(),a=n[s];this.writeTimestamp(this.pendingDispatchNumber*2),r.setPipeline(a.computePipeline),r.setBindGroup(0,a.bindGroup),r.dispatchWorkgroups(...a.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(e[s]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(n){this.unregisterBuffers(n),this.capturedCommandList.has(n)&&this.capturedCommandList.delete(n),this.capturedPendingKernels.has(n)&&this.capturedPendingKernels.delete(n),this.gpuDataManager.onReleaseSession(n)}onRunStart(n){this.currentSessionId=n,this.setQueryType()}}}),sme={};rx(sme,{init:()=>rme});var eA,yQ,rme,Fst=pn(()=>{Ns(),Jg(),Bs(),qnt(),eA=class ime{constructor(e,t,s,r){this.module=e,this.dataType=t,this.data=s,this.dims=r}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let e=Nt.size(this.dims);return e===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let e=Nt.size(this.dims);return e===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let e=Nt.size(this.dims);return e===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let e=Nt.size(this.dims);return e===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,e)}reshape(e){if(Nt.size(e)!==Nt.size(this.dims))throw new Error("Invalid new shape");return new ime(this.module,this.dataType,this.data,e)}},yQ=class{constructor(n,e,t){this.module=n,this.backend=e,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=e.adapterInfo;let s=n.PTR_SIZE,r=t/n.PTR_SIZE,a=s===4?"i32":"i64";this.opKernelContext=Number(n.getValue(s*r++,a));let o=Number(n.getValue(s*r++,a));this.outputCount=Number(n.getValue(s*r++,a)),this.customDataOffset=Number(n.getValue(s*r++,"*")),this.customDataSize=Number(n.getValue(s*r++,a));let l=[];for(let c=0;c<o;c++){let u=Number(n.getValue(s*r++,a)),f=Number(n.getValue(s*r++,"*")),d=Number(n.getValue(s*r++,a)),h=[];for(let p=0;p<d;p++)h.push(Number(n.getValue(s*r++,a)));l.push(new eA(n,u,f,h))}this.inputs=l}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(n,e){let t=e?.inputs?.map(o=>typeof o=="number"?this.inputs[o]:o)??this.inputs,s=e?.outputs??[],r=(o,l,c)=>new eA(this.module,l,this.output(o,c),c),a=(o,l)=>{let c=Vy(o,l);if(!c)throw new Error(`Unsupported data type: ${o}`);let u=c>0?this.backend.gpuDataManager.create(c).id:0;return new eA(this.module,o,u,l)};return this.backend.run(n,t,s,r,a,this.outputCount)}output(n,e){let t=this.module.stackSave();try{let s=this.module.PTR_SIZE,r=s===4?"i32":"i64",a=this.module.stackAlloc((1+e.length)*s);this.module.setValue(a,e.length,r);for(let o=0;o<e.length;o++)this.module.setValue(a+s*(o+1),e[o],r);return this.module._JsepOutput(this.opKernelContext,n,a)}catch(s){throw new Error(`Failed to generate kernel's output[${n}] with dims [${e}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${s}`)}finally{this.module.stackRestore(t)}}},rme=async(n,e,t,s)=>{let r=e.jsepInit;if(!r)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(n==="webgpu"){let a=(Rst(),XM(tme)).WebGpuBackend,o=new a;await o.initialize(t,s),r("webgpu",[o,l=>o.alloc(Number(l)),l=>o.free(l),(l,c,u,f=!1)=>{if(f)$r("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(l)}, dst=${Number(c)}, size=${Number(u)}`),o.memcpy(Number(l),Number(c));else{$r("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(l)}, gpuDataId=${Number(c)}, size=${Number(u)}`);let d=e.HEAPU8.subarray(Number(l>>>0),Number(l>>>0)+Number(u));o.upload(Number(c),d)}},async(l,c,u)=>{$r("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${l}, dataOffset=${c}, size=${u}`),await o.download(Number(l),()=>e.HEAPU8.subarray(Number(c)>>>0,Number(c+u)>>>0))},(l,c,u)=>o.createKernel(l,Number(c),u,e.UTF8ToString(e._JsepGetNodeName(Number(c)))),l=>o.releaseKernel(l),(l,c,u,f)=>{$r("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${u}, kernel=${l}, contextDataOffset=${c}`);let d=new yQ(e,o,Number(c));return o.computeKernel(Number(l),d,f)},()=>o.captureBegin(),()=>o.captureEnd(),()=>o.replay()])}else{let a=new mde(t);r("webnn",[a,()=>a.reserveTensorId(),o=>a.releaseTensorId(o),async(o,l,c,u,f)=>a.ensureTensor(o,l,c,u,f),(o,l)=>{a.uploadTensor(o,l)},async(o,l)=>a.downloadTensor(o,l)])}}}),bQ,OU,PU,$0,wQ,N$,s4,$U,jU,D$,RU,FU,zU,ame=pn(()=>{Wnt(),Gnt(),Ns(),aw(),yU(),cde(),bQ=(n,e)=>{ra()._OrtInit(n,e)!==0&&Ai("Can't initialize onnxruntime.")},OU=async n=>{bQ(n.wasm.numThreads,JN(n.logLevel))},PU=async(n,e)=>{ra().asyncInit?.();{let t=(Fst(),XM(sme)).init;if(e==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let s=n.webgpu.adapter;if(s){if(typeof s.limits!="object"||typeof s.features!="object"||typeof s.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let r=n.webgpu.powerPreference;if(r!==void 0&&r!=="low-power"&&r!=="high-performance")throw new Error(`Invalid powerPreference setting: "${r}"`);let a=n.webgpu.forceFallbackAdapter;if(a!==void 0&&typeof a!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${a}"`);if(s=await navigator.gpu.requestAdapter({powerPreference:r,forceFallbackAdapter:a}),!s)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await t("webgpu",ra(),n,s)}if(e==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await t("webnn",ra(),n)}}},$0=new Map,wQ=n=>{let e=ra(),t=e.stackSave();try{let s=e.PTR_SIZE,r=e.stackAlloc(2*s);e._OrtGetInputOutputCount(n,r,r+s)!==0&&Ai("Can't get session input/output count.");let a=s===4?"i32":"i64";return[Number(e.getValue(r,a)),Number(e.getValue(r+s,a))]}finally{e.stackRestore(t)}},N$=(n,e)=>{let t=ra(),s=t.stackSave(),r=0;try{let a=t.PTR_SIZE,o=t.stackAlloc(2*a);t._OrtGetInputOutputMetadata(n,e,o,o+a)!==0&&Ai("Can't get session input/output metadata.");let l=Number(t.getValue(o,"*"));r=Number(t.getValue(o+a,"*"));let c=t.HEAP32[r/4];if(c===0)return[l,0];let u=t.HEAPU32[r/4+1],f=[];for(let d=0;d<u;d++){let h=Number(t.getValue(r+8+d*a,"*"));f.push(h!==0?t.UTF8ToString(h):Number(t.getValue(r+8+(d+u)*a,"*")))}return[l,c,f]}finally{t.stackRestore(s),r!==0&&t._OrtFree(r)}},s4=n=>{let e=ra(),t=e._malloc(n.byteLength);if(t===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${n.byteLength}.`);return e.HEAPU8.set(n,t),[t,n.byteLength]},$U=async(n,e)=>{let t,s,r=ra();Array.isArray(n)?[t,s]=n:n.buffer===r.HEAPU8.buffer?[t,s]=[n.byteOffset,n.byteLength]:[t,s]=s4(n);let a=0,o=0,l=0,c=[],u=[],f=[];try{if([o,c]=await lde(e),e?.externalData&&r.mountExternalData){let C=[];for(let M of e.externalData){let k=typeof M=="string"?M:M.path;C.push(_U(typeof M=="string"?M:M.data).then(E=>{r.mountExternalData(k,E)}))}await Promise.all(C)}for(let C of e?.executionProviders??[])if((typeof C=="string"?C:C.name)==="webnn"){if(r.shouldTransferToMLTensor=!1,typeof C!="string"){let M=C,k=M?.context,E=M?.gpuDevice,I=M?.deviceType,A=M?.powerPreference;k?r.currentContext=k:E?r.currentContext=await r.webnnCreateMLContext(E):r.currentContext=await r.webnnCreateMLContext({deviceType:I,powerPreference:A})}else r.currentContext=await r.webnnCreateMLContext();break}a=await r._OrtCreateSession(t,s,o),r.webgpuOnCreateSession?.(a),a===0&&Ai("Can't create a session."),r.jsepOnCreateSession?.(),r.currentContext&&(r.webnnRegisterMLContext(a,r.currentContext),r.currentContext=void 0,r.shouldTransferToMLTensor=!0);let[d,h]=wQ(a),p=!!e?.enableGraphCapture,g=[],b=[],v=[],w=[],x=[];for(let C=0;C<d;C++){let[M,k,E]=N$(a,C);M===0&&Ai("Can't get an input name."),u.push(M);let I=r.UTF8ToString(M);g.push(I),v.push(k===0?{name:I,isTensor:!1}:{name:I,isTensor:!0,type:Tg(k),shape:E})}for(let C=0;C<h;C++){let[M,k,E]=N$(a,C+d);M===0&&Ai("Can't get an output name."),f.push(M);let I=r.UTF8ToString(M);b.push(I),w.push(k===0?{name:I,isTensor:!1}:{name:I,isTensor:!0,type:Tg(k),shape:E});{if(p&&e?.preferredOutputLocation===void 0){x.push("gpu-buffer");continue}let A=typeof e?.preferredOutputLocation=="string"?e.preferredOutputLocation:e?.preferredOutputLocation?.[I]??"cpu";if(A!=="cpu"&&A!=="cpu-pinned"&&A!=="gpu-buffer"&&A!=="ml-tensor")throw new Error(`Not supported preferred output location: ${A}.`);if(p&&A!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${A}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);x.push(A)}}let S=null;return x.some(C=>C==="gpu-buffer"||C==="ml-tensor")&&(l=r._OrtCreateBinding(a),l===0&&Ai("Can't create IO binding."),S={handle:l,outputPreferredLocations:x,outputPreferredLocationsEncoded:x.map(C=>x6(C))}),$0.set(a,[a,u,f,S,p,!1]),[a,g,b,v,w]}catch(d){throw u.forEach(h=>r._OrtFree(h)),f.forEach(h=>r._OrtFree(h)),l!==0&&r._OrtReleaseBinding(l)!==0&&Ai("Can't release IO binding."),a!==0&&r._OrtReleaseSession(a)!==0&&Ai("Can't release session."),d}finally{r._free(t),o!==0&&r._OrtReleaseSessionOptions(o)!==0&&Ai("Can't release session options."),c.forEach(d=>r._free(d)),r.unmountExternalData?.()}},jU=n=>{let e=ra(),t=$0.get(n);if(!t)throw new Error(`cannot release session. invalid session id: ${n}`);let[s,r,a,o,l]=t;o&&(l&&e._OrtClearBoundOutputs(o.handle)!==0&&Ai("Can't clear bound outputs."),e._OrtReleaseBinding(o.handle)!==0&&Ai("Can't release IO binding.")),e.jsepOnReleaseSession?.(n),e.webnnOnReleaseSession?.(n),e.webgpuOnReleaseSession?.(n),r.forEach(c=>e._OrtFree(c)),a.forEach(c=>e._OrtFree(c)),e._OrtReleaseSession(s)!==0&&Ai("Can't release session."),$0.delete(n)},D$=async(n,e,t,s,r,a,o=!1)=>{if(!n){e.push(0);return}let l=ra(),c=l.PTR_SIZE,u=n[0],f=n[1],d=n[3],h=d,p,g;if(u==="string"&&(d==="gpu-buffer"||d==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(o&&d!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${a} when enableGraphCapture is true.`);if(d==="gpu-buffer"){let w=n[2].gpuBuffer;g=Vy(Lv(u),f);{let x=l.jsepRegisterBuffer;if(!x)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');p=x(s,a,w,g)}}else if(d==="ml-tensor"){let w=n[2].mlTensor;g=Vy(Lv(u),f);let x=l.webnnRegisterMLTensor;if(!x)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');p=x(s,w,Lv(u),f)}else{let w=n[2];if(Array.isArray(w)){g=c*w.length,p=l._malloc(g),t.push(p);for(let x=0;x<w.length;x++){if(typeof w[x]!="string")throw new TypeError(`tensor data at index ${x} is not a string`);l.setValue(p+x*c,ep(w[x],t),"*")}}else{let x=l.webnnIsGraphInput;if(u!=="string"&&x){let S=l.UTF8ToString(r);if(x(s,S)){let C=Lv(u);g=Vy(C,f),h="ml-tensor";let M=l.webnnCreateTemporaryTensor,k=l.webnnUploadTensor;if(!M||!k)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let E=await M(s,C,f);k(E,new Uint8Array(w.buffer,w.byteOffset,w.byteLength)),p=E}else g=w.byteLength,p=l._malloc(g),t.push(p),l.HEAPU8.set(new Uint8Array(w.buffer,w.byteOffset,g),p)}else g=w.byteLength,p=l._malloc(g),t.push(p),l.HEAPU8.set(new Uint8Array(w.buffer,w.byteOffset,g),p)}}let b=l.stackSave(),v=l.stackAlloc(4*f.length);try{f.forEach((x,S)=>l.setValue(v+S*c,x,c===4?"i32":"i64"));let w=l._OrtCreateTensor(Lv(u),p,g,v,f.length,x6(h));w===0&&Ai(`Can't create tensor for input/output. session=${s}, index=${a}.`),e.push(w)}finally{l.stackRestore(b)}},RU=async(n,e,t,s,r,a)=>{let o=ra(),l=o.PTR_SIZE,c=$0.get(n);if(!c)throw new Error(`cannot run inference. invalid session id: ${n}`);let u=c[0],f=c[1],d=c[2],h=c[3],p=c[4],g=c[5],b=e.length,v=s.length,w=0,x=[],S=[],C=[],M=[],k=o.stackSave(),E=o.stackAlloc(b*l),I=o.stackAlloc(b*l),A=o.stackAlloc(v*l),D=o.stackAlloc(v*l);try{[w,x]=ode(a);for(let j=0;j<b;j++)await D$(t[j],S,M,n,f[e[j]],e[j],p);for(let j=0;j<v;j++)await D$(r[j],C,M,n,d[s[j]],b+s[j],p);for(let j=0;j<b;j++)o.setValue(E+j*l,S[j],"*"),o.setValue(I+j*l,f[e[j]],"*");for(let j=0;j<v;j++)o.setValue(A+j*l,C[j],"*"),o.setValue(D+j*l,d[s[j]],"*");if(h&&!g){let{handle:j,outputPreferredLocations:G,outputPreferredLocationsEncoded:Q}=h;if(f.length!==b)throw new Error(`input count from feeds (${b}) is expected to be always equal to model's input count (${f.length}).`);for(let q=0;q<b;q++){let te=e[q];await o._OrtBindInput(j,f[te],S[q])!==0&&Ai(`Can't bind input[${q}] for session=${n}.`)}for(let q=0;q<v;q++){let te=s[q];r[q]?.[3]?o._OrtBindOutput(j,d[te],C[q],0)!==0&&Ai(`Can't bind pre-allocated output[${q}] for session=${n}.`):o._OrtBindOutput(j,d[te],0,Q[te])!==0&&Ai(`Can't bind output[${q}] to ${G[q]} for session=${n}.`)}$0.set(n,[u,f,d,h,p,!0])}o.jsepOnRunStart?.(u),o.webnnOnRunStart?.(u);let L;h?L=await o._OrtRunWithBinding(u,h.handle,v,A,w):L=await o._OrtRun(u,I,E,b,D,v,A,w),L!==0&&Ai("failed to call OrtRun().");let P=[];for(let j=0;j<v;j++){let G=Number(o.getValue(A+j*l,"*"));if(G===C[j]){P.push(r[j]);continue}let Q=o.stackSave(),q=o.stackAlloc(4*l),te=!1,Z,ne=0;try{o._OrtGetTensorData(G,q,q+l,q+2*l,q+3*l)!==0&&Ai(`Can't access output tensor data on index ${j}.`);let le=l===4?"i32":"i64",H=Number(o.getValue(q,le));ne=o.getValue(q+l,"*");let R=o.getValue(q+l*2,"*"),B=Number(o.getValue(q+l*3,le)),W=[];for(let ge=0;ge<B;ge++)W.push(Number(o.getValue(R+ge*l,le)));o._OrtFree(R)!==0&&Ai("Can't free memory for tensor dims.");let se=W.reduce((ge,Ce)=>ge*Ce,1);Z=Tg(H);let ue=h?.outputPreferredLocations[s[j]];if(Z==="string"){if(ue==="gpu-buffer"||ue==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let ge=[];for(let Ce=0;Ce<se;Ce++){let Se=o.getValue(ne+Ce*l,"*"),Me=o.getValue(ne+(Ce+1)*l,"*"),pe=Ce===se-1?void 0:Me-Se;ge.push(o.UTF8ToString(Se,pe))}P.push([Z,W,ge,"cpu"])}else if(ue==="gpu-buffer"&&se>0){let ge=o.jsepGetBuffer;if(!ge)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let Ce=ge(ne),Se=Vy(H,se);if(Se===void 0||!wU(Z))throw new Error(`Unsupported data type: ${Z}`);te=!0,P.push([Z,W,{gpuBuffer:Ce,download:o.jsepCreateDownloader(Ce,Se,Z),dispose:()=>{o._OrtReleaseTensor(G)!==0&&Ai("Can't release tensor.")}},"gpu-buffer"])}else if(ue==="ml-tensor"&&se>0){let ge=o.webnnEnsureTensor,Ce=o.webnnIsInt64Supported;if(!ge||!Ce)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Vy(H,se)===void 0||!vU(Z))throw new Error(`Unsupported data type: ${Z}`);if(Z==="int64"&&!Ce(n))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let Se=await ge(n,ne,H,W,!1);te=!0,P.push([Z,W,{mlTensor:Se,download:o.webnnCreateMLTensorDownloader(ne,Z),dispose:()=>{o.webnnReleaseTensorId(ne),o._OrtReleaseTensor(G)}},"ml-tensor"])}else{let ge=bU(Z),Ce=new ge(se);new Uint8Array(Ce.buffer,Ce.byteOffset,Ce.byteLength).set(o.HEAPU8.subarray(ne,ne+Ce.byteLength)),P.push([Z,W,Ce,"cpu"])}}finally{o.stackRestore(Q),Z==="string"&&ne&&o._free(ne),te||o._OrtReleaseTensor(G),o.webnnOnRunEnd?.(u)}}return h&&!p&&(o._OrtClearBoundOutputs(h.handle)!==0&&Ai("Can't clear bound outputs."),$0.set(n,[u,f,d,h,p,!1])),P}finally{o.stackRestore(k),S.forEach(L=>o._OrtReleaseTensor(L)),C.forEach(L=>o._OrtReleaseTensor(L)),M.forEach(L=>o._free(L)),w!==0&&o._OrtReleaseRunOptions(w),x.forEach(L=>o._free(L))}},FU=n=>{let e=ra(),t=$0.get(n);if(!t)throw new Error("invalid session id");let s=t[0],r=e._OrtEndProfiling(s);r===0&&Ai("Can't get an profile file name."),e._OrtFree(r)},zU=n=>{let e=[];for(let t of n){let s=t[2];!Array.isArray(s)&&"buffer"in s&&e.push(s.buffer)}return e}}),j0,Qd,bv,iS,aS,tA,O$,nA,wy,vy,vQ,ome,lme,cme,ume,fme,dme,hme,pme=pn(()=>{kp(),ame(),aw(),mU(),j0=()=>!!pa.wasm.proxy&&typeof document<"u",bv=!1,iS=!1,aS=!1,nA=new Map,wy=(n,e)=>{let t=nA.get(n);t?t.push(e):nA.set(n,[e])},vy=()=>{if(bv||!iS||aS||!Qd)throw new Error("worker not ready")},vQ=n=>{switch(n.data.type){case"init-wasm":bv=!1,n.data.err?(aS=!0,O$[1](n.data.err)):(iS=!0,O$[0]()),tA&&(URL.revokeObjectURL(tA),tA=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let e=nA.get(n.data.type);n.data.err?e.shift()[1](n.data.err):e.shift()[0](n.data.out);break}}},ome=async()=>{if(!iS){if(bv)throw new Error("multiple calls to 'initWasm()' detected.");if(aS)throw new Error("previous call to 'initWasm()' failed.");if(bv=!0,j0())return new Promise((n,e)=>{Qd?.terminate(),ide().then(([t,s])=>{try{Qd=s,Qd.onerror=a=>e(a),Qd.onmessage=vQ,O$=[n,e];let r={type:"init-wasm",in:pa};!r.in.wasm.wasmPaths&&(t||_6)&&(r.in.wasm.wasmPaths={wasm:new URL(""+new URL("ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href,import.meta.url).href}),Qd.postMessage(r),tA=t}catch(r){e(r)}},e)});try{await gU(pa.wasm),await OU(pa),iS=!0}catch(n){throw aS=!0,n}finally{bv=!1}}},lme=async n=>{if(j0())return vy(),new Promise((e,t)=>{wy("init-ep",[e,t]);let s={type:"init-ep",in:{epName:n,env:pa}};Qd.postMessage(s)});await PU(pa,n)},cme=async n=>j0()?(vy(),new Promise((e,t)=>{wy("copy-from",[e,t]);let s={type:"copy-from",in:{buffer:n}};Qd.postMessage(s,[n.buffer])})):s4(n),ume=async(n,e)=>{if(j0()){if(e?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return vy(),new Promise((t,s)=>{wy("create",[t,s]);let r={type:"create",in:{model:n,options:{...e}}},a=[];n instanceof Uint8Array&&a.push(n.buffer),Qd.postMessage(r,a)})}else return $U(n,e)},fme=async n=>{if(j0())return vy(),new Promise((e,t)=>{wy("release",[e,t]);let s={type:"release",in:n};Qd.postMessage(s)});jU(n)},dme=async(n,e,t,s,r,a)=>{if(j0()){if(t.some(o=>o[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(r.some(o=>o))throw new Error("pre-allocated output tensor is not supported for proxy.");return vy(),new Promise((o,l)=>{wy("run",[o,l]);let c=t,u={type:"run",in:{sessionId:n,inputIndices:e,inputs:c,outputIndices:s,options:a}};Qd.postMessage(u,zU(c))})}else return RU(n,e,t,s,r,a)},hme=async n=>{if(j0())return vy(),new Promise((e,t)=>{wy("end-profiling",[e,t]);let s={type:"end-profiling",in:n};Qd.postMessage(s)});FU(n)}}),P$,_Q,mme,zst=pn(()=>{kp(),pme(),Ns(),pU(),cde(),P$=(n,e)=>{switch(n.location){case"cpu":return[n.type,n.dims,n.data,"cpu"];case"gpu-buffer":return[n.type,n.dims,{gpuBuffer:n.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[n.type,n.dims,{mlTensor:n.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${n.location} for ${e()}`)}},_Q=n=>{switch(n[3]){case"cpu":return new sp(n[0],n[2],n[1]);case"gpu-buffer":{let e=n[0];if(!wU(e))throw new Error(`not supported data type: ${e} for deserializing GPU tensor`);let{gpuBuffer:t,download:s,dispose:r}=n[2];return sp.fromGpuBuffer(t,{dataType:e,dims:n[1],download:s,dispose:r})}case"ml-tensor":{let e=n[0];if(!vU(e))throw new Error(`not supported data type: ${e} for deserializing MLTensor tensor`);let{mlTensor:t,download:s,dispose:r}=n[2];return sp.fromMLTensor(t,{dataType:e,dims:n[1],download:s,dispose:r})}default:throw new Error(`invalid data location: ${n[3]}`)}},mme=class{async fetchModelAndCopyToWasmMemory(n){return cme(await _U(n))}async loadModel(n,e){vp();let t;typeof n=="string"?t=await this.fetchModelAndCopyToWasmMemory(n):t=n,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await ume(t,e),hh()}async dispose(){return fme(this.sessionId)}async run(n,e,t){vp();let s=[],r=[];Object.entries(n).forEach(d=>{let h=d[0],p=d[1],g=this.inputNames.indexOf(h);if(g===-1)throw new Error(`invalid input '${h}'`);s.push(p),r.push(g)});let a=[],o=[];Object.entries(e).forEach(d=>{let h=d[0],p=d[1],g=this.outputNames.indexOf(h);if(g===-1)throw new Error(`invalid output '${h}'`);a.push(p),o.push(g)});let l=s.map((d,h)=>P$(d,()=>`input "${this.inputNames[r[h]]}"`)),c=a.map((d,h)=>d?P$(d,()=>`output "${this.outputNames[o[h]]}"`):null),u=await dme(this.sessionId,r,l,o,c,t),f={};for(let d=0;d<u.length;d++)f[this.outputNames[o[d]]]=a[d]??_Q(u[d]);return hh(),f}startProfiling(){}endProfiling(){hme(this.sessionId)}}}),gme={};rx(gme,{OnnxruntimeWebAssemblyBackend:()=>$6,initializeFlags:()=>P6,wasmBackend:()=>yme});var P6,$6,yme,Bst=pn(()=>{kp(),pme(),zst(),P6=()=>{(typeof pa.wasm.initTimeout!="number"||pa.wasm.initTimeout<0)&&(pa.wasm.initTimeout=0);let n=pa.wasm.simd;if(typeof n!="boolean"&&n!==void 0&&n!=="fixed"&&n!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${n}". Reset it to \`false\` and ignore SIMD feature checking.`),pa.wasm.simd=!1),typeof pa.wasm.proxy!="boolean"&&(pa.wasm.proxy=!1),typeof pa.wasm.trace!="boolean"&&(pa.wasm.trace=!1),typeof pa.wasm.numThreads!="number"||!Number.isInteger(pa.wasm.numThreads)||pa.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)pa.wasm.numThreads=1;else{let e=typeof navigator>"u"?knt("node:os").cpus().length:navigator.hardwareConcurrency;pa.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},$6=class{async init(n){P6(),await ome(),await lme(n)}async createInferenceSessionHandler(n,e){let t=new mme;return await t.loadModel(n,e),t}},yme=new $6});kp();kp();kp();var Ust="1.22.0-dev.20250409-89f8206ba4",Vst=Zfe;{let n=(Bst(),XM(gme)).wasmBackend;Yy("webgpu",n,5),Yy("webnn",n,5),Yy("cpu",n,10),Yy("wasm",n,10)}Object.defineProperty(pa.versions,"web",{value:Ust,enumerable:!0});const Wst=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return hU},get TRACE(){return QM},get TRACE_FUNC_BEGIN(){return vp},get TRACE_FUNC_END(){return hh},get Tensor(){return sp},default:Vst,get env(){return pa},get registerBackend(){return Yy}},Symbol.toStringTag,{value:"Module"}));var $$={},Gst={"onnxruntime-common":(n=>{n.exports=Cnt}),"onnxruntime-web":(n=>{n.exports=Wst}),"?2ce3":(()=>{}),"?7992":(()=>{}),"?5af5":(()=>{}),"?2b25":(()=>{}),"?db59":(()=>{}),"?383f":(()=>{}),"?fa4b":(()=>{}),"./node_modules/@huggingface/jinja/dist/index.js":((n,e,t)=>{t.r(e),t.d(e,{Environment:()=>Qt,Interpreter:()=>En,Template:()=>ro,parse:()=>ge,tokenize:()=>d});var s=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Comment:"Comment"}),r=class{constructor(re,Pe){this.value=re,this.type=Pe}};function a(re){return/\w/.test(re)}function o(re){return/[0-9]/.test(re)}function l(re){return/\s/.test(re)}var c=[["{%",s.OpenStatement],["%}",s.CloseStatement],["{{",s.OpenExpression],["}}",s.CloseExpression],["(",s.OpenParen],[")",s.CloseParen],["{",s.OpenCurlyBracket],["}",s.CloseCurlyBracket],["[",s.OpenSquareBracket],["]",s.CloseSquareBracket],[",",s.Comma],[".",s.Dot],[":",s.Colon],["|",s.Pipe],["<=",s.ComparisonBinaryOperator],[">=",s.ComparisonBinaryOperator],["==",s.ComparisonBinaryOperator],["!=",s.ComparisonBinaryOperator],["<",s.ComparisonBinaryOperator],[">",s.ComparisonBinaryOperator],["+",s.AdditiveBinaryOperator],["-",s.AdditiveBinaryOperator],["~",s.AdditiveBinaryOperator],["*",s.MultiplicativeBinaryOperator],["/",s.MultiplicativeBinaryOperator],["%",s.MultiplicativeBinaryOperator],["=",s.Equals]],u=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function f(re,Pe={}){return re.endsWith(`
`)&&(re=re.slice(0,-1)),Pe.lstrip_blocks&&(re=re.replace(/^[ \t]*({[#%-])/gm,"$1")),Pe.trim_blocks&&(re=re.replace(/([#%-]})\n/g,"$1")),re.replace(/{%\s*(end)?generation\s*%}/gs,"")}function d(re,Pe={}){const ve=[],Oe=f(re,Pe);let ze=0,ut=0;const Et=un=>{let Gn="";for(;un(Oe[ze]);){if(Oe[ze]==="\\"){if(++ze,ze>=Oe.length)throw new SyntaxError("Unexpected end of input");const hn=Oe[ze++],vs=u.get(hn);if(vs===void 0)throw new SyntaxError(`Unexpected escaped character: ${hn}`);Gn+=vs;continue}if(Gn+=Oe[ze++],ze>=Oe.length)throw new SyntaxError("Unexpected end of input")}return Gn},rn=()=>{const un=ve.at(-1);un&&un.type===s.Text&&(un.value=un.value.trimEnd(),un.value===""&&ve.pop())},xn=()=>{for(;ze<Oe.length&&l(Oe[ze]);)++ze};e:for(;ze<Oe.length;){const un=ve.at(-1)?.type;if(un===void 0||un===s.CloseStatement||un===s.CloseExpression||un===s.Comment){let hn="";for(;ze<Oe.length&&!(Oe[ze]==="{"&&(Oe[ze+1]==="%"||Oe[ze+1]==="{"||Oe[ze+1]==="#"));)hn+=Oe[ze++];if(hn.length>0){ve.push(new r(hn,s.Text));continue}}if(Oe[ze]==="{"&&Oe[ze+1]==="#"){ze+=2;const hn=Oe[ze]==="-";hn&&++ze;let vs="";for(;Oe[ze]!=="#"||Oe[ze+1]!=="}";){if(ze+2>=Oe.length)throw new SyntaxError("Missing end of comment tag");vs+=Oe[ze++]}const _s=vs.endsWith("-");_s&&(vs=vs.slice(0,-1)),hn&&rn(),ve.push(new r(vs,s.Comment)),ze+=2,_s&&xn();continue}if(Oe.slice(ze,ze+3)==="{%-"){rn(),ve.push(new r("{%",s.OpenStatement)),ze+=3;continue}if(Oe.slice(ze,ze+3)==="{{-"){rn(),ve.push(new r("{{",s.OpenExpression)),ut=0,ze+=3;continue}if(Et(l),Oe.slice(ze,ze+3)==="-%}"){ve.push(new r("%}",s.CloseStatement)),ze+=3,xn();continue}if(Oe.slice(ze,ze+3)==="-}}"){ve.push(new r("}}",s.CloseExpression)),ze+=3,xn();continue}const Gn=Oe[ze];if(Gn==="-"||Gn==="+"){const hn=ve.at(-1)?.type;if(hn===s.Text||hn===void 0)throw new SyntaxError(`Unexpected character: ${Gn}`);switch(hn){case s.Identifier:case s.NumericLiteral:case s.StringLiteral:case s.CloseParen:case s.CloseSquareBracket:break;default:{++ze;const vs=Et(o);ve.push(new r(`${Gn}${vs}`,vs.length>0?s.NumericLiteral:s.UnaryOperator));continue}}}for(const[hn,vs]of c){if(hn==="}}"&&ut>0)continue;if(Oe.slice(ze,ze+hn.length)===hn){ve.push(new r(hn,vs)),vs===s.OpenExpression?ut=0:vs===s.OpenCurlyBracket?++ut:vs===s.CloseCurlyBracket&&--ut,ze+=hn.length;continue e}}if(Gn==="'"||Gn==='"'){++ze;const hn=Et(vs=>vs!==Gn);ve.push(new r(hn,s.StringLiteral)),++ze;continue}if(o(Gn)){let hn=Et(o);if(Oe[ze]==="."&&o(Oe[ze+1])){++ze;const vs=Et(o);hn=`${hn}.${vs}`}ve.push(new r(hn,s.NumericLiteral));continue}if(a(Gn)){const hn=Et(a);ve.push(new r(hn,s.Identifier));continue}throw new SyntaxError(`Unexpected character: ${Gn}`)}return ve}var h=class{type="Statement"},p=class extends h{constructor(re){super(),this.body=re}type="Program"},g=class extends h{constructor(re,Pe,ve){super(),this.test=re,this.body=Pe,this.alternate=ve}type="If"},b=class extends h{constructor(re,Pe,ve,Oe){super(),this.loopvar=re,this.iterable=Pe,this.body=ve,this.defaultBlock=Oe}type="For"},v=class extends h{type="Break"},w=class extends h{type="Continue"},x=class extends h{constructor(re,Pe,ve){super(),this.assignee=re,this.value=Pe,this.body=ve}type="Set"},S=class extends h{constructor(re,Pe,ve){super(),this.name=re,this.args=Pe,this.body=ve}type="Macro"},C=class extends h{constructor(re){super(),this.value=re}type="Comment"},M=class extends h{type="Expression"},k=class extends M{constructor(re,Pe,ve){super(),this.object=re,this.property=Pe,this.computed=ve}type="MemberExpression"},E=class extends M{constructor(re,Pe){super(),this.callee=re,this.args=Pe}type="CallExpression"},I=class extends M{constructor(re){super(),this.value=re}type="Identifier"},A=class extends M{constructor(re){super(),this.value=re}type="Literal"},D=class extends A{type="IntegerLiteral"},L=class extends A{type="FloatLiteral"},P=class extends A{type="StringLiteral"},j=class extends A{type="ArrayLiteral"},G=class extends A{type="TupleLiteral"},Q=class extends A{type="ObjectLiteral"},q=class extends M{constructor(re,Pe,ve){super(),this.operator=re,this.left=Pe,this.right=ve}type="BinaryExpression"},te=class extends M{constructor(re,Pe){super(),this.operand=re,this.filter=Pe}type="FilterExpression"},Z=class extends h{constructor(re,Pe){super(),this.filter=re,this.body=Pe}type="FilterStatement"},ne=class extends M{constructor(re,Pe){super(),this.lhs=re,this.test=Pe}type="SelectExpression"},le=class extends M{constructor(re,Pe,ve){super(),this.operand=re,this.negate=Pe,this.test=ve}type="TestExpression"},H=class extends M{constructor(re,Pe){super(),this.operator=re,this.argument=Pe}type="UnaryExpression"},R=class extends M{constructor(re=void 0,Pe=void 0,ve=void 0){super(),this.start=re,this.stop=Pe,this.step=ve}type="SliceExpression"},B=class extends M{constructor(re,Pe){super(),this.key=re,this.value=Pe}type="KeywordArgumentExpression"},W=class extends M{constructor(re){super(),this.argument=re}type="SpreadExpression"},se=class extends h{constructor(re,Pe,ve){super(),this.call=re,this.callerArgs=Pe,this.body=ve}type="CallStatement"},ue=class extends M{constructor(re,Pe,ve){super(),this.condition=re,this.trueExpr=Pe,this.falseExpr=ve}type="Ternary"};function ge(re){const Pe=new p([]);let ve=0;function Oe(Zt,cn){const In=re[ve++];if(!In||In.type!==Zt)throw new Error(`Parser Error: ${cn}. ${In.type} !== ${Zt}.`);return In}function ze(Zt){if(!xn(Zt))throw new SyntaxError(`Expected ${Zt}`);++ve}function ut(){switch(re[ve].type){case s.Comment:return new C(re[ve++].value);case s.Text:return un();case s.OpenStatement:return Gn();case s.OpenExpression:return hn();default:throw new SyntaxError(`Unexpected token type: ${re[ve].type}`)}}function Et(...Zt){return ve+Zt.length<=re.length&&Zt.every((cn,In)=>cn===re[ve+In].type)}function rn(...Zt){return re[ve]?.type===s.OpenStatement&&re[ve+1]?.type===s.Identifier&&Zt.includes(re[ve+1]?.value)}function xn(...Zt){return ve+Zt.length<=re.length&&Zt.every((cn,In)=>re[ve+In].type==="Identifier"&&cn===re[ve+In].value)}function un(){return new P(Oe(s.Text,"Expected text token").value)}function Gn(){if(Oe(s.OpenStatement,"Expected opening statement token"),re[ve].type!==s.Identifier)throw new SyntaxError(`Unknown statement, got ${re[ve].type}`);const Zt=re[ve].value;let cn;switch(Zt){case"set":++ve,cn=vs();break;case"if":++ve,cn=_s(),Oe(s.OpenStatement,"Expected {% token"),ze("endif"),Oe(s.CloseStatement,"Expected %} token");break;case"macro":++ve,cn=Vr(),Oe(s.OpenStatement,"Expected {% token"),ze("endmacro"),Oe(s.CloseStatement,"Expected %} token");break;case"for":++ve,cn=Cr(),Oe(s.OpenStatement,"Expected {% token"),ze("endfor"),Oe(s.CloseStatement,"Expected %} token");break;case"call":{++ve;let In=null;Et(s.OpenParen)&&(In=yo());const Rs=Ga();if(Rs.type!=="Identifier")throw new SyntaxError("Expected identifier following call statement");const xi=yo();Oe(s.CloseStatement,"Expected closing statement token");const ci=[];for(;!rn("endcall");)ci.push(ut());Oe(s.OpenStatement,"Expected '{%'"),ze("endcall"),Oe(s.CloseStatement,"Expected closing statement token");const Gl=new E(Rs,xi);cn=new se(Gl,In,ci);break}case"break":++ve,Oe(s.CloseStatement,"Expected closing statement token"),cn=new v;break;case"continue":++ve,Oe(s.CloseStatement,"Expected closing statement token"),cn=new w;break;case"filter":{++ve;let In=Ga();In instanceof I&&Et(s.OpenParen)&&(In=pi(In)),Oe(s.CloseStatement,"Expected closing statement token");const Rs=[];for(;!rn("endfilter");)Rs.push(ut());Oe(s.OpenStatement,"Expected '{%'"),ze("endfilter"),Oe(s.CloseStatement,"Expected '%}'"),cn=new Z(In,Rs);break}default:throw new SyntaxError(`Unknown statement type: ${Zt}`)}return cn}function hn(){Oe(s.OpenExpression,"Expected opening expression token");const Zt=Kr();return Oe(s.CloseExpression,"Expected closing expression token"),Zt}function vs(){const Zt=Yr();let cn=null;const In=[];if(Et(s.Equals))++ve,cn=Yr();else{for(Oe(s.CloseStatement,"Expected %} token");!rn("endset");)In.push(ut());Oe(s.OpenStatement,"Expected {% token"),ze("endset")}return Oe(s.CloseStatement,"Expected closing statement token"),new x(Zt,cn,In)}function _s(){const Zt=Kr();Oe(s.CloseStatement,"Expected closing statement token");const cn=[],In=[];for(;!rn("elif","else","endif");)cn.push(ut());if(rn("elif")){++ve,++ve;const Rs=_s();In.push(Rs)}else if(rn("else"))for(++ve,++ve,Oe(s.CloseStatement,"Expected closing statement token");!rn("endif");)In.push(ut());return new g(Zt,cn,In)}function Vr(){const Zt=Ga();if(Zt.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const cn=yo();Oe(s.CloseStatement,"Expected closing statement token");const In=[];for(;!rn("endmacro");)In.push(ut());return new S(Zt,cn,In)}function Yr(Zt=!1){const cn=Zt?Ga:Kr,In=[cn()],Rs=Et(s.Comma);for(;Rs&&(++ve,In.push(cn()),!!Et(s.Comma)););return Rs?new G(In):In[0]}function Cr(){const Zt=Yr(!0);if(!(Zt instanceof I||Zt instanceof G))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${Zt.type} instead`);if(!xn("in"))throw new SyntaxError("Expected `in` keyword following loop variable");++ve;const cn=Kr();Oe(s.CloseStatement,"Expected closing statement token");const In=[];for(;!rn("endfor","else");)In.push(ut());const Rs=[];if(rn("else"))for(++ve,++ve,Oe(s.CloseStatement,"Expected closing statement token");!rn("endfor");)Rs.push(ut());return new b(Zt,cn,In,Rs)}function Kr(){return sl()}function sl(){const Zt=Ni();if(xn("if")){++ve;const cn=Ni();if(xn("else")){++ve;const In=sl();return new ue(cn,Zt,In)}else return new ne(Zt,cn)}return Zt}function Ni(){let Zt=Xr();for(;xn("or");){const cn=re[ve];++ve;const In=Xr();Zt=new q(cn,Zt,In)}return Zt}function Xr(){let Zt=ka();for(;xn("and");){const cn=re[ve];++ve;const In=ka();Zt=new q(cn,Zt,In)}return Zt}function ka(){let Zt;for(;xn("not");){const cn=re[ve];++ve;const In=ka();Zt=new H(cn,In)}return Zt??oi()}function oi(){let Zt=wa();for(;;){let cn;if(xn("not","in"))cn=new r("not in",s.Identifier),ve+=2;else if(xn("in"))cn=re[ve++];else if(Et(s.ComparisonBinaryOperator))cn=re[ve++];else break;const In=wa();Zt=new q(cn,Zt,In)}return Zt}function wa(){let Zt=bo();for(;Et(s.AdditiveBinaryOperator);){const cn=re[ve];++ve;const In=bo();Zt=new q(cn,Zt,In)}return Zt}function li(){const Zt=va(Ga());return Et(s.OpenParen)?pi(Zt):Zt}function pi(Zt){let cn=new E(Zt,yo());return cn=va(cn),Et(s.OpenParen)&&(cn=pi(cn)),cn}function yo(){Oe(s.OpenParen,"Expected opening parenthesis for arguments list");const Zt=rl();return Oe(s.CloseParen,"Expected closing parenthesis for arguments list"),Zt}function rl(){const Zt=[];for(;!Et(s.CloseParen);){let cn;if(re[ve].type===s.MultiplicativeBinaryOperator&&re[ve].value==="*"){++ve;const In=Kr();cn=new W(In)}else if(cn=Kr(),Et(s.Equals)){if(++ve,!(cn instanceof I))throw new SyntaxError("Expected identifier for keyword argument");const In=Kr();cn=new B(cn,In)}Zt.push(cn),Et(s.Comma)&&++ve}return Zt}function Gc(){const Zt=[];let cn=!1;for(;!Et(s.CloseSquareBracket);)Et(s.Colon)?(Zt.push(void 0),++ve,cn=!0):(Zt.push(Kr()),Et(s.Colon)&&(++ve,cn=!0));if(Zt.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(cn){if(Zt.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new R(...Zt)}return Zt[0]}function va(Zt){for(;Et(s.Dot)||Et(s.OpenSquareBracket);){const cn=re[ve];++ve;let In;const Rs=cn.type===s.OpenSquareBracket;if(Rs)In=Gc(),Oe(s.CloseSquareBracket,"Expected closing square bracket");else if(In=Ga(),In.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");Zt=new k(Zt,In,Rs)}return Zt}function bo(){let Zt=Wa();for(;Et(s.MultiplicativeBinaryOperator);){const cn=re[ve++],In=Wa();Zt=new q(cn,Zt,In)}return Zt}function Wa(){let Zt=Us();for(;xn("is");){++ve;const cn=xn("not");cn&&++ve;const In=Ga();if(!(In instanceof I))throw new SyntaxError("Expected identifier for the test");Zt=new le(Zt,cn,In)}return Zt}function Us(){let Zt=li();for(;Et(s.Pipe);){++ve;let cn=Ga();if(!(cn instanceof I))throw new SyntaxError("Expected identifier for the filter");Et(s.OpenParen)&&(cn=pi(cn)),Zt=new te(Zt,cn)}return Zt}function Ga(){const Zt=re[ve++];switch(Zt.type){case s.NumericLiteral:{const cn=Zt.value;return cn.includes(".")?new L(Number(cn)):new D(Number(cn))}case s.StringLiteral:{let cn=Zt.value;for(;Et(s.StringLiteral);)cn+=re[ve++].value;return new P(cn)}case s.Identifier:return new I(Zt.value);case s.OpenParen:{const cn=Yr();return Oe(s.CloseParen,"Expected closing parenthesis, got ${tokens[current].type} instead."),cn}case s.OpenSquareBracket:{const cn=[];for(;!Et(s.CloseSquareBracket);)cn.push(Kr()),Et(s.Comma)&&++ve;return++ve,new j(cn)}case s.OpenCurlyBracket:{const cn=new Map;for(;!Et(s.CloseCurlyBracket);){const In=Kr();Oe(s.Colon,"Expected colon between key and value in object literal");const Rs=Kr();cn.set(In,Rs),Et(s.Comma)&&++ve}return++ve,new Q(cn)}default:throw new SyntaxError(`Unexpected token: ${Zt.type}`)}}for(;ve<re.length;)Pe.body.push(ut());return Pe}function Ce(re,Pe,ve=1){Pe===void 0&&(Pe=re,re=0);const Oe=[];for(let ze=re;ze<Pe;ze+=ve)Oe.push(ze);return Oe}function Se(re,Pe,ve,Oe=1){const ze=Math.sign(Oe);ze>=0?(Pe=(Pe??=0)<0?Math.max(re.length+Pe,0):Math.min(Pe,re.length),ve=(ve??=re.length)<0?Math.max(re.length+ve,0):Math.min(ve,re.length)):(Pe=(Pe??=re.length-1)<0?Math.max(re.length+Pe,-1):Math.min(Pe,re.length-1),ve=(ve??=-1)<-1?Math.max(re.length+ve,-1):Math.min(ve,re.length-1));const ut=[];for(let Et=Pe;ze*Et<ze*ve;Et+=Oe)ut.push(re[Et]);return ut}function Me(re){return re.replace(/\b\w/g,Pe=>Pe.toUpperCase())}function pe(re){return fe(new Date,re)}function fe(re,Pe){const ve=new Intl.DateTimeFormat(void 0,{month:"long"}),Oe=new Intl.DateTimeFormat(void 0,{month:"short"}),ze=ut=>ut<10?"0"+ut:ut.toString();return Pe.replace(/%[YmdbBHM%]/g,ut=>{switch(ut){case"%Y":return re.getFullYear().toString();case"%m":return ze(re.getMonth()+1);case"%d":return ze(re.getDate());case"%b":return Oe.format(re);case"%B":return ve.format(re);case"%H":return ze(re.getHours());case"%M":return ze(re.getMinutes());case"%%":return"%";default:return ut}})}function $e(re){return re.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function We(re,Pe,ve,Oe){if(Oe===0)return re;let ze=Oe==null||Oe<0?1/0:Oe;const ut=Pe.length===0?new RegExp("(?=)","gu"):new RegExp($e(Pe),"gu");return re.replaceAll(ut,Et=>ze>0?(--ze,ve):Et)}var de=class extends Error{},Be=class extends Error{},st=class{type="RuntimeValue";value;builtins=new Map;constructor(re=void 0){this.value=re}__bool__(){return new Ze(!!this.value)}toString(){return String(this.value)}},He=class extends st{type="IntegerValue"},Xe=class extends st{type="FloatValue";toString(){return this.value%1===0?this.value.toFixed(1):this.value.toString()}},Ke=class extends st{type="StringValue";builtins=new Map([["upper",new Gt(()=>new Ke(this.value.toUpperCase()))],["lower",new Gt(()=>new Ke(this.value.toLowerCase()))],["strip",new Gt(()=>new Ke(this.value.trim()))],["title",new Gt(()=>new Ke(Me(this.value)))],["capitalize",new Gt(()=>new Ke(this.value.charAt(0).toUpperCase()+this.value.slice(1)))],["length",new He(this.value.length)],["rstrip",new Gt(()=>new Ke(this.value.trimEnd()))],["lstrip",new Gt(()=>new Ke(this.value.trimStart()))],["startswith",new Gt(re=>{if(re.length===0)throw new Error("startswith() requires at least one argument");const Pe=re[0];if(Pe instanceof Ke)return new Ze(this.value.startsWith(Pe.value));if(Pe instanceof It){for(const ve of Pe.value){if(!(ve instanceof Ke))throw new Error("startswith() tuple elements must be strings");if(this.value.startsWith(ve.value))return new Ze(!0)}return new Ze(!1)}throw new Error("startswith() argument must be a string or tuple of strings")})],["endswith",new Gt(re=>{if(re.length===0)throw new Error("endswith() requires at least one argument");const Pe=re[0];if(Pe instanceof Ke)return new Ze(this.value.endsWith(Pe.value));if(Pe instanceof It){for(const ve of Pe.value){if(!(ve instanceof Ke))throw new Error("endswith() tuple elements must be strings");if(this.value.endsWith(ve.value))return new Ze(!0)}return new Ze(!1)}throw new Error("endswith() argument must be a string or tuple of strings")})],["split",new Gt(re=>{const Pe=re[0]??new At;if(!(Pe instanceof Ke||Pe instanceof At))throw new Error("sep argument must be a string or null");const ve=re[1]??new He(-1);if(!(ve instanceof He))throw new Error("maxsplit argument must be a number");let Oe=[];if(Pe instanceof At){const ze=this.value.trimStart();for(const{0:ut,index:Et}of ze.matchAll(/\S+/g)){if(ve.value!==-1&&Oe.length>=ve.value&&Et!==void 0){Oe.push(ut+ze.slice(Et+ut.length));break}Oe.push(ut)}}else{if(Pe.value==="")throw new Error("empty separator");Oe=this.value.split(Pe.value),ve.value!==-1&&Oe.length>ve.value&&Oe.push(Oe.splice(ve.value).join(Pe.value))}return new It(Oe.map(ze=>new Ke(ze)))})],["replace",new Gt(re=>{if(re.length<2)throw new Error("replace() requires at least two arguments");const Pe=re[0],ve=re[1];if(!(Pe instanceof Ke&&ve instanceof Ke))throw new Error("replace() arguments must be strings");let Oe;if(re.length>2?re[2].type==="KeywordArgumentsValue"?Oe=re[2].value.get("count")??new At:Oe=re[2]:Oe=new At,!(Oe instanceof He||Oe instanceof At))throw new Error("replace() count argument must be a number or null");return new Ke(We(this.value,Pe.value,ve.value,Oe.value))})]])},Ze=class extends st{type="BooleanValue"};function xt(re,Pe,ve,Oe=!0){const ze=ve??0;switch(re.type){case"NullValue":return"null";case"UndefinedValue":return Oe?"null":"undefined";case"IntegerValue":case"FloatValue":case"StringValue":case"BooleanValue":return JSON.stringify(re.value);case"ArrayValue":case"ObjectValue":{const ut=Pe?" ".repeat(Pe):"",Et=`
`+ut.repeat(ze),rn=Et+ut;if(re.type==="ArrayValue"){const xn=re.value.map(un=>xt(un,Pe,ze+1,Oe));return Pe?`[${rn}${xn.join(`,${rn}`)}${Et}]`:`[${xn.join(", ")}]`}else{const xn=Array.from(re.value.entries()).map(([un,Gn])=>{const hn=`"${un}": ${xt(Gn,Pe,ze+1,Oe)}`;return Pe?`${rn}${hn}`:hn});return Pe?`{${xn.join(",")}${Et}}`:`{${xn.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${re.type}`)}}var dt=class extends st{type="ObjectValue";__bool__(){return new Ze(this.value.size>0)}builtins=new Map([["get",new Gt(([re,Pe])=>{if(!(re instanceof Ke))throw new Error(`Object key must be a string: got ${re.type}`);return this.value.get(re.value)??Pe??new At})],["items",new Gt(()=>this.items())],["keys",new Gt(()=>this.keys())],["values",new Gt(()=>this.values())],["dictsort",new Gt(re=>{let Pe=new Map;const ve=re.filter(rn=>rn instanceof Ft?(Pe=rn.value,!1):!0),Oe=ve.at(0)??Pe.get("case_sensitive")??new Ze(!1);if(!(Oe instanceof Ze))throw new Error("case_sensitive must be a boolean");const ze=ve.at(1)??Pe.get("by")??new Ke("key");if(!(ze instanceof Ke))throw new Error("by must be a string");if(!["key","value"].includes(ze.value))throw new Error("by must be either 'key' or 'value'");const ut=ve.at(2)??Pe.get("reverse")??new Ze(!1);if(!(ut instanceof Ze))throw new Error("reverse must be a boolean");const Et=Array.from(this.value.entries()).map(([rn,xn])=>new It([new Ke(rn),xn])).sort((rn,xn)=>{const un=ze.value==="key"?0:1,Gn=rn.value[un],hn=xn.value[un],vs=yn(Gn,hn,Oe.value);return ut.value?-vs:vs});return new It(Et)})]]);items(){return new It(Array.from(this.value.entries()).map(([re,Pe])=>new It([new Ke(re),Pe])))}keys(){return new It(Array.from(this.value.keys()).map(re=>new Ke(re)))}values(){return new It(Array.from(this.value.values()))}toString(){return xt(this,null,0,!1)}},Ft=class extends dt{type="KeywordArgumentsValue"},It=class extends st{type="ArrayValue";builtins=new Map([["length",new He(this.value.length)]]);__bool__(){return new Ze(this.value.length>0)}toString(){return xt(this,null,0,!1)}},Bt=class extends It{type="TupleValue"},Gt=class extends st{type="FunctionValue"},At=class extends st{type="NullValue"},ht=class extends st{type="UndefinedValue"},Qt=class{constructor(re){this.parent=re}variables=new Map([["namespace",new Gt(re=>{if(re.length===0)return new dt(new Map);if(re.length!==1||!(re[0]instanceof dt))throw new Error("`namespace` expects either zero arguments or a single object argument");return re[0]})]]);tests=new Map([["boolean",re=>re.type==="BooleanValue"],["callable",re=>re instanceof Gt],["odd",re=>{if(!(re instanceof He))throw new Error(`cannot odd on ${re.type}`);return re.value%2!==0}],["even",re=>{if(!(re instanceof He))throw new Error(`cannot even on ${re.type}`);return re.value%2===0}],["false",re=>re.type==="BooleanValue"&&!re.value],["true",re=>re.type==="BooleanValue"&&re.value],["none",re=>re.type==="NullValue"],["string",re=>re.type==="StringValue"],["number",re=>re instanceof He||re instanceof Xe],["integer",re=>re instanceof He],["iterable",re=>re.type==="ArrayValue"||re.type==="StringValue"],["mapping",re=>re.type==="ObjectValue"],["lower",re=>{const Pe=re.value;return re.type==="StringValue"&&Pe===Pe.toLowerCase()}],["upper",re=>{const Pe=re.value;return re.type==="StringValue"&&Pe===Pe.toUpperCase()}],["none",re=>re.type==="NullValue"],["defined",re=>re.type!=="UndefinedValue"],["undefined",re=>re.type==="UndefinedValue"],["equalto",(re,Pe)=>re.value===Pe.value],["eq",(re,Pe)=>re.value===Pe.value]]);set(re,Pe){return this.declareVariable(re,Vn(Pe))}declareVariable(re,Pe){if(this.variables.has(re))throw new SyntaxError(`Variable already declared: ${re}`);return this.variables.set(re,Pe),Pe}setVariable(re,Pe){return this.variables.set(re,Pe),Pe}resolve(re){if(this.variables.has(re))return this;if(this.parent)return this.parent.resolve(re);throw new Error(`Unknown variable: ${re}`)}lookupVariable(re){try{return this.resolve(re).variables.get(re)??new ht}catch{return new ht}}};function Xt(re){re.set("false",!1),re.set("true",!0),re.set("none",null),re.set("raise_exception",Pe=>{throw new Error(Pe)}),re.set("range",Ce),re.set("strftime_now",pe),re.set("True",!0),re.set("False",!1),re.set("None",null)}function us(re,Pe){const ve=Pe.split(".");let Oe=re;for(const ze of ve)if(Oe instanceof dt)Oe=Oe.value.get(ze)??new ht;else if(Oe instanceof It){const ut=parseInt(ze,10);if(!isNaN(ut)&&ut>=0&&ut<Oe.value.length)Oe=Oe.value[ut];else return new ht}else return new ht;return Oe}function yn(re,Pe,ve=!1){if(re instanceof At&&Pe instanceof At)return 0;if(re instanceof At||Pe instanceof At)throw new Error(`Cannot compare ${re.type} with ${Pe.type}`);if(re instanceof ht&&Pe instanceof ht)return 0;if(re instanceof ht||Pe instanceof ht)throw new Error(`Cannot compare ${re.type} with ${Pe.type}`);const Oe=ut=>ut instanceof He||ut instanceof Xe||ut instanceof Ze,ze=ut=>ut instanceof Ze?ut.value?1:0:ut.value;if(Oe(re)&&Oe(Pe)){const ut=ze(re),Et=ze(Pe);return ut<Et?-1:ut>Et?1:0}if(re.type!==Pe.type)throw new Error(`Cannot compare different types: ${re.type} and ${Pe.type}`);if(re.type==="StringValue"){let ut=re.value,Et=Pe.value;return ve||(ut=ut.toLowerCase(),Et=Et.toLowerCase()),ut<Et?-1:ut>Et?1:0}else throw new Error(`Cannot compare type: ${re.type}`)}var En=class{global;constructor(re){this.global=re??new Qt}run(re){return this.evaluate(re,this.global)}evaluateBinaryExpression(re,Pe){const ve=this.evaluate(re.left,Pe);switch(re.operator.value){case"and":return ve.__bool__().value?this.evaluate(re.right,Pe):ve;case"or":return ve.__bool__().value?ve:this.evaluate(re.right,Pe)}const Oe=this.evaluate(re.right,Pe);switch(re.operator.value){case"==":return new Ze(ve.value==Oe.value);case"!=":return new Ze(ve.value!=Oe.value)}if(ve instanceof ht||Oe instanceof ht){if(Oe instanceof ht&&["in","not in"].includes(re.operator.value))return new Ze(re.operator.value==="not in");throw new Error(`Cannot perform operation ${re.operator.value} on undefined values`)}else{if(ve instanceof At||Oe instanceof At)throw new Error("Cannot perform operation on null values");if(re.operator.value==="~")return new Ke(ve.value.toString()+Oe.value.toString());if((ve instanceof He||ve instanceof Xe)&&(Oe instanceof He||Oe instanceof Xe)){const ze=ve.value,ut=Oe.value;switch(re.operator.value){case"+":case"-":case"*":{const Et=re.operator.value==="+"?ze+ut:re.operator.value==="-"?ze-ut:ze*ut;return ve instanceof Xe||Oe instanceof Xe?new Xe(Et):new He(Et)}case"/":return new Xe(ze/ut);case"%":{const Et=ze%ut;return ve instanceof Xe||Oe instanceof Xe?new Xe(Et):new He(Et)}case"<":return new Ze(ze<ut);case">":return new Ze(ze>ut);case">=":return new Ze(ze>=ut);case"<=":return new Ze(ze<=ut)}}else if(ve instanceof It&&Oe instanceof It){if(re.operator.value==="+")return new It(ve.value.concat(Oe.value))}else if(Oe instanceof It){const ze=Oe.value.find(ut=>ut.value===ve.value)!==void 0;switch(re.operator.value){case"in":return new Ze(ze);case"not in":return new Ze(!ze)}}}if((ve instanceof Ke||Oe instanceof Ke)&&re.operator.value==="+")return new Ke(ve.value.toString()+Oe.value.toString());if(ve instanceof Ke&&Oe instanceof Ke)switch(re.operator.value){case"in":return new Ze(Oe.value.includes(ve.value));case"not in":return new Ze(!Oe.value.includes(ve.value))}if(ve instanceof Ke&&Oe instanceof dt)switch(re.operator.value){case"in":return new Ze(Oe.value.has(ve.value));case"not in":return new Ze(!Oe.value.has(ve.value))}throw new SyntaxError(`Unknown operator "${re.operator.value}" between ${ve.type} and ${Oe.type}`)}evaluateArguments(re,Pe){const ve=[],Oe=new Map;for(const ze of re)if(ze.type==="SpreadExpression"){const ut=ze,Et=this.evaluate(ut.argument,Pe);if(!(Et instanceof It))throw new Error(`Cannot unpack non-iterable type: ${Et.type}`);for(const rn of Et.value)ve.push(rn)}else if(ze.type==="KeywordArgumentExpression"){const ut=ze;Oe.set(ut.key.value,this.evaluate(ut.value,Pe))}else{if(Oe.size>0)throw new Error("Positional arguments must come before keyword arguments");ve.push(this.evaluate(ze,Pe))}return[ve,Oe]}applyFilter(re,Pe,ve){if(Pe.type==="Identifier"){const Oe=Pe;if(Oe.value==="tojson")return new Ke(xt(re));if(re instanceof It)switch(Oe.value){case"list":return re;case"first":return re.value[0];case"last":return re.value[re.value.length-1];case"length":return new He(re.value.length);case"reverse":return new It(re.value.slice().reverse());case"sort":return new It(re.value.slice().sort((ze,ut)=>yn(ze,ut,!1)));case"join":return new Ke(re.value.map(ze=>ze.value).join(""));case"string":return new Ke(xt(re,null,0,!1));case"unique":{const ze=new Set,ut=[];for(const Et of re.value)ze.has(Et.value)||(ze.add(Et.value),ut.push(Et));return new It(ut)}default:throw new Error(`Unknown ArrayValue filter: ${Oe.value}`)}else if(re instanceof Ke)switch(Oe.value){case"length":case"upper":case"lower":case"title":case"capitalize":{const ze=re.builtins.get(Oe.value);if(ze instanceof Gt)return ze.value([],ve);if(ze instanceof He)return ze;throw new Error(`Unknown StringValue filter: ${Oe.value}`)}case"trim":return new Ke(re.value.trim());case"indent":return new Ke(re.value.split(`
`).map((ze,ut)=>ut===0||ze.length===0?ze:"    "+ze).join(`
`));case"join":case"string":return re;case"int":{const ze=parseInt(re.value,10);return new He(isNaN(ze)?0:ze)}case"float":{const ze=parseFloat(re.value);return new Xe(isNaN(ze)?0:ze)}default:throw new Error(`Unknown StringValue filter: ${Oe.value}`)}else if(re instanceof He||re instanceof Xe)switch(Oe.value){case"abs":return re instanceof He?new He(Math.abs(re.value)):new Xe(Math.abs(re.value));case"int":return new He(Math.floor(re.value));case"float":return new Xe(re.value);default:throw new Error(`Unknown NumericValue filter: ${Oe.value}`)}else if(re instanceof dt)switch(Oe.value){case"items":return new It(Array.from(re.value.entries()).map(([ze,ut])=>new It([new Ke(ze),ut])));case"length":return new He(re.value.size);default:{const ze=re.builtins.get(Oe.value);if(ze)return ze instanceof Gt?ze.value([],ve):ze;throw new Error(`Unknown ObjectValue filter: ${Oe.value}`)}}else if(re instanceof Ze)switch(Oe.value){case"bool":return new Ze(re.value);case"int":return new He(re.value?1:0);case"float":return new Xe(re.value?1:0);case"string":return new Ke(re.value?"true":"false");default:throw new Error(`Unknown BooleanValue filter: ${Oe.value}`)}throw new Error(`Cannot apply filter "${Oe.value}" to type: ${re.type}`)}else if(Pe.type==="CallExpression"){const Oe=Pe;if(Oe.callee.type!=="Identifier")throw new Error(`Unknown filter: ${Oe.callee.type}`);const ze=Oe.callee.value;if(ze==="tojson"){const[,ut]=this.evaluateArguments(Oe.args,ve),Et=ut.get("indent")??new At;if(!(Et instanceof He||Et instanceof At))throw new Error("If set, indent must be a number");return new Ke(xt(re,Et.value))}else if(ze==="join"){let ut;if(re instanceof Ke)ut=Array.from(re.value);else if(re instanceof It)ut=re.value.map(un=>un.value);else throw new Error(`Cannot apply filter "${ze}" to type: ${re.type}`);const[Et,rn]=this.evaluateArguments(Oe.args,ve),xn=Et.at(0)??rn.get("separator")??new Ke("");if(!(xn instanceof Ke))throw new Error("separator must be a string");return new Ke(ut.join(xn.value))}else if(ze==="int"||ze==="float"){const[ut,Et]=this.evaluateArguments(Oe.args,ve),rn=ut.at(0)??Et.get("default")??(ze==="int"?new He(0):new Xe(0));if(re instanceof Ke){const xn=ze==="int"?parseInt(re.value,10):parseFloat(re.value);return isNaN(xn)?rn:ze==="int"?new He(xn):new Xe(xn)}else{if(re instanceof He||re instanceof Xe)return re;if(re instanceof Ze)return ze==="int"?new He(re.value?1:0):new Xe(re.value?1:0);throw new Error(`Cannot apply filter "${ze}" to type: ${re.type}`)}}else if(ze==="default"){const[ut,Et]=this.evaluateArguments(Oe.args,ve),rn=ut[0]??new Ke(""),xn=ut[1]??Et.get("boolean")??new Ze(!1);if(!(xn instanceof Ze))throw new Error("`default` filter flag must be a boolean");return re instanceof ht||xn.value&&!re.__bool__().value?rn:re}if(re instanceof It){switch(ze){case"sort":{const[ut,Et]=this.evaluateArguments(Oe.args,ve),rn=ut.at(0)??Et.get("reverse")??new Ze(!1);if(!(rn instanceof Ze))throw new Error("reverse must be a boolean");const xn=ut.at(1)??Et.get("case_sensitive")??new Ze(!1);if(!(xn instanceof Ze))throw new Error("case_sensitive must be a boolean");const un=ut.at(2)??Et.get("attribute")??new At;if(!(un instanceof Ke||un instanceof He||un instanceof At))throw new Error("attribute must be a string, integer, or null");const Gn=hn=>{if(un instanceof At)return hn;const vs=un instanceof He?String(un.value):un.value;return us(hn,vs)};return new It(re.value.slice().sort((hn,vs)=>{const _s=Gn(hn),Vr=Gn(vs),Yr=yn(_s,Vr,xn.value);return rn.value?-Yr:Yr}))}case"selectattr":case"rejectattr":{const ut=ze==="selectattr";if(re.value.some(hn=>!(hn instanceof dt)))throw new Error(`\`${ze}\` can only be applied to array of objects`);if(Oe.args.some(hn=>hn.type!=="StringLiteral"))throw new Error(`arguments of \`${ze}\` must be strings`);const[Et,rn,xn]=Oe.args.map(hn=>this.evaluate(hn,ve));let un;if(rn){const hn=ve.tests.get(rn.value);if(!hn)throw new Error(`Unknown test: ${rn.value}`);un=hn}else un=(...hn)=>hn[0].__bool__().value;const Gn=re.value.filter(hn=>{const vs=hn.value.get(Et.value),_s=vs?un(vs,xn):!1;return ut?_s:!_s});return new It(Gn)}case"map":{const[,ut]=this.evaluateArguments(Oe.args,ve);if(ut.has("attribute")){const Et=ut.get("attribute");if(!(Et instanceof Ke))throw new Error("attribute must be a string");const rn=ut.get("default"),xn=re.value.map(un=>{if(!(un instanceof dt))throw new Error("items in map must be an object");const Gn=us(un,Et.value);return Gn instanceof ht?rn??new ht:Gn});return new It(xn)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${ze}`)}else if(re instanceof Ke){switch(ze){case"indent":{const[ut,Et]=this.evaluateArguments(Oe.args,ve),rn=ut.at(0)??Et.get("width")??new He(4);if(!(rn instanceof He))throw new Error("width must be a number");const xn=ut.at(1)??Et.get("first")??new Ze(!1),un=ut.at(2)??Et.get("blank")??new Ze(!1),Gn=re.value.split(`
`),hn=" ".repeat(rn.value),vs=Gn.map((_s,Vr)=>!xn.value&&Vr===0||!un.value&&_s.length===0?_s:hn+_s);return new Ke(vs.join(`
`))}case"replace":{const ut=re.builtins.get("replace");if(!(ut instanceof Gt))throw new Error("replace filter not available");const[Et,rn]=this.evaluateArguments(Oe.args,ve);return ut.value([...Et,new Ft(rn)],ve)}}throw new Error(`Unknown StringValue filter: ${ze}`)}else if(re instanceof dt){const ut=re.builtins.get(ze);if(ut&&ut instanceof Gt){const[Et,rn]=this.evaluateArguments(Oe.args,ve);return rn.size>0&&Et.push(new Ft(rn)),ut.value(Et,ve)}throw new Error(`Unknown ObjectValue filter: ${ze}`)}else throw new Error(`Cannot apply filter "${ze}" to type: ${re.type}`)}throw new Error(`Unknown filter: ${Pe.type}`)}evaluateFilterExpression(re,Pe){const ve=this.evaluate(re.operand,Pe);return this.applyFilter(ve,re.filter,Pe)}evaluateTestExpression(re,Pe){const ve=this.evaluate(re.operand,Pe),Oe=Pe.tests.get(re.test.value);if(!Oe)throw new Error(`Unknown test: ${re.test.value}`);const ze=Oe(ve);return new Ze(re.negate?!ze:ze)}evaluateSelectExpression(re,Pe){return this.evaluate(re.test,Pe).__bool__().value?this.evaluate(re.lhs,Pe):new ht}evaluateUnaryExpression(re,Pe){const ve=this.evaluate(re.argument,Pe);if(re.operator.value==="not")return new Ze(!ve.value);throw new SyntaxError(`Unknown operator: ${re.operator.value}`)}evaluateTernaryExpression(re,Pe){return this.evaluate(re.condition,Pe).__bool__().value?this.evaluate(re.trueExpr,Pe):this.evaluate(re.falseExpr,Pe)}evalProgram(re,Pe){return this.evaluateBlock(re.body,Pe)}evaluateBlock(re,Pe){let ve="";for(const Oe of re){const ze=this.evaluate(Oe,Pe);ze.type!=="NullValue"&&ze.type!=="UndefinedValue"&&(ve+=ze.toString())}return new Ke(ve)}evaluateIdentifier(re,Pe){return Pe.lookupVariable(re.value)}evaluateCallExpression(re,Pe){const[ve,Oe]=this.evaluateArguments(re.args,Pe);Oe.size>0&&ve.push(new Ft(Oe));const ze=this.evaluate(re.callee,Pe);if(ze.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${ze.type}`);return ze.value(ve,Pe)}evaluateSliceExpression(re,Pe,ve){if(!(re instanceof It||re instanceof Ke))throw new Error("Slice object must be an array or string");const Oe=this.evaluate(Pe.start,ve),ze=this.evaluate(Pe.stop,ve),ut=this.evaluate(Pe.step,ve);if(!(Oe instanceof He||Oe instanceof ht))throw new Error("Slice start must be numeric or undefined");if(!(ze instanceof He||ze instanceof ht))throw new Error("Slice stop must be numeric or undefined");if(!(ut instanceof He||ut instanceof ht))throw new Error("Slice step must be numeric or undefined");return re instanceof It?new It(Se(re.value,Oe.value,ze.value,ut.value)):new Ke(Se(Array.from(re.value),Oe.value,ze.value,ut.value).join(""))}evaluateMemberExpression(re,Pe){const ve=this.evaluate(re.object,Pe);let Oe;if(re.computed){if(re.property.type==="SliceExpression")return this.evaluateSliceExpression(ve,re.property,Pe);Oe=this.evaluate(re.property,Pe)}else Oe=new Ke(re.property.value);let ze;if(ve instanceof dt){if(!(Oe instanceof Ke))throw new Error(`Cannot access property with non-string: got ${Oe.type}`);ze=ve.value.get(Oe.value)??ve.builtins.get(Oe.value)}else if(ve instanceof It||ve instanceof Ke)if(Oe instanceof He)ze=ve.value.at(Oe.value),ve instanceof Ke&&(ze=new Ke(ve.value.at(Oe.value)));else if(Oe instanceof Ke)ze=ve.builtins.get(Oe.value);else throw new Error(`Cannot access property with non-string/non-number: got ${Oe.type}`);else{if(!(Oe instanceof Ke))throw new Error(`Cannot access property with non-string: got ${Oe.type}`);ze=ve.builtins.get(Oe.value)}return ze instanceof st?ze:new ht}evaluateSet(re,Pe){const ve=re.value?this.evaluate(re.value,Pe):this.evaluateBlock(re.body,Pe);if(re.assignee.type==="Identifier"){const Oe=re.assignee.value;Pe.setVariable(Oe,ve)}else if(re.assignee.type==="TupleLiteral"){const Oe=re.assignee;if(!(ve instanceof It))throw new Error(`Cannot unpack non-iterable type in set: ${ve.type}`);const ze=ve.value;if(ze.length!==Oe.value.length)throw new Error(`Too ${Oe.value.length>ze.length?"few":"many"} items to unpack in set`);for(let ut=0;ut<Oe.value.length;++ut){const Et=Oe.value[ut];if(Et.type!=="Identifier")throw new Error(`Cannot unpack to non-identifier in set: ${Et.type}`);Pe.setVariable(Et.value,ze[ut])}}else if(re.assignee.type==="MemberExpression"){const Oe=re.assignee,ze=this.evaluate(Oe.object,Pe);if(!(ze instanceof dt))throw new Error("Cannot assign to member of non-object");if(Oe.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");ze.value.set(Oe.property.value,ve)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(re.assignee)}`);return new At}evaluateIf(re,Pe){const ve=this.evaluate(re.test,Pe);return this.evaluateBlock(ve.__bool__().value?re.body:re.alternate,Pe)}evaluateFor(re,Pe){const ve=new Qt(Pe);let Oe,ze;if(re.iterable.type==="SelectExpression"){const un=re.iterable;ze=this.evaluate(un.lhs,ve),Oe=un.test}else ze=this.evaluate(re.iterable,ve);if(!(ze instanceof It||ze instanceof dt))throw new Error(`Expected iterable or object type in for loop: got ${ze.type}`);ze instanceof dt&&(ze=ze.keys());const ut=[],Et=[];for(let un=0;un<ze.value.length;++un){const Gn=new Qt(ve),hn=ze.value[un];let vs;if(re.loopvar.type==="Identifier")vs=_s=>_s.setVariable(re.loopvar.value,hn);else if(re.loopvar.type==="TupleLiteral"){const _s=re.loopvar;if(hn.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${hn.type}`);const Vr=hn;if(_s.value.length!==Vr.value.length)throw new Error(`Too ${_s.value.length>Vr.value.length?"few":"many"} items to unpack`);vs=Yr=>{for(let Cr=0;Cr<_s.value.length;++Cr){if(_s.value[Cr].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${_s.value[Cr].type}`);Yr.setVariable(_s.value[Cr].value,Vr.value[Cr])}}}else throw new Error(`Invalid loop variable(s): ${re.loopvar.type}`);Oe&&(vs(Gn),!this.evaluate(Oe,Gn).__bool__().value)||(ut.push(hn),Et.push(vs))}let rn="",xn=!0;for(let un=0;un<ut.length;++un){const Gn=new Map([["index",new He(un+1)],["index0",new He(un)],["revindex",new He(ut.length-un)],["revindex0",new He(ut.length-un-1)],["first",new Ze(un===0)],["last",new Ze(un===ut.length-1)],["length",new He(ut.length)],["previtem",un>0?ut[un-1]:new ht],["nextitem",un<ut.length-1?ut[un+1]:new ht]]);ve.setVariable("loop",new dt(Gn)),Et[un](ve);try{const hn=this.evaluateBlock(re.body,ve);rn+=hn.value}catch(hn){if(hn instanceof Be)continue;if(hn instanceof de)break;throw hn}xn=!1}if(xn){const un=this.evaluateBlock(re.defaultBlock,ve);rn+=un.value}return new Ke(rn)}evaluateMacro(re,Pe){return Pe.setVariable(re.name.value,new Gt((ve,Oe)=>{const ze=new Qt(Oe);ve=ve.slice();let ut;ve.at(-1)?.type==="KeywordArgumentsValue"&&(ut=ve.pop());for(let Et=0;Et<re.args.length;++Et){const rn=re.args[Et],xn=ve[Et];if(rn.type==="Identifier"){const un=rn;if(!xn)throw new Error(`Missing positional argument: ${un.value}`);ze.setVariable(un.value,xn)}else if(rn.type==="KeywordArgumentExpression"){const un=rn,Gn=xn??ut?.value.get(un.key.value)??this.evaluate(un.value,ze);ze.setVariable(un.key.value,Gn)}else throw new Error(`Unknown argument type: ${rn.type}`)}return this.evaluateBlock(re.body,ze)})),new At}evaluateCallStatement(re,Pe){const ve=new Gt((rn,xn)=>{const un=new Qt(xn);if(re.callerArgs)for(let Gn=0;Gn<re.callerArgs.length;++Gn){const hn=re.callerArgs[Gn];if(hn.type!=="Identifier")throw new Error(`Caller parameter must be an identifier, got ${hn.type}`);un.setVariable(hn.value,rn[Gn]??new ht)}return this.evaluateBlock(re.body,un)}),[Oe,ze]=this.evaluateArguments(re.call.args,Pe);Oe.push(new Ft(ze));const ut=this.evaluate(re.call.callee,Pe);if(ut.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${ut.type}`);const Et=new Qt(Pe);return Et.setVariable("caller",ve),ut.value(Oe,Et)}evaluateFilterStatement(re,Pe){const ve=this.evaluateBlock(re.body,Pe);return this.applyFilter(ve,re.filter,Pe)}evaluate(re,Pe){if(!re)return new ht;switch(re.type){case"Program":return this.evalProgram(re,Pe);case"Set":return this.evaluateSet(re,Pe);case"If":return this.evaluateIf(re,Pe);case"For":return this.evaluateFor(re,Pe);case"Macro":return this.evaluateMacro(re,Pe);case"CallStatement":return this.evaluateCallStatement(re,Pe);case"Break":throw new de;case"Continue":throw new Be;case"IntegerLiteral":return new He(re.value);case"FloatLiteral":return new Xe(re.value);case"StringLiteral":return new Ke(re.value);case"ArrayLiteral":return new It(re.value.map(ve=>this.evaluate(ve,Pe)));case"TupleLiteral":return new Bt(re.value.map(ve=>this.evaluate(ve,Pe)));case"ObjectLiteral":{const ve=new Map;for(const[Oe,ze]of re.value){const ut=this.evaluate(Oe,Pe);if(!(ut instanceof Ke))throw new Error(`Object keys must be strings: got ${ut.type}`);ve.set(ut.value,this.evaluate(ze,Pe))}return new dt(ve)}case"Identifier":return this.evaluateIdentifier(re,Pe);case"CallExpression":return this.evaluateCallExpression(re,Pe);case"MemberExpression":return this.evaluateMemberExpression(re,Pe);case"UnaryExpression":return this.evaluateUnaryExpression(re,Pe);case"BinaryExpression":return this.evaluateBinaryExpression(re,Pe);case"FilterExpression":return this.evaluateFilterExpression(re,Pe);case"FilterStatement":return this.evaluateFilterStatement(re,Pe);case"TestExpression":return this.evaluateTestExpression(re,Pe);case"SelectExpression":return this.evaluateSelectExpression(re,Pe);case"Ternary":return this.evaluateTernaryExpression(re,Pe);case"Comment":return new At;default:throw new SyntaxError(`Unknown node type: ${re.type}`)}}};function Vn(re){switch(typeof re){case"number":return Number.isInteger(re)?new He(re):new Xe(re);case"string":return new Ke(re);case"boolean":return new Ze(re);case"undefined":return new ht;case"object":return re===null?new At:Array.isArray(re)?new It(re.map(Vn)):new dt(new Map(Object.entries(re).map(([Pe,ve])=>[Pe,Vn(ve)])));case"function":return new Gt((Pe,ve)=>{const Oe=re(...Pe.map(ze=>ze.value))??null;return Vn(Oe)});default:throw new Error(`Cannot convert to runtime value: ${re}`)}}var Nn=`
`,Dn="{%- ",gr=" -%}";function os(re){switch(re.operator.type){case"MultiplicativeBinaryOperator":return 4;case"AdditiveBinaryOperator":return 3;case"ComparisonBinaryOperator":return 2;case"Identifier":return re.operator.value==="and"?1:re.operator.value==="in"||re.operator.value==="not in"?2:0}return 0}function ps(re,Pe="	"){const ve=typeof Pe=="number"?" ".repeat(Pe):Pe;return Qn(re.body,0,ve).replace(/\n$/,"")}function Ss(...re){return Dn+re.join(" ")+gr}function Qn(re,Pe,ve){return re.map(Oe=>On(Oe,Pe,ve)).join(Nn)}function On(re,Pe,ve){const Oe=ve.repeat(Pe);switch(re.type){case"Program":return Qn(re.body,Pe,ve);case"If":return Mt(re,Pe,ve);case"For":return sn(re,Pe,ve);case"Set":return Tn(re,Pe,ve);case"Macro":return ai(re,Pe,ve);case"Break":return Oe+Ss("break");case"Continue":return Oe+Ss("continue");case"CallStatement":return ir(re,Pe,ve);case"FilterStatement":return Fn(re,Pe,ve);case"Comment":return Oe+"{# "+re.value+" #}";default:return Oe+"{{- "+fs(re)+" -}}"}}function Mt(re,Pe,ve){const Oe=ve.repeat(Pe),ze=[];let ut=re;for(;ut&&(ze.push({test:ut.test,body:ut.body}),ut.alternate.length===1&&ut.alternate[0].type==="If");)ut=ut.alternate[0];let Et=Oe+Ss("if",fs(ze[0].test))+Nn+Qn(ze[0].body,Pe+1,ve);for(let rn=1;rn<ze.length;++rn)Et+=Nn+Oe+Ss("elif",fs(ze[rn].test))+Nn+Qn(ze[rn].body,Pe+1,ve);return ut&&ut.alternate.length>0&&(Et+=Nn+Oe+Ss("else")+Nn+Qn(ut.alternate,Pe+1,ve)),Et+=Nn+Oe+Ss("endif"),Et}function sn(re,Pe,ve){const Oe=ve.repeat(Pe);let ze="";if(re.iterable.type==="SelectExpression"){const Et=re.iterable;ze=`${fs(Et.lhs)} if ${fs(Et.test)}`}else ze=fs(re.iterable);let ut=Oe+Ss("for",fs(re.loopvar),"in",ze)+Nn+Qn(re.body,Pe+1,ve);return re.defaultBlock.length>0&&(ut+=Nn+Oe+Ss("else")+Nn+Qn(re.defaultBlock,Pe+1,ve)),ut+=Nn+Oe+Ss("endfor"),ut}function Tn(re,Pe,ve){const Oe=ve.repeat(Pe),ze=fs(re.assignee),ut=re.value?fs(re.value):"",Et=Oe+Ss("set",`${ze}${re.value?" = "+ut:""}`);return re.body.length===0?Et:Et+Nn+Qn(re.body,Pe+1,ve)+Nn+Oe+Ss("endset")}function ai(re,Pe,ve){const Oe=ve.repeat(Pe),ze=re.args.map(fs).join(", ");return Oe+Ss("macro",`${re.name.value}(${ze})`)+Nn+Qn(re.body,Pe+1,ve)+Nn+Oe+Ss("endmacro")}function ir(re,Pe,ve){const Oe=ve.repeat(Pe),ze=re.callerArgs&&re.callerArgs.length>0?`(${re.callerArgs.map(fs).join(", ")})`:"",ut=fs(re.call);let Et=Oe+Ss(`call${ze}`,ut)+Nn;return Et+=Qn(re.body,Pe+1,ve)+Nn,Et+=Oe+Ss("endcall"),Et}function Fn(re,Pe,ve){const Oe=ve.repeat(Pe),ze=re.filter.type==="Identifier"?re.filter.value:fs(re.filter);let ut=Oe+Ss("filter",ze)+Nn;return ut+=Qn(re.body,Pe+1,ve)+Nn,ut+=Oe+Ss("endfilter"),ut}function fs(re,Pe=-1){switch(re.type){case"SpreadExpression":return`*${fs(re.argument)}`;case"Identifier":return re.value;case"IntegerLiteral":return`${re.value}`;case"FloatLiteral":return`${re.value}`;case"StringLiteral":return JSON.stringify(re.value);case"BinaryExpression":{const ve=re,Oe=os(ve),ze=fs(ve.left,Oe),ut=fs(ve.right,Oe+1),Et=`${ze} ${ve.operator.value} ${ut}`;return Oe<Pe?`(${Et})`:Et}case"UnaryExpression":{const ve=re;return ve.operator.value+(ve.operator.value==="not"?" ":"")+fs(ve.argument,1/0)}case"CallExpression":{const ve=re,Oe=ve.args.map(fs).join(", ");return`${fs(ve.callee)}(${Oe})`}case"MemberExpression":{const ve=re;let Oe=fs(ve.object);["Identifier","MemberExpression","CallExpression","StringLiteral","IntegerLiteral","FloatLiteral","ArrayLiteral","TupleLiteral","ObjectLiteral"].includes(ve.object.type)||(Oe=`(${Oe})`);let ze=fs(ve.property);return!ve.computed&&ve.property.type!=="Identifier"&&(ze=`(${ze})`),ve.computed?`${Oe}[${ze}]`:`${Oe}.${ze}`}case"FilterExpression":{const ve=re,Oe=fs(ve.operand,1/0);return ve.filter.type==="CallExpression"?`${Oe} | ${fs(ve.filter)}`:`${Oe} | ${ve.filter.value}`}case"SelectExpression":{const ve=re;return`${fs(ve.lhs)} if ${fs(ve.test)}`}case"TestExpression":{const ve=re;return`${fs(ve.operand)} is${ve.negate?" not":""} ${ve.test.value}`}case"ArrayLiteral":case"TupleLiteral":{const ve=re.value.map(fs),Oe=re.type==="ArrayLiteral"?"[]":"()";return`${Oe[0]}${ve.join(", ")}${Oe[1]}`}case"ObjectLiteral":return`{${Array.from(re.value.entries()).map(([Oe,ze])=>`${fs(Oe)}: ${fs(ze)}`).join(", ")}}`;case"SliceExpression":{const ve=re,Oe=ve.start?fs(ve.start):"",ze=ve.stop?fs(ve.stop):"",ut=ve.step?`:${fs(ve.step)}`:"";return`${Oe}:${ze}${ut}`}case"KeywordArgumentExpression":{const ve=re;return`${ve.key.value}=${fs(ve.value)}`}case"Ternary":{const ve=re,Oe=`${fs(ve.trueExpr)} if ${fs(ve.condition,0)} else ${fs(ve.falseExpr)}`;return Pe>-1?`(${Oe})`:Oe}default:throw new Error(`Unknown expression type: ${re.type}`)}}var ro=class{parsed;constructor(re){const Pe=d(re,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=ge(Pe)}render(re){const Pe=new Qt;if(Xt(Pe),re)for(const[ze,ut]of Object.entries(re))Pe.set(ze,ut);return new En(Pe).run(this.parsed).value}format(re){return ps(this.parsed,re?.indent||"	")}}}),"./src/backends/onnx.js":((n,e,t)=>{var s;t.r(e),t.d(e,{Tensor:()=>l.Tensor,createInferenceSession:()=>v,deviceToExecutionProviders:()=>g,isONNXProxy:()=>k,isONNXTensor:()=>C,runInferenceSession:()=>S});var r=t("./src/env.js"),a=t("?2ce3"),o=t("onnxruntime-web"),l=t("onnxruntime-common");const c=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),u=[];let f,d;const h=Symbol.for("onnxruntime");if(h in globalThis)d=globalThis[h];else if(r.apis.IS_NODE_ENV){switch(d=a??(s||(s=t.t(a,2))),process.platform){case"win32":u.push("dml");break;case"linux":process.arch==="x64"&&u.push("cuda");break}u.push("cpu"),f=["cpu"]}else d=o,r.apis.IS_WEBNN_AVAILABLE&&u.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),r.apis.IS_WEBGPU_AVAILABLE&&u.push("webgpu"),u.push("wasm"),f=["wasm"];const p=d.InferenceSession;function g(E=null){if(!E)return f;switch(E){case"auto":return u;case"gpu":return u.filter(I=>["webgpu","cuda","dml","webnn-gpu"].includes(I))}if(u.includes(E))return[c[E]??E];throw new Error(`Unsupported device: "${E}". Should be one of: ${u.join(", ")}.`)}let b=null;async function v(E,I,A){b&&await b;const D=p.create(E,I);b??=D;const L=await D;return L.config=A,L}let w=Promise.resolve();const x=r.apis.IS_BROWSER_ENV||r.apis.IS_WEBWORKER_ENV;async function S(E,I){const A=()=>E.run(I);return await(x?w=w.then(A):A())}function C(E){return E instanceof d.Tensor}const M=d?.env;M?.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!M.wasm.wasmPaths&&(M.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${r.env.version}/dist/`),M.wasm.proxy=!1),M?.webgpu&&(M.webgpu.powerPreference="high-performance");function k(){return M?.wasm?.proxy}r.env.backends.onnx=M}),"./src/base/feature_extraction_utils.js":((n,e,t)=>{t.r(e),t.d(e,{FeatureExtractor:()=>o,validate_audio_inputs:()=>l});var s=t("./src/utils/constants.js"),r=t("./src/utils/generic.js"),a=t("./src/utils/hub.js");class o extends r.Callable{constructor(u){super(),this.config=u}static async from_pretrained(u,f={}){const d=await(0,a.getModelJSON)(u,s.FEATURE_EXTRACTOR_NAME,!0,f);return new this(d)}}function l(c,u){if(!(c instanceof Float32Array||c instanceof Float64Array))throw new Error(`${u} expects input to be a Float32Array or a Float64Array, but got ${c?.constructor?.name??typeof c} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}}),"./src/base/image_processors_utils.js":((n,e,t)=>{t.r(e),t.d(e,{ImageProcessor:()=>C,center_to_corners_format:()=>d,post_process_instance_segmentation:()=>S,post_process_object_detection:()=>h,post_process_panoptic_segmentation:()=>x,post_process_semantic_segmentation:()=>p});var s=t("./src/utils/generic.js"),r=t("./src/utils/tensor.js"),a=t("./src/utils/maths.js");t("./src/utils/image.js");var o=t("./src/utils/core.js"),l=t("./src/utils/hub.js"),c=t("./src/utils/constants.js");function u(M,k,E=0,I=null){const A=M/k;let D=(0,a.bankers_round)(A)*k;return I!==null&&D>I&&(D=Math.floor(A)*k),D<E&&(D=Math.ceil(A)*k),D}function f([M,k],E){return[Math.max(Math.floor(M/E),1)*E,Math.max(Math.floor(k/E),1)*E]}function d([M,k,E,I]){return[M-E/2,k-I/2,M+E/2,k+I/2]}function h(M,k=.5,E=null,I=!1){const A=M.logits,D=M.pred_boxes,[L,P,j]=A.dims;if(E!==null&&E.length!==L)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let G=[];for(let Q=0;Q<L;++Q){let q=E!==null?E[Q]:null,te={boxes:[],classes:[],scores:[]},Z=A[Q],ne=D[Q];for(let le=0;le<P;++le){let H=Z[le],R=[],B;if(I){B=H.sigmoid().data;for(let W=0;W<B.length;++W)B[W]>k&&R.push(W)}else{let W=(0,a.max)(H.data)[1];if(W===j-1||(B=(0,a.softmax)(H.data),B[W]<k))continue;R.push(W)}for(const W of R){let se=ne[le].data;se=d(se),q!==null&&(se=se.map((ue,ge)=>ue*q[(ge+1)%2])),te.boxes.push(se),te.classes.push(W),te.scores.push(B[W])}}G.push(te)}return G}function p(M,k=null){const E=M.logits,I=E.dims[0];if(k!==null&&k.length!==I)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const A=[];for(let D=0;D<I;++D){const L=k!==null?k[D]:null;let P=E[D];L!==null&&(P=(0,r.interpolate)(P,L,"bilinear",!1));const[j,G]=L??P.dims.slice(-2),Q=new r.Tensor("int32",new Int32Array(j*G),[j,G]),q=P[0].data,te=Q.data;for(let le=1;le<P.dims[0];++le){const H=P[le].data;for(let R=0;R<H.length;++R)H[R]>q[R]&&(q[R]=H[R],te[R]=le)}const Z=new Array(P.dims[0]);for(let le=0;le<te.length;++le){const H=te[le];Z[H]=H}const ne=Z.filter(le=>le!==void 0);A.push({segmentation:Q,labels:ne})}return A}function g(M,k,E,I){const A=[],D=[],L=[];for(let P=0;P<M.dims[0];++P){const j=M[P],G=k[P],Q=(0,a.max)(j.data)[1];if(Q===I)continue;const te=(0,a.softmax)(j.data)[Q];te>E&&(A.push(G),D.push(te),L.push(Q))}return[A,D,L]}function b(M,k,E,I=.5,A=.8){const D=[];let L=0,P=0;const j=k[E].data;for(let Q=0;Q<M.length;++Q)M[Q]===E&&(D.push(Q),++L),j[Q]>=I&&++P;let G=L>0&&P>0;return G&&(G=L/P>A),[G,D]}function v(M,k,E,I,A,D=null,L=null){const[P,j]=L??M[0].dims,G=new r.Tensor("int32",new Int32Array(P*j),[P,j]),Q=[];if(L!==null)for(let le=0;le<M.length;++le)M[le]=(0,r.interpolate)(M[le],L,"bilinear",!1);const q=new Int32Array(M[0].data.length),te=new Float32Array(M[0].data.length);for(let le=0;le<M.length;++le){let H=k[le];const R=M[le].data;for(let B=0;B<R.length;++B)R[B]*=H,R[B]>te[B]&&(q[B]=le,te[B]=R[B])}let Z=0;const ne=G.data;for(let le=0;le<E.length;++le){const H=E[le],[R,B]=b(q,M,le,I,A);if(R){++Z;for(const W of B)ne[W]=Z;Q.push({id:Z,label_id:H,score:k[le]})}}return[G,Q]}function w(M,k,E=28,I=3136,A=784*1280){if(M<E||k<E)throw new Error(`height:${M} or width:${k} must be larger than factor:${E}`);if(Math.max(M,k)/Math.min(M,k)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(M,k)/Math.min(M,k)}`);let D=Math.round(M/E)*E,L=Math.round(k/E)*E;if(D*L>A){const P=Math.sqrt(M*k/A);D=Math.floor(M/P/E)*E,L=Math.floor(k/P/E)*E}else if(D*L<I){const P=Math.sqrt(I/(M*k));D=Math.ceil(M*P/E)*E,L=Math.ceil(k*P/E)*E}return[D,L]}function x(M,k=.5,E=.5,I=.8,A=null,D=null){A===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),A=new Set);const L=M.class_queries_logits??M.logits,j=(M.masks_queries_logits??M.pred_masks).sigmoid();let[G,Q,q]=L.dims;if(q-=1,D!==null&&D.length!==G)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let te=[];for(let Z=0;Z<G;++Z){let ne=D!==null?D[Z]:null,le=L[Z],H=j[Z],[R,B,W]=g(le,H,k,q);if(W.length===0){let[ge,Ce]=ne??H.dims.slice(-2),Se=new r.Tensor("int32",new Int32Array(ge*Ce).fill(-1),[ge,Ce]);te.push({segmentation:Se,segments_info:[]});continue}let[se,ue]=v(R,B,W,E,I,A,ne);te.push({segmentation:se,segments_info:ue})}return te}function S(M,k=.5,E=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class C extends s.Callable{constructor(k){super(),this.image_mean=k.image_mean??k.mean,this.image_std=k.image_std??k.std,this.resample=k.resample??2,this.do_rescale=k.do_rescale??!0,this.rescale_factor=k.rescale_factor??1/255,this.do_normalize=k.do_normalize,this.do_thumbnail=k.do_thumbnail,this.size=k.size??k.image_size,this.do_resize=k.do_resize??this.size!==void 0,this.size_divisibility=k.size_divisibility??k.size_divisor,this.do_center_crop=k.do_center_crop,this.crop_size=k.crop_size,this.do_convert_rgb=k.do_convert_rgb??!0,this.do_crop_margin=k.do_crop_margin,this.pad_size=k.pad_size,this.do_pad=k.do_pad,this.min_pixels=k.min_pixels,this.max_pixels=k.max_pixels,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=k.do_flip_channel_order??!1,this.config=k}async thumbnail(k,E,I=2){const A=k.height,D=k.width,L=E.height,P=E.width;let j=Math.min(A,L),G=Math.min(D,P);return j===A&&G===D?k:(A>D?G=Math.floor(D*j/A):D>A&&(j=Math.floor(A*G/D)),await k.resize(G,j,{resample:I}))}async crop_margin(k,E=200){const I=k.clone().grayscale(),A=(0,a.min)(I.data)[0],L=(0,a.max)(I.data)[0]-A;if(L===0)return k;const P=E/255;let j=I.width,G=I.height,Q=0,q=0;const te=I.data;for(let Z=0;Z<I.height;++Z){const ne=Z*I.width;for(let le=0;le<I.width;++le)(te[ne+le]-A)/L<P&&(j=Math.min(j,le),G=Math.min(G,Z),Q=Math.max(Q,le),q=Math.max(q,Z))}return k=await k.crop([j,G,Q,q]),k}pad_image(k,E,I,{mode:A="constant",center:D=!1,constant_values:L=0}={}){const[P,j,G]=E;let Q,q;if(typeof I=="number"?(Q=I,q=I):I==="square"?Q=q=Math.max(P,j):(Q=I.width,q=I.height),Q!==j||q!==P){const te=new Float32Array(Q*q*G);if(Array.isArray(L))for(let le=0;le<te.length;++le)te[le]=L[le%G];else L!==0&&te.fill(L);const[Z,ne]=D?[Math.floor((Q-j)/2),Math.floor((q-P)/2)]:[0,0];for(let le=0;le<P;++le){const H=(le+ne)*Q,R=le*j;for(let B=0;B<j;++B){const W=(H+B+Z)*G,se=(R+B)*G;for(let ue=0;ue<G;++ue)te[W+ue]=k[se+ue]}}if(A==="symmetric"){if(D)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const le=P-1,H=j-1;for(let R=0;R<q;++R){const B=R*Q,W=(0,o.calculateReflectOffset)(R,le)*j;for(let se=0;se<Q;++se){if(R<P&&se<j)continue;const ue=(B+se)*G,ge=(W+(0,o.calculateReflectOffset)(se,H))*G;for(let Ce=0;Ce<G;++Ce)te[ue+Ce]=k[ge+Ce]}}}k=te,E=[q,Q,G]}return[k,E]}rescale(k){for(let E=0;E<k.length;++E)k[E]=this.rescale_factor*k[E]}get_resize_output_image_size(k,E){const[I,A]=k.size;let D,L;if(this.do_thumbnail){const{height:P,width:j}=E;D=Math.min(P,j)}else Number.isInteger(E)?(D=E,L=this.config.max_size??D):E!==void 0&&(D=E.shortest_edge,L=E.longest_edge);if(D!==void 0||L!==void 0){const P=D===void 0?1:Math.max(D/I,D/A),j=I*P,G=A*P,Q=L===void 0?1:Math.min(L/j,L/G);let q=Math.floor(Number((j*Q).toFixed(2))),te=Math.floor(Number((G*Q).toFixed(2)));return this.size_divisibility!==void 0&&([q,te]=f([q,te],this.size_divisibility)),[q,te]}else if(E!==void 0&&E.width!==void 0&&E.height!==void 0){let P=E.width,j=E.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let G=j/A,Q=P/I;Math.abs(1-Q)<Math.abs(1-G)?G=Q:Q=G,j=u(G*A,this.config.ensure_multiple_of),P=u(Q*I,this.config.ensure_multiple_of)}return[P,j]}else{if(this.size_divisibility!==void 0)return f([I,A],this.size_divisibility);if(this.min_pixels!==void 0&&this.max_pixels!==void 0){const P=this.config.patch_size*this.config.merge_size;return w(A,I,P,this.min_pixels,this.max_pixels)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(E)}`)}}async resize(k){const[E,I]=this.get_resize_output_image_size(k,this.size);return await k.resize(E,I,{resample:this.resample})}async preprocess(k,{do_normalize:E=null,do_pad:I=null,do_convert_rgb:A=null,do_convert_grayscale:D=null,do_flip_channel_order:L=null}={}){this.do_crop_margin&&(k=await this.crop_margin(k));const[P,j]=k.size;if(A??this.do_convert_rgb?k=k.rgb():D&&(k=k.grayscale()),this.do_resize&&(k=await this.resize(k)),this.do_thumbnail&&(k=await this.thumbnail(k,this.size,this.resample)),this.do_center_crop){let Z,ne;Number.isInteger(this.crop_size)?(Z=this.crop_size,ne=this.crop_size):(Z=this.crop_size.width,ne=this.crop_size.height),k=await k.center_crop(Z,ne)}const G=[k.height,k.width];let Q=Float32Array.from(k.data),q=[k.height,k.width,k.channels];if(this.do_rescale&&this.rescale(Q),E??this.do_normalize){let Z=this.image_mean;Array.isArray(this.image_mean)||(Z=new Array(k.channels).fill(Z));let ne=this.image_std;if(Array.isArray(this.image_std)||(ne=new Array(k.channels).fill(ne)),Z.length!==k.channels||ne.length!==k.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${Z.length}) and \`image_std\` (${ne.length}) must match the number of channels in the image (${k.channels}).`);for(let le=0;le<Q.length;le+=k.channels)for(let H=0;H<k.channels;++H)Q[le+H]=(Q[le+H]-Z[H])/ne[H]}if(I??this.do_pad){if(this.pad_size)[Q,q]=this.pad_image(Q,[k.height,k.width,k.channels],this.pad_size);else if(this.size_divisibility){const[Z,ne]=f([q[1],q[0]],this.size_divisibility);[Q,q]=this.pad_image(Q,q,{width:Z,height:ne})}}if(L??this.do_flip_channel_order){if(q[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let Z=0;Z<Q.length;Z+=3){const ne=Q[Z];Q[Z]=Q[Z+2],Q[Z+2]=ne}}const te=new r.Tensor("float32",Q,q).permute(2,0,1);return{original_size:[j,P],reshaped_input_size:G,pixel_values:te}}async _call(k,...E){Array.isArray(k)||(k=[k]);const I=await Promise.all(k.map(D=>this.preprocess(D)));return{pixel_values:(0,r.stack)(I.map(D=>D.pixel_values),0),original_sizes:I.map(D=>D.original_size),reshaped_input_sizes:I.map(D=>D.reshaped_input_size)}}static async from_pretrained(k,E={}){const I=await(0,l.getModelJSON)(k,c.IMAGE_PROCESSOR_NAME,!0,E);return new this(I)}}}),"./src/base/processing_utils.js":((n,e,t)=>{t.r(e),t.d(e,{Processor:()=>o});var s=t("./src/utils/constants.js"),r=t("./src/utils/generic.js"),a=t("./src/utils/hub.js");class o extends r.Callable{static classes=["image_processor_class","tokenizer_class","feature_extractor_class"];static uses_processor_config=!1;static uses_chat_template_file=!1;constructor(c,u,f){super(),this.config=c,this.components=u,this.chat_template=f}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(c,u={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(c,{tokenize:!1,chat_template:this.chat_template??void 0,...u})}batch_decode(...c){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...c)}decode(...c){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...c)}async _call(c,...u){for(const f of[this.image_processor,this.feature_extractor,this.tokenizer])if(f)return f(c,...u);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(c,u={}){const[f,d,h]=await Promise.all([this.uses_processor_config?(0,a.getModelJSON)(c,s.PROCESSOR_NAME,!0,u):{},Promise.all(this.classes.filter(p=>p in this).map(async p=>{const g=await this[p].from_pretrained(c,u);return[p.replace(/_class$/,""),g]})).then(Object.fromEntries),this.uses_chat_template_file?(0,a.getModelText)(c,s.CHAT_TEMPLATE_NAME,!0,u):null]);return new this(f,d,h)}}}),"./src/configs.js":((n,e,t)=>{t.r(e),t.d(e,{AutoConfig:()=>f,PretrainedConfig:()=>u,getCacheShapes:()=>l});var s=t("./src/utils/core.js"),r=t("./src/utils/hub.js");async function a(d,h){return await(0,r.getModelJSON)(d,"config.json",!0,h)}function o(d){const h={};let p={};switch(d.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"voxtral":case"smolvlm":case"gemma3n":case"mistral3":p=o(d.text_config);break;case"moondream1":p=o(d.phi_config);break;case"musicgen":p=o(d.decoder);break;case"multi_modality":p=o(d.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":h.num_heads="n_head",h.num_layers="n_layer",h.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":case"modernbert-decoder":h.num_heads="num_attention_heads",h.num_layers="num_hidden_layers",h.hidden_size="hidden_size";break;case"llama":case"llama4_text":case"nanochat":case"arcee":case"lfm2":case"smollm3":case"olmo":case"olmo2":case"mobilellm":case"granite":case"granitemoehybrid":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":h.num_heads="num_key_value_heads",h.num_layers="num_hidden_layers",h.hidden_size="hidden_size",h.num_attention_heads="num_attention_heads",h.dim_kv="head_dim";break;case"qwen3":case"gemma":case"gemma2":case"vaultgemma":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":case"ernie4_5":case"ministral":case"ministral3":h.num_heads="num_key_value_heads",h.num_layers="num_hidden_layers",h.dim_kv="head_dim";break;case"openelm":h.num_heads="num_kv_heads",h.num_layers="num_transformer_layers",h.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":h.num_heads="num_heads",h.num_layers="num_layers",h.hidden_size="hidden_size";break;case"bloom":h.num_heads="n_head",h.num_layers="n_layer",h.hidden_size="hidden_size";break;case"mpt":h.num_heads="n_heads",h.num_layers="n_layers",h.hidden_size="d_model";break;case"exaone":h.num_heads="num_key_value_heads",h.num_layers="num_layers",h.dim_kv="head_dim",h.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":h.num_decoder_layers="num_decoder_layers",h.num_decoder_heads="num_heads",h.decoder_dim_kv="d_kv",h.num_encoder_layers="num_layers",h.num_encoder_heads="num_heads",h.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":h.num_decoder_layers="decoder_layers",h.num_decoder_heads="decoder_attention_heads",h.decoder_hidden_size="d_model",h.num_encoder_layers="encoder_layers",h.num_encoder_heads="encoder_attention_heads",h.encoder_hidden_size="d_model";break;case"speecht5":h.num_decoder_layers="decoder_layers",h.num_decoder_heads="decoder_attention_heads",h.decoder_hidden_size="hidden_size",h.num_encoder_layers="encoder_layers",h.num_encoder_heads="encoder_attention_heads",h.encoder_hidden_size="hidden_size";break;case"trocr":h.num_encoder_layers=h.num_decoder_layers="decoder_layers",h.num_encoder_heads=h.num_decoder_heads="decoder_attention_heads",h.encoder_hidden_size=h.decoder_hidden_size="d_model";break;case"musicgen_decoder":h.num_encoder_layers=h.num_decoder_layers="num_hidden_layers",h.num_encoder_heads=h.num_decoder_heads="num_attention_heads",h.encoder_hidden_size=h.decoder_hidden_size="hidden_size";break;case"moonshine":h.num_decoder_layers="decoder_num_hidden_layers",h.num_decoder_heads="decoder_num_key_value_heads",h.num_encoder_layers="encoder_num_hidden_layers",h.num_encoder_heads="encoder_num_key_value_heads",h.encoder_hidden_size=h.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const b=o(d.decoder),v="num_decoder_layers"in b,w=(0,s.pick)(d,["model_type","is_encoder_decoder"]);return v?(w.num_decoder_layers=b.num_decoder_layers,w.num_decoder_heads=b.num_decoder_heads,w.decoder_hidden_size=b.decoder_hidden_size,w.num_encoder_layers=b.num_encoder_layers,w.num_encoder_heads=b.num_encoder_heads,w.encoder_hidden_size=b.encoder_hidden_size):(w.num_layers=b.num_layers,w.num_heads=b.num_heads,w.hidden_size=b.hidden_size),w}const g={...p,...(0,s.pick)(d,["model_type","multi_query","is_encoder_decoder"])};for(const b in h)g[b]=d[h[b]];return g}function l(d,h){if(d.model_type==="lfm2"){const p=h?.prefix??"past_key_values",g=p==="present"?"present":"past",b={},{layer_types:v,num_attention_heads:w,num_key_value_heads:x,hidden_size:S,conv_L_cache:C}=d,M=S/w,k=h?.batch_size??1;for(let E=0;E<v.length;++E)if(v[E]==="full_attention")for(const I of["key","value"])b[`${p}.${E}.${I}`]=[k,x,0,M];else if(v[E]==="conv")b[`${g}_conv.${E}`]=[k,S,C];else throw new Error(`Unsupported layer type: ${v[E]}`);return b}return c(d,h)}function c(d,{prefix:h="past_key_values",batch_size:p=1}={}){const g={},b=d.normalized_config;if(b.is_encoder_decoder&&"num_encoder_heads"in b&&"num_decoder_heads"in b){const v=b.encoder_dim_kv??b.encoder_hidden_size/b.num_encoder_heads,w=b.decoder_dim_kv??b.decoder_hidden_size/b.num_decoder_heads,x=[p,b.num_encoder_heads,0,v],S=[p,b.num_decoder_heads,0,w];for(let C=0;C<b.num_decoder_layers;++C)g[`${h}.${C}.encoder.key`]=x,g[`${h}.${C}.encoder.value`]=x,g[`${h}.${C}.decoder.key`]=S,g[`${h}.${C}.decoder.value`]=S}else{const v=b.num_heads,w=b.num_layers,x=b.dim_kv??b.hidden_size/(b.num_attention_heads??v);if(b.model_type==="falcon"){const S=[p*v,0,x];for(let C=0;C<w;++C)g[`${h}.${C}.key`]=S,g[`${h}.${C}.value`]=S}else if(b.multi_query){const S=[p*v,0,2*x];for(let C=0;C<w;++C)g[`${h}.${C}.key_value`]=S}else if(b.model_type==="bloom"){const S=[p*v,x,0],C=[p*v,0,x];for(let M=0;M<w;++M)g[`${h}.${M}.key`]=S,g[`${h}.${M}.value`]=C}else if(b.model_type==="openelm")for(let S=0;S<w;++S){const C=[p,v[S],0,x];g[`${h}.${S}.key`]=C,g[`${h}.${S}.value`]=C}else{const S=[p,v,0,x];for(let C=0;C<w;++C)g[`${h}.${C}.key`]=S,g[`${h}.${C}.value`]=S}}return g}class u{model_type=null;is_encoder_decoder=!1;max_position_embeddings;"transformers.js_config";constructor(h){Object.assign(this,h),this.normalized_config=o(this)}static async from_pretrained(h,{progress_callback:p=null,config:g=null,cache_dir:b=null,local_files_only:v=!1,revision:w="main"}={}){g&&!(g instanceof u)&&(g=new u(g));const x=g??await a(h,{progress_callback:p,config:g,cache_dir:b,local_files_only:v,revision:w});return new this(x)}}class f{static async from_pretrained(...h){return u.from_pretrained(...h)}}}),"./src/env.js":((n,e,t)=>{t.r(e),t.d(e,{apis:()=>w,env:()=>E});var s=t("?db59"),r=t("?383f"),a=t("?fa4b");const o="3.8.1",l=typeof window<"u"&&typeof window.document<"u",c=typeof self<"u"&&["DedicatedWorkerGlobalScope","ServiceWorkerGlobalScope","SharedWorkerGlobalScope"].includes(self.constructor?.name),u=typeof self<"u"&&"caches"in self,f=typeof navigator<"u"&&"gpu"in navigator,d=typeof navigator<"u"&&"ml"in navigator,h=typeof process<"u",p=h&&process?.release?.name==="node",g=!I(s),b=!I(r),v=typeof globalThis.Deno<"u",w=Object.freeze({IS_BROWSER_ENV:l,IS_WEBWORKER_ENV:c,IS_WEB_CACHE_AVAILABLE:u,IS_WEBGPU_AVAILABLE:f,IS_WEBNN_AVAILABLE:d,IS_PROCESS_AVAILABLE:h,IS_NODE_ENV:p,IS_FS_AVAILABLE:g,IS_PATH_AVAILABLE:b}),x=g&&b;let S="./";if(x){const A=Object(import.meta).url;A?S=r.dirname(r.dirname(a.fileURLToPath(A))):typeof __dirname<"u"&&(S=r.dirname(__dirname))}const C=x?r.join(S,"/.cache/"):null,M="/models/",k=x?r.join(S,M):M,E={version:o,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(l||c),localModelPath:k,useFS:g,useBrowserCache:u&&!v,useFSCache:g,cacheDir:C,useCustomCache:!1,customCache:null};function I(A){return Object.keys(A).length===0}}),"./src/generation/configuration_utils.js":((n,e,t)=>{t.r(e),t.d(e,{GenerationConfig:()=>r});var s=t("./src/utils/core.js");class r{max_length=20;max_new_tokens=null;min_length=0;min_new_tokens=null;early_stopping=!1;max_time=null;do_sample=!1;num_beams=1;num_beam_groups=1;penalty_alpha=null;use_cache=!0;temperature=1;top_k=50;top_p=1;typical_p=1;epsilon_cutoff=0;eta_cutoff=0;diversity_penalty=0;repetition_penalty=1;encoder_repetition_penalty=1;length_penalty=1;no_repeat_ngram_size=0;bad_words_ids=null;force_words_ids=null;renormalize_logits=!1;constraints=null;forced_bos_token_id=null;forced_eos_token_id=null;remove_invalid_values=!1;exponential_decay_length_penalty=null;suppress_tokens=null;streamer=null;begin_suppress_tokens=null;forced_decoder_ids=null;guidance_scale=null;num_return_sequences=1;output_attentions=!1;output_hidden_states=!1;output_scores=!1;return_dict_in_generate=!1;pad_token_id=null;bos_token_id=null;eos_token_id=null;encoder_no_repeat_ngram_size=0;decoder_start_token_id=null;generation_kwargs={};constructor(o){Object.assign(this,(0,s.pick)(o,Object.getOwnPropertyNames(this)))}}}),"./src/generation/logits_process.js":((n,e,t)=>{t.r(e),t.d(e,{ClassifierFreeGuidanceLogitsProcessor:()=>w,ForcedBOSTokenLogitsProcessor:()=>c,ForcedEOSTokenLogitsProcessor:()=>u,LogitsProcessor:()=>a,LogitsProcessorList:()=>l,LogitsWarper:()=>o,MinLengthLogitsProcessor:()=>g,MinNewTokensLengthLogitsProcessor:()=>b,NoBadWordsLogitsProcessor:()=>v,NoRepeatNGramLogitsProcessor:()=>h,RepetitionPenaltyLogitsProcessor:()=>p,SuppressTokensAtBeginLogitsProcessor:()=>f,TemperatureLogitsWarper:()=>x,TopKLogitsWarper:()=>C,TopPLogitsWarper:()=>S,WhisperTimeStampLogitsProcessor:()=>d});var s=t("./src/utils/generic.js");t("./src/utils/tensor.js");var r=t("./src/utils/maths.js");class a extends s.Callable{_call(k,E){throw Error("`_call` should be implemented in a subclass")}}class o extends s.Callable{_call(k,E){throw Error("`_call` should be implemented in a subclass")}}class l extends s.Callable{constructor(){super(),this.processors=[]}push(k){this.processors.push(k)}extend(k){this.processors.push(...k)}_call(k,E){let I=E;for(const A of this.processors)I=A(k,I);return I}[Symbol.iterator](){return this.processors.values()}}class c extends a{constructor(k){super(),this.bos_token_id=k}_call(k,E){for(let I=0;I<k.length;++I)if(k[I].length===1){const A=E[I].data;A.fill(-1/0),A[this.bos_token_id]=0}return E}}class u extends a{constructor(k,E){super(),this.max_length=k,this.eos_token_id=Array.isArray(E)?E:[E]}_call(k,E){for(let I=0;I<k.length;++I)if(k[I].length===this.max_length-1){const A=E[I].data;A.fill(-1/0);for(const D of this.eos_token_id)A[D]=0}return E}}class f extends a{constructor(k,E){super(),this.begin_suppress_tokens=k,this.begin_index=E}_call(k,E){for(let I=0;I<k.length;++I)if(k[I].length===this.begin_index){const A=E[I].data;for(const D of this.begin_suppress_tokens)A[D]=-1/0}return E}}class d extends a{constructor(k,E){super(),this.eos_token_id=Array.isArray(k.eos_token_id)?k.eos_token_id[0]:k.eos_token_id,this.no_timestamps_token_id=k.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=E.length,E.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=k.max_initial_timestamp_index}_call(k,E){for(let I=0;I<k.length;++I){const A=E[I].data;if(A[this.no_timestamps_token_id]=-1/0,k[I].length===this.begin_index-1){A.fill(-1/0),A[this.timestamp_begin]=0;continue}const D=k[I].slice(this.begin_index),L=D.length>=1&&D[D.length-1]>=this.timestamp_begin,P=D.length<2||D[D.length-2]>=this.timestamp_begin;if(L&&(P?A.subarray(this.timestamp_begin).fill(-1/0):A.subarray(0,this.eos_token_id).fill(-1/0)),k[I].length===this.begin_index&&this.max_initial_timestamp_index!==null){const q=this.timestamp_begin+this.max_initial_timestamp_index;A.subarray(q+1).fill(-1/0)}const j=(0,r.log_softmax)(A),G=Math.log(j.subarray(this.timestamp_begin).map(Math.exp).reduce((q,te)=>q+te)),Q=(0,r.max)(j.subarray(0,this.timestamp_begin))[0];G>Q&&A.subarray(0,this.timestamp_begin).fill(-1/0)}return E}}class h extends a{constructor(k){super(),this.no_repeat_ngram_size=k}getNgrams(k){const E=k.length,I=[];for(let D=0;D<E+1-this.no_repeat_ngram_size;++D){const L=[];for(let P=0;P<this.no_repeat_ngram_size;++P)L.push(k[D+P]);I.push(L.map(Number))}const A=new Map;for(const D of I){const L=D.slice(0,D.length-1),P=JSON.stringify(L),j=A.get(P)??[];j.push(D[D.length-1]),A.set(P,j)}return A}getGeneratedNgrams(k,E){const I=E.slice(E.length+1-this.no_repeat_ngram_size,E.length);return k.get(JSON.stringify(I.map(Number)))??[]}calcBannedNgramTokens(k){const E=[];if(k.length+1<this.no_repeat_ngram_size)return E;{const I=this.getNgrams(k);return this.getGeneratedNgrams(I,k)}}_call(k,E){for(let I=0;I<k.length;++I){const A=E[I].data,D=this.calcBannedNgramTokens(k[I]);for(const L of D)A[L]=-1/0}return E}}class p extends a{constructor(k){super(),this.penalty=k}_call(k,E){for(let I=0;I<k.length;++I){const A=E[I].data;for(const D of new Set(k[I])){const L=Number(D);A[L]<0?A[L]*=this.penalty:A[L]/=this.penalty}}return E}}class g extends a{constructor(k,E){super(),this.min_length=k,this.eos_token_id=Array.isArray(E)?E:[E]}_call(k,E){for(let I=0;I<k.length;++I)if(k[I].length<this.min_length){const A=E[I].data;for(const D of this.eos_token_id)A[D]=-1/0}return E}}class b extends a{constructor(k,E,I){super(),this.prompt_length_to_skip=k,this.min_new_tokens=E,this.eos_token_id=Array.isArray(I)?I:[I]}_call(k,E){for(let I=0;I<k.length;++I)if(k[I].length-this.prompt_length_to_skip<this.min_new_tokens){const D=E[I].data;for(const L of this.eos_token_id)D[L]=-1/0}return E}}class v extends a{constructor(k,E){super(),this.bad_words_ids=k,this.eos_token_id=Array.isArray(E)?E:[E]}_call(k,E){for(let I=0;I<k.length;++I){const A=E[I].data,D=k[I];for(const L of this.bad_words_ids){if(D.length<L.length-1)continue;let P=!0;for(let j=1;j<=L.length-1;++j)if(L.at(-j-1)!=D.at(-j)){P=!1;break}P&&(A[L.at(-1)]=-1/0)}}return E}}class w extends a{constructor(k){if(super(),k<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${k}.`);this.guidance_scale=k}_call(k,E){if(E.dims[0]!==2*k.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${E.dims[0]} for the logits and ${k.length} for the input ids.`);const I=k.length,A=E.slice([0,I],null),D=E.slice([I,E.dims[0]],null);for(let L=0;L<D.data.length;++L)D.data[L]+=(A.data[L]-D.data[L])*this.guidance_scale;return D}}class x extends o{constructor(k){super(),this.temperature=k}_call(k,E){const I=E.data;for(let A=0;A<I.length;++A)I[A]/=this.temperature;return E}}class S extends o{constructor(k,{filter_value:E=-1/0,min_tokens_to_keep:I=1}={}){if(super(),k<0||k>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${k}`);if(!Number.isInteger(I)||I<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${I}`);this.top_p=k,this.filter_value=E,this.min_tokens_to_keep=I}}class C extends o{constructor(k,{filter_value:E=-1/0,min_tokens_to_keep:I=1}={}){if(super(),!Number.isInteger(k)||k<0)throw new Error(`\`top_k\` must be a positive integer, but is ${k}`);this.top_k=Math.max(k,I),this.filter_value=E}}}),"./src/generation/logits_sampler.js":((n,e,t)=>{t.r(e),t.d(e,{LogitsSampler:()=>o});var s=t("./src/utils/generic.js"),r=t("./src/utils/tensor.js"),a=t("./src/utils/maths.js");t("./src/generation/configuration_utils.js");class o extends s.Callable{constructor(d){super(),this.generation_config=d}async _call(d){return this.sample(d)}async sample(d){throw Error("sample should be implemented in subclasses.")}getLogits(d,h){let p=d.dims.at(-1),g=d.data;if(h===-1)g=g.slice(-p);else{let b=h*p;g=g.slice(b,b+p)}return g}randomSelect(d){let h=0;for(let g=0;g<d.length;++g)h+=d[g];let p=Math.random()*h;for(let g=0;g<d.length;++g)if(p-=d[g],p<=0)return g;return 0}static getSampler(d){if(d.do_sample)return new c(d);if(d.num_beams>1)return new u(d);if(d.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${d.num_return_sequences}.`);return new l(d)}}class l extends o{async sample(d){const h=(0,a.max)(d.data)[1];return[[BigInt(h),0]]}}class c extends o{async sample(d){let h=d.dims.at(-1);this.generation_config.top_k>0&&(h=Math.min(this.generation_config.top_k,h));const[p,g]=await(0,r.topk)(d,h),b=(0,a.softmax)(p.data);return Array.from({length:this.generation_config.num_beams},()=>{const v=this.randomSelect(b);return[g.data[v],Math.log(b[v])]})}}class u extends o{async sample(d){let h=d.dims.at(-1);this.generation_config.top_k>0&&(h=Math.min(this.generation_config.top_k,h));const[p,g]=await(0,r.topk)(d,h),b=(0,a.softmax)(p.data);return Array.from({length:this.generation_config.num_beams},(v,w)=>[g.data[w],Math.log(b[w])])}}}),"./src/generation/stopping_criteria.js":((n,e,t)=>{t.r(e),t.d(e,{EosTokenCriteria:()=>l,InterruptableStoppingCriteria:()=>c,MaxLengthCriteria:()=>o,StoppingCriteria:()=>r,StoppingCriteriaList:()=>a});var s=t("./src/utils/generic.js");class r extends s.Callable{_call(f,d){throw Error("StoppingCriteria needs to be subclassed")}}class a extends s.Callable{constructor(){super(),this.criteria=[]}push(f){this.criteria.push(f)}extend(f){f instanceof a?f=f.criteria:f instanceof r&&(f=[f]),this.criteria.push(...f)}_call(f,d){const h=new Array(f.length).fill(!1);for(const p of this.criteria){const g=p(f,d);for(let b=0;b<h.length;++b)h[b]||=g[b]}return h}[Symbol.iterator](){return this.criteria.values()}}class o extends r{constructor(f,d=null){super(),this.max_length=f,this.max_position_embeddings=d}_call(f){return f.map(d=>d.length>=this.max_length)}}class l extends r{constructor(f){super(),Array.isArray(f)||(f=[f]),this.eos_token_id=f}_call(f,d){return f.map(h=>{const p=h.at(-1);return this.eos_token_id.some(g=>p==g)})}}class c extends r{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(f,d){return new Array(f.length).fill(this.interrupted)}}}),"./src/generation/streamers.js":((n,e,t)=>{t.r(e),t.d(e,{BaseStreamer:()=>o,TextStreamer:()=>c,WhisperTextStreamer:()=>u});var s=t("./src/utils/core.js"),r=t("./src/tokenizers.js"),a=t("./src/env.js");class o{put(d){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const l=a.apis.IS_PROCESS_AVAILABLE?f=>process.stdout.write(f):f=>console.log(f);class c extends o{constructor(d,{skip_prompt:h=!1,callback_function:p=null,token_callback_function:g=null,skip_special_tokens:b=!0,decode_kwargs:v={},...w}={}){super(),this.tokenizer=d,this.skip_prompt=h,this.callback_function=p??l,this.token_callback_function=g,this.decode_kwargs={skip_special_tokens:b,...v,...w},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(d){if(d.length>1)throw Error("TextStreamer only supports batch size of 1");const h=this.next_tokens_are_prompt;if(h&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const p=d[0];this.token_callback_function?.(p),this.token_cache=(0,s.mergeArrays)(this.token_cache,p);const g=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let b;h||g.endsWith(`
`)?(b=g.slice(this.print_len),this.token_cache=[],this.print_len=0):g.length>0&&(0,r.is_chinese_char)(g.charCodeAt(g.length-1))?(b=g.slice(this.print_len),this.print_len+=b.length):(b=g.slice(this.print_len,g.lastIndexOf(" ")+1),this.print_len+=b.length),this.on_finalized_text(b,!1)}end(){let d;this.token_cache.length>0?(d=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):d="",this.next_tokens_are_prompt=!0,this.on_finalized_text(d,!0)}on_finalized_text(d,h){d.length>0&&this.callback_function?.(d),h&&this.callback_function===l&&a.apis.IS_PROCESS_AVAILABLE&&this.callback_function?.(`
`)}}class u extends c{constructor(d,{skip_prompt:h=!1,callback_function:p=null,token_callback_function:g=null,on_chunk_start:b=null,on_chunk_end:v=null,on_finalize:w=null,time_precision:x=.02,skip_special_tokens:S=!0,decode_kwargs:C={}}={}){super(d,{skip_prompt:h,skip_special_tokens:S,callback_function:p,token_callback_function:g,decode_kwargs:C}),this.timestamp_begin=d.timestamp_begin,this.on_chunk_start=b,this.on_chunk_end=v,this.on_finalize=w,this.time_precision=x,this.waiting_for_timestamp=!1}put(d){if(d.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const h=d[0];if(h.length===1){const p=Number(h[0])-this.timestamp_begin;if(p>=0){const g=p*this.time_precision;this.waiting_for_timestamp?this.on_chunk_end?.(g):this.on_chunk_start?.(g),this.waiting_for_timestamp=!this.waiting_for_timestamp,this.token_callback_function?.(h);return}}return super.put(d)}end(){super.end(),this.on_finalize?.()}}}),"./src/models.js":((n,e,t)=>{t.r(e),t.d(e,{ASTForAudioClassification:()=>xs,ASTModel:()=>qn,ASTPreTrainedModel:()=>zn,AlbertForMaskedLM:()=>mn,AlbertForQuestionAnswering:()=>_n,AlbertForSequenceClassification:()=>bn,AlbertModel:()=>wn,AlbertPreTrainedModel:()=>Rt,ArceeForCausalLM:()=>Ep,ArceeModel:()=>Bm,ArceePreTrainedModel:()=>jf,AutoModel:()=>NP,AutoModelForAudioClassification:()=>SC,AutoModelForAudioFrameClassification:()=>HE,AutoModelForAudioTextToText:()=>wr,AutoModelForCTC:()=>jP,AutoModelForCausalLM:()=>xC,AutoModelForDepthEstimation:()=>FP,AutoModelForDocumentQuestionAnswering:()=>RP,AutoModelForImageClassification:()=>qd,AutoModelForImageFeatureExtraction:()=>BP,AutoModelForImageMatting:()=>MC,AutoModelForImageSegmentation:()=>uy,AutoModelForImageTextToText:()=>qE,AutoModelForImageToImage:()=>TC,AutoModelForMaskGeneration:()=>WE,AutoModelForMaskedLM:()=>sv,AutoModelForNormalEstimation:()=>zP,AutoModelForObjectDetection:()=>UE,AutoModelForPoseEstimation:()=>fy,AutoModelForQuestionAnswering:()=>CC,AutoModelForSemanticSegmentation:()=>$P,AutoModelForSeq2SeqLM:()=>OP,AutoModelForSequenceClassification:()=>zE,AutoModelForSpeechSeq2Seq:()=>PP,AutoModelForTextToSpectrogram:()=>nv,AutoModelForTextToWaveform:()=>C0,AutoModelForTokenClassification:()=>DP,AutoModelForUniversalSegmentation:()=>BE,AutoModelForVision2Seq:()=>Jp,AutoModelForXVector:()=>GE,AutoModelForZeroShotObjectDetection:()=>VE,BartForConditionalGeneration:()=>Qr,BartForSequenceClassification:()=>mi,BartModel:()=>Si,BartPretrainedModel:()=>Fr,BaseModelOutput:()=>We,BeitForImageClassification:()=>Zi,BeitModel:()=>Or,BeitPreTrainedModel:()=>Ys,BertForMaskedLM:()=>st,BertForQuestionAnswering:()=>Ke,BertForSequenceClassification:()=>He,BertForTokenClassification:()=>Xe,BertModel:()=>Be,BertPreTrainedModel:()=>de,BlenderbotForConditionalGeneration:()=>Qs,BlenderbotModel:()=>Gr,BlenderbotPreTrainedModel:()=>Di,BlenderbotSmallForConditionalGeneration:()=>il,BlenderbotSmallModel:()=>Oi,BlenderbotSmallPreTrainedModel:()=>Nr,BloomForCausalLM:()=>$p,BloomModel:()=>Pp,BloomPreTrainedModel:()=>Rd,CLIPModel:()=>zo,CLIPPreTrainedModel:()=>Yl,CLIPSegForImageSegmentation:()=>La,CLIPSegModel:()=>Ql,CLIPSegPreTrainedModel:()=>ll,CLIPTextModel:()=>Kl,CLIPTextModelWithProjection:()=>Sc,CLIPVisionModel:()=>Od,CLIPVisionModelWithProjection:()=>Xl,CamembertForMaskedLM:()=>ut,CamembertForQuestionAnswering:()=>xn,CamembertForSequenceClassification:()=>Et,CamembertForTokenClassification:()=>rn,CamembertModel:()=>ze,CamembertPreTrainedModel:()=>Oe,CausalLMOutput:()=>Zf,CausalLMOutputWithPast:()=>UP,ChineseCLIPModel:()=>kc,ChineseCLIPPreTrainedModel:()=>Tc,ClapAudioModelWithProjection:()=>Vw,ClapModel:()=>Wd,ClapPreTrainedModel:()=>J1,ClapTextModelWithProjection:()=>oo,CodeGenForCausalLM:()=>an,CodeGenModel:()=>$t,CodeGenPreTrainedModel:()=>rt,CohereForCausalLM:()=>Co,CohereModel:()=>j1,CoherePreTrainedModel:()=>Np,ConvBertForMaskedLM:()=>sn,ConvBertForQuestionAnswering:()=>ir,ConvBertForSequenceClassification:()=>Tn,ConvBertForTokenClassification:()=>ai,ConvBertModel:()=>Mt,ConvBertPreTrainedModel:()=>On,ConvNextForImageClassification:()=>vw,ConvNextModel:()=>cx,ConvNextPreTrainedModel:()=>Ud,ConvNextV2ForImageClassification:()=>dx,ConvNextV2Model:()=>fx,ConvNextV2PreTrainedModel:()=>ux,DFineForObjectDetection:()=>Gf,DFineModel:()=>Wf,DFinePreTrainedModel:()=>Ma,DINOv3ConvNextModel:()=>CE,DINOv3ConvNextPreTrainedModel:()=>bx,DINOv3ViTModel:()=>yx,DINOv3ViTPreTrainedModel:()=>xw,DPTForDepthEstimation:()=>a0,DPTModel:()=>ff,DPTPreTrainedModel:()=>Up,DacDecoderModel:()=>sy,DacDecoderOutput:()=>ty,DacEncoderModel:()=>ny,DacEncoderOutput:()=>Qw,DacModel:()=>rC,DacPreTrainedModel:()=>Nl,DebertaForMaskedLM:()=>hn,DebertaForQuestionAnswering:()=>Vr,DebertaForSequenceClassification:()=>vs,DebertaForTokenClassification:()=>_s,DebertaModel:()=>Gn,DebertaPreTrainedModel:()=>un,DebertaV2ForMaskedLM:()=>Kr,DebertaV2ForQuestionAnswering:()=>Xr,DebertaV2ForSequenceClassification:()=>sl,DebertaV2ForTokenClassification:()=>Ni,DebertaV2Model:()=>Cr,DebertaV2PreTrainedModel:()=>Yr,DecisionTransformerModel:()=>ey,DecisionTransformerPreTrainedModel:()=>nC,DeiTForImageClassification:()=>ww,DeiTModel:()=>uf,DeiTPreTrainedModel:()=>Fp,DepthAnythingForDepthEstimation:()=>z1,DepthAnythingPreTrainedModel:()=>o0,DepthProForDepthEstimation:()=>l0,DepthProPreTrainedModel:()=>V1,DetrForObjectDetection:()=>ea,DetrForSegmentation:()=>Tr,DetrModel:()=>qa,DetrObjectDetectionOutput:()=>oa,DetrPreTrainedModel:()=>Mr,DetrSegmentationOutput:()=>ei,Dinov2ForImageClassification:()=>px,Dinov2Model:()=>hx,Dinov2PreTrainedModel:()=>_w,Dinov2WithRegistersForImageClassification:()=>gx,Dinov2WithRegistersModel:()=>mx,Dinov2WithRegistersPreTrainedModel:()=>H1,DistilBertForMaskedLM:()=>yo,DistilBertForQuestionAnswering:()=>pi,DistilBertForSequenceClassification:()=>wa,DistilBertForTokenClassification:()=>li,DistilBertModel:()=>oi,DistilBertPreTrainedModel:()=>ka,DonutSwinModel:()=>Dh,DonutSwinPreTrainedModel:()=>G1,EdgeTamModel:()=>Cx,EfficientNetForImageClassification:()=>NE,EfficientNetModel:()=>Jx,EfficientNetPreTrainedModel:()=>Gw,ElectraForMaskedLM:()=>ro,ElectraForQuestionAnswering:()=>ve,ElectraForSequenceClassification:()=>re,ElectraForTokenClassification:()=>Pe,ElectraModel:()=>fs,ElectraPreTrainedModel:()=>Fn,Ernie4_5ForCausalLM:()=>Yf,Ernie4_5Model:()=>g0,Ernie4_5PreTrainedModel:()=>Fw,EsmForMaskedLM:()=>va,EsmForSequenceClassification:()=>bo,EsmForTokenClassification:()=>Wa,EsmModel:()=>Gc,EsmPreTrainedModel:()=>rl,ExaoneForCausalLM:()=>Wm,ExaoneModel:()=>Lp,ExaonePreTrainedModel:()=>af,FalconForCausalLM:()=>Q1,FalconModel:()=>Uw,FalconPreTrainedModel:()=>X1,FastViTForImageClassification:()=>ar,FastViTModel:()=>Wn,FastViTPreTrainedModel:()=>Ds,Florence2ForConditionalGeneration:()=>_c,Florence2PreTrainedModel:()=>Pf,GLPNForDepthEstimation:()=>Bd,GLPNModel:()=>Zm,GLPNPreTrainedModel:()=>Gp,GPT2LMHeadModel:()=>sf,GPT2Model:()=>Eu,GPT2PreTrainedModel:()=>Jl,GPTBigCodeForCausalLM:()=>Le,GPTBigCodeModel:()=>be,GPTBigCodePreTrainedModel:()=>he,GPTJForCausalLM:()=>ee,GPTJModel:()=>F,GPTJPreTrainedModel:()=>nr,GPTNeoForCausalLM:()=>Ac,GPTNeoModel:()=>_o,GPTNeoPreTrainedModel:()=>Ic,GPTNeoXForCausalLM:()=>yr,GPTNeoXModel:()=>ul,GPTNeoXPreTrainedModel:()=>Na,Gemma2ForCausalLM:()=>Rf,Gemma2Model:()=>Zc,Gemma2PreTrainedModel:()=>Qi,Gemma3ForCausalLM:()=>Ih,Gemma3Model:()=>n0,Gemma3PreTrainedModel:()=>Ff,Gemma3nForConditionalGeneration:()=>Cc,Gemma3nPreTrainedModel:()=>kl,GemmaForCausalLM:()=>dl,GemmaModel:()=>mr,GemmaPreTrainedModel:()=>Mi,GlmForCausalLM:()=>kh,GlmModel:()=>Ap,GlmPreTrainedModel:()=>ec,GraniteForCausalLM:()=>$c,GraniteModel:()=>Pc,GraniteMoeHybridForCausalLM:()=>t0,GraniteMoeHybridModel:()=>$1,GraniteMoeHybridPreTrainedModel:()=>Il,GranitePreTrainedModel:()=>of,GroundingDinoForObjectDetection:()=>wx,GroundingDinoPreTrainedModel:()=>Cw,GroupViTModel:()=>jn,GroupViTPreTrainedModel:()=>Yn,HeliumForCausalLM:()=>Vm,HeliumModel:()=>Uo,HeliumPreTrainedModel:()=>Ip,HieraForImageClassification:()=>Xm,HieraModel:()=>i0,HieraPreTrainedModel:()=>Km,HubertForCTC:()=>Fx,HubertForSequenceClassification:()=>zx,HubertModel:()=>Rx,HubertPreTrainedModel:()=>jx,IJepaForImageClassification:()=>tt,IJepaModel:()=>Re,IJepaPreTrainedModel:()=>De,Idefics3ForConditionalGeneration:()=>El,Idefics3PreTrainedModel:()=>$f,ImageMattingOutput:()=>EC,JAISLMHeadModel:()=>cl,JAISModel:()=>Ec,JAISPreTrainedModel:()=>Zl,JinaCLIPModel:()=>Jc,JinaCLIPPreTrainedModel:()=>Qc,JinaCLIPTextModel:()=>Dr,JinaCLIPVisionModel:()=>nf,Lfm2ForCausalLM:()=>rf,Lfm2Model:()=>Um,Lfm2PreTrainedModel:()=>Mh,LiteWhisperForConditionalGeneration:()=>Ki,Llama4ForCausalLM:()=>sr,Llama4PreTrainedModel:()=>Js,LlamaForCausalLM:()=>Es,LlamaModel:()=>Rn,LlamaPreTrainedModel:()=>vn,LlavaForConditionalGeneration:()=>ol,LlavaOnevisionForConditionalGeneration:()=>Xc,LlavaPreTrainedModel:()=>vc,LlavaQwen2ForCausalLM:()=>xc,LongT5ForConditionalGeneration:()=>An,LongT5Model:()=>Sr,LongT5PreTrainedModel:()=>Ci,M2M100ForConditionalGeneration:()=>Aw,M2M100Model:()=>Iw,M2M100PreTrainedModel:()=>Ew,MBartForCausalLM:()=>aa,MBartForConditionalGeneration:()=>Ha,MBartForSequenceClassification:()=>Yi,MBartModel:()=>io,MBartPreTrainedModel:()=>Wr,MPNetForMaskedLM:()=>ci,MPNetForQuestionAnswering:()=>ft,MPNetForSequenceClassification:()=>Gl,MPNetForTokenClassification:()=>Of,MPNetModel:()=>xi,MPNetPreTrainedModel:()=>Rs,MT5ForConditionalGeneration:()=>Ml,MT5Model:()=>wo,MT5PreTrainedModel:()=>Lr,MarianMTModel:()=>kw,MarianModel:()=>Mx,MarianPreTrainedModel:()=>tg,MaskFormerForInstanceSegmentation:()=>hf,MaskFormerModel:()=>df,MaskFormerPreTrainedModel:()=>eu,MaskedLMOutput:()=>co,Metric3DForDepthEstimation:()=>zd,Metric3DPreTrainedModel:()=>W1,Metric3Dv2ForDepthEstimation:()=>Wp,Metric3Dv2PreTrainedModel:()=>Jm,MgpstrForSceneTextRecognition:()=>$i,MgpstrModelOutput:()=>OE,MgpstrPreTrainedModel:()=>ti,MimiDecoderModel:()=>_0,MimiDecoderOutput:()=>Xw,MimiEncoderModel:()=>ag,MimiEncoderOutput:()=>Kp,MimiModel:()=>nu,MimiPreTrainedModel:()=>Qf,Ministral3ForCausalLM:()=>qx,Ministral3Model:()=>Ph,Ministral3PreTrainedModel:()=>sg,MinistralForCausalLM:()=>Hx,MinistralModel:()=>AE,MinistralPreTrainedModel:()=>Gx,Mistral3ForConditionalGeneration:()=>Xi,MistralForCausalLM:()=>ta,MistralModel:()=>m0,MistralPreTrainedModel:()=>p0,MobileBertForMaskedLM:()=>Zt,MobileBertForQuestionAnswering:()=>In,MobileBertForSequenceClassification:()=>cn,MobileBertModel:()=>Ga,MobileBertPreTrainedModel:()=>Us,MobileLLMForCausalLM:()=>Nc,MobileLLMModel:()=>Gm,MobileLLMPreTrainedModel:()=>Pd,MobileNetV1ForImageClassification:()=>Hd,MobileNetV1ForSemanticSegmentation:()=>Yp,MobileNetV1Model:()=>Zx,MobileNetV1PreTrainedModel:()=>Ll,MobileNetV2ForImageClassification:()=>Yw,MobileNetV2ForSemanticSegmentation:()=>mf,MobileNetV2Model:()=>qw,MobileNetV2PreTrainedModel:()=>pf,MobileNetV3ForImageClassification:()=>b0,MobileNetV3ForSemanticSegmentation:()=>w0,MobileNetV3Model:()=>rg,MobileNetV3PreTrainedModel:()=>Z1,MobileNetV4ForImageClassification:()=>tC,MobileNetV4ForSemanticSegmentation:()=>v0,MobileNetV4Model:()=>eC,MobileNetV4PreTrainedModel:()=>$h,MobileViTForImageClassification:()=>Ji,MobileViTModel:()=>Sn,MobileViTPreTrainedModel:()=>$n,MobileViTV2ForImageClassification:()=>Zr,MobileViTV2Model:()=>Vs,MobileViTV2PreTrainedModel:()=>Cs,ModelOutput:()=>$e,ModernBertDecoderForCausalLM:()=>En,ModernBertDecoderModel:()=>yn,ModernBertDecoderPreTrainedModel:()=>us,ModernBertForMaskedLM:()=>ht,ModernBertForSequenceClassification:()=>Qt,ModernBertForTokenClassification:()=>Xt,ModernBertModel:()=>At,ModernBertPreTrainedModel:()=>Gt,Moondream1ForConditionalGeneration:()=>Dd,MoonshineForConditionalGeneration:()=>zi,MoonshineModel:()=>Ea,MoonshinePreTrainedModel:()=>Jr,MptForCausalLM:()=>$,MptModel:()=>N,MptPreTrainedModel:()=>jp,MultiModalityCausalLM:()=>DE,MultiModalityPreTrainedModel:()=>sC,MusicgenForCausalLM:()=>Kf,MusicgenForConditionalGeneration:()=>Hw,MusicgenModel:()=>tu,MusicgenPreTrainedModel:()=>y0,NanoChatForCausalLM:()=>fl,NanoChatModel:()=>Lc,NanoChatPreTrainedModel:()=>zr,NeoBertForMaskedLM:()=>dt,NeoBertForQuestionAnswering:()=>Bt,NeoBertForSequenceClassification:()=>Ft,NeoBertForTokenClassification:()=>It,NeoBertModel:()=>xt,NeoBertPreTrainedModel:()=>Ze,NomicBertModel:()=>Nn,NomicBertPreTrainedModel:()=>Vn,OPTForCausalLM:()=>ye,OPTModel:()=>ie,OPTPreTrainedModel:()=>J,Olmo2ForCausalLM:()=>Oc,Olmo2Model:()=>Dc,Olmo2PreTrainedModel:()=>Eh,OlmoForCausalLM:()=>Hm,OlmoModel:()=>jd,OlmoPreTrainedModel:()=>$d,OpenELMForCausalLM:()=>Iu,OpenELMModel:()=>zf,OpenELMPreTrainedModel:()=>Dp,OwlViTForObjectDetection:()=>Ti,OwlViTModel:()=>To,OwlViTPreTrainedModel:()=>Da,Owlv2ForObjectDetection:()=>Oa,Owlv2Model:()=>Vo,Owlv2PreTrainedModel:()=>Ca,PaliGemmaForConditionalGeneration:()=>tf,PaliGemmaPreTrainedModel:()=>Hl,ParakeetForCTC:()=>q1,ParakeetPreTrainedModel:()=>Ix,PatchTSMixerForPrediction:()=>ig,PatchTSMixerModel:()=>jh,PatchTSMixerPreTrainedModel:()=>Fc,PatchTSTForPrediction:()=>bi,PatchTSTModel:()=>br,PatchTSTPreTrainedModel:()=>lr,Phi3ForCausalLM:()=>xa,Phi3Model:()=>bw,Phi3PreTrainedModel:()=>F1,Phi3VForCausalLM:()=>ku,Phi3VPreTrainedModel:()=>ql,PhiForCausalLM:()=>yw,PhiModel:()=>R1,PhiPreTrainedModel:()=>Op,PreTrainedModel:()=>fe,PretrainedMixin:()=>rr,PvtForImageClassification:()=>Ut,PvtModel:()=>gt,PvtPreTrainedModel:()=>ct,PyAnnoteForAudioFrameClassification:()=>Ax,PyAnnoteModel:()=>Nw,PyAnnotePreTrainedModel:()=>Lw,QuestionAnsweringModelOutput:()=>uo,Qwen2ForCausalLM:()=>Ah,Qwen2Model:()=>jc,Qwen2PreTrainedModel:()=>cf,Qwen2VLForConditionalGeneration:()=>Mo,Qwen2VLPreTrainedModel:()=>Vf,Qwen3ForCausalLM:()=>Ym,Qwen3Model:()=>Uf,Qwen3PreTrainedModel:()=>Bf,RFDetrForObjectDetection:()=>Rc,RFDetrModel:()=>Al,RFDetrObjectDetectionOutput:()=>hl,RFDetrPreTrainedModel:()=>kr,RTDetrForObjectDetection:()=>yi,RTDetrModel:()=>Pa,RTDetrObjectDetectionOutput:()=>or,RTDetrPreTrainedModel:()=>Sa,RTDetrV2ForObjectDetection:()=>ms,RTDetrV2Model:()=>la,RTDetrV2ObjectDetectionOutput:()=>ys,RTDetrV2PreTrainedModel:()=>ko,ResNetForImageClassification:()=>zp,ResNetModel:()=>ca,ResNetPreTrainedModel:()=>Ya,RoFormerForMaskedLM:()=>os,RoFormerForQuestionAnswering:()=>Qn,RoFormerForSequenceClassification:()=>ps,RoFormerForTokenClassification:()=>Ss,RoFormerModel:()=>gr,RoFormerPreTrainedModel:()=>Dn,RobertaForMaskedLM:()=>Hc,RobertaForQuestionAnswering:()=>Nd,RobertaForSequenceClassification:()=>qc,RobertaForTokenClassification:()=>ef,RobertaModel:()=>Tu,RobertaPreTrainedModel:()=>Tl,Sam2ImageSegmentationOutput:()=>c0,Sam2Model:()=>eg,Sam2PreTrainedModel:()=>Tw,Sam3TrackerModel:()=>Sx,SamImageSegmentationOutput:()=>xx,SamModel:()=>ME,SamPreTrainedModel:()=>SE,SapiensForDepthEstimation:()=>B1,SapiensForNormalEstimation:()=>U1,SapiensForSemanticSegmentation:()=>Hf,SapiensPreTrainedModel:()=>Vp,SegformerForImageClassification:()=>Xx,SegformerForSemanticSegmentation:()=>ua,SegformerModel:()=>LE,SegformerPreTrainedModel:()=>Ww,Seq2SeqLMOutput:()=>kC,SequenceClassifierOutput:()=>Ls,SiglipModel:()=>vo,SiglipPreTrainedModel:()=>Mc,SiglipTextModel:()=>Aa,SiglipVisionModel:()=>Pn,SmolLM3ForCausalLM:()=>xo,SmolLM3Model:()=>Bo,SmolLM3PreTrainedModel:()=>Th,SmolVLMForConditionalGeneration:()=>Ia,SnacDecoderModel:()=>og,SnacEncoderModel:()=>Rh,SnacModel:()=>Io,SnacPreTrainedModel:()=>Jf,SpeechT5ForSpeechToText:()=>Vd,SpeechT5ForTextToSpeech:()=>jw,SpeechT5HifiGan:()=>IE,SpeechT5Model:()=>EE,SpeechT5PreTrainedModel:()=>h0,SqueezeBertForMaskedLM:()=>Ue,SqueezeBertForQuestionAnswering:()=>Ct,SqueezeBertForSequenceClassification:()=>Ve,SqueezeBertModel:()=>Ne,SqueezeBertPreTrainedModel:()=>oe,StableLmForCausalLM:()=>Qx,StableLmModel:()=>Gd,StableLmPreTrainedModel:()=>tc,Starcoder2ForCausalLM:()=>Yx,Starcoder2Model:()=>Bw,Starcoder2PreTrainedModel:()=>zw,StyleTextToSpeech2Model:()=>Ux,StyleTextToSpeech2PreTrainedModel:()=>$w,SupertonicForConditionalGeneration:()=>qf,SupertonicPreTrainedModel:()=>Vx,Swin2SRForImageSuperResolution:()=>Qm,Swin2SRModel:()=>Nh,Swin2SRPreTrainedModel:()=>Bp,SwinForImageClassification:()=>Fd,SwinForSemanticSegmentation:()=>Lu,SwinModel:()=>Lh,SwinPreTrainedModel:()=>Au,T5ForConditionalGeneration:()=>Ar,T5Model:()=>ds,T5PreTrainedModel:()=>ls,TableTransformerForObjectDetection:()=>s0,TableTransformerModel:()=>ki,TableTransformerObjectDetectionOutput:()=>r0,TableTransformerPreTrainedModel:()=>Rp,TokenClassifierOutput:()=>lo,TrOCRForCausalLM:()=>Wx,TrOCRPreTrainedModel:()=>Rw,UltravoxModel:()=>Xf,UltravoxPreTrainedModel:()=>Kw,UniSpeechForCTC:()=>pl,UniSpeechForSequenceClassification:()=>Nx,UniSpeechModel:()=>ao,UniSpeechPreTrainedModel:()=>u0,UniSpeechSatForAudioFrameClassification:()=>Px,UniSpeechSatForCTC:()=>Ox,UniSpeechSatForSequenceClassification:()=>d0,UniSpeechSatModel:()=>Dx,UniSpeechSatPreTrainedModel:()=>f0,VaultGemmaForCausalLM:()=>So,VaultGemmaModel:()=>lf,VaultGemmaPreTrainedModel:()=>qm,ViTForImageClassification:()=>Ae,ViTMAEModel:()=>zt,ViTMAEPreTrainedModel:()=>_t,ViTMSNForImageClassification:()=>en,ViTMSNModel:()=>dn,ViTMSNPreTrainedModel:()=>Yt,ViTModel:()=>xe,ViTPreTrainedModel:()=>_e,VisionEncoderDecoderModel:()=>_a,VitMatteForImageMatting:()=>Fs,VitMattePreTrainedModel:()=>Pi,VitPoseForPoseEstimation:()=>je,VitPosePreTrainedModel:()=>St,VitsModel:()=>Eo,VitsModelOutput:()=>YE,VitsPreTrainedModel:()=>Kx,VoxtralForConditionalGeneration:()=>$a,Wav2Vec2BertForCTC:()=>kE,Wav2Vec2BertForSequenceClassification:()=>Y1,Wav2Vec2BertModel:()=>$x,Wav2Vec2BertPreTrainedModel:()=>ng,Wav2Vec2ForAudioFrameClassification:()=>Ex,Wav2Vec2ForCTC:()=>Hp,Wav2Vec2ForSequenceClassification:()=>kx,Wav2Vec2Model:()=>Tx,Wav2Vec2PreTrainedModel:()=>Oh,WavLMForAudioFrameClassification:()=>K1,WavLMForCTC:()=>Ow,WavLMForSequenceClassification:()=>Bx,WavLMForXVector:()=>Pw,WavLMModel:()=>Dw,WavLMPreTrainedModel:()=>qp,WeSpeakerResNetModel:()=>TE,WeSpeakerResNetPreTrainedModel:()=>Lx,WhisperForConditionalGeneration:()=>gi,WhisperModel:()=>pr,WhisperPreTrainedModel:()=>ks,XLMForQuestionAnswering:()=>Y,XLMForSequenceClassification:()=>Kc,XLMForTokenClassification:()=>Sh,XLMModel:()=>Yc,XLMPreTrainedModel:()=>al,XLMRobertaForMaskedLM:()=>Je,XLMRobertaForQuestionAnswering:()=>nn,XLMRobertaForSequenceClassification:()=>pt,XLMRobertaForTokenClassification:()=>Ht,XLMRobertaModel:()=>Fe,XLMRobertaPreTrainedModel:()=>me,XLMWithLMHeadModel:()=>Ch,XVectorOutput:()=>rv,YolosForObjectDetection:()=>vx,YolosModel:()=>Mw,YolosObjectDetectionOutput:()=>_x,YolosPreTrainedModel:()=>Sw});var s=t("./src/configs.js"),r=t("./src/backends/onnx.js"),a=t("./src/utils/dtypes.js"),o=t("./src/utils/generic.js"),l=t("./src/utils/core.js"),c=t("./src/utils/hub.js"),u=t("./src/utils/constants.js"),f=t("./src/generation/logits_process.js"),d=t("./src/generation/configuration_utils.js"),h=t("./src/utils/tensor.js"),p=t("./src/utils/image.js"),g=t("./src/utils/maths.js"),b=t("./src/generation/stopping_criteria.js"),v=t("./src/generation/logits_sampler.js"),w=t("./src/env.js"),x=t("./src/models/whisper/generation_whisper.js"),S=t("./src/models/whisper/common_whisper.js");const C={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12,Supertonic:13},M=new Map,k=new Map,E=new Map;async function I(K,X,Ee){let qe=Ee.config?.["transformers.js_config"]??{},vt=Ee.device??qe.device;vt&&typeof vt!="string"&&(vt.hasOwnProperty(X)?vt=vt[X]:(console.warn(`device not specified for "${X}". Using the default device.`),vt=null));const yt=vt??(w.apis.IS_NODE_ENV?"cpu":"wasm"),Vt=(0,r.deviceToExecutionProviders)(yt),on=qe.device_config??{};on.hasOwnProperty(yt)&&(qe={...qe,...on[yt]});let gn=Ee.dtype??qe.dtype;if(typeof gn!="string"&&(gn&&gn.hasOwnProperty(X)?gn=gn[X]:(gn=a.DEFAULT_DEVICE_DTYPE_MAPPING[yt]??a.DATA_TYPES.fp32,console.warn(`dtype not specified for "${X}". Using the default dtype (${gn}) for this device (${yt}).`))),gn===a.DATA_TYPES.auto){let qs=qe.dtype;typeof qs!="string"&&(qs=qs?.[X]),qs&&qs!==a.DATA_TYPES.auto&&a.DATA_TYPES.hasOwnProperty(qs)?gn=qs:gn=a.DEFAULT_DEVICE_DTYPE_MAPPING[yt]??a.DATA_TYPES.fp32}const Ln=gn;if(a.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(Ln)){if(Ln===a.DATA_TYPES.fp16&&yt==="webgpu"&&!await(0,a.isWebGpuFp16Supported)())throw new Error(`The device (${yt}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${Ln}. Should be one of: ${Object.keys(a.DATA_TYPES).join(", ")}`);const Is=qe.kv_cache_dtype,Ms=Is?typeof Is=="string"?Is:Is[Ln]??"float32":void 0;if(Ms&&!["float32","float16"].includes(Ms))throw new Error(`Invalid kv_cache_dtype: ${Ms}. Should be one of: float32, float16`);const Ps={dtype:Ln,kv_cache_dtype:Ms,device:yt},ss=a.DEFAULT_DTYPE_SUFFIX_MAPPING[Ln],vr=`${X}${ss}.onnx`,rs=`${Ee.subfolder??""}/${vr}`,is={...Ee.session_options};is.executionProviders??=Vt;const cr=qe.free_dimension_overrides;cr?is.freeDimensionOverrides??=cr:yt.startsWith("webnn")&&!is.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${yt}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);const ni=w.apis.IS_NODE_ENV&&w.env.useFSCache,Bi=(0,c.getModelFile)(K,rs,!0,Ee,ni),fa=Ee.use_external_data_format??qe.use_external_data_format;let ja=[];if(fa){let qs;typeof fa=="object"?fa.hasOwnProperty(vr)?qs=fa[vr]:fa.hasOwnProperty(X)?qs=fa[X]:qs=!1:qs=fa;const da=+qs;if(da>c.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${da}) exceeds the maximum allowed value (${c.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let fo=0;fo<da;++fo){const cg=`${vr}_data${fo===0?"":"_"+fo}`,Bc=`${Ee.subfolder??""}/${cg}`;ja.push(new Promise(async(gf,Zp)=>{const em=await(0,c.getModelFile)(K,Bc,!0,Ee,ni);gf(em instanceof Uint8Array?{path:cg,data:em}:cg)}))}}else is.externalData!==void 0&&(ja=is.externalData.map(async qs=>{if(typeof qs.data=="string"){const da=await(0,c.getModelFile)(K,qs.data,!0,Ee);return{...qs,data:da}}return qs}));if(ja.length>0){const qs=await Promise.all(ja);w.apis.IS_NODE_ENV||(is.externalData=qs)}if(yt==="webgpu"){const qs=(0,s.getCacheShapes)(Ee.config,{prefix:"present"});if(Object.keys(qs).length>0&&!(0,r.isONNXProxy)()){const da={};for(const fo in qs)da[fo]="gpu-buffer";is.preferredOutputLocation=da}}return{buffer_or_path:await Bi,session_options:is,session_config:Ps}}async function A(K,X,Ee){return Object.fromEntries(await Promise.all(Object.keys(X).map(async qe=>{const{buffer_or_path:vt,session_options:yt,session_config:Vt}=await I(K,X[qe],Ee),on=await(0,r.createInferenceSession)(vt,yt,Vt);return[qe,on]})))}async function D(K,X,Ee){return Object.fromEntries(await Promise.all(Object.keys(X).map(async qe=>{const vt=await(0,c.getModelJSON)(K,X[qe],!1,Ee);return[qe,vt]})))}function L(K,X){const Ee=Object.create(null),qe=[];for(const Vt of K.inputNames){const on=X[Vt];if(!(on instanceof h.Tensor)){qe.push(Vt);continue}Ee[Vt]=(0,r.isONNXProxy)()?on.clone():on}if(qe.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${qe.join(", ")}.`);const vt=Object.keys(X).length,yt=K.inputNames.length;if(vt>yt){let Vt=Object.keys(X).filter(on=>!K.inputNames.includes(on));console.warn(`WARNING: Too many inputs were provided (${vt} > ${yt}). The following inputs will be ignored: "${Vt.join(", ")}".`)}return Ee}async function P(K,X){const Ee=L(K,X);try{const qe=Object.fromEntries(Object.entries(Ee).map(([yt,Vt])=>[yt,Vt.ort_tensor])),vt=await(0,r.runInferenceSession)(K,qe);return j(vt)}catch(qe){const vt=Object.fromEntries(Object.entries(Ee).map(([yt,Vt])=>{const on={type:Vt.type,dims:Vt.dims,location:Vt.location};return on.location!=="gpu-buffer"&&(on.data=Vt.data),[yt,on]}));throw console.error(`An error occurred during model execution: "${qe}".`),console.error("Inputs given to model:",vt),qe}}function j(K){for(let X in K)(0,r.isONNXTensor)(K[X])?K[X]=new h.Tensor(K[X]):typeof K[X]=="object"&&j(K[X]);return K}function G(K){if(K instanceof h.Tensor)return K;if(K.length===0)throw Error("items must be non-empty");if(Array.isArray(K[0])){if(K.some(X=>X.length!==K[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new h.Tensor("int64",BigInt64Array.from(K.flat().map(X=>BigInt(X))),[K.length,K[0].length])}else return new h.Tensor("int64",BigInt64Array.from(K.map(X=>BigInt(X))),[1,K.length])}function Q(K){return new h.Tensor("bool",[K],[1])}async function q(K,X){let{encoder_outputs:Ee,input_ids:qe,decoder_input_ids:vt,...yt}=X;if(!Ee){const on=(0,l.pick)(X,K.sessions.model.inputNames);Ee=(await te(K,on)).last_hidden_state}return yt.input_ids=vt,yt.encoder_hidden_states=Ee,K.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(yt.encoder_attention_mask=X.attention_mask),await ne(K,yt,!0)}async function te(K,X){const Ee=K.sessions.model,qe=(0,l.pick)(X,Ee.inputNames);if(Ee.inputNames.includes("inputs_embeds")&&!qe.inputs_embeds){if(!X.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");qe.inputs_embeds=await K.encode_text({input_ids:X.input_ids})}if(Ee.inputNames.includes("token_type_ids")&&!qe.token_type_ids){if(!qe.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");qe.token_type_ids=(0,h.zeros_like)(qe.input_ids)}if(Ee.inputNames.includes("pixel_mask")&&!qe.pixel_mask){if(!qe.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const vt=qe.pixel_values.dims;qe.pixel_mask=(0,h.ones)([vt[0],vt[2],vt[3]])}return await P(Ee,qe)}async function Z(K,X){const Ee=await K.encode(X);return await K.decode(Ee)}async function ne(K,X,Ee=!1){const qe=K.sessions[Ee?"decoder_model_merged":"model"],{past_key_values:vt,...yt}=X;if(qe.inputNames.includes("use_cache_branch")&&(yt.use_cache_branch=Q(!!vt)),qe.inputNames.includes("position_ids")&&yt.attention_mask&&!yt.position_ids){const on=["paligemma","gemma3_text","gemma3"].includes(K.config.model_type)?1:0;yt.position_ids=ge(yt,vt,on)}K.addPastKeyValues(yt,vt);const Vt=(0,l.pick)(yt,qe.inputNames);return await P(qe,Vt)}function le({modality_token_id:K,inputs_embeds:X,modality_features:Ee,input_ids:qe,attention_mask:vt}){const yt=qe.tolist().map(Ln=>Ln.reduce((Is,Ms,Ps)=>(Ms==K&&Is.push(Ps),Is),[])),Vt=yt.reduce((Ln,Is)=>Ln+Is.length,0),on=Ee.dims[0];if(Vt!==on)throw new Error(`Number of tokens and features do not match: tokens: ${Vt}, features ${on}`);let gn=0;for(let Ln=0;Ln<yt.length;++Ln){const Is=yt[Ln],Ms=X[Ln];for(let Ps=0;Ps<Is.length;++Ps)Ms[Is[Ps]].data.set(Ee[gn++].data)}return{inputs_embeds:X,attention_mask:vt}}function H({image_token_id:K,inputs_embeds:X,image_features:Ee,input_ids:qe,attention_mask:vt}){return le({modality_token_id:K,inputs_embeds:X,modality_features:Ee,input_ids:qe,attention_mask:vt})}function R({audio_token_id:K,inputs_embeds:X,audio_features:Ee,input_ids:qe,attention_mask:vt}){return le({modality_token_id:K,inputs_embeds:X,modality_features:Ee,input_ids:qe,attention_mask:vt})}async function B(K,{encode_function:X,merge_function:Ee,modality_input_name:qe,modality_output_name:vt,input_ids:yt=null,attention_mask:Vt=null,position_ids:on=null,inputs_embeds:gn=null,past_key_values:Ln=null,generation_config:Is=null,logits_processor:Ms=null,...Ps}){const ss=Ps[qe];if(!gn){if(gn=await K.encode_text({input_ids:yt,...Ps}),ss&&yt.dims[1]!==1){const rs=await X({[qe]:ss,...Ps});({inputs_embeds:gn,attention_mask:Vt}=Ee({[vt]:rs,inputs_embeds:gn,input_ids:yt,attention_mask:Vt}))}else if(Ln&&ss&&yt.dims[1]===1){const rs=yt.dims[1],is=Object.values(Ln)[0].dims.at(-2);Vt=(0,h.cat)([(0,h.ones)([yt.dims[0],is]),Vt.slice(null,[Vt.dims[1]-rs,Vt.dims[1]])],1)}}if(!on&&K.config.model_type==="qwen2_vl"){const{image_grid_thw:rs,video_grid_thw:is}=Ps;[on]=K.get_rope_index(yt,rs,is,Vt)}return await ne(K,{inputs_embeds:gn,past_key_values:Ln,attention_mask:Vt,position_ids:on,generation_config:Is,logits_processor:Ms},!0)}async function W(K,X){return await B(K,{...X,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:K.encode_audio.bind(K),merge_function:K._merge_input_ids_with_audio_features.bind(K)})}async function se(K,X){return await B(K,{...X,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:K.encode_image.bind(K),merge_function:K._merge_input_ids_with_image_features.bind(K)})}function ue(K,X=0){const[Ee,qe]=K.dims,vt=K.data,yt=new BigInt64Array(vt.length);for(let Vt=0;Vt<Ee;++Vt){const on=Vt*qe;let gn=BigInt(X);for(let Ln=0;Ln<qe;++Ln){const Is=on+Ln;vt[Is]===0n?yt[Is]=BigInt(1):(yt[Is]=gn,gn+=vt[Is])}}return{data:yt,dims:K.dims}}function ge(K,X=null,Ee=0){const{input_ids:qe,inputs_embeds:vt,attention_mask:yt}=K,{data:Vt,dims:on}=ue(yt,Ee);let gn=new h.Tensor("int64",Vt,on);if(X){const Ln=-(qe??vt).dims.at(1);gn=gn.slice(null,[Ln,null])}return gn}function Ce(K,X,Ee,qe){const vt=Ee.past_key_values?Object.values(Ee.past_key_values)[0].dims.at(-2):0;if(!Ee.attention_mask){let yt;for(const Vt of["input_ids","inputs_embeds","position_ids"])if(Ee[Vt]){yt=Ee[Vt].dims;break}if(!yt)throw new Error("attention_mask is not provided, and unable to infer its shape from model inputs.");Ee.attention_mask=(0,h.ones)([yt[0],vt+yt[1]])}if(Ee.past_key_values){const{input_ids:yt,attention_mask:Vt}=Ee;Vt&&Vt.dims[1]>yt.dims[1]||vt<yt.dims[1]&&(Ee.input_ids=yt.slice(null,[vt,null]))}return Ee}function Se(K,X,Ee,qe){return Ee.past_key_values&&(X=X.map(vt=>[vt.at(-1)])),{...Ee,decoder_input_ids:G(X)}}function Me(K,...X){return K.config.is_encoder_decoder?Se(K,...X):Ce(K,...X)}function pe(K,X,Ee,qe){const vt=!!Ee.past_key_values;return qe.guidance_scale!==null&&qe.guidance_scale>1&&(vt?Ee.input_ids=(0,h.cat)([Ee.input_ids,Ee.input_ids],0):(Ee.input_ids=(0,h.cat)([Ee.input_ids,(0,h.full_like)(Ee.input_ids,BigInt(qe.pad_token_id))],0),Ee.attention_mask=(0,h.cat)([Ee.attention_mask,(0,h.full_like)(Ee.attention_mask,0n)],0))),(vt||!Ee.pixel_values)&&(Ee.pixel_values=(0,h.full)([0,0,3,384,384],1)),vt&&(Ee.images_seq_mask=new h.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),Ee.images_emb_mask=new h.Tensor("bool",new Array(0).fill(!1),[1,1,0])),Ee}class fe extends o.Callable{main_input_name="input_ids";forward_params=["input_ids","attention_mask"];constructor(X,Ee,qe){super(),this.config=X,this.sessions=Ee,this.configs=qe;const vt=E.get(this.constructor),yt=M.get(vt);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,yt){case C.DecoderOnly:this.can_generate=!0,this._forward=ne,this._prepare_inputs_for_generation=Ce;break;case C.Seq2Seq:case C.Vision2Seq:case C.Musicgen:this.can_generate=!0,this._forward=q,this._prepare_inputs_for_generation=Se;break;case C.EncoderDecoder:this._forward=q;break;case C.ImageTextToText:this.can_generate=!0,this._forward=se,this._prepare_inputs_for_generation=Me;break;case C.AudioTextToText:this.can_generate=!0,this._forward=W,this._prepare_inputs_for_generation=Me;break;case C.Phi3V:case C.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=Me;break;case C.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=pe;break;case C.AutoEncoder:this._forward=Z;break;default:this._forward=te;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){const X=[];for(const Ee of Object.values(this.sessions))Ee?.handler?.dispose&&X.push(Ee.handler.dispose());return await Promise.all(X)}static async from_pretrained(X,{progress_callback:Ee=null,config:qe=null,cache_dir:vt=null,local_files_only:yt=!1,revision:Vt="main",model_file_name:on=null,subfolder:gn="onnx",device:Ln=null,dtype:Is=null,use_external_data_format:Ms=null,session_options:Ps={}}={}){let ss={progress_callback:Ee,config:qe,cache_dir:vt,local_files_only:yt,revision:Vt,model_file_name:on,subfolder:gn,device:Ln,dtype:Is,use_external_data_format:Ms,session_options:Ps};const vr=E.get(this),rs=M.get(vr);qe=ss.config=await s.AutoConfig.from_pretrained(X,ss);let is;if(rs===C.DecoderOnly)is=await Promise.all([A(X,{model:ss.model_file_name??"model"},ss),D(X,{generation_config:"generation_config.json"},ss)]);else if(rs===C.Seq2Seq||rs===C.Vision2Seq)is=await Promise.all([A(X,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},ss),D(X,{generation_config:"generation_config.json"},ss)]);else if(rs===C.MaskGeneration)is=await Promise.all([A(X,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},ss)]);else if(rs===C.EncoderDecoder)is=await Promise.all([A(X,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},ss)]);else if(rs===C.ImageTextToText){const cr={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};qe.is_encoder_decoder&&(cr.model="encoder_model"),is=await Promise.all([A(X,cr,ss),D(X,{generation_config:"generation_config.json"},ss)])}else if(rs===C.AudioTextToText){const cr={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};is=await Promise.all([A(X,cr,ss),D(X,{generation_config:"generation_config.json"},ss)])}else if(rs===C.ImageAudioTextToText){const cr={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};is=await Promise.all([A(X,cr,ss),D(X,{generation_config:"generation_config.json"},ss)])}else if(rs===C.Musicgen)is=await Promise.all([A(X,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},ss),D(X,{generation_config:"generation_config.json"},ss)]);else if(rs===C.MultiModality)is=await Promise.all([A(X,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},ss),D(X,{generation_config:"generation_config.json"},ss)]);else if(rs===C.Phi3V)is=await Promise.all([A(X,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},ss),D(X,{generation_config:"generation_config.json"},ss)]);else if(rs===C.AutoEncoder)is=await Promise.all([A(X,{encoder_model:"encoder_model",decoder_model:"decoder_model"},ss)]);else if(rs===C.Supertonic)is=await Promise.all([A(X,{text_encoder:"text_encoder",latent_denoiser:"latent_denoiser",voice_decoder:"voice_decoder"},ss)]);else{if(rs!==C.EncoderOnly){const cr=vr??qe?.model_type;cr!=="custom"&&console.warn(`Model type for '${cr}' not found, assuming encoder-only architecture. Please report this at ${u.GITHUB_ISSUE_URL}.`)}is=await Promise.all([A(X,{model:ss.model_file_name??"model"},ss)])}return new this(qe,...is)}async _call(X){return await this.forward(X)}async forward(X){return await this._forward(this,X)}get generation_config(){return this.configs?.generation_config??null}_get_logits_processor(X,Ee,qe=null){const vt=new f.LogitsProcessorList;if(X.repetition_penalty!==null&&X.repetition_penalty!==1&&vt.push(new f.RepetitionPenaltyLogitsProcessor(X.repetition_penalty)),X.no_repeat_ngram_size!==null&&X.no_repeat_ngram_size>0&&vt.push(new f.NoRepeatNGramLogitsProcessor(X.no_repeat_ngram_size)),X.bad_words_ids!==null&&vt.push(new f.NoBadWordsLogitsProcessor(X.bad_words_ids,X.eos_token_id)),X.min_length!==null&&X.eos_token_id!==null&&X.min_length>0&&vt.push(new f.MinLengthLogitsProcessor(X.min_length,X.eos_token_id)),X.min_new_tokens!==null&&X.eos_token_id!==null&&X.min_new_tokens>0&&vt.push(new f.MinNewTokensLengthLogitsProcessor(Ee,X.min_new_tokens,X.eos_token_id)),X.forced_bos_token_id!==null&&vt.push(new f.ForcedBOSTokenLogitsProcessor(X.forced_bos_token_id)),X.forced_eos_token_id!==null&&vt.push(new f.ForcedEOSTokenLogitsProcessor(X.max_length,X.forced_eos_token_id)),X.begin_suppress_tokens!==null){const yt=Ee>1||X.forced_bos_token_id===null?Ee:Ee+1;vt.push(new f.SuppressTokensAtBeginLogitsProcessor(X.begin_suppress_tokens,yt))}return X.guidance_scale!==null&&X.guidance_scale>1&&vt.push(new f.ClassifierFreeGuidanceLogitsProcessor(X.guidance_scale)),X.temperature===0&&X.do_sample&&(console.warn("`do_sample` changed to false because `temperature: 0` implies greedy sampling (always selecting the most likely token), which is incompatible with `do_sample: true`."),X.do_sample=!1),X.do_sample&&X.temperature!==null&&X.temperature!==1&&vt.push(new f.TemperatureLogitsWarper(X.temperature)),qe!==null&&vt.extend(qe),vt}_prepare_generation_config(X,Ee,qe=d.GenerationConfig){const vt={...this.config};for(const Vt of["decoder","generator","text_config"])Vt in vt&&Object.assign(vt,vt[Vt]);const yt=new qe(vt);return Object.assign(yt,this.generation_config??{}),X&&Object.assign(yt,X),Ee&&Object.assign(yt,(0,l.pick)(Ee,Object.getOwnPropertyNames(yt))),yt}_get_stopping_criteria(X,Ee=null){const qe=new b.StoppingCriteriaList;return X.max_length!==null&&qe.push(new b.MaxLengthCriteria(X.max_length,this.config.max_position_embeddings??null)),X.eos_token_id!==null&&qe.push(new b.EosTokenCriteria(X.eos_token_id)),Ee&&qe.extend(Ee),qe}_validate_model_class(){if(!this.can_generate){const X=[cC,Qp,Jw,iy],Ee=E.get(this.constructor),qe=new Set,vt=this.config.model_type;for(const Vt of X){const on=Vt.get(vt);on&&qe.add(on[0])}let yt=`The current model class (${Ee}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw qe.size>0&&(yt+=` Please use the following class instead: ${[...qe].join(", ")}`),Error(yt)}}prepare_inputs_for_generation(...X){return this._prepare_inputs_for_generation(this,...X)}_update_model_kwargs_for_generation({generated_input_ids:X,outputs:Ee,model_inputs:qe,is_encoder_decoder:vt}){return qe.past_key_values=this.getPastKeyValues(Ee,qe.past_key_values),qe.input_ids=new h.Tensor("int64",X.flat(),[X.length,1]),vt||(qe.attention_mask=(0,h.cat)([qe.attention_mask,(0,h.ones)([qe.attention_mask.dims[0],1])],1)),qe.position_ids=null,qe}_prepare_model_inputs({inputs:X,bos_token_id:Ee,model_kwargs:qe}){const vt=(0,l.pick)(qe,this.forward_params),yt=this.main_input_name;if(yt in vt){if(X)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else vt[yt]=X;return{inputs_tensor:vt[yt],model_inputs:vt,model_input_name:yt}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:X,model_inputs:Ee,model_input_name:qe,generation_config:vt}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!Ee.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:Vt,pixel_values:on,attention_mask:gn,...Ln}=Ee,Is=await this._prepare_inputs_embeds(Ee);Ee={...Ln,...(0,l.pick)(Is,["inputs_embeds","attention_mask"])}}let{last_hidden_state:yt}=await te(this,Ee);if(vt.guidance_scale!==null&&vt.guidance_scale>1)yt=(0,h.cat)([yt,(0,h.full_like)(yt,0)],0),"attention_mask"in Ee&&(Ee.attention_mask=(0,h.cat)([Ee.attention_mask,(0,h.zeros_like)(Ee.attention_mask)],0));else if(Ee.decoder_input_ids){const Vt=G(Ee.decoder_input_ids).dims[0];if(Vt!==yt.dims[0]){if(yt.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${yt.dims[0]}) than the decoder inputs (${Vt}).`);yt=(0,h.cat)(Array.from({length:Vt},()=>yt),0)}}return Ee.encoder_outputs=yt,Ee}_prepare_decoder_input_ids_for_generation({batch_size:X,model_input_name:Ee,model_kwargs:qe,decoder_start_token_id:vt,bos_token_id:yt,generation_config:Vt}){let{decoder_input_ids:on,...gn}=qe;if(!(on instanceof h.Tensor)){if(on)Array.isArray(on[0])||(on=Array.from({length:X},()=>on));else if(vt??=yt,this.config.model_type==="musicgen")on=Array.from({length:X*this.config.decoder.num_codebooks},()=>[vt]);else if(Array.isArray(vt)){if(vt.length!==X)throw new Error(`\`decoder_start_token_id\` expcted to have length ${X} but got ${vt.length}`);on=vt}else on=Array.from({length:X},()=>[vt]);on=G(on)}return qe.decoder_attention_mask=(0,h.ones_like)(on),{input_ids:on,model_inputs:gn}}async generate({inputs:X=null,generation_config:Ee=null,logits_processor:qe=null,stopping_criteria:vt=null,streamer:yt=null,...Vt}){this._validate_model_class(),Ee=this._prepare_generation_config(Ee,Vt);let{inputs_tensor:on,model_inputs:gn,model_input_name:Ln}=this._prepare_model_inputs({inputs:X,model_kwargs:Vt});const Is=this.config.is_encoder_decoder;Is&&("encoder_outputs"in gn||(gn=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:on,model_inputs:gn,model_input_name:Ln,generation_config:Ee})));let Ms;Is?{input_ids:Ms,model_inputs:gn}=this._prepare_decoder_input_ids_for_generation({batch_size:gn[Ln].dims.at(0),model_input_name:Ln,model_kwargs:gn,decoder_start_token_id:Ee.decoder_start_token_id,bos_token_id:Ee.bos_token_id,generation_config:Ee}):Ms=gn[Ln];let Ps=Ms.dims.at(-1);Ee.max_new_tokens!==null&&(Ee.max_length=Ps+Ee.max_new_tokens);const ss=this._get_logits_processor(Ee,Ps,qe),vr=this._get_stopping_criteria(Ee,vt),rs=gn[Ln].dims.at(0),is=v.LogitsSampler.getSampler(Ee),cr=new Array(rs).fill(0),ni=Ms.tolist();yt&&yt.put(ni);let Bi,fa={};for(;;){if(gn=this.prepare_inputs_for_generation(ni,gn,Ee),Bi=await this.forward(gn),Ee.output_attentions&&Ee.return_dict_in_generate){const Bc=this.getAttentions(Bi);for(const gf in Bc)gf in fa||(fa[gf]=[]),fa[gf].push(Bc[gf])}const qs=Bi.logits.slice(null,-1,null),da=ss(ni,qs),fo=[];for(let Bc=0;Bc<da.dims.at(0);++Bc){const gf=da[Bc],Zp=await is(gf);for(const[em,iv]of Zp){const nc=BigInt(em);cr[Bc]+=iv,ni[Bc].push(nc),fo.push([nc]);break}}if(yt&&yt.put(fo),vr(ni).every(Bc=>Bc))break;gn=this._update_model_kwargs_for_generation({generated_input_ids:fo,outputs:Bi,model_inputs:gn,is_encoder_decoder:Is})}yt&&yt.end();const ja=this.getPastKeyValues(Bi,gn.past_key_values,!0),Ii=new h.Tensor("int64",ni.flat(),[ni.length,ni[0].length]);if(Ee.return_dict_in_generate)return{sequences:Ii,past_key_values:ja,...fa};for(const qs of Object.values(Bi))qs.location==="gpu-buffer"&&qs.dispose();return Ii}getPastKeyValues(X,Ee,qe=!1){const vt=Object.create(null);for(const yt in X)if(yt.startsWith("present")){const Vt=yt.replace("present_conv","past_conv").replace("present","past_key_values"),on=yt.includes("encoder");if(on&&Ee?vt[Vt]=Ee[Vt]:vt[Vt]=X[yt],Ee&&(!on||qe)){const gn=Ee[Vt];gn.location==="gpu-buffer"&&gn.dispose()}}return vt}getAttentions(X){const Ee={};for(const qe of["cross_attentions","encoder_attentions","decoder_attentions"])for(const vt in X)vt.startsWith(qe)&&(qe in Ee||(Ee[qe]=[]),Ee[qe].push(X[vt]));return Ee}addPastKeyValues(X,Ee){if(Ee)Object.assign(X,Ee);else{const qe=this.sessions.decoder_model_merged??this.sessions.model,vt=(X[this.main_input_name]??X.attention_mask)?.dims?.[0]??1,yt=qe?.config?.kv_cache_dtype??"float32",Vt=yt==="float16"?h.DataTypeMap.float16:h.DataTypeMap.float32,on=(0,s.getCacheShapes)(this.config,{batch_size:vt});for(const gn in on){const Ln=on[gn].reduce((Is,Ms)=>Is*Ms,1);X[gn]=new h.Tensor(yt,new Vt(Ln),on[gn])}}}async encode_image({pixel_values:X}){return(await P(this.sessions.vision_encoder,{pixel_values:X})).image_features}async encode_text({input_ids:X}){return(await P(this.sessions.embed_tokens,{input_ids:X})).inputs_embeds}async encode_audio({audio_values:X}){return(await P(this.sessions.audio_encoder,{audio_values:X})).audio_features}}class $e{}class We extends $e{constructor({last_hidden_state:X,hidden_states:Ee=null,attentions:qe=null}){super(),this.last_hidden_state=X,this.hidden_states=Ee,this.attentions=qe}}class de extends fe{}class Be extends de{}class st extends de{async _call(X){return new co(await super._call(X))}}class He extends de{async _call(X){return new Ls(await super._call(X))}}class Xe extends de{async _call(X){return new lo(await super._call(X))}}class Ke extends de{async _call(X){return new uo(await super._call(X))}}class Ze extends fe{}class xt extends Ze{}class dt extends Ze{async _call(X){return new co(await super._call(X))}}class Ft extends Ze{async _call(X){return new Ls(await super._call(X))}}class It extends Ze{async _call(X){return new lo(await super._call(X))}}class Bt extends Ze{async _call(X){return new uo(await super._call(X))}}class Gt extends fe{}class At extends Gt{}class ht extends Gt{async _call(X){return new co(await super._call(X))}}class Qt extends Gt{async _call(X){return new Ls(await super._call(X))}}class Xt extends Gt{async _call(X){return new lo(await super._call(X))}}class us extends fe{}class yn extends us{}class En extends us{}class Vn extends fe{}class Nn extends Vn{}class Dn extends fe{}class gr extends Dn{}class os extends Dn{async _call(X){return new co(await super._call(X))}}class ps extends Dn{async _call(X){return new Ls(await super._call(X))}}class Ss extends Dn{async _call(X){return new lo(await super._call(X))}}class Qn extends Dn{async _call(X){return new uo(await super._call(X))}}class On extends fe{}class Mt extends On{}class sn extends On{async _call(X){return new co(await super._call(X))}}class Tn extends On{async _call(X){return new Ls(await super._call(X))}}class ai extends On{async _call(X){return new lo(await super._call(X))}}class ir extends On{async _call(X){return new uo(await super._call(X))}}class Fn extends fe{}class fs extends Fn{}class ro extends Fn{async _call(X){return new co(await super._call(X))}}class re extends Fn{async _call(X){return new Ls(await super._call(X))}}class Pe extends Fn{async _call(X){return new lo(await super._call(X))}}class ve extends Fn{async _call(X){return new uo(await super._call(X))}}class Oe extends fe{}class ze extends Oe{}class ut extends Oe{async _call(X){return new co(await super._call(X))}}class Et extends Oe{async _call(X){return new Ls(await super._call(X))}}class rn extends Oe{async _call(X){return new lo(await super._call(X))}}class xn extends Oe{async _call(X){return new uo(await super._call(X))}}class un extends fe{}class Gn extends un{}class hn extends un{async _call(X){return new co(await super._call(X))}}class vs extends un{async _call(X){return new Ls(await super._call(X))}}class _s extends un{async _call(X){return new lo(await super._call(X))}}class Vr extends un{async _call(X){return new uo(await super._call(X))}}class Yr extends fe{}class Cr extends Yr{}class Kr extends Yr{async _call(X){return new co(await super._call(X))}}class sl extends Yr{async _call(X){return new Ls(await super._call(X))}}class Ni extends Yr{async _call(X){return new lo(await super._call(X))}}class Xr extends Yr{async _call(X){return new uo(await super._call(X))}}class ka extends fe{}class oi extends ka{}class wa extends ka{async _call(X){return new Ls(await super._call(X))}}class li extends ka{async _call(X){return new lo(await super._call(X))}}class pi extends ka{async _call(X){return new uo(await super._call(X))}}class yo extends ka{async _call(X){return new co(await super._call(X))}}class rl extends fe{}class Gc extends rl{}class va extends rl{async _call(X){return new co(await super._call(X))}}class bo extends rl{async _call(X){return new Ls(await super._call(X))}}class Wa extends rl{async _call(X){return new lo(await super._call(X))}}class Us extends fe{}class Ga extends Us{}class Zt extends Us{async _call(X){return new co(await super._call(X))}}class cn extends Us{async _call(X){return new Ls(await super._call(X))}}class In extends Us{async _call(X){return new uo(await super._call(X))}}class Rs extends fe{}class xi extends Rs{}class ci extends Rs{async _call(X){return new co(await super._call(X))}}class Gl extends Rs{async _call(X){return new Ls(await super._call(X))}}class Of extends Rs{async _call(X){return new lo(await super._call(X))}}class ft extends Rs{async _call(X){return new uo(await super._call(X))}}class oe extends fe{}class Ne extends oe{}class Ue extends oe{async _call(X){return new co(await super._call(X))}}class Ve extends oe{async _call(X){return new Ls(await super._call(X))}}class Ct extends oe{async _call(X){return new uo(await super._call(X))}}class Rt extends fe{}class wn extends Rt{}class bn extends Rt{async _call(X){return new Ls(await super._call(X))}}class _n extends Rt{async _call(X){return new uo(await super._call(X))}}class mn extends Rt{async _call(X){return new co(await super._call(X))}}class ls extends fe{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"]}class ds extends ls{}class Ar extends ls{}class Ci extends fe{}class Sr extends Ci{}class An extends Ci{}class Lr extends fe{}class wo extends Lr{}class Ml extends Lr{}class Fr extends fe{}class Si extends Fr{}class Qr extends Fr{}class mi extends Fr{async _call(X){return new Ls(await super._call(X))}}class Wr extends fe{}class io extends Wr{}class Ha extends Wr{}class Yi extends Wr{async _call(X){return new Ls(await super._call(X))}}class aa extends Wr{}class Di extends fe{}class Gr extends Di{}class Qs extends Di{}class Nr extends fe{}class Oi extends Nr{}class il extends Nr{}class Tl extends fe{}class Tu extends Tl{}class Hc extends Tl{async _call(X){return new co(await super._call(X))}}class qc extends Tl{async _call(X){return new Ls(await super._call(X))}}class ef extends Tl{async _call(X){return new lo(await super._call(X))}}class Nd extends Tl{async _call(X){return new uo(await super._call(X))}}class al extends fe{}class Yc extends al{}class Ch extends al{async _call(X){return new co(await super._call(X))}}class Kc extends al{async _call(X){return new Ls(await super._call(X))}}class Sh extends al{async _call(X){return new lo(await super._call(X))}}class Y extends al{async _call(X){return new uo(await super._call(X))}}class me extends fe{}class Fe extends me{}class Je extends me{async _call(X){return new co(await super._call(X))}}class pt extends me{async _call(X){return new Ls(await super._call(X))}}class Ht extends me{async _call(X){return new lo(await super._call(X))}}class nn extends me{async _call(X){return new uo(await super._call(X))}}class zn extends fe{}class qn extends zn{}class xs extends zn{}class ks extends fe{requires_attention_mask=!1;main_input_name="input_features";forward_params=["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"]}class pr extends ks{}class gi extends ks{_prepare_generation_config(X,Ee){return super._prepare_generation_config(X,Ee,x.WhisperGenerationConfig)}_retrieve_init_tokens(X){const Ee=[X.decoder_start_token_id];let qe=X.language;const vt=X.task;if(X.is_multilingual){qe||(console.warn("No language specified - defaulting to English (en)."),qe="en");const Vt=`<|${(0,S.whisper_language_to_code)(qe)}|>`;Ee.push(X.lang_to_id[Vt]),Ee.push(X.task_to_id[vt??"transcribe"])}else if(qe||vt)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!X.return_timestamps&&X.no_timestamps_token_id&&Ee.at(-1)!==X.no_timestamps_token_id?Ee.push(X.no_timestamps_token_id):X.return_timestamps&&Ee.at(-1)===X.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),Ee.pop()),Ee.filter(yt=>yt!=null)}async generate({inputs:X=null,generation_config:Ee=null,logits_processor:qe=null,stopping_criteria:vt=null,...yt}){Ee=this._prepare_generation_config(Ee,yt);const Vt=yt.decoder_input_ids??this._retrieve_init_tokens(Ee);if(Ee.return_timestamps&&(qe??=new f.LogitsProcessorList,qe.push(new f.WhisperTimeStampLogitsProcessor(Ee,Vt))),Ee.begin_suppress_tokens&&(qe??=new f.LogitsProcessorList,qe.push(new f.SuppressTokensAtBeginLogitsProcessor(Ee.begin_suppress_tokens,Vt.length))),Ee.return_token_timestamps){if(!Ee.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");Ee.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),Ee.output_attentions=!0,Ee.return_dict_in_generate=!0}const on=await super.generate({inputs:X,generation_config:Ee,logits_processor:qe,decoder_input_ids:Vt,...yt});return Ee.return_token_timestamps&&(on.token_timestamps=this._extract_token_timestamps(on,Ee.alignment_heads,Ee.num_frames)),on}_extract_token_timestamps(X,Ee,qe=null,vt=.02){if(!X.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");qe==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let yt=this.config.median_filter_width;yt===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),yt=7);const Vt=X.cross_attentions,on=Array.from({length:this.config.decoder_layers},(rs,is)=>(0,h.cat)(Vt.map(cr=>cr[is]),2)),gn=(0,h.stack)(Ee.map(([rs,is])=>{if(rs>=on.length)throw new Error(`Layer index ${rs} is out of bounds for cross attentions (length ${on.length}).`);return qe?on[rs].slice(null,is,null,[0,qe]):on[rs].slice(null,is)})).transpose(1,0,2,3),[Ln,Is]=(0,h.std_mean)(gn,-2,0,!0),Ms=gn.clone();for(let rs=0;rs<Ms.dims[0];++rs){const is=Ms[rs];for(let cr=0;cr<is.dims[0];++cr){const ni=is[cr],Bi=Ln[rs][cr][0].data,fa=Is[rs][cr][0].data;for(let ja=0;ja<ni.dims[0];++ja){let Ii=ni[ja].data;for(let qs=0;qs<Ii.length;++qs)Ii[qs]=(Ii[qs]-fa[qs])/Bi[qs];Ii.set((0,g.medianFilter)(Ii,yt))}}}const Ps=[(0,h.mean)(Ms,1)],ss=X.sequences.dims,vr=new h.Tensor("float32",new Float32Array(ss[0]*ss[1]),ss);for(let rs=0;rs<ss[0];++rs){const is=Ps[rs].neg().squeeze_(0),[cr,ni]=(0,g.dynamic_time_warping)(is.tolist()),Bi=Array.from({length:cr.length-1},(Ii,qs)=>cr[qs+1]-cr[qs]),fa=(0,l.mergeArrays)([1],Bi).map(Ii=>!!Ii),ja=[];for(let Ii=0;Ii<fa.length;++Ii)fa[Ii]&&ja.push(ni[Ii]*vt);vr[rs].data.set(ja,1)}return vr}}class Ki extends gi{}class Jr extends fe{requires_attention_mask=!1;main_input_name="input_values";forward_params=["input_values","decoder_input_ids","past_key_values"]}class Ea extends Jr{}class zi extends Jr{}class _a extends fe{main_input_name="pixel_values";forward_params=["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"]}class vc extends fe{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class ol extends vc{_merge_input_ids_with_image_features(X){const Ee=X.image_features.dims.at(-1),qe=X.image_features.view(-1,Ee);return H({image_token_id:this.config.image_token_index,...X,image_features:qe})}}class Xc extends ol{}class Dd extends ol{}class Pf extends fe{forward_params=["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"];main_input_name="inputs_embeds"}class _c extends Pf{_merge_input_ids_with_image_features({inputs_embeds:X,image_features:Ee,input_ids:qe,attention_mask:vt}){return{inputs_embeds:(0,h.cat)([Ee,X],1),attention_mask:(0,h.cat)([(0,h.ones)(Ee.dims.slice(0,2)),vt],1)}}async _prepare_inputs_embeds({input_ids:X,pixel_values:Ee,inputs_embeds:qe,attention_mask:vt}){if(!X&&!Ee)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let yt,Vt;return X&&(yt=await this.encode_text({input_ids:X})),Ee&&(Vt=await this.encode_image({pixel_values:Ee})),yt&&Vt?{inputs_embeds:qe,attention_mask:vt}=this._merge_input_ids_with_image_features({inputs_embeds:yt,image_features:Vt,input_ids:X,attention_mask:vt}):qe=yt||Vt,{inputs_embeds:qe,attention_mask:vt}}async forward({input_ids:X,pixel_values:Ee,attention_mask:qe,decoder_input_ids:vt,decoder_attention_mask:yt,encoder_outputs:Vt,past_key_values:on,inputs_embeds:gn,decoder_inputs_embeds:Ln}){if(gn||({inputs_embeds:gn,attention_mask:qe}=await this._prepare_inputs_embeds({input_ids:X,pixel_values:Ee,inputs_embeds:gn,attention_mask:qe})),!Vt){let{last_hidden_state:Ps}=await te(this,{inputs_embeds:gn,attention_mask:qe});Vt=Ps}if(!Ln){if(!vt)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");Ln=await this.encode_text({input_ids:vt})}return await ne(this,{inputs_embeds:Ln,attention_mask:yt,encoder_attention_mask:qe,encoder_hidden_states:Vt,past_key_values:on},!0)}}class Hl extends fe{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class tf extends Hl{_merge_input_ids_with_image_features(X){const Ee=X.image_features.dims.at(-1),qe=X.image_features.view(-1,Ee);return H({image_token_id:this.config.image_token_index,...X,image_features:qe})}}class xc extends vc{_merge_input_ids_with_image_features(X){const Ee=X.image_features.dims.at(-1),qe=X.image_features.view(-1,Ee);return H({image_token_id:this.config.image_token_index,...X,image_features:qe})}}class Xi extends xc{}class kl extends fe{forward_params=["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"]}class Cc extends kl{async forward({input_ids:X=null,attention_mask:Ee=null,pixel_values:qe=null,input_features:vt=null,input_features_mask:yt=null,position_ids:Vt=null,inputs_embeds:on=null,per_layer_inputs:gn=null,past_key_values:Ln=null,generation_config:Is=null,logits_processor:Ms=null,...Ps}){if((!on||!gn)&&({inputs_embeds:on,per_layer_inputs:gn}=await P(this.sessions.embed_tokens,{input_ids:X}),X.dims[1]!==1)){if(qe){const{image_features:vr}=await P(this.sessions.vision_encoder,{pixel_values:qe});({inputs_embeds:on,attention_mask:Ee}=this._merge_input_ids_with_image_features({image_features:vr,inputs_embeds:on,input_ids:X,attention_mask:Ee}))}if(vt){const{audio_features:vr}=await P(this.sessions.audio_encoder,{input_features:vt,input_features_mask:yt});({inputs_embeds:on,attention_mask:Ee}=this._merge_input_ids_with_audio_features({audio_features:vr,inputs_embeds:on,input_ids:X,attention_mask:Ee}))}}return await ne(this,{inputs_embeds:on,per_layer_inputs:gn,past_key_values:Ln,attention_mask:Ee,position_ids:Vt,generation_config:Is,logits_processor:Ms},!0)}_merge_input_ids_with_image_features(X){const Ee=X.image_features.dims.at(-1),qe=X.image_features.view(-1,Ee);return H({image_token_id:this.config.image_token_id,...X,image_features:qe})}_merge_input_ids_with_audio_features(X){const Ee=X.audio_features.dims.at(-1),qe=X.audio_features.view(-1,Ee);return R({audio_token_id:this.config.audio_token_id,...X,audio_features:qe})}}class $f extends fe{forward_params=["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"]}class El extends $f{async encode_image({pixel_values:X,pixel_attention_mask:Ee}){return(await P(this.sessions.vision_encoder,{pixel_values:X,pixel_attention_mask:Ee})).image_features}_merge_input_ids_with_image_features(X){const Ee=X.image_features.dims.at(-1),qe=X.image_features.view(-1,Ee);return H({image_token_id:this.config.image_token_id,...X,image_features:qe})}}class Ia extends El{}class ql extends fe{forward_params=["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"]}class ku extends ql{async forward({input_ids:X=null,attention_mask:Ee=null,pixel_values:qe=null,image_sizes:vt=null,position_ids:yt=null,inputs_embeds:Vt=null,past_key_values:on=null,generation_config:gn=null,logits_processor:Ln=null,...Is}){if(!Vt){let Ps;if(qe&&X.dims[1]!==1){if(!vt)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:Ps}=await P(this.sessions.vision_encoder,{pixel_values:qe,image_sizes:vt}))}else{const ss=this.config.normalized_config.hidden_size;Ps=new h.Tensor("float32",[],[0,ss])}({inputs_embeds:Vt}=await P(this.sessions.prepare_inputs_embeds,{input_ids:X,image_features:Ps}))}return await ne(this,{inputs_embeds:Vt,past_key_values:on,attention_mask:Ee,position_ids:yt,generation_config:gn,logits_processor:Ln},!1)}}class Yl extends fe{}class zo extends Yl{}class Kl extends Yl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"text_model"})}}class Sc extends Yl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"text_model"})}}class Od extends Yl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"vision_model"})}}class Xl extends Yl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"vision_model"})}}class Mc extends fe{}class vo extends Mc{}class Aa extends Mc{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"text_model"})}}class Pn extends Yl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"vision_model"})}}class Tc extends fe{}class kc extends Tc{}class Qc extends fe{}class Jc extends Qc{async forward(X){const Ee=!X.input_ids,qe=!X.pixel_values;if(Ee&&qe)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(Ee&&(X.input_ids=(0,h.ones)([X.pixel_values.dims[0],1])),qe){const{image_size:Ln}=this.config.vision_config;X.pixel_values=(0,h.full)([0,3,Ln,Ln],0)}const{text_embeddings:vt,image_embeddings:yt,l2norm_text_embeddings:Vt,l2norm_image_embeddings:on}=await super.forward(X),gn={};return Ee||(gn.text_embeddings=vt,gn.l2norm_text_embeddings=Vt),qe||(gn.image_embeddings=yt,gn.l2norm_image_embeddings=on),gn}}class Dr extends Qc{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"text_model"})}}class nf extends Qc{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"vision_model"})}}class ll extends fe{}class Ql extends ll{}class La extends ll{}class Jl extends fe{}class Eu extends Jl{}class sf extends Jl{}class Zl extends fe{}class Ec extends Zl{}class cl extends Zl{}class Ic extends fe{}class _o extends Ic{}class Ac extends Ic{}class Na extends fe{}class ul extends Na{}class yr extends Na{}class nr extends fe{}class F extends nr{}class ee extends nr{}class he extends fe{}class be extends he{}class Le extends he{}class rt extends fe{}class $t extends rt{}class an extends rt{}class vn extends fe{}class Rn extends vn{}class Es extends vn{}class Js extends fe{}class sr extends Js{}class zr extends fe{}class Lc extends zr{}class fl extends zr{}class jf extends fe{}class Bm extends jf{}class Ep extends jf{}class Mh extends fe{}class Um extends Mh{}class rf extends Mh{}class Th extends fe{}class Bo extends Th{}class xo extends Th{}class Ip extends fe{}class Uo extends Ip{}class Vm extends Ip{}class ec extends fe{}class Ap extends ec{}class kh extends ec{}class af extends fe{}class Lp extends af{}class Wm extends af{}class Pd extends fe{}class Gm extends Pd{}class Nc extends Pd{}class $d extends fe{}class jd extends $d{}class Hm extends $d{}class Eh extends fe{}class Dc extends Eh{}class Oc extends Eh{}class of extends fe{}class Pc extends of{}class $c extends of{}class Il extends fe{}class $1 extends Il{}class t0 extends Il{}class Np extends fe{}class j1 extends Np{}class Co extends Np{}class Mi extends fe{}class mr extends Mi{}class dl extends Mi{}class Qi extends fe{}class Zc extends Qi{}class Rf extends Qi{}class qm extends fe{}class lf extends qm{}class So extends qm{}class Ff extends fe{}class n0 extends Ff{}class Ih extends Ff{}class Dp extends fe{}class zf extends Dp{}class Iu extends Dp{}class cf extends fe{}class jc extends cf{}class Ah extends cf{}class Bf extends fe{}class Uf extends Bf{}class Ym extends Bf{}class Vf extends fe{forward_params=["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"]}class Mo extends Vf{get_rope_index(X,Ee,qe,vt){const{vision_config:yt,image_token_id:Vt,video_token_id:on,vision_start_token_id:gn}=this.config,Ln=yt.spatial_merge_size??2,Is=[];if(Ee||qe){let Ms=X.tolist();vt||(vt=(0,h.ones_like)(X));const Ps=vt.tolist(),ss=Array.from({length:3},ni=>Array.from({length:X.dims[0]},Bi=>Array.from({length:X.dims[1]},fa=>1))),vr=Ee?Ee.tolist():[],rs=qe?qe.tolist():[];let is=0,cr=0;for(let ni=0;ni<Ms.length;++ni){const Bi=Ms[ni].filter((Ui,ho)=>Ps[ni][ho]==1),ja=Bi.reduce((Ui,ho,Fh)=>(ho==gn&&Ui.push(Fh),Ui),[]).map(Ui=>Bi[Ui+1]),Ii=ja.filter(Ui=>Ui==Vt).length,qs=ja.filter(Ui=>Ui==on).length;let da=[],fo=0,cg=Ii,Bc=qs;for(let Ui=0;Ui<ja.length;++Ui){const ho=Bi.findIndex((nm,sc)=>sc>fo&&nm==Vt),Fh=Bi.findIndex((nm,sc)=>sc>fo&&nm==on),ed=cg>0&&ho!==-1?ho:Bi.length+1,Dl=Bc>0&&Fh!==-1?Fh:Bi.length+1;let dy,S0,td,AC;ed<Dl?([S0,td,AC]=vr[is],++is,--cg,dy=ed):([S0,td,AC]=rs[cr],++cr,--Bc,dy=Dl);const[VP,tm,hy]=[Number(S0),Math.floor(Number(td)/Ln),Math.floor(Number(AC)/Ln)],LC=dy-fo,KE=da.length>0?(0,g.max)(da.at(-1))[0]+1:0;da.push(Array.from({length:3*LC},(nm,sc)=>KE+sc%LC));const NC=LC+KE,av=VP*tm*hy,WP=Array.from({length:av},(nm,sc)=>NC+Math.floor(sc/(tm*hy))),GP=Array.from({length:av},(nm,sc)=>NC+Math.floor(sc/hy)%tm),HP=Array.from({length:av},(nm,sc)=>NC+sc%hy);da.push([WP,GP,HP].flat()),fo=dy+av}if(fo<Bi.length){const Ui=da.length>0?(0,g.max)(da.at(-1))[0]+1:0,ho=Bi.length-fo;da.push(Array.from({length:3*ho},(Fh,ed)=>Ui+ed%ho))}const gf=da.reduce((Ui,ho)=>Ui+ho.length,0),Zp=new Array(gf);let em=0;for(let Ui=0;Ui<3;++Ui)for(let ho=0;ho<da.length;++ho){const Fh=da[ho],ed=Fh.length/3;for(let Dl=Ui*ed;Dl<(Ui+1)*ed;++Dl)Zp[em++]=Fh[Dl]}let iv=0;const nc=Ps[ni];for(let Ui=0;Ui<nc.length;++Ui)if(nc[Ui]==1){for(let ho=0;ho<3;++ho)ss[ho][ni][Ui]=Zp[ho*gf/3+iv];++iv}const IC=(0,g.max)(Zp)[0];Is.push(IC+1-Ms[ni].length)}return[new h.Tensor("int64",ss.flat(1/0),[3,X.dims[0],X.dims[1]]),new h.Tensor("int64",Is,[Is.length,1])]}else if(vt){const{data:Ms,dims:Ps}=ue(vt),ss=BigInt64Array.from({length:3*Ms.length},(rs,is)=>Ms[is%Ms.length]),vr=Array.from({length:Ps[0]},(rs,is)=>(0,g.max)(Ms.subarray(Ps[1]*is,Ps[1]*(is+1)))[0]+1n+BigInt(Ps[1]));return[new h.Tensor("int64",ss,[3,...Ps]),new h.Tensor("int64",vr,[vr.length,1])]}else{const[Ms,Ps]=X.dims,ss=BigInt64Array.from({length:3*Ms*Ps},(vr,rs)=>BigInt(Math.floor(rs%Ps/Ms)));return[new h.Tensor("int64",ss,[3,...X.dims]),(0,h.zeros)([Ms,1])]}}async encode_image({pixel_values:X,image_grid_thw:Ee}){return(await P(this.sessions.vision_encoder,{pixel_values:X,grid_thw:Ee})).image_features}_merge_input_ids_with_image_features(X){return H({image_token_id:this.config.image_token_id,...X})}prepare_inputs_for_generation(X,Ee,qe){if(Ee.attention_mask&&!Ee.position_ids)if(!Ee.past_key_values)[Ee.position_ids,Ee.rope_deltas]=this.get_rope_index(Ee.input_ids,Ee.image_grid_thw,Ee.video_grid_thw,Ee.attention_mask);else{Ee.pixel_values=null;const vt=BigInt(Object.values(Ee.past_key_values)[0].dims.at(-2)),yt=Ee.rope_deltas.map(Vt=>vt+Vt);Ee.position_ids=(0,h.stack)([yt,yt,yt],0)}return Ee}}class Op extends fe{}class R1 extends Op{}class yw extends Op{}class F1 extends fe{}class bw extends F1{}class xa extends F1{}class Rd extends fe{}class Pp extends Rd{}class $p extends Rd{}class jp extends fe{}class N extends jp{}class $ extends jp{}class J extends fe{}class ie extends J{}class ye extends J{}class _e extends fe{}class xe extends _e{}class Ae extends _e{async _call(X){return new Ls(await super._call(X))}}class De extends fe{}class Re extends De{}class tt extends De{async _call(X){return new Ls(await super._call(X))}}class St extends fe{}class je extends St{}class ct extends fe{}class gt extends ct{}class Ut extends ct{async _call(X){return new Ls(await super._call(X))}}class _t extends fe{}class zt extends _t{}class Yt extends fe{}class dn extends Yt{}class en extends Yt{async _call(X){return new Ls(await super._call(X))}}class Yn extends fe{}class jn extends Yn{}class Ds extends fe{}class Wn extends Ds{}class ar extends Ds{async _call(X){return new Ls(await super._call(X))}}class Pi extends fe{}class Fs extends Pi{async _call(X){return new EC(await super._call(X))}}class $n extends fe{}class Sn extends $n{}class Ji extends $n{async _call(X){return new Ls(await super._call(X))}}class Cs extends fe{}class Vs extends Cs{}class Zr extends Cs{async _call(X){return new Ls(await super._call(X))}}class Da extends fe{}class To extends Da{}class Ti extends Da{}class Ca extends fe{}class Vo extends Ca{}class Oa extends Ca{}class Ys extends fe{}class Or extends Ys{}class Zi extends Ys{async _call(X){return new Ls(await super._call(X))}}class Mr extends fe{}class qa extends Mr{}class ea extends Mr{async _call(X){return new oa(await super._call(X))}}class Tr extends Mr{async _call(X){return new ei(await super._call(X))}}class oa extends $e{constructor({logits:X,pred_boxes:Ee}){super(),this.logits=X,this.pred_boxes=Ee}}class ei extends $e{constructor({logits:X,pred_boxes:Ee,pred_masks:qe}){super(),this.logits=X,this.pred_boxes=Ee,this.pred_masks=qe}}class Sa extends fe{}class Pa extends Sa{}class yi extends Sa{async _call(X){return new or(await super._call(X))}}class or extends $e{constructor({logits:X,pred_boxes:Ee}){super(),this.logits=X,this.pred_boxes=Ee}}class ko extends fe{}class la extends ko{}class ms extends ko{async _call(X){return new ys(await super._call(X))}}class ys extends or{}class kr extends fe{}class Al extends kr{}class Rc extends kr{async _call(X){return new hl(await super._call(X))}}class hl extends or{}class Ma extends fe{}class Wf extends Ma{}class Gf extends Ma{async _call(X){return new or(await super._call(X))}}class Rp extends fe{}class ki extends Rp{}class s0 extends Rp{async _call(X){return new r0(await super._call(X))}}class r0 extends oa{}class Fp extends fe{}class uf extends Fp{}class ww extends Fp{async _call(X){return new Ls(await super._call(X))}}class Km extends fe{}class i0 extends Km{}class Xm extends Km{async _call(X){return new Ls(await super._call(X))}}class Ya extends fe{}class ca extends Ya{}class zp extends Ya{async _call(X){return new Ls(await super._call(X))}}class Au extends fe{}class Lh extends Au{}class Fd extends Au{async _call(X){return new Ls(await super._call(X))}}class Lu extends Au{}class Bp extends fe{}class Nh extends Bp{}class Qm extends Bp{}class Up extends fe{}class ff extends Up{}class a0 extends Up{}class o0 extends fe{}class z1 extends o0{}class Vp extends fe{}class Hf extends Vp{}class B1 extends Vp{}class U1 extends Vp{}class V1 extends fe{}class l0 extends V1{}class W1 extends fe{}class zd extends W1{}class Jm extends fe{}class Wp extends Jm{}class eu extends fe{}class df extends eu{}class hf extends eu{}class Gp extends fe{}class Zm extends Gp{}class Bd extends Gp{}class G1 extends fe{}class Dh extends G1{}class Ud extends fe{}class cx extends Ud{}class vw extends Ud{async _call(X){return new Ls(await super._call(X))}}class ux extends fe{}class fx extends ux{}class dx extends ux{async _call(X){return new Ls(await super._call(X))}}class _w extends fe{}class hx extends _w{}class px extends _w{async _call(X){return new Ls(await super._call(X))}}class H1 extends fe{}class mx extends H1{}class gx extends H1{async _call(X){return new Ls(await super._call(X))}}class xw extends fe{}class yx extends xw{}class bx extends fe{}class CE extends bx{}class Cw extends fe{}class wx extends Cw{}class Sw extends fe{}class Mw extends Sw{}class vx extends Sw{async _call(X){return new _x(await super._call(X))}}class _x extends $e{constructor({logits:X,pred_boxes:Ee}){super(),this.logits=X,this.pred_boxes=Ee}}class SE extends fe{}class ME extends SE{async get_image_embeddings({pixel_values:X}){return await te(this,{pixel_values:X})}async forward(X){!X.image_embeddings||!X.image_positional_embeddings?X={...X,...await this.get_image_embeddings(X)}:X={...X},X.input_labels??=(0,h.ones)(X.input_points.dims.slice(0,-1));const Ee={image_embeddings:X.image_embeddings,image_positional_embeddings:X.image_positional_embeddings};return X.input_points&&(Ee.input_points=X.input_points),X.input_labels&&(Ee.input_labels=X.input_labels),X.input_boxes&&(Ee.input_boxes=X.input_boxes),await P(this.sessions.prompt_encoder_mask_decoder,Ee)}async _call(X){return new xx(await super._call(X))}}class xx extends $e{constructor({iou_scores:X,pred_masks:Ee}){super(),this.iou_scores=X,this.pred_masks=Ee}}class c0 extends $e{constructor({iou_scores:X,pred_masks:Ee,object_score_logits:qe}){super(),this.iou_scores=X,this.pred_masks=Ee,this.object_score_logits=qe}}class Tw extends fe{}class eg extends Tw{async get_image_embeddings({pixel_values:X}){return await te(this,{pixel_values:X})}async forward(X){const{num_feature_levels:Ee}=this.config.vision_config;if(Array.from({length:Ee},(Vt,on)=>`image_embeddings.${on}`).some(Vt=>!X[Vt])?X={...X,...await this.get_image_embeddings(X)}:X={...X},X.input_points){if(X.input_boxes&&X.input_boxes.dims[1]!==1)throw new Error("When both `input_points` and `input_boxes` are provided, the number of boxes per image must be 1.");const Vt=X.input_points.dims;X.input_labels??=(0,h.ones)(Vt.slice(0,-1)),X.input_boxes??=(0,h.full)([Vt[0],0,4],0)}else if(X.input_boxes){const Vt=X.input_boxes.dims;X.input_labels=(0,h.full)([Vt[0],Vt[1],0],-1n),X.input_points=(0,h.full)([Vt[0],1,0,2],0)}else throw new Error("At least one of `input_points` or `input_boxes` must be provided.");const vt=this.sessions.prompt_encoder_mask_decoder,yt=(0,l.pick)(X,vt.inputNames);return await P(vt,yt)}async _call(X){return new c0(await super._call(X))}}class Cx extends eg{}class Sx extends eg{}class tg extends fe{}class Mx extends tg{}class kw extends tg{}class Ew extends fe{}class Iw extends Ew{}class Aw extends Ew{}class Oh extends fe{}class Tx extends Oh{}class Hp extends Oh{async _call(X){return new Zf(await super._call(X))}}class kx extends Oh{async _call(X){return new Ls(await super._call(X))}}class Ex extends Oh{async _call(X){return new lo(await super._call(X))}}class Ix extends fe{}class q1 extends Ix{async _call(X){return new Zf(await super._call(X))}}class Lw extends fe{}class Nw extends Lw{}class Ax extends Lw{async _call(X){return new lo(await super._call(X))}}class Lx extends fe{}class TE extends Lx{}class u0 extends fe{}class ao extends u0{}class pl extends u0{async _call(X){return new Zf(await super._call(X))}}class Nx extends u0{async _call(X){return new Ls(await super._call(X))}}class f0 extends fe{}class Dx extends f0{}class Ox extends f0{async _call(X){return new Zf(await super._call(X))}}class d0 extends f0{async _call(X){return new Ls(await super._call(X))}}class Px extends f0{async _call(X){return new lo(await super._call(X))}}class ng extends fe{}class $x extends ng{}class kE extends ng{async _call(X){return new Zf(await super._call(X))}}class Y1 extends ng{async _call(X){return new Ls(await super._call(X))}}class jx extends fe{}class Rx extends Oh{}class Fx extends Oh{async _call(X){return new Zf(await super._call(X))}}class zx extends Oh{async _call(X){return new Ls(await super._call(X))}}class qp extends fe{}class Dw extends qp{}class Ow extends qp{async _call(X){return new Zf(await super._call(X))}}class Bx extends qp{async _call(X){return new Ls(await super._call(X))}}class Pw extends qp{async _call(X){return new rv(await super._call(X))}}class K1 extends qp{async _call(X){return new lo(await super._call(X))}}class $w extends fe{}class Ux extends $w{}class h0 extends fe{}class EE extends h0{}class Vd extends h0{}class jw extends h0{async generate_speech(X,Ee,{threshold:qe=.5,minlenratio:vt=0,maxlenratio:yt=20,vocoder:Vt=null}={}){const on={input_ids:X},{encoder_outputs:gn,encoder_attention_mask:Ln}=await te(this,on),Is=gn.dims[1]/this.config.reduction_factor,Ms=Math.floor(Is*yt),Ps=Math.floor(Is*vt),ss=this.config.num_mel_bins;let vr=[],rs=null,is=null,cr=0;for(;;){++cr;const fa=Q(!!is);let ja;is?ja=is.output_sequence_out:ja=new h.Tensor("float32",new Float32Array(ss),[1,1,ss]);let Ii={use_cache_branch:fa,output_sequence:ja,encoder_attention_mask:Ln,speaker_embeddings:Ee,encoder_hidden_states:gn};this.addPastKeyValues(Ii,rs),is=await P(this.sessions.decoder_model_merged,Ii),rs=this.getPastKeyValues(is,rs);const{prob:qs,spectrum:da}=is;if(vr.push(da),cr>=Ps&&(Array.from(qs.data).filter(fo=>fo>=qe).length>0||cr>=Ms))break}const ni=(0,h.cat)(vr),{waveform:Bi}=await P(Vt.sessions.model,{spectrogram:ni});return{spectrogram:ni,waveform:Bi}}}class IE extends fe{main_input_name="spectrogram"}class Vx extends fe{}class qf extends Vx{async generate_speech({input_ids:X,attention_mask:Ee,style:qe,num_inference_steps:vt=5,speed:yt=1.05}){const{sampling_rate:Vt,chunk_compress_factor:on,base_chunk_size:gn,latent_dim:Ln}=this.config,{last_hidden_state:Is,durations:Ms}=await P(this.sessions.text_encoder,{input_ids:X,attention_mask:Ee,style:qe});Ms.div_(yt);const Ps=Ms.max().item()*Vt,ss=gn*on,vr=Math.floor((Ps+ss-1)/ss),rs=X.dims[0],is=(0,h.ones)([rs,vr]),cr=(0,h.full)([rs],vt);let ni=(0,h.randn)([rs,Ln*on,vr]);for(let fa=0;fa<vt;++fa){const ja=(0,h.full)([rs],fa);({denoised_latents:ni}=await P(this.sessions.latent_denoiser,{style:qe,noisy_latents:ni,latent_mask:is,encoder_outputs:Is,attention_mask:Ee,timestep:ja,num_inference_steps:cr}))}const{waveform:Bi}=await P(this.sessions.voice_decoder,{latents:ni});return{waveform:Bi,durations:Ms}}}class Rw extends fe{}class Wx extends Rw{}class p0 extends fe{}class m0 extends p0{}class ta extends p0{}class Gx extends fe{}class AE extends Gx{}class Hx extends Gx{}class sg extends fe{}class Ph extends sg{}class qx extends sg{}class Fw extends fe{}class g0 extends Fw{}class Yf extends Fw{}class zw extends fe{}class Bw extends zw{}class Yx extends zw{}class X1 extends fe{}class Uw extends X1{}class Q1 extends X1{}class J1 extends fe{}class Wd extends J1{}class oo extends J1{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"text_model"})}}class Vw extends J1{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"audio_model"})}}class Kx extends fe{}class Eo extends Kx{async _call(X){return new YE(await super._call(X))}}class Ww extends fe{}class LE extends Ww{}class Xx extends Ww{}class ua extends Ww{}class tc extends fe{}class Gd extends tc{}class Qx extends tc{}class Gw extends fe{}class Jx extends Gw{}class NE extends Gw{async _call(X){return new Ls(await super._call(X))}}class y0 extends fe{}class tu extends y0{}class Kf extends y0{}class Hw extends fe{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"];_apply_and_filter_by_delay_pattern_mask(X){const[Ee,qe]=X.dims,vt=this.config.decoder.num_codebooks,yt=qe-vt;let Vt=0;for(let Ln=0;Ln<X.size;++Ln){if(X.data[Ln]===this.config.decoder.pad_token_id)continue;const Is=Ln%qe,Ms=Math.floor(Ln/qe)%vt,Ps=Is-Ms;Ps>0&&Ps<=yt&&(X.data[Vt++]=X.data[Ln])}const on=Math.floor(Ee/vt),gn=Vt/(on*vt);return new h.Tensor(X.type,X.data.slice(0,Vt),[on,vt,gn])}prepare_inputs_for_generation(X,Ee,qe){let vt=structuredClone(X);for(let Vt=0;Vt<vt.length;++Vt)for(let on=0;on<vt[Vt].length;++on)Vt%this.config.decoder.num_codebooks>=on&&(vt[Vt][on]=BigInt(this.config.decoder.pad_token_id));return qe.guidance_scale!==null&&qe.guidance_scale>1&&(vt=vt.concat(vt)),super.prepare_inputs_for_generation(vt,Ee,qe)}async generate(X){const Ee=await super.generate(X),qe=this._apply_and_filter_by_delay_pattern_mask(Ee).unsqueeze_(0),{audio_values:vt}=await P(this.sessions.encodec_decode,{audio_codes:qe});return vt}}class Ll extends fe{}class Zx extends Ll{}class Hd extends Ll{async _call(X){return new Ls(await super._call(X))}}class Yp extends Ll{}class pf extends fe{}class qw extends pf{}class Yw extends pf{async _call(X){return new Ls(await super._call(X))}}class mf extends pf{}class Z1 extends fe{}class rg extends Z1{}class b0 extends Z1{async _call(X){return new Ls(await super._call(X))}}class w0 extends Z1{}class $h extends fe{}class eC extends $h{}class tC extends $h{async _call(X){return new Ls(await super._call(X))}}class v0 extends $h{}class nC extends fe{}class ey extends nC{}class sC extends fe{}class DE extends sC{forward_params=["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"];constructor(...X){super(...X),this._generation_mode="text"}async forward(X){const Ee=this._generation_mode??"text";let qe;if(Ee==="text"||!X.past_key_values){const gn=this.sessions.prepare_inputs_embeds,Ln=(0,l.pick)(X,gn.inputNames);qe=await P(gn,Ln)}else{const gn=this.sessions.gen_img_embeds,Ln=(0,l.pick)({image_ids:X.input_ids},gn.inputNames);qe=await P(gn,Ln)}const vt={...X,...qe},yt=await ne(this,vt),Vt=this.sessions[Ee==="text"?"lm_head":"gen_head"];if(!Vt)throw new Error(`Unable to find "${Vt}" generation head`);const on=await P(Vt,(0,l.pick)(yt,Vt.inputNames));return{...qe,...yt,...on}}async generate(X){return this._generation_mode="text",super.generate(X)}async generate_images(X){this._generation_mode="image";const Ee=(X.inputs??X[this.main_input_name]).dims[1],vt=(await super.generate(X)).slice(null,[Ee,null]),yt=this.sessions.image_decode,{decoded_image:Vt}=await P(yt,{generated_tokens:vt}),on=Vt.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),gn=[];for(const Ln of on){const Is=p.RawImage.fromTensor(Ln);gn.push(Is)}return gn}}class OE extends $e{constructor({char_logits:X,bpe_logits:Ee,wp_logits:qe}){super(),this.char_logits=X,this.bpe_logits=Ee,this.wp_logits=qe}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class ti extends fe{}class $i extends ti{async _call(X){return new OE(await super._call(X))}}class lr extends fe{}class br extends lr{}class bi extends lr{}class Fc extends fe{}class jh extends Fc{}class ig extends Fc{}class Kw extends fe{forward_params=["input_ids","attention_mask","position_ids","audio_values","past_key_values"]}class Xf extends Kw{_merge_input_ids_with_audio_features(X){const Ee=X.audio_features.dims.at(-1),qe=X.audio_features.view(-1,Ee);return R({audio_token_id:this.config.ignore_index??this.config.audio_token_id,...X,audio_features:qe})}}class $a extends Xf{}class Qf extends fe{main_input_name="input_values";forward_params=["input_values"]}class Kp extends $e{constructor({audio_codes:X}){super(),this.audio_codes=X}}class Xw extends $e{constructor({audio_values:X}){super(),this.audio_values=X}}class nu extends Qf{async encode(X){return new Kp(await P(this.sessions.encoder_model,X))}async decode(X){return new Xw(await P(this.sessions.decoder_model,X))}}class ag extends Qf{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"encoder_model"})}}class _0 extends Qf{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"decoder_model"})}}class Nl extends fe{main_input_name="input_values";forward_params=["input_values"]}class Qw extends $e{constructor({audio_codes:X}){super(),this.audio_codes=X}}class ty extends $e{constructor({audio_values:X}){super(),this.audio_values=X}}class rC extends Nl{async encode(X){return new Qw(await P(this.sessions.encoder_model,X))}async decode(X){return new ty(await P(this.sessions.decoder_model,X))}}class ny extends Nl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"encoder_model"})}}class sy extends Nl{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"decoder_model"})}}class Jf extends fe{main_input_name="input_values";forward_params=["input_values"]}class Io extends Jf{async encode(X){return await P(this.sessions.encoder_model,X)}async decode(X){return await P(this.sessions.decoder_model,X)}}class Rh extends Jf{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"encoder_model"})}}class og extends Jf{static async from_pretrained(X,Ee={}){return super.from_pretrained(X,{...Ee,model_file_name:Ee.model_file_name??"decoder_model"})}}class rr{static MODEL_CLASS_MAPPINGS=null;static BASE_IF_FAIL=!1;static async from_pretrained(X,{progress_callback:Ee=null,config:qe=null,cache_dir:vt=null,local_files_only:yt=!1,revision:Vt="main",model_file_name:on=null,subfolder:gn="onnx",device:Ln=null,dtype:Is=null,use_external_data_format:Ms=null,session_options:Ps={}}={}){const ss={progress_callback:Ee,config:qe,cache_dir:vt,local_files_only:yt,revision:Vt,model_file_name:on,subfolder:gn,device:Ln,dtype:Is,use_external_data_format:Ms,session_options:Ps};if(ss.config=await s.AutoConfig.from_pretrained(X,ss),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const vr=ss.config.model_type;for(const rs of this.MODEL_CLASS_MAPPINGS){let is=rs.get(vr);if(!is){for(const cr of rs.values())if(cr[0]===vr){is=cr;break}if(!is)continue}return await is[1].from_pretrained(X,ss)}if(this.BASE_IF_FAIL)return tv.has(vr)||console.warn(`Unknown model class "${vr}", attempting to construct from base class.`),await fe.from_pretrained(X,ss);throw Error(`Unsupported model type: ${vr}`)}}const iC=new Map([["bert",["BertModel",Be]],["neobert",["NeoBertModel",xt]],["modernbert",["ModernBertModel",At]],["nomic_bert",["NomicBertModel",Nn]],["roformer",["RoFormerModel",gr]],["electra",["ElectraModel",fs]],["esm",["EsmModel",Gc]],["convbert",["ConvBertModel",Mt]],["camembert",["CamembertModel",ze]],["deberta",["DebertaModel",Gn]],["deberta-v2",["DebertaV2Model",Cr]],["mpnet",["MPNetModel",xi]],["albert",["AlbertModel",wn]],["distilbert",["DistilBertModel",oi]],["roberta",["RobertaModel",Tu]],["xlm",["XLMModel",Yc]],["xlm-roberta",["XLMRobertaModel",Fe]],["clap",["ClapModel",Wd]],["clip",["CLIPModel",zo]],["clipseg",["CLIPSegModel",Ql]],["chinese_clip",["ChineseCLIPModel",kc]],["siglip",["SiglipModel",vo]],["jina_clip",["JinaCLIPModel",Jc]],["mobilebert",["MobileBertModel",Ga]],["squeezebert",["SqueezeBertModel",Ne]],["wav2vec2",["Wav2Vec2Model",Tx]],["wav2vec2-bert",["Wav2Vec2BertModel",$x]],["unispeech",["UniSpeechModel",ao]],["unispeech-sat",["UniSpeechSatModel",Dx]],["hubert",["HubertModel",Rx]],["wavlm",["WavLMModel",Dw]],["audio-spectrogram-transformer",["ASTModel",qn]],["vits",["VitsModel",Eo]],["pyannote",["PyAnnoteModel",Nw]],["wespeaker-resnet",["WeSpeakerResNetModel",TE]],["detr",["DetrModel",qa]],["rt_detr",["RTDetrModel",Pa]],["rt_detr_v2",["RTDetrV2Model",la]],["rf_detr",["RFDetrModel",Al]],["d_fine",["DFineModel",Wf]],["table-transformer",["TableTransformerModel",ki]],["vit",["ViTModel",xe]],["ijepa",["IJepaModel",Re]],["pvt",["PvtModel",gt]],["vit_msn",["ViTMSNModel",dn]],["vit_mae",["ViTMAEModel",zt]],["groupvit",["GroupViTModel",jn]],["fastvit",["FastViTModel",Wn]],["mobilevit",["MobileViTModel",Sn]],["mobilevitv2",["MobileViTV2Model",Vs]],["owlvit",["OwlViTModel",To]],["owlv2",["Owlv2Model",Vo]],["beit",["BeitModel",Or]],["deit",["DeiTModel",uf]],["hiera",["HieraModel",i0]],["convnext",["ConvNextModel",cx]],["convnextv2",["ConvNextV2Model",fx]],["dinov2",["Dinov2Model",hx]],["dinov2_with_registers",["Dinov2WithRegistersModel",mx]],["dinov3_vit",["DINOv3ViTModel",yx]],["dinov3_convnext",["DINOv3ConvNextModel",CE]],["resnet",["ResNetModel",ca]],["swin",["SwinModel",Lh]],["swin2sr",["Swin2SRModel",Nh]],["donut-swin",["DonutSwinModel",Dh]],["yolos",["YolosModel",Mw]],["dpt",["DPTModel",ff]],["glpn",["GLPNModel",Zm]],["hifigan",["SpeechT5HifiGan",IE]],["efficientnet",["EfficientNetModel",Jx]],["decision_transformer",["DecisionTransformerModel",ey]],["patchtst",["PatchTSTForPrediction",br]],["patchtsmixer",["PatchTSMixerForPrediction",jh]],["mobilenet_v1",["MobileNetV1Model",Zx]],["mobilenet_v2",["MobileNetV2Model",qw]],["mobilenet_v3",["MobileNetV3Model",rg]],["mobilenet_v4",["MobileNetV4Model",eC]],["maskformer",["MaskFormerModel",df]],["mgp-str",["MgpstrForSceneTextRecognition",$i]],["style_text_to_speech_2",["StyleTextToSpeech2Model",Ux]]]),aC=new Map([["t5",["T5Model",ds]],["longt5",["LongT5Model",Sr]],["mt5",["MT5Model",wo]],["bart",["BartModel",Si]],["mbart",["MBartModel",io]],["marian",["MarianModel",Mx]],["whisper",["WhisperModel",pr]],["m2m_100",["M2M100Model",Iw]],["blenderbot",["BlenderbotModel",Gr]],["blenderbot-small",["BlenderbotSmallModel",Oi]]]),PE=new Map([["mimi",["MimiModel",nu]],["dac",["DacModel",rC]],["snac",["SnacModel",Io]]]),ry=new Map([["bloom",["BloomModel",Pp]],["jais",["JAISModel",Ec]],["gpt2",["GPT2Model",Eu]],["gptj",["GPTJModel",F]],["gpt_bigcode",["GPTBigCodeModel",be]],["gpt_neo",["GPTNeoModel",_o]],["gpt_neox",["GPTNeoXModel",ul]],["codegen",["CodeGenModel",$t]],["llama",["LlamaModel",Rn]],["nanochat",["NanoChatModel",Lc]],["arcee",["ArceeModel",Bm]],["lfm2",["Lfm2Model",Um]],["smollm3",["SmolLM3Model",Bo]],["exaone",["ExaoneModel",Lp]],["olmo",["OlmoModel",jd]],["olmo2",["Olmo2Model",Dc]],["mobilellm",["MobileLLMModel",Gm]],["granite",["GraniteModel",Pc]],["granitemoehybrid",["GraniteMoeHybridModel",$1]],["cohere",["CohereModel",j1]],["gemma",["GemmaModel",mr]],["gemma2",["Gemma2Model",Zc]],["vaultgemma",["VaultGemmaModel",lf]],["gemma3_text",["Gemma3Model",n0]],["helium",["HeliumModel",Uo]],["glm",["GlmModel",Ap]],["openelm",["OpenELMModel",zf]],["qwen2",["Qwen2Model",jc]],["qwen3",["Qwen3Model",Uf]],["phi",["PhiModel",R1]],["phi3",["Phi3Model",bw]],["mpt",["MptModel",N]],["opt",["OPTModel",ie]],["mistral",["MistralModel",m0]],["ministral",["MinistralModel",AE]],["ministral3",["Ministral3Model",Ph]],["ernie4_5",["Ernie4_5Model",g0]],["starcoder2",["Starcoder2Model",Bw]],["falcon",["FalconModel",Uw]],["stablelm",["StableLmModel",Gd]],["modernbert-decoder",["ModernBertDecoderModel",yn]]]),iy=new Map([["speecht5",["SpeechT5ForSpeechToText",Vd]],["whisper",["WhisperForConditionalGeneration",gi]],["lite-whisper",["LiteWhisperForConditionalGeneration",Ki]],["moonshine",["MoonshineForConditionalGeneration",zi]]]),su=new Map([["speecht5",["SpeechT5ForTextToSpeech",jw]]]),oC=new Map([["vits",["VitsModel",Eo]],["musicgen",["MusicgenForConditionalGeneration",Hw]],["supertonic",["SupertonicForConditionalGeneration",qf]]]),zc=new Map([["bert",["BertForSequenceClassification",He]],["neobert",["NeoBertForSequenceClassification",Ft]],["modernbert",["ModernBertForSequenceClassification",Qt]],["roformer",["RoFormerForSequenceClassification",ps]],["electra",["ElectraForSequenceClassification",re]],["esm",["EsmForSequenceClassification",bo]],["convbert",["ConvBertForSequenceClassification",Tn]],["camembert",["CamembertForSequenceClassification",Et]],["deberta",["DebertaForSequenceClassification",vs]],["deberta-v2",["DebertaV2ForSequenceClassification",sl]],["mpnet",["MPNetForSequenceClassification",Gl]],["albert",["AlbertForSequenceClassification",bn]],["distilbert",["DistilBertForSequenceClassification",wa]],["roberta",["RobertaForSequenceClassification",qc]],["xlm",["XLMForSequenceClassification",Kc]],["xlm-roberta",["XLMRobertaForSequenceClassification",pt]],["bart",["BartForSequenceClassification",mi]],["mbart",["MBartForSequenceClassification",Yi]],["mobilebert",["MobileBertForSequenceClassification",cn]],["squeezebert",["SqueezeBertForSequenceClassification",Ve]]]),lC=new Map([["bert",["BertForTokenClassification",Xe]],["neobert",["NeoBertForTokenClassification",It]],["modernbert",["ModernBertForTokenClassification",Xt]],["roformer",["RoFormerForTokenClassification",Ss]],["electra",["ElectraForTokenClassification",Pe]],["esm",["EsmForTokenClassification",Wa]],["convbert",["ConvBertForTokenClassification",ai]],["camembert",["CamembertForTokenClassification",rn]],["deberta",["DebertaForTokenClassification",_s]],["deberta-v2",["DebertaV2ForTokenClassification",Ni]],["mpnet",["MPNetForTokenClassification",Of]],["distilbert",["DistilBertForTokenClassification",li]],["roberta",["RobertaForTokenClassification",ef]],["xlm",["XLMForTokenClassification",Sh]],["xlm-roberta",["XLMRobertaForTokenClassification",Ht]]]),Jw=new Map([["t5",["T5ForConditionalGeneration",Ar]],["longt5",["LongT5ForConditionalGeneration",An]],["mt5",["MT5ForConditionalGeneration",Ml]],["bart",["BartForConditionalGeneration",Qr]],["mbart",["MBartForConditionalGeneration",Ha]],["marian",["MarianMTModel",kw]],["m2m_100",["M2M100ForConditionalGeneration",Aw]],["blenderbot",["BlenderbotForConditionalGeneration",Qs]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",il]]]),cC=new Map([["bloom",["BloomForCausalLM",$p]],["gpt2",["GPT2LMHeadModel",sf]],["jais",["JAISLMHeadModel",cl]],["gptj",["GPTJForCausalLM",ee]],["gpt_bigcode",["GPTBigCodeForCausalLM",Le]],["gpt_neo",["GPTNeoForCausalLM",Ac]],["gpt_neox",["GPTNeoXForCausalLM",yr]],["codegen",["CodeGenForCausalLM",an]],["llama",["LlamaForCausalLM",Es]],["nanochat",["NanoChatForCausalLM",fl]],["llama4_text",["Llama4ForCausalLM",sr]],["arcee",["ArceeForCausalLM",Ep]],["lfm2",["Lfm2ForCausalLM",rf]],["smollm3",["SmolLM3ForCausalLM",xo]],["exaone",["ExaoneForCausalLM",Wm]],["olmo",["OlmoForCausalLM",Hm]],["olmo2",["Olmo2ForCausalLM",Oc]],["mobilellm",["MobileLLMForCausalLM",Nc]],["granite",["GraniteForCausalLM",$c]],["granitemoehybrid",["GraniteMoeHybridForCausalLM",t0]],["cohere",["CohereForCausalLM",Co]],["gemma",["GemmaForCausalLM",dl]],["gemma2",["Gemma2ForCausalLM",Rf]],["vaultgemma",["VaultGemmaForCausalLM",So]],["gemma3_text",["Gemma3ForCausalLM",Ih]],["helium",["HeliumForCausalLM",Vm]],["glm",["GlmForCausalLM",kh]],["openelm",["OpenELMForCausalLM",Iu]],["qwen2",["Qwen2ForCausalLM",Ah]],["qwen3",["Qwen3ForCausalLM",Ym]],["phi",["PhiForCausalLM",yw]],["phi3",["Phi3ForCausalLM",xa]],["mpt",["MptForCausalLM",$]],["opt",["OPTForCausalLM",ye]],["mbart",["MBartForCausalLM",aa]],["mistral",["MistralForCausalLM",ta]],["ministral",["MinistralForCausalLM",Hx]],["ministral3",["Ministral3ForCausalLM",qx]],["ernie4_5",["Ernie4_5ForCausalLM",Yf]],["starcoder2",["Starcoder2ForCausalLM",Yx]],["falcon",["FalconForCausalLM",Q1]],["trocr",["TrOCRForCausalLM",Wx]],["stablelm",["StableLmForCausalLM",Qx]],["modernbert-decoder",["ModernBertDecoderForCausalLM",En]],["phi3_v",["Phi3VForCausalLM",ku]]]),Xp=new Map([["multi_modality",["MultiModalityCausalLM",DE]]]),ay=new Map([["bert",["BertForMaskedLM",st]],["neobert",["NeoBertForMaskedLM",dt]],["modernbert",["ModernBertForMaskedLM",ht]],["roformer",["RoFormerForMaskedLM",os]],["electra",["ElectraForMaskedLM",ro]],["esm",["EsmForMaskedLM",va]],["convbert",["ConvBertForMaskedLM",sn]],["camembert",["CamembertForMaskedLM",ut]],["deberta",["DebertaForMaskedLM",hn]],["deberta-v2",["DebertaV2ForMaskedLM",Kr]],["mpnet",["MPNetForMaskedLM",ci]],["albert",["AlbertForMaskedLM",mn]],["distilbert",["DistilBertForMaskedLM",yo]],["roberta",["RobertaForMaskedLM",Hc]],["xlm",["XLMWithLMHeadModel",Ch]],["xlm-roberta",["XLMRobertaForMaskedLM",Je]],["mobilebert",["MobileBertForMaskedLM",Zt]],["squeezebert",["SqueezeBertForMaskedLM",Ue]]]),Zw=new Map([["bert",["BertForQuestionAnswering",Ke]],["neobert",["NeoBertForQuestionAnswering",Bt]],["roformer",["RoFormerForQuestionAnswering",Qn]],["electra",["ElectraForQuestionAnswering",ve]],["convbert",["ConvBertForQuestionAnswering",ir]],["camembert",["CamembertForQuestionAnswering",xn]],["deberta",["DebertaForQuestionAnswering",Vr]],["deberta-v2",["DebertaV2ForQuestionAnswering",Xr]],["mpnet",["MPNetForQuestionAnswering",ft]],["albert",["AlbertForQuestionAnswering",_n]],["distilbert",["DistilBertForQuestionAnswering",pi]],["roberta",["RobertaForQuestionAnswering",Nd]],["xlm",["XLMForQuestionAnswering",Y]],["xlm-roberta",["XLMRobertaForQuestionAnswering",nn]],["mobilebert",["MobileBertForQuestionAnswering",In]],["squeezebert",["SqueezeBertForQuestionAnswering",Ct]]]),Qp=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",_a]],["idefics3",["Idefics3ForConditionalGeneration",El]],["smolvlm",["SmolVLMForConditionalGeneration",Ia]]]),uC=new Map([["llava",["LlavaForConditionalGeneration",ol]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",Xc]],["moondream1",["Moondream1ForConditionalGeneration",Dd]],["florence2",["Florence2ForConditionalGeneration",_c]],["qwen2-vl",["Qwen2VLForConditionalGeneration",Mo]],["idefics3",["Idefics3ForConditionalGeneration",El]],["smolvlm",["SmolVLMForConditionalGeneration",Ia]],["paligemma",["PaliGemmaForConditionalGeneration",tf]],["llava_qwen2",["LlavaQwen2ForCausalLM",xc]],["gemma3n",["Gemma3nForConditionalGeneration",Cc]],["mistral3",["Mistral3ForConditionalGeneration",Xi]]]),fC=new Map([["ultravox",["UltravoxModel",Xf]],["voxtral",["VoxtralForConditionalGeneration",$a]]]),$E=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",_a]]]),dC=new Map([["vit",["ViTForImageClassification",Ae]],["ijepa",["IJepaForImageClassification",tt]],["pvt",["PvtForImageClassification",Ut]],["vit_msn",["ViTMSNForImageClassification",en]],["fastvit",["FastViTForImageClassification",ar]],["mobilevit",["MobileViTForImageClassification",Ji]],["mobilevitv2",["MobileViTV2ForImageClassification",Zr]],["beit",["BeitForImageClassification",Zi]],["deit",["DeiTForImageClassification",ww]],["hiera",["HieraForImageClassification",Xm]],["convnext",["ConvNextForImageClassification",vw]],["convnextv2",["ConvNextV2ForImageClassification",dx]],["dinov2",["Dinov2ForImageClassification",px]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",gx]],["resnet",["ResNetForImageClassification",zp]],["swin",["SwinForImageClassification",Fd]],["segformer",["SegformerForImageClassification",Xx]],["efficientnet",["EfficientNetForImageClassification",NE]],["mobilenet_v1",["MobileNetV1ForImageClassification",Hd]],["mobilenet_v2",["MobileNetV2ForImageClassification",Yw]],["mobilenet_v3",["MobileNetV3ForImageClassification",b0]],["mobilenet_v4",["MobileNetV4ForImageClassification",tC]]]),oy=new Map([["detr",["DetrForObjectDetection",ea]],["rt_detr",["RTDetrForObjectDetection",yi]],["rt_detr_v2",["RTDetrV2ForObjectDetection",ms]],["rf_detr",["RFDetrForObjectDetection",Rc]],["d_fine",["DFineForObjectDetection",Gf]],["table-transformer",["TableTransformerForObjectDetection",s0]],["yolos",["YolosForObjectDetection",vx]]]),ev=new Map([["owlvit",["OwlViTForObjectDetection",Ti]],["owlv2",["Owlv2ForObjectDetection",Oa]],["grounding-dino",["GroundingDinoForObjectDetection",wx]]]),x0=new Map([["detr",["DetrForSegmentation",Tr]],["clipseg",["CLIPSegForImageSegmentation",La]]]),jE=new Map([["segformer",["SegformerForSemanticSegmentation",ua]],["sapiens",["SapiensForSemanticSegmentation",Hf]],["swin",["SwinForSemanticSegmentation",Lu]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",Yp]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",mf]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",w0]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",v0]]]),RE=new Map([["detr",["DetrForSegmentation",Tr]],["maskformer",["MaskFormerForInstanceSegmentation",hf]]]),hC=new Map([["sam",["SamModel",ME]],["sam2",["Sam2Model",eg]],["edgetam",["EdgeTamModel",Cx]],["sam3_tracker",["Sam3TrackerModel",Sx]]]),pC=new Map([["wav2vec2",["Wav2Vec2ForCTC",Hp]],["wav2vec2-bert",["Wav2Vec2BertForCTC",kE]],["unispeech",["UniSpeechForCTC",pl]],["unispeech-sat",["UniSpeechSatForCTC",Ox]],["wavlm",["WavLMForCTC",Ow]],["hubert",["HubertForCTC",Fx]],["parakeet_ctc",["ParakeetForCTC",q1]]]),lg=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",kx]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",Y1]],["unispeech",["UniSpeechForSequenceClassification",Nx]],["unispeech-sat",["UniSpeechSatForSequenceClassification",d0]],["wavlm",["WavLMForSequenceClassification",Bx]],["hubert",["HubertForSequenceClassification",zx]],["audio-spectrogram-transformer",["ASTForAudioClassification",xs]]]),ly=new Map([["wavlm",["WavLMForXVector",Pw]]]),mC=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",Px]],["wavlm",["WavLMForAudioFrameClassification",K1]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",Ex]],["pyannote",["PyAnnoteForAudioFrameClassification",Ax]]]),gC=new Map([["vitmatte",["VitMatteForImageMatting",Fs]]]),FE=new Map([["patchtst",["PatchTSTForPrediction",bi]],["patchtsmixer",["PatchTSMixerForPrediction",ig]]]),yC=new Map([["swin2sr",["Swin2SRForImageSuperResolution",Qm]]]),bC=new Map([["dpt",["DPTForDepthEstimation",a0]],["depth_anything",["DepthAnythingForDepthEstimation",z1]],["glpn",["GLPNForDepthEstimation",Bd]],["sapiens",["SapiensForDepthEstimation",B1]],["depth_pro",["DepthProForDepthEstimation",l0]],["metric3d",["Metric3DForDepthEstimation",zd]],["metric3dv2",["Metric3Dv2ForDepthEstimation",Wp]]]),wC=new Map([["sapiens",["SapiensForNormalEstimation",U1]]]),cy=new Map([["vitpose",["VitPoseForPoseEstimation",je]]]),vC=new Map([["clip",["CLIPVisionModelWithProjection",Xl]],["siglip",["SiglipVisionModel",Pn]],["jina_clip",["JinaCLIPVisionModel",nf]]]),_C=[[iC,C.EncoderOnly],[aC,C.EncoderDecoder],[ry,C.DecoderOnly],[PE,C.AutoEncoder],[zc,C.EncoderOnly],[lC,C.EncoderOnly],[Jw,C.Seq2Seq],[iy,C.Seq2Seq],[cC,C.DecoderOnly],[Xp,C.MultiModality],[ay,C.EncoderOnly],[Zw,C.EncoderOnly],[Qp,C.Vision2Seq],[uC,C.ImageTextToText],[fC,C.AudioTextToText],[dC,C.EncoderOnly],[x0,C.EncoderOnly],[RE,C.EncoderOnly],[jE,C.EncoderOnly],[gC,C.EncoderOnly],[FE,C.EncoderOnly],[yC,C.EncoderOnly],[bC,C.EncoderOnly],[wC,C.EncoderOnly],[cy,C.EncoderOnly],[oy,C.EncoderOnly],[ev,C.EncoderOnly],[hC,C.MaskGeneration],[pC,C.EncoderOnly],[lg,C.EncoderOnly],[su,C.Seq2Seq],[oC,C.EncoderOnly],[ly,C.EncoderOnly],[mC,C.EncoderOnly],[vC,C.EncoderOnly]];for(const[K,X]of _C)for(const[Ee,qe]of K.values())M.set(Ee,X),E.set(qe,Ee),k.set(Ee,qe);const Ei=[["MusicgenForConditionalGeneration",Hw,C.Musicgen],["Phi3VForCausalLM",ku,C.Phi3V],["CLIPTextModelWithProjection",Sc,C.EncoderOnly],["SiglipTextModel",Aa,C.EncoderOnly],["JinaCLIPTextModel",Dr,C.EncoderOnly],["ClapTextModelWithProjection",oo,C.EncoderOnly],["ClapAudioModelWithProjection",Vw,C.EncoderOnly],["DacEncoderModel",ny,C.EncoderOnly],["DacDecoderModel",sy,C.EncoderOnly],["MimiEncoderModel",ag,C.EncoderOnly],["MimiDecoderModel",_0,C.EncoderOnly],["SnacEncoderModel",Rh,C.EncoderOnly],["SnacDecoderModel",og,C.EncoderOnly],["Gemma3nForConditionalGeneration",Cc,C.ImageAudioTextToText],["SupertonicForConditionalGeneration",qf,C.Supertonic]];for(const[K,X,Ee]of Ei)M.set(K,Ee),E.set(X,K),k.set(K,X);const tv=new Map([["modnet",x0],["birefnet",x0],["isnet",x0],["ben",x0]]);for(const[K,X]of tv.entries())X.set(K,["PreTrainedModel",fe]),M.set(K,C.EncoderOnly),E.set(fe,K),k.set(K,fe);class NP extends rr{static MODEL_CLASS_MAPPINGS=_C.map(X=>X[0]);static BASE_IF_FAIL=!0}class zE extends rr{static MODEL_CLASS_MAPPINGS=[zc]}class DP extends rr{static MODEL_CLASS_MAPPINGS=[lC]}class OP extends rr{static MODEL_CLASS_MAPPINGS=[Jw]}class PP extends rr{static MODEL_CLASS_MAPPINGS=[iy]}class nv extends rr{static MODEL_CLASS_MAPPINGS=[su]}class C0 extends rr{static MODEL_CLASS_MAPPINGS=[oC]}class xC extends rr{static MODEL_CLASS_MAPPINGS=[cC]}class sv extends rr{static MODEL_CLASS_MAPPINGS=[ay]}class CC extends rr{static MODEL_CLASS_MAPPINGS=[Zw]}class Jp extends rr{static MODEL_CLASS_MAPPINGS=[Qp]}class qd extends rr{static MODEL_CLASS_MAPPINGS=[dC]}class uy extends rr{static MODEL_CLASS_MAPPINGS=[x0]}class $P extends rr{static MODEL_CLASS_MAPPINGS=[jE]}class BE extends rr{static MODEL_CLASS_MAPPINGS=[RE]}class UE extends rr{static MODEL_CLASS_MAPPINGS=[oy]}class VE extends rr{static MODEL_CLASS_MAPPINGS=[ev]}class WE extends rr{static MODEL_CLASS_MAPPINGS=[hC]}class jP extends rr{static MODEL_CLASS_MAPPINGS=[pC]}class SC extends rr{static MODEL_CLASS_MAPPINGS=[lg]}class GE extends rr{static MODEL_CLASS_MAPPINGS=[ly]}class HE extends rr{static MODEL_CLASS_MAPPINGS=[mC]}class RP extends rr{static MODEL_CLASS_MAPPINGS=[$E]}class MC extends rr{static MODEL_CLASS_MAPPINGS=[gC]}class TC extends rr{static MODEL_CLASS_MAPPINGS=[yC]}class FP extends rr{static MODEL_CLASS_MAPPINGS=[bC]}class zP extends rr{static MODEL_CLASS_MAPPINGS=[wC]}class fy extends rr{static MODEL_CLASS_MAPPINGS=[cy]}class BP extends rr{static MODEL_CLASS_MAPPINGS=[vC]}class qE extends rr{static MODEL_CLASS_MAPPINGS=[uC]}class wr extends rr{static MODEL_CLASS_MAPPINGS=[fC]}class kC extends $e{constructor({logits:X,past_key_values:Ee,encoder_outputs:qe,decoder_attentions:vt=null,cross_attentions:yt=null}){super(),this.logits=X,this.past_key_values=Ee,this.encoder_outputs=qe,this.decoder_attentions=vt,this.cross_attentions=yt}}class Ls extends $e{constructor({logits:X,...Ee}){super(),this.logits=X;const qe=Object.values(Ee);qe.length>0&&(this.attentions=qe)}}class rv extends $e{constructor({logits:X,embeddings:Ee}){super(),this.logits=X,this.embeddings=Ee}}class lo extends $e{constructor({logits:X}){super(),this.logits=X}}class co extends $e{constructor({logits:X}){super(),this.logits=X}}class uo extends $e{constructor({start_logits:X,end_logits:Ee}){super(),this.start_logits=X,this.end_logits=Ee}}class Zf extends $e{constructor({logits:X}){super(),this.logits=X}}class UP extends $e{constructor({logits:X,past_key_values:Ee}){super(),this.logits=X,this.past_key_values=Ee}}class EC extends $e{constructor({alphas:X}){super(),this.alphas=X}}class YE extends $e{constructor({waveform:X,spectrogram:Ee}){super(),this.waveform=X,this.spectrogram=Ee}}}),"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":((n,e,t)=>{t.r(e),t.d(e,{ASTFeatureExtractor:()=>a});var s=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var r=t("./src/utils/audio.js");class a extends s.FeatureExtractor{constructor(l){super(l);const c=this.config.sampling_rate,u=(0,r.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(c/2),c,null,"kaldi",!0);this.mel_filters=u,this.window=(0,r.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(l,c){return(0,r.spectrogram)(l,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:c,transpose:!0})}async _call(l){(0,s.validate_audio_inputs)(l,"ASTFeatureExtractor");const c=await this._extract_fbank_features(l,this.config.max_length);if(this.config.do_normalize){const u=this.std*2,f=c.data;for(let d=0;d<f.length;++d)f[d]=(f[d]-this.mean)/u}return{input_values:c.unsqueeze_(0)}}}}),"./src/models/auto/feature_extraction_auto.js":((n,e,t)=>{t.r(e),t.d(e,{AutoFeatureExtractor:()=>o});var s=t("./src/utils/constants.js"),r=t("./src/utils/hub.js");t("./src/base/feature_extraction_utils.js");var a=t("./src/models/feature_extractors.js");class o{static async from_pretrained(c,u={}){const f=await(0,r.getModelJSON)(c,s.FEATURE_EXTRACTOR_NAME,!0,u),d=f.feature_extractor_type,h=a[d];if(!h)throw new Error(`Unknown feature_extractor_type: '${d}'. Please report this at ${s.GITHUB_ISSUE_URL}.`);return new h(f)}}}),"./src/models/auto/image_processing_auto.js":((n,e,t)=>{t.r(e),t.d(e,{AutoImageProcessor:()=>l});var s=t("./src/utils/constants.js"),r=t("./src/utils/hub.js"),a=t("./src/base/image_processors_utils.js"),o=t("./src/models/image_processors.js");class l{static async from_pretrained(u,f={}){const d=await(0,r.getModelJSON)(u,s.IMAGE_PROCESSOR_NAME,!0,f),h=d.image_processor_type??d.feature_extractor_type;let p=o[h?.replace(/Fast$/,"")];return p||(h!==void 0&&console.warn(`Image processor type '${h}' not found, assuming base ImageProcessor. Please report this at ${s.GITHUB_ISSUE_URL}.`),p=a.ImageProcessor),new p(d)}}}),"./src/models/auto/processing_auto.js":((n,e,t)=>{t.r(e),t.d(e,{AutoProcessor:()=>u});var s=t("./src/utils/constants.js"),r=t("./src/utils/hub.js"),a=t("./src/base/processing_utils.js"),o=t("./src/models/processors.js"),l=t("./src/models/image_processors.js"),c=t("./src/models/feature_extractors.js");class u{static async from_pretrained(d,h={}){const p=await(0,r.getModelJSON)(d,s.IMAGE_PROCESSOR_NAME,!0,h),{image_processor_type:g,feature_extractor_type:b,processor_class:v}=p;if(v&&o[v])return o[v].from_pretrained(d,h);if(!g&&!b)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const w={};if(g){const S=l[g.replace(/Fast$/,"")];if(!S)throw new Error(`Unknown image_processor_type: '${g}'.`);w.image_processor=new S(p)}if(b){const S=l[b];if(S)w.image_processor=new S(p);else{const C=c[b];if(!C)throw new Error(`Unknown feature_extractor_type: '${b}'.`);w.feature_extractor=new C(p)}}const x={};return new a.Processor(x,w,null)}}}),"./src/models/beit/image_processing_beit.js":((n,e,t)=>{t.r(e),t.d(e,{BeitFeatureExtractor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/bit/image_processing_bit.js":((n,e,t)=>{t.r(e),t.d(e,{BitImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/chinese_clip/image_processing_chinese_clip.js":((n,e,t)=>{t.r(e),t.d(e,{ChineseCLIPFeatureExtractor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/clap/feature_extraction_clap.js":((n,e,t)=>{t.r(e),t.d(e,{ClapFeatureExtractor:()=>a});var s=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var r=t("./src/utils/audio.js");class a extends s.FeatureExtractor{constructor(l){super(l),this.mel_filters=(0,r.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,r.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,r.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(l,c,u,f){let d;const h=l.length-c;if(h>0)if(u==="rand_trunc"){const p=Math.floor(Math.random()*(h+1));l=l.subarray(p,p+c),d=await this._extract_fbank_features(l,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${u}" not implemented`);else{if(h<0){let p=new Float64Array(c);if(p.set(l),f==="repeat")for(let g=l.length;g<c;g+=l.length)p.set(l.subarray(0,Math.min(l.length,c-g)),g);else if(f==="repeatpad")for(let g=l.length;g<-h;g+=l.length)p.set(l,g);l=p}if(u==="fusion")throw new Error(`Truncation strategy "${u}" not implemented`);d=await this._extract_fbank_features(l,this.mel_filters_slaney,this.config.nb_max_samples)}return d.unsqueeze_(0)}async _extract_fbank_features(l,c,u=null){return(0,r.spectrogram)(l,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:c,log_mel:"dB",max_num_frames:u,do_pad:!1,transpose:!0})}async _call(l,{max_length:c=null}={}){return(0,s.validate_audio_inputs)(l,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(l,c??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}}),"./src/models/clip/image_processing_clip.js":((n,e,t)=>{t.r(e),t.d(e,{CLIPFeatureExtractor:()=>a,CLIPImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/convnext/image_processing_convnext.js":((n,e,t)=>{t.r(e),t.d(e,{ConvNextFeatureExtractor:()=>a,ConvNextImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{constructor(l){super(l),this.crop_pct=this.config.crop_pct??224/256}async resize(l){const c=this.size?.shortest_edge;if(c===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(c<384){const u=Math.floor(c/this.crop_pct),[f,d]=this.get_resize_output_image_size(l,{shortest_edge:u});l=await l.resize(f,d,{resample:this.resample}),l=await l.center_crop(c,c)}else l=await l.resize(c,c,{resample:this.resample});return l}}class a extends r{}}),"./src/models/dac/feature_extraction_dac.js":((n,e,t)=>{t.r(e),t.d(e,{DacFeatureExtractor:()=>r});var s=t("./src/models/encodec/feature_extraction_encodec.js");class r extends s.EncodecFeatureExtractor{}}),"./src/models/deit/image_processing_deit.js":((n,e,t)=>{t.r(e),t.d(e,{DeiTFeatureExtractor:()=>a,DeiTImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/detr/image_processing_detr.js":((n,e,t)=>{t.r(e),t.d(e,{DetrFeatureExtractor:()=>o,DetrImageProcessor:()=>a});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(c){const u=await super._call(c),f=[u.pixel_values.dims[0],64,64],d=(0,r.full)(f,1n);return{...u,pixel_mask:d}}post_process_object_detection(...c){return(0,s.post_process_object_detection)(...c)}post_process_panoptic_segmentation(...c){return(0,s.post_process_panoptic_segmentation)(...c)}post_process_instance_segmentation(...c){return(0,s.post_process_instance_segmentation)(...c)}}class o extends a{}}),"./src/models/dinov3_vit/image_processing_dinov3_vit.js":((n,e,t)=>{t.r(e),t.d(e,{DINOv3ViTImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/donut/image_processing_donut.js":((n,e,t)=>{t.r(e),t.d(e,{DonutFeatureExtractor:()=>a,DonutImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{pad_image(l,c,u,f={}){const[d,h,p]=c;let g=this.image_mean;Array.isArray(this.image_mean)||(g=new Array(p).fill(g));let b=this.image_std;Array.isArray(b)||(b=new Array(p).fill(g));const v=g.map((w,x)=>-w/b[x]);return super.pad_image(l,c,u,{center:!0,constant_values:v,...f})}}class a extends r{}}),"./src/models/dpt/image_processing_dpt.js":((n,e,t)=>{t.r(e),t.d(e,{DPTFeatureExtractor:()=>a,DPTImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/efficientnet/image_processing_efficientnet.js":((n,e,t)=>{t.r(e),t.d(e,{EfficientNetImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{constructor(o){super(o),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(l=>l*l))}}}),"./src/models/encodec/feature_extraction_encodec.js":((n,e,t)=>{t.r(e),t.d(e,{EncodecFeatureExtractor:()=>a});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js");class a extends s.FeatureExtractor{async _call(l){(0,s.validate_audio_inputs)(l,"EncodecFeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));const c=this.config.feature_size;if(l.length%c!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${c}).`);const u=[1,c,l.length/c];return{input_values:new r.Tensor("float32",l,u)}}}}),"./src/models/feature_extractors.js":((n,e,t)=>{t.r(e),t.d(e,{ASTFeatureExtractor:()=>s.ASTFeatureExtractor,ClapFeatureExtractor:()=>a.ClapFeatureExtractor,DacFeatureExtractor:()=>o.DacFeatureExtractor,EncodecFeatureExtractor:()=>r.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>l.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>w.ImageProcessor,MoonshineFeatureExtractor:()=>c.MoonshineFeatureExtractor,ParakeetFeatureExtractor:()=>u.ParakeetFeatureExtractor,PyAnnoteFeatureExtractor:()=>f.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>d.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>h.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>p.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>g.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>b.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>v.WhisperFeatureExtractor});var s=t("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),r=t("./src/models/encodec/feature_extraction_encodec.js"),a=t("./src/models/clap/feature_extraction_clap.js"),o=t("./src/models/dac/feature_extraction_dac.js"),l=t("./src/models/gemma3n/feature_extraction_gemma3n.js"),c=t("./src/models/moonshine/feature_extraction_moonshine.js"),u=t("./src/models/parakeet/feature_extraction_parakeet.js"),f=t("./src/models/pyannote/feature_extraction_pyannote.js"),d=t("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),h=t("./src/models/snac/feature_extraction_snac.js"),p=t("./src/models/speecht5/feature_extraction_speecht5.js"),g=t("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),b=t("./src/models/wespeaker/feature_extraction_wespeaker.js"),v=t("./src/models/whisper/feature_extraction_whisper.js"),w=t("./src/base/image_processors_utils.js")}),"./src/models/florence2/processing_florence2.js":((n,e,t)=>{t.r(e),t.d(e,{Florence2Processor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");class o extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;constructor(c,u,f){super(c,u,f);const{tasks_answer_post_processing_type:d,task_prompts_without_inputs:h,task_prompts_with_input:p}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(d??{})),this.task_prompts_without_inputs=new Map(Object.entries(h??{})),this.task_prompts_with_input=new Map(Object.entries(p??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(c){typeof c=="string"&&(c=[c]);const u=[];for(const f of c)if(this.task_prompts_without_inputs.has(f))u.push(this.task_prompts_without_inputs.get(f));else{for(const[d,h]of this.task_prompts_with_input)if(f.includes(d)){u.push(h.replaceAll("{input}",f).replaceAll(d,""));break}u.length!==c.length&&u.push(f)}return u}post_process_generation(c,u,f){const d=this.tasks_answer_post_processing_type.get(u)??"pure_text";c=c.replaceAll("<s>","").replaceAll("</s>","");let h;switch(d){case"pure_text":h=c;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const p=d==="ocr"?"quad_boxes":"bboxes",g=c.matchAll(this.regexes[p]),b=[],v=[];for(const[w,x,...S]of g)b.push(x?x.trim():b.at(-1)??""),v.push(S.map((C,M)=>(Number(C)+.5)/this.size_per_bin*f[M%2]));h={labels:b,[p]:v};break;default:throw new Error(`Task "${u}" (of type "${d}") not yet implemented.`)}return{[u]:h}}async _call(c,u=null,f={}){if(!c&&!u)throw new Error("Either text or images must be provided");const d=await this.image_processor(c,f),h=u?this.tokenizer(this.construct_prompts(u),f):{};return{...d,...h}}}}),"./src/models/gemma3n/feature_extraction_gemma3n.js":((n,e,t)=>{t.r(e),t.d(e,{Gemma3nAudioFeatureExtractor:()=>o});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js"),a=t("./src/utils/audio.js");class o extends s.FeatureExtractor{constructor(c){super(c);const{fft_length:u,feature_size:f,min_frequency:d,max_frequency:h,sampling_rate:p,frame_length:g}=this.config,b=(0,a.mel_filter_bank)(Math.floor(1+u/2),f,d,h,p,null,"htk",!1);this.mel_filters=b,this.window=(0,a.window_function)(g,"hann")}async _extract_fbank_features(c,u){return(0,a.spectrogram)(c,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call(c,{max_length:u=48e4,truncation:f=!0,padding:d=!0,pad_to_multiple_of:h=128}={}){if((0,s.validate_audio_inputs)(c,"Gemma3nAudioFeatureExtractor"),f&&c.length>u&&(c=c.slice(0,u)),d&&c.length%h!==0){const b=h-c.length%h,v=new Float64Array(c.length+b);v.set(c),this.config.padding_value!==0&&v.fill(this.config.padding_value,c.length),c=v}const p=await this._extract_fbank_features(c,this.config.max_length),g=(0,r.full)([1,p.dims[0]],!0);return{input_features:p.unsqueeze_(0),input_features_mask:g}}}}),"./src/models/gemma3n/processing_gemma3n.js":((n,e,t)=>{t.r(e),t.d(e,{Gemma3nProcessor:()=>l});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/models/auto/feature_extraction_auto.js"),o=t("./src/tokenizers.js");t("./src/utils/image.js"),t("./src/utils/audio.js");class l extends s.Processor{static image_processor_class=r.AutoImageProcessor;static feature_extractor_class=a.AutoFeatureExtractor;static tokenizer_class=o.AutoTokenizer;static uses_processor_config=!0;static uses_chat_template_file=!0;constructor(u,f,d){super(u,f,d),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;const{audio_token_id:h,boa_token:p,audio_token:g,eoa_token:b,image_token_id:v,boi_token:w,image_token:x,eoi_token:S}=this.tokenizer.config;this.audio_token_id=h,this.boa_token=p,this.audio_token=g;const C=g.repeat(this.audio_seq_length);this.full_audio_sequence=`

${p}${C}${b}

`,this.image_token_id=v,this.boi_token=w,this.image_token=x;const M=x.repeat(this.image_seq_length);this.full_image_sequence=`

${w}${M}${S}

`}async _call(u,f=null,d=null,h={}){typeof u=="string"&&(u=[u]);let p;d&&(p=await this.feature_extractor(d,h),u=u.map(v=>v.replaceAll(this.audio_token,this.full_audio_sequence)));let g;return f&&(g=await this.image_processor(f,h),u=u.map(v=>v.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(u,h),...g,...p}}}}),"./src/models/glpn/image_processing_glpn.js":((n,e,t)=>{t.r(e),t.d(e,{GLPNFeatureExtractor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/grounding_dino/image_processing_grounding_dino.js":((n,e,t)=>{t.r(e),t.d(e,{GroundingDinoImageProcessor:()=>a});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(l){const c=await super._call(l),u=c.pixel_values.dims,f=(0,r.ones)([u[0],u[2],u[3]]);return{...c,pixel_mask:f}}}}),"./src/models/grounding_dino/processing_grounding_dino.js":((n,e,t)=>{t.r(e),t.d(e,{GroundingDinoProcessor:()=>c});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js"),o=t("./src/base/image_processors_utils.js");function l(u,f){const h=u.dims.at(-1)-1,p=u.tolist();p.fill(!1,0,1),p.fill(!1,h);const g=f.tolist();return p.map((b,v)=>b?v:null).filter(b=>b!==null).map(b=>g[b])}class c extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;async _call(f,d,h={}){const p=f?await this.image_processor(f,h):{};return{...d?this.tokenizer(d,h):{},...p}}post_process_grounded_object_detection(f,d,{box_threshold:h=.25,text_threshold:p=.25,target_sizes:g=null}={}){const{logits:b,pred_boxes:v}=f,w=b.dims[0];if(g!==null&&g.length!==w)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const x=b.dims.at(1),S=b.sigmoid(),C=S.max(-1).tolist(),M=v.tolist().map(E=>E.map(I=>(0,o.center_to_corners_format)(I))),k=[];for(let E=0;E<w;++E){const I=g!==null?g[E]:null;I!==null&&(M[E]=M[E].map(j=>j.map((G,Q)=>G*I[(Q+1)%2])));const A=C[E],D=[],L=[],P=[];for(let j=0;j<x;++j){const G=A[j];if(G<=h)continue;const Q=M[E][j],q=S[E][j];D.push(G),P.push(Q);const te=l(q.gt(p),d[E]);L.push(te)}k.push({scores:D,boxes:P,labels:this.batch_decode(L)})}return k}}}),"./src/models/idefics3/image_processing_idefics3.js":((n,e,t)=>{t.r(e),t.d(e,{Idefics3ImageProcessor:()=>a});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/tensor.js");class a extends s.ImageProcessor{constructor(l){super(l),this.do_image_splitting=l.do_image_splitting??!0,this.max_image_size=l.max_image_size}get_resize_for_vision_encoder(l,c){let[u,f]=l.dims.slice(-2);const d=f/u;return f>=u?(f=Math.ceil(f/c)*c,u=Math.floor(f/d),u=Math.ceil(u/c)*c):(u=Math.ceil(u/c)*c,f=Math.floor(u*d),f=Math.ceil(f/c)*c),{height:u,width:f}}async _call(l,{do_image_splitting:c=null,return_row_col_info:u=!1}={}){let f;if(!Array.isArray(l))f=[[l]];else{if(l.length===0||!l[0])throw new Error("No images provided.");Array.isArray(l[0])?f=l:f=[l]}let d=[],h=[],p=[];const g=[],b=[];for(const E of f){let I=await Promise.all(E.map(L=>this.preprocess(L)));g.push(...I.map(L=>L.original_size)),b.push(...I.map(L=>L.reshaped_input_size)),I.forEach(L=>L.pixel_values.unsqueeze_(0));const{longest_edge:A}=this.max_image_size;let D;if(c??this.do_image_splitting){let L=new Array(I.length),P=new Array(I.length);D=await Promise.all(I.map(async(j,G)=>{const Q=this.get_resize_for_vision_encoder(j.pixel_values,A),q=await(0,r.interpolate_4d)(j.pixel_values,{size:[Q.height,Q.width]}),{frames:te,num_splits_h:Z,num_splits_w:ne}=await this.split_image(q,this.max_image_size);return L[G]=Z,P[G]=ne,(0,r.cat)(te,0)})),h.push(L),p.push(P)}else{const L=[A,A];D=await Promise.all(I.map(P=>(0,r.interpolate_4d)(P.pixel_values,{size:L}))),h.push(new Array(I.length).fill(0)),p.push(new Array(I.length).fill(0))}d.push((0,r.cat)(D,0))}const v=d.length,[w,x,S,C]=d[0].dims;let M,k;if(v===1)M=d[0].unsqueeze_(0),k=(0,r.full)([v,w,S,C],!0);else{const E=Math.max(...d.map(D=>D.dims.at(0)));k=(0,r.full)([v,E,S,C],!0);const I=k.data,A=E*S*C;for(let D=0;D<v;++D){const L=d[D].dims[0];if(L<E){d[D]=(0,r.cat)([d[D],(0,r.full)([E-L,x,S,C],0)],0);const P=D*A+L*S*C,j=(D+1)*A;I.fill(!1,P,j)}}M=(0,r.stack)(d,0)}return{pixel_values:M,pixel_attention_mask:k,original_sizes:g,reshaped_input_sizes:b,...u?{rows:h,cols:p}:{}}}async split_image(l,{longest_edge:c}){const u=c,f=c,d=[],[h,p]=l.dims.slice(-2);let g=0,b=0;if(h>u||p>f){g=Math.ceil(h/u),b=Math.ceil(p/f);const v=Math.ceil(h/g),w=Math.ceil(p/b);for(let C=0;C<g;++C)for(let M=0;M<b;++M){let k,E,I,A;C===g-1?(E=h-v,A=h):(E=C*v,A=(C+1)*v),M===b-1?(k=p-w,I=p):(k=M*w,I=(M+1)*w);const D=[E,k],L=[A,I],P=await(0,r.slice)(l,D,L,[2,3]);d.push(P)}const x=u,S=f;(h!==x||p!==S)&&(l=await(0,r.interpolate_4d)(l,{size:[x,S]}))}return d.push(l),{frames:d,num_splits_h:g,num_splits_w:b}}}}),"./src/models/idefics3/processing_idefics3.js":((n,e,t)=>{t.r(e),t.d(e,{Idefics3Processor:()=>f});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");t("./src/utils/image.js");var o=t("./src/utils/core.js");function l(d,h,p,g,b,v){let w="";for(let x=0;x<h;++x){for(let S=0;S<p;++S)w+=g+`<row_${x+1}_col_${S+1}>`+b.repeat(d);w+=`
`}return w+=`
${g}${v}`+b.repeat(d)+`${g}`,w}function c(d,h,p,g){return`${h}${g}`+p.repeat(d)+`${h}`}function u(d,h,p,g,b,v){return d===0&&h===0?c(p,g,b,v):l(p,d,h,g,b,v)}class f extends s.Processor{static image_processor_class=r.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;static uses_processor_config=!0;fake_image_token="<fake_token_around_image>";image_token="<image>";global_img_token="<global-img>";async _call(h,p=null,g={}){g.return_row_col_info??=!0;let b;p&&(b=await this.image_processor(p,g)),Array.isArray(h)||(h=[h]);const v=b.rows??[new Array(h.length).fill(0)],w=b.cols??[new Array(h.length).fill(0)],x=this.config.image_seq_len,S=[],C=[];for(let k=0;k<h.length;++k){const E=h[k],I=v[k],A=w[k];S.push((0,o.count)(E,this.image_token));const D=I.map((j,G)=>u(j,A[G],x,this.fake_image_token,this.image_token,this.global_img_token)),L=E.split(this.image_token);if(L.length===0)throw new Error("The image token should be present in the text.");let P=L[0];for(let j=0;j<D.length;++j)P+=D[j]+L[j+1];C.push(P)}return{...this.tokenizer(C),...b}}}}),"./src/models/image_processors.js":((n,e,t)=>{t.r(e),t.d(e,{BeitFeatureExtractor:()=>s.BeitFeatureExtractor,BitImageProcessor:()=>r.BitImageProcessor,CLIPFeatureExtractor:()=>o.CLIPFeatureExtractor,CLIPImageProcessor:()=>o.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>a.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>l.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>l.ConvNextImageProcessor,DINOv3ViTImageProcessor:()=>f.DINOv3ViTImageProcessor,DPTFeatureExtractor:()=>h.DPTFeatureExtractor,DPTImageProcessor:()=>h.DPTImageProcessor,DeiTFeatureExtractor:()=>c.DeiTFeatureExtractor,DeiTImageProcessor:()=>c.DeiTImageProcessor,DetrFeatureExtractor:()=>u.DetrFeatureExtractor,DetrImageProcessor:()=>u.DetrImageProcessor,DonutFeatureExtractor:()=>d.DonutFeatureExtractor,DonutImageProcessor:()=>d.DonutImageProcessor,EfficientNetImageProcessor:()=>p.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>g.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>b.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>v.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>x.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>S.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>C.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>M.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>M.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>k.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>k.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>E.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>E.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>I.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>I.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>A.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>A.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>D.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>D.MobileViTImageProcessor,NougatImageProcessor:()=>L.NougatImageProcessor,OwlViTFeatureExtractor:()=>j.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>j.OwlViTImageProcessor,Owlv2ImageProcessor:()=>P.Owlv2ImageProcessor,Phi3VImageProcessor:()=>G.Phi3VImageProcessor,PixtralImageProcessor:()=>Q.PixtralImageProcessor,PvtImageProcessor:()=>q.PvtImageProcessor,Qwen2VLImageProcessor:()=>te.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>Z.RTDetrImageProcessor,Sam2ImageProcessor:()=>le.Sam2ImageProcessor,Sam3ImageProcessor:()=>H.Sam3ImageProcessor,SamImageProcessor:()=>ne.SamImageProcessor,SegformerFeatureExtractor:()=>R.SegformerFeatureExtractor,SegformerImageProcessor:()=>R.SegformerImageProcessor,SiglipImageProcessor:()=>B.SiglipImageProcessor,SmolVLMImageProcessor:()=>W.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>se.Swin2SRImageProcessor,VLMImageProcessor:()=>w.VLMImageProcessor,ViTFeatureExtractor:()=>ue.ViTFeatureExtractor,ViTImageProcessor:()=>ue.ViTImageProcessor,VitMatteImageProcessor:()=>ge.VitMatteImageProcessor,VitPoseImageProcessor:()=>Ce.VitPoseImageProcessor,YolosFeatureExtractor:()=>Se.YolosFeatureExtractor,YolosImageProcessor:()=>Se.YolosImageProcessor});var s=t("./src/models/beit/image_processing_beit.js"),r=t("./src/models/bit/image_processing_bit.js"),a=t("./src/models/chinese_clip/image_processing_chinese_clip.js"),o=t("./src/models/clip/image_processing_clip.js"),l=t("./src/models/convnext/image_processing_convnext.js"),c=t("./src/models/deit/image_processing_deit.js"),u=t("./src/models/detr/image_processing_detr.js"),f=t("./src/models/dinov3_vit/image_processing_dinov3_vit.js"),d=t("./src/models/donut/image_processing_donut.js"),h=t("./src/models/dpt/image_processing_dpt.js"),p=t("./src/models/efficientnet/image_processing_efficientnet.js"),g=t("./src/models/glpn/image_processing_glpn.js"),b=t("./src/models/grounding_dino/image_processing_grounding_dino.js"),v=t("./src/models/idefics3/image_processing_idefics3.js"),w=t("./src/models/janus/image_processing_janus.js"),x=t("./src/models/jina_clip/image_processing_jina_clip.js"),S=t("./src/models/llava_onevision/image_processing_llava_onevision.js"),C=t("./src/models/mask2former/image_processing_mask2former.js"),M=t("./src/models/maskformer/image_processing_maskformer.js"),k=t("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),E=t("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),I=t("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),A=t("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),D=t("./src/models/mobilevit/image_processing_mobilevit.js"),L=t("./src/models/nougat/image_processing_nougat.js"),P=t("./src/models/owlv2/image_processing_owlv2.js"),j=t("./src/models/owlvit/image_processing_owlvit.js"),G=t("./src/models/phi3_v/image_processing_phi3_v.js"),Q=t("./src/models/pixtral/image_processing_pixtral.js"),q=t("./src/models/pvt/image_processing_pvt.js"),te=t("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),Z=t("./src/models/rt_detr/image_processing_rt_detr.js"),ne=t("./src/models/sam/image_processing_sam.js"),le=t("./src/models/sam2/image_processing_sam2.js"),H=t("./src/models/sam3/image_processing_sam3.js"),R=t("./src/models/segformer/image_processing_segformer.js"),B=t("./src/models/siglip/image_processing_siglip.js"),W=t("./src/models/smolvlm/image_processing_smolvlm.js"),se=t("./src/models/swin2sr/image_processing_swin2sr.js"),ue=t("./src/models/vit/image_processing_vit.js"),ge=t("./src/models/vitmatte/image_processing_vitmatte.js"),Ce=t("./src/models/vitpose/image_processing_vitpose.js"),Se=t("./src/models/yolos/image_processing_yolos.js")}),"./src/models/janus/image_processing_janus.js":((n,e,t)=>{t.r(e),t.d(e,{VLMImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{constructor(o){super({do_pad:!0,pad_size:{width:o.image_size,height:o.image_size},...o}),this.constant_values=this.config.background_color.map(l=>l*this.rescale_factor)}pad_image(o,l,c,u){return super.pad_image(o,l,c,{constant_values:this.constant_values,center:!0,...u})}}}),"./src/models/janus/processing_janus.js":((n,e,t)=>{t.r(e),t.d(e,{VLChatProcessor:()=>u});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js"),o=t("./src/utils/core.js"),l=t("./src/utils/tensor.js"),c=t("./src/utils/image.js");class u extends s.Processor{static image_processor_class=r.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;static uses_processor_config=!0;constructor(d,h,p){super(d,h,p),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(d,{images:h=null,chat_template:p="default"}={}){h?Array.isArray(h)||(h=[h]):h=await Promise.all(d.filter(D=>D.images).flatMap(D=>D.images).map(D=>c.RawImage.read(D)));const g=this.tokenizer,b=g.apply_chat_template(d,{tokenize:!1,add_generation_prompt:!0,chat_template:p}),v=D=>g.encode(D,{add_special_tokens:!1}),w=b.split(this.image_tag),x=w.length-1;if(h.length!==x)throw new Error(`Number of images provided (${h.length}) does not match number of "${this.image_tag}" image tags (${x})`);const[S,C,M]=g.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let k=v(w[0]),E=new Array(k.length).fill(!1);for(let D=1;D<w.length;++D){const L=new Array(this.num_image_tokens).fill(S),P=v(w[D]);k=(0,o.mergeArrays)(k,[C],L,[M],P);const j=new Array(this.num_image_tokens).fill(!0);E=(0,o.mergeArrays)(E,[!1],j,[!1],new Array(P.length).fill(!1))}const I=[1,k.length],A={input_ids:new l.Tensor("int64",k,I),attention_mask:new l.Tensor("int64",new Array(k.length).fill(1),I),images_seq_mask:new l.Tensor("bool",E,I),images_emb_mask:new l.Tensor("bool",new Array(x*this.num_image_tokens).fill(!0),[1,x,this.num_image_tokens])};if(h&&h.length>0){const D=await this.image_processor(h);return D.pixel_values.unsqueeze_(0),{...A,...D}}return A}}}),"./src/models/jina_clip/image_processing_jina_clip.js":((n,e,t)=>{t.r(e),t.d(e,{JinaCLIPImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{constructor(o){const{resize_mode:l,fill_color:c,interpolation:u,size:f,...d}=o,h=l==="squash"?{width:f,height:f}:l==="shortest"?{shortest_edge:f}:{longest_edge:f},p=u==="bicubic"?3:2;super({...d,size:h,resample:p,do_center_crop:!0,crop_size:f,do_normalize:!0})}}}),"./src/models/jina_clip/processing_jina_clip.js":((n,e,t)=>{t.r(e),t.d(e,{JinaCLIPProcessor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");class o extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;async _call(c=null,u=null,f={}){if(!c&&!u)throw new Error("Either text or images must be provided");const d=c?this.tokenizer(c,f):{},h=u?await this.image_processor(u,f):{};return{...d,...h}}}}),"./src/models/llava/processing_llava.js":((n,e,t)=>{t.r(e),t.d(e,{LlavaProcessor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");class o extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;static uses_processor_config=!0;async _call(c,u=null,f={}){const d=await this.image_processor(c,f);if(u){const[p,g]=d.pixel_values.dims.slice(-2),{image_token:b,patch_size:v,num_additional_image_tokens:w}=this.config,x=Math.floor(p/v)*Math.floor(g/v)+w;u=structuredClone(u),Array.isArray(u)||(u=[u]);for(let S=0;S<u.length;++S)u[S]=u[S].replace(b,b.repeat(x))}const h=u?this.tokenizer(u,f):{};return{...d,...h}}}}),"./src/models/llava_onevision/image_processing_llava_onevision.js":((n,e,t)=>{t.r(e),t.d(e,{LlavaOnevisionImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/mask2former/image_processing_mask2former.js":((n,e,t)=>{t.r(e),t.d(e,{Mask2FormerImageProcessor:()=>r});var s=t("./src/models/maskformer/image_processing_maskformer.js");class r extends s.MaskFormerImageProcessor{}}),"./src/models/maskformer/image_processing_maskformer.js":((n,e,t)=>{t.r(e),t.d(e,{MaskFormerFeatureExtractor:()=>a,MaskFormerImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{post_process_panoptic_segmentation(...l){return(0,s.post_process_panoptic_segmentation)(...l)}post_process_instance_segmentation(...l){return(0,s.post_process_instance_segmentation)(...l)}}class a extends r{}}),"./src/models/mgp_str/processing_mgp_str.js":((n,e,t)=>{t.r(e),t.d(e,{MgpstrProcessor:()=>c});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js"),o=t("./src/utils/maths.js");const l={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class c extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(f,d){if(!l.hasOwnProperty(d))throw new Error(`Format ${d} is not supported.`);const[h,p]=l[d],g=this[h].bind(this),[b,v]=f.dims,w=[],x=[],S=f.tolist();for(let M=0;M<b;++M){const k=S[M],E=[],I=[];for(let D=1;D<v;++D){const[L,P]=(0,o.max)((0,o.softmax)(k[D]));if(I.push(L),P==p)break;E.push(P)}const A=I.length>0?I.reduce((D,L)=>D*L,1):0;x.push(E),w.push(A)}return[g(x),w]}char_decode(f){return this.char_tokenizer.batch_decode(f).map(d=>d.replaceAll(" ",""))}bpe_decode(f){return this.bpe_tokenizer.batch_decode(f)}wp_decode(f){return this.wp_tokenizer.batch_decode(f).map(d=>d.replaceAll(" ",""))}batch_decode([f,d,h]){const[p,g]=this._decode_helper(f,"char"),[b,v]=this._decode_helper(d,"bpe"),[w,x]=this._decode_helper(h,"wp"),S=[],C=[];for(let M=0;M<p.length;++M){const[k,E]=(0,o.max)([g[M],v[M],x[M]]);S.push([p[M],b[M],w[M]][E]),C.push(k)}return{generated_text:S,scores:C,char_preds:p,bpe_preds:b,wp_preds:w}}static async from_pretrained(...f){const d=await super.from_pretrained(...f),h=await a.AutoTokenizer.from_pretrained("Xenova/gpt2"),p=await a.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return d.components={image_processor:d.image_processor,char_tokenizer:d.tokenizer,bpe_tokenizer:h,wp_tokenizer:p},d}async _call(f,d=null){const h=await this.image_processor(f);return d&&(h.labels=this.tokenizer(d).input_ids),h}}}),"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":((n,e,t)=>{t.r(e),t.d(e,{MobileNetV1FeatureExtractor:()=>a,MobileNetV1ImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":((n,e,t)=>{t.r(e),t.d(e,{MobileNetV2FeatureExtractor:()=>a,MobileNetV2ImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":((n,e,t)=>{t.r(e),t.d(e,{MobileNetV3FeatureExtractor:()=>a,MobileNetV3ImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":((n,e,t)=>{t.r(e),t.d(e,{MobileNetV4FeatureExtractor:()=>a,MobileNetV4ImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/mobilevit/image_processing_mobilevit.js":((n,e,t)=>{t.r(e),t.d(e,{MobileViTFeatureExtractor:()=>a,MobileViTImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/moonshine/feature_extraction_moonshine.js":((n,e,t)=>{t.r(e),t.d(e,{MoonshineFeatureExtractor:()=>a});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js");class a extends s.FeatureExtractor{async _call(l){(0,s.validate_audio_inputs)(l,"MoonshineFeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));const c=[1,l.length];return{input_values:new r.Tensor("float32",l,c)}}}}),"./src/models/moonshine/processing_moonshine.js":((n,e,t)=>{t.r(e),t.d(e,{MoonshineProcessor:()=>o});var s=t("./src/models/auto/feature_extraction_auto.js"),r=t("./src/tokenizers.js"),a=t("./src/base/processing_utils.js");class o extends a.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/nougat/image_processing_nougat.js":((n,e,t)=>{t.r(e),t.d(e,{NougatImageProcessor:()=>r});var s=t("./src/models/donut/image_processing_donut.js");class r extends s.DonutImageProcessor{}}),"./src/models/owlv2/image_processing_owlv2.js":((n,e,t)=>{t.r(e),t.d(e,{Owlv2ImageProcessor:()=>r});var s=t("./src/models/owlvit/image_processing_owlvit.js");class r extends s.OwlViTImageProcessor{}}),"./src/models/owlvit/image_processing_owlvit.js":((n,e,t)=>{t.r(e),t.d(e,{OwlViTFeatureExtractor:()=>a,OwlViTImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{post_process_object_detection(...l){return(0,s.post_process_object_detection)(...l)}}class a extends r{}}),"./src/models/owlvit/processing_owlvit.js":((n,e,t)=>{t.r(e),t.d(e,{OwlViTProcessor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");class o extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor}}),"./src/models/paligemma/processing_paligemma.js":((n,e,t)=>{t.r(e),t.d(e,{PaliGemmaProcessor:()=>c});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");const o="<image>";function l(u,f,d,h,p){return`${h.repeat(d*p)}${f}${u}
`}class c extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;static uses_processor_config=!1;async _call(f,d=null,h={}){d||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),d=""),Array.isArray(f)||(f=[f]),Array.isArray(d)||(d=[d]);const p=this.tokenizer.bos_token,g=this.image_processor.config.image_seq_length;let b;d.some(x=>x.includes(o))?b=d.map(x=>{const S=x.replaceAll(o,o.repeat(g)),C=S.lastIndexOf(o),M=C===-1?0:C+o.length;return S.slice(0,M)+p+S.slice(M)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),b=d.map(x=>l(x,p,g,o,f.length)));const v=this.tokenizer(b,h);return{...await this.image_processor(f,h),...v}}}}),"./src/models/parakeet/feature_extraction_parakeet.js":((n,e,t)=>{t.r(e),t.d(e,{ParakeetFeatureExtractor:()=>l});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js"),a=t("./src/utils/audio.js");const o=1e-5;class l extends s.FeatureExtractor{constructor(u){super(u),this.config.mel_filters??=(0,a.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,this.config.sampling_rate/2,this.config.sampling_rate,"slaney","slaney");const f=(0,a.window_function)(this.config.win_length,"hann",{periodic:!1});this.window=new Float64Array(this.config.n_fft);const d=Math.floor((this.config.n_fft-this.config.win_length)/2);this.window.set(f,d)}async _extract_fbank_features(u){const f=this.config.preemphasis;u=new Float64Array(u);for(let h=u.length-1;h>=1;--h)u[h]-=f*u[h-1];return await(0,a.spectrogram)(u,this.window,this.window.length,this.config.hop_length,{fft_length:this.config.n_fft,power:2,mel_filters:this.config.mel_filters,log_mel:"log",mel_floor:-1/0,pad_mode:"constant",center:!0,transpose:!0,mel_offset:2**-24})}async _call(u){(0,s.validate_audio_inputs)(u,"ParakeetFeatureExtractor");const f=await this._extract_fbank_features(u),d=Math.floor((u.length+Math.floor(this.config.n_fft/2)*2-this.config.n_fft)/this.config.hop_length),h=f.data;h.fill(0,d*f.dims[1]);const[p,g]=f.dims,b=new Float64Array(g),v=new Float64Array(g);for(let S=0;S<d;++S){const C=S*g;for(let M=0;M<g;++M){const k=h[C+M];b[M]+=k,v[M]+=k*k}}const w=d>1?d-1:1;for(let S=0;S<g;++S){const C=b[S]/d,M=(v[S]-d*C*C)/w,E=1/(Math.sqrt(M)+o);for(let I=0;I<d;++I){const A=I*g+S;h[A]=(h[A]-C)*E}}const x=new BigInt64Array(p);return x.fill(1n,0,d),{input_features:f.unsqueeze_(0),attention_mask:new r.Tensor("int64",x,[1,p])}}}}),"./src/models/phi3_v/image_processing_phi3_v.js":((n,e,t)=>{t.r(e),t.d(e,{Phi3VImageProcessor:()=>f});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/tensor.js");const a=336,o=[2,3],{ceil:l,floor:c,sqrt:u}=Math;class f extends s.ImageProcessor{constructor(h){super({...h,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=h.num_crops}calc_num_image_tokens_from_image_size(h,p){const{num_img_tokens:g}=this.config;return c((c(p/a)*c(h/a)+1)*g+1+(c(p/a)+1)*u(g))}get_resize_output_image_size(h,p){const g=this._num_crops,[b,v]=h.size;let w=b/v,x=1;for(;x*Math.ceil(x/w)<=g;)x+=1;x-=1;const S=Math.floor(x*336),C=Math.floor(S/w);return[S,C]}pad_image(h,p,g,b={}){const[v,w]=p,x=a*l(v/a),S=a*l(w/a),C=[1,1,1].map((M,k)=>(M-this.image_mean[k])/this.image_std[k]);return super.pad_image(h,p,{width:S,height:x},{center:!0,constant_values:C,...b})}async _call(h,{num_crops:p=null}={}){if(this._num_crops=p??=this.config.num_crops,p<4||u(p)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(h)||(h=[h]);const g=h.length,b=await Promise.all(h.map(E=>this.preprocess(E))),v=b.map(E=>E.original_size),w=b.map(E=>E.reshaped_input_size),x=[];for(const{pixel_values:E}of b){E.unsqueeze_(0);const[I,A]=E.dims.slice(-2),D=await(0,r.interpolate_4d)(E,{size:[a,a],mode:"bicubic"});if(p>0){const L=[],P=u(p),j=c(A/P),G=c(I/P);for(let q=0;q<P;++q)for(let te=0;te<P;++te){let Z,ne,le,H;q===P-1?(ne=I-G,H=I):(ne=q*G,H=(q+1)*G),te===P-1?(Z=A-j,le=A):(Z=te*j,le=(te+1)*j);const R=[ne,Z],B=[H,le],W=await(0,r.slice)(E,R,B,o);L.push(W)}const Q=await(0,r.interpolate_4d)((0,r.cat)(L,0),{size:[a,a],mode:"bicubic"});x.push((0,r.cat)([D,Q],0))}else x.push(D)}const S=(0,r.stack)(x,0),C=w.map(E=>E.map(I=>a*l(I/a))),M=new r.Tensor("int64",C.flat(),[g,2]),k=C.map(([E,I])=>this.calc_num_image_tokens_from_image_size(I,E));return{pixel_values:S,original_sizes:v,reshaped_input_sizes:w,image_sizes:M,num_img_tokens:k}}}}),"./src/models/phi3_v/processing_phi3_v.js":((n,e,t)=>{t.r(e),t.d(e,{Phi3VProcessor:()=>c});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");t("./src/utils/image.js");const o="<|image|>",l=/<\|image_\d+\|>/g;class c extends s.Processor{static image_processor_class=r.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;async _call(f,d=null,{padding:h=!0,truncation:p=!0,num_crops:g=null}={}){Array.isArray(f)||(f=[f]);let b,v;if(d){v=await this.image_processor(d,{num_crops:g});const{num_img_tokens:w}=v,x=f.map((C,M)=>C.split(l).join(o.repeat(w[M])));b=this.tokenizer(x,{padding:h,truncation:p});const S=this.tokenizer.model.convert_tokens_to_ids([o])[0];b.input_ids.map_(C=>C==S?-C:C)}else b=this.tokenizer(f);return{...b,...v}}}}),"./src/models/pixtral/image_processing_pixtral.js":((n,e,t)=>{t.r(e),t.d(e,{PixtralImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{get_resize_output_image_size(o,l){const{longest_edge:c}=l;if(c===void 0)throw new Error("size must contain 'longest_edge'");const[u,f]=o.size,d=Math.max(u,f)/c;let h=u,p=f;d>1&&(h=Math.floor(u/d),p=Math.floor(f/d));const{patch_size:g,spatial_merge_size:b}=this.config;if(!b)throw new Error("config must contain 'spatial_merge_size'");const v=g*b,w=Math.floor((h-1)/v)+1,x=Math.floor((p-1)/v)+1;return[w*v,x*v]}}}),"./src/models/pixtral/processing_pixtral.js":((n,e,t)=>{t.r(e),t.d(e,{PixtralProcessor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");class o extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=r.AutoImageProcessor;static uses_processor_config=!0;async _call(c,u=null,f={}){const d=await this.image_processor(c,f);if(u){const[p,g]=d.pixel_values.dims.slice(-2),{image_token:b,image_break_token:v,image_end_token:w,patch_size:x,spatial_merge_size:S}=this.config,C=x*S,M=Math.floor(p/C),k=Math.floor(g/C);u=structuredClone(u),Array.isArray(u)||(u=[u]);for(let E=0;E<u.length;++E){const I=b.repeat(k),A=I+v,D=I+w,L=A.repeat(M-1)+D;u[E]=u[E].replace(b,L)}}const h=u?this.tokenizer(u,f):{};return{...d,...h}}}}),"./src/models/processors.js":((n,e,t)=>{t.r(e),t.d(e,{Florence2Processor:()=>s.Florence2Processor,Gemma3nProcessor:()=>r.Gemma3nProcessor,GroundingDinoProcessor:()=>a.GroundingDinoProcessor,Idefics3Processor:()=>o.Idefics3Processor,JinaCLIPProcessor:()=>c.JinaCLIPProcessor,LlavaProcessor:()=>u.LlavaProcessor,MgpstrProcessor:()=>f.MgpstrProcessor,MoonshineProcessor:()=>d.MoonshineProcessor,OwlViTProcessor:()=>h.OwlViTProcessor,PaliGemmaProcessor:()=>p.PaliGemmaProcessor,Phi3VProcessor:()=>g.Phi3VProcessor,PixtralProcessor:()=>b.PixtralProcessor,PyAnnoteProcessor:()=>v.PyAnnoteProcessor,Qwen2VLProcessor:()=>w.Qwen2VLProcessor,Sam2Processor:()=>S.Sam2Processor,Sam2VideoProcessor:()=>S.Sam2VideoProcessor,SamProcessor:()=>x.SamProcessor,SmolVLMProcessor:()=>C.SmolVLMProcessor,SpeechT5Processor:()=>M.SpeechT5Processor,UltravoxProcessor:()=>k.UltravoxProcessor,VLChatProcessor:()=>l.VLChatProcessor,VoxtralProcessor:()=>E.VoxtralProcessor,Wav2Vec2Processor:()=>I.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>A.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>D.WhisperProcessor});var s=t("./src/models/florence2/processing_florence2.js"),r=t("./src/models/gemma3n/processing_gemma3n.js"),a=t("./src/models/grounding_dino/processing_grounding_dino.js"),o=t("./src/models/idefics3/processing_idefics3.js"),l=t("./src/models/janus/processing_janus.js"),c=t("./src/models/jina_clip/processing_jina_clip.js"),u=t("./src/models/llava/processing_llava.js"),f=t("./src/models/mgp_str/processing_mgp_str.js"),d=t("./src/models/moonshine/processing_moonshine.js"),h=t("./src/models/owlvit/processing_owlvit.js"),p=t("./src/models/paligemma/processing_paligemma.js"),g=t("./src/models/phi3_v/processing_phi3_v.js"),b=t("./src/models/pixtral/processing_pixtral.js"),v=t("./src/models/pyannote/processing_pyannote.js"),w=t("./src/models/qwen2_vl/processing_qwen2_vl.js"),x=t("./src/models/sam/processing_sam.js"),S=t("./src/models/sam2/processing_sam2.js"),C=t("./src/models/smolvlm/processing_smolvlm.js"),M=t("./src/models/speecht5/processing_speecht5.js"),k=t("./src/models/ultravox/processing_ultravox.js"),E=t("./src/models/voxtral/processing_voxtral.js"),I=t("./src/models/wav2vec2/processing_wav2vec2.js"),A=t("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),D=t("./src/models/whisper/processing_whisper.js")}),"./src/models/pvt/image_processing_pvt.js":((n,e,t)=>{t.r(e),t.d(e,{PvtImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/pyannote/feature_extraction_pyannote.js":((n,e,t)=>{t.r(e),t.d(e,{PyAnnoteFeatureExtractor:()=>o});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js"),a=t("./src/utils/maths.js");class o extends s.FeatureExtractor{async _call(c){(0,s.validate_audio_inputs)(c,"PyAnnoteFeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));const u=[1,1,c.length];return{input_values:new r.Tensor("float32",c,u)}}samples_to_frames(c){return(c-this.config.offset)/this.config.step}post_process_speaker_diarization(c,u){const f=u/this.samples_to_frames(u)/this.config.sampling_rate,d=[];for(const h of c.tolist()){const p=[];let g=-1;for(let b=0;b<h.length;++b){const v=(0,a.softmax)(h[b]),[w,x]=(0,a.max)(v),[S,C]=[b,b+1];x!==g?(g=x,p.push({id:x,start:S,end:C,score:w})):(p.at(-1).end=C,p.at(-1).score+=w)}d.push(p.map(({id:b,start:v,end:w,score:x})=>({id:b,start:v*f,end:w*f,confidence:x/(w-v)})))}return d}}}),"./src/models/pyannote/processing_pyannote.js":((n,e,t)=>{t.r(e),t.d(e,{PyAnnoteProcessor:()=>a});var s=t("./src/base/processing_utils.js"),r=t("./src/models/pyannote/feature_extraction_pyannote.js");class a extends s.Processor{static feature_extractor_class=r.PyAnnoteFeatureExtractor;async _call(l){return await this.feature_extractor(l)}post_process_speaker_diarization(...l){return this.feature_extractor.post_process_speaker_diarization(...l)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}}),"./src/models/qwen2_vl/image_processing_qwen2_vl.js":((n,e,t)=>{t.r(e),t.d(e,{Qwen2VLImageProcessor:()=>a});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(l,...c){const{pixel_values:u,original_sizes:f,reshaped_input_sizes:d}=await super._call(l,...c);let h=u;const{temporal_patch_size:p,merge_size:g,patch_size:b}=this.config;h.dims[0]===1&&(h=(0,r.cat)(Array.from({length:p},()=>h),0));const v=h.dims[0]/p,w=h.dims[1],x=Math.floor(h.dims[2]/b),S=Math.floor(h.dims[3]/b),C=h.view(v,p,w,Math.floor(x/g),g,b,Math.floor(S/g),g,b).permute(0,3,6,4,7,2,1,5,8).view(v*x*S,w*p*b*b),M=new r.Tensor("int64",[v,x,S],[1,3]);return{pixel_values:C,image_grid_thw:M,original_sizes:f,reshaped_input_sizes:d}}}}),"./src/models/qwen2_vl/processing_qwen2_vl.js":((n,e,t)=>{t.r(e),t.d(e,{Qwen2VLProcessor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js"),a=t("./src/tokenizers.js");t("./src/utils/image.js");class o extends s.Processor{static image_processor_class=r.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;async _call(c,u=null,...f){Array.isArray(c)||(c=[c]);let d,h;if(u&&(d=await this.image_processor(u),h=d.image_grid_thw),h){let g=this.image_processor.config.merge_size**2,b=0;const v=h.tolist();c=c.map(w=>{for(;w.includes("<|image_pad|>");){const x=Number(v[b++].reduce((S,C)=>S*C,1n));w=w.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(x/g)))}return w.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(c),...d}}}}),"./src/models/rt_detr/image_processing_rt_detr.js":((n,e,t)=>{t.r(e),t.d(e,{RTDetrImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{post_process_object_detection(...o){return(0,s.post_process_object_detection)(...o)}}}),"./src/models/sam/image_processing_sam.js":((n,e,t)=>{t.r(e),t.d(e,{SamImageProcessor:()=>o});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/core.js"),a=t("./src/utils/tensor.js");class o extends s.ImageProcessor{reshape_input_points(c,u,f,d=!1){c=structuredClone(c);let h=(0,r.calculateDimensions)(c);if(h.length===3)d||(h=[1,...h]),c=[c];else if(h.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let p=0;p<c.length;++p){const[g,b]=u[p],[v,w]=f[p],x=[w/b,v/g];for(let S=0;S<c[p].length;++S)for(let C=0;C<c[p][S].length;++C)for(let M=0;M<c[p][S][C].length;++M)c[p][S][C][M]*=x[M%2]}return new a.Tensor("float32",Float32Array.from(c.flat(1/0)),h)}add_input_labels(c,u){let f=(0,r.calculateDimensions)(c);if(f.length===2)f=[1,...f],c=[c];else if(f.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(f.some((d,h)=>d!==u.dims[h]))throw Error(`The first ${f.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new a.Tensor("int64",c.flat(1/0).map(BigInt),f)}async _call(c,{input_points:u=null,input_labels:f=null,input_boxes:d=null}={}){const h=await super._call(c);if(u&&(h.input_points=this.reshape_input_points(u,h.original_sizes,h.reshaped_input_sizes)),f){if(!h.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");h.input_labels=this.add_input_labels(f,h.input_points)}return d&&(h.input_boxes=this.reshape_input_points(d,h.original_sizes,h.reshaped_input_sizes,!0)),h}async post_process_masks(c,u,f,{mask_threshold:d=0,binarize:h=!0,pad_size:p=null}={}){const g=[];p=p??this.pad_size??this.size;const b=[p.height,p.width];for(let v=0;v<u.length;++v){const w=u[v],x=f[v];let S=await(0,a.interpolate_4d)(c[v],{mode:"bilinear",size:b});if(S=S.slice(null,null,[0,x[0]],[0,x[1]]),S=await(0,a.interpolate_4d)(S,{mode:"bilinear",size:w}),h){const C=S.data,M=new Uint8Array(C.length);for(let k=0;k<C.length;++k)C[k]>d&&(M[k]=1);S=new a.Tensor("bool",M,S.dims)}g.push(S)}return g}generate_crop_boxes(c,u,{crop_n_layers:f=0,overlap_ratio:d=512/1500,points_per_crop:h=32,crop_n_points_downscale_factor:p=1}={}){}}}),"./src/models/sam/processing_sam.js":((n,e,t)=>{t.r(e),t.d(e,{SamProcessor:()=>a});var s=t("./src/base/processing_utils.js"),r=t("./src/models/auto/image_processing_auto.js");class a extends s.Processor{static image_processor_class=r.AutoImageProcessor;async _call(...l){return await this.image_processor(...l)}post_process_masks(...l){return this.image_processor.post_process_masks(...l)}reshape_input_points(...l){return this.image_processor.reshape_input_points(...l)}}}),"./src/models/sam2/image_processing_sam2.js":((n,e,t)=>{t.r(e),t.d(e,{Sam2ImageProcessor:()=>s.SamImageProcessor});var s=t("./src/models/sam/image_processing_sam.js")}),"./src/models/sam2/processing_sam2.js":((n,e,t)=>{t.r(e),t.d(e,{Sam2Processor:()=>r,Sam2VideoProcessor:()=>a});var s=t("./src/models/sam/processing_sam.js");class r extends s.SamProcessor{}class a extends r{}}),"./src/models/sam3/image_processing_sam3.js":((n,e,t)=>{t.r(e),t.d(e,{Sam3ImageProcessor:()=>s.Sam2ImageProcessor});var s=t("./src/models/sam2/image_processing_sam2.js")}),"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":((n,e,t)=>{t.r(e),t.d(e,{SeamlessM4TFeatureExtractor:()=>o});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js"),a=t("./src/utils/audio.js");class o extends s.FeatureExtractor{constructor(c){super(c);const u=this.config.sampling_rate,f=(0,a.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);this.mel_filters=f,this.window=(0,a.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(c,u){return c=c.map(f=>f*32768),(0,a.spectrogram)(c,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:u,transpose:!0})}async _call(c,{padding:u=!0,pad_to_multiple_of:f=2,do_normalize_per_mel_bins:d=!0,return_attention_mask:h=!0}={}){(0,s.validate_audio_inputs)(c,"SeamlessM4TFeatureExtractor");let p=await this._extract_fbank_features(c,this.config.max_length);if(d){const[M,k]=p.dims,E=p.data;for(let I=0;I<k;++I){let A=0;for(let j=0;j<M;++j)A+=E[j*k+I];const D=A/M;let L=0;for(let j=0;j<M;++j)L+=(E[j*k+I]-D)**2;L/=M-1;const P=Math.sqrt(L+1e-7);for(let j=0;j<M;++j){const G=j*k+I;E[G]=(E[G]-D)/P}}}let g;if(u){const[M,k]=p.dims,E=p.data,I=M%f;if(I>0){const A=new Float32Array(k*(M+I));A.set(E),A.fill(this.config.padding_value,E.length);const D=M+I;p=new r.Tensor(p.type,A,[D,k]),h&&(g=new r.Tensor("int64",new BigInt64Array(D),[1,D]),g.data.fill(1n,0,M))}}const[b,v]=p.dims,w=this.config.stride;if(b%w!==0)throw new Error(`The number of frames (${b}) must be a multiple of the stride (${w}).`);const S=p.view(1,Math.floor(b/w),v*w),C={input_features:S};if(h){const M=S.dims[1],k=new BigInt64Array(M);if(g){const E=g.data;for(let I=1,A=0;I<b;I+=w,++A)k[A]=E[I]}else k.fill(1n);C.attention_mask=new r.Tensor("int64",k,[1,M])}return C}}}),"./src/models/segformer/image_processing_segformer.js":((n,e,t)=>{t.r(e),t.d(e,{SegformerFeatureExtractor:()=>a,SegformerImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{post_process_semantic_segmentation(...l){return(0,s.post_process_semantic_segmentation)(...l)}}class a extends r{}}),"./src/models/siglip/image_processing_siglip.js":((n,e,t)=>{t.r(e),t.d(e,{SiglipImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}}),"./src/models/smolvlm/image_processing_smolvlm.js":((n,e,t)=>{t.r(e),t.d(e,{SmolVLMImageProcessor:()=>s.Idefics3ImageProcessor});var s=t("./src/models/idefics3/image_processing_idefics3.js")}),"./src/models/smolvlm/processing_smolvlm.js":((n,e,t)=>{t.r(e),t.d(e,{SmolVLMProcessor:()=>s.Idefics3Processor});var s=t("./src/models/idefics3/processing_idefics3.js")}),"./src/models/snac/feature_extraction_snac.js":((n,e,t)=>{t.r(e),t.d(e,{SnacFeatureExtractor:()=>r});var s=t("./src/models/dac/feature_extraction_dac.js");class r extends s.DacFeatureExtractor{}}),"./src/models/speecht5/feature_extraction_speecht5.js":((n,e,t)=>{t.r(e),t.d(e,{SpeechT5FeatureExtractor:()=>r});var s=t("./src/base/feature_extraction_utils.js");class r extends s.FeatureExtractor{}}),"./src/models/speecht5/processing_speecht5.js":((n,e,t)=>{t.r(e),t.d(e,{SpeechT5Processor:()=>o});var s=t("./src/base/processing_utils.js"),r=t("./src/tokenizers.js"),a=t("./src/models/auto/feature_extraction_auto.js");class o extends s.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=a.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/swin2sr/image_processing_swin2sr.js":((n,e,t)=>{t.r(e),t.d(e,{Swin2SRImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{pad_image(o,l,c,u={}){const[f,d,h]=l;return super.pad_image(o,l,{width:d+(c-d%c)%c,height:f+(c-f%c)%c},{mode:"symmetric",center:!1,constant_values:-1,...u})}}}),"./src/models/ultravox/processing_ultravox.js":((n,e,t)=>{t.r(e),t.d(e,{UltravoxProcessor:()=>o});var s=t("./src/models/auto/feature_extraction_auto.js"),r=t("./src/tokenizers.js"),a=t("./src/base/processing_utils.js");class o extends a.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;static uses_processor_config=!0;async _call(c,u=null,f={}){if(Array.isArray(c))throw new Error("Batched inputs are not supported yet.");let d={};if(u){const p=u.length,{input_features:g}=await this.feature_extractor(u,{...f,max_length:p}),b=Math.round(p/this.config.encoder_ds_factor+1e-4),v=1+Math.ceil(b/this.config.stack_factor);d.audio_token_len=[v],d.audio_values=g;const w=this.config.audio_placeholder;if(!c.includes(w))throw new Error(`The input text does not contain the image token ${w}.`);c=c.replaceAll(w,w.repeat(v))}return{...this.tokenizer(c,{add_special_tokens:!1,...f}),...d}}}}),"./src/models/vit/image_processing_vit.js":((n,e,t)=>{t.r(e),t.d(e,{ViTFeatureExtractor:()=>a,ViTImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{}class a extends r{}}),"./src/models/vitmatte/image_processing_vitmatte.js":((n,e,t)=>{t.r(e),t.d(e,{VitMatteImageProcessor:()=>a});var s=t("./src/base/image_processors_utils.js"),r=t("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(l,c){Array.isArray(l)||(l=[l]),Array.isArray(c)||(c=[c]);const u=await Promise.all(l.map(h=>this.preprocess(h))),f=await Promise.all(c.map(h=>this.preprocess(h,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,r.stack)(u.map((h,p)=>(0,r.cat)([h.pixel_values,f[p].pixel_values],0)),0),original_sizes:u.map(h=>h.original_size),reshaped_input_sizes:u.map(h=>h.reshaped_input_size)}}}}),"./src/models/vitpose/image_processing_vitpose.js":((n,e,t)=>{t.r(e),t.d(e,{VitPoseImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{post_process_pose_estimation(o,l,{threshold:c=null}={}){const u=o.tolist(),[f,d,h,p]=o.dims,g=[];for(let b=0;b<f;++b){const v=u[b],w=l[b],x=[];for(let S=0;S<w.length;++S){const C=w[S],M=[],k=[],E=[],I=C.at(-2)/p,A=C.at(-1)/h;for(let D=0;D<v.length;++D){let[L,P]=[0,0],j=0,G=-1/0;const Q=v[D];for(let te=0;te<Q.length;++te){const Z=Q[te];for(let ne=0;ne<Z.length;++ne){const le=Z[ne];j+=le,G=Math.max(G,le),L+=(ne+.5)*le,P+=te*le}}if(c!=null&&G<c)continue;const q=[I*L/j,A*P/j];M.push(q),E.push(D),k.push(G)}x.push({bbox:C,scores:k,labels:E,keypoints:M})}g.push(x)}return g}}}),"./src/models/voxtral/processing_voxtral.js":((n,e,t)=>{t.r(e),t.d(e,{VoxtralProcessor:()=>d});var s=t("./src/models/auto/feature_extraction_auto.js"),r=t("./src/tokenizers.js"),a=t("./src/base/processing_utils.js"),o=t("./src/utils/tensor.js");const l="[AUDIO]",c="[BEGIN_AUDIO]",u=375;function f(h,p){const g=[];for(let b=0;b<h.length;b+=p)g.push(h.subarray(b,Math.min(b+p,h.length)));return g}class d extends a.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;static uses_processor_config=!1;async _call(p,g=null,b={}){if(Array.isArray(p))throw new Error("Batched inputs are not supported yet.");const v={};if(g){if(!p.includes(l))throw new Error(`The input text does not contain the audio token ${l}.`);Array.isArray(g)||(g=[g]);const x=p.split(l),S=x.length-1;if(S!==g.length)throw new Error(`The number of audio inputs (${g.length}) does not match the number of audio tokens in the text (${S}).`);const C=this.feature_extractor.config.n_samples,M=g.map(D=>f(D,C)),k=M.map(D=>D.length),E=M.flat(),I=(await Promise.all(E.map(D=>this.feature_extractor(D,b)))).map(D=>D.input_features);v.audio_values=I.length>1?(0,o.cat)(I,0):I[0];let A=x[0];for(let D=0;D<k.length;++D){A+=c;for(let L=0;L<k[D];++L)A+=l.repeat(u);A+=x[D+1]}p=A}return{...this.tokenizer(p,{add_special_tokens:!1,...b}),...v}}}}),"./src/models/wav2vec2/feature_extraction_wav2vec2.js":((n,e,t)=>{t.r(e),t.d(e,{Wav2Vec2FeatureExtractor:()=>a});var s=t("./src/base/feature_extraction_utils.js"),r=t("./src/utils/tensor.js");class a extends s.FeatureExtractor{_zero_mean_unit_var_norm(l){const u=l.reduce((d,h)=>d+h,0)/l.length,f=l.reduce((d,h)=>d+(h-u)**2,0)/l.length;return l.map(d=>(d-u)/Math.sqrt(f+1e-7))}async _call(l){(0,s.validate_audio_inputs)(l,"Wav2Vec2FeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));let c=l;this.config.do_normalize&&(c=this._zero_mean_unit_var_norm(c));const u=[1,c.length];return{input_values:new r.Tensor("float32",c,u),attention_mask:new r.Tensor("int64",new BigInt64Array(c.length).fill(1n),u)}}}}),"./src/models/wav2vec2/processing_wav2vec2.js":((n,e,t)=>{t.r(e),t.d(e,{Wav2Vec2Processor:()=>o});var s=t("./src/tokenizers.js"),r=t("./src/models/auto/feature_extraction_auto.js"),a=t("./src/base/processing_utils.js");class o extends a.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":((n,e,t)=>{t.r(e),t.d(e,{Wav2Vec2ProcessorWithLM:()=>o});var s=t("./src/tokenizers.js"),r=t("./src/models/auto/feature_extraction_auto.js"),a=t("./src/base/processing_utils.js");class o extends a.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/wespeaker/feature_extraction_wespeaker.js":((n,e,t)=>{t.r(e),t.d(e,{WeSpeakerFeatureExtractor:()=>a});var s=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var r=t("./src/utils/audio.js");class a extends s.FeatureExtractor{constructor(l){super(l);const c=this.config.sampling_rate,u=(0,r.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(c/2),c,null,"kaldi",!0);this.mel_filters=u,this.window=(0,r.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(l){return l=l.map(c=>c*32768),(0,r.spectrogram)(l,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(l){(0,s.validate_audio_inputs)(l,"WeSpeakerFeatureExtractor");const c=(await this._extract_fbank_features(l)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const u=c.mean(1).data,f=c.data,[d,h,p]=c.dims;for(let g=0;g<d;++g){const b=g*h*p,v=g*p;for(let w=0;w<h;++w){const x=b+w*p;for(let S=0;S<p;++S)f[x+S]-=u[v+S]}}}return{input_features:c}}}}),"./src/models/whisper/common_whisper.js":((n,e,t)=>{t.r(e),t.d(e,{WHISPER_LANGUAGE_MAPPING:()=>r,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>a,whisper_language_to_code:()=>o});const s=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],r=new Map(s),a=new Map([...s.map(([l,c])=>[c,l]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function o(l){l=l.toLowerCase();let c=a.get(l);if(c===void 0){const u=l.match(/^<\|([a-z]{2})\|>$/);if(u&&(l=u[1]),r.has(l))c=l;else{const d=l.length===2?r.keys():r.values();throw new Error(`Language "${l}" is not supported. Must be one of: ${JSON.stringify(Array.from(d))}`)}}return c}}),"./src/models/whisper/feature_extraction_whisper.js":((n,e,t)=>{t.r(e),t.d(e,{WhisperFeatureExtractor:()=>o});var s=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var r=t("./src/utils/audio.js"),a=t("./src/utils/maths.js");class o extends s.FeatureExtractor{constructor(c){super(c),this.config.mel_filters??=(0,r.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney"),this.window=(0,r.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(c){const u=await(0,r.spectrogram)(c,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(c.length/this.config.hop_length),this.config.nb_max_frames)}),f=u.data,d=(0,a.max)(f)[0];for(let h=0;h<f.length;++h)f[h]=(Math.max(f[h],d-8)+4)/4;return u}async _call(c,{max_length:u=null}={}){(0,s.validate_audio_inputs)(c,"WhisperFeatureExtractor");let f;const d=u??this.config.n_samples;return c.length>d?(c.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),f=c.slice(0,d)):(f=new Float32Array(d),f.set(c)),{input_features:(await this._extract_fbank_features(f)).unsqueeze_(0)}}}}),"./src/models/whisper/generation_whisper.js":((n,e,t)=>{t.r(e),t.d(e,{WhisperGenerationConfig:()=>r});var s=t("./src/generation/configuration_utils.js");class r extends s.GenerationConfig{return_timestamps=null;return_token_timestamps=null;num_frames=null;alignment_heads=null;task=null;language=null;no_timestamps_token_id=null;prompt_ids=null;is_multilingual=null;lang_to_id=null;task_to_id=null;max_initial_timestamp_index=1}}),"./src/models/whisper/processing_whisper.js":((n,e,t)=>{t.r(e),t.d(e,{WhisperProcessor:()=>o});var s=t("./src/models/auto/feature_extraction_auto.js"),r=t("./src/tokenizers.js"),a=t("./src/base/processing_utils.js");class o extends a.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/yolos/image_processing_yolos.js":((n,e,t)=>{t.r(e),t.d(e,{YolosFeatureExtractor:()=>a,YolosImageProcessor:()=>r});var s=t("./src/base/image_processors_utils.js");class r extends s.ImageProcessor{post_process_object_detection(...l){return(0,s.post_process_object_detection)(...l)}}class a extends r{}}),"./src/ops/registry.js":((n,e,t)=>{t.r(e),t.d(e,{TensorOpRegistry:()=>o});var s=t("./src/backends/onnx.js"),r=t("./src/utils/tensor.js");const a=async(l,c,u)=>{const f=await(0,s.createInferenceSession)(new Uint8Array(l),c);return(async d=>{const h=(0,s.isONNXProxy)(),p=Object.fromEntries(Object.entries(d).map(([b,v])=>[b,(h?v.clone():v).ort_tensor])),g=await(0,s.runInferenceSession)(f,p);return Array.isArray(u)?u.map(b=>new r.Tensor(g[b])):new r.Tensor(g[u])})};class o{static session_options={};static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=a([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=a([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=a([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=a([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=a([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=a([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=a([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=a([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}}),"./src/pipelines.js":((n,e,t)=>{t.r(e),t.d(e,{AudioClassificationPipeline:()=>P,AutomaticSpeechRecognitionPipeline:()=>G,BackgroundRemovalPipeline:()=>Z,DepthEstimationPipeline:()=>se,DocumentQuestionAnsweringPipeline:()=>R,FeatureExtractionPipeline:()=>D,FillMaskPipeline:()=>S,ImageClassificationPipeline:()=>q,ImageFeatureExtractionPipeline:()=>L,ImageSegmentationPipeline:()=>te,ImageToImagePipeline:()=>W,ImageToTextPipeline:()=>Q,ObjectDetectionPipeline:()=>le,Pipeline:()=>b,QuestionAnsweringPipeline:()=>x,SummarizationPipeline:()=>M,Text2TextGenerationPipeline:()=>C,TextClassificationPipeline:()=>v,TextGenerationPipeline:()=>I,TextToAudioPipeline:()=>B,TokenClassificationPipeline:()=>w,TranslationPipeline:()=>k,ZeroShotAudioClassificationPipeline:()=>j,ZeroShotClassificationPipeline:()=>A,ZeroShotImageClassificationPipeline:()=>ne,ZeroShotObjectDetectionPipeline:()=>H,pipeline:()=>Ce});var s=t("./src/tokenizers.js"),r=t("./src/models.js"),a=t("./src/models/auto/processing_auto.js");t("./src/base/processing_utils.js");var o=t("./src/utils/generic.js"),l=t("./src/utils/core.js"),c=t("./src/utils/maths.js"),u=t("./src/utils/audio.js"),f=t("./src/utils/tensor.js"),d=t("./src/utils/image.js");async function h(Me){return Array.isArray(Me)||(Me=[Me]),await Promise.all(Me.map(pe=>d.RawImage.read(pe)))}async function p(Me,pe){return Array.isArray(Me)||(Me=[Me]),await Promise.all(Me.map(fe=>typeof fe=="string"||fe instanceof URL?(0,u.read_audio)(fe,pe):fe instanceof Float64Array?new Float32Array(fe):fe))}function g(Me,pe){pe&&(Me=Me.map(Be=>Be|0));const[fe,$e,We,de]=Me;return{xmin:fe,ymin:$e,xmax:We,ymax:de}}class b extends o.Callable{constructor({task:pe,model:fe,tokenizer:$e=null,processor:We=null}){super(),this.task=pe,this.model=fe,this.tokenizer=$e,this.processor=We}async dispose(){await this.model.dispose()}}class v extends b{constructor(pe){super(pe)}async _call(pe,{top_k:fe=1}={}){const $e=this.tokenizer(pe,{padding:!0,truncation:!0}),We=await this.model($e),de=this.model.config.problem_type==="multi_label_classification"?He=>He.sigmoid():He=>new f.Tensor("float32",(0,c.softmax)(He.data),He.dims),Be=this.model.config.id2label,st=[];for(const He of We.logits){const Xe=de(He),Ke=await(0,f.topk)(Xe,fe),Ze=Ke[0].tolist(),dt=Ke[1].tolist().map((Ft,It)=>({label:Be?Be[Ft]:`LABEL_${Ft}`,score:Ze[It]}));fe===1?st.push(...dt):st.push(dt)}return Array.isArray(pe)||fe===1?st:st[0]}}class w extends b{constructor(pe){super(pe)}async _call(pe,{ignore_labels:fe=["O"]}={}){const $e=Array.isArray(pe),We=this.tokenizer($e?pe:[pe],{padding:!0,truncation:!0}),Be=(await this.model(We)).logits,st=this.model.config.id2label,He=[];for(let Xe=0;Xe<Be.dims[0];++Xe){const Ke=We.input_ids[Xe],Ze=Be[Xe],xt=[];for(let dt=0;dt<Ze.dims[0];++dt){const Ft=Ze[dt],It=(0,c.max)(Ft.data)[1],Bt=st?st[It]:`LABEL_${It}`;if(fe.includes(Bt))continue;const Gt=this.tokenizer.decode([Ke[dt].item()],{skip_special_tokens:!0});if(Gt==="")continue;const At=(0,c.softmax)(Ft.data);xt.push({entity:Bt,score:At[It],index:dt,word:Gt})}He.push(xt)}return $e?He:He[0]}}class x extends b{constructor(pe){super(pe)}async _call(pe,fe,{top_k:$e=1}={}){const We=this.tokenizer(pe,{text_pair:fe,padding:!0,truncation:!0}),{start_logits:de,end_logits:Be}=await this.model(We),st=We.input_ids.tolist(),He=We.attention_mask.tolist(),Xe=this.tokenizer.all_special_ids,Ke=[];for(let Ze=0;Ze<de.dims[0];++Ze){const xt=st[Ze],dt=xt.findIndex(ht=>ht==this.tokenizer.sep_token_id);He[Ze].map((ht,Qt)=>ht==1&&(Qt===0||Qt>dt&&Xe.findIndex(Xt=>Xt==xt[Qt])===-1));const Ft=de[Ze].tolist(),It=Be[Ze].tolist();for(let ht=1;ht<Ft.length;++ht)(He[Ze]==0||ht<=dt||Xe.findIndex(Qt=>Qt==xt[ht])!==-1)&&(Ft[ht]=-1/0,It[ht]=-1/0);const Bt=(0,c.softmax)(Ft).map((ht,Qt)=>[ht,Qt]),Gt=(0,c.softmax)(It).map((ht,Qt)=>[ht,Qt]);Bt[0][0]=0,Gt[0][0]=0;const At=(0,l.product)(Bt,Gt).filter(ht=>ht[0][1]<=ht[1][1]).map(ht=>[ht[0][1],ht[1][1],ht[0][0]*ht[1][0]]).sort((ht,Qt)=>Qt[2]-ht[2]);for(let ht=0;ht<Math.min(At.length,$e);++ht){const[Qt,Xt,us]=At[ht],yn=xt.slice(Qt,Xt+1),En=this.tokenizer.decode(yn,{skip_special_tokens:!0});Ke.push({answer:En,score:us})}}return $e===1?Ke[0]:Ke}}class S extends b{constructor(pe){super(pe)}async _call(pe,{top_k:fe=5}={}){const $e=this.tokenizer(pe,{padding:!0,truncation:!0}),{logits:We}=await this.model($e),de=[],Be=$e.input_ids.tolist();for(let st=0;st<Be.length;++st){const He=Be[st],Xe=He.findIndex(Ft=>Ft==this.tokenizer.mask_token_id);if(Xe===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const Ke=We[st][Xe],Ze=await(0,f.topk)(new f.Tensor("float32",(0,c.softmax)(Ke.data),Ke.dims),fe),xt=Ze[0].tolist(),dt=Ze[1].tolist();de.push(dt.map((Ft,It)=>{const Bt=He.slice();return Bt[Xe]=Ft,{score:xt[It],token:Number(Ft),token_str:this.tokenizer.decode([Ft]),sequence:this.tokenizer.decode(Bt,{skip_special_tokens:!0})}}))}return Array.isArray(pe)?de:de[0]}}class C extends b{_key="generated_text";constructor(pe){super(pe)}async _call(pe,fe={}){Array.isArray(pe)||(pe=[pe]),this.model.config.prefix&&(pe=pe.map(He=>this.model.config.prefix+He));const $e=this.model.config.task_specific_params;$e&&$e[this.task]&&$e[this.task].prefix&&(pe=pe.map(He=>$e[this.task].prefix+He));const We=this.tokenizer,de={padding:!0,truncation:!0};let Be;this instanceof k&&"_build_translation_inputs"in We?Be=We._build_translation_inputs(pe,de,fe):Be=We(pe,de);const st=await this.model.generate({...Be,...fe});return We.batch_decode(st,{skip_special_tokens:!0}).map(He=>({[this._key]:He}))}}class M extends C{_key="summary_text";constructor(pe){super(pe)}}class k extends C{_key="translation_text";constructor(pe){super(pe)}}function E(Me){return Array.isArray(Me)&&Me.every(pe=>"role"in pe&&"content"in pe)}class I extends b{constructor(pe){super(pe)}async _call(pe,fe={}){let $e=!1,We=!1,de=fe.add_special_tokens??(this.tokenizer.add_bos_token||this.tokenizer.add_eos_token)??!1,Be;if(typeof pe=="string")Be=pe=[pe];else if(Array.isArray(pe)&&pe.every(dt=>typeof dt=="string"))$e=!0,Be=pe;else{if(E(pe))pe=[pe];else if(Array.isArray(pe)&&pe.every(E))$e=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");We=!0,Be=pe.map(dt=>this.tokenizer.apply_chat_template(dt,{tokenize:!1,add_generation_prompt:!0})),de=!1}const st=We?!1:fe.return_full_text??!0;this.tokenizer.padding_side="left";const He=this.tokenizer(Be,{add_special_tokens:de,padding:!0,truncation:!0}),Xe=await this.model.generate({...He,...fe}),Ke=this.tokenizer.batch_decode(Xe,{skip_special_tokens:!0});let Ze;!st&&He.input_ids.dims.at(-1)>0&&(Ze=this.tokenizer.batch_decode(He.input_ids,{skip_special_tokens:!0}).map(dt=>dt.length));const xt=Array.from({length:pe.length},dt=>[]);for(let dt=0;dt<Ke.length;++dt){const Ft=Math.floor(dt/Xe.dims[0]*pe.length);Ze&&(Ke[dt]=Ke[dt].slice(Ze[Ft])),xt[Ft].push({generated_text:We?[...pe[Ft],{role:"assistant",content:Ke[dt]}]:Ke[dt]})}return!$e&&xt.length===1?xt[0]:xt}}class A extends b{constructor(pe){super(pe),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([fe,$e])=>[fe.toLowerCase(),$e])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(pe,fe,{hypothesis_template:$e="This example is {}.",multi_label:We=!1}={}){const de=Array.isArray(pe);de||(pe=[pe]),Array.isArray(fe)||(fe=[fe]);const Be=fe.map(Xe=>$e.replace("{}",Xe)),st=We||fe.length===1,He=[];for(const Xe of pe){const Ke=[];for(const dt of Be){const Ft=this.tokenizer(Xe,{text_pair:dt,padding:!0,truncation:!0}),It=await this.model(Ft);st?Ke.push([It.logits.data[this.contradiction_id],It.logits.data[this.entailment_id]]):Ke.push(It.logits.data[this.entailment_id])}const xt=(st?Ke.map(dt=>(0,c.softmax)(dt)[1]):(0,c.softmax)(Ke)).map((dt,Ft)=>[dt,Ft]).sort((dt,Ft)=>Ft[0]-dt[0]);He.push({sequence:Xe,labels:xt.map(dt=>fe[dt[1]]),scores:xt.map(dt=>dt[0])})}return de?He:He[0]}}class D extends b{constructor(pe){super(pe)}async _call(pe,{pooling:fe="none",normalize:$e=!1,quantize:We=!1,precision:de="binary"}={}){const Be=this.tokenizer(pe,{padding:!0,truncation:!0}),st=await this.model(Be);let He=st.last_hidden_state??st.logits??st.token_embeddings;switch(fe){case"none":break;case"mean":He=(0,f.mean_pooling)(He,Be.attention_mask);break;case"first_token":case"cls":He=He.slice(null,0);break;case"last_token":case"eos":He=He.slice(null,-1);break;default:throw Error(`Pooling method '${fe}' not supported.`)}return $e&&(He=He.normalize(2,-1)),We&&(He=(0,f.quantize_embeddings)(He,de)),He}}class L extends b{constructor(pe){super(pe)}async _call(pe,{pool:fe=null}={}){const $e=await h(pe),{pixel_values:We}=await this.processor($e),de=await this.model({pixel_values:We});let Be;if(fe){if(!("pooler_output"in de))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");Be=de.pooler_output}else Be=de.last_hidden_state??de.logits??de.image_embeds;return Be}}class P extends b{constructor(pe){super(pe)}async _call(pe,{top_k:fe=5}={}){const $e=this.processor.feature_extractor.config.sampling_rate,We=await p(pe,$e),de=this.model.config.id2label,Be=[];for(const st of We){const He=await this.processor(st),Ke=(await this.model(He)).logits[0],Ze=await(0,f.topk)(new f.Tensor("float32",(0,c.softmax)(Ke.data),Ke.dims),fe),xt=Ze[0].tolist(),Ft=Ze[1].tolist().map((It,Bt)=>({label:de?de[It]:`LABEL_${It}`,score:xt[Bt]}));Be.push(Ft)}return Array.isArray(pe)?Be:Be[0]}}class j extends b{constructor(pe){super(pe)}async _call(pe,fe,{hypothesis_template:$e="This is a sound of {}."}={}){const We=!Array.isArray(pe);We&&(pe=[pe]);const de=fe.map(Ke=>$e.replace("{}",Ke)),Be=this.tokenizer(de,{padding:!0,truncation:!0}),st=this.processor.feature_extractor.config.sampling_rate,He=await p(pe,st),Xe=[];for(const Ke of He){const Ze=await this.processor(Ke),xt=await this.model({...Be,...Ze}),dt=(0,c.softmax)(xt.logits_per_audio.data);Xe.push([...dt].map((Ft,It)=>({score:Ft,label:fe[It]})))}return We?Xe[0]:Xe}}class G extends b{constructor(pe){super(pe)}async _call(pe,fe={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(pe,fe);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":case"parakeet_ctc":return this._call_wav2vec2(pe,fe);case"moonshine":return this._call_moonshine(pe,fe);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(pe,fe){fe.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),fe.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const $e=!Array.isArray(pe);$e&&(pe=[pe]);const We=this.processor.feature_extractor.config.sampling_rate,de=await p(pe,We),Be=[];for(const st of de){const He=await this.processor(st),Ke=(await this.model(He)).logits[0],Ze=[];for(const dt of Ke)Ze.push((0,c.max)(dt.data)[1]);const xt=this.tokenizer.decode(Ze,{skip_special_tokens:!0}).trim();Be.push({text:xt})}return $e?Be[0]:Be}async _call_whisper(pe,fe){const $e=fe.return_timestamps??!1,We=fe.chunk_length_s??0,de=fe.force_full_sequences??!1;let Be=fe.stride_length_s??null;const st={...fe};$e==="word"&&(st.return_token_timestamps=!0,st.return_timestamps=!1);const He=!Array.isArray(pe);He&&(pe=[pe]);const Xe=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,Ke=this.processor.feature_extractor.config.hop_length,Ze=this.processor.feature_extractor.config.sampling_rate,xt=await p(pe,Ze),dt=[];for(const Ft of xt){let It=[];if(We>0){if(Be===null)Be=We/6;else if(We<=Be)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const At=Ze*We,ht=Ze*Be,Qt=At-2*ht;let Xt=0;for(;;){const us=Xt+At,yn=Ft.subarray(Xt,us),En=await this.processor(yn),Vn=Xt===0,Nn=us>=Ft.length;if(It.push({stride:[yn.length,Vn?0:ht,Nn?0:ht],input_features:En.input_features,is_last:Nn}),Nn)break;Xt+=Qt}}else It=[{stride:[Ft.length,0,0],input_features:(await this.processor(Ft)).input_features,is_last:!0}];for(const At of It){st.num_frames=Math.floor(At.stride[0]/Ke);const ht=await this.model.generate({inputs:At.input_features,...st});$e==="word"?(At.tokens=ht.sequences.tolist()[0],At.token_timestamps=ht.token_timestamps.tolist()[0].map(Qt=>(0,c.round)(Qt,2))):At.tokens=ht[0].tolist(),At.stride=At.stride.map(Qt=>Qt/Ze)}const[Bt,Gt]=this.tokenizer._decode_asr(It,{time_precision:Xe,return_timestamps:$e,force_full_sequences:de});dt.push({text:Bt,...Gt})}return He?dt[0]:dt}async _call_moonshine(pe,fe){const $e=!Array.isArray(pe);$e&&(pe=[pe]);const We=this.processor.feature_extractor.config.sampling_rate,de=await p(pe,We),Be=[];for(const st of de){const He=await this.processor(st),Xe=Math.floor(st.length/We)*6,Ke=await this.model.generate({max_new_tokens:Xe,...fe,...He}),Ze=this.processor.batch_decode(Ke,{skip_special_tokens:!0})[0];Be.push({text:Ze})}return $e?Be[0]:Be}}class Q extends b{constructor(pe){super(pe)}async _call(pe,fe={}){const $e=Array.isArray(pe),We=await h(pe),{pixel_values:de}=await this.processor(We),Be=[];for(const st of de){st.dims=[1,...st.dims];const He=await this.model.generate({inputs:st,...fe}),Xe=this.tokenizer.batch_decode(He,{skip_special_tokens:!0}).map(Ke=>({generated_text:Ke.trim()}));Be.push(Xe)}return $e?Be:Be[0]}}class q extends b{constructor(pe){super(pe)}async _call(pe,{top_k:fe=5}={}){const $e=await h(pe),{pixel_values:We}=await this.processor($e),de=await this.model({pixel_values:We}),Be=this.model.config.id2label,st=[];for(const He of de.logits){const Xe=await(0,f.topk)(new f.Tensor("float32",(0,c.softmax)(He.data),He.dims),fe),Ke=Xe[0].tolist(),xt=Xe[1].tolist().map((dt,Ft)=>({label:Be?Be[dt]:`LABEL_${dt}`,score:Ke[Ft]}));st.push(xt)}return Array.isArray(pe)?st:st[0]}}class te extends b{constructor(pe){super(pe),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(pe,{threshold:fe=.5,mask_threshold:$e=.5,overlap_mask_area_threshold:We=.8,label_ids_to_fuse:de=null,target_sizes:Be=null,subtask:st=null}={}){if(Array.isArray(pe)&&pe.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const Xe=await h(pe),Ke=Xe.map(At=>[At.height,At.width]),Ze=await this.processor(Xe),{inputNames:xt,outputNames:dt}=this.model.sessions.model;if(!xt.includes("pixel_values")){if(xt.length!==1)throw Error(`Expected a single input name, but got ${xt.length} inputs: ${xt}.`);const At=xt[0];if(At in Ze)throw Error(`Input name ${At} already exists in the inputs.`);Ze[At]=Ze.pixel_values}const Ft=await this.model(Ze);let It=null;if(st!==null)It=this.subtasks_mapping[st];else if(this.processor.image_processor){for(const[At,ht]of Object.entries(this.subtasks_mapping))if(ht in this.processor.image_processor){It=this.processor.image_processor[ht].bind(this.processor.image_processor),st=At;break}}const Bt=this.model.config.id2label,Gt=[];if(st)if(st==="panoptic"||st==="instance"){const At=It(Ft,fe,$e,We,de,Be??Ke)[0],ht=At.segmentation;for(const Qt of At.segments_info){const Xt=new Uint8ClampedArray(ht.data.length);for(let yn=0;yn<ht.data.length;++yn)ht.data[yn]===Qt.id&&(Xt[yn]=255);const us=new d.RawImage(Xt,ht.dims[1],ht.dims[0],1);Gt.push({score:Qt.score,label:Bt[Qt.label_id],mask:us})}}else if(st==="semantic"){const{segmentation:At,labels:ht}=It(Ft,Be??Ke)[0];for(const Qt of ht){const Xt=new Uint8ClampedArray(At.data.length);for(let yn=0;yn<At.data.length;++yn)At.data[yn]===Qt&&(Xt[yn]=255);const us=new d.RawImage(Xt,At.dims[1],At.dims[0],1);Gt.push({score:null,label:Bt[Qt],mask:us})}}else throw Error(`Subtask ${st} not supported.`);else{const ht=Ft[dt[0]];for(let Qt=0;Qt<Ke.length;++Qt){const Xt=Ke[Qt],us=ht[Qt];us.data.some(En=>En<-1e-5||En>1+1e-5)&&us.sigmoid_();const yn=await d.RawImage.fromTensor(us.mul_(255).to("uint8")).resize(Xt[1],Xt[0]);Gt.push({label:null,score:null,mask:yn})}}return Gt}}class Z extends te{constructor(pe){super(pe)}async _call(pe,fe={}){if(Array.isArray(pe)&&pe.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const We=await h(pe),de=await super._call(pe,fe);return We.map((st,He)=>{const Xe=st.clone();return Xe.putAlpha(de[He].mask),Xe})}}class ne extends b{constructor(pe){super(pe)}async _call(pe,fe,{hypothesis_template:$e="This is a photo of {}"}={}){const We=Array.isArray(pe),de=await h(pe),Be=fe.map(xt=>$e.replace("{}",xt)),st=this.tokenizer(Be,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:He}=await this.processor(de),Xe=await this.model({...st,pixel_values:He}),Ke=this.model.config.model_type==="siglip"?xt=>xt.sigmoid().data:xt=>(0,c.softmax)(xt.data),Ze=[];for(const xt of Xe.logits_per_image){const Ft=[...Ke(xt)].map((It,Bt)=>({score:It,label:fe[Bt]}));Ft.sort((It,Bt)=>Bt.score-It.score),Ze.push(Ft)}return We?Ze:Ze[0]}}class le extends b{constructor(pe){super(pe)}async _call(pe,{threshold:fe=.9,percentage:$e=!1}={}){const We=Array.isArray(pe);if(We&&pe.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const de=await h(pe),Be=$e?null:de.map(dt=>[dt.height,dt.width]),{pixel_values:st,pixel_mask:He}=await this.processor(de),Xe=await this.model({pixel_values:st,pixel_mask:He}),Ke=this.processor.image_processor.post_process_object_detection(Xe,fe,Be),Ze=this.model.config.id2label,xt=Ke.map(dt=>dt.boxes.map((Ft,It)=>({score:dt.scores[It],label:Ze[dt.classes[It]],box:g(Ft,!$e)})));return We?xt:xt[0]}}class H extends b{constructor(pe){super(pe)}async _call(pe,fe,{threshold:$e=.1,top_k:We=null,percentage:de=!1}={}){const Be=Array.isArray(pe),st=await h(pe),He=this.tokenizer(fe,{padding:!0,truncation:!0}),Xe=await this.processor(st),Ke=[];for(let Ze=0;Ze<st.length;++Ze){const xt=st[Ze],dt=de?null:[[xt.height,xt.width]],Ft=Xe.pixel_values[Ze].unsqueeze_(0),It=await this.model({...He,pixel_values:Ft});let Bt;if("post_process_grounded_object_detection"in this.processor){const Gt=this.processor.post_process_grounded_object_detection(It,He.input_ids,{box_threshold:$e,text_threshold:$e,target_sizes:dt})[0];Bt=Gt.boxes.map((At,ht)=>({score:Gt.scores[ht],label:Gt.labels[ht],box:g(At,!de)}))}else{const Gt=this.processor.image_processor.post_process_object_detection(It,$e,dt,!0)[0];Bt=Gt.boxes.map((At,ht)=>({score:Gt.scores[ht],label:fe[Gt.classes[ht]],box:g(At,!de)}))}Bt.sort((Gt,At)=>At.score-Gt.score),We!==null&&(Bt=Bt.slice(0,We)),Ke.push(Bt)}return Be?Ke:Ke[0]}}class R extends b{constructor(pe){super(pe)}async _call(pe,fe,$e={}){const We=(await h(pe))[0],{pixel_values:de}=await this.processor(We),Be=`<s_docvqa><s_question>${fe}</s_question><s_answer>`,st=this.tokenizer(Be,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,He=await this.model.generate({inputs:de,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:st,...$e}),Ke=this.tokenizer.batch_decode(He)[0].match(/<s_answer>(.*?)<\/s_answer>/);let Ze=null;return Ke&&Ke.length>=2&&(Ze=Ke[1].trim()),[{answer:Ze}]}}class B extends b{DEFAULT_VOCODER_ID="Xenova/speecht5_hifigan";constructor(pe){super(pe),this.vocoder=pe.vocoder??null}async _prepare_speaker_embeddings(pe){if((typeof pe=="string"||pe instanceof URL)&&(pe=new Float32Array(await(await fetch(pe)).arrayBuffer())),pe instanceof Float32Array)pe=new f.Tensor("float32",pe,[pe.length]);else if(!(pe instanceof f.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");return pe}async _call(pe,{speaker_embeddings:fe=null,num_inference_steps:$e,speed:We}={}){return this.processor?this._call_text_to_spectrogram(pe,{speaker_embeddings:fe}):this.model.config.model_type==="supertonic"?this._call_supertonic(pe,{speaker_embeddings:fe,num_inference_steps:$e,speed:We}):this._call_text_to_waveform(pe)}async _call_supertonic(pe,{speaker_embeddings:fe,num_inference_steps:$e,speed:We}){if(!fe)throw new Error("Speaker embeddings must be provided for Supertonic models.");fe=await this._prepare_speaker_embeddings(fe);const{sampling_rate:de,style_dim:Be}=this.model.config;fe=fe.view(1,-1,Be);const st=this.tokenizer(pe,{padding:!0,truncation:!0}),{waveform:He}=await this.model.generate_speech({...st,style:fe,num_inference_steps:$e,speed:We});return new u.RawAudio(He.data,de)}async _call_text_to_waveform(pe){const fe=this.tokenizer(pe,{padding:!0,truncation:!0}),{waveform:$e}=await this.model(fe),We=this.model.config.sampling_rate;return new u.RawAudio($e.data,We)}async _call_text_to_spectrogram(pe,{speaker_embeddings:fe}){this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await r.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"}));const{input_ids:$e}=this.tokenizer(pe,{padding:!0,truncation:!0});fe=await this._prepare_speaker_embeddings(fe),fe=fe.view(1,-1);const{waveform:We}=await this.model.generate_speech($e,fe,{vocoder:this.vocoder}),de=this.processor.feature_extractor.config.sampling_rate;return new u.RawAudio(We.data,de)}}class W extends b{constructor(pe){super(pe)}async _call(pe){const fe=await h(pe),$e=await this.processor(fe),We=await this.model($e),de=[];for(const Be of We.reconstruction){const st=Be.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");de.push(d.RawImage.fromTensor(st))}return de.length>1?de:de[0]}}class se extends b{constructor(pe){super(pe)}async _call(pe){const fe=await h(pe),$e=await this.processor(fe),{predicted_depth:We}=await this.model($e),de=[];for(let Be=0;Be<fe.length;++Be){const st=We[Be],[He,Xe]=st.dims.slice(-2),[Ke,Ze]=fe[Be].size,xt=(await(0,f.interpolate_4d)(st.view(1,1,He,Xe),{size:[Ze,Ke],mode:"bilinear"})).view(Ze,Ke),dt=xt.min().item(),Ft=xt.max().item(),It=xt.sub(dt).div_(Ft-dt).mul_(255).to("uint8").unsqueeze(0),Bt=d.RawImage.fromTensor(It);de.push({predicted_depth:xt,depth:Bt})}return de.length>1?de:de[0]}}const ue=Object.freeze({"text-classification":{tokenizer:s.AutoTokenizer,pipeline:v,model:r.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:s.AutoTokenizer,pipeline:w,model:r.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:s.AutoTokenizer,pipeline:x,model:r.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:s.AutoTokenizer,pipeline:S,model:r.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:s.AutoTokenizer,pipeline:M,model:r.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:s.AutoTokenizer,pipeline:k,model:r.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:s.AutoTokenizer,pipeline:C,model:r.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:s.AutoTokenizer,pipeline:I,model:r.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:s.AutoTokenizer,pipeline:A,model:r.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:P,model:r.AutoModelForAudioClassification,processor:a.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:s.AutoTokenizer,pipeline:j,model:r.AutoModel,processor:a.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:s.AutoTokenizer,pipeline:G,model:[r.AutoModelForSpeechSeq2Seq,r.AutoModelForCTC],processor:a.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:s.AutoTokenizer,pipeline:B,model:[r.AutoModelForTextToWaveform,r.AutoModelForTextToSpectrogram],processor:[a.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:s.AutoTokenizer,pipeline:Q,model:r.AutoModelForVision2Seq,processor:a.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:q,model:r.AutoModelForImageClassification,processor:a.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:te,model:[r.AutoModelForImageSegmentation,r.AutoModelForSemanticSegmentation,r.AutoModelForUniversalSegmentation],processor:a.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:Z,model:[r.AutoModelForImageSegmentation,r.AutoModelForSemanticSegmentation,r.AutoModelForUniversalSegmentation],processor:a.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:s.AutoTokenizer,pipeline:ne,model:r.AutoModel,processor:a.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:le,model:r.AutoModelForObjectDetection,processor:a.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:s.AutoTokenizer,pipeline:H,model:r.AutoModelForZeroShotObjectDetection,processor:a.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:s.AutoTokenizer,pipeline:R,model:r.AutoModelForDocumentQuestionAnswering,processor:a.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:W,model:r.AutoModelForImageToImage,processor:a.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:se,model:r.AutoModelForDepthEstimation,processor:a.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:s.AutoTokenizer,pipeline:D,model:r.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:a.AutoProcessor,pipeline:L,model:[r.AutoModelForImageFeatureExtraction,r.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),ge=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function Ce(Me,pe=null,{progress_callback:fe=null,config:$e=null,cache_dir:We=null,local_files_only:de=!1,revision:Be="main",device:st=null,dtype:He=null,subfolder:Xe="onnx",use_external_data_format:Ke=null,model_file_name:Ze=null,session_options:xt={}}={}){Me=ge[Me]??Me;const dt=ue[Me.split("_",1)[0]];if(!dt)throw Error(`Unsupported pipeline: ${Me}. Must be one of [${Object.keys(ue)}]`);pe||(pe=dt.default.model,console.log(`No model specified. Using default model: "${pe}".`));const Ft={progress_callback:fe,config:$e,cache_dir:We,local_files_only:de,revision:Be,device:st,dtype:He,subfolder:Xe,use_external_data_format:Ke,model_file_name:Ze,session_options:xt},It=new Map([["tokenizer",dt.tokenizer],["model",dt.model],["processor",dt.processor]]),Bt=await Se(It,pe,Ft);Bt.task=Me,(0,l.dispatchCallback)(fe,{status:"ready",task:Me,model:pe});const Gt=dt.pipeline;return new Gt(Bt)}async function Se(Me,pe,fe){const $e=Object.create(null),We=[];for(const[de,Be]of Me.entries()){if(!Be)continue;let st;Array.isArray(Be)?st=new Promise(async(He,Xe)=>{let Ke;for(const Ze of Be){if(Ze===null){He(null);return}try{He(await Ze.from_pretrained(pe,fe));return}catch(xt){if(xt.message?.includes("Unsupported model type"))Ke=xt;else if(xt.message?.includes("Could not locate file"))Ke=xt;else{Xe(xt);return}}}Xe(Ke)}):st=Be.from_pretrained(pe,fe),$e[de]=st,We.push(st)}await Promise.all(We);for(const[de,Be]of Object.entries($e))$e[de]=await Be;return $e}}),"./src/tokenizers.js":((n,e,t)=>{t.r(e),t.d(e,{AlbertTokenizer:()=>ai,AutoTokenizer:()=>Of,BartTokenizer:()=>un,BertTokenizer:()=>Tn,BlenderbotSmallTokenizer:()=>cn,BlenderbotTokenizer:()=>Zt,BloomTokenizer:()=>_s,CLIPTokenizer:()=>bo,CamembertTokenizer:()=>ze,CodeGenTokenizer:()=>va,CodeLlamaTokenizer:()=>Cr,CohereTokenizer:()=>ci,ConvBertTokenizer:()=>Pe,DebertaTokenizer:()=>fs,DebertaV2Tokenizer:()=>ro,DistilBertTokenizer:()=>Oe,ElectraTokenizer:()=>Et,EsmTokenizer:()=>ka,FalconTokenizer:()=>Ni,GPT2Tokenizer:()=>xn,GPTNeoXTokenizer:()=>Xr,GemmaTokenizer:()=>wa,Grok1Tokenizer:()=>li,HerbertTokenizer:()=>re,LlamaTokenizer:()=>Yr,M2M100Tokenizer:()=>rl,MBart50Tokenizer:()=>hn,MBartTokenizer:()=>Gn,MPNetTokenizer:()=>sl,MarianTokenizer:()=>Us,MgpstrTokenizer:()=>Gl,MobileBertTokenizer:()=>ir,NllbTokenizer:()=>yo,NougatTokenizer:()=>Rs,PreTrainedTokenizer:()=>sn,Qwen2Tokenizer:()=>oi,RoFormerTokenizer:()=>ve,RobertaTokenizer:()=>vs,SiglipTokenizer:()=>Wa,SpeechT5Tokenizer:()=>In,SqueezeBertTokenizer:()=>Fn,T5Tokenizer:()=>rn,TokenizerModel:()=>L,VitsTokenizer:()=>xi,Wav2Vec2CTCTokenizer:()=>Ga,WhisperTokenizer:()=>Gc,XLMRobertaTokenizer:()=>Kr,XLMTokenizer:()=>ut,is_chinese_char:()=>S});var s=t("./src/utils/generic.js"),r=t("./src/utils/core.js"),a=t("./src/utils/hub.js"),o=t("./src/utils/maths.js"),l=t("./src/utils/tensor.js"),c=t("./src/utils/data-structures.js"),u=t("./node_modules/@huggingface/jinja/dist/index.js"),f=t("./src/models/whisper/common_whisper.js");async function d(ft,oe){const Ne=await Promise.all([(0,a.getModelJSON)(ft,"tokenizer.json",!0,oe),(0,a.getModelJSON)(ft,"tokenizer_config.json",!0,oe)]);return oe.legacy!==null&&(Ne[1].legacy=oe.legacy),Ne}function h(ft,oe){const Ne=[];let Ue=0;for(const Ve of ft.matchAll(oe)){const Ct=Ve[0];Ue<Ve.index&&Ne.push(ft.slice(Ue,Ve.index)),Ct.length>0&&Ne.push(Ct),Ue=Ve.index+Ct.length}return Ue<ft.length&&Ne.push(ft.slice(Ue)),Ne}function p(ft,oe=!0){if(ft.Regex!==void 0){let Ne=ft.Regex.replace(/\\([#&~])/g,"$1");for(const[Ue,Ve]of A)Ne=Ne.replaceAll(Ue,Ve);return new RegExp(Ne,"gu")}else if(ft.String!==void 0){const Ne=(0,r.escapeRegExp)(ft.String);return new RegExp(oe?Ne:`(${Ne})`,"gu")}else return console.warn("Unknown pattern type:",ft),null}function g(ft){return new Map(Object.entries(ft))}function b(ft){const oe=ft.dims;switch(oe.length){case 1:return ft.tolist();case 2:if(oe[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return ft.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${oe.length}.`)}}function v(ft){return ft.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function w(ft){return ft.replace(new RegExp("\\p{M}","gu"),"")}function x(ft){return w(ft.toLowerCase())}function S(ft){return ft>=19968&&ft<=40959||ft>=13312&&ft<=19903||ft>=131072&&ft<=173791||ft>=173824&&ft<=177983||ft>=177984&&ft<=178207||ft>=178208&&ft<=183983||ft>=63744&&ft<=64255||ft>=194560&&ft<=195103}function C(ft,oe,Ne){const Ue=[];let Ve=0;for(;Ve<ft.length;){if(Ue.push(ft[Ve]),(oe.get(ft[Ve])??Ne)!==Ne){++Ve;continue}for(;++Ve<ft.length&&(oe.get(ft[Ve])??Ne)===Ne;)oe.get(Ue.at(-1))!==Ne&&(Ue[Ue.length-1]+=ft[Ve])}return Ue}function M(ft){return ft.match(/\S+/g)||[]}const k="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",E=new RegExp(`^[${k}]+$`,"gu"),I=".,!?",A=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],["(?i:[sdmt]|ll|ve|re)","(?:[sS]|[dD]|[mM]|[tT]|[lL][lL]|[vV][eE]|[rR][eE])"],["[^\\r\\n\\p{L}\\p{N}]?+","[^\\r\\n\\p{L}\\p{N}]?"],["[^\\s\\p{L}\\p{N}]++","[^\\s\\p{L}\\p{N}]+"],[` ?[^(\\s|[${I}])]+`,` ?[^\\s${I}]+`]]);class D{constructor(oe){this.content=oe.content,this.id=oe.id,this.single_word=oe.single_word??!1,this.lstrip=oe.lstrip??!1,this.rstrip=oe.rstrip??!1,this.special=oe.special??!1,this.normalized=oe.normalized??null}}class L extends s.Callable{constructor(oe){super(),this.config=oe,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(oe,...Ne){switch(oe.type){case"WordPiece":return new P(oe);case"Unigram":return new j(oe,...Ne);case"BPE":return new q(oe);default:if(oe.vocab)return Array.isArray(oe.vocab)?new j(oe,...Ne):Object.hasOwn(oe,"continuing_subword_prefix")&&Object.hasOwn(oe,"unk_token")?Object.hasOwn(oe,"merges")?new q(oe):new P(oe):new te(oe,...Ne);throw new Error(`Unknown TokenizerModel type: ${oe.type}`)}}_call(oe){return oe=this.encode(oe),this.fuse_unk&&(oe=C(oe,this.tokens_to_ids,this.unk_token_id)),oe}encode(oe){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(oe){return oe.map(Ne=>this.tokens_to_ids.get(Ne)??this.unk_token_id)}convert_ids_to_tokens(oe){return oe.map(Ne=>this.vocab[Ne]??this.unk_token)}}class P extends L{constructor(oe){super(oe),this.tokens_to_ids=g(oe.vocab),this.unk_token_id=this.tokens_to_ids.get(oe.unk_token),this.unk_token=oe.unk_token,this.max_input_chars_per_word=oe.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[Ne,Ue]of this.tokens_to_ids)this.vocab[Ue]=Ne}encode(oe){const Ne=[];for(const Ue of oe){const Ve=[...Ue];if(Ve.length>this.max_input_chars_per_word){Ne.push(this.unk_token);continue}let Ct=!1,Rt=0;const wn=[];for(;Rt<Ve.length;){let bn=Ve.length,_n=null;for(;Rt<bn;){let mn=Ve.slice(Rt,bn).join("");if(Rt>0&&(mn=this.config.continuing_subword_prefix+mn),this.tokens_to_ids.has(mn)){_n=mn;break}--bn}if(_n===null){Ct=!0;break}wn.push(_n),Rt=bn}Ct?Ne.push(this.unk_token):Ne.push(...wn)}return Ne}}class j extends L{constructor(oe,Ne){super(oe);const Ue=oe.vocab.length;this.vocab=new Array(Ue),this.scores=new Array(Ue);for(let Ve=0;Ve<Ue;++Ve)[this.vocab[Ve],this.scores[Ve]]=oe.vocab[Ve];this.unk_token_id=oe.unk_id,this.unk_token=this.vocab[oe.unk_id],this.tokens_to_ids=new Map(this.vocab.map((Ve,Ct)=>[Ve,Ct])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=Ne.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,o.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new c.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(oe){const Ne=oe.chars,Ue=1;let Ve=0;for(;Ve<Ne.length;){let Ct=!1;const Rt=Ne.slice(Ve).join(""),wn=this.trie.commonPrefixSearch(Rt);for(const bn of wn){const _n=this.tokens_to_ids.get(bn),mn=this.scores[_n],ls=(0,r.len)(bn);oe.insert(Ve,ls,mn,_n),!Ct&&ls===Ue&&(Ct=!0)}Ct||oe.insert(Ve,Ue,this.unk_score,this.unk_token_id),Ve+=Ue}}tokenize(oe){const Ne=new c.TokenLattice(oe,this.bos_token_id,this.eos_token_id);return this.populateNodes(Ne),Ne.tokens()}encode(oe){const Ne=[];for(const Ue of oe){const Ve=this.tokenize(Ue);Ne.push(...Ve)}return Ne}}const G=(()=>{const ft=[...Array.from({length:94},(Ve,Ct)=>Ct+33),...Array.from({length:12},(Ve,Ct)=>Ct+161),...Array.from({length:82},(Ve,Ct)=>Ct+174)],oe=ft.slice();let Ne=0;for(let Ve=0;Ve<256;++Ve)ft.includes(Ve)||(ft.push(Ve),oe.push(256+Ne),Ne+=1);const Ue=oe.map(Ve=>String.fromCharCode(Ve));return Object.fromEntries(ft.map((Ve,Ct)=>[Ve,Ue[Ct]]))})(),Q=(0,r.reverseDictionary)(G);class q extends L{constructor(oe){super(oe),this.tokens_to_ids=g(oe.vocab),this.unk_token_id=this.tokens_to_ids.get(oe.unk_token),this.unk_token=oe.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[Ue,Ve]of this.tokens_to_ids)this.vocab[Ve]=Ue;const Ne=Array.isArray(oe.merges[0]);this.merges=Ne?oe.merges:oe.merges.map(Ue=>Ue.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((Ue,Ve)=>[JSON.stringify(Ue),Ve])),this.end_of_word_suffix=oe.end_of_word_suffix,this.continuing_subword_suffix=oe.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new c.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(oe){if(oe.length===0)return[];const Ne=this.cache.get(oe);if(Ne!==void 0)return Ne;const Ue=Array.from(oe);this.end_of_word_suffix&&(Ue[Ue.length-1]+=this.end_of_word_suffix);let Ve=[];if(Ue.length>1){const Ct=new c.PriorityQueue((bn,_n)=>bn.score<_n.score);let Rt={token:Ue[0],bias:0,prev:null,next:null},wn=Rt;for(let bn=1;bn<Ue.length;++bn){const _n={bias:bn/Ue.length,token:Ue[bn],prev:wn,next:null};wn.next=_n,this._add_node(Ct,wn),wn=_n}for(;!Ct.isEmpty();){const bn=Ct.pop();if(bn.deleted||!bn.next||bn.next.deleted)continue;if(bn.deleted=!0,bn.next.deleted=!0,bn.prev){const mn={...bn.prev};bn.prev.deleted=!0,bn.prev=mn,mn.prev?mn.prev.next=mn:Rt=mn}const _n={token:bn.token+bn.next.token,bias:bn.bias,prev:bn.prev,next:bn.next.next};_n.prev?(_n.prev.next=_n,this._add_node(Ct,_n.prev)):Rt=_n,_n.next&&(_n.next.prev=_n,this._add_node(Ct,_n))}for(let bn=Rt;bn!==null;bn=bn.next)Ve.push(bn.token)}else Ve=Ue;if(this.continuing_subword_suffix)for(let Ct=0;Ct<Ve.length-1;++Ct)Ve[Ct]+=this.continuing_subword_suffix;return oe.length<this.max_length_to_cache&&this.cache.put(oe,Ve),Ve}_add_node(oe,Ne){const Ue=this.bpe_ranks.get(JSON.stringify([Ne.token,Ne.next.token]));Ue!==void 0&&(Ne.score=Ue+Ne.bias,oe.push(Ne))}encode(oe){const Ne=[];for(const Ue of oe){if(this.ignore_merges&&this.tokens_to_ids.has(Ue)){Ne.push(Ue);continue}const Ve=this.bpe(Ue);for(const Ct of Ve)if(this.tokens_to_ids.has(Ct))Ne.push(Ct);else if(this.byte_fallback){const Rt=Array.from(this.text_encoder.encode(Ct)).map(wn=>`<0x${wn.toString(16).toUpperCase().padStart(2,"0")}>`);Rt.every(wn=>this.tokens_to_ids.has(wn))?Ne.push(...Rt):Ne.push(this.unk_token)}else Ne.push(this.unk_token)}return Ne}}class te extends L{constructor(oe,Ne){super(oe),this.tokens_to_ids=g(Ne.target_lang?oe.vocab[Ne.target_lang]:oe.vocab),this.bos_token=Ne.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=Ne.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=Ne.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=Ne.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[Ue,Ve]of this.tokens_to_ids)this.vocab[Ve]=Ue}encode(oe){return oe}}class Z extends s.Callable{constructor(oe){super(),this.config=oe}static fromConfig(oe){if(oe===null)return null;switch(oe.type){case"BertNormalizer":return new Me(oe);case"Precompiled":return new Nn(oe);case"Sequence":return new Se(oe);case"Replace":return new ne(oe);case"NFC":return new H(oe);case"NFD":return new R(oe);case"NFKC":return new B(oe);case"NFKD":return new W(oe);case"Strip":return new se(oe);case"StripAccents":return new ue(oe);case"Lowercase":return new ge(oe);case"Prepend":return new Ce(oe);default:throw new Error(`Unknown Normalizer type: ${oe.type}`)}}normalize(oe){throw Error("normalize should be implemented in subclass.")}_call(oe){return this.normalize(oe)}}class ne extends Z{normalize(oe){const Ne=p(this.config.pattern);return Ne===null?oe:oe.replaceAll(Ne,this.config.content)}}class le extends Z{form=void 0;normalize(oe){return oe=oe.normalize(this.form),oe}}class H extends le{form="NFC"}class R extends le{form="NFD"}class B extends le{form="NFKC"}class W extends le{form="NFKD"}class se extends Z{normalize(oe){return this.config.strip_left&&this.config.strip_right?oe=oe.trim():(this.config.strip_left&&(oe=oe.trimStart()),this.config.strip_right&&(oe=oe.trimEnd())),oe}}class ue extends Z{normalize(oe){return oe=w(oe),oe}}class ge extends Z{normalize(oe){return oe=oe.toLowerCase(),oe}}class Ce extends Z{normalize(oe){return oe=this.config.prepend+oe,oe}}class Se extends Z{constructor(oe){super(oe),this.normalizers=oe.normalizers.map(Ne=>Z.fromConfig(Ne))}normalize(oe){return this.normalizers.reduce((Ne,Ue)=>Ue.normalize(Ne),oe)}}class Me extends Z{_tokenize_chinese_chars(oe){const Ne=[];for(let Ue=0;Ue<oe.length;++Ue){const Ve=oe[Ue],Ct=Ve.charCodeAt(0);S(Ct)?(Ne.push(" "),Ne.push(Ve),Ne.push(" ")):Ne.push(Ve)}return Ne.join("")}stripAccents(oe){return oe.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(oe){switch(oe){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(oe)}}_clean_text(oe){const Ne=[];for(const Ue of oe){const Ve=Ue.charCodeAt(0);Ve===0||Ve===65533||this._is_control(Ue)||(/^\s$/.test(Ue)?Ne.push(" "):Ne.push(Ue))}return Ne.join("")}normalize(oe){return this.config.clean_text&&(oe=this._clean_text(oe)),this.config.handle_chinese_chars&&(oe=this._tokenize_chinese_chars(oe)),this.config.lowercase?(oe=oe.toLowerCase(),this.config.strip_accents!==!1&&(oe=this.stripAccents(oe))):this.config.strip_accents&&(oe=this.stripAccents(oe)),oe}}class pe extends s.Callable{static fromConfig(oe){if(oe===null)return null;switch(oe.type){case"BertPreTokenizer":return new fe(oe);case"Sequence":return new Dn(oe);case"Whitespace":return new gr(oe);case"WhitespaceSplit":return new os(oe);case"Metaspace":return new En(oe);case"ByteLevel":return new $e(oe);case"Split":return new We(oe);case"Punctuation":return new de(oe);case"Digits":return new Be(oe);case"Replace":return new ps(oe);case"FixedLength":return new Ss(oe);default:throw new Error(`Unknown PreTokenizer type: ${oe.type}`)}}pre_tokenize_text(oe,Ne){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(oe,Ne){return(Array.isArray(oe)?oe.map(Ue=>this.pre_tokenize_text(Ue,Ne)):this.pre_tokenize_text(oe,Ne)).flat()}_call(oe,Ne){return this.pre_tokenize(oe,Ne)}}class fe extends pe{constructor(oe){super(),this.pattern=new RegExp(`[^\\s${k}]+|[${k}]`,"gu")}pre_tokenize_text(oe,Ne){return oe.trim().match(this.pattern)||[]}}class $e extends pe{constructor(oe){super(),this.config=oe,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=G,this.text_encoder=new TextEncoder}pre_tokenize_text(oe,Ne){return this.add_prefix_space&&!oe.startsWith(" ")&&(oe=" "+oe),(this.use_regex?oe.match(this.pattern)||[]:[oe]).map(Ve=>Array.from(this.text_encoder.encode(Ve),Ct=>this.byte_encoder[Ct]).join(""))}}class We extends pe{constructor(oe){super(),this.config=oe,this.pattern=p(this.config.pattern,this.config.invert)}pre_tokenize_text(oe,Ne){return this.pattern===null?[]:this.config.invert?oe.match(this.pattern)||[]:this.config.behavior?.toLowerCase()==="removed"?oe.split(this.pattern).filter(Ue=>Ue):h(oe,this.pattern)}}class de extends pe{constructor(oe){super(),this.config=oe,this.pattern=new RegExp(`[^${k}]+|[${k}]+`,"gu")}pre_tokenize_text(oe,Ne){return oe.match(this.pattern)||[]}}class Be extends pe{constructor(oe){super(),this.config=oe;const Ne=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(Ne,"gu")}pre_tokenize_text(oe,Ne){return oe.match(this.pattern)||[]}}class st extends s.Callable{constructor(oe){super(),this.config=oe}static fromConfig(oe){if(oe===null)return null;switch(oe.type){case"TemplateProcessing":return new Ke(oe);case"ByteLevel":return new Ze(oe);case"RobertaProcessing":return new Xe(oe);case"BertProcessing":return new He(oe);case"Sequence":return new xt(oe);default:throw new Error(`Unknown PostProcessor type: ${oe.type}`)}}post_process(oe,...Ne){throw Error("post_process should be implemented in subclass.")}_call(oe,...Ne){return this.post_process(oe,...Ne)}}class He extends st{constructor(oe){super(oe),this.cls=oe.cls[0],this.sep=oe.sep[0]}post_process(oe,Ne=null,{add_special_tokens:Ue=!0}={}){Ue&&(oe=(0,r.mergeArrays)([this.cls],oe,[this.sep]));let Ve=new Array(oe.length).fill(0);if(Ne!==null){const Ct=Ue&&this instanceof Xe?[this.sep]:[],Rt=Ue?[this.sep]:[];oe=(0,r.mergeArrays)(oe,Ct,Ne,Rt),Ve=(0,r.mergeArrays)(Ve,new Array(Ne.length+Ct.length+Rt.length).fill(1))}return{tokens:oe,token_type_ids:Ve}}}class Xe extends He{}class Ke extends st{constructor(oe){super(oe),this.single=oe.single,this.pair=oe.pair}post_process(oe,Ne=null,{add_special_tokens:Ue=!0}={}){const Ve=Ne===null?this.single:this.pair;let Ct=[],Rt=[];for(const wn of Ve)"SpecialToken"in wn?Ue&&(Ct.push(wn.SpecialToken.id),Rt.push(wn.SpecialToken.type_id)):"Sequence"in wn&&(wn.Sequence.id==="A"?(Ct=(0,r.mergeArrays)(Ct,oe),Rt=(0,r.mergeArrays)(Rt,new Array(oe.length).fill(wn.Sequence.type_id))):wn.Sequence.id==="B"&&(Ct=(0,r.mergeArrays)(Ct,Ne),Rt=(0,r.mergeArrays)(Rt,new Array(Ne.length).fill(wn.Sequence.type_id))));return{tokens:Ct,token_type_ids:Rt}}}class Ze extends st{post_process(oe,Ne=null){return Ne&&(oe=(0,r.mergeArrays)(oe,Ne)),{tokens:oe}}}class xt extends st{constructor(oe){super(oe),this.processors=oe.processors.map(Ne=>st.fromConfig(Ne))}post_process(oe,Ne=null,Ue={}){let Ve;for(const Ct of this.processors)if(Ct instanceof Ze)oe=Ct.post_process(oe).tokens,Ne&&(Ne=Ct.post_process(Ne).tokens);else{const Rt=Ct.post_process(oe,Ne,Ue);oe=Rt.tokens,Ve=Rt.token_type_ids}return{tokens:oe,token_type_ids:Ve}}}class dt extends s.Callable{constructor(oe){super(),this.config=oe,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=oe.trim_offsets}static fromConfig(oe){if(oe===null)return null;switch(oe.type){case"WordPiece":return new At(oe);case"Metaspace":return new Vn(oe);case"ByteLevel":return new ht(oe);case"Replace":return new Ft(oe);case"ByteFallback":return new It(oe);case"Fuse":return new Bt(oe);case"Strip":return new Gt(oe);case"Sequence":return new Xt(oe);case"CTC":return new Qt(oe);case"BPEDecoder":return new us(oe);default:throw new Error(`Unknown Decoder type: ${oe.type}`)}}_call(oe){return this.decode(oe)}decode(oe){return this.decode_chain(oe).join("")}decode_chain(oe){throw Error("`decode_chain` should be implemented in subclass.")}}class Ft extends dt{decode_chain(oe){const Ne=p(this.config.pattern);return Ne===null?oe:oe.map(Ue=>Ue.replaceAll(Ne,this.config.content))}}class It extends dt{constructor(oe){super(oe),this.text_decoder=new TextDecoder}decode_chain(oe){const Ne=[];let Ue=[];for(const Ve of oe){let Ct=null;if(Ve.length===6&&Ve.startsWith("<0x")&&Ve.endsWith(">")){const Rt=parseInt(Ve.slice(3,5),16);isNaN(Rt)||(Ct=Rt)}if(Ct!==null)Ue.push(Ct);else{if(Ue.length>0){const Rt=this.text_decoder.decode(Uint8Array.from(Ue));Ne.push(Rt),Ue=[]}Ne.push(Ve)}}if(Ue.length>0){const Ve=this.text_decoder.decode(Uint8Array.from(Ue));Ne.push(Ve),Ue=[]}return Ne}}class Bt extends dt{decode_chain(oe){return[oe.join("")]}}class Gt extends dt{constructor(oe){super(oe),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(oe){return oe.map(Ne=>{let Ue=0;for(let Ct=0;Ct<this.start&&Ne[Ct]===this.content;++Ct){Ue=Ct+1;continue}let Ve=Ne.length;for(let Ct=0;Ct<this.stop;++Ct){const Rt=Ne.length-Ct-1;if(Ne[Rt]===this.content){Ve=Rt;continue}else break}return Ne.slice(Ue,Ve)})}}class At extends dt{constructor(oe){super(oe),this.cleanup=oe.cleanup}decode_chain(oe){return oe.map((Ne,Ue)=>(Ue!==0&&(Ne.startsWith(this.config.prefix)?Ne=Ne.replace(this.config.prefix,""):Ne=" "+Ne),this.cleanup&&(Ne=v(Ne)),Ne))}}class ht extends dt{constructor(oe){super(oe),this.byte_decoder=Q,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(oe){const Ne=oe.join(""),Ue=new Uint8Array([...Ne].map(Ct=>this.byte_decoder[Ct]));return this.text_decoder.decode(Ue)}decode_chain(oe){const Ne=[];let Ue=[];for(const Ve of oe)this.added_tokens.find(Ct=>Ct.content===Ve)!==void 0?(Ue.length>0&&(Ne.push(this.convert_tokens_to_string(Ue)),Ue=[]),Ne.push(Ve)):Ue.push(Ve);return Ue.length>0&&Ne.push(this.convert_tokens_to_string(Ue)),Ne}}class Qt extends dt{constructor(oe){super(oe),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(oe){if(oe.length===0)return"";const Ne=[oe[0]];for(let Ct=1;Ct<oe.length;++Ct)oe[Ct]!==Ne.at(-1)&&Ne.push(oe[Ct]);let Ve=Ne.filter(Ct=>Ct!==this.pad_token).join("");return this.cleanup&&(Ve=v(Ve).replaceAll(this.word_delimiter_token," ").trim()),Ve}decode_chain(oe){return[this.convert_tokens_to_string(oe)]}}class Xt extends dt{constructor(oe){super(oe),this.decoders=oe.decoders.map(Ne=>dt.fromConfig(Ne))}decode_chain(oe){return this.decoders.reduce((Ne,Ue)=>Ue.decode_chain(Ne),oe)}}class us extends dt{constructor(oe){super(oe),this.suffix=this.config.suffix}decode_chain(oe){return oe.map((Ne,Ue)=>Ne.replaceAll(this.suffix,Ue===oe.length-1?"":" "))}}class yn extends dt{decode_chain(oe){let Ne="";for(let Ue=1;Ue<oe.length;Ue+=2)Ne+=oe[Ue];return[Ne]}}class En extends pe{constructor(oe){super(),this.replacement=oe.replacement,this.strRep=oe.str_rep||this.replacement,this.prepend_scheme=oe.prepend_scheme??"always"}pre_tokenize_text(oe,{section_index:Ne=void 0}={}){let Ue=oe.replaceAll(" ",this.strRep);return!Ue.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&Ne===0)&&(Ue=this.strRep+Ue),[Ue]}}class Vn extends dt{constructor(oe){super(oe),this.replacement=oe.replacement}decode_chain(oe){const Ne=[];for(let Ue=0;Ue<oe.length;++Ue){let Ve=oe[Ue].replaceAll(this.replacement," ");Ue==0&&Ve.startsWith(" ")&&(Ve=Ve.substring(1)),Ne.push(Ve)}return Ne}}class Nn extends Z{constructor(oe){super(oe),this.charsmap=oe.precompiled_charsmap}normalize(oe){return oe=oe.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),oe=oe.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),oe.includes("")?oe=oe.split("").map(Ue=>Ue.normalize("NFKC")).join(""):oe=oe.normalize("NFKC"),oe}}class Dn extends pe{constructor(oe){super(),this.tokenizers=oe.pretokenizers.map(Ne=>pe.fromConfig(Ne))}pre_tokenize_text(oe,Ne){return this.tokenizers.reduce((Ue,Ve)=>Ve.pre_tokenize(Ue,Ne),[oe])}}class gr extends pe{constructor(oe){super()}pre_tokenize_text(oe,Ne){return oe.match(/\w+|[^\w\s]+/g)||[]}}class os extends pe{constructor(oe){super()}pre_tokenize_text(oe,Ne){return M(oe)}}class ps extends pe{constructor(oe){super(),this.config=oe,this.pattern=p(this.config.pattern),this.content=this.config.content}pre_tokenize_text(oe,Ne){return this.pattern===null?[oe]:[oe.replaceAll(this.pattern,this.config.content)]}}class Ss extends pe{constructor(oe){super(),this._length=oe.length}pre_tokenize_text(oe,Ne){const Ue=[];for(let Ve=0;Ve<oe.length;Ve+=this._length)Ue.push(oe.slice(Ve,Ve+this._length));return Ue}}const Qn=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function On(ft,oe,Ne,Ue){for(const Ve of Object.keys(ft)){const Ct=oe-ft[Ve].length,Rt=Ne(Ve),wn=new Array(Ct).fill(Rt);ft[Ve]=Ue==="right"?(0,r.mergeArrays)(ft[Ve],wn):(0,r.mergeArrays)(wn,ft[Ve])}}function Mt(ft,oe){for(const Ne of Object.keys(ft))ft[Ne].length=oe}class sn extends s.Callable{return_token_type_ids=!1;padding_side="right";constructor(oe,Ne){super(),this.config=Ne,this.normalizer=Z.fromConfig(oe.normalizer),this.pre_tokenizer=pe.fromConfig(oe.pre_tokenizer),this.model=L.fromConfig(oe.model,Ne),this.post_processor=st.fromConfig(oe.post_processor),this.decoder=dt.fromConfig(oe.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const Ue of oe.added_tokens){const Ve=new D(Ue);this.added_tokens.push(Ve),this.model.tokens_to_ids.set(Ve.content,Ve.id),this.model.vocab[Ve.id]=Ve.content,Ve.special&&(this.special_tokens.push(Ve.content),this.all_special_ids.push(Ve.id))}if(this.additional_special_tokens=Ne.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new c.DictionarySplitter(this.added_tokens.map(Ue=>Ue.content)),this.added_tokens_map=new Map(this.added_tokens.map(Ue=>[Ue.content,Ue])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=Ne.model_max_length,this.remove_space=Ne.remove_space,this.clean_up_tokenization_spaces=Ne.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=Ne.do_lowercase_and_remove_accent??!1,Ne.padding_side&&(this.padding_side=Ne.padding_side),this.add_bos_token=Ne.add_bos_token,this.add_eos_token=Ne.add_eos_token,this.legacy=!1,this.chat_template=Ne.chat_template??null,Array.isArray(this.chat_template)){const Ue=Object.create(null);for(const{name:Ve,template:Ct}of this.chat_template){if(typeof Ve!="string"||typeof Ct!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');Ue[Ve]=Ct}this.chat_template=Ue}this._compiled_template_cache=new Map}getToken(...oe){for(const Ne of oe){const Ue=this.config[Ne];if(Ue)if(typeof Ue=="object"){if(Ue.__type==="AddedToken")return Ue.content;throw Error(`Unknown token: ${Ue}`)}else return Ue}return null}static async from_pretrained(oe,{progress_callback:Ne=null,config:Ue=null,cache_dir:Ve=null,local_files_only:Ct=!1,revision:Rt="main",legacy:wn=null}={}){const bn=await d(oe,{progress_callback:Ne,config:Ue,cache_dir:Ve,local_files_only:Ct,revision:Rt,legacy:wn});return new this(...bn)}_call(oe,{text_pair:Ne=null,add_special_tokens:Ue=!0,padding:Ve=!1,truncation:Ct=null,max_length:Rt=null,return_tensor:wn=!0,return_token_type_ids:bn=null}={}){const _n=Array.isArray(oe);let mn;if(_n){if(oe.length===0)throw Error("text array must be non-empty");if(Ne!==null){if(Array.isArray(Ne)){if(oe.length!==Ne.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");mn=oe.map((ds,Ar)=>this._encode_plus(ds,{text_pair:Ne[Ar],add_special_tokens:Ue,return_token_type_ids:bn}))}else mn=oe.map(ds=>this._encode_plus(ds,{add_special_tokens:Ue,return_token_type_ids:bn}))}else{if(oe==null)throw Error("text may not be null or undefined");if(Array.isArray(Ne))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");mn=[this._encode_plus(oe,{text_pair:Ne,add_special_tokens:Ue,return_token_type_ids:bn})]}if(Rt===null?Rt=this.model_max_length:Ct===null&&(Ve===!0?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),Rt=this.model_max_length):Ve===!1&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),Ct=!0)),Ve===!0&&(Rt=Math.min((0,o.max)(mn.map(ds=>ds.input_ids.length))[0],Rt??1/0)),Rt=Math.min(Rt,this.model_max_length??1/0),Ve||Ct)for(let ds=0;ds<mn.length;++ds)mn[ds].input_ids.length!==Rt&&(mn[ds].input_ids.length>Rt?Ct&&Mt(mn[ds],Rt):Ve&&On(mn[ds],Rt,Ar=>Ar==="input_ids"?this.pad_token_id:0,this.padding_side));const ls={};if(wn){if(!(Ve&&Ct)&&mn.some(Ar=>{for(const Ci of Object.keys(Ar))if(Ar[Ci].length!==mn[0][Ci]?.length)return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const ds=[mn.length,mn[0].input_ids.length];for(const Ar of Object.keys(mn[0]))ls[Ar]=new l.Tensor("int64",BigInt64Array.from(mn.flatMap(Ci=>Ci[Ar]).map(BigInt)),ds)}else{for(const ds of Object.keys(mn[0]))ls[ds]=mn.map(Ar=>Ar[ds]);if(!_n)for(const ds of Object.keys(ls))ls[ds]=ls[ds][0]}return ls}_encode_text(oe){if(oe===null)return null;const Ne=this.added_tokens_splitter.split(oe);for(let Ve=0;Ve<Ne.length;++Ve){const Ct=this.added_tokens_map.get(Ne[Ve]);Ct&&(Ct.lstrip&&Ve>0&&(Ne[Ve-1]=Ne[Ve-1].trimEnd()),Ct.rstrip&&Ve<Ne.length-1&&(Ne[Ve+1]=Ne[Ve+1].trimStart()))}return Ne.flatMap((Ve,Ct)=>{if(Ve.length===0)return[];if(this.added_tokens_map.has(Ve))return[Ve];if(this.remove_space===!0&&(Ve=Ve.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(Ve=x(Ve)),this.normalizer!==null&&(Ve=this.normalizer(Ve)),Ve.length===0)return[];const Rt=this.pre_tokenizer!==null?this.pre_tokenizer(Ve,{section_index:Ct}):[Ve];return this.model(Rt)})}_encode_plus(oe,{text_pair:Ne=null,add_special_tokens:Ue=!0,return_token_type_ids:Ve=null}={}){const{tokens:Ct,token_type_ids:Rt}=this._tokenize_helper(oe,{pair:Ne,add_special_tokens:Ue}),wn=this.model.convert_tokens_to_ids(Ct),bn={input_ids:wn,attention_mask:new Array(wn.length).fill(1)};return(Ve??this.return_token_type_ids)&&Rt&&(bn.token_type_ids=Rt),bn}_tokenize_helper(oe,{pair:Ne=null,add_special_tokens:Ue=!1}={}){const Ve=this._encode_text(oe),Ct=this._encode_text(Ne);return this.post_processor?this.post_processor(Ve,Ct,{add_special_tokens:Ue}):{tokens:(0,r.mergeArrays)(Ve??[],Ct??[])}}tokenize(oe,{pair:Ne=null,add_special_tokens:Ue=!1}={}){return this._tokenize_helper(oe,{pair:Ne,add_special_tokens:Ue}).tokens}encode(oe,{text_pair:Ne=null,add_special_tokens:Ue=!0,return_token_type_ids:Ve=null}={}){return this._encode_plus(oe,{text_pair:Ne,add_special_tokens:Ue,return_token_type_ids:Ve}).input_ids}batch_decode(oe,Ne={}){return oe instanceof l.Tensor&&(oe=oe.tolist()),oe.map(Ue=>this.decode(Ue,Ne))}decode(oe,Ne={}){if(oe instanceof l.Tensor&&(oe=b(oe)),!Array.isArray(oe)||oe.length===0||!(0,r.isIntegralNumber)(oe[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(oe,Ne)}decode_single(oe,{skip_special_tokens:Ne=!1,clean_up_tokenization_spaces:Ue=null}){let Ve=this.model.convert_ids_to_tokens(oe);Ne&&(Ve=Ve.filter(Rt=>!this.special_tokens.includes(Rt)));let Ct=this.decoder?this.decoder(Ve):Ve.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(Ct=Ct.replaceAll(this.decoder.end_of_word_suffix," "),Ne&&(Ct=Ct.trim())),(Ue??this.clean_up_tokenization_spaces)&&(Ct=v(Ct)),Ct}get_chat_template({chat_template:oe=null,tools:Ne=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const Ue=this.chat_template;if(oe!==null&&Object.hasOwn(Ue,oe))oe=Ue[oe];else if(oe===null)if(Ne!==null&&"tool_use"in Ue)oe=Ue.tool_use;else if("default"in Ue)oe=Ue.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(Ue).sort()}.`)}else if(oe===null)if(this.chat_template)oe=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return oe}apply_chat_template(oe,{tools:Ne=null,documents:Ue=null,chat_template:Ve=null,add_generation_prompt:Ct=!1,tokenize:Rt=!0,padding:wn=!1,truncation:bn=!1,max_length:_n=null,return_tensor:mn=!0,return_dict:ls=!1,tokenizer_kwargs:ds={},...Ar}={}){if(Ve=this.get_chat_template({chat_template:Ve,tools:Ne}),typeof Ve!="string")throw Error(`chat_template must be a string, but got ${typeof Ve}`);let Ci=this._compiled_template_cache.get(Ve);Ci===void 0&&(Ci=new u.Template(Ve),this._compiled_template_cache.set(Ve,Ci));const Sr=Object.create(null);for(const Lr of Qn){const wo=this.getToken(Lr);wo&&(Sr[Lr]=wo)}const An=Ci.render({messages:oe,add_generation_prompt:Ct,tools:Ne,documents:Ue,...Sr,...Ar});if(Rt){const Lr=this._call(An,{add_special_tokens:!1,padding:wn,truncation:bn,max_length:_n,return_tensor:mn,...ds});return ls?Lr:Lr.input_ids}return An}}class Tn extends sn{return_token_type_ids=!0}class ai extends sn{return_token_type_ids=!0}class ir extends sn{return_token_type_ids=!0}class Fn extends sn{return_token_type_ids=!0}class fs extends sn{return_token_type_ids=!0}class ro extends sn{return_token_type_ids=!0}class re extends sn{return_token_type_ids=!0}class Pe extends sn{return_token_type_ids=!0}class ve extends sn{return_token_type_ids=!0}class Oe extends sn{}class ze extends sn{}class ut extends sn{return_token_type_ids=!0;constructor(oe,Ne){super(oe,Ne),console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class Et extends sn{return_token_type_ids=!0}class rn extends sn{}class xn extends sn{}class un extends sn{}class Gn extends sn{constructor(oe,Ne){super(oe,Ne),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(Ue=>this.languageRegex.test(Ue)),this.lang_to_token=Ue=>Ue}_build_translation_inputs(oe,Ne,Ue){return pi(this,oe,Ne,Ue)}}class hn extends Gn{}class vs extends sn{}class _s extends sn{}const Vr="";class Yr extends sn{padding_side="left";constructor(oe,Ne){super(oe,Ne),this.legacy=Ne.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new En({replacement:Vr,prepend_scheme:"first"}))}_encode_text(oe){if(oe===null)return null;if(this.legacy||oe.length===0)return super._encode_text(oe);let Ne=super._encode_text(Vr+oe.replaceAll(Vr," "));return Ne.length>1&&Ne[0]===Vr&&this.special_tokens.includes(Ne[1])&&(Ne=Ne.slice(1)),Ne}}class Cr extends sn{}class Kr extends sn{}class sl extends sn{}class Ni extends sn{}class Xr extends sn{}class ka extends sn{}class oi extends sn{}class wa extends sn{}class li extends sn{}function pi(ft,oe,Ne,Ue){if(!("language_codes"in ft)||!Array.isArray(ft.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in ft)||!(ft.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in ft)||typeof ft.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const Ve=Ue.src_lang,Ct=Ue.tgt_lang;if(!ft.language_codes.includes(Ct))throw new Error(`Target language code "${Ct}" is not valid. Must be one of: {${ft.language_codes.join(", ")}}`);if(Ve!==void 0){if(!ft.language_codes.includes(Ve))throw new Error(`Source language code "${Ve}" is not valid. Must be one of: {${ft.language_codes.join(", ")}}`);for(const Rt of ft.post_processor.config.single)if("SpecialToken"in Rt&&ft.languageRegex.test(Rt.SpecialToken.id)){Rt.SpecialToken.id=ft.lang_to_token(Ve);break}}return Ue.forced_bos_token_id=ft.model.convert_tokens_to_ids([ft.lang_to_token(Ct)])[0],ft._call(oe,Ne)}class yo extends sn{constructor(oe,Ne){super(oe,Ne),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(Ue=>this.languageRegex.test(Ue)),this.lang_to_token=Ue=>Ue}_build_translation_inputs(oe,Ne,Ue){return pi(this,oe,Ne,Ue)}}class rl extends sn{constructor(oe,Ne){super(oe,Ne),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(Ue=>this.languageRegex.test(Ue)).map(Ue=>Ue.slice(2,-2)),this.lang_to_token=Ue=>`__${Ue}__`}_build_translation_inputs(oe,Ne,Ue){return pi(this,oe,Ne,Ue)}}class Gc extends sn{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(oe,{return_timestamps:Ne=!1,return_language:Ue=!1,time_precision:Ve=null,force_full_sequences:Ct=!0}={}){if(Ve===null)throw Error("Must specify time_precision");let Rt=null;const wn=Ne==="word";function bn(){return{language:Rt,timestamp:[null,null],text:""}}const _n=[];let mn=bn(),ls=0;const ds=this.timestamp_begin,Ci=ds+1500;let Sr=[],An=[],Lr=!1,wo=null;const Ml=new Set(this.all_special_ids);for(const Qr of oe){const mi=Qr.tokens,Wr=wn?Qr.token_timestamps:null;let io=null,Ha=ds;if("stride"in Qr){const[Di,Gr,Qs]=Qr.stride;if(ls-=Gr,wo=Di-Qs,Gr&&(Ha=Gr/Ve+ds),Qs)for(let Nr=mi.length-1;Nr>=0;--Nr){const Oi=Number(mi[Nr]);if(Oi>=ds){if(io!==null&&(Oi-ds)*Ve<wo)break;io=Oi}}}let Yi=[],aa=[];for(let Di=0;Di<mi.length;++Di){const Gr=Number(mi[Di]);if(Ml.has(Gr)){const Qs=this.decode([Gr]),Nr=f.WHISPER_LANGUAGE_MAPPING.get(Qs.slice(2,-2));if(Nr!==void 0){if(Rt!==null&&Nr!==Rt&&!Ne){Sr.push(Yi);const Oi=this.findLongestCommonSequence(Sr)[0],il=this.decode(Oi);mn.text=il,_n.push(mn),Sr=[],Yi=[],mn=bn()}Rt=mn.language=Nr}}else if(Gr>=ds&&Gr<=Ci){const Qs=(Gr-ds)*Ve+ls,Nr=(0,o.round)(Qs,2);if(io!==null&&Gr>=io)Lr=!0;else if(Lr||Sr.length>0&&Gr<Ha)Lr=!1;else if(mn.timestamp[0]===null)mn.timestamp[0]=Nr;else if(Nr!==mn.timestamp[0]){mn.timestamp[1]=Nr,Sr.push(Yi),wn&&An.push(aa);const[Oi,il]=this.findLongestCommonSequence(Sr,An),Tl=this.decode(Oi);mn.text=Tl,wn&&(mn.words=this.collateWordTimestamps(Oi,il,Rt)),_n.push(mn),Sr=[],Yi=[],An=[],aa=[],mn=bn()}}else if(Yi.push(Gr),wn){let Qs=(0,o.round)(Wr[Di]+ls,2),Nr;if(Di+1<Wr.length){Nr=(0,o.round)(Wr[Di+1]+ls,2);const Oi=this.decode([Gr]);E.test(Oi)&&(Nr=(0,o.round)(Math.min(Qs+Ve,Nr),2))}else Nr=null;aa.push([Qs,Nr])}}if("stride"in Qr){const[Di,Gr,Qs]=Qr.stride;ls+=Di-Qs}Yi.length>0?(Sr.push(Yi),wn&&An.push(aa)):Sr.every(Di=>Di.length===0)&&(mn=bn(),Sr=[],Yi=[],An=[],aa=[])}if(Sr.length>0){if(Ct&&Ne)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[Qr,mi]=this.findLongestCommonSequence(Sr,An),Wr=this.decode(Qr);mn.text=Wr,wn&&(mn.words=this.collateWordTimestamps(Qr,mi,Rt)),_n.push(mn)}let Fr=Object.create(null);const Si=_n.map(Qr=>Qr.text).join("");if(Ne||Ue){for(let Qr=0;Qr<_n.length;++Qr){const mi=_n[Qr];Ne||delete mi.timestamp,Ue||delete mi.language}if(wn){const Qr=[];for(const mi of _n)for(const Wr of mi.words)Qr.push(Wr);Fr={chunks:Qr}}else Fr={chunks:_n}}return[Si,Fr]}findLongestCommonSequence(oe,Ne=null){let Ue=oe[0],Ve=Ue.length,Ct=[];const Rt=Array.isArray(Ne)&&Ne.length>0;let wn=Rt?[]:null,bn=Rt?Ne[0]:null;for(let _n=1;_n<oe.length;++_n){const mn=oe[_n];let ls=0,ds=[Ve,Ve,0,0];const Ar=mn.length;for(let Fr=1;Fr<Ve+Ar;++Fr){const Si=Math.max(0,Ve-Fr),Qr=Math.min(Ve,Ve+Ar-Fr),mi=Ue.slice(Si,Qr),Wr=Math.max(0,Fr-Ve),io=Math.min(Ar,Fr),Ha=mn.slice(Wr,io);if(mi.length!==Ha.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let Yi;Rt?Yi=mi.filter((Gr,Qs)=>Gr===Ha[Qs]&&bn[Si+Qs]<=Ne[_n][Wr+Qs]).length:Yi=mi.filter((Gr,Qs)=>Gr===Ha[Qs]).length;const aa=Fr/1e4,Di=Yi/Fr+aa;Yi>1&&Di>ls&&(ls=Di,ds=[Si,Qr,Wr,io])}const[Ci,Sr,An,Lr]=ds,wo=Math.floor((Sr+Ci)/2),Ml=Math.floor((Lr+An)/2);Ct.push(...Ue.slice(0,wo)),Ue=mn.slice(Ml),Ve=Ue.length,Rt&&(wn.push(...bn.slice(0,wo)),bn=Ne[_n].slice(Ml))}return Ct.push(...Ue),Rt?(wn.push(...bn),[Ct,wn]):[Ct,[]]}collateWordTimestamps(oe,Ne,Ue){const[Ve,Ct,Rt]=this.combineTokensIntoWords(oe,Ue),wn=[];for(let bn=0;bn<Ve.length;++bn){const _n=Rt[bn];wn.push({text:Ve[bn],timestamp:[Ne[_n.at(0)][0],Ne[_n.at(-1)][1]]})}return wn}combineTokensIntoWords(oe,Ne,Ue=`"'([{-`,Ve=`"'.,!?:)]}`){Ne=Ne??"english";let Ct,Rt,wn;return["chinese","japanese","thai","lao","myanmar"].includes(Ne)?[Ct,Rt,wn]=this.splitTokensOnUnicode(oe):[Ct,Rt,wn]=this.splitTokensOnSpaces(oe),this.mergePunctuations(Ct,Rt,wn,Ue,Ve)}decode(oe,Ne){let Ue;return Ne?.decode_with_timestamps?(oe instanceof l.Tensor&&(oe=b(oe)),Ue=this.decodeWithTimestamps(oe,Ne)):Ue=super.decode(oe,Ne),Ue}decodeWithTimestamps(oe,Ne){const Ue=Ne?.time_precision??.02,Ve=Array.from(this.all_special_ids).at(-1)+1;let Ct=[[]];for(let Rt of oe)if(Rt=Number(Rt),Rt>=Ve){const wn=((Rt-Ve)*Ue).toFixed(2);Ct.push(`<|${wn}|>`),Ct.push([])}else Ct[Ct.length-1].push(Rt);return Ct=Ct.map(Rt=>typeof Rt=="string"?Rt:super.decode(Rt,Ne)),Ct.join("")}splitTokensOnUnicode(oe){const Ne=this.decode(oe,{decode_with_timestamps:!0}),Ue="",Ve=[],Ct=[],Rt=[];let wn=[],bn=[],_n=0;for(let mn=0;mn<oe.length;++mn){const ls=oe[mn];wn.push(ls),bn.push(mn);const ds=this.decode(wn,{decode_with_timestamps:!0});(!ds.includes(Ue)||Ne[_n+ds.indexOf(Ue)]===Ue)&&(Ve.push(ds),Ct.push(wn),Rt.push(bn),wn=[],bn=[],_n+=ds.length)}return[Ve,Ct,Rt]}splitTokensOnSpaces(oe){const[Ne,Ue,Ve]=this.splitTokensOnUnicode(oe),Ct=[],Rt=[],wn=[],bn=new RegExp(`^[${k}]$`,"gu");for(let _n=0;_n<Ne.length;++_n){const mn=Ne[_n],ls=Ue[_n],ds=Ve[_n],Ar=ls[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),Ci=mn.startsWith(" "),Sr=mn.trim(),An=bn.test(Sr);if(Ar||Ci||An||Ct.length===0)Ct.push(mn),Rt.push(ls),wn.push(ds);else{const Lr=Ct.length-1;Ct[Lr]+=mn,Rt[Lr].push(...ls),wn[Lr].push(...ds)}}return[Ct,Rt,wn]}mergePunctuations(oe,Ne,Ue,Ve,Ct){const Rt=structuredClone(oe),wn=structuredClone(Ne),bn=structuredClone(Ue);let _n=Rt.length-2,mn=Rt.length-1;for(;_n>=0;)Rt[_n].startsWith(" ")&&Ve.includes(Rt[_n].trim())?(Rt[mn]=Rt[_n]+Rt[mn],wn[mn]=(0,r.mergeArrays)(wn[_n],wn[mn]),bn[mn]=(0,r.mergeArrays)(bn[_n],bn[mn]),Rt[_n]="",wn[_n]=[],bn[_n]=[]):mn=_n,--_n;for(_n=0,mn=1;mn<Rt.length;)!Rt[_n].endsWith(" ")&&Ct.includes(Rt[mn])?(Rt[_n]+=Rt[mn],wn[_n]=(0,r.mergeArrays)(wn[_n],wn[mn]),bn[_n]=(0,r.mergeArrays)(bn[_n],bn[mn]),Rt[mn]="",wn[mn]=[],bn[mn]=[]):_n=mn,++mn;return[Rt.filter(ls=>ls),wn.filter(ls=>ls.length>0),bn.filter(ls=>ls.length>0)]}}class va extends sn{}class bo extends sn{}class Wa extends sn{}class Us extends sn{constructor(oe,Ne){super(oe,Ne),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(Ue=>this.languageRegex.test(Ue)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(oe){if(oe===null)return null;const[Ne,...Ue]=oe.trim().split(this.languageRegex);if(Ue.length===0)return super._encode_text(Ne);if(Ue.length===2){const[Ve,Ct]=Ue;return this.supported_language_codes.includes(Ve)||console.warn(`Unsupported language code "${Ve}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,r.mergeArrays)([Ve],super._encode_text(Ct))}}}class Ga extends sn{}class Zt extends sn{}class cn extends sn{}class In extends sn{}class Rs extends sn{}class xi extends sn{constructor(oe,Ne){super(oe,Ne),this.decoder=new yn({})}}class ci extends sn{}class Gl extends sn{}class Of{static TOKENIZER_CLASS_MAPPING={T5Tokenizer:rn,DistilBertTokenizer:Oe,CamembertTokenizer:ze,DebertaTokenizer:fs,DebertaV2Tokenizer:ro,BertTokenizer:Tn,HerbertTokenizer:re,ConvBertTokenizer:Pe,RoFormerTokenizer:ve,XLMTokenizer:ut,ElectraTokenizer:Et,MobileBertTokenizer:ir,SqueezeBertTokenizer:Fn,AlbertTokenizer:ai,GPT2Tokenizer:xn,BartTokenizer:un,MBartTokenizer:Gn,MBart50Tokenizer:hn,RobertaTokenizer:vs,WhisperTokenizer:Gc,CodeGenTokenizer:va,CLIPTokenizer:bo,SiglipTokenizer:Wa,MarianTokenizer:Us,BloomTokenizer:_s,NllbTokenizer:yo,M2M100Tokenizer:rl,LlamaTokenizer:Yr,CodeLlamaTokenizer:Cr,XLMRobertaTokenizer:Kr,MPNetTokenizer:sl,FalconTokenizer:Ni,GPTNeoXTokenizer:Xr,EsmTokenizer:ka,Wav2Vec2CTCTokenizer:Ga,BlenderbotTokenizer:Zt,BlenderbotSmallTokenizer:cn,SpeechT5Tokenizer:In,NougatTokenizer:Rs,VitsTokenizer:xi,Qwen2Tokenizer:oi,GemmaTokenizer:wa,Grok1Tokenizer:li,CohereTokenizer:ci,MgpstrTokenizer:Gl,PreTrainedTokenizer:sn};static async from_pretrained(oe,{progress_callback:Ne=null,config:Ue=null,cache_dir:Ve=null,local_files_only:Ct=!1,revision:Rt="main",legacy:wn=null}={}){const[bn,_n]=await d(oe,{progress_callback:Ne,config:Ue,cache_dir:Ve,local_files_only:Ct,revision:Rt,legacy:wn}),mn=_n.tokenizer_class?.replace(/Fast$/,"")??"PreTrainedTokenizer";let ls=this.TOKENIZER_CLASS_MAPPING[mn];return ls||(console.warn(`Unknown tokenizer class "${mn}", attempting to construct from base class.`),ls=sn),new ls(bn,_n)}}}),"./src/utils/audio.js":((n,e,t)=>{t.r(e),t.d(e,{RawAudio:()=>P,hamming:()=>h,hanning:()=>d,mel_filter_bank:()=>S,read_audio:()=>u,spectrogram:()=>I,window_function:()=>A});var s=t("./src/utils/hub.js"),r=t("./src/utils/maths.js"),a=t("./src/utils/core.js"),o=t("./src/env.js"),l=t("./src/utils/tensor.js"),c=t("?7992");async function u(j,G){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const Q=await(await(0,s.getFile)(j)).arrayBuffer(),q=new AudioContext({sampleRate:G});typeof G>"u"&&console.warn(`No sampling rate provided, using default of ${q.sampleRate}Hz.`);const te=await q.decodeAudioData(Q);let Z;if(te.numberOfChannels===2){const ne=Math.sqrt(2),le=te.getChannelData(0),H=te.getChannelData(1);Z=new Float32Array(le.length);for(let R=0;R<te.length;++R)Z[R]=ne*(le[R]+H[R])/2}else Z=te.getChannelData(0);return Z}function f(j,G){if(j<1)return new Float64Array;if(j===1)return new Float64Array([1]);const Q=1-G,q=2*Math.PI/(j-1),te=new Float64Array(j);for(let Z=0;Z<j;++Z)te[Z]=G-Q*Math.cos(Z*q);return te}function d(j){return f(j,.5)}function h(j){return f(j,.54)}const p={htk:j=>2595*Math.log10(1+j/700),kaldi:j=>1127*Math.log(1+j/700),slaney:(j,G=1e3,Q=15,q=27/Math.log(6.4))=>j>=G?Q+Math.log(j/G)*q:3*j/200};function g(j,G="htk"){const Q=p[G];if(!Q)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof j=="number"?Q(j):j.map(q=>Q(q))}const b={htk:j=>700*(10**(j/2595)-1),kaldi:j=>700*(Math.exp(j/1127)-1),slaney:(j,G=1e3,Q=15,q=Math.log(6.4)/27)=>j>=Q?G*Math.exp(q*(j-Q)):200*j/3};function v(j,G="htk"){const Q=b[G];if(!Q)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof j=="number"?Q(j):j.map(q=>Q(q))}function w(j,G){const Q=Float64Array.from({length:G.length-1},(ne,le)=>G[le+1]-G[le]),q=Array.from({length:j.length},()=>new Array(G.length));for(let ne=0;ne<j.length;++ne){const le=q[ne];for(let H=0;H<G.length;++H)le[H]=G[H]-j[ne]}const te=G.length-2,Z=Array.from({length:te},()=>new Array(j.length));for(let ne=0;ne<j.length;++ne){const le=q[ne];for(let H=0;H<te;++H){const R=-le[H]/Q[H],B=le[H+2]/Q[H+1];Z[H][ne]=Math.max(0,Math.min(R,B))}}return Z}function x(j,G,Q){const q=(G-j)/(Q-1);return Float64Array.from({length:Q},(te,Z)=>j+q*Z)}function S(j,G,Q,q,te,Z=null,ne="htk",le=!1){if(Z!==null&&Z!=="slaney")throw new Error('norm must be one of null or "slaney"');if(j<2)throw new Error(`Require num_frequency_bins: ${j} >= 2`);if(Q>q)throw new Error(`Require min_frequency: ${Q} <= max_frequency: ${q}`);const H=g(Q,ne),R=g(q,ne),B=x(H,R,G+2);let W=v(B,ne),se;if(le){const ge=te/((j-1)*2);se=g(Float64Array.from({length:j},(Ce,Se)=>Se*ge),ne),W=B}else se=x(0,Math.floor(te/2),j);const ue=w(se,W);if(Z!==null&&Z==="slaney")for(let ge=0;ge<G;++ge){const Ce=ue[ge],Se=2/(W[ge+2]-W[ge]);for(let Me=0;Me<j;++Me)Ce[Me]*=Se}return ue}function C(j,G,Q){const q=new j.constructor(j.length+G+Q),te=j.length-1;for(let Z=0;Z<j.length;++Z)q[G+Z]=j[Z];for(let Z=1;Z<=G;++Z)q[G-Z]=j[(0,a.calculateReflectOffset)(Z,te)];for(let Z=1;Z<=Q;++Z)q[te+G+Z]=j[(0,a.calculateReflectOffset)(te-Z,te)];return q}function M(j,G,Q,q,te){if(Q<=0)throw new Error("reference must be greater than zero");if(q<=0)throw new Error("min_value must be greater than zero");Q=Math.max(q,Q);const Z=Math.log10(Q);for(let ne=0;ne<j.length;++ne)j[ne]=G*Math.log10(Math.max(q,j[ne])-Z);if(te!==null){if(te<=0)throw new Error("db_range must be greater than zero");const ne=(0,r.max)(j)[0]-te;for(let le=0;le<j.length;++le)j[le]=Math.max(j[le],ne)}return j}function k(j,G=1,Q=1e-5,q=null){return M(j,20,G,Q,q)}function E(j,G=1,Q=1e-10,q=null){return M(j,10,G,Q,q)}async function I(j,G,Q,q,{fft_length:te=null,power:Z=1,center:ne=!0,pad_mode:le="reflect",onesided:H=!0,preemphasis:R=null,preemphasis_htk_flavor:B=!0,mel_filters:W=null,mel_floor:se=1e-10,log_mel:ue=null,reference:ge=1,min_value:Ce=1e-10,db_range:Se=null,remove_dc_offset:Me=null,min_num_frames:pe=null,max_num_frames:fe=null,do_pad:$e=!0,transpose:We=!1,mel_offset:de=0}={}){const Be=G.length;if(te===null&&(te=Q),Q>te)throw Error(`frame_length (${Q}) may not be larger than fft_length (${te})`);if(Be!==Q)throw new Error(`Length of the window (${Be}) must equal frame_length (${Q})`);if(q<=0)throw new Error("hop_length must be greater than zero");if(Z===null&&W!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!B)throw new Error("`preemphasis_htk_flavor=false` is not currently supported.");if(ne)switch(le){case"reflect":{const At=Math.floor((te-1)/2)+1;j=C(j,At,At);break}case"constant":{const At=Math.floor(te/2),ht=new j.constructor(j.length+2*At);ht.set(j,At),j=ht;break}default:throw new Error(`pad_mode="${le}" not implemented yet.`)}let st=Math.floor(1+Math.floor((j.length-Q)/q));pe!==null&&st<pe&&(st=pe);const He=H?Math.floor(te/2)+1:te;let Xe=st,Ke=st;fe!==null&&(fe>st?$e&&(Ke=fe):Ke=Xe=fe);const Ze=new r.FFT(te),xt=new Float64Array(te),dt=new Float64Array(Ze.outputBufferSize),Ft=new Float32Array(He*Ke);for(let At=0;At<Xe;++At){const ht=At*q,Qt=Math.min(j.length-ht,Q);Qt!==Q&&xt.fill(0,0,Q);for(let Xt=0;Xt<Qt;++Xt)xt[Xt]=j[ht+Xt];if(Me){let Xt=0;for(let yn=0;yn<Qt;++yn)Xt+=xt[yn];const us=Xt/Qt;for(let yn=0;yn<Qt;++yn)xt[yn]-=us}if(R!==null){for(let Xt=Qt-1;Xt>=1;--Xt)xt[Xt]-=R*xt[Xt-1];xt[0]*=1-R}for(let Xt=0;Xt<G.length;++Xt)xt[Xt]*=G[Xt];Ze.realTransform(dt,xt);for(let Xt=0;Xt<He;++Xt){const us=Xt<<1;Ft[Xt*Ke+At]=dt[us]**2+dt[us+1]**2}}if(Z!==null&&Z!==2){const At=Z/2;for(let ht=0;ht<Ft.length;++ht)Ft[ht]**=At}const It=W.length;let Bt=await(0,l.matmul)(new l.Tensor("float32",W.flat(),[It,He]),new l.Tensor("float32",Ft,[He,Ke]));We&&(Bt=Bt.transpose(1,0));const Gt=Bt.data;for(let At=0;At<Gt.length;++At)Gt[At]=de+Math.max(se,Gt[At]);if(Z!==null&&ue!==null){const At=Math.min(Gt.length,Xe*It);switch(ue){case"log":for(let ht=0;ht<At;++ht)Gt[ht]=Math.log(Gt[ht]);break;case"log10":for(let ht=0;ht<At;++ht)Gt[ht]=Math.log10(Gt[ht]);break;case"dB":if(Z===1)k(Gt,ge,Ce,Se);else if(Z===2)E(Gt,ge,Ce,Se);else throw new Error(`Cannot use log_mel option '${ue}' with power ${Z}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${ue}'`)}}return Bt}function A(j,G,{periodic:Q=!0,frame_length:q=null,center:te=!0}={}){const Z=Q?j+1:j;let ne;switch(G){case"boxcar":ne=new Float64Array(Z).fill(1);break;case"hann":case"hann_window":ne=d(Z);break;case"hamming":ne=h(Z);break;case"povey":ne=d(Z).map(le=>Math.pow(le,.85));break;default:throw new Error(`Unknown window type ${G}.`)}if(Q&&(ne=ne.subarray(0,j)),q===null)return ne;if(j>q)throw new Error(`Length of the window (${j}) may not be larger than frame_length (${q})`);return ne}function D(j,G){let Q=44;const q=new ArrayBuffer(Q+j.length*4),te=new DataView(q);L(te,0,"RIFF"),te.setUint32(4,36+j.length*4,!0),L(te,8,"WAVE"),L(te,12,"fmt "),te.setUint32(16,16,!0),te.setUint16(20,3,!0),te.setUint16(22,1,!0),te.setUint32(24,G,!0),te.setUint32(28,G*4,!0),te.setUint16(32,4,!0),te.setUint16(34,32,!0),L(te,36,"data"),te.setUint32(40,j.length*4,!0);for(let Z=0;Z<j.length;++Z,Q+=4)te.setFloat32(Q,j[Z],!0);return q}function L(j,G,Q){for(let q=0;q<Q.length;++q)j.setUint8(G+q,Q.charCodeAt(q))}class P{constructor(G,Q){this.audio=G,this.sampling_rate=Q}toWav(){return D(this.audio,this.sampling_rate)}toBlob(){const G=this.toWav();return new Blob([G],{type:"audio/wav"})}async save(G){let Q;if(o.apis.IS_BROWSER_ENV){if(o.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");Q=a.saveBlob}else if(o.apis.IS_FS_AVAILABLE)Q=async(q,te)=>{let Z=await te.arrayBuffer();c.writeFileSync(q,Buffer.from(Z))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await Q(G,this.toBlob())}}}),"./src/utils/constants.js":((n,e,t)=>{t.r(e),t.d(e,{CHAT_TEMPLATE_NAME:()=>c,CONFIG_NAME:()=>r,FEATURE_EXTRACTOR_NAME:()=>a,GENERATION_CONFIG_NAME:()=>u,GITHUB_ISSUE_URL:()=>s,IMAGE_PROCESSOR_NAME:()=>o,PROCESSOR_NAME:()=>l});const s="https://github.com/huggingface/transformers.js/issues/new/choose",r="config.json",a="preprocessor_config.json",o=a,l="processor_config.json",c="chat_template.jinja",u="generation_config.json"}),"./src/utils/core.js":((n,e,t)=>{t.r(e),t.d(e,{calculateDimensions:()=>u,calculateReflectOffset:()=>p,count:()=>w,dispatchCallback:()=>s,escapeRegExp:()=>a,isIntegralNumber:()=>l,isNullishDimension:()=>c,isTypedArray:()=>o,len:()=>v,mergeArrays:()=>d,pick:()=>b,pop:()=>f,product:()=>h,reverseDictionary:()=>r,saveBlob:()=>g});function s(x,S){x&&x(S)}function r(x){return Object.fromEntries(Object.entries(x).map(([S,C])=>[C,S]))}function a(x){return x.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(x){return x?.prototype?.__proto__?.constructor?.name==="TypedArray"}function l(x){return Number.isInteger(x)||typeof x=="bigint"}function c(x){return x==null||x===-1}function u(x){const S=[];let C=x;for(;Array.isArray(C);)S.push(C.length),C=C[0];return S}function f(x,S,C=void 0){const M=x[S];if(M!==void 0)return delete x[S],M;if(C===void 0)throw Error(`Key ${S} does not exist in object.`);return C}function d(...x){return Array.prototype.concat.apply([],x)}function h(...x){return x.reduce((S,C)=>S.flatMap(M=>C.map(k=>[M,k])))}function p(x,S){return Math.abs((x+S)%(2*S)-S)}function g(x,S){const C=URL.createObjectURL(S),M=document.createElement("a");M.href=C,M.download=x,M.click(),M.remove(),URL.revokeObjectURL(C)}function b(x,S){return Object.assign({},...S.map(C=>{if(x[C]!==void 0)return{[C]:x[C]}}))}function v(x){let S=0;for(const C of x)++S;return S}function w(x,S){let C=0;for(const M of x)M===S&&++C;return C}}),"./src/utils/data-structures.js":((n,e,t)=>{t.r(e),t.d(e,{CharTrie:()=>r,DictionarySplitter:()=>c,LRUCache:()=>u,PriorityQueue:()=>s,TokenLattice:()=>o});class s{constructor(d=(p,g)=>p>g,h=1/0){this._heap=[],this._comparator=d,this._maxSize=h}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...d){return this.extend(d)}extend(d){for(const h of d)if(this.size<this._maxSize)this._heap.push(h),this._siftUp();else{const p=this._smallest();this._comparator(h,this._heap[p])&&(this._heap[p]=h,this._siftUpFrom(p))}return this.size}pop(){const d=this.peek(),h=this.size-1;return h>0&&this._swap(0,h),this._heap.pop(),this._siftDown(),d}replace(d){const h=this.peek();return this._heap[0]=d,this._siftDown(),h}_parent(d){return(d+1>>>1)-1}_left(d){return(d<<1)+1}_right(d){return d+1<<1}_greater(d,h){return this._comparator(this._heap[d],this._heap[h])}_swap(d,h){const p=this._heap[d];this._heap[d]=this._heap[h],this._heap[h]=p}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(d){for(;d>0&&this._greater(d,this._parent(d));)this._swap(d,this._parent(d)),d=this._parent(d)}_siftDown(){let d=0;for(;this._left(d)<this.size&&this._greater(this._left(d),d)||this._right(d)<this.size&&this._greater(this._right(d),d);){const h=this._right(d)<this.size&&this._greater(this._right(d),this._left(d))?this._right(d):this._left(d);this._swap(d,h),d=h}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class r{constructor(){this.root=a.default()}extend(d){for(const h of d)this.push(h)}push(d){let h=this.root;for(const p of d){let g=h.children.get(p);g===void 0&&(g=a.default(),h.children.set(p,g)),h=g}h.isLeaf=!0}*commonPrefixSearch(d){let h=this.root;if(h===void 0)return;let p="";for(const g of d){if(p+=g,h=h.children.get(g),h===void 0)return;h.isLeaf&&(yield p)}}}class a{constructor(d,h){this.isLeaf=d,this.children=h}static default(){return new a(!1,new Map)}}class o{constructor(d,h,p){this.chars=Array.from(d),this.len=this.chars.length,this.bosTokenId=h,this.eosTokenId=p,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const g=new l(this.bosTokenId,0,0,0,0),b=new l(this.eosTokenId,1,this.len,0,0);this.nodes.push(g.clone()),this.nodes.push(b.clone()),this.beginNodes[this.len].push(b),this.endNodes[0].push(g)}insert(d,h,p,g){const b=this.nodes.length,v=new l(g,b,d,h,p);this.beginNodes[d].push(v),this.endNodes[d+h].push(v),this.nodes.push(v)}viterbi(){const d=this.len;let h=0;for(;h<=d;){if(this.beginNodes[h].length==0)return[];for(let w of this.beginNodes[h]){w.prev=null;let x=0,S=null;for(let C of this.endNodes[h]){const M=C.backtraceScore+w.score;(S===null||M>x)&&(S=C.clone(),x=M)}if(S!==null)w.prev=S,w.backtraceScore=x;else return[]}++h}const p=[],b=this.beginNodes[d][0].prev;if(b===null)return[];let v=b.clone();for(;v.prev!==null;)p.push(v.clone()),v=v.clone().prev.clone();return p.reverse(),p}piece(d){return this.chars.slice(d.pos,d.pos+d.length).join("")}tokens(){return this.viterbi().map(h=>this.piece(h))}tokenIds(){return this.viterbi().map(h=>h.tokenId)}}class l{constructor(d,h,p,g,b){this.tokenId=d,this.nodeId=h,this.pos=p,this.length=g,this.score=b,this.prev=null,this.backtraceScore=0}clone(){const d=new l(this.tokenId,this.nodeId,this.pos,this.length,this.score);return d.prev=this.prev,d.backtraceScore=this.backtraceScore,d}}class c{constructor(d){this.trie=this._buildTrie(d)}_buildTrie(d){const h=Object.create(null);for(const p of d){let g=h;for(let b=0;b<p.length;++b)g=g[p[b]]??=Object.create(null);g.end=p}return h}split(d){const h=[],p=d.length;let g=0,b=0;for(;b<p;){let v=this.trie,w=null,x=b;for(;x<p&&(v=v[d[x]]);)v.end&&(w=v.end),++x;w?(b>g&&h.push(d.slice(g,b)),h.push(w),b+=w.length,g=b):++b}return g<p&&h.push(d.slice(g)),h}}class u{constructor(d){this.capacity=d,this.cache=new Map}get(d){if(!this.cache.has(d))return;const h=this.cache.get(d);return this.cache.delete(d),this.cache.set(d,h),h}put(d,h){this.cache.has(d)&&this.cache.delete(d),this.cache.set(d,h),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}}),"./src/utils/devices.js":((n,e,t)=>{t.r(e),t.d(e,{DEVICE_TYPES:()=>s});const s=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})}),"./src/utils/dtypes.js":((n,e,t)=>{t.r(e),t.d(e,{DATA_TYPES:()=>o,DEFAULT_DEVICE_DTYPE_MAPPING:()=>l,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>c,isWebGpuFp16Supported:()=>a});var s=t("./src/env.js"),r=t("./src/utils/devices.js");const a=(function(){let u;return async function(){if(u===void 0)if(!s.apis.IS_WEBGPU_AVAILABLE)u=!1;else try{u=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{u=!1}return u}})(),o=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),l=Object.freeze({[r.DEVICE_TYPES.wasm]:o.q8}),c=Object.freeze({[o.fp32]:"",[o.fp16]:"_fp16",[o.int8]:"_int8",[o.uint8]:"_uint8",[o.q8]:"_quantized",[o.q4]:"_q4",[o.q4f16]:"_q4f16",[o.bnb4]:"_bnb4"})}),"./src/utils/generic.js":((n,e,t)=>{t.r(e),t.d(e,{Callable:()=>s});const s=class{constructor(){let r=function(...a){return r._call(...a)};return Object.setPrototypeOf(r,new.target.prototype)}_call(...r){throw Error("Must implement _call method in subclass")}}}),"./src/utils/hub.js":((n,e,t)=>{t.r(e),t.d(e,{MAX_EXTERNAL_DATA_CHUNKS:()=>l,getFile:()=>p,getModelFile:()=>x,getModelJSON:()=>C,getModelText:()=>S});var s=t("?7992"),r=t("?5af5"),a=t("./src/env.js"),o=t("./src/utils/core.js");const l=100,c={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class u{constructor(I){if(this.filePath=I,this.headers=new Headers,this.exists=s.existsSync(I),this.exists){this.status=200,this.statusText="OK";let A=s.statSync(I);this.headers.set("content-length",A.size.toString()),this.updateContentType();const D=s.createReadStream(I);this.body=new ReadableStream({start(L){D.on("data",P=>L.enqueue(P)),D.on("end",()=>L.close()),D.on("error",P=>L.error(P))},cancel(){D.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const I=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",c[I]??"application/octet-stream")}clone(){let I=new u(this.filePath);return I.exists=this.exists,I.status=this.status,I.statusText=this.statusText,I.headers=new Headers(this.headers),I}async arrayBuffer(){return(await s.promises.readFile(this.filePath)).buffer}async blob(){const I=await s.promises.readFile(this.filePath);return new Blob([I],{type:this.headers.get("content-type")})}async text(){return await s.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function f(E,I=null,A=null){let D;try{D=new URL(E)}catch{return!1}return!(I&&!I.includes(D.protocol)||A&&!A.includes(D.hostname))}const d=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;function h(E){return!(!d.test(E)||E.includes("..")||E.includes("--")||E.endsWith(".git")||E.endsWith(".ipynb"))}async function p(E){if(a.env.useFS&&!f(E,["http:","https:","blob:"]))return new u(E instanceof URL?E.protocol==="file:"?E.pathname:E.toString():E);if(typeof process<"u"&&process?.release?.name==="node"){const I=!!$$?.TESTING_REMOTELY,A=a.env.version,D=new Headers;if(D.set("User-Agent",`transformers.js/${A}; is_ci/${I};`),f(E,["http:","https:"],["huggingface.co","hf.co"])){const P=$$?.HF_TOKEN??$$?.HF_ACCESS_TOKEN;P&&D.set("Authorization",`Bearer ${P}`)}return fetch(E,{headers:D})}else return fetch(E)}const g={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function b(E,I,A){if(!A)return null;const D=g[E]??`Error (${E}) occurred while trying to load file`;throw Error(`${D}: "${I}".`)}class v{constructor(I){this.path=I}async match(I){let A=r.join(this.path,I),D=new u(A);if(D.exists)return D}async put(I,A,D=void 0){let L=r.join(this.path,I);try{const P=A.headers.get("Content-Length"),j=parseInt(P??"0");let G=0;await s.promises.mkdir(r.dirname(L),{recursive:!0});const Q=s.createWriteStream(L),q=A.body.getReader();for(;;){const{done:te,value:Z}=await q.read();if(te)break;await new Promise((le,H)=>{Q.write(Z,R=>{if(R){H(R);return}le()})}),G+=Z.length;const ne=j?G/j*100:0;D?.({progress:ne,loaded:G,total:j})}Q.close()}catch(P){try{await s.promises.unlink(L)}catch{}throw P}}}async function w(E,...I){for(let A of I)try{let D=await E.match(A);if(D)return D}catch{continue}}async function x(E,I,A=!0,D={},L=!1){if(!a.env.allowLocalModels){if(D.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!a.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,o.dispatchCallback)(D.progress_callback,{status:"initiate",name:E,file:I});let P;if(!P&&a.env.useCustomCache){if(!a.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!a.env.customCache.match||!a.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");P=a.env.customCache}if(!P&&a.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{P=await caches.open("transformers-cache")}catch(se){console.warn("An error occurred while opening the browser cache:",se)}}if(!P&&a.env.useFSCache){if(!a.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");P=new v(D.cache_dir??a.env.cacheDir)}const j=D.revision??"main",G=k(E,I),Q=h(E),q=Q?k(a.env.localModelPath,G):G,te=k(a.env.remoteHost,a.env.remotePathTemplate.replaceAll("{model}",E).replaceAll("{revision}",encodeURIComponent(j)),I);let Z;const ne=P instanceof v?j==="main"?G:k(E,j,I):te;let le=!1,H;P&&(H=await w(P,q,ne));const R=H!==void 0;if(H===void 0){if(a.env.allowLocalModels)if(f(G,["http:","https:"])){if(D.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${G}.`);if(!a.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${G}.`)}else try{H=await p(q),Z=q}catch(ue){console.warn(`Unable to load from local path "${q}": "${ue}"`)}if(H===void 0||H.status===404){if(D.local_files_only||!a.env.allowRemoteModels){if(A)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${q}".`);return null}if(!Q)throw Error(`Local file missing at "${q}" and download aborted due to invalid model ID "${E}".`);if(H=await p(te),H.status!==200)return b(H.status,te,A);Z=ne}le=P&&typeof Response<"u"&&H instanceof Response&&H.status===200}(0,o.dispatchCallback)(D.progress_callback,{status:"download",name:E,file:I});let B;if(!(a.apis.IS_NODE_ENV&&L)){let se;D.progress_callback?R&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(se=new Uint8Array(await H.arrayBuffer()),(0,o.dispatchCallback)(D.progress_callback,{status:"progress",name:E,file:I,progress:100,loaded:se.length,total:se.length})):se=await M(H,ue=>{(0,o.dispatchCallback)(D.progress_callback,{status:"progress",name:E,file:I,...ue})}):se=new Uint8Array(await H.arrayBuffer()),B=se}if(le&&Z&&await P.match(Z)===void 0)if(B)await P.put(Z,new Response(B,{headers:H.headers})).catch(se=>{console.warn(`Unable to add response to browser cache: ${se}.`)});else{const se=D.progress_callback?ue=>(0,o.dispatchCallback)(D.progress_callback,{status:"progress",name:E,file:I,...ue}):void 0;await P.put(Z,H,se)}if((0,o.dispatchCallback)(D.progress_callback,{status:"done",name:E,file:I}),B){if(!a.apis.IS_NODE_ENV&&L)throw new Error("Cannot return path in a browser environment.");return B}if(H instanceof u)return H.filePath;const W=await P?.match(Z);if(W instanceof u)return W.filePath;if(W instanceof Response)return new Uint8Array(await W.arrayBuffer());if(typeof W=="string")return W;throw new Error("Unable to get model file path or buffer.")}async function S(E,I,A=!0,D={}){const L=await x(E,I,A,D,!1);return L===null?null:new TextDecoder("utf-8").decode(L)}async function C(E,I,A=!0,D={}){const L=await S(E,I,A,D);return L===null?{}:JSON.parse(L)}async function M(E,I){const A=E.headers.get("Content-Length");A===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let D=parseInt(A??"0"),L=new Uint8Array(D),P=0;const j=E.body.getReader();async function G(){const{done:Q,value:q}=await j.read();if(Q)return;const te=P+q.length;if(te>D){D=te;const ne=new Uint8Array(D);ne.set(L),L=ne}L.set(q,P),P=te;const Z=P/D*100;return I({progress:Z,loaded:P,total:D}),G()}return await G(),L}function k(...E){return E=E.map((I,A)=>(A&&(I=I.replace(new RegExp("^/"),"")),A!==E.length-1&&(I=I.replace(new RegExp("/$"),"")),I)),E.join("/")}}),"./src/utils/image.js":((n,e,t)=>{t.r(e),t.d(e,{RawImage:()=>g,load_image:()=>b});var s=t("./src/utils/core.js"),r=t("./src/utils/hub.js"),a=t("./src/env.js"),o=t("./src/utils/tensor.js"),l=t("?2b25");let c,u,f;const d=a.apis.IS_BROWSER_ENV||a.apis.IS_WEBWORKER_ENV;if(d)c=(v,w)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(v,w)},f=self.createImageBitmap,u=self.ImageData;else if(l)f=async v=>{const x=(await v.metadata()).channels,{data:S,info:C}=await v.rotate().raw().toBuffer({resolveWithObject:!0}),M=new g(new Uint8ClampedArray(S),C.width,C.height,C.channels);return x!==void 0&&x!==C.channels&&M.convert(x),M};else throw new Error("Unable to load image processing library.");const h={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},p=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class g{constructor(w,x,S,C){this.data=w,this.width=x,this.height=S,this.channels=C}get size(){return[this.width,this.height]}static async read(w){if(w instanceof g)return w;if(typeof w=="string"||w instanceof URL)return await this.fromURL(w);if(w instanceof Blob)return await this.fromBlob(w);if(typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&w instanceof OffscreenCanvas)return this.fromCanvas(w);throw new Error(`Unsupported input type: ${typeof w}`)}static fromCanvas(w){if(!d)throw new Error("fromCanvas() is only supported in browser environments.");const S=w.getContext("2d").getImageData(0,0,w.width,w.height).data;return new g(S,w.width,w.height,4)}static async fromURL(w){const x=await(0,r.getFile)(w);if(x.status!==200)throw new Error(`Unable to read image from "${w}" (${x.status} ${x.statusText})`);const S=await x.blob();return this.fromBlob(S)}static async fromBlob(w){if(d){const x=await f(w),S=c(x.width,x.height).getContext("2d");return S.drawImage(x,0,0),new this(S.getImageData(0,0,x.width,x.height).data,x.width,x.height,4)}else{const x=l(await w.arrayBuffer());return await f(x)}}static fromTensor(w,x="CHW"){if(w.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${w.dims.length} dimensions.`);if(x==="CHW")w=w.transpose(1,2,0);else if(x!=="HWC")throw new Error(`Unsupported channel format: ${x}`);if(!(w.data instanceof Uint8ClampedArray||w.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${w.type}`);switch(w.dims[2]){case 1:case 2:case 3:case 4:return new g(w.data,w.dims[1],w.dims[0],w.dims[2]);default:throw new Error(`Unsupported number of channels: ${w.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const w=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let x=0,S=0;x<this.data.length;x+=this.channels){const C=this.data[x],M=this.data[x+1],k=this.data[x+2];w[S++]=Math.round(.2989*C+.587*M+.114*k)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(w,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const w=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let x=0,S=0;x<this.data.length;++x)w[S++]=this.data[x],w[S++]=this.data[x],w[S++]=this.data[x];break;case 4:for(let x=0,S=0;x<this.data.length;x+=4)w[S++]=this.data[x],w[S++]=this.data[x+1],w[S++]=this.data[x+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(w,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const w=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let x=0,S=0;x<this.data.length;++x)w[S++]=this.data[x],w[S++]=this.data[x],w[S++]=this.data[x],w[S++]=255;break;case 3:for(let x=0,S=0;x<this.data.length;x+=3)w[S++]=this.data[x],w[S++]=this.data[x+1],w[S++]=this.data[x+2],w[S++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(w,this.width,this.height,4)}putAlpha(w){if(w.width!==this.width||w.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${w.width}x${w.height}`);if(w.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${w.channels}`);const x=this.data,S=w.data,C=this.width*this.height;if(this.channels===3){const M=new Uint8ClampedArray(C*4);for(let k=0,E=0,I=0;k<C;++k)M[I++]=x[E++],M[I++]=x[E++],M[I++]=x[E++],M[I++]=S[k];return this._update(M,this.width,this.height,4)}else if(this.channels===4){for(let M=0;M<C;++M)x[4*M+3]=S[M];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(w,x,{resample:S=2}={}){if(this.width===w&&this.height===x)return this;let C=h[S]??S;const M=(0,s.isNullishDimension)(w),k=(0,s.isNullishDimension)(x);if(M&&k)return this;if(M?w=x/this.height*this.width:k&&(x=w/this.width*this.height),d){const E=this.channels,I=this.toCanvas(),A=c(w,x).getContext("2d");return A.drawImage(I,0,0,w,x),new g(A.getImageData(0,0,w,x).data,w,x,4).convert(E)}else{let E=this.toSharp();switch(C){case"box":case"hamming":(C==="box"||C==="hamming")&&(console.warn(`Resampling method ${C} is not yet supported. Using bilinear instead.`),C="bilinear");case"nearest":case"bilinear":case"bicubic":E=E.affine([w/this.width,0,0,x/this.height],{interpolator:C});break;case"lanczos":E=E.resize({width:w,height:x,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${C} is not supported.`)}return await f(E)}}async pad([w,x,S,C]){if(w=Math.max(w,0),x=Math.max(x,0),S=Math.max(S,0),C=Math.max(C,0),w===0&&x===0&&S===0&&C===0)return this;if(d){const M=this.channels,k=this.toCanvas(),E=this.width+w+x,I=this.height+S+C,A=c(E,I).getContext("2d");return A.drawImage(k,0,0,this.width,this.height,w,S,this.width,this.height),new g(A.getImageData(0,0,E,I).data,E,I,4).convert(M)}else{const M=this.toSharp().extend({left:w,right:x,top:S,bottom:C});return await f(M)}}async crop([w,x,S,C]){if(w=Math.max(w,0),x=Math.max(x,0),S=Math.min(S,this.width-1),C=Math.min(C,this.height-1),w===0&&x===0&&S===this.width-1&&C===this.height-1)return this;const M=S-w+1,k=C-x+1;if(d){const E=this.channels,I=this.toCanvas(),A=c(M,k).getContext("2d");return A.drawImage(I,w,x,M,k,0,0,M,k),new g(A.getImageData(0,0,M,k).data,M,k,4).convert(E)}else{const E=this.toSharp().extract({left:w,top:x,width:M,height:k});return await f(E)}}async center_crop(w,x){if(this.width===w&&this.height===x)return this;const S=(this.width-w)/2,C=(this.height-x)/2;if(d){const M=this.channels,k=this.toCanvas(),E=c(w,x).getContext("2d");let I=0,A=0,D=0,L=0;return S>=0?I=S:D=-S,C>=0?A=C:L=-C,E.drawImage(k,I,A,w,x,D,L,w,x),new g(E.getImageData(0,0,w,x).data,w,x,4).convert(M)}else{let M=this.toSharp();if(S>=0&&C>=0)M=M.extract({left:Math.floor(S),top:Math.floor(C),width:w,height:x});else if(S<=0&&C<=0){const k=Math.floor(-C),E=Math.floor(-S);M=M.extend({top:k,left:E,right:w-this.width-E,bottom:x-this.height-k})}else{let k=[0,0],E=0;C<0?(k[0]=Math.floor(-C),k[1]=x-this.height-k[0]):E=Math.floor(C);let I=[0,0],A=0;S<0?(I[0]=Math.floor(-S),I[1]=w-this.width-I[0]):A=Math.floor(S),M=M.extend({top:k[0],bottom:k[1],left:I[0],right:I[1]}).extract({left:A,top:E,width:w,height:x})}return await f(M)}}async toBlob(w="image/png",x=1){if(!d)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:w,quality:x})}toTensor(w="CHW"){let x=new o.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(w!=="HWC")if(w==="CHW")x=x.permute(2,0,1);else throw new Error(`Unsupported channel format: ${w}`);return x}toCanvas(){if(!d)throw new Error("toCanvas() is only supported in browser environments.");const w=this.clone().rgba(),x=c(w.width,w.height),S=new u(w.data,w.width,w.height);return x.getContext("2d").putImageData(S,0,0),x}split(){const{data:w,width:x,height:S,channels:C}=this,M=w.constructor,k=w.length/C,E=Array.from({length:C},()=>new M(k));for(let I=0;I<k;++I){const A=C*I;for(let D=0;D<C;++D)E[D][I]=w[A+D]}return E.map(I=>new g(I,x,S,1))}_update(w,x,S,C=null){return this.data=w,this.width=x,this.height=S,C!==null&&(this.channels=C),this}clone(){return new g(this.data.slice(),this.width,this.height,this.channels)}convert(w){if(this.channels===w)return this;switch(w){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(w){if(d){if(a.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const x=w.split(".").pop().toLowerCase(),S=p.get(x)??"image/png",C=await this.toBlob(S);(0,s.saveBlob)(w,C)}else{if(a.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(w);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(d)throw new Error("toSharp() is only supported in server-side environments.");return l(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const b=g.read.bind(g)}),"./src/utils/maths.js":((n,e,t)=>{t.r(e),t.d(e,{FFT:()=>b,bankers_round:()=>x,cos_sim:()=>c,dot:()=>l,dynamic_time_warping:()=>S,interpolate_data:()=>s,log_softmax:()=>o,magnitude:()=>u,max:()=>d,medianFilter:()=>v,min:()=>f,permute_data:()=>r,round:()=>w,softmax:()=>a});function s(C,[M,k,E],[I,A],D="bilinear",L=!1){const P=A/E,j=I/k,G=new C.constructor(I*A*M),Q=k*E,q=I*A;for(let te=0;te<I;++te)for(let Z=0;Z<A;++Z){const ne=te*A+Z,le=(Z+.5)/P-.5,H=(te+.5)/j-.5;let R=Math.floor(le),B=Math.floor(H);const W=Math.min(R+1,E-1),se=Math.min(B+1,k-1);R=Math.max(R,0),B=Math.max(B,0);const ue=le-R,ge=H-B,Ce=(1-ue)*(1-ge),Se=ue*(1-ge),Me=(1-ue)*ge,pe=ue*ge,fe=B*E,$e=se*E,We=fe+R,de=fe+W,Be=$e+R,st=$e+W;for(let He=0;He<M;++He){const Xe=He*Q;G[He*q+ne]=Ce*C[Xe+We]+Se*C[Xe+de]+Me*C[Xe+Be]+pe*C[Xe+st]}}return G}function r(C,M,k){const E=new Array(k.length),I=new Array(k.length);for(let L=k.length-1,P=1;L>=0;--L)I[L]=P,E[L]=M[k[L]],P*=E[L];const A=k.map((L,P)=>I[k.indexOf(P)]),D=new C.constructor(C.length);for(let L=0;L<C.length;++L){let P=0;for(let j=M.length-1,G=L;j>=0;--j)P+=G%M[j]*A[j],G=Math.floor(G/M[j]);D[P]=C[L]}return[D,E]}function a(C){const M=d(C)[0],k=C.map(A=>Math.exp(A-M)),E=k.reduce((A,D)=>A+D,0);return k.map(A=>A/E)}function o(C){const M=d(C)[0];let k=0;for(let A=0;A<C.length;++A)k+=Math.exp(C[A]-M);const E=Math.log(k);return C.map(A=>A-M-E)}function l(C,M){let k=0;for(let E=0;E<C.length;++E)k+=C[E]*M[E];return k}function c(C,M){const k=l(C,M),E=u(C),I=u(M);return k/(E*I)}function u(C){return Math.sqrt(C.reduce((M,k)=>M+k*k,0))}function f(C){if(C.length===0)throw Error("Array must not be empty");let M=C[0],k=0;for(let E=1;E<C.length;++E)C[E]<M&&(M=C[E],k=E);return[M,k]}function d(C){if(C.length===0)throw Error("Array must not be empty");let M=C[0],k=0;for(let E=1;E<C.length;++E)C[E]>M&&(M=C[E],k=E);return[M,k]}function h(C){return C>0&&(C&C-1)===0}class p{constructor(M){if(this.size=M|0,this.size<=1||!h(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=M<<1,this.table=new Float64Array(this.size*2);for(let E=0;E<this.table.length;E+=2){const I=Math.PI*E/this.size;this.table[E]=Math.cos(I),this.table[E+1]=-Math.sin(I)}let k=0;for(let E=1;this.size>E;E<<=1)++k;this._width=k%2===0?k-1:k,this._bitrev=new Int32Array(1<<this._width);for(let E=0;E<this._bitrev.length;++E){this._bitrev[E]=0;for(let I=0;I<this._width;I+=2){const A=this._width-I-2;this._bitrev[E]|=(E>>>I&3)<<A}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(M,k){const E=k||new Array(M.length>>>1);for(let I=0;I<M.length;I+=2)E[I>>>1]=M[I];return E}toComplexArray(M,k){const E=k||this.createComplexArray();for(let I=0;I<E.length;I+=2)E[I]=M[I>>>1],E[I+1]=0;return E}transform(M,k){if(M===k)throw new Error("Input and output buffers must be different");this._transform4(M,k,1)}realTransform(M,k){if(M===k)throw new Error("Input and output buffers must be different");this._realTransform4(M,k,1)}inverseTransform(M,k){if(M===k)throw new Error("Input and output buffers must be different");this._transform4(M,k,-1);for(let E=0;E<M.length;++E)M[E]/=this.size}_transform4(M,k,E){const I=this._csize;let D=1<<this._width,L=I/D<<1,P,j;const G=this._bitrev;if(L===4)for(P=0,j=0;P<I;P+=L,++j){const q=G[j];this._singleTransform2(k,M,P,q,D)}else for(P=0,j=0;P<I;P+=L,++j){const q=G[j];this._singleTransform4(k,M,P,q,D,E)}const Q=this.table;for(D>>=2;D>=2;D>>=2){L=I/D<<1;const q=L>>>2;for(P=0;P<I;P+=L){const te=P+q-1;for(let Z=P,ne=0;Z<te;Z+=2,ne+=D){const le=Z,H=le+q,R=H+q,B=R+q,W=M[le],se=M[le+1],ue=M[H],ge=M[H+1],Ce=M[R],Se=M[R+1],Me=M[B],pe=M[B+1],fe=Q[ne],$e=E*Q[ne+1],We=ue*fe-ge*$e,de=ue*$e+ge*fe,Be=Q[2*ne],st=E*Q[2*ne+1],He=Ce*Be-Se*st,Xe=Ce*st+Se*Be,Ke=Q[3*ne],Ze=E*Q[3*ne+1],xt=Me*Ke-pe*Ze,dt=Me*Ze+pe*Ke,Ft=W+He,It=se+Xe,Bt=W-He,Gt=se-Xe,At=We+xt,ht=de+dt,Qt=E*(We-xt),Xt=E*(de-dt);M[le]=Ft+At,M[le+1]=It+ht,M[H]=Bt+Xt,M[H+1]=Gt-Qt,M[R]=Ft-At,M[R+1]=It-ht,M[B]=Bt-Xt,M[B+1]=Gt+Qt}}}}_singleTransform2(M,k,E,I,A){const D=M[I],L=M[I+1],P=M[I+A],j=M[I+A+1];k[E]=D+P,k[E+1]=L+j,k[E+2]=D-P,k[E+3]=L-j}_singleTransform4(M,k,E,I,A,D){const L=A*2,P=A*3,j=M[I],G=M[I+1],Q=M[I+A],q=M[I+A+1],te=M[I+L],Z=M[I+L+1],ne=M[I+P],le=M[I+P+1],H=j+te,R=G+Z,B=j-te,W=G-Z,se=Q+ne,ue=q+le,ge=D*(Q-ne),Ce=D*(q-le);k[E]=H+se,k[E+1]=R+ue,k[E+2]=B+Ce,k[E+3]=W-ge,k[E+4]=H-se,k[E+5]=R-ue,k[E+6]=B-Ce,k[E+7]=W+ge}_realTransform4(M,k,E){const I=this._csize;let D=1<<this._width,L=I/D<<1,P,j;const G=this._bitrev;if(L===4)for(P=0,j=0;P<I;P+=L,++j){const te=G[j];this._singleRealTransform2(k,M,P,te>>>1,D>>>1)}else for(P=0,j=0;P<I;P+=L,++j){const te=G[j];this._singleRealTransform4(k,M,P,te>>>1,D>>>1,E)}const Q=this.table;for(D>>=2;D>=2;D>>=2){L=I/D<<1;const te=L>>>1,Z=te>>>1,ne=Z>>>1;for(P=0;P<I;P+=L)for(let le=0,H=0;le<=ne;le+=2,H+=D){const R=P+le,B=R+Z,W=B+Z,se=W+Z,ue=M[R],ge=M[R+1],Ce=M[B],Se=M[B+1],Me=M[W],pe=M[W+1],fe=M[se],$e=M[se+1],We=ue,de=ge,Be=Q[H],st=E*Q[H+1],He=Ce*Be-Se*st,Xe=Ce*st+Se*Be,Ke=Q[2*H],Ze=E*Q[2*H+1],xt=Me*Ke-pe*Ze,dt=Me*Ze+pe*Ke,Ft=Q[3*H],It=E*Q[3*H+1],Bt=fe*Ft-$e*It,Gt=fe*It+$e*Ft,At=We+xt,ht=de+dt,Qt=We-xt,Xt=de-dt,us=He+Bt,yn=Xe+Gt,En=E*(He-Bt),Vn=E*(Xe-Gt);if(M[R]=At+us,M[R+1]=ht+yn,M[B]=Qt+Vn,M[B+1]=Xt-En,le===0){M[W]=At-us,M[W+1]=ht-yn;continue}if(le===ne)continue;const Nn=P+Z-le,Dn=P+te-le;M[Nn]=Qt-E*Vn,M[Nn+1]=-Xt-E*En,M[Dn]=At-E*us,M[Dn+1]=-ht+E*yn}}const q=I>>>1;for(let te=2;te<q;te+=2)M[I-te]=M[te],M[I-te+1]=-M[te+1]}_singleRealTransform2(M,k,E,I,A){const D=M[I],L=M[I+A];k[E]=D+L,k[E+1]=0,k[E+2]=D-L,k[E+3]=0}_singleRealTransform4(M,k,E,I,A,D){const L=A*2,P=A*3,j=M[I],G=M[I+A],Q=M[I+L],q=M[I+P],te=j+Q,Z=j-Q,ne=G+q,le=D*(G-q);k[E]=te+ne,k[E+1]=0,k[E+2]=Z,k[E+3]=-le,k[E+4]=te-ne,k[E+5]=0,k[E+6]=Z,k[E+7]=le}}class g{constructor(M){const k=2*(M-1),E=2*(2*M-1),I=2**Math.ceil(Math.log2(E));this.bufferSize=I,this._a=k;const A=new Float64Array(E),D=new Float64Array(I);this._chirpBuffer=new Float64Array(I),this._buffer1=new Float64Array(I),this._buffer2=new Float64Array(I),this._outBuffer1=new Float64Array(I),this._outBuffer2=new Float64Array(I);const L=-2*Math.PI/M,P=Math.cos(L),j=Math.sin(L);for(let G=0;G<E>>1;++G){const Q=(G+1-M)**2/2,q=Math.sqrt(P**2+j**2)**Q,te=Q*Math.atan2(j,P),Z=2*G;A[Z]=q*Math.cos(te),A[Z+1]=q*Math.sin(te),D[Z]=A[Z],D[Z+1]=-A[Z+1]}this._slicedChirpBuffer=A.subarray(k,E),this._f=new p(I>>1),this._f.transform(this._chirpBuffer,D)}_transform(M,k,E){const I=this._buffer1,A=this._buffer2,D=this._outBuffer1,L=this._outBuffer2,P=this._chirpBuffer,j=this._slicedChirpBuffer,G=this._a;if(E)for(let Q=0;Q<j.length;Q+=2){const q=Q+1,te=Q>>1,Z=k[te];I[Q]=Z*j[Q],I[q]=Z*j[q]}else for(let Q=0;Q<j.length;Q+=2){const q=Q+1;I[Q]=k[Q]*j[Q]-k[q]*j[q],I[q]=k[Q]*j[q]+k[q]*j[Q]}this._f.transform(D,I);for(let Q=0;Q<P.length;Q+=2){const q=Q+1;A[Q]=D[Q]*P[Q]-D[q]*P[q],A[q]=D[Q]*P[q]+D[q]*P[Q]}this._f.inverseTransform(L,A);for(let Q=0;Q<L.length;Q+=2){const q=L[Q+G],te=L[Q+G+1],Z=j[Q],ne=j[Q+1];M[Q]=q*Z-te*ne,M[Q+1]=q*ne+te*Z}}transform(M,k){this._transform(M,k,!1)}realTransform(M,k){this._transform(M,k,!0)}}class b{constructor(M){this.fft_length=M,this.isPowerOfTwo=h(M),this.isPowerOfTwo?(this.fft=new p(M),this.outputBufferSize=2*M):(this.fft=new g(M),this.outputBufferSize=this.fft.bufferSize)}realTransform(M,k){this.fft.realTransform(M,k)}transform(M,k){this.fft.transform(M,k)}}function v(C,M){if(M%2===0||M<=0)throw new Error("Window size must be a positive odd number");const k=new C.constructor(C.length),E=new C.constructor(M),I=Math.floor(M/2);for(let A=0;A<C.length;++A){let D=0;for(let L=-I;L<=I;++L){let P=A+L;P<0?P=Math.abs(P):P>=C.length&&(P=2*(C.length-1)-P),E[D++]=C[P]}E.sort(),k[A]=E[I]}return k}function w(C,M){const k=Math.pow(10,M);return Math.round(C*k)/k}function x(C){const M=Math.round(C);return Math.abs(C)%1===.5?M%2===0?M:M-1:M}function S(C){const M=C.length,k=C[0].length,E=[M+1,k+1],I=Array.from({length:E[0]},()=>Array(E[1]).fill(1/0));I[0][0]=0;const A=Array.from({length:E[0]},()=>Array(E[1]).fill(-1));for(let G=1;G<E[1];++G)for(let Q=1;Q<E[0];++Q){const q=I[Q-1][G-1],te=I[Q-1][G],Z=I[Q][G-1];let ne,le;q<te&&q<Z?(ne=q,le=0):te<q&&te<Z?(ne=te,le=1):(ne=Z,le=2),I[Q][G]=C[Q-1][G-1]+ne,A[Q][G]=le}for(let G=0;G<E[1];++G)A[0][G]=2;for(let G=0;G<E[0];++G)A[G][0]=1;let D=M,L=k,P=[],j=[];for(;D>0||L>0;)switch(P.push(D-1),j.push(L-1),A[D][L]){case 0:--D,--L;break;case 1:--D;break;case 2:--L;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${D}, ${L}]. Please file a bug report.`)}return P.reverse(),j.reverse(),[P,j]}}),"./src/utils/tensor.js":((n,e,t)=>{t.r(e),t.d(e,{DataTypeMap:()=>o,Tensor:()=>l,cat:()=>k,full:()=>j,full_like:()=>G,interpolate:()=>f,interpolate_4d:()=>d,layer_norm:()=>x,matmul:()=>h,mean:()=>D,mean_pooling:()=>w,ones:()=>Q,ones_like:()=>q,permute:()=>u,quantize_embeddings:()=>H,rand:()=>ne,randn:()=>le,rfft:()=>p,slice:()=>v,stack:()=>E,std_mean:()=>A,topk:()=>g,zeros:()=>te,zeros_like:()=>Z});var s=t("./src/utils/maths.js"),r=t("./src/backends/onnx.js"),a=t("./src/ops/registry.js");const o=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class l{get dims(){return this.ort_tensor.dims}set dims(B){this.ort_tensor.dims=B}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}ort_tensor;constructor(...B){return(0,r.isONNXTensor)(B[0])?this.ort_tensor=B[0]:this.ort_tensor=new r.Tensor(B[0],B[1],B[2]),new Proxy(this,{get:(W,se)=>{if(typeof se=="string"){let ue=Number(se);if(Number.isInteger(ue))return W._getitem(ue)}return W[se]},set:(W,se,ue)=>W[se]=ue})}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[B,...W]=this.dims;if(W.length>0){const se=W.reduce((ue,ge)=>ue*ge);for(let ue=0;ue<B;++ue)yield this._subarray(ue,se,W)}else yield*this.data}_getitem(B){const[W,...se]=this.dims;if(B=M(B,W),se.length>0){const ue=se.reduce((ge,Ce)=>ge*Ce);return this._subarray(B,ue,se)}else return new l(this.type,[this.data[B]],se)}indexOf(B){const W=this.data;for(let se=0;se<W.length;++se)if(W[se]==B)return se;return-1}_subarray(B,W,se){const ue=B*W,ge=(B+1)*W,Ce="subarray"in this.data?this.data.subarray(ue,ge):this.data.slice(ue,ge);return new l(this.type,Ce,se)}item(){const B=this.data;if(B.length!==1)throw new Error(`a Tensor with ${B.length} elements cannot be converted to Scalar`);return B[0]}tolist(){return c(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const B=this.data;for(let W=0;W<B.length;++W)B[W]=1/(1+Math.exp(-B[W]));return this}map(B){return this.clone().map_(B)}map_(B){const W=this.data;for(let se=0;se<W.length;++se)W[se]=B(W[se],se,W);return this}mul(B){return this.clone().mul_(B)}mul_(B){const W=this.data;for(let se=0;se<W.length;++se)W[se]*=B;return this}div(B){return this.clone().div_(B)}div_(B){const W=this.data;for(let se=0;se<W.length;++se)W[se]/=B;return this}add(B){return this.clone().add_(B)}add_(B){const W=this.data;for(let se=0;se<W.length;++se)W[se]+=B;return this}sub(B){return this.clone().sub_(B)}sub_(B){const W=this.data;for(let se=0;se<W.length;++se)W[se]-=B;return this}clone(){return new l(this.type,this.data.slice(),this.dims.slice())}slice(...B){const W=[],se=[];for(let fe=0;fe<this.dims.length;++fe){let $e=B[fe];if($e==null)se.push([0,this.dims[fe]]),W.push(this.dims[fe]);else if(typeof $e=="number")$e=M($e,this.dims[fe],fe),se.push([$e,$e+1]);else if(Array.isArray($e)&&$e.length===2){let[We,de]=$e;if(We=We===null?0:M(We,this.dims[fe],fe,!1),de=de===null?this.dims[fe]:M(de,this.dims[fe],fe,!1),We>de)throw new Error(`Invalid slice: ${$e}`);const Be=[Math.max(We,0),Math.min(de,this.dims[fe])];se.push(Be),W.push(Be[1]-Be[0])}else throw new Error(`Invalid slice: ${$e}`)}const ue=se.map(([fe,$e])=>$e-fe),ge=ue.reduce((fe,$e)=>fe*$e),Ce=this.data,Se=new Ce.constructor(ge),Me=this.stride();let pe=!0;for(let fe=1;fe<ue.length;++fe)if(se[fe][0]!==0||se[fe][1]!==this.dims[fe]){pe=!1;break}if(pe){const fe=se[0][0]*Me[0],$e=se[0][1]*Me[0];if(ArrayBuffer.isView(Ce))Se.set(Ce.subarray(fe,$e));else if(Array.isArray(Ce)){const We=Ce.slice(fe,$e);for(let de=0;de<We.length;++de)Se[de]=We[de]}else throw new Error("Unsupported data type for slicing")}else for(let fe=0;fe<ge;++fe){let $e=0;for(let We=ue.length-1,de=fe;We>=0;--We){const Be=ue[We];$e+=(de%Be+se[We][0])*Me[We],de=Math.floor(de/Be)}Se[fe]=Ce[$e]}return new l(this.type,Se,W)}permute(...B){return u(this,B)}transpose(...B){return this.permute(...B)}sum(B=null,W=!1){return this.norm(1,B,W)}norm(B="fro",W=null,se=!1){if(B==="fro")B=2;else if(typeof B=="string")throw Error(`Unsupported norm: ${B}`);const ue=this.data,ge=(pe,fe)=>pe+fe**B;if(W===null){const pe=ue.reduce(ge,0)**(1/B);return new l(this.type,[pe],[])}const[Ce,Se,Me]=I(ge,this,W,se);if(B!==1)for(let pe=0;pe<Se.length;++pe)Se[pe]=Se[pe]**(1/B);return new l(Ce,Se,Me)}normalize_(B=2,W=1){W=M(W,this.dims.length);const se=this.norm(B,W,!0),ue=this.data,ge=se.data;for(let Ce=0;Ce<ue.length;++Ce){let Se=0;for(let Me=this.dims.length-1,pe=Ce,fe=1;Me>=0;--Me){const $e=this.dims[Me];if(Me!==W){const We=pe%$e;Se+=We*fe,fe*=this.dims[Me]}pe=Math.floor(pe/$e)}ue[Ce]/=ge[Se]}return this}normalize(B=2,W=1){return this.clone().normalize_(B,W)}stride(){return L(this.dims)}squeeze(B=null){return new l(this.type,this.data,S(this.dims,B))}squeeze_(B=null){return this.dims=S(this.dims,B),this}unsqueeze(B=null){return new l(this.type,this.data,C(this.dims,B))}unsqueeze_(B=null){return this.dims=C(this.dims,B),this}flatten_(B=0,W=-1){W=(W+this.dims.length)%this.dims.length;let se=this.dims.slice(0,B),ue=this.dims.slice(B,W+1),ge=this.dims.slice(W+1);return this.dims=[...se,ue.reduce((Ce,Se)=>Ce*Se,1),...ge],this}flatten(B=0,W=-1){return this.clone().flatten_(B,W)}view(...B){let W=-1;for(let ue=0;ue<B.length;++ue)if(B[ue]===-1){if(W!==-1)throw new Error("Only one dimension can be inferred");W=ue}const se=this.data;if(W!==-1){const ue=B.reduce((ge,Ce,Se)=>Se!==W?ge*Ce:ge,1);B[W]=se.length/ue}return new l(this.type,se,B)}neg_(){const B=this.data;for(let W=0;W<B.length;++W)B[W]=-B[W];return this}neg(){return this.clone().neg_()}gt(B){const W=new Uint8Array(this.data.length),se=this.data;for(let ue=0;ue<se.length;++ue)W[ue]=se[ue]>B?1:0;return new l("bool",W,this.dims)}lt(B){const W=new Uint8Array(this.data.length),se=this.data;for(let ue=0;ue<se.length;++ue)W[ue]=se[ue]<B?1:0;return new l("bool",W,this.dims)}clamp_(B,W){const se=this.data;for(let ue=0;ue<se.length;++ue)se[ue]=Math.min(Math.max(se[ue],B),W);return this}clamp(B,W){return this.clone().clamp_(B,W)}round_(){const B=this.data;for(let W=0;W<B.length;++W)B[W]=Math.round(B[W]);return this}round(){return this.clone().round_()}mean(B=null,W=!1){return D(this,B,W)}min(B=null,W=!1){if(B===null){const Ce=(0,s.min)(this.data)[0];return new l(this.type,[Ce],[])}const[se,ue,ge]=I((Ce,Se)=>Math.min(Ce,Se),this,B,W,1/0);return new l(se,ue,ge)}max(B=null,W=!1){if(B===null){const Ce=(0,s.max)(this.data)[0];return new l(this.type,[Ce],[])}const[se,ue,ge]=I((Ce,Se)=>Math.max(Ce,Se),this,B,W,-1/0);return new l(se,ue,ge)}argmin(B=null,W=!1){if(B!==null)throw new Error("`dim !== null` not yet implemented.");const se=(0,s.min)(this.data)[1];return new l("int64",[BigInt(se)],[])}argmax(B=null,W=!1){if(B!==null)throw new Error("`dim !== null` not yet implemented.");const se=(0,s.max)(this.data)[1];return new l("int64",[BigInt(se)],[])}to(B){if(this.type===B)return this;if(!o.hasOwnProperty(B))throw new Error(`Unsupported type: ${B}`);let W;const se=["int64","uint64"].includes(this.type),ue=["int64","uint64"].includes(B);return se&&!ue?W=Number:!se&&ue&&(["float16","float32","float64"].includes(this.type)?W=ge=>BigInt(Math.floor(ge)):W=BigInt),new l(B,o[B].from(this.data,W),this.dims)}}function c(R,B){const W=R.length,se=B.reduce((ge,Ce)=>ge*Ce);if(W!==se)throw Error(`cannot reshape array of size ${W} into shape (${B})`);let ue=R;for(let ge=B.length-1;ge>=0;ge--)ue=ue.reduce((Ce,Se)=>{let Me=Ce[Ce.length-1];return Me.length<B[ge]?Me.push(Se):Ce.push([Se]),Ce},[[]]);return ue[0]}function u(R,B){const[W,se]=(0,s.permute_data)(R.data,R.dims,B);return new l(R.type,W,se)}function f(R,[B,W],se="bilinear",ue=!1){const ge=R.dims.at(-3)??1,Ce=R.dims.at(-2),Se=R.dims.at(-1);let Me=(0,s.interpolate_data)(R.data,[ge,Ce,Se],[B,W],se,ue);return new l(R.type,Me,[ge,B,W])}async function d(R,{size:B=null,mode:W="bilinear"}={}){if(R.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!B)throw new Error("`interpolate_4d` requires a `size` argument.");let se;if(B.length===2)se=[...R.dims.slice(0,2),...B];else if(B.length===3)se=[R.dims[0],...B];else if(B.length===4)se=B;else throw new Error("`size` must be of length 2, 3, or 4.");let ue;if(W==="nearest")ue=await a.TensorOpRegistry.nearest_interpolate_4d;else if(W==="bilinear")ue=await a.TensorOpRegistry.bilinear_interpolate_4d;else if(W==="bicubic")ue=await a.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${W}`);const ge=new l("int64",new BigInt64Array(se.map(BigInt)),[se.length]);return await ue({x:R,s:ge})}async function h(R,B){return await(await a.TensorOpRegistry.matmul)({a:R,b:B})}async function p(R,B){return await(await a.TensorOpRegistry.rfft)({x:R,a:B})}async function g(R,B){const W=await a.TensorOpRegistry.top_k;return B==null?B=R.dims.at(-1):B=Math.min(B,R.dims.at(-1)),await W({x:R,k:new l("int64",[BigInt(B)],[1])})}const b=R=>new l("int64",R,[R.length]);async function v(R,B,W,se,ue){return await(await a.TensorOpRegistry.slice)({x:R,s:b(B),e:b(W),a:b(se),t:b(ue??new Array(se.length).fill(1))})}function w(R,B){const W=R.data,se=B.data,ue=[R.dims[0],R.dims[2]],ge=new W.constructor(ue[0]*ue[1]),[Ce,Se,Me]=R.dims;let pe=0;for(let fe=0;fe<Ce;++fe){const $e=fe*Me*Se;for(let We=0;We<Me;++We){let de=0,Be=0;const st=fe*Se,He=$e+We;for(let Ke=0;Ke<Se;++Ke){const Ze=Number(se[st+Ke]);Be+=Ze,de+=W[He+Ke*Me]*Ze}const Xe=de/Be;ge[pe++]=Xe}}return new l(R.type,ge,ue)}function x(R,B,{eps:W=1e-5}={}){if(R.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[se,ue]=R.dims;if(B.length!==1&&B[0]!==ue)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[ge,Ce]=A(R,1,0,!0),Se=ge.data,Me=Ce.data,pe=R.data,fe=new pe.constructor(pe.length);for(let $e=0;$e<se;++$e){const We=$e*ue;for(let de=0;de<ue;++de){const Be=We+de;fe[Be]=(pe[Be]-Me[$e])/(Se[$e]+W)}}return new l(R.type,fe,R.dims)}function S(R,B){return R=R.slice(),B===null?R=R.filter(W=>W!==1):typeof B=="number"?R[B]===1&&R.splice(B,1):Array.isArray(B)&&(R=R.filter((W,se)=>W!==1||!B.includes(se))),R}function C(R,B){return B=M(B,R.length+1),R=R.slice(),R.splice(B,0,1),R}function M(R,B,W=null,se=!0){if(R<-B||R>=B){if(se)throw new Error(`IndexError: index ${R} is out of bounds for dimension${W===null?"":" "+W} with size ${B}`);return R<-B?0:B}return R<0&&(R=(R%B+B)%B),R}function k(R,B=0){B=M(B,R[0].dims.length);const W=R[0].dims.slice();W[B]=R.reduce((Ce,Se)=>Ce+Se.dims[B],0);const se=W.reduce((Ce,Se)=>Ce*Se,1),ue=new R[0].data.constructor(se),ge=R[0].type;if(B===0){let Ce=0;for(const Se of R){const Me=Se.data;ue.set(Me,Ce),Ce+=Me.length}}else{let Ce=0;for(let Se=0;Se<R.length;++Se){const{data:Me,dims:pe}=R[Se];for(let fe=0;fe<Me.length;++fe){let $e=0;for(let We=pe.length-1,de=fe,Be=1;We>=0;--We){const st=pe[We];let He=de%st;We===B&&(He+=Ce),$e+=He*Be,Be*=W[We],de=Math.floor(de/st)}ue[$e]=Me[fe]}Ce+=pe[B]}}return new l(ge,ue,W)}function E(R,B=0){return k(R.map(W=>W.unsqueeze(B)),B)}function I(R,B,W=null,se=!1,ue=null){const ge=B.data,Ce=B.dims;W=M(W,Ce.length);const Se=Ce.slice();Se[W]=1;const Me=new ge.constructor(ge.length/Ce[W]);ue!==null&&Me.fill(ue);for(let pe=0;pe<ge.length;++pe){let fe=0;for(let $e=Ce.length-1,We=pe,de=1;$e>=0;--$e){const Be=Ce[$e];if($e!==W){const st=We%Be;fe+=st*de,de*=Se[$e]}We=Math.floor(We/Be)}Me[fe]=R(Me[fe],ge[pe],pe,fe)}return se||Se.splice(W,1),[B.type,Me,Se]}function A(R,B=null,W=1,se=!1){const ue=R.data,ge=R.dims;if(B===null){const de=ue.reduce((Xe,Ke)=>Xe+Ke,0)/ue.length,Be=Math.sqrt(ue.reduce((Xe,Ke)=>Xe+(Ke-de)**2,0)/(ue.length-W)),st=new l(R.type,[de],[]);return[new l(R.type,[Be],[]),st]}B=M(B,ge.length);const Ce=D(R,B,se),Se=Ce.data,[Me,pe,fe]=I((We,de,Be,st)=>We+(de-Se[st])**2,R,B,se);for(let We=0;We<pe.length;++We)pe[We]=Math.sqrt(pe[We]/(ge[B]-W));return[new l(Me,pe,fe),Ce]}function D(R,B=null,W=!1){const se=R.dims,ue=R.data;if(B===null){const Me=ue.reduce((pe,fe)=>pe+fe,0);return new l(R.type,[Me/ue.length],[])}B=M(B,se.length);const[ge,Ce,Se]=I((Me,pe)=>Me+pe,R,B,W);if(se[B]!==1)for(let Me=0;Me<Ce.length;++Me)Ce[Me]/=se[B];return new l(ge,Ce,Se)}function L(R){const B=new Array(R.length);for(let W=R.length-1,se=1;W>=0;--W)B[W]=se,se*=R[W];return B}function P(R,B,W,se){const ue=R.reduce((ge,Ce)=>ge*Ce,1);return new l(W,new se(ue).fill(B),R)}function j(R,B){let W,se;if(typeof B=="number")W="float32",se=Float32Array;else if(typeof B=="bigint")W="int64",se=BigInt64Array;else if(typeof B=="boolean")W="bool",se=Uint8Array;else throw new Error(`Unsupported data type: ${typeof B}`);return P(R,B,W,se)}function G(R,B){return j(R.dims,B)}function Q(R){return P(R,1n,"int64",BigInt64Array)}function q(R){return Q(R.dims)}function te(R){return P(R,0n,"int64",BigInt64Array)}function Z(R){return te(R.dims)}function ne(R){const B=R.reduce((W,se)=>W*se,1);return new l("float32",Float32Array.from({length:B},()=>Math.random()),R)}function le(R){const B=R.reduce((se,ue)=>se*ue,1);function W(){const se=1-Math.random(),ue=1-Math.random();return Math.sqrt(-2*Math.log(se))*Math.cos(2*Math.PI*ue)}return new l("float32",Float32Array.from({length:B},()=>W()),R)}function H(R,B){if(R.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(R.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(B))throw new Error("The precision must be either 'binary' or 'ubinary'");const W=B==="binary",se=W?"int8":"uint8",ue=W?Int8Array:Uint8Array,ge=R.data,Ce=new ue(ge.length/8);for(let Se=0;Se<ge.length;++Se){const Me=ge[Se]>0?1:0,pe=Math.floor(Se/8),fe=Se%8;Ce[pe]|=Me<<7-fe,W&&fe===0&&(Ce[pe]-=128)}return new l(se,Ce,[R.dims[0],R.dims[1]/8])}}),"./src/utils/video.js":((n,e,t)=>{t.r(e),t.d(e,{RawVideo:()=>o,RawVideoFrame:()=>a,load_video:()=>l});var s=t("./src/utils/image.js"),r=t("./src/env.js");class a{constructor(u,f){this.image=u,this.timestamp=f}}class o{constructor(u,f){u.length>0&&u[0]instanceof s.RawImage&&(u=u.map((d,h)=>new a(d,(h+1)/(u.length+1)*f))),this.frames=u,this.duration=f}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function l(c,{num_frames:u=null,fps:f=null}={}){if(!r.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(u==null&&f==null)throw new Error("Either num_frames or fps must be provided.");const d=[],h=document.createElement("video");if(h.crossOrigin="anonymous",h.muted=!0,typeof c=="string")h.src=c;else if(c instanceof Blob)h.src=URL.createObjectURL(c);else if(c instanceof HTMLVideoElement)h.src=c.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(S=>h.onloadedmetadata=S),h.seekable.start(0)===h.seekable.end(0)){const C=await(await fetch(h.src)).blob();h.src=URL.createObjectURL(C),await new Promise(M=>h.onloadedmetadata=M)}const p=h.duration;let g,b;u!=null?(g=u,b=u===1?0:p/(u-1)):(b=1/f,g=Math.floor(p/b));let v=[];for(let S=0;S<g;++S)v.push(u===1?p/2:S*b);const w=document.createElement("canvas");w.width=h.videoWidth,w.height=h.videoHeight;const x=w.getContext("2d",{willReadFrequently:!0});for(const S of v){h.currentTime=S,await new Promise(E=>{h.onseeked=E}),x.drawImage(h,0,0,w.width,w.height);const C=x.getImageData(0,0,w.width,w.height),M=new s.RawImage(C.data,w.width,w.height,4),k=new a(M,S);d.push(k)}return h.remove(),new o(d,p)}})},xQ={};function ui(n){var e=xQ[n];if(e!==void 0)return e.exports;var t=xQ[n]={exports:{}};return Gst[n](t,t.exports,ui),t.exports}(()=>{var n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,e;ui.t=function(t,s){if(s&1&&(t=this(t)),s&8||typeof t=="object"&&t&&(s&4&&t.__esModule||s&16&&typeof t.then=="function"))return t;var r=Object.create(null);ui.r(r);var a={};e=e||[null,n({}),n([]),n(n)];for(var o=s&2&&t;typeof o=="object"&&!~e.indexOf(o);o=n(o))Object.getOwnPropertyNames(o).forEach(l=>a[l]=()=>t[l]);return a.default=()=>t,ui.d(r,a),r}})();ui.d=(n,e)=>{for(var t in e)ui.o(e,t)&&!ui.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};ui.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);ui.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var U={};(()=>{ui.r(U),ui.d(U,{ASTFeatureExtractor:()=>d.ASTFeatureExtractor,ASTForAudioClassification:()=>t.ASTForAudioClassification,ASTModel:()=>t.ASTModel,ASTPreTrainedModel:()=>t.ASTPreTrainedModel,AlbertForMaskedLM:()=>t.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>t.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>t.AlbertForSequenceClassification,AlbertModel:()=>t.AlbertModel,AlbertPreTrainedModel:()=>t.AlbertPreTrainedModel,AlbertTokenizer:()=>s.AlbertTokenizer,ArceeForCausalLM:()=>t.ArceeForCausalLM,ArceeModel:()=>t.ArceeModel,ArceePreTrainedModel:()=>t.ArceePreTrainedModel,AudioClassificationPipeline:()=>e.AudioClassificationPipeline,AutoConfig:()=>r.AutoConfig,AutoFeatureExtractor:()=>h.AutoFeatureExtractor,AutoImageProcessor:()=>b.AutoImageProcessor,AutoModel:()=>t.AutoModel,AutoModelForAudioClassification:()=>t.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>t.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>t.AutoModelForAudioTextToText,AutoModelForCTC:()=>t.AutoModelForCTC,AutoModelForCausalLM:()=>t.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>t.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>t.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>t.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>t.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>t.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>t.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>t.AutoModelForImageTextToText,AutoModelForImageToImage:()=>t.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>t.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>t.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>t.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>t.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>t.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>t.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>t.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>t.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>t.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>t.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>t.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>t.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>t.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>t.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>t.AutoModelForVision2Seq,AutoModelForXVector:()=>t.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>t.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>x.AutoProcessor,AutoTokenizer:()=>s.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>e.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>e.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>t.BartForConditionalGeneration,BartForSequenceClassification:()=>t.BartForSequenceClassification,BartModel:()=>t.BartModel,BartPretrainedModel:()=>t.BartPretrainedModel,BartTokenizer:()=>s.BartTokenizer,BaseModelOutput:()=>t.BaseModelOutput,BaseStreamer:()=>S.BaseStreamer,BeitFeatureExtractor:()=>g.BeitFeatureExtractor,BeitForImageClassification:()=>t.BeitForImageClassification,BeitModel:()=>t.BeitModel,BeitPreTrainedModel:()=>t.BeitPreTrainedModel,BertForMaskedLM:()=>t.BertForMaskedLM,BertForQuestionAnswering:()=>t.BertForQuestionAnswering,BertForSequenceClassification:()=>t.BertForSequenceClassification,BertForTokenClassification:()=>t.BertForTokenClassification,BertModel:()=>t.BertModel,BertPreTrainedModel:()=>t.BertPreTrainedModel,BertTokenizer:()=>s.BertTokenizer,BitImageProcessor:()=>g.BitImageProcessor,BlenderbotForConditionalGeneration:()=>t.BlenderbotForConditionalGeneration,BlenderbotModel:()=>t.BlenderbotModel,BlenderbotPreTrainedModel:()=>t.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>t.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>t.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>t.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>s.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>s.BlenderbotTokenizer,BloomForCausalLM:()=>t.BloomForCausalLM,BloomModel:()=>t.BloomModel,BloomPreTrainedModel:()=>t.BloomPreTrainedModel,BloomTokenizer:()=>s.BloomTokenizer,CLIPFeatureExtractor:()=>g.CLIPFeatureExtractor,CLIPImageProcessor:()=>g.CLIPImageProcessor,CLIPModel:()=>t.CLIPModel,CLIPPreTrainedModel:()=>t.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>t.CLIPSegForImageSegmentation,CLIPSegModel:()=>t.CLIPSegModel,CLIPSegPreTrainedModel:()=>t.CLIPSegPreTrainedModel,CLIPTextModel:()=>t.CLIPTextModel,CLIPTextModelWithProjection:()=>t.CLIPTextModelWithProjection,CLIPTokenizer:()=>s.CLIPTokenizer,CLIPVisionModel:()=>t.CLIPVisionModel,CLIPVisionModelWithProjection:()=>t.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>t.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>t.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>t.CamembertForSequenceClassification,CamembertForTokenClassification:()=>t.CamembertForTokenClassification,CamembertModel:()=>t.CamembertModel,CamembertPreTrainedModel:()=>t.CamembertPreTrainedModel,CamembertTokenizer:()=>s.CamembertTokenizer,CausalLMOutput:()=>t.CausalLMOutput,CausalLMOutputWithPast:()=>t.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>g.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>t.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>t.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>t.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>d.ClapFeatureExtractor,ClapModel:()=>t.ClapModel,ClapPreTrainedModel:()=>t.ClapPreTrainedModel,ClapTextModelWithProjection:()=>t.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>M.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>t.CodeGenForCausalLM,CodeGenModel:()=>t.CodeGenModel,CodeGenPreTrainedModel:()=>t.CodeGenPreTrainedModel,CodeGenTokenizer:()=>s.CodeGenTokenizer,CodeLlamaTokenizer:()=>s.CodeLlamaTokenizer,CohereForCausalLM:()=>t.CohereForCausalLM,CohereModel:()=>t.CohereModel,CoherePreTrainedModel:()=>t.CoherePreTrainedModel,CohereTokenizer:()=>s.CohereTokenizer,ConvBertForMaskedLM:()=>t.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>t.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>t.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>t.ConvBertForTokenClassification,ConvBertModel:()=>t.ConvBertModel,ConvBertPreTrainedModel:()=>t.ConvBertPreTrainedModel,ConvBertTokenizer:()=>s.ConvBertTokenizer,ConvNextFeatureExtractor:()=>g.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>t.ConvNextForImageClassification,ConvNextImageProcessor:()=>g.ConvNextImageProcessor,ConvNextModel:()=>t.ConvNextModel,ConvNextPreTrainedModel:()=>t.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>t.ConvNextV2ForImageClassification,ConvNextV2Model:()=>t.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>t.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>t.DFineForObjectDetection,DFineModel:()=>t.DFineModel,DFinePreTrainedModel:()=>t.DFinePreTrainedModel,DINOv3ConvNextModel:()=>t.DINOv3ConvNextModel,DINOv3ConvNextPreTrainedModel:()=>t.DINOv3ConvNextPreTrainedModel,DINOv3ViTImageProcessor:()=>g.DINOv3ViTImageProcessor,DINOv3ViTModel:()=>t.DINOv3ViTModel,DINOv3ViTPreTrainedModel:()=>t.DINOv3ViTPreTrainedModel,DPTFeatureExtractor:()=>g.DPTFeatureExtractor,DPTForDepthEstimation:()=>t.DPTForDepthEstimation,DPTImageProcessor:()=>g.DPTImageProcessor,DPTModel:()=>t.DPTModel,DPTPreTrainedModel:()=>t.DPTPreTrainedModel,DacDecoderModel:()=>t.DacDecoderModel,DacDecoderOutput:()=>t.DacDecoderOutput,DacEncoderModel:()=>t.DacEncoderModel,DacEncoderOutput:()=>t.DacEncoderOutput,DacFeatureExtractor:()=>d.DacFeatureExtractor,DacModel:()=>t.DacModel,DacPreTrainedModel:()=>t.DacPreTrainedModel,DataTypeMap:()=>c.DataTypeMap,DebertaForMaskedLM:()=>t.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>t.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>t.DebertaForSequenceClassification,DebertaForTokenClassification:()=>t.DebertaForTokenClassification,DebertaModel:()=>t.DebertaModel,DebertaPreTrainedModel:()=>t.DebertaPreTrainedModel,DebertaTokenizer:()=>s.DebertaTokenizer,DebertaV2ForMaskedLM:()=>t.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>t.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>t.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>t.DebertaV2ForTokenClassification,DebertaV2Model:()=>t.DebertaV2Model,DebertaV2PreTrainedModel:()=>t.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>s.DebertaV2Tokenizer,DecisionTransformerModel:()=>t.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>t.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>g.DeiTFeatureExtractor,DeiTForImageClassification:()=>t.DeiTForImageClassification,DeiTImageProcessor:()=>g.DeiTImageProcessor,DeiTModel:()=>t.DeiTModel,DeiTPreTrainedModel:()=>t.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>t.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>t.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>e.DepthEstimationPipeline,DepthProForDepthEstimation:()=>t.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>t.DepthProPreTrainedModel,DetrFeatureExtractor:()=>g.DetrFeatureExtractor,DetrForObjectDetection:()=>t.DetrForObjectDetection,DetrForSegmentation:()=>t.DetrForSegmentation,DetrImageProcessor:()=>g.DetrImageProcessor,DetrModel:()=>t.DetrModel,DetrObjectDetectionOutput:()=>t.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>t.DetrPreTrainedModel,DetrSegmentationOutput:()=>t.DetrSegmentationOutput,Dinov2ForImageClassification:()=>t.Dinov2ForImageClassification,Dinov2Model:()=>t.Dinov2Model,Dinov2PreTrainedModel:()=>t.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>t.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>t.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>t.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>t.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>t.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>t.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>t.DistilBertForTokenClassification,DistilBertModel:()=>t.DistilBertModel,DistilBertPreTrainedModel:()=>t.DistilBertPreTrainedModel,DistilBertTokenizer:()=>s.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>e.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>g.DonutFeatureExtractor,DonutImageProcessor:()=>g.DonutImageProcessor,DonutSwinModel:()=>t.DonutSwinModel,DonutSwinPreTrainedModel:()=>t.DonutSwinPreTrainedModel,EdgeTamModel:()=>t.EdgeTamModel,EfficientNetForImageClassification:()=>t.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>g.EfficientNetImageProcessor,EfficientNetModel:()=>t.EfficientNetModel,EfficientNetPreTrainedModel:()=>t.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>t.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>t.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>t.ElectraForSequenceClassification,ElectraForTokenClassification:()=>t.ElectraForTokenClassification,ElectraModel:()=>t.ElectraModel,ElectraPreTrainedModel:()=>t.ElectraPreTrainedModel,ElectraTokenizer:()=>s.ElectraTokenizer,EncodecFeatureExtractor:()=>d.EncodecFeatureExtractor,EosTokenCriteria:()=>C.EosTokenCriteria,Ernie4_5ForCausalLM:()=>t.Ernie4_5ForCausalLM,Ernie4_5Model:()=>t.Ernie4_5Model,Ernie4_5PreTrainedModel:()=>t.Ernie4_5PreTrainedModel,EsmForMaskedLM:()=>t.EsmForMaskedLM,EsmForSequenceClassification:()=>t.EsmForSequenceClassification,EsmForTokenClassification:()=>t.EsmForTokenClassification,EsmModel:()=>t.EsmModel,EsmPreTrainedModel:()=>t.EsmPreTrainedModel,EsmTokenizer:()=>s.EsmTokenizer,ExaoneForCausalLM:()=>t.ExaoneForCausalLM,ExaoneModel:()=>t.ExaoneModel,ExaonePreTrainedModel:()=>t.ExaonePreTrainedModel,FFT:()=>u.FFT,FalconForCausalLM:()=>t.FalconForCausalLM,FalconModel:()=>t.FalconModel,FalconPreTrainedModel:()=>t.FalconPreTrainedModel,FalconTokenizer:()=>s.FalconTokenizer,FastViTForImageClassification:()=>t.FastViTForImageClassification,FastViTModel:()=>t.FastViTModel,FastViTPreTrainedModel:()=>t.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>e.FeatureExtractionPipeline,FeatureExtractor:()=>f.FeatureExtractor,FillMaskPipeline:()=>e.FillMaskPipeline,Florence2ForConditionalGeneration:()=>t.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>t.Florence2PreTrainedModel,Florence2Processor:()=>w.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>M.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>M.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>g.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>t.GLPNForDepthEstimation,GLPNModel:()=>t.GLPNModel,GLPNPreTrainedModel:()=>t.GLPNPreTrainedModel,GPT2LMHeadModel:()=>t.GPT2LMHeadModel,GPT2Model:()=>t.GPT2Model,GPT2PreTrainedModel:()=>t.GPT2PreTrainedModel,GPT2Tokenizer:()=>s.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>t.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>t.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>t.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>t.GPTJForCausalLM,GPTJModel:()=>t.GPTJModel,GPTJPreTrainedModel:()=>t.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>t.GPTNeoForCausalLM,GPTNeoModel:()=>t.GPTNeoModel,GPTNeoPreTrainedModel:()=>t.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>t.GPTNeoXForCausalLM,GPTNeoXModel:()=>t.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>t.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>s.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>t.Gemma2ForCausalLM,Gemma2Model:()=>t.Gemma2Model,Gemma2PreTrainedModel:()=>t.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>t.Gemma3ForCausalLM,Gemma3Model:()=>t.Gemma3Model,Gemma3PreTrainedModel:()=>t.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>d.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>t.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>t.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>w.Gemma3nProcessor,GemmaForCausalLM:()=>t.GemmaForCausalLM,GemmaModel:()=>t.GemmaModel,GemmaPreTrainedModel:()=>t.GemmaPreTrainedModel,GemmaTokenizer:()=>s.GemmaTokenizer,GlmForCausalLM:()=>t.GlmForCausalLM,GlmModel:()=>t.GlmModel,GlmPreTrainedModel:()=>t.GlmPreTrainedModel,GraniteForCausalLM:()=>t.GraniteForCausalLM,GraniteModel:()=>t.GraniteModel,GraniteMoeHybridForCausalLM:()=>t.GraniteMoeHybridForCausalLM,GraniteMoeHybridModel:()=>t.GraniteMoeHybridModel,GraniteMoeHybridPreTrainedModel:()=>t.GraniteMoeHybridPreTrainedModel,GranitePreTrainedModel:()=>t.GranitePreTrainedModel,Grok1Tokenizer:()=>s.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>t.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>g.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>t.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>w.GroundingDinoProcessor,GroupViTModel:()=>t.GroupViTModel,GroupViTPreTrainedModel:()=>t.GroupViTPreTrainedModel,HeliumForCausalLM:()=>t.HeliumForCausalLM,HeliumModel:()=>t.HeliumModel,HeliumPreTrainedModel:()=>t.HeliumPreTrainedModel,HerbertTokenizer:()=>s.HerbertTokenizer,HieraForImageClassification:()=>t.HieraForImageClassification,HieraModel:()=>t.HieraModel,HieraPreTrainedModel:()=>t.HieraPreTrainedModel,HubertForCTC:()=>t.HubertForCTC,HubertForSequenceClassification:()=>t.HubertForSequenceClassification,HubertModel:()=>t.HubertModel,HubertPreTrainedModel:()=>t.HubertPreTrainedModel,IJepaForImageClassification:()=>t.IJepaForImageClassification,IJepaModel:()=>t.IJepaModel,IJepaPreTrainedModel:()=>t.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>t.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>g.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>t.Idefics3PreTrainedModel,Idefics3Processor:()=>w.Idefics3Processor,ImageClassificationPipeline:()=>e.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>e.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>d.ImageFeatureExtractor,ImageMattingOutput:()=>t.ImageMattingOutput,ImageProcessor:()=>p.ImageProcessor,ImageSegmentationPipeline:()=>e.ImageSegmentationPipeline,ImageToImagePipeline:()=>e.ImageToImagePipeline,ImageToTextPipeline:()=>e.ImageToTextPipeline,InterruptableStoppingCriteria:()=>C.InterruptableStoppingCriteria,JAISLMHeadModel:()=>t.JAISLMHeadModel,JAISModel:()=>t.JAISModel,JAISPreTrainedModel:()=>t.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>g.JinaCLIPImageProcessor,JinaCLIPModel:()=>t.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>t.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>w.JinaCLIPProcessor,JinaCLIPTextModel:()=>t.JinaCLIPTextModel,JinaCLIPVisionModel:()=>t.JinaCLIPVisionModel,Lfm2ForCausalLM:()=>t.Lfm2ForCausalLM,Lfm2Model:()=>t.Lfm2Model,Lfm2PreTrainedModel:()=>t.Lfm2PreTrainedModel,LiteWhisperForConditionalGeneration:()=>t.LiteWhisperForConditionalGeneration,Llama4ForCausalLM:()=>t.Llama4ForCausalLM,Llama4PreTrainedModel:()=>t.Llama4PreTrainedModel,LlamaForCausalLM:()=>t.LlamaForCausalLM,LlamaModel:()=>t.LlamaModel,LlamaPreTrainedModel:()=>t.LlamaPreTrainedModel,LlamaTokenizer:()=>s.LlamaTokenizer,LlavaForConditionalGeneration:()=>t.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>t.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>g.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>t.LlavaPreTrainedModel,LlavaProcessor:()=>w.LlavaProcessor,LlavaQwen2ForCausalLM:()=>t.LlavaQwen2ForCausalLM,LogitsProcessor:()=>M.LogitsProcessor,LogitsProcessorList:()=>M.LogitsProcessorList,LogitsWarper:()=>M.LogitsWarper,LongT5ForConditionalGeneration:()=>t.LongT5ForConditionalGeneration,LongT5Model:()=>t.LongT5Model,LongT5PreTrainedModel:()=>t.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>t.M2M100ForConditionalGeneration,M2M100Model:()=>t.M2M100Model,M2M100PreTrainedModel:()=>t.M2M100PreTrainedModel,M2M100Tokenizer:()=>s.M2M100Tokenizer,MBart50Tokenizer:()=>s.MBart50Tokenizer,MBartForCausalLM:()=>t.MBartForCausalLM,MBartForConditionalGeneration:()=>t.MBartForConditionalGeneration,MBartForSequenceClassification:()=>t.MBartForSequenceClassification,MBartModel:()=>t.MBartModel,MBartPreTrainedModel:()=>t.MBartPreTrainedModel,MBartTokenizer:()=>s.MBartTokenizer,MPNetForMaskedLM:()=>t.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>t.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>t.MPNetForSequenceClassification,MPNetForTokenClassification:()=>t.MPNetForTokenClassification,MPNetModel:()=>t.MPNetModel,MPNetPreTrainedModel:()=>t.MPNetPreTrainedModel,MPNetTokenizer:()=>s.MPNetTokenizer,MT5ForConditionalGeneration:()=>t.MT5ForConditionalGeneration,MT5Model:()=>t.MT5Model,MT5PreTrainedModel:()=>t.MT5PreTrainedModel,MarianMTModel:()=>t.MarianMTModel,MarianModel:()=>t.MarianModel,MarianPreTrainedModel:()=>t.MarianPreTrainedModel,MarianTokenizer:()=>s.MarianTokenizer,Mask2FormerImageProcessor:()=>g.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>g.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>t.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>g.MaskFormerImageProcessor,MaskFormerModel:()=>t.MaskFormerModel,MaskFormerPreTrainedModel:()=>t.MaskFormerPreTrainedModel,MaskedLMOutput:()=>t.MaskedLMOutput,MaxLengthCriteria:()=>C.MaxLengthCriteria,Metric3DForDepthEstimation:()=>t.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>t.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>t.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>t.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>t.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>t.MgpstrModelOutput,MgpstrPreTrainedModel:()=>t.MgpstrPreTrainedModel,MgpstrProcessor:()=>w.MgpstrProcessor,MgpstrTokenizer:()=>s.MgpstrTokenizer,MimiDecoderModel:()=>t.MimiDecoderModel,MimiDecoderOutput:()=>t.MimiDecoderOutput,MimiEncoderModel:()=>t.MimiEncoderModel,MimiEncoderOutput:()=>t.MimiEncoderOutput,MimiModel:()=>t.MimiModel,MimiPreTrainedModel:()=>t.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>M.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>M.MinNewTokensLengthLogitsProcessor,Ministral3ForCausalLM:()=>t.Ministral3ForCausalLM,Ministral3Model:()=>t.Ministral3Model,Ministral3PreTrainedModel:()=>t.Ministral3PreTrainedModel,MinistralForCausalLM:()=>t.MinistralForCausalLM,MinistralModel:()=>t.MinistralModel,MinistralPreTrainedModel:()=>t.MinistralPreTrainedModel,Mistral3ForConditionalGeneration:()=>t.Mistral3ForConditionalGeneration,MistralForCausalLM:()=>t.MistralForCausalLM,MistralModel:()=>t.MistralModel,MistralPreTrainedModel:()=>t.MistralPreTrainedModel,MobileBertForMaskedLM:()=>t.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>t.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>t.MobileBertForSequenceClassification,MobileBertModel:()=>t.MobileBertModel,MobileBertPreTrainedModel:()=>t.MobileBertPreTrainedModel,MobileBertTokenizer:()=>s.MobileBertTokenizer,MobileLLMForCausalLM:()=>t.MobileLLMForCausalLM,MobileLLMModel:()=>t.MobileLLMModel,MobileLLMPreTrainedModel:()=>t.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>g.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>t.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>t.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>g.MobileNetV1ImageProcessor,MobileNetV1Model:()=>t.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>t.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>g.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>t.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>t.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>g.MobileNetV2ImageProcessor,MobileNetV2Model:()=>t.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>t.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>g.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>t.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>t.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>g.MobileNetV3ImageProcessor,MobileNetV3Model:()=>t.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>t.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>g.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>t.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>t.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>g.MobileNetV4ImageProcessor,MobileNetV4Model:()=>t.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>t.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>g.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>t.MobileViTForImageClassification,MobileViTImageProcessor:()=>g.MobileViTImageProcessor,MobileViTModel:()=>t.MobileViTModel,MobileViTPreTrainedModel:()=>t.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>t.MobileViTV2ForImageClassification,MobileViTV2Model:()=>t.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>t.MobileViTV2PreTrainedModel,ModelOutput:()=>t.ModelOutput,ModernBertDecoderForCausalLM:()=>t.ModernBertDecoderForCausalLM,ModernBertDecoderModel:()=>t.ModernBertDecoderModel,ModernBertDecoderPreTrainedModel:()=>t.ModernBertDecoderPreTrainedModel,ModernBertForMaskedLM:()=>t.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>t.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>t.ModernBertForTokenClassification,ModernBertModel:()=>t.ModernBertModel,ModernBertPreTrainedModel:()=>t.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>t.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>d.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>t.MoonshineForConditionalGeneration,MoonshineModel:()=>t.MoonshineModel,MoonshinePreTrainedModel:()=>t.MoonshinePreTrainedModel,MoonshineProcessor:()=>w.MoonshineProcessor,MptForCausalLM:()=>t.MptForCausalLM,MptModel:()=>t.MptModel,MptPreTrainedModel:()=>t.MptPreTrainedModel,MultiModalityCausalLM:()=>t.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>t.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>t.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>t.MusicgenForConditionalGeneration,MusicgenModel:()=>t.MusicgenModel,MusicgenPreTrainedModel:()=>t.MusicgenPreTrainedModel,NanoChatForCausalLM:()=>t.NanoChatForCausalLM,NanoChatModel:()=>t.NanoChatModel,NanoChatPreTrainedModel:()=>t.NanoChatPreTrainedModel,NeoBertForMaskedLM:()=>t.NeoBertForMaskedLM,NeoBertForQuestionAnswering:()=>t.NeoBertForQuestionAnswering,NeoBertForSequenceClassification:()=>t.NeoBertForSequenceClassification,NeoBertForTokenClassification:()=>t.NeoBertForTokenClassification,NeoBertModel:()=>t.NeoBertModel,NeoBertPreTrainedModel:()=>t.NeoBertPreTrainedModel,NllbTokenizer:()=>s.NllbTokenizer,NoBadWordsLogitsProcessor:()=>M.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>M.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>t.NomicBertModel,NomicBertPreTrainedModel:()=>t.NomicBertPreTrainedModel,NougatImageProcessor:()=>g.NougatImageProcessor,NougatTokenizer:()=>s.NougatTokenizer,OPTForCausalLM:()=>t.OPTForCausalLM,OPTModel:()=>t.OPTModel,OPTPreTrainedModel:()=>t.OPTPreTrainedModel,ObjectDetectionPipeline:()=>e.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>t.Olmo2ForCausalLM,Olmo2Model:()=>t.Olmo2Model,Olmo2PreTrainedModel:()=>t.Olmo2PreTrainedModel,OlmoForCausalLM:()=>t.OlmoForCausalLM,OlmoModel:()=>t.OlmoModel,OlmoPreTrainedModel:()=>t.OlmoPreTrainedModel,OpenELMForCausalLM:()=>t.OpenELMForCausalLM,OpenELMModel:()=>t.OpenELMModel,OpenELMPreTrainedModel:()=>t.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>g.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>t.OwlViTForObjectDetection,OwlViTImageProcessor:()=>g.OwlViTImageProcessor,OwlViTModel:()=>t.OwlViTModel,OwlViTPreTrainedModel:()=>t.OwlViTPreTrainedModel,OwlViTProcessor:()=>w.OwlViTProcessor,Owlv2ForObjectDetection:()=>t.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>g.Owlv2ImageProcessor,Owlv2Model:()=>t.Owlv2Model,Owlv2PreTrainedModel:()=>t.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>t.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>t.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>w.PaliGemmaProcessor,ParakeetFeatureExtractor:()=>d.ParakeetFeatureExtractor,ParakeetForCTC:()=>t.ParakeetForCTC,ParakeetPreTrainedModel:()=>t.ParakeetPreTrainedModel,PatchTSMixerForPrediction:()=>t.PatchTSMixerForPrediction,PatchTSMixerModel:()=>t.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>t.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>t.PatchTSTForPrediction,PatchTSTModel:()=>t.PatchTSTModel,PatchTSTPreTrainedModel:()=>t.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>t.Phi3ForCausalLM,Phi3Model:()=>t.Phi3Model,Phi3PreTrainedModel:()=>t.Phi3PreTrainedModel,Phi3VForCausalLM:()=>t.Phi3VForCausalLM,Phi3VImageProcessor:()=>g.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>t.Phi3VPreTrainedModel,Phi3VProcessor:()=>w.Phi3VProcessor,PhiForCausalLM:()=>t.PhiForCausalLM,PhiModel:()=>t.PhiModel,PhiPreTrainedModel:()=>t.PhiPreTrainedModel,Pipeline:()=>e.Pipeline,PixtralImageProcessor:()=>g.PixtralImageProcessor,PixtralProcessor:()=>w.PixtralProcessor,PreTrainedModel:()=>t.PreTrainedModel,PreTrainedTokenizer:()=>s.PreTrainedTokenizer,PretrainedConfig:()=>r.PretrainedConfig,PretrainedMixin:()=>t.PretrainedMixin,Processor:()=>v.Processor,PvtForImageClassification:()=>t.PvtForImageClassification,PvtImageProcessor:()=>g.PvtImageProcessor,PvtModel:()=>t.PvtModel,PvtPreTrainedModel:()=>t.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>d.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>t.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>t.PyAnnoteModel,PyAnnotePreTrainedModel:()=>t.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>w.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>t.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>e.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>t.Qwen2ForCausalLM,Qwen2Model:()=>t.Qwen2Model,Qwen2PreTrainedModel:()=>t.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>s.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>t.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>g.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>t.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>w.Qwen2VLProcessor,Qwen3ForCausalLM:()=>t.Qwen3ForCausalLM,Qwen3Model:()=>t.Qwen3Model,Qwen3PreTrainedModel:()=>t.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>t.RFDetrForObjectDetection,RFDetrModel:()=>t.RFDetrModel,RFDetrObjectDetectionOutput:()=>t.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>t.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>t.RTDetrForObjectDetection,RTDetrImageProcessor:()=>g.RTDetrImageProcessor,RTDetrModel:()=>t.RTDetrModel,RTDetrObjectDetectionOutput:()=>t.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>t.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>t.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>t.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>t.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>t.RTDetrV2PreTrainedModel,RawAudio:()=>a.RawAudio,RawImage:()=>o.RawImage,RawVideo:()=>l.RawVideo,RawVideoFrame:()=>l.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>M.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>t.ResNetForImageClassification,ResNetModel:()=>t.ResNetModel,ResNetPreTrainedModel:()=>t.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>t.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>t.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>t.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>t.RoFormerForTokenClassification,RoFormerModel:()=>t.RoFormerModel,RoFormerPreTrainedModel:()=>t.RoFormerPreTrainedModel,RoFormerTokenizer:()=>s.RoFormerTokenizer,RobertaForMaskedLM:()=>t.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>t.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>t.RobertaForSequenceClassification,RobertaForTokenClassification:()=>t.RobertaForTokenClassification,RobertaModel:()=>t.RobertaModel,RobertaPreTrainedModel:()=>t.RobertaPreTrainedModel,RobertaTokenizer:()=>s.RobertaTokenizer,Sam2ImageProcessor:()=>g.Sam2ImageProcessor,Sam2ImageSegmentationOutput:()=>t.Sam2ImageSegmentationOutput,Sam2Model:()=>t.Sam2Model,Sam2PreTrainedModel:()=>t.Sam2PreTrainedModel,Sam2Processor:()=>w.Sam2Processor,Sam2VideoProcessor:()=>w.Sam2VideoProcessor,Sam3ImageProcessor:()=>g.Sam3ImageProcessor,Sam3TrackerModel:()=>t.Sam3TrackerModel,SamImageProcessor:()=>g.SamImageProcessor,SamImageSegmentationOutput:()=>t.SamImageSegmentationOutput,SamModel:()=>t.SamModel,SamPreTrainedModel:()=>t.SamPreTrainedModel,SamProcessor:()=>w.SamProcessor,SapiensForDepthEstimation:()=>t.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>t.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>t.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>t.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>d.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>g.SegformerFeatureExtractor,SegformerForImageClassification:()=>t.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>t.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>g.SegformerImageProcessor,SegformerModel:()=>t.SegformerModel,SegformerPreTrainedModel:()=>t.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>t.Seq2SeqLMOutput,SequenceClassifierOutput:()=>t.SequenceClassifierOutput,SiglipImageProcessor:()=>g.SiglipImageProcessor,SiglipModel:()=>t.SiglipModel,SiglipPreTrainedModel:()=>t.SiglipPreTrainedModel,SiglipTextModel:()=>t.SiglipTextModel,SiglipTokenizer:()=>s.SiglipTokenizer,SiglipVisionModel:()=>t.SiglipVisionModel,SmolLM3ForCausalLM:()=>t.SmolLM3ForCausalLM,SmolLM3Model:()=>t.SmolLM3Model,SmolLM3PreTrainedModel:()=>t.SmolLM3PreTrainedModel,SmolVLMForConditionalGeneration:()=>t.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>g.SmolVLMImageProcessor,SmolVLMProcessor:()=>w.SmolVLMProcessor,SnacDecoderModel:()=>t.SnacDecoderModel,SnacEncoderModel:()=>t.SnacEncoderModel,SnacFeatureExtractor:()=>d.SnacFeatureExtractor,SnacModel:()=>t.SnacModel,SnacPreTrainedModel:()=>t.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>d.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>t.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>t.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>t.SpeechT5HifiGan,SpeechT5Model:()=>t.SpeechT5Model,SpeechT5PreTrainedModel:()=>t.SpeechT5PreTrainedModel,SpeechT5Processor:()=>w.SpeechT5Processor,SpeechT5Tokenizer:()=>s.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>t.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>t.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>t.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>t.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>t.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>s.SqueezeBertTokenizer,StableLmForCausalLM:()=>t.StableLmForCausalLM,StableLmModel:()=>t.StableLmModel,StableLmPreTrainedModel:()=>t.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>t.Starcoder2ForCausalLM,Starcoder2Model:()=>t.Starcoder2Model,Starcoder2PreTrainedModel:()=>t.Starcoder2PreTrainedModel,StoppingCriteria:()=>C.StoppingCriteria,StoppingCriteriaList:()=>C.StoppingCriteriaList,StyleTextToSpeech2Model:()=>t.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>t.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>e.SummarizationPipeline,SupertonicForConditionalGeneration:()=>t.SupertonicForConditionalGeneration,SupertonicPreTrainedModel:()=>t.SupertonicPreTrainedModel,SuppressTokensAtBeginLogitsProcessor:()=>M.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>t.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>g.Swin2SRImageProcessor,Swin2SRModel:()=>t.Swin2SRModel,Swin2SRPreTrainedModel:()=>t.Swin2SRPreTrainedModel,SwinForImageClassification:()=>t.SwinForImageClassification,SwinForSemanticSegmentation:()=>t.SwinForSemanticSegmentation,SwinModel:()=>t.SwinModel,SwinPreTrainedModel:()=>t.SwinPreTrainedModel,T5ForConditionalGeneration:()=>t.T5ForConditionalGeneration,T5Model:()=>t.T5Model,T5PreTrainedModel:()=>t.T5PreTrainedModel,T5Tokenizer:()=>s.T5Tokenizer,TableTransformerForObjectDetection:()=>t.TableTransformerForObjectDetection,TableTransformerModel:()=>t.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>t.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>t.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>M.TemperatureLogitsWarper,Tensor:()=>c.Tensor,Text2TextGenerationPipeline:()=>e.Text2TextGenerationPipeline,TextClassificationPipeline:()=>e.TextClassificationPipeline,TextGenerationPipeline:()=>e.TextGenerationPipeline,TextStreamer:()=>S.TextStreamer,TextToAudioPipeline:()=>e.TextToAudioPipeline,TokenClassificationPipeline:()=>e.TokenClassificationPipeline,TokenClassifierOutput:()=>t.TokenClassifierOutput,TokenizerModel:()=>s.TokenizerModel,TopKLogitsWarper:()=>M.TopKLogitsWarper,TopPLogitsWarper:()=>M.TopPLogitsWarper,TrOCRForCausalLM:()=>t.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>t.TrOCRPreTrainedModel,TranslationPipeline:()=>e.TranslationPipeline,UltravoxModel:()=>t.UltravoxModel,UltravoxPreTrainedModel:()=>t.UltravoxPreTrainedModel,UltravoxProcessor:()=>w.UltravoxProcessor,UniSpeechForCTC:()=>t.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>t.UniSpeechForSequenceClassification,UniSpeechModel:()=>t.UniSpeechModel,UniSpeechPreTrainedModel:()=>t.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>t.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>t.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>t.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>t.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>t.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>w.VLChatProcessor,VLMImageProcessor:()=>g.VLMImageProcessor,VaultGemmaForCausalLM:()=>t.VaultGemmaForCausalLM,VaultGemmaModel:()=>t.VaultGemmaModel,VaultGemmaPreTrainedModel:()=>t.VaultGemmaPreTrainedModel,ViTFeatureExtractor:()=>g.ViTFeatureExtractor,ViTForImageClassification:()=>t.ViTForImageClassification,ViTImageProcessor:()=>g.ViTImageProcessor,ViTMAEModel:()=>t.ViTMAEModel,ViTMAEPreTrainedModel:()=>t.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>t.ViTMSNForImageClassification,ViTMSNModel:()=>t.ViTMSNModel,ViTMSNPreTrainedModel:()=>t.ViTMSNPreTrainedModel,ViTModel:()=>t.ViTModel,ViTPreTrainedModel:()=>t.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>t.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>t.VitMatteForImageMatting,VitMatteImageProcessor:()=>g.VitMatteImageProcessor,VitMattePreTrainedModel:()=>t.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>t.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>g.VitPoseImageProcessor,VitPosePreTrainedModel:()=>t.VitPosePreTrainedModel,VitsModel:()=>t.VitsModel,VitsModelOutput:()=>t.VitsModelOutput,VitsPreTrainedModel:()=>t.VitsPreTrainedModel,VitsTokenizer:()=>s.VitsTokenizer,VoxtralForConditionalGeneration:()=>t.VoxtralForConditionalGeneration,VoxtralProcessor:()=>w.VoxtralProcessor,Wav2Vec2BertForCTC:()=>t.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>t.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>t.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>t.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>s.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>d.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>t.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>t.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>t.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>t.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>t.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>w.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>w.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>t.WavLMForAudioFrameClassification,WavLMForCTC:()=>t.WavLMForCTC,WavLMForSequenceClassification:()=>t.WavLMForSequenceClassification,WavLMForXVector:()=>t.WavLMForXVector,WavLMModel:()=>t.WavLMModel,WavLMPreTrainedModel:()=>t.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>d.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>t.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>t.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>d.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>t.WhisperForConditionalGeneration,WhisperModel:()=>t.WhisperModel,WhisperPreTrainedModel:()=>t.WhisperPreTrainedModel,WhisperProcessor:()=>w.WhisperProcessor,WhisperTextStreamer:()=>S.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>M.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>s.WhisperTokenizer,XLMForQuestionAnswering:()=>t.XLMForQuestionAnswering,XLMForSequenceClassification:()=>t.XLMForSequenceClassification,XLMForTokenClassification:()=>t.XLMForTokenClassification,XLMModel:()=>t.XLMModel,XLMPreTrainedModel:()=>t.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>t.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>t.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>t.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>t.XLMRobertaForTokenClassification,XLMRobertaModel:()=>t.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>t.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>s.XLMRobertaTokenizer,XLMTokenizer:()=>s.XLMTokenizer,XLMWithLMHeadModel:()=>t.XLMWithLMHeadModel,XVectorOutput:()=>t.XVectorOutput,YolosFeatureExtractor:()=>g.YolosFeatureExtractor,YolosForObjectDetection:()=>t.YolosForObjectDetection,YolosImageProcessor:()=>g.YolosImageProcessor,YolosModel:()=>t.YolosModel,YolosObjectDetectionOutput:()=>t.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>t.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>e.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>e.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>e.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>e.ZeroShotObjectDetectionPipeline,bankers_round:()=>u.bankers_round,cat:()=>c.cat,cos_sim:()=>u.cos_sim,dot:()=>u.dot,dynamic_time_warping:()=>u.dynamic_time_warping,env:()=>n.env,full:()=>c.full,full_like:()=>c.full_like,getCacheShapes:()=>r.getCacheShapes,hamming:()=>a.hamming,hanning:()=>a.hanning,interpolate:()=>c.interpolate,interpolate_4d:()=>c.interpolate_4d,interpolate_data:()=>u.interpolate_data,is_chinese_char:()=>s.is_chinese_char,layer_norm:()=>c.layer_norm,load_image:()=>o.load_image,load_video:()=>l.load_video,log_softmax:()=>u.log_softmax,magnitude:()=>u.magnitude,matmul:()=>c.matmul,max:()=>u.max,mean:()=>c.mean,mean_pooling:()=>c.mean_pooling,medianFilter:()=>u.medianFilter,mel_filter_bank:()=>a.mel_filter_bank,min:()=>u.min,ones:()=>c.ones,ones_like:()=>c.ones_like,permute:()=>c.permute,permute_data:()=>u.permute_data,pipeline:()=>e.pipeline,quantize_embeddings:()=>c.quantize_embeddings,rand:()=>c.rand,randn:()=>c.randn,read_audio:()=>a.read_audio,rfft:()=>c.rfft,round:()=>u.round,slice:()=>c.slice,softmax:()=>u.softmax,spectrogram:()=>a.spectrogram,stack:()=>c.stack,std_mean:()=>c.std_mean,topk:()=>c.topk,window_function:()=>a.window_function,zeros:()=>c.zeros,zeros_like:()=>c.zeros_like});var n=ui("./src/env.js"),e=ui("./src/pipelines.js"),t=ui("./src/models.js"),s=ui("./src/tokenizers.js"),r=ui("./src/configs.js"),a=ui("./src/utils/audio.js"),o=ui("./src/utils/image.js"),l=ui("./src/utils/video.js"),c=ui("./src/utils/tensor.js"),u=ui("./src/utils/maths.js"),f=ui("./src/base/feature_extraction_utils.js"),d=ui("./src/models/feature_extractors.js"),h=ui("./src/models/auto/feature_extraction_auto.js"),p=ui("./src/base/image_processors_utils.js"),g=ui("./src/models/image_processors.js"),b=ui("./src/models/auto/image_processing_auto.js"),v=ui("./src/base/processing_utils.js"),w=ui("./src/models/processors.js"),x=ui("./src/models/auto/processing_auto.js"),S=ui("./src/generation/streamers.js"),C=ui("./src/generation/stopping_criteria.js"),M=ui("./src/generation/logits_process.js")})();U.ASTFeatureExtractor;U.ASTForAudioClassification;U.ASTModel;U.ASTPreTrainedModel;U.AlbertForMaskedLM;U.AlbertForQuestionAnswering;U.AlbertForSequenceClassification;U.AlbertModel;U.AlbertPreTrainedModel;U.AlbertTokenizer;U.ArceeForCausalLM;U.ArceeModel;U.ArceePreTrainedModel;U.AudioClassificationPipeline;U.AutoConfig;U.AutoFeatureExtractor;U.AutoImageProcessor;var Hst=U.AutoModel;U.AutoModelForAudioClassification;U.AutoModelForAudioFrameClassification;U.AutoModelForAudioTextToText;U.AutoModelForCTC;U.AutoModelForCausalLM;U.AutoModelForDepthEstimation;U.AutoModelForDocumentQuestionAnswering;U.AutoModelForImageClassification;U.AutoModelForImageFeatureExtraction;U.AutoModelForImageMatting;U.AutoModelForImageSegmentation;U.AutoModelForImageTextToText;U.AutoModelForImageToImage;U.AutoModelForMaskGeneration;U.AutoModelForMaskedLM;U.AutoModelForNormalEstimation;U.AutoModelForObjectDetection;U.AutoModelForPoseEstimation;U.AutoModelForQuestionAnswering;U.AutoModelForSemanticSegmentation;U.AutoModelForSeq2SeqLM;U.AutoModelForSequenceClassification;U.AutoModelForSpeechSeq2Seq;U.AutoModelForTextToSpectrogram;U.AutoModelForTextToWaveform;U.AutoModelForTokenClassification;U.AutoModelForUniversalSegmentation;U.AutoModelForVision2Seq;U.AutoModelForXVector;U.AutoModelForZeroShotObjectDetection;var qst=U.AutoProcessor;U.AutoTokenizer;U.AutomaticSpeechRecognitionPipeline;U.BackgroundRemovalPipeline;U.BartForConditionalGeneration;U.BartForSequenceClassification;U.BartModel;U.BartPretrainedModel;U.BartTokenizer;U.BaseModelOutput;U.BaseStreamer;U.BeitFeatureExtractor;U.BeitForImageClassification;U.BeitModel;U.BeitPreTrainedModel;U.BertForMaskedLM;U.BertForQuestionAnswering;U.BertForSequenceClassification;U.BertForTokenClassification;U.BertModel;U.BertPreTrainedModel;U.BertTokenizer;U.BitImageProcessor;U.BlenderbotForConditionalGeneration;U.BlenderbotModel;U.BlenderbotPreTrainedModel;U.BlenderbotSmallForConditionalGeneration;U.BlenderbotSmallModel;U.BlenderbotSmallPreTrainedModel;U.BlenderbotSmallTokenizer;U.BlenderbotTokenizer;U.BloomForCausalLM;U.BloomModel;U.BloomPreTrainedModel;U.BloomTokenizer;U.CLIPFeatureExtractor;U.CLIPImageProcessor;U.CLIPModel;U.CLIPPreTrainedModel;U.CLIPSegForImageSegmentation;U.CLIPSegModel;U.CLIPSegPreTrainedModel;U.CLIPTextModel;U.CLIPTextModelWithProjection;U.CLIPTokenizer;U.CLIPVisionModel;U.CLIPVisionModelWithProjection;U.CamembertForMaskedLM;U.CamembertForQuestionAnswering;U.CamembertForSequenceClassification;U.CamembertForTokenClassification;U.CamembertModel;U.CamembertPreTrainedModel;U.CamembertTokenizer;U.CausalLMOutput;U.CausalLMOutputWithPast;U.ChineseCLIPFeatureExtractor;U.ChineseCLIPModel;U.ChineseCLIPPreTrainedModel;U.ClapAudioModelWithProjection;U.ClapFeatureExtractor;U.ClapModel;U.ClapPreTrainedModel;U.ClapTextModelWithProjection;U.ClassifierFreeGuidanceLogitsProcessor;U.CodeGenForCausalLM;U.CodeGenModel;U.CodeGenPreTrainedModel;U.CodeGenTokenizer;U.CodeLlamaTokenizer;U.CohereForCausalLM;U.CohereModel;U.CoherePreTrainedModel;U.CohereTokenizer;U.ConvBertForMaskedLM;U.ConvBertForQuestionAnswering;U.ConvBertForSequenceClassification;U.ConvBertForTokenClassification;U.ConvBertModel;U.ConvBertPreTrainedModel;U.ConvBertTokenizer;U.ConvNextFeatureExtractor;U.ConvNextForImageClassification;U.ConvNextImageProcessor;U.ConvNextModel;U.ConvNextPreTrainedModel;U.ConvNextV2ForImageClassification;U.ConvNextV2Model;U.ConvNextV2PreTrainedModel;U.DFineForObjectDetection;U.DFineModel;U.DFinePreTrainedModel;U.DINOv3ConvNextModel;U.DINOv3ConvNextPreTrainedModel;U.DINOv3ViTImageProcessor;U.DINOv3ViTModel;U.DINOv3ViTPreTrainedModel;U.DPTFeatureExtractor;U.DPTForDepthEstimation;U.DPTImageProcessor;U.DPTModel;U.DPTPreTrainedModel;U.DacDecoderModel;U.DacDecoderOutput;U.DacEncoderModel;U.DacEncoderOutput;U.DacFeatureExtractor;U.DacModel;U.DacPreTrainedModel;U.DataTypeMap;U.DebertaForMaskedLM;U.DebertaForQuestionAnswering;U.DebertaForSequenceClassification;U.DebertaForTokenClassification;U.DebertaModel;U.DebertaPreTrainedModel;U.DebertaTokenizer;U.DebertaV2ForMaskedLM;U.DebertaV2ForQuestionAnswering;U.DebertaV2ForSequenceClassification;U.DebertaV2ForTokenClassification;U.DebertaV2Model;U.DebertaV2PreTrainedModel;U.DebertaV2Tokenizer;U.DecisionTransformerModel;U.DecisionTransformerPreTrainedModel;U.DeiTFeatureExtractor;U.DeiTForImageClassification;U.DeiTImageProcessor;U.DeiTModel;U.DeiTPreTrainedModel;U.DepthAnythingForDepthEstimation;U.DepthAnythingPreTrainedModel;U.DepthEstimationPipeline;U.DepthProForDepthEstimation;U.DepthProPreTrainedModel;U.DetrFeatureExtractor;U.DetrForObjectDetection;U.DetrForSegmentation;U.DetrImageProcessor;U.DetrModel;U.DetrObjectDetectionOutput;U.DetrPreTrainedModel;U.DetrSegmentationOutput;U.Dinov2ForImageClassification;U.Dinov2Model;U.Dinov2PreTrainedModel;U.Dinov2WithRegistersForImageClassification;U.Dinov2WithRegistersModel;U.Dinov2WithRegistersPreTrainedModel;U.DistilBertForMaskedLM;U.DistilBertForQuestionAnswering;U.DistilBertForSequenceClassification;U.DistilBertForTokenClassification;U.DistilBertModel;U.DistilBertPreTrainedModel;U.DistilBertTokenizer;U.DocumentQuestionAnsweringPipeline;U.DonutFeatureExtractor;U.DonutImageProcessor;U.DonutSwinModel;U.DonutSwinPreTrainedModel;U.EdgeTamModel;U.EfficientNetForImageClassification;U.EfficientNetImageProcessor;U.EfficientNetModel;U.EfficientNetPreTrainedModel;U.ElectraForMaskedLM;U.ElectraForQuestionAnswering;U.ElectraForSequenceClassification;U.ElectraForTokenClassification;U.ElectraModel;U.ElectraPreTrainedModel;U.ElectraTokenizer;U.EncodecFeatureExtractor;U.EosTokenCriteria;U.Ernie4_5ForCausalLM;U.Ernie4_5Model;U.Ernie4_5PreTrainedModel;U.EsmForMaskedLM;U.EsmForSequenceClassification;U.EsmForTokenClassification;U.EsmModel;U.EsmPreTrainedModel;U.EsmTokenizer;U.ExaoneForCausalLM;U.ExaoneModel;U.ExaonePreTrainedModel;U.FFT;U.FalconForCausalLM;U.FalconModel;U.FalconPreTrainedModel;U.FalconTokenizer;U.FastViTForImageClassification;U.FastViTModel;U.FastViTPreTrainedModel;U.FeatureExtractionPipeline;U.FeatureExtractor;U.FillMaskPipeline;U.Florence2ForConditionalGeneration;U.Florence2PreTrainedModel;U.Florence2Processor;U.ForcedBOSTokenLogitsProcessor;U.ForcedEOSTokenLogitsProcessor;U.GLPNFeatureExtractor;U.GLPNForDepthEstimation;U.GLPNModel;U.GLPNPreTrainedModel;U.GPT2LMHeadModel;U.GPT2Model;U.GPT2PreTrainedModel;U.GPT2Tokenizer;U.GPTBigCodeForCausalLM;U.GPTBigCodeModel;U.GPTBigCodePreTrainedModel;U.GPTJForCausalLM;U.GPTJModel;U.GPTJPreTrainedModel;U.GPTNeoForCausalLM;U.GPTNeoModel;U.GPTNeoPreTrainedModel;U.GPTNeoXForCausalLM;U.GPTNeoXModel;U.GPTNeoXPreTrainedModel;U.GPTNeoXTokenizer;U.Gemma2ForCausalLM;U.Gemma2Model;U.Gemma2PreTrainedModel;U.Gemma3ForCausalLM;U.Gemma3Model;U.Gemma3PreTrainedModel;U.Gemma3nAudioFeatureExtractor;U.Gemma3nForConditionalGeneration;U.Gemma3nPreTrainedModel;U.Gemma3nProcessor;U.GemmaForCausalLM;U.GemmaModel;U.GemmaPreTrainedModel;U.GemmaTokenizer;U.GlmForCausalLM;U.GlmModel;U.GlmPreTrainedModel;U.GraniteForCausalLM;U.GraniteModel;U.GraniteMoeHybridForCausalLM;U.GraniteMoeHybridModel;U.GraniteMoeHybridPreTrainedModel;U.GranitePreTrainedModel;U.Grok1Tokenizer;U.GroundingDinoForObjectDetection;U.GroundingDinoImageProcessor;U.GroundingDinoPreTrainedModel;U.GroundingDinoProcessor;U.GroupViTModel;U.GroupViTPreTrainedModel;U.HeliumForCausalLM;U.HeliumModel;U.HeliumPreTrainedModel;U.HerbertTokenizer;U.HieraForImageClassification;U.HieraModel;U.HieraPreTrainedModel;U.HubertForCTC;U.HubertForSequenceClassification;U.HubertModel;U.HubertPreTrainedModel;U.IJepaForImageClassification;U.IJepaModel;U.IJepaPreTrainedModel;U.Idefics3ForConditionalGeneration;U.Idefics3ImageProcessor;U.Idefics3PreTrainedModel;U.Idefics3Processor;U.ImageClassificationPipeline;U.ImageFeatureExtractionPipeline;U.ImageFeatureExtractor;U.ImageMattingOutput;U.ImageProcessor;U.ImageSegmentationPipeline;U.ImageToImagePipeline;U.ImageToTextPipeline;U.InterruptableStoppingCriteria;U.JAISLMHeadModel;U.JAISModel;U.JAISPreTrainedModel;U.JinaCLIPImageProcessor;U.JinaCLIPModel;U.JinaCLIPPreTrainedModel;U.JinaCLIPProcessor;U.JinaCLIPTextModel;U.JinaCLIPVisionModel;U.Lfm2ForCausalLM;U.Lfm2Model;U.Lfm2PreTrainedModel;U.LiteWhisperForConditionalGeneration;U.Llama4ForCausalLM;U.Llama4PreTrainedModel;U.LlamaForCausalLM;U.LlamaModel;U.LlamaPreTrainedModel;U.LlamaTokenizer;U.LlavaForConditionalGeneration;U.LlavaOnevisionForConditionalGeneration;U.LlavaOnevisionImageProcessor;U.LlavaPreTrainedModel;U.LlavaProcessor;U.LlavaQwen2ForCausalLM;U.LogitsProcessor;U.LogitsProcessorList;U.LogitsWarper;U.LongT5ForConditionalGeneration;U.LongT5Model;U.LongT5PreTrainedModel;U.M2M100ForConditionalGeneration;U.M2M100Model;U.M2M100PreTrainedModel;U.M2M100Tokenizer;U.MBart50Tokenizer;U.MBartForCausalLM;U.MBartForConditionalGeneration;U.MBartForSequenceClassification;U.MBartModel;U.MBartPreTrainedModel;U.MBartTokenizer;U.MPNetForMaskedLM;U.MPNetForQuestionAnswering;U.MPNetForSequenceClassification;U.MPNetForTokenClassification;U.MPNetModel;U.MPNetPreTrainedModel;U.MPNetTokenizer;U.MT5ForConditionalGeneration;U.MT5Model;U.MT5PreTrainedModel;U.MarianMTModel;U.MarianModel;U.MarianPreTrainedModel;U.MarianTokenizer;U.Mask2FormerImageProcessor;U.MaskFormerFeatureExtractor;U.MaskFormerForInstanceSegmentation;U.MaskFormerImageProcessor;U.MaskFormerModel;U.MaskFormerPreTrainedModel;U.MaskedLMOutput;U.MaxLengthCriteria;U.Metric3DForDepthEstimation;U.Metric3DPreTrainedModel;U.Metric3Dv2ForDepthEstimation;U.Metric3Dv2PreTrainedModel;U.MgpstrForSceneTextRecognition;U.MgpstrModelOutput;U.MgpstrPreTrainedModel;U.MgpstrProcessor;U.MgpstrTokenizer;U.MimiDecoderModel;U.MimiDecoderOutput;U.MimiEncoderModel;U.MimiEncoderOutput;U.MimiModel;U.MimiPreTrainedModel;U.MinLengthLogitsProcessor;U.MinNewTokensLengthLogitsProcessor;U.Ministral3ForCausalLM;U.Ministral3Model;U.Ministral3PreTrainedModel;U.MinistralForCausalLM;U.MinistralModel;U.MinistralPreTrainedModel;U.Mistral3ForConditionalGeneration;U.MistralForCausalLM;U.MistralModel;U.MistralPreTrainedModel;U.MobileBertForMaskedLM;U.MobileBertForQuestionAnswering;U.MobileBertForSequenceClassification;U.MobileBertModel;U.MobileBertPreTrainedModel;U.MobileBertTokenizer;U.MobileLLMForCausalLM;U.MobileLLMModel;U.MobileLLMPreTrainedModel;U.MobileNetV1FeatureExtractor;U.MobileNetV1ForImageClassification;U.MobileNetV1ForSemanticSegmentation;U.MobileNetV1ImageProcessor;U.MobileNetV1Model;U.MobileNetV1PreTrainedModel;U.MobileNetV2FeatureExtractor;U.MobileNetV2ForImageClassification;U.MobileNetV2ForSemanticSegmentation;U.MobileNetV2ImageProcessor;U.MobileNetV2Model;U.MobileNetV2PreTrainedModel;U.MobileNetV3FeatureExtractor;U.MobileNetV3ForImageClassification;U.MobileNetV3ForSemanticSegmentation;U.MobileNetV3ImageProcessor;U.MobileNetV3Model;U.MobileNetV3PreTrainedModel;U.MobileNetV4FeatureExtractor;U.MobileNetV4ForImageClassification;U.MobileNetV4ForSemanticSegmentation;U.MobileNetV4ImageProcessor;U.MobileNetV4Model;U.MobileNetV4PreTrainedModel;U.MobileViTFeatureExtractor;U.MobileViTForImageClassification;U.MobileViTImageProcessor;U.MobileViTModel;U.MobileViTPreTrainedModel;U.MobileViTV2ForImageClassification;U.MobileViTV2Model;U.MobileViTV2PreTrainedModel;U.ModelOutput;U.ModernBertDecoderForCausalLM;U.ModernBertDecoderModel;U.ModernBertDecoderPreTrainedModel;U.ModernBertForMaskedLM;U.ModernBertForSequenceClassification;U.ModernBertForTokenClassification;U.ModernBertModel;U.ModernBertPreTrainedModel;U.Moondream1ForConditionalGeneration;U.MoonshineFeatureExtractor;U.MoonshineForConditionalGeneration;U.MoonshineModel;U.MoonshinePreTrainedModel;U.MoonshineProcessor;U.MptForCausalLM;U.MptModel;U.MptPreTrainedModel;U.MultiModalityCausalLM;U.MultiModalityPreTrainedModel;U.MusicgenForCausalLM;U.MusicgenForConditionalGeneration;U.MusicgenModel;U.MusicgenPreTrainedModel;U.NanoChatForCausalLM;U.NanoChatModel;U.NanoChatPreTrainedModel;U.NeoBertForMaskedLM;U.NeoBertForQuestionAnswering;U.NeoBertForSequenceClassification;U.NeoBertForTokenClassification;U.NeoBertModel;U.NeoBertPreTrainedModel;U.NllbTokenizer;U.NoBadWordsLogitsProcessor;U.NoRepeatNGramLogitsProcessor;U.NomicBertModel;U.NomicBertPreTrainedModel;U.NougatImageProcessor;U.NougatTokenizer;U.OPTForCausalLM;U.OPTModel;U.OPTPreTrainedModel;U.ObjectDetectionPipeline;U.Olmo2ForCausalLM;U.Olmo2Model;U.Olmo2PreTrainedModel;U.OlmoForCausalLM;U.OlmoModel;U.OlmoPreTrainedModel;U.OpenELMForCausalLM;U.OpenELMModel;U.OpenELMPreTrainedModel;U.OwlViTFeatureExtractor;U.OwlViTForObjectDetection;U.OwlViTImageProcessor;U.OwlViTModel;U.OwlViTPreTrainedModel;U.OwlViTProcessor;U.Owlv2ForObjectDetection;U.Owlv2ImageProcessor;U.Owlv2Model;U.Owlv2PreTrainedModel;U.PaliGemmaForConditionalGeneration;U.PaliGemmaPreTrainedModel;U.PaliGemmaProcessor;U.ParakeetFeatureExtractor;U.ParakeetForCTC;U.ParakeetPreTrainedModel;U.PatchTSMixerForPrediction;U.PatchTSMixerModel;U.PatchTSMixerPreTrainedModel;U.PatchTSTForPrediction;U.PatchTSTModel;U.PatchTSTPreTrainedModel;U.Phi3ForCausalLM;U.Phi3Model;U.Phi3PreTrainedModel;U.Phi3VForCausalLM;U.Phi3VImageProcessor;U.Phi3VPreTrainedModel;U.Phi3VProcessor;U.PhiForCausalLM;U.PhiModel;U.PhiPreTrainedModel;U.Pipeline;U.PixtralImageProcessor;U.PixtralProcessor;U.PreTrainedModel;U.PreTrainedTokenizer;U.PretrainedConfig;U.PretrainedMixin;U.Processor;U.PvtForImageClassification;U.PvtImageProcessor;U.PvtModel;U.PvtPreTrainedModel;U.PyAnnoteFeatureExtractor;U.PyAnnoteForAudioFrameClassification;U.PyAnnoteModel;U.PyAnnotePreTrainedModel;U.PyAnnoteProcessor;U.QuestionAnsweringModelOutput;U.QuestionAnsweringPipeline;U.Qwen2ForCausalLM;U.Qwen2Model;U.Qwen2PreTrainedModel;U.Qwen2Tokenizer;U.Qwen2VLForConditionalGeneration;U.Qwen2VLImageProcessor;U.Qwen2VLPreTrainedModel;U.Qwen2VLProcessor;U.Qwen3ForCausalLM;U.Qwen3Model;U.Qwen3PreTrainedModel;U.RFDetrForObjectDetection;U.RFDetrModel;U.RFDetrObjectDetectionOutput;U.RFDetrPreTrainedModel;U.RTDetrForObjectDetection;U.RTDetrImageProcessor;U.RTDetrModel;U.RTDetrObjectDetectionOutput;U.RTDetrPreTrainedModel;U.RTDetrV2ForObjectDetection;U.RTDetrV2Model;U.RTDetrV2ObjectDetectionOutput;U.RTDetrV2PreTrainedModel;U.RawAudio;var j$=U.RawImage;U.RawVideo;U.RawVideoFrame;U.RepetitionPenaltyLogitsProcessor;U.ResNetForImageClassification;U.ResNetModel;U.ResNetPreTrainedModel;U.RoFormerForMaskedLM;U.RoFormerForQuestionAnswering;U.RoFormerForSequenceClassification;U.RoFormerForTokenClassification;U.RoFormerModel;U.RoFormerPreTrainedModel;U.RoFormerTokenizer;U.RobertaForMaskedLM;U.RobertaForQuestionAnswering;U.RobertaForSequenceClassification;U.RobertaForTokenClassification;U.RobertaModel;U.RobertaPreTrainedModel;U.RobertaTokenizer;U.Sam2ImageProcessor;U.Sam2ImageSegmentationOutput;U.Sam2Model;U.Sam2PreTrainedModel;U.Sam2Processor;U.Sam2VideoProcessor;U.Sam3ImageProcessor;U.Sam3TrackerModel;U.SamImageProcessor;U.SamImageSegmentationOutput;U.SamModel;U.SamPreTrainedModel;U.SamProcessor;U.SapiensForDepthEstimation;U.SapiensForNormalEstimation;U.SapiensForSemanticSegmentation;U.SapiensPreTrainedModel;U.SeamlessM4TFeatureExtractor;U.SegformerFeatureExtractor;U.SegformerForImageClassification;U.SegformerForSemanticSegmentation;U.SegformerImageProcessor;U.SegformerModel;U.SegformerPreTrainedModel;U.Seq2SeqLMOutput;U.SequenceClassifierOutput;U.SiglipImageProcessor;U.SiglipModel;U.SiglipPreTrainedModel;U.SiglipTextModel;U.SiglipTokenizer;U.SiglipVisionModel;U.SmolLM3ForCausalLM;U.SmolLM3Model;U.SmolLM3PreTrainedModel;U.SmolVLMForConditionalGeneration;U.SmolVLMImageProcessor;U.SmolVLMProcessor;U.SnacDecoderModel;U.SnacEncoderModel;U.SnacFeatureExtractor;U.SnacModel;U.SnacPreTrainedModel;U.SpeechT5FeatureExtractor;U.SpeechT5ForSpeechToText;U.SpeechT5ForTextToSpeech;U.SpeechT5HifiGan;U.SpeechT5Model;U.SpeechT5PreTrainedModel;U.SpeechT5Processor;U.SpeechT5Tokenizer;U.SqueezeBertForMaskedLM;U.SqueezeBertForQuestionAnswering;U.SqueezeBertForSequenceClassification;U.SqueezeBertModel;U.SqueezeBertPreTrainedModel;U.SqueezeBertTokenizer;U.StableLmForCausalLM;U.StableLmModel;U.StableLmPreTrainedModel;U.Starcoder2ForCausalLM;U.Starcoder2Model;U.Starcoder2PreTrainedModel;U.StoppingCriteria;U.StoppingCriteriaList;U.StyleTextToSpeech2Model;U.StyleTextToSpeech2PreTrainedModel;U.SummarizationPipeline;U.SupertonicForConditionalGeneration;U.SupertonicPreTrainedModel;U.SuppressTokensAtBeginLogitsProcessor;U.Swin2SRForImageSuperResolution;U.Swin2SRImageProcessor;U.Swin2SRModel;U.Swin2SRPreTrainedModel;U.SwinForImageClassification;U.SwinForSemanticSegmentation;U.SwinModel;U.SwinPreTrainedModel;U.T5ForConditionalGeneration;U.T5Model;U.T5PreTrainedModel;U.T5Tokenizer;U.TableTransformerForObjectDetection;U.TableTransformerModel;U.TableTransformerObjectDetectionOutput;U.TableTransformerPreTrainedModel;U.TemperatureLogitsWarper;U.Tensor;U.Text2TextGenerationPipeline;U.TextClassificationPipeline;U.TextGenerationPipeline;U.TextStreamer;U.TextToAudioPipeline;U.TokenClassificationPipeline;U.TokenClassifierOutput;U.TokenizerModel;U.TopKLogitsWarper;U.TopPLogitsWarper;U.TrOCRForCausalLM;U.TrOCRPreTrainedModel;U.TranslationPipeline;U.UltravoxModel;U.UltravoxPreTrainedModel;U.UltravoxProcessor;U.UniSpeechForCTC;U.UniSpeechForSequenceClassification;U.UniSpeechModel;U.UniSpeechPreTrainedModel;U.UniSpeechSatForAudioFrameClassification;U.UniSpeechSatForCTC;U.UniSpeechSatForSequenceClassification;U.UniSpeechSatModel;U.UniSpeechSatPreTrainedModel;U.VLChatProcessor;U.VLMImageProcessor;U.VaultGemmaForCausalLM;U.VaultGemmaModel;U.VaultGemmaPreTrainedModel;U.ViTFeatureExtractor;U.ViTForImageClassification;U.ViTImageProcessor;U.ViTMAEModel;U.ViTMAEPreTrainedModel;U.ViTMSNForImageClassification;U.ViTMSNModel;U.ViTMSNPreTrainedModel;U.ViTModel;U.ViTPreTrainedModel;U.VisionEncoderDecoderModel;U.VitMatteForImageMatting;U.VitMatteImageProcessor;U.VitMattePreTrainedModel;U.VitPoseForPoseEstimation;U.VitPoseImageProcessor;U.VitPosePreTrainedModel;U.VitsModel;U.VitsModelOutput;U.VitsPreTrainedModel;U.VitsTokenizer;U.VoxtralForConditionalGeneration;U.VoxtralProcessor;U.Wav2Vec2BertForCTC;U.Wav2Vec2BertForSequenceClassification;U.Wav2Vec2BertModel;U.Wav2Vec2BertPreTrainedModel;U.Wav2Vec2CTCTokenizer;U.Wav2Vec2FeatureExtractor;U.Wav2Vec2ForAudioFrameClassification;U.Wav2Vec2ForCTC;U.Wav2Vec2ForSequenceClassification;U.Wav2Vec2Model;U.Wav2Vec2PreTrainedModel;U.Wav2Vec2Processor;U.Wav2Vec2ProcessorWithLM;U.WavLMForAudioFrameClassification;U.WavLMForCTC;U.WavLMForSequenceClassification;U.WavLMForXVector;U.WavLMModel;U.WavLMPreTrainedModel;U.WeSpeakerFeatureExtractor;U.WeSpeakerResNetModel;U.WeSpeakerResNetPreTrainedModel;U.WhisperFeatureExtractor;U.WhisperForConditionalGeneration;U.WhisperModel;U.WhisperPreTrainedModel;U.WhisperProcessor;U.WhisperTextStreamer;U.WhisperTimeStampLogitsProcessor;U.WhisperTokenizer;U.XLMForQuestionAnswering;U.XLMForSequenceClassification;U.XLMForTokenClassification;U.XLMModel;U.XLMPreTrainedModel;U.XLMRobertaForMaskedLM;U.XLMRobertaForQuestionAnswering;U.XLMRobertaForSequenceClassification;U.XLMRobertaForTokenClassification;U.XLMRobertaModel;U.XLMRobertaPreTrainedModel;U.XLMRobertaTokenizer;U.XLMTokenizer;U.XLMWithLMHeadModel;U.XVectorOutput;U.YolosFeatureExtractor;U.YolosForObjectDetection;U.YolosImageProcessor;U.YolosModel;U.YolosObjectDetectionOutput;U.YolosPreTrainedModel;U.ZeroShotAudioClassificationPipeline;U.ZeroShotClassificationPipeline;U.ZeroShotImageClassificationPipeline;U.ZeroShotObjectDetectionPipeline;U.bankers_round;U.cat;U.cos_sim;U.dot;U.dynamic_time_warping;U.env;U.full;U.full_like;U.getCacheShapes;U.hamming;U.hanning;U.interpolate;U.interpolate_4d;U.interpolate_data;U.is_chinese_char;U.layer_norm;U.load_image;U.load_video;U.log_softmax;U.magnitude;U.matmul;U.max;U.mean;U.mean_pooling;U.medianFilter;U.mel_filter_bank;U.min;U.ones;U.ones_like;U.permute;U.permute_data;U.pipeline;U.quantize_embeddings;U.rand;U.randn;U.read_audio;U.rfft;U.round;U.slice;U.softmax;U.spectrogram;U.stack;U.std_mean;U.topk;U.window_function;U.zeros;U.zeros_like;const sh={model:null,processor:null,modelId:"briaai/RMBG-1.4",init:async()=>{if(!(sh.model&&sh.processor))try{console.log("[Transformers.js] Initializing Background Removal Service..."),sh.model=await Hst.from_pretrained(sh.modelId,{config:{model_type:"custom"}}),sh.processor=await qst.from_pretrained(sh.modelId),console.log("[Transformers.js] Model and Processor initialized.")}catch(n){throw console.error("[Transformers.js] Initialization failed:",n),n}},removeBackground:async n=>{await sh.init();try{let e;if(typeof n=="string")e=await j$.fromURL(n);else if(n instanceof Blob)e=await j$.fromBlob(n);else if(n instanceof HTMLImageElement)e=await j$.fromURL(n.src);else throw new Error("Unsupported image source type");const{pixel_values:t}=await sh.processor(e),{output:s}=await sh.model({input:t}),r=s[0].mul(255).to("uint8").squeeze(),a=r.dims[0],o=r.dims[1],l=document.createElement("canvas");l.width=o,l.height=a;const c=l.getContext("2d"),u=r.data,f=new Uint8ClampedArray(o*a*4);for(let b=0;b<u.length;b++){const v=u[b],w=b*4;f[w]=0,f[w+1]=0,f[w+2]=0,f[w+3]=v}const d=new ImageData(f,o,a);c.putImageData(d,0,0);const h=document.createElement("canvas");h.width=e.width,h.height=e.height;const p=h.getContext("2d"),g=new Image;return g.crossOrigin="anonymous",n instanceof HTMLImageElement?g.src=n.src:typeof n=="string"?g.src=n:g.src=URL.createObjectURL(n),await new Promise((b,v)=>{g.onload=b,g.onerror=v}),p.drawImage(g,0,0),p.globalCompositeOperation="destination-in",p.drawImage(l,0,0,h.width,h.height),n instanceof Blob&&URL.revokeObjectURL(g.src),new Promise(b=>h.toBlob(b,"image/png"))}catch(e){throw console.error("[Transformers.js] Background removal failed:",e),e}}};function Yst(){const{canvasManager:n}=aP(),{setColorPickerVisible:e,setColorPickerAnchor:t,setExtractedPalette:s}=Nb(),r=Ie.useRef(null),[a,o]=Ie.useState(!1),[l,c]=Ie.useState({x:0,y:0}),[u,f]=Ie.useState(null),[d,h]=Ie.useState(!1),[p,g]=Ie.useState(!1);if(Ie.useEffect(()=>{if(!n)return;const A=()=>{const D=n.getActiveObject();if(f(D),D){const L=D.getBoundingRect(!0,!0),j=n.canvas.getElement().getBoundingClientRect(),G=j.left+L.left,Q=j.top+L.top,q=180,te=44,Z=G+L.width/2-q/2;let ne=Q-te-10;ne<0&&(ne=Q+L.height+10),c({x:Z,y:ne}),o(!0)}else o(!1)};return n.canvas.on("selection:created",A),n.canvas.on("selection:updated",A),n.canvas.on("selection:cleared",()=>o(!1)),n.canvas.on("object:moving",A),n.canvas.on("object:scaling",A),n.canvas.on("object:rotating",A),n.canvas.on("object:modified",A),()=>{n.canvas&&(n.canvas.off("selection:created",A),n.canvas.off("selection:updated",A),n.canvas.off("selection:cleared"),n.canvas.off("object:moving",A),n.canvas.off("object:scaling",A),n.canvas.off("object:rotating",A),n.canvas.off("object:modified",A))}},[n]),!a||!u)return null;const b=u,v=b.type==="i-text"||b.type==="text",w=b.type==="image"||b.type==="fabric-image",x=b.id==="crop-ui",S=b.type==="activeSelection"||b.type==="activeselection",C=b.type==="group",M=async(A,D)=>{if(n)switch(A){case"duplicate":n.duplicateActiveObject();break;case"delete":n.removeActiveObject();break;case"layer-up":n.layerActiveObject("up");break;case"layer-down":n.layerActiveObject("down");break;case"group":n.group();break;case"ungroup":n.ungroup();break;case"font-family":n.updateActiveObject("fontFamily",D);break;case"format":D==="bold"&&n.toggleTextDecoration("fontWeight"),D==="italic"&&n.toggleTextDecoration("fontStyle"),D==="underline"&&n.toggleTextDecoration("underline");break;case"crop-apply":n.applyCrop();break;case"crop-cancel":n.cancelCrop();break;case"start-crop":n.startCropMode(),o(!1);break;case"toggle-color":t(D),e(P=>!P);break;case"remove-bg":if(d)return;h(!0),$s.info("Removing background...",2e3);try{const P=u.getSrc(),j=await sh.removeBackground(P),G=URL.createObjectURL(j);await n.replaceImage(u,G),$s.success("Background removed!")}catch(P){console.error("BG Removal error:",P),$s.error("Failed to remove background")}finally{h(!1)}break;case"extract-palette":if(!n)return;const L=await n.extractPaletteFromActiveImage();L&&s(L);break;case"vectorize":o(!1),await n.vectorizeActiveImage();break;case"upscale":if(p)return;g(!0);try{await n.upscaleActiveImage()}finally{g(!1)}break}},k=()=>V.jsxs(V.Fragment,{children:[V.jsx("button",{className:"ft-btn",onClick:()=>M("crop-apply"),title:"Apply",style:{color:"#4ade80"},children:V.jsx(dfe,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("crop-cancel"),title:"Cancel",style:{color:"#f87171"},children:V.jsx(hE,{size:16})})]}),E=()=>{const A=D=>D?D.split(",")[0].trim().replace(/['"]/g,""):"Arial";return V.jsxs(V.Fragment,{children:[V.jsxs("select",{className:"ft-select",value:A(b.fontFamily)||"Arial",onChange:D=>M("font-family",D.target.value),title:"Font Family",children:[V.jsx("option",{value:"Arial",children:"Arial"}),V.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),V.jsx("option",{value:"Courier New",children:"Courier New"}),V.jsx("option",{value:"Noto Sans Lao",children:"Noto Sans Lao"}),V.jsx("option",{value:"Noto Serif Lao",children:"Noto Serif Lao"}),V.jsx("option",{value:"Phetsarath OT",children:"Phetsarath OT"}),V.jsx("option",{value:"Noto Sans Lao Looped",children:"Noto Sans Lao Looped"}),V.jsx("option",{value:"Roboto",children:"Roboto"}),V.jsx("option",{value:"Open Sans",children:"Open Sans"}),V.jsx("option",{value:"Montserrat",children:"Montserrat"}),V.jsx("option",{value:"Poppins",children:"Poppins"}),V.jsx("option",{value:"Lato",children:"Lato"}),V.jsx("option",{value:"Oswald",children:"Oswald"}),V.jsx("option",{value:"Playfair Display",children:"Playfair Display"}),V.jsx("option",{value:"Raleway",children:"Raleway"}),V.jsx("option",{value:"Impact",children:"Impact"})]}),V.jsx("div",{className:"ft-sep"}),V.jsx("button",{className:`ft-btn ${b.fontWeight==="bold"?"active":""}`,onClick:()=>M("format","bold"),title:"Bold",children:V.jsx(ffe,{size:16})}),V.jsx("button",{className:`ft-btn ${b.fontStyle==="italic"?"active":""}`,onClick:()=>M("format","italic"),title:"Italic",children:V.jsx(gfe,{size:16})}),V.jsx("button",{className:`ft-btn ${b.underline?"active":""}`,onClick:()=>M("format","underline"),title:"Underline",children:V.jsx(Tfe,{size:16})}),V.jsx("div",{className:"ft-sep"})]})},I=()=>V.jsxs(V.Fragment,{children:[v&&E(),w&&V.jsxs(V.Fragment,{children:[V.jsx("button",{className:"ft-btn",onClick:()=>M("start-crop"),title:"Crop Image",children:V.jsx(oU,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("remove-bg"),title:"Remove Background",style:{color:d?"#8b5cf6":"inherit"},children:d?V.jsx("div",{className:"spinner-small",style:{border:"2px solid rgba(139, 92, 246, 0.3)",borderTopColor:"#8b5cf6",borderRadius:"50%",width:"14px",height:"14px",animation:"spin 1s linear infinite"}}):V.jsx(cU,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("extract-palette"),title:"Extract Color Palette",children:V.jsx(Ket,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("vectorize"),title:"Vectorize Image",children:V.jsx(_fe,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("upscale"),title:"AI Quality Enhance",style:{color:p?"var(--accent-primary)":"inherit"},children:p?V.jsx("div",{className:"spinner-small",style:{border:"2px solid rgba(139, 92, 246, 0.3)",borderTopColor:"#8b5cf6",borderRadius:"50%",width:"14px",height:"14px",animation:"spin 1s linear infinite"}}):V.jsx(xfe,{size:16})}),V.jsx("div",{className:"ft-sep"})]}),V.jsx("button",{className:"ft-btn",onClick:()=>M("duplicate"),title:"Duplicate",children:V.jsx(aU,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("delete"),title:"Delete",children:V.jsx(oP,{size:16})}),V.jsx("div",{className:"ft-sep"}),V.jsx("button",{className:"ft-btn",onClick:()=>M("layer-up"),title:"Bring Forward",children:V.jsx(iU,{size:16})}),V.jsx("button",{className:"ft-btn",onClick:()=>M("layer-down"),title:"Send Backward",children:V.jsx(rU,{size:16})}),S&&V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"ft-sep"}),V.jsx("button",{className:"ft-btn",onClick:()=>M("group"),title:"Group",children:V.jsx(pM,{size:16})})]}),C&&V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"ft-sep"}),V.jsx("button",{className:"ft-btn",onClick:()=>M("ungroup"),title:"Ungroup",children:V.jsx(yfe,{size:16})})]}),V.jsx("div",{className:"ft-sep"}),V.jsx("div",{className:"color-swatch-wrap",children:V.jsx("div",{ref:r,className:"ft-color-swatch",onClick:()=>M("toggle-color",r.current),style:{backgroundColor:b.fill&&typeof b.fill=="string"?b.fill:"transparent"},title:"Change Color"})})]});return V.jsx("div",{className:"floating-toolbar",style:{position:"fixed",top:`${l.y}px`,left:`${l.x}px`,zIndex:1e3},children:x?k():I()})}const Kst=Ie.memo(({obj:n,index:e,isSelected:t,isDragging:s,isEditing:r,editingName:a,onSelect:o,onToggleLock:l,onToggleVisible:c,onDragStart:u,onDragOver:f,onDrop:d,onDragEnd:h,onNameDoubleClick:p,onNameChange:g,onNameKeyDown:b,onNameBlur:v,onMouseEnter:w,onMouseLeave:x,onContextMenu:S})=>{const C=n.name||n.type,M=n.lockMovementX,k=n.visible!==!1,E=I=>{switch(I){case"i-text":case"text":return V.jsx(Mfe,{size:14});case"image":return V.jsx(Net,{size:14});case"rect":return V.jsx(vtt,{size:14});case"circle":return V.jsx(tet,{size:14});case"group":return V.jsx(_et,{size:14});default:return V.jsx(HZe,{size:14})}};return V.jsxs("div",{className:`layer-item ${t?"selected":""} ${s?"dragging":""}`,onClick:I=>o(n,I),onContextMenu:I=>S(n,I),onMouseEnter:()=>w(n),onMouseLeave:x,draggable:!0,onDragStart:I=>u(I,e),onDragOver:f,onDrop:I=>d(I,e),onDragEnd:h,style:{cursor:"pointer",opacity:s?.5:1},children:[V.jsx("div",{className:"layer-handle",style:{cursor:"grab"},children:V.jsx(Tet,{size:14})}),V.jsx("div",{className:"layer-icon",children:E(n.type)}),V.jsx("div",{className:"layer-name-wrap",style:{flex:1,overflow:"hidden"},onDoubleClick:I=>p(n,I),children:r?V.jsx("input",{type:"text",value:a,onChange:g,onKeyDown:I=>b(I,n),onBlur:()=>v(n),autoFocus:!0,onClick:I=>I.stopPropagation(),style:{width:"100%",border:"1px solid var(--accent-primary)",background:"var(--bg-primary)",color:"var(--text-primary)",padding:"2px 4px",fontSize:"inherit",borderRadius:"2px",outline:"none"}}):V.jsx("span",{className:"layer-name",children:C})}),V.jsxs("div",{className:"layer-actions",children:[V.jsx("button",{className:`icon-btn btn-xs btn-lock ${M?"active":""}`,onClick:I=>l(n,I),title:"Lock/Unlock",children:M?V.jsx(lU,{size:14}):V.jsx(bfe,{size:14})}),V.jsx("button",{className:`icon-btn btn-xs btn-visible ${k?"":"active"}`,onClick:I=>c(n,I),title:"Toggle Visibility",children:k?V.jsx(cet,{size:14}):V.jsx(aet,{size:14})})]})]})});function Xst({canvasManager:n}){const[e,t]=Ie.useState([]),[s,r]=Ie.useState([]),[a,o]=Ie.useState(null),[l,c]=Ie.useState(null),[u,f]=Ie.useState("");Ie.useEffect(()=>{if(!n)return;const A=()=>{const L=n.canvas.getObjects().filter(P=>!P.excludeFromExport);t([...L].reverse())},D=()=>{const L=n.getActiveObject();if(L)if(L.type==="activeSelection"){const P=L.getObjects().map(j=>j.uid||j);r(P)}else r([L.uid||L]);else r([])};return n.canvas.on("object:added",A),n.canvas.on("object:removed",A),n.canvas.on("object:modified",A),n.canvas.on("selection:created",D),n.canvas.on("selection:updated",D),n.canvas.on("selection:cleared",D),n.canvas.on("layer:updated",A),A(),D(),()=>{n.canvas&&(n.canvas.off("object:added",A),n.canvas.off("object:removed",A),n.canvas.off("object:modified",A),n.canvas.off("selection:created",D),n.canvas.off("selection:updated",D),n.canvas.off("selection:cleared",D),n.canvas.off("layer:updated",A))}},[n]);const d=(A,D)=>{if(!n)return;const L=n.canvas;if(D.shiftKey||D.ctrlKey||D.metaKey){const P=L.getActiveObject();let j=[];P&&(P.type==="activeSelection"?j=[...P.getObjects()]:j=[P]);const G=j.indexOf(A);if(G>-1?(D.ctrlKey||D.metaKey)&&j.splice(G,1):j.push(A),j.length===0)L.discardActiveObject();else if(j.length===1)L.setActiveObject(j[0]);else{const Q=new ip(j,{canvas:L});L.setActiveObject(Q)}}else L.discardActiveObject(),L.setActiveObject(A);L.requestRenderAll()},h=(A,D)=>{D.stopPropagation();const L=!A.lockMovementX;A.set({lockMovementX:L,lockMovementY:L,lockRotation:L,lockScalingX:L,lockScalingY:L}),n.canvas.requestRenderAll(),t([...n.canvas.getObjects()].reverse())},p=(A,D)=>{D.stopPropagation(),A.set("visible",!A.visible),n.canvas.requestRenderAll(),t([...n.canvas.getObjects()].reverse())},g=(A,D)=>{o(D),A.dataTransfer.effectAllowed="move"},b=A=>{A.preventDefault(),A.dataTransfer.dropEffect="move"},v=(A,D)=>{if(A.preventDefault(),a===null||a===D){o(null);return}const L=n.canvas.getObjects(),P=L.length,j=P-1-a;let G=P-1-D;if(n.objectManager&&n.objectManager.reorder){const Q=L[j];n.canvas.moveObjectTo(Q,G)}else{const Q=L[j];n.canvas.moveObjectTo(Q,G)}n.canvas.requestRenderAll(),t([...n.canvas.getObjects()].reverse()),o(null)},w=()=>o(null),x=(A,D)=>{D.stopPropagation(),c(A.uid||A),f(A.name||A.type)},S=A=>f(A.target.value),C=(A,D)=>{A.key==="Enter"?(A.preventDefault(),D.set("name",u),c(null),n.canvas.requestRenderAll(),t([...n.canvas.getObjects()].reverse())):A.key==="Escape"&&c(null)},M=A=>{A.set("name",u),c(null),n.canvas.requestRenderAll(),t([...n.canvas.getObjects()].reverse())},k=A=>{n&&n.setHighlightObject&&n.setHighlightObject(A)},E=()=>{n&&n.setHighlightObject&&n.setHighlightObject(null)},I=(A,D)=>{D.preventDefault(),d(A,D);const L=new CustomEvent("canvas:contextmenu",{detail:{target:A,x:D.clientX,y:D.clientY}});document.dispatchEvent(L)};return V.jsx("div",{className:"layers-list",children:e.length===0?V.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999",fontSize:"0.9em"},children:"No objects yet"}):e.map((A,D)=>V.jsx(Kst,{obj:A,index:D,isSelected:s.includes(A.uid||A),isDragging:a===D,isEditing:l===(A.uid||A),editingName:u,onSelect:d,onToggleLock:h,onToggleVisible:p,onDragStart:g,onDragOver:b,onDrop:v,onDragEnd:w,onNameDoubleClick:x,onNameChange:S,onNameKeyDown:C,onNameBlur:M,onMouseEnter:k,onMouseLeave:E,onContextMenu:I},A.uid||D))})}function Qst({activeObject:n,onUpdate:e}){if(!n)return null;const t=(u,f)=>{let d=parseFloat(f);isNaN(d)&&(d=0),e(u,d)},s=Math.round(n.left||0),r=Math.round(n.top||0),a=Math.round(n.getScaledWidth()||0),o=Math.round(n.getScaledHeight()||0),l=Math.round(n.angle||0),c=Math.round((n.opacity||1)*100)/100;return V.jsxs("div",{className:"section",children:[V.jsx("div",{className:"section-title",children:"Transform"}),V.jsxs("div",{className:"inputs-grid-2 mb-2",children:[V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"X"}),V.jsx("input",{type:"number",className:"input-field input-sm",value:s,onChange:u=>t("left",u.target.value)})]}),V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"Y"}),V.jsx("input",{type:"number",className:"input-field input-sm",value:r,onChange:u=>t("top",u.target.value)})]})]}),V.jsxs("div",{className:"inputs-grid-2",children:[V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"W"}),V.jsx("input",{type:"number",className:"input-field input-sm",value:a,onChange:u=>t("width",u.target.value)})]}),V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"H"}),V.jsx("input",{type:"number",className:"input-field input-sm",value:o,onChange:u=>t("height",u.target.value)})]})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Rotation"}),V.jsxs("span",{className:"value-display",style:{marginLeft:"8px"},children:[l,""]})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"360",value:l,onChange:u=>t("angle",u.target.value)})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Opacity"}),V.jsxs("span",{className:"value-display",style:{marginLeft:"8px"},children:[Math.round(c*100),"%"]})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"1",step:"0.01",value:c,onChange:u=>t("opacity",u.target.value)})]})]})}function Jst({activeObject:n,canvasManager:e,onUpdate:t}){if(!n||!["i-text","text"].includes(n.type))return null;const s=[{label:"Arial (Standard)",value:"Arial"},{label:"Times New Roman",value:"Times New Roman"},{label:"Courier New",value:"Courier New"},{label:"Noto Sans Lao",value:"Noto Sans Lao"},{label:"Noto Serif Lao",value:"Noto Serif Lao"},{label:"Phetsarath OT",value:"Phetsarath OT"},{label:"Noto Sans Lao Looped",value:"Noto Sans Lao Looped"},{label:"Roboto",value:"Roboto"},{label:"Open Sans",value:"Open Sans"},{label:"Montserrat",value:"Montserrat"},{label:"Poppins",value:"Poppins"},{label:"Lato",value:"Lato"},{label:"Oswald",value:"Oswald"},{label:"Playfair Display",value:"Playfair Display"},{label:"Raleway",value:"Raleway"},{label:"Impact",value:"Impact"}],r=h=>{const p=h.target.value;e?.setTextStyle?e.setTextStyle("fontFamily",p):t("fontFamily",p)},a=h=>{e?.toggleTextDecoration&&e.toggleTextDecoration(h)},o=n.textAlign||"left",l=n.fontWeight||"normal",c=n.fontStyle||"normal",u=!!n.underline,d=(h=>h?h.split(",")[0].trim().replace(/['"]/g,""):"Arial")(n.fontFamily);return V.jsxs("div",{className:"section",children:[V.jsx("div",{className:"section-title",children:"Text Style"}),V.jsxs("div",{className:"input-group",children:[V.jsx("div",{className:"label-row",children:V.jsx("label",{className:"input-label",children:"Font"})}),V.jsx("select",{className:"select-field",value:d,onChange:r,children:s.map(h=>V.jsx("option",{value:h.value,children:h.label},h.value))})]}),V.jsxs("div",{className:"property-actions wide mt-2",children:[V.jsx("button",{className:`icon-btn ${o==="left"?"active":""}`,onClick:()=>t("textAlign","left"),title:"Align Left",children:V.jsx(Sfe,{size:16})}),V.jsx("button",{className:`icon-btn ${o==="center"?"active":""}`,onClick:()=>t("textAlign","center"),title:"Center",children:V.jsx(xtt,{size:16})}),V.jsx("button",{className:`icon-btn ${o==="right"?"active":""}`,onClick:()=>t("textAlign","right"),title:"Align Right",children:V.jsx(Cfe,{size:16})}),V.jsx("button",{className:`icon-btn ${o==="justify"?"active":""}`,onClick:()=>t("textAlign","justify"),title:"Justify",children:V.jsx(Mtt,{size:16})})]}),V.jsxs("div",{className:"property-actions wide mt-2",children:[V.jsx("button",{className:`icon-btn ${l==="bold"?"active":""}`,onClick:()=>a("fontWeight"),title:"Bold",children:V.jsx(ffe,{size:16})}),V.jsx("button",{className:`icon-btn ${c==="italic"?"active":""}`,onClick:()=>a("fontStyle"),title:"Italic",children:V.jsx(gfe,{size:16})}),V.jsx("button",{className:`icon-btn ${u?"active":""}`,onClick:()=>a("underline"),title:"Underline",children:V.jsx(Tfe,{size:16})})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",children:[V.jsx("label",{className:"input-label",children:"Line Height"}),V.jsx("span",{className:"value-display",children:Math.round((n.lineHeight||1.16)*10)/10})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0.8",max:"2.5",step:"0.1",value:n.lineHeight||1.16,onChange:h=>t("lineHeight",parseFloat(h.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",children:[V.jsx("label",{className:"input-label",children:"Char Spacing"}),V.jsx("span",{className:"value-display",children:n.charSpacing||0})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-50",max:"200",step:"10",value:n.charSpacing||0,onChange:h=>t("charSpacing",parseInt(h.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",children:[V.jsx("label",{className:"input-label",children:"Char Spacing"}),V.jsx("span",{className:"value-display",children:n.charSpacing||0})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-50",max:"200",step:"10",value:n.charSpacing||0,onChange:h=>t("charSpacing",parseInt(h.target.value))})]}),V.jsx("div",{className:"section-divider my-2"}),V.jsx("div",{className:"section-title",children:"Effects"}),V.jsxs("div",{className:"effects-grid",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[V.jsx("button",{className:"btn-effect",style:{padding:"8px",border:"1px solid var(--border-color)",borderRadius:"6px",background:"var(--bg-tertiary)",cursor:"pointer",fontSize:"0.8rem",color:"var(--text-secondary)"},onClick:()=>{t("shadow",null),t("stroke",null),t("strokeWidth",0),n.fill||t("fill","#ffffff")},title:"No Effect",children:"None"}),V.jsx("button",{className:"btn-effect",style:{padding:"8px",border:"1px solid var(--border-color)",borderRadius:"6px",background:"var(--bg-tertiary)",cursor:"pointer",fontSize:"0.8rem",color:"var(--text-primary)",textShadow:"2px 2px 2px rgba(0,0,0,0.5)"},onClick:()=>{t("shadow",{color:"rgba(0,0,0,0.5)",blur:5,offsetX:5,offsetY:5})},children:"Shadow"}),V.jsx("button",{className:"btn-effect",style:{padding:"8px",border:"1px solid var(--border-color)",borderRadius:"6px",background:"var(--bg-tertiary)",cursor:"pointer",fontSize:"0.8rem",color:"var(--text-primary)",textShadow:"0 10px 20px rgba(0,0,0,0.5)"},onClick:()=>{t("shadow",{color:"rgba(0,0,0,0.6)",blur:25,offsetX:0,offsetY:0})},children:"Lift"}),V.jsx("button",{className:"btn-effect",style:{padding:"8px",border:"1px solid var(--border-color)",borderRadius:"6px",background:"var(--bg-tertiary)",cursor:"pointer",fontSize:"0.8rem",color:"#ff00ff",textShadow:"0 0 10px #ff00ff"},onClick:()=>{const h=n.fill&&n.fill!=="transparent"?n.fill:"#ff00ff";t("shadow",{color:h,blur:20,offsetX:0,offsetY:0})},children:"Neon"}),V.jsx("button",{className:"btn-effect",style:{padding:"8px",border:"1px solid var(--border-color)",borderRadius:"6px",background:"var(--bg-tertiary)",cursor:"pointer",fontSize:"0.8rem",color:"var(--text-primary)",WebkitTextStroke:"1px var(--text-primary)",textStroke:"1px var(--text-primary)"},onClick:()=>{t("stroke",n.fill||"#000000"),t("strokeWidth",1),t("shadow",null)},children:"Outline"}),V.jsx("button",{className:"btn-effect",style:{padding:"8px",border:"1px solid var(--border-color)",borderRadius:"6px",background:"var(--bg-tertiary)",cursor:"pointer",fontSize:"0.8rem",color:"var(--bg-tertiary)",WebkitTextStroke:"1px var(--text-primary)"},onClick:()=>{t("stroke","#ffffff"),t("strokeWidth",2),t("fill",null),t("shadow",null)},children:"Hollow"})]})]})}function Zst({activeObject:n,onUpdate:e}){const{setColorPickerVisible:t,setColorPickerAnchor:s,setActiveColorProp:r,setColorPickerAlign:a}=Nb();if(!n)return null;const o=(S,C,M="left")=>{r(C),s(S.currentTarget),a(M),t(!0)},l=n.fill,c=n.stroke,u=n.strokeWidth||0,f=n.strokeDashArray;let d="solid";f&&f.length>0&&(f[0]<5?d="dotted":d="dashed");const h=S=>{let C=null;S==="dashed"&&(C=[10,5]),S==="dotted"&&(C=[2,2]),e("strokeDashArray",C)},p=n.shadow||{},g=p.color||"#000000",b=p.blur||0,v=p.offsetX||0,w=p.offsetY||0,x=(S,C)=>{e(`shadow.${S}`,C)};return V.jsxs("div",{className:"section",children:[V.jsx("div",{className:"section-title",children:"Appearance"}),V.jsxs("div",{className:"inputs-grid-2",children:[V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"Fill"}),V.jsx("div",{className:"color-swatch-btn",style:{backgroundColor:typeof l=="string"?l:"transparent",backgroundImage:typeof l!="string"?"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)":"none"},onClick:S=>o(S,"fill","right"),children:typeof l!="string"&&V.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(to right, transparent, rgba(0,0,0,0.1))"}})})]}),V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"Stroke"}),V.jsx("div",{className:"color-swatch-btn",style:{backgroundColor:typeof c=="string"?c:"transparent"},onClick:S=>o(S,"stroke","right")})]})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Stroke Width"}),V.jsx("span",{className:"value-display",children:u})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"50",value:u,onChange:S=>e("strokeWidth",parseFloat(S.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsx("label",{className:"input-label",children:"Stroke Style"}),V.jsxs("select",{className:"select-field",value:d,onChange:S=>h(S.target.value),children:[V.jsx("option",{value:"solid",children:"Solid"}),V.jsx("option",{value:"dashed",children:"Dashed"}),V.jsx("option",{value:"dotted",children:"Dotted"})]})]}),V.jsx("div",{className:"section-divider my-2"}),V.jsx("div",{className:"section-title",children:"Shadow"}),V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"Shadow Color"}),V.jsx("div",{className:"color-swatch-btn",style:{backgroundColor:g},onClick:S=>o(S,"shadow.color","right")})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Blur"}),V.jsx("span",{className:"value-display",children:b})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"50",value:b,onChange:S=>x("blur",parseInt(S.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"X Offset"}),V.jsx("span",{className:"value-display",children:v})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-50",max:"50",value:v,onChange:S=>x("offsetX",parseInt(S.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Y Offset"}),V.jsx("span",{className:"value-display",children:w})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-50",max:"50",value:w,onChange:S=>x("offsetY",parseInt(S.target.value))})]})]})}function ert({activeObject:n,canvasManager:e,onUpdate:t}){const{setColorPickerVisible:s,setColorPickerAnchor:r,setActiveColorProp:a}=Nb();if(!n||n.type!=="image"&&n.type!=="fabric-image")return null;const o=(D,L)=>{a(L),r(D.currentTarget),s(!0)},l=D=>{if(!n.filters)return 0;const P={brightness:"Brightness",contrast:"Contrast",blur:"Blur",saturation:"Saturation",grayscale:"Grayscale",sepia:"Sepia",hue:"HueRotation",noise:"Noise",pixelate:"Pixelate",tint:"BlendColor"}[D],j=n.filters.find(G=>G.type===P);return j?D==="blur"?j.blur||0:D==="pixelate"?j.blocksize||0:D==="hue"?j.rotation||0:D==="noise"?j.noise||0:D==="sharpen"?j.matrix?(j.matrix[4]-1)/4:0:j[D]||0:0},c=n.fill,[u,f]=Hr.useState(!1),[d,h]=Hr.useState(!1),[p,g]=Hr.useState(!1),[b,v]=Hr.useState(!1),[w,x]=Hr.useState(0),{extractedPalette:S,setExtractedPalette:C}=Nb();Hr.useEffect(()=>{const D=l("sharpen");Math.abs(D-w)>.01&&x(D)},[n]);const M=async()=>{if(n){h(!0),$s.info("Removing background. This may take a moment...",3e3);try{const D=n.getSrc();$s.info("Downloading AI models. Check Console for progress...",5e3);const L=await sh.removeBackground(D),P=URL.createObjectURL(L);await e.replaceImage(n,P),$s.success("Background removed!")}catch(D){console.error("Background removal failed:",D),$s.error("Failed to remove background.")}finally{h(!1)}}},k=async()=>{v(!0);try{await e.extractTextFromActiveImage()}finally{v(!1)}},E=async()=>{if(!e)return;const D=await e.extractPaletteFromActiveImage();D&&C(D)},I=async()=>{g(!0);try{await e.upscaleActiveImage()}finally{g(!1)}},A=D=>{x(D),t("filter.sharpen",D)};return Hr.useEffect(()=>{if(!e)return;f(!!e.isCropping);const D=e.onCropModeChange;return e.onCropModeChange=L=>{f(L),D&&D(L)},()=>{e.onCropModeChange=D}},[e,n]),V.jsxs("div",{className:"section",children:[V.jsx("div",{className:"section-title",children:"Image Correction"}),V.jsxs("button",{className:`btn-secondary full-width mb-2 ${u?"active":""}`,onClick:()=>u?e.cancelCrop():e.startCropMode(),style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:u?"var(--accent-primary)":"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px 0",color:u?"#fff":"var(--text-primary)",transition:"all 0.3s ease",fontWeight:500,fontSize:"0.85rem"},children:[V.jsx(oU,{size:16}),V.jsx("span",{children:u?"Done Cropping":"Crop Image"})]}),V.jsx("button",{className:"btn-primary full-width mb-2",onClick:M,disabled:d,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",border:"none",borderRadius:"8px",padding:"12px 0",boxShadow:"0 4px 6px -1px rgba(99, 102, 241, 0.2), 0 2px 4px -1px rgba(99, 102, 241, 0.1)",transition:"all 0.3s ease",fontWeight:500,fontSize:"0.85rem"},children:d?V.jsx("div",{className:"spinner-small",style:{border:"2px solid rgba(255,255,255,0.3)",borderTopColor:"#fff",borderRadius:"50%",width:"16px",height:"16px",animation:"spin 1s linear infinite"}}):V.jsxs(V.Fragment,{children:[V.jsx(cU,{size:16,color:"#fff"}),V.jsx("span",{children:"Remove BG"})]})}),V.jsxs("button",{className:"btn-secondary full-width mb-2",onClick:()=>e.vectorizeActiveImage(),style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px 0",color:"var(--text-primary)",transition:"all 0.3s ease",fontWeight:500,fontSize:"0.85rem"},children:[V.jsx(pM,{size:16}),V.jsx("span",{children:"Vectorize"})]}),V.jsx("button",{className:"btn-secondary full-width mb-2",onClick:I,disabled:p,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"12px 0",borderRadius:"8px",fontSize:"0.85rem",background:"var(--bg-tertiary)",border:"1px solid var(--border-color)",color:"var(--text-primary)",transition:"all 0.3s ease",fontWeight:500},children:p?V.jsx("div",{className:"spinner-small",style:{border:"2px solid rgba(255,255,255,0.3)",borderTopColor:"var(--accent-primary)",borderRadius:"50%",width:"16px",height:"16px",animation:"spin 1s linear infinite"}}):V.jsxs(V.Fragment,{children:[V.jsx(xfe,{size:16,className:"text-accent",style:{color:"#fbbf24"}}),V.jsx("span",{children:"AI Upscale (x2)"})]})}),V.jsxs("button",{className:"btn-secondary full-width mb-3",onClick:E,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"10px 0",borderRadius:"8px",fontSize:"0.85rem"},children:[V.jsxs("div",{style:{display:"flex",gap:"3px"},children:[V.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#ef4444"}}),V.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#3b82f6"}}),V.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#10b981"}})]}),V.jsx("span",{children:"Extract Color Palette"})]}),V.jsx("button",{className:"btn-secondary full-width mb-3",onClick:k,disabled:b,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"10px 0",borderRadius:"8px",fontSize:"0.85rem"},children:b?V.jsx("div",{className:"spinner-small",style:{border:"2px solid rgba(255,255,255,0.3)",borderTopColor:"var(--accent-primary)",borderRadius:"50%",width:"16px",height:"16px",animation:"spin 1s linear infinite"}}):V.jsxs(V.Fragment,{children:[V.jsx(htt,{size:16}),V.jsx("span",{children:"Extract Text (OCR)"})]})}),V.jsxs("div",{className:"input-group mb-3",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[V.jsx("label",{className:"input-label",style:{margin:0},children:"Sharpen (Clear)"}),V.jsx("span",{className:"value-display",style:{opacity:.6},children:w>0?`${Math.round(w*200)}%`:"Off"})]}),V.jsx("div",{style:{display:"flex",width:"100%",borderRadius:"4px",overflow:"hidden",border:"1px solid #333"},children:[{label:"Off",val:0},{label:"1x",val:.1},{label:"2x",val:.2},{label:"3x",val:.35},{label:"4x",val:.5}].map((D,L,P)=>{const j=Math.abs(w-D.val)<.01;return V.jsx("button",{onClick:()=>A(D.val),title:D.label,style:{flex:1,padding:"6px 0",fontSize:"0.8em",backgroundColor:j?"var(--primary-color, #007bff)":"#2a2a2a",color:j?"#fff":"#888",border:"none",borderRight:L<P.length-1?"1px solid #333":"none",borderRadius:0,cursor:"pointer",transition:"all 0.2s ease"},children:D.label},D.label)})})]}),V.jsxs("div",{className:"input-group",children:[V.jsx("label",{className:"input-label",children:"Tint"}),V.jsx("div",{className:"color-swatch-btn",style:{backgroundColor:typeof c=="string"?c:"transparent"},onClick:D=>o(D,"fill")})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Brightness"}),V.jsx("span",{className:"value-display",children:Math.round(l("brightness")*100)/100})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-1",max:"1",step:"0.05",value:l("brightness"),onChange:D=>t("filter.brightness",parseFloat(D.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Contrast"}),V.jsx("span",{className:"value-display",children:Math.round(l("contrast")*100)/100})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-1",max:"1",step:"0.05",value:l("contrast"),onChange:D=>t("filter.contrast",parseFloat(D.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Blur"}),V.jsx("span",{className:"value-display",children:Math.round(l("blur")*100)/100})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"1",step:"0.05",value:l("blur"),onChange:D=>t("filter.blur",parseFloat(D.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Saturation"}),V.jsx("span",{className:"value-display",children:Math.round(l("saturation")*100)/100})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-1",max:"1",step:"0.1",value:l("saturation"),onChange:D=>t("filter.saturation",parseFloat(D.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Hue"}),V.jsx("span",{className:"value-display",children:Math.round(l("hue"))})]}),V.jsx("input",{type:"range",className:"range-slider",min:"-1",max:"1",step:"0.1",value:l("hue"),onChange:D=>t("filter.hue",parseFloat(D.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Noise"}),V.jsx("span",{className:"value-display",children:l("noise")})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"100",step:"5",value:l("noise"),onChange:D=>t("filter.noise",parseInt(D.target.value))})]}),V.jsxs("div",{className:"input-group mt-2",children:[V.jsxs("div",{className:"label-row",style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[V.jsx("label",{className:"input-label",children:"Pixelate"}),V.jsx("span",{className:"value-display",children:l("pixelate")})]}),V.jsx("input",{type:"range",className:"range-slider",min:"0",max:"20",step:"1",value:l("pixelate"),onChange:D=>t("filter.pixelate",parseInt(D.target.value))})]})]})}function trt({activeObject:n,canvasManager:e}){if(!n)return null;const t=c=>e.alignObjects(c,!1),s=c=>{e.distributeObjects(c)},r=c=>e.layerActiveObject(c),a=c=>e.flipActiveObject(c),o=n.type?n.type.toLowerCase():"",l=o==="activeselection"||o==="group";return V.jsxs("div",{className:"section",children:[V.jsx("div",{className:"section-header",style:{marginBottom:"8px"},children:V.jsx("div",{className:"section-title",children:"Align & Distribute"})}),V.jsxs("div",{className:"inputs-grid-4 mb-2",children:[V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>t("left"),title:"Left",children:V.jsx(Sfe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>t("center"),title:"Center",children:V.jsx(EZe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>t("right"),title:"Right",children:V.jsx(Cfe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>s("horizontal"),title:"Distribute Horizontal",children:V.jsx(AZe,{size:14})})]}),V.jsxs("div",{className:"inputs-grid-4 mb-2",children:[V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>t("top"),title:"Top",children:V.jsx(UZe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>t("middle"),title:"Middle",children:V.jsx(OZe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>t("bottom"),title:"Bottom",children:V.jsx($Ze,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>s("vertical"),title:"Distribute Vertical",children:V.jsx(NZe,{size:14})})]}),V.jsx("div",{className:"section-title mt-3",children:"Order & Group"}),V.jsxs("div",{className:"inputs-grid-4 mb-2",children:[V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>a("horizontal"),title:"Flip Horizontal",children:V.jsx(cfe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>a("vertical"),title:"Flip Vertical",children:V.jsx(ufe,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>r("up"),title:"Bring Forward",children:V.jsx(iU,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>r("down"),title:"Send Backward",children:V.jsx(rU,{size:14})})]}),l&&V.jsxs("div",{className:"inputs-grid-4",children:[V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>e.group(),title:"Group Objects",children:V.jsx(wet,{size:14})}),V.jsx("button",{className:"icon-btn btn-xs",onClick:()=>e.ungroup(),title:"Ungroup Objects",children:V.jsx(met,{size:14})})]})]})}function nrt({onUpdate:n}){const{extractedPalette:e,setExtractedPalette:t}=Nb();if(!e)return null;const s=[e.dominant,...e.palette],r=a=>{n("fill",a),$s.info(`Color ${a} applied!`)};return V.jsxs("div",{className:"section document-palette",children:[V.jsxs("div",{className:"section-title",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[V.jsx("span",{children:"Document Palette"}),V.jsx("button",{className:"ft-btn",onClick:()=>t(null),title:"Clear Palette",style:{padding:"2px",height:"auto"},children:V.jsx(oP,{size:12})})]}),V.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"8px"},children:s.map((a,o)=>V.jsx("div",{className:"color-swatch-btn",style:{backgroundColor:a,width:"28px",height:"28px",border:a.toLowerCase()==="#ffffff"?"1px solid var(--border-color)":"none",cursor:"pointer",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",transition:"transform 0.2s ease"},onClick:()=>r(a),title:`Apply ${a}`,onMouseEnter:l=>l.currentTarget.style.transform="scale(1.1)",onMouseLeave:l=>l.currentTarget.style.transform="scale(1)"},`${a}-${o}`))})]})}function srt(){const{canvasManager:n,activeObject:e}=aP(),[,t]=Ie.useState({});Ie.useEffect(()=>{if(!n||!n.canvas)return;const u=()=>t({});return n.canvas.on("object:modified",u),()=>{n.canvas&&n.canvas.off("object:modified",u)}},[n]);const s=(u,f)=>{n&&e&&(n.updateActiveObject(u,f),t({}))};if(!e)return V.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999",fontSize:"0.9em"},children:"Select an object"});const r=e.type,a=r==="i-text"||r==="text",o=r==="image"||r==="fabric-image",l=r==="group"||r==="activeSelection"||r==="activeselection",c=["rect","circle","triangle","polygon","path","line"].includes(r);return V.jsxs("div",{className:"property-panel",children:[V.jsx(nrt,{onUpdate:s}),V.jsx(Qst,{activeObject:e,onUpdate:s}),a&&V.jsx(Jst,{activeObject:e,canvasManager:n,onUpdate:s}),(c||l||a)&&V.jsx(Zst,{activeObject:e,onUpdate:s}),o&&V.jsx(ert,{activeObject:e,canvasManager:n,onUpdate:s}),V.jsx("div",{className:"section-divider my-2"}),V.jsx(trt,{activeObject:e,canvasManager:n})]})}const rrt="https://api.unsplash.com",R$="unsplash_access_key",irt="2ImRn-jXTI2k3XM0W8xp4Szj9X889Z2KBA50D4qyt74",V0={getApiKey:()=>localStorage.getItem(R$)||irt,setApiKey:n=>{localStorage.setItem(R$,n)},removeApiKey:()=>{localStorage.removeItem(R$)},searchPhotos:async(n,e=1,t=20)=>{const s=V0.getApiKey(),r=await fetch(`${rrt}/search/photos?query=${encodeURIComponent(n)}&page=${e}&per_page=${t}`,{headers:{Authorization:`Client-ID ${s}`}});if(!r.ok)throw r.status===401?new Error("Invalid Access Key"):new Error(`API Error: ${r.statusText}`);return await r.json()},triggerDownload:async n=>{const e=V0.getApiKey();try{await fetch(n,{headers:{Authorization:`Client-ID ${e}`}})}catch(t){console.error("Failed to trigger download event:",t)}}},F$="https://api.iconify.design",z$={searchIcons:async(n,e=50)=>{try{const t=await fetch(`${F$}/search?query=${encodeURIComponent(n)}&limit=${e}`);if(!t.ok)throw new Error("Icon search failed");return(await t.json()).icons||[]}catch(t){return console.error("IconService Search Error:",t),[]}},getIconSVG:async n=>{try{const e=n.split(":");if(e.length!==2)return null;const t=e[0],s=e[1],r=await fetch(`${F$}/${t}/${s}.svg`);if(!r.ok)throw new Error("Failed to fetch SVG");return await r.text()}catch(e){return console.error("IconService SVG Error:",e),null}},getIconPreviewUrl:n=>{const e=n.split(":");return e.length!==2?"":`${F$}/${e[0]}/${e[1]}.svg`}};var wv={},B$,CQ;function art(){return CQ||(CQ=1,B$=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),B$}var U$={},R0={},SQ;function lw(){if(SQ)return R0;SQ=1;let n;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return R0.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17},R0.getSymbolTotalCodewords=function(s){return e[s]},R0.getBCHDigit=function(t){let s=0;for(;t!==0;)s++,t>>>=1;return s},R0.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');n=s},R0.isKanjiModeEnabled=function(){return typeof n<"u"},R0.toSJIS=function(s){return n(s)},R0}var V$={},MQ;function BU(){return MQ||(MQ=1,(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},n.from=function(s,r){if(n.isValid(s))return s;try{return e(s)}catch{return r}}})(V$)),V$}var W$,TQ;function ort(){if(TQ)return W$;TQ=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let s=0;s<t;s++)this.putBit((e>>>t-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},W$=n,W$}var G$,kQ;function lrt(){if(kQ)return G$;kQ=1;function n(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return n.prototype.set=function(e,t,s,r){const a=e*this.size+t;this.data[a]=s,r&&(this.reservedBit[a]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,s){this.data[e*this.size+t]^=s},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},G$=n,G$}var H$={},EQ;function crt(){return EQ||(EQ=1,(function(n){const e=lw().getSymbolSize;n.getRowColCoords=function(s){if(s===1)return[];const r=Math.floor(s/7)+2,a=e(s),o=a===145?26:Math.ceil((a-13)/(2*r-2))*2,l=[a-7];for(let c=1;c<r-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},n.getPositions=function(s){const r=[],a=n.getRowColCoords(s),o=a.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||r.push([a[l],a[c]]);return r}})(H$)),H$}var q$={},IQ;function urt(){if(IQ)return q$;IQ=1;const n=lw().getSymbolSize,e=7;return q$.getPositions=function(s){const r=n(s);return[[0,0],[r-e,0],[0,r-e]]},q$}var Y$={},AQ;function frt(){return AQ||(AQ=1,(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},n.from=function(r){return n.isValid(r)?parseInt(r,10):void 0},n.getPenaltyN1=function(r){const a=r.size;let o=0,l=0,c=0,u=null,f=null;for(let d=0;d<a;d++){l=c=0,u=f=null;for(let h=0;h<a;h++){let p=r.get(d,h);p===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=p,l=1),p=r.get(h,d),p===f?c++:(c>=5&&(o+=e.N1+(c-5)),f=p,c=1)}l>=5&&(o+=e.N1+(l-5)),c>=5&&(o+=e.N1+(c-5))}return o},n.getPenaltyN2=function(r){const a=r.size;let o=0;for(let l=0;l<a-1;l++)for(let c=0;c<a-1;c++){const u=r.get(l,c)+r.get(l,c+1)+r.get(l+1,c)+r.get(l+1,c+1);(u===4||u===0)&&o++}return o*e.N2},n.getPenaltyN3=function(r){const a=r.size;let o=0,l=0,c=0;for(let u=0;u<a;u++){l=c=0;for(let f=0;f<a;f++)l=l<<1&2047|r.get(u,f),f>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|r.get(f,u),f>=10&&(c===1488||c===93)&&o++}return o*e.N3},n.getPenaltyN4=function(r){let a=0;const o=r.data.length;for(let c=0;c<o;c++)a+=r.data[c];return Math.abs(Math.ceil(a*100/o/5)-10)*e.N4};function t(s,r,a){switch(s){case n.Patterns.PATTERN000:return(r+a)%2===0;case n.Patterns.PATTERN001:return r%2===0;case n.Patterns.PATTERN010:return a%3===0;case n.Patterns.PATTERN011:return(r+a)%3===0;case n.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(a/3))%2===0;case n.Patterns.PATTERN101:return r*a%2+r*a%3===0;case n.Patterns.PATTERN110:return(r*a%2+r*a%3)%2===0;case n.Patterns.PATTERN111:return(r*a%3+(r+a)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}n.applyMask=function(r,a){const o=a.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)a.isReserved(c,l)||a.xor(c,l,t(r,c,l))},n.getBestMask=function(r,a){const o=Object.keys(n.Patterns).length;let l=0,c=1/0;for(let u=0;u<o;u++){a(u),n.applyMask(u,r);const f=n.getPenaltyN1(r)+n.getPenaltyN2(r)+n.getPenaltyN3(r)+n.getPenaltyN4(r);n.applyMask(u,r),f<c&&(c=f,l=u)}return l}})(Y$)),Y$}var sA={},LQ;function bme(){if(LQ)return sA;LQ=1;const n=BU(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return sA.getBlocksCount=function(r,a){switch(a){case n.L:return e[(r-1)*4+0];case n.M:return e[(r-1)*4+1];case n.Q:return e[(r-1)*4+2];case n.H:return e[(r-1)*4+3];default:return}},sA.getTotalCodewordsCount=function(r,a){switch(a){case n.L:return t[(r-1)*4+0];case n.M:return t[(r-1)*4+1];case n.Q:return t[(r-1)*4+2];case n.H:return t[(r-1)*4+3];default:return}},sA}var K$={},oS={},NQ;function drt(){if(NQ)return oS;NQ=1;const n=new Uint8Array(512),e=new Uint8Array(256);return(function(){let s=1;for(let r=0;r<255;r++)n[r]=s,e[s]=r,s<<=1,s&256&&(s^=285);for(let r=255;r<512;r++)n[r]=n[r-255]})(),oS.log=function(s){if(s<1)throw new Error("log("+s+")");return e[s]},oS.exp=function(s){return n[s]},oS.mul=function(s,r){return s===0||r===0?0:n[e[s]+e[r]]},oS}var DQ;function hrt(){return DQ||(DQ=1,(function(n){const e=drt();n.mul=function(s,r){const a=new Uint8Array(s.length+r.length-1);for(let o=0;o<s.length;o++)for(let l=0;l<r.length;l++)a[o+l]^=e.mul(s[o],r[l]);return a},n.mod=function(s,r){let a=new Uint8Array(s);for(;a.length-r.length>=0;){const o=a[0];for(let c=0;c<r.length;c++)a[c]^=e.mul(r[c],o);let l=0;for(;l<a.length&&a[l]===0;)l++;a=a.slice(l)}return a},n.generateECPolynomial=function(s){let r=new Uint8Array([1]);for(let a=0;a<s;a++)r=n.mul(r,new Uint8Array([1,e.exp(a)]));return r}})(K$)),K$}var X$,OQ;function prt(){if(OQ)return X$;OQ=1;const n=hrt();function e(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(s){this.degree=s,this.genPoly=n.generateECPolynomial(this.degree)},e.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(s.length+this.degree);r.set(s);const a=n.mod(r,this.genPoly),o=this.degree-a.length;if(o>0){const l=new Uint8Array(this.degree);return l.set(a,o),l}return a},X$=e,X$}var Q$={},J$={},Z$={},PQ;function wme(){return PQ||(PQ=1,Z$.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),Z$}var im={},$Q;function vme(){if($Q)return im;$Q=1;const n="[0-9]+",e="[A-Z $%*+\\-./:]+";let t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";t=t.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+t+`)(?:.|[\r
]))+`;im.KANJI=new RegExp(t,"g"),im.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),im.BYTE=new RegExp(s,"g"),im.NUMERIC=new RegExp(n,"g"),im.ALPHANUMERIC=new RegExp(e,"g");const r=new RegExp("^"+t+"$"),a=new RegExp("^"+n+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return im.testKanji=function(c){return r.test(c)},im.testNumeric=function(c){return a.test(c)},im.testAlphanumeric=function(c){return o.test(c)},im}var jQ;function cw(){return jQ||(jQ=1,(function(n){const e=wme(),t=vme();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(a,o){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?a.ccBits[0]:o<27?a.ccBits[1]:a.ccBits[2]},n.getBestModeForData=function(a){return t.testNumeric(a)?n.NUMERIC:t.testAlphanumeric(a)?n.ALPHANUMERIC:t.testKanji(a)?n.KANJI:n.BYTE},n.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},n.isValid=function(a){return a&&a.bit&&a.ccBits};function s(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+r)}}n.from=function(a,o){if(n.isValid(a))return a;try{return s(a)}catch{return o}}})(J$)),J$}var RQ;function mrt(){return RQ||(RQ=1,(function(n){const e=lw(),t=bme(),s=BU(),r=cw(),a=wme(),o=7973,l=e.getBCHDigit(o);function c(h,p,g){for(let b=1;b<=40;b++)if(p<=n.getCapacity(b,g,h))return b}function u(h,p){return r.getCharCountIndicator(h,p)+4}function f(h,p){let g=0;return h.forEach(function(b){const v=u(b.mode,p);g+=v+b.getBitsLength()}),g}function d(h,p){for(let g=1;g<=40;g++)if(f(h,g)<=n.getCapacity(g,p,r.MIXED))return g}n.from=function(p,g){return a.isValid(p)?parseInt(p,10):g},n.getCapacity=function(p,g,b){if(!a.isValid(p))throw new Error("Invalid QR Code version");typeof b>"u"&&(b=r.BYTE);const v=e.getSymbolTotalCodewords(p),w=t.getTotalCodewordsCount(p,g),x=(v-w)*8;if(b===r.MIXED)return x;const S=x-u(b,p);switch(b){case r.NUMERIC:return Math.floor(S/10*3);case r.ALPHANUMERIC:return Math.floor(S/11*2);case r.KANJI:return Math.floor(S/13);case r.BYTE:default:return Math.floor(S/8)}},n.getBestVersionForData=function(p,g){let b;const v=s.from(g,s.M);if(Array.isArray(p)){if(p.length>1)return d(p,v);if(p.length===0)return 1;b=p[0]}else b=p;return c(b.mode,b.getLength(),v)},n.getEncodedBits=function(p){if(!a.isValid(p)||p<7)throw new Error("Invalid QR Code version");let g=p<<12;for(;e.getBCHDigit(g)-l>=0;)g^=o<<e.getBCHDigit(g)-l;return p<<12|g}})(Q$)),Q$}var ej={},FQ;function grt(){if(FQ)return ej;FQ=1;const n=lw(),e=1335,t=21522,s=n.getBCHDigit(e);return ej.getEncodedBits=function(a,o){const l=a.bit<<3|o;let c=l<<10;for(;n.getBCHDigit(c)-s>=0;)c^=e<<n.getBCHDigit(c)-s;return(l<<10|c)^t},ej}var tj={},nj,zQ;function yrt(){if(zQ)return nj;zQ=1;const n=cw();function e(t){this.mode=n.NUMERIC,this.data=t.toString()}return e.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(s){let r,a,o;for(r=0;r+3<=this.data.length;r+=3)a=this.data.substr(r,3),o=parseInt(a,10),s.put(o,10);const l=this.data.length-r;l>0&&(a=this.data.substr(r),o=parseInt(a,10),s.put(o,l*3+1))},nj=e,nj}var sj,BQ;function brt(){if(BQ)return sj;BQ=1;const n=cw(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t(s){this.mode=n.ALPHANUMERIC,this.data=s}return t.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){let a;for(a=0;a+2<=this.data.length;a+=2){let o=e.indexOf(this.data[a])*45;o+=e.indexOf(this.data[a+1]),r.put(o,11)}this.data.length%2&&r.put(e.indexOf(this.data[a]),6)},sj=t,sj}var rj,UQ;function wrt(){if(UQ)return rj;UQ=1;const n=cw();function e(t){this.mode=n.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}return e.getBitsLength=function(s){return s*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(t){for(let s=0,r=this.data.length;s<r;s++)t.put(this.data[s],8)},rj=e,rj}var ij,VQ;function vrt(){if(VQ)return ij;VQ=1;const n=cw(),e=lw();function t(s){this.mode=n.KANJI,this.data=s}return t.getBitsLength=function(r){return r*13},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(s){let r;for(r=0;r<this.data.length;r++){let a=e.toSJIS(this.data[r]);if(a>=33088&&a<=40956)a-=33088;else if(a>=57408&&a<=60351)a-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);a=(a>>>8&255)*192+(a&255),s.put(a,13)}},ij=t,ij}var aj={exports:{}},WQ;function _rt(){return WQ||(WQ=1,(function(n){var e={single_source_shortest_paths:function(t,s,r){var a={},o={};o[s]=0;var l=e.PriorityQueue.make();l.push(s,0);for(var c,u,f,d,h,p,g,b,v;!l.empty();){c=l.pop(),u=c.value,d=c.cost,h=t[u]||{};for(f in h)h.hasOwnProperty(f)&&(p=h[f],g=d+p,b=o[f],v=typeof o[f]>"u",(v||b>g)&&(o[f]=g,l.push(f,g),a[f]=u))}if(typeof r<"u"&&typeof o[r]>"u"){var w=["Could not find a path from ",s," to ",r,"."].join("");throw new Error(w)}return a},extract_shortest_path_from_predecessor_list:function(t,s){for(var r=[],a=s;a;)r.push(a),t[a],a=t[a];return r.reverse(),r},find_path:function(t,s,r){var a=e.single_source_shortest_paths(t,s,r);return e.extract_shortest_path_from_predecessor_list(a,r)},PriorityQueue:{make:function(t){var s=e.PriorityQueue,r={},a;t=t||{};for(a in s)s.hasOwnProperty(a)&&(r[a]=s[a]);return r.queue=[],r.sorter=t.sorter||s.default_sorter,r},default_sorter:function(t,s){return t.cost-s.cost},push:function(t,s){var r={value:t,cost:s};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(aj)),aj.exports}var GQ;function xrt(){return GQ||(GQ=1,(function(n){const e=cw(),t=yrt(),s=brt(),r=wrt(),a=vrt(),o=vme(),l=lw(),c=_rt();function u(w){return unescape(encodeURIComponent(w)).length}function f(w,x,S){const C=[];let M;for(;(M=w.exec(S))!==null;)C.push({data:M[0],index:M.index,mode:x,length:M[0].length});return C}function d(w){const x=f(o.NUMERIC,e.NUMERIC,w),S=f(o.ALPHANUMERIC,e.ALPHANUMERIC,w);let C,M;return l.isKanjiModeEnabled()?(C=f(o.BYTE,e.BYTE,w),M=f(o.KANJI,e.KANJI,w)):(C=f(o.BYTE_KANJI,e.BYTE,w),M=[]),x.concat(S,C,M).sort(function(E,I){return E.index-I.index}).map(function(E){return{data:E.data,mode:E.mode,length:E.length}})}function h(w,x){switch(x){case e.NUMERIC:return t.getBitsLength(w);case e.ALPHANUMERIC:return s.getBitsLength(w);case e.KANJI:return a.getBitsLength(w);case e.BYTE:return r.getBitsLength(w)}}function p(w){return w.reduce(function(x,S){const C=x.length-1>=0?x[x.length-1]:null;return C&&C.mode===S.mode?(x[x.length-1].data+=S.data,x):(x.push(S),x)},[])}function g(w){const x=[];for(let S=0;S<w.length;S++){const C=w[S];switch(C.mode){case e.NUMERIC:x.push([C,{data:C.data,mode:e.ALPHANUMERIC,length:C.length},{data:C.data,mode:e.BYTE,length:C.length}]);break;case e.ALPHANUMERIC:x.push([C,{data:C.data,mode:e.BYTE,length:C.length}]);break;case e.KANJI:x.push([C,{data:C.data,mode:e.BYTE,length:u(C.data)}]);break;case e.BYTE:x.push([{data:C.data,mode:e.BYTE,length:u(C.data)}])}}return x}function b(w,x){const S={},C={start:{}};let M=["start"];for(let k=0;k<w.length;k++){const E=w[k],I=[];for(let A=0;A<E.length;A++){const D=E[A],L=""+k+A;I.push(L),S[L]={node:D,lastCount:0},C[L]={};for(let P=0;P<M.length;P++){const j=M[P];S[j]&&S[j].node.mode===D.mode?(C[j][L]=h(S[j].lastCount+D.length,D.mode)-h(S[j].lastCount,D.mode),S[j].lastCount+=D.length):(S[j]&&(S[j].lastCount=D.length),C[j][L]=h(D.length,D.mode)+4+e.getCharCountIndicator(D.mode,x))}}M=I}for(let k=0;k<M.length;k++)C[M[k]].end=0;return{map:C,table:S}}function v(w,x){let S;const C=e.getBestModeForData(w);if(S=e.from(x,C),S!==e.BYTE&&S.bit<C.bit)throw new Error('"'+w+'" cannot be encoded with mode '+e.toString(S)+`.
 Suggested mode is: `+e.toString(C));switch(S===e.KANJI&&!l.isKanjiModeEnabled()&&(S=e.BYTE),S){case e.NUMERIC:return new t(w);case e.ALPHANUMERIC:return new s(w);case e.KANJI:return new a(w);case e.BYTE:return new r(w)}}n.fromArray=function(x){return x.reduce(function(S,C){return typeof C=="string"?S.push(v(C,null)):C.data&&S.push(v(C.data,C.mode)),S},[])},n.fromString=function(x,S){const C=d(x,l.isKanjiModeEnabled()),M=g(C),k=b(M,S),E=c.find_path(k.map,"start","end"),I=[];for(let A=1;A<E.length-1;A++)I.push(k.table[E[A]].node);return n.fromArray(p(I))},n.rawSplit=function(x){return n.fromArray(d(x,l.isKanjiModeEnabled()))}})(tj)),tj}var HQ;function Crt(){if(HQ)return U$;HQ=1;const n=lw(),e=BU(),t=ort(),s=lrt(),r=crt(),a=urt(),o=frt(),l=bme(),c=prt(),u=mrt(),f=grt(),d=cw(),h=xrt();function p(k,E){const I=k.size,A=a.getPositions(E);for(let D=0;D<A.length;D++){const L=A[D][0],P=A[D][1];for(let j=-1;j<=7;j++)if(!(L+j<=-1||I<=L+j))for(let G=-1;G<=7;G++)P+G<=-1||I<=P+G||(j>=0&&j<=6&&(G===0||G===6)||G>=0&&G<=6&&(j===0||j===6)||j>=2&&j<=4&&G>=2&&G<=4?k.set(L+j,P+G,!0,!0):k.set(L+j,P+G,!1,!0))}}function g(k){const E=k.size;for(let I=8;I<E-8;I++){const A=I%2===0;k.set(I,6,A,!0),k.set(6,I,A,!0)}}function b(k,E){const I=r.getPositions(E);for(let A=0;A<I.length;A++){const D=I[A][0],L=I[A][1];for(let P=-2;P<=2;P++)for(let j=-2;j<=2;j++)P===-2||P===2||j===-2||j===2||P===0&&j===0?k.set(D+P,L+j,!0,!0):k.set(D+P,L+j,!1,!0)}}function v(k,E){const I=k.size,A=u.getEncodedBits(E);let D,L,P;for(let j=0;j<18;j++)D=Math.floor(j/3),L=j%3+I-8-3,P=(A>>j&1)===1,k.set(D,L,P,!0),k.set(L,D,P,!0)}function w(k,E,I){const A=k.size,D=f.getEncodedBits(E,I);let L,P;for(L=0;L<15;L++)P=(D>>L&1)===1,L<6?k.set(L,8,P,!0):L<8?k.set(L+1,8,P,!0):k.set(A-15+L,8,P,!0),L<8?k.set(8,A-L-1,P,!0):L<9?k.set(8,15-L-1+1,P,!0):k.set(8,15-L-1,P,!0);k.set(A-8,8,1,!0)}function x(k,E){const I=k.size;let A=-1,D=I-1,L=7,P=0;for(let j=I-1;j>0;j-=2)for(j===6&&j--;;){for(let G=0;G<2;G++)if(!k.isReserved(D,j-G)){let Q=!1;P<E.length&&(Q=(E[P]>>>L&1)===1),k.set(D,j-G,Q),L--,L===-1&&(P++,L=7)}if(D+=A,D<0||I<=D){D-=A,A=-A;break}}}function S(k,E,I){const A=new t;I.forEach(function(G){A.put(G.mode.bit,4),A.put(G.getLength(),d.getCharCountIndicator(G.mode,k)),G.write(A)});const D=n.getSymbolTotalCodewords(k),L=l.getTotalCodewordsCount(k,E),P=(D-L)*8;for(A.getLengthInBits()+4<=P&&A.put(0,4);A.getLengthInBits()%8!==0;)A.putBit(0);const j=(P-A.getLengthInBits())/8;for(let G=0;G<j;G++)A.put(G%2?17:236,8);return C(A,k,E)}function C(k,E,I){const A=n.getSymbolTotalCodewords(E),D=l.getTotalCodewordsCount(E,I),L=A-D,P=l.getBlocksCount(E,I),j=A%P,G=P-j,Q=Math.floor(A/P),q=Math.floor(L/P),te=q+1,Z=Q-q,ne=new c(Z);let le=0;const H=new Array(P),R=new Array(P);let B=0;const W=new Uint8Array(k.buffer);for(let Se=0;Se<P;Se++){const Me=Se<G?q:te;H[Se]=W.slice(le,le+Me),R[Se]=ne.encode(H[Se]),le+=Me,B=Math.max(B,Me)}const se=new Uint8Array(A);let ue=0,ge,Ce;for(ge=0;ge<B;ge++)for(Ce=0;Ce<P;Ce++)ge<H[Ce].length&&(se[ue++]=H[Ce][ge]);for(ge=0;ge<Z;ge++)for(Ce=0;Ce<P;Ce++)se[ue++]=R[Ce][ge];return se}function M(k,E,I,A){let D;if(Array.isArray(k))D=h.fromArray(k);else if(typeof k=="string"){let Q=E;if(!Q){const q=h.rawSplit(k);Q=u.getBestVersionForData(q,I)}D=h.fromString(k,Q||40)}else throw new Error("Invalid data");const L=u.getBestVersionForData(D,I);if(!L)throw new Error("The amount of data is too big to be stored in a QR Code");if(!E)E=L;else if(E<L)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+L+`.
`);const P=S(E,I,D),j=n.getSymbolSize(E),G=new s(j);return p(G,E),g(G),b(G,E),w(G,I,0),E>=7&&v(G,E),x(G,P),isNaN(A)&&(A=o.getBestMask(G,w.bind(null,G,I))),o.applyMask(A,G),w(G,I,A),{modules:G,version:E,errorCorrectionLevel:I,maskPattern:A,segments:D}}return U$.create=function(E,I){if(typeof E>"u"||E==="")throw new Error("No input text");let A=e.M,D,L;return typeof I<"u"&&(A=e.from(I.errorCorrectionLevel,e.M),D=u.from(I.version),L=o.from(I.maskPattern),I.toSJISFunc&&n.setToSJISFunction(I.toSJISFunc)),M(E,D,A,L)},U$}var oj={},lj={},qQ;function _me(){return qQ||(qQ=1,(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let s=t.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+t);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(a){return[a,a]}))),s.length===6&&s.push("F","F");const r=parseInt(s.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+s.slice(0,6).join("")}}n.getOptions=function(s){s||(s={}),s.color||(s.color={});const r=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,a=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:a,scale:a?4:o,margin:r,color:{dark:e(s.color.dark||"#000000ff"),light:e(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},n.getScale=function(s,r){return r.width&&r.width>=s+r.margin*2?r.width/(s+r.margin*2):r.scale},n.getImageWidth=function(s,r){const a=n.getScale(s,r);return Math.floor((s+r.margin*2)*a)},n.qrToImageData=function(s,r,a){const o=r.modules.size,l=r.modules.data,c=n.getScale(o,a),u=Math.floor((o+a.margin*2)*c),f=a.margin*c,d=[a.color.light,a.color.dark];for(let h=0;h<u;h++)for(let p=0;p<u;p++){let g=(h*u+p)*4,b=a.color.light;if(h>=f&&p>=f&&h<u-f&&p<u-f){const v=Math.floor((h-f)/c),w=Math.floor((p-f)/c);b=d[l[v*o+w]?1:0]}s[g++]=b.r,s[g++]=b.g,s[g++]=b.b,s[g]=b.a}}})(lj)),lj}var YQ;function Srt(){return YQ||(YQ=1,(function(n){const e=_me();function t(r,a,o){r.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=o,a.width=o,a.style.height=o+"px",a.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(a,o,l){let c=l,u=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(u=s()),c=e.getOptions(c);const f=e.getImageWidth(a.modules.size,c),d=u.getContext("2d"),h=d.createImageData(f,f);return e.qrToImageData(h.data,a,c),t(d,u,f),d.putImageData(h,0,0),u},n.renderToDataURL=function(a,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const u=n.render(a,o,c),f=c.type||"image/png",d=c.rendererOpts||{};return u.toDataURL(f,d.quality)}})(oj)),oj}var cj={},KQ;function Mrt(){if(KQ)return cj;KQ=1;const n=_me();function e(r,a){const o=r.a/255,l=a+'="'+r.hex+'"';return o<1?l+" "+a+'-opacity="'+o.toFixed(2).slice(1)+'"':l}function t(r,a,o){let l=r+a;return typeof o<"u"&&(l+=" "+o),l}function s(r,a,o){let l="",c=0,u=!1,f=0;for(let d=0;d<r.length;d++){const h=Math.floor(d%a),p=Math.floor(d/a);!h&&!u&&(u=!0),r[d]?(f++,d>0&&h>0&&r[d-1]||(l+=u?t("M",h+o,.5+p+o):t("m",c,0),c=0,u=!1),h+1<a&&r[d+1]||(l+=t("h",f),f=0)):c++}return l}return cj.render=function(a,o,l){const c=n.getOptions(o),u=a.modules.size,f=a.modules.data,d=u+c.margin*2,h=c.color.light.a?"<path "+e(c.color.light,"fill")+' d="M0 0h'+d+"v"+d+'H0z"/>':"",p="<path "+e(c.color.dark,"stroke")+' d="'+s(f,u,c.margin)+'"/>',g='viewBox="0 0 '+d+" "+d+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+g+' shape-rendering="crispEdges">'+h+p+`</svg>
`;return typeof l=="function"&&l(null,v),v},cj}var XQ;function Trt(){if(XQ)return wv;XQ=1;const n=art(),e=Crt(),t=Srt(),s=Mrt();function r(a,o,l,c,u){const f=[].slice.call(arguments,1),d=f.length,h=typeof f[d-1]=="function";if(!h&&!n())throw new Error("Callback required as last argument");if(h){if(d<2)throw new Error("Too few arguments provided");d===2?(u=l,l=o,o=c=void 0):d===3&&(o.getContext&&typeof u>"u"?(u=c,c=void 0):(u=c,c=l,l=o,o=void 0))}else{if(d<1)throw new Error("Too few arguments provided");return d===1?(l=o,o=c=void 0):d===2&&!o.getContext&&(c=l,l=o,o=void 0),new Promise(function(p,g){try{const b=e.create(l,c);p(a(b,o,c))}catch(b){g(b)}})}try{const p=e.create(l,c);u(null,a(p,o,c))}catch(p){u(p)}}return wv.create=e.create,wv.toCanvas=r.bind(null,t.render),wv.toDataURL=r.bind(null,t.renderToDataURL),wv.toString=r.bind(null,function(a,o,l){return s.render(a,l)}),wv}var krt=Trt();const Ert=k2(krt);var rA={},lS={},iA={},QQ;function Ed(){if(QQ)return iA;QQ=1,Object.defineProperty(iA,"__esModule",{value:!0});function n(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var e=function t(s,r){n(this,t),this.data=s,this.text=r.text||s,this.options=r};return iA.default=e,iA}var JQ;function Irt(){if(JQ)return lS;JQ=1,Object.defineProperty(lS,"__esModule",{value:!0}),lS.CODE39=void 0;var n=(function(){function b(v,w){for(var x=0;x<w.length;x++){var S=w[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}return function(v,w,x){return w&&b(v.prototype,w),x&&b(v,x),v}})(),e=Ed(),t=s(e);function s(b){return b&&b.__esModule?b:{default:b}}function r(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}function a(b,v){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:b}function o(b,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);b.prototype=Object.create(v&&v.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(b,v):b.__proto__=v)}var l=(function(b){o(v,b);function v(w,x){return r(this,v),w=w.toUpperCase(),x.mod43&&(w+=h(g(w))),a(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,w,x))}return n(v,[{key:"encode",value:function(){for(var x=f("*"),S=0;S<this.data.length;S++)x+=f(this.data[S])+"0";return x+=f("*"),{data:x,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),v})(t.default),c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],u=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function f(b){return d(p(b))}function d(b){return u[b].toString(2)}function h(b){return c[b]}function p(b){return c.indexOf(b)}function g(b){for(var v=0,w=0;w<b.length;w++)v+=p(b[w]);return v=v%43,v}return lS.CODE39=l,lS}var Yh={},aA={},oA={},Ao={},ZQ;function pE(){if(ZQ)return Ao;ZQ=1,Object.defineProperty(Ao,"__esModule",{value:!0});var n;function e(c,u,f){return u in c?Object.defineProperty(c,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[u]=f,c}var t=Ao.SET_A=0,s=Ao.SET_B=1,r=Ao.SET_C=2;Ao.SHIFT=98;var a=Ao.START_A=103,o=Ao.START_B=104,l=Ao.START_C=105;return Ao.MODULO=103,Ao.STOP=106,Ao.FNC1=207,Ao.SET_BY_CODE=(n={},e(n,a,t),e(n,o,s),e(n,l,r),n),Ao.SWAP={101:t,100:s,99:r},Ao.A_START_CHAR="",Ao.B_START_CHAR="",Ao.C_START_CHAR="",Ao.A_CHARS="[\0-_-]",Ao.B_CHARS="[ --]",Ao.C_CHARS="(*[0-9]{2}*)",Ao.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],Ao}var eJ;function cP(){if(eJ)return oA;eJ=1,Object.defineProperty(oA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=Ed(),t=r(e),s=pE();function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(d,h){a(this,f);var p=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,d.substring(1),h));return p.bytes=d.split("").map(function(g){return g.charCodeAt(0)}),p}return n(f,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var h=this.bytes,p=h.shift()-105,g=s.SET_BY_CODE[p];if(g===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&h.unshift(s.FNC1);var b=f.next(h,1,g);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:f.getBar(p)+b.result+f.getBar((b.checksum+p)%s.MODULO)+f.getBar(s.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var h=this.options.ean128||!1;return typeof h=="string"&&(h=h.toLowerCase()==="true"),h}}],[{key:"getBar",value:function(h){return s.BARS[h]?s.BARS[h].toString():""}},{key:"correctIndex",value:function(h,p){if(p===s.SET_A){var g=h.shift();return g<32?g+64:g-32}else return p===s.SET_B?h.shift()-32:(h.shift()-48)*10+h.shift()-48}},{key:"next",value:function(h,p,g){if(!h.length)return{result:"",checksum:0};var b=void 0,v=void 0;if(h[0]>=200){v=h.shift()-105;var w=s.SWAP[v];w!==void 0?b=f.next(h,p+1,w):((g===s.SET_A||g===s.SET_B)&&v===s.SHIFT&&(h[0]=g===s.SET_A?h[0]>95?h[0]-96:h[0]:h[0]<32?h[0]+96:h[0]),b=f.next(h,p+1,g))}else v=f.correctIndex(h,g),b=f.next(h,p+1,g);var x=f.getBar(v),S=v*p;return{result:x+b.result,checksum:S+b.checksum}}}]),f})(t.default);return oA.default=c,oA}var lA={},tJ;function Art(){if(tJ)return lA;tJ=1,Object.defineProperty(lA,"__esModule",{value:!0});var n=pE(),e=function(l){return l.match(new RegExp("^"+n.A_CHARS+"*"))[0].length},t=function(l){return l.match(new RegExp("^"+n.B_CHARS+"*"))[0].length},s=function(l){return l.match(new RegExp("^"+n.C_CHARS+"*"))[0]};function r(o,l){var c=l?n.A_CHARS:n.B_CHARS,u=o.match(new RegExp("^("+c+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(u)return u[1]+""+a(o.substring(u[1].length));var f=o.match(new RegExp("^"+c+"+"))[0];return f.length===o.length?o:f+String.fromCharCode(l?205:206)+r(o.substring(f.length),!l)}function a(o){var l=s(o),c=l.length;if(c===o.length)return o;o=o.substring(c);var u=e(o)>=t(o);return l+String.fromCharCode(u?206:205)+r(o,u)}return lA.default=function(o){var l=void 0,c=s(o).length;if(c>=2)l=n.C_START_CHAR+a(o);else{var u=e(o)>t(o);l=(u?n.A_START_CHAR:n.B_START_CHAR)+r(o,u)}return l.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(f,d){return""+d})},lA}var nJ;function Lrt(){if(nJ)return aA;nJ=1,Object.defineProperty(aA,"__esModule",{value:!0});var n=cP(),e=r(n),t=Art(),s=r(t);function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(d,h){if(a(this,f),/^[\x00-\x7F\xC8-\xD3]+$/.test(d))var p=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,(0,s.default)(d),h));else var p=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,d,h));return o(p)}return f})(e.default);return aA.default=c,aA}var cA={},sJ;function Nrt(){if(sJ)return cA;sJ=1,Object.defineProperty(cA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=cP(),t=r(e),s=pE();function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(d,h){return a(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,s.A_START_CHAR+d,h))}return n(f,[{key:"valid",value:function(){return new RegExp("^"+s.A_CHARS+"+$").test(this.data)}}]),f})(t.default);return cA.default=c,cA}var uA={},rJ;function Drt(){if(rJ)return uA;rJ=1,Object.defineProperty(uA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=cP(),t=r(e),s=pE();function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(d,h){return a(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,s.B_START_CHAR+d,h))}return n(f,[{key:"valid",value:function(){return new RegExp("^"+s.B_CHARS+"+$").test(this.data)}}]),f})(t.default);return uA.default=c,uA}var fA={},iJ;function Ort(){if(iJ)return fA;iJ=1,Object.defineProperty(fA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=cP(),t=r(e),s=pE();function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(d,h){return a(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,s.C_START_CHAR+d,h))}return n(f,[{key:"valid",value:function(){return new RegExp("^"+s.C_CHARS+"+$").test(this.data)}}]),f})(t.default);return fA.default=c,fA}var aJ;function Prt(){if(aJ)return Yh;aJ=1,Object.defineProperty(Yh,"__esModule",{value:!0}),Yh.CODE128C=Yh.CODE128B=Yh.CODE128A=Yh.CODE128=void 0;var n=Lrt(),e=c(n),t=Nrt(),s=c(t),r=Drt(),a=c(r),o=Ort(),l=c(o);function c(u){return u&&u.__esModule?u:{default:u}}return Yh.CODE128=e.default,Yh.CODE128A=s.default,Yh.CODE128B=a.default,Yh.CODE128C=l.default,Yh}var Du={},dA={},hg={},oJ;function mE(){return oJ||(oJ=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.SIDE_BIN="101",hg.MIDDLE_BIN="01010",hg.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},hg.EAN2_STRUCTURE=["LL","LG","GL","GG"],hg.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],hg.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]),hg}var hA={},pA={},lJ;function gE(){if(lJ)return pA;lJ=1,Object.defineProperty(pA,"__esModule",{value:!0});var n=mE(),e=function(s,r,a){var o=s.split("").map(function(c,u){return n.BINARIES[r[u]]}).map(function(c,u){return c?c[s[u]]:""});if(a){var l=s.length-1;o=o.map(function(c,u){return u<l?c+a:c})}return o.join("")};return pA.default=e,pA}var cJ;function xme(){if(cJ)return hA;cJ=1,Object.defineProperty(hA,"__esModule",{value:!0});var n=(function(){function d(h,p){for(var g=0;g<p.length;g++){var b=p[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,p,g){return p&&d(h.prototype,p),g&&d(h,g),h}})(),e=mE(),t=gE(),s=o(t),r=Ed(),a=o(r);function o(d){return d&&d.__esModule?d:{default:d}}function l(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function c(d,h){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:d}function u(d,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);d.prototype=Object.create(h&&h.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(d,h):d.__proto__=h)}var f=(function(d){u(h,d);function h(p,g){l(this,h);var b=c(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,p,g));return b.fontSize=!g.flat&&g.fontSize>g.width*10?g.width*10:g.fontSize,b.guardHeight=g.height+b.fontSize/2+g.textMargin,b}return n(h,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(g,b){return this.text.substr(g,b)}},{key:"leftEncode",value:function(g,b){return(0,s.default)(g,b)}},{key:"rightText",value:function(g,b){return this.text.substr(g,b)}},{key:"rightEncode",value:function(g,b){return(0,s.default)(g,b)}},{key:"encodeGuarded",value:function(){var g={fontSize:this.fontSize},b={height:this.guardHeight};return[{data:e.SIDE_BIN,options:b},{data:this.leftEncode(),text:this.leftText(),options:g},{data:e.MIDDLE_BIN,options:b},{data:this.rightEncode(),text:this.rightText(),options:g},{data:e.SIDE_BIN,options:b}]}},{key:"encodeFlat",value:function(){var g=[e.SIDE_BIN,this.leftEncode(),e.MIDDLE_BIN,this.rightEncode(),e.SIDE_BIN];return{data:g.join(""),text:this.text}}}]),h})(a.default);return hA.default=f,hA}var uJ;function $rt(){if(uJ)return dA;uJ=1,Object.defineProperty(dA,"__esModule",{value:!0});var n=(function(){function d(h,p){for(var g=0;g<p.length;g++){var b=p[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,p,g){return p&&d(h.prototype,p),g&&d(h,g),h}})(),e=function d(h,p,g){h===null&&(h=Function.prototype);var b=Object.getOwnPropertyDescriptor(h,p);if(b===void 0){var v=Object.getPrototypeOf(h);return v===null?void 0:d(v,p,g)}else{if("value"in b)return b.value;var w=b.get;return w===void 0?void 0:w.call(g)}},t=mE(),s=xme(),r=a(s);function a(d){return d&&d.__esModule?d:{default:d}}function o(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function l(d,h){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:d}function c(d,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);d.prototype=Object.create(h&&h.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(d,h):d.__proto__=h)}var u=function(h){var p=h.substr(0,12).split("").map(function(g){return+g}).reduce(function(g,b,v){return v%2?g+b*3:g+b},0);return(10-p%10)%10},f=(function(d){c(h,d);function h(p,g){o(this,h),p.search(/^[0-9]{12}$/)!==-1&&(p+=u(p));var b=l(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,p,g));return b.lastChar=g.lastChar,b}return n(h,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===u(this.data)}},{key:"leftText",value:function(){return e(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var g=this.data.substr(1,6),b=t.EAN13_STRUCTURE[this.data[0]];return e(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"leftEncode",this).call(this,g,b)}},{key:"rightText",value:function(){return e(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var g=this.data.substr(7,6);return e(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"rightEncode",this).call(this,g,"RRRRRR")}},{key:"encodeGuarded",value:function(){var g=e(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(g.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(g.push({data:"00"}),g.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),g}}]),h})(r.default);return dA.default=f,dA}var mA={},fJ;function jrt(){if(fJ)return mA;fJ=1,Object.defineProperty(mA,"__esModule",{value:!0});var n=(function(){function f(d,h){for(var p=0;p<h.length;p++){var g=h[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}return function(d,h,p){return h&&f(d.prototype,h),p&&f(d,p),d}})(),e=function f(d,h,p){d===null&&(d=Function.prototype);var g=Object.getOwnPropertyDescriptor(d,h);if(g===void 0){var b=Object.getPrototypeOf(d);return b===null?void 0:f(b,h,p)}else{if("value"in g)return g.value;var v=g.get;return v===void 0?void 0:v.call(p)}},t=xme(),s=r(t);function r(f){return f&&f.__esModule?f:{default:f}}function a(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function o(f,d){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:f}function l(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(f,d):f.__proto__=d)}var c=function(d){var h=d.substr(0,7).split("").map(function(p){return+p}).reduce(function(p,g,b){return b%2?p+g:p+g*3},0);return(10-h%10)%10},u=(function(f){l(d,f);function d(h,p){return a(this,d),h.search(/^[0-9]{7}$/)!==-1&&(h+=c(h)),o(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,h,p))}return n(d,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===c(this.data)}},{key:"leftText",value:function(){return e(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var p=this.data.substr(0,4);return e(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"leftEncode",this).call(this,p,"LLLL")}},{key:"rightText",value:function(){return e(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var p=this.data.substr(4,4);return e(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"rightEncode",this).call(this,p,"RRRR")}}]),d})(s.default);return mA.default=u,mA}var gA={},dJ;function Rrt(){if(dJ)return gA;dJ=1,Object.defineProperty(gA,"__esModule",{value:!0});var n=(function(){function h(p,g){for(var b=0;b<g.length;b++){var v=g[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,v.key,v)}}return function(p,g,b){return g&&h(p.prototype,g),b&&h(p,b),p}})(),e=mE(),t=gE(),s=o(t),r=Ed(),a=o(r);function o(h){return h&&h.__esModule?h:{default:h}}function l(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")}function c(h,p){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:h}function u(h,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);h.prototype=Object.create(p&&p.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(h,p):h.__proto__=p)}var f=function(p){var g=p.split("").map(function(b){return+b}).reduce(function(b,v,w){return w%2?b+v*9:b+v*3},0);return g%10},d=(function(h){u(p,h);function p(g,b){return l(this,p),c(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,g,b))}return n(p,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var b=e.EAN5_STRUCTURE[f(this.data)];return{data:"1011"+(0,s.default)(this.data,b,"01"),text:this.text}}}]),p})(a.default);return gA.default=d,gA}var yA={},hJ;function Frt(){if(hJ)return yA;hJ=1,Object.defineProperty(yA,"__esModule",{value:!0});var n=(function(){function d(h,p){for(var g=0;g<p.length;g++){var b=p[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,p,g){return p&&d(h.prototype,p),g&&d(h,g),h}})(),e=mE(),t=gE(),s=o(t),r=Ed(),a=o(r);function o(d){return d&&d.__esModule?d:{default:d}}function l(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function c(d,h){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:d}function u(d,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);d.prototype=Object.create(h&&h.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(d,h):d.__proto__=h)}var f=(function(d){u(h,d);function h(p,g){return l(this,h),c(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,p,g))}return n(h,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var g=e.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,s.default)(this.data,g,"01"),text:this.text}}}]),h})(a.default);return yA.default=f,yA}var cS={},pJ;function Cme(){if(pJ)return cS;pJ=1,Object.defineProperty(cS,"__esModule",{value:!0});var n=(function(){function d(h,p){for(var g=0;g<p.length;g++){var b=p[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,p,g){return p&&d(h.prototype,p),g&&d(h,g),h}})();cS.checksum=f;var e=gE(),t=a(e),s=Ed(),r=a(s);function a(d){return d&&d.__esModule?d:{default:d}}function o(d,h){if(!(d instanceof h))throw new TypeError("Cannot call a class as a function")}function l(d,h){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:d}function c(d,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);d.prototype=Object.create(h&&h.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(d,h):d.__proto__=h)}var u=(function(d){c(h,d);function h(p,g){o(this,h),p.search(/^[0-9]{11}$/)!==-1&&(p+=f(p));var b=l(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,p,g));return b.displayValue=g.displayValue,g.fontSize>g.width*10?b.fontSize=g.width*10:b.fontSize=g.fontSize,b.guardHeight=g.height+b.fontSize/2+g.textMargin,b}return n(h,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==f(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var g="";return g+="101",g+=(0,t.default)(this.data.substr(0,6),"LLLLLL"),g+="01010",g+=(0,t.default)(this.data.substr(6,6),"RRRRRR"),g+="101",{data:g,text:this.text}}},{key:"guardedEncoding",value:function(){var g=[];return this.displayValue&&g.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),g.push({data:"101"+(0,t.default)(this.data[0],"L"),options:{height:this.guardHeight}}),g.push({data:(0,t.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),g.push({data:"01010",options:{height:this.guardHeight}}),g.push({data:(0,t.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),g.push({data:(0,t.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&g.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),g}}]),h})(r.default);function f(d){var h=0,p;for(p=1;p<11;p+=2)h+=parseInt(d[p]);for(p=0;p<11;p+=2)h+=parseInt(d[p])*3;return(10-h%10)%10}return cS.default=u,cS}var bA={},mJ;function zrt(){if(mJ)return bA;mJ=1,Object.defineProperty(bA,"__esModule",{value:!0});var n=(function(){function g(b,v){for(var w=0;w<v.length;w++){var x=v[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}return function(b,v,w){return v&&g(b.prototype,v),w&&g(b,w),b}})(),e=gE(),t=o(e),s=Ed(),r=o(s),a=Cme();function o(g){return g&&g.__esModule?g:{default:g}}function l(g,b){if(!(g instanceof b))throw new TypeError("Cannot call a class as a function")}function c(g,b){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:g}function u(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);g.prototype=Object.create(b&&b.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(g,b):g.__proto__=b)}var f=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],d=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],h=(function(g){u(b,g);function b(v,w){l(this,b);var x=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,v,w));if(x.isValid=!1,v.search(/^[0-9]{6}$/)!==-1)x.middleDigits=v,x.upcA=p(v,"0"),x.text=w.text||""+x.upcA[0]+v+x.upcA[x.upcA.length-1],x.isValid=!0;else if(v.search(/^[01][0-9]{7}$/)!==-1)if(x.middleDigits=v.substring(1,v.length-1),x.upcA=p(x.middleDigits,v[0]),x.upcA[x.upcA.length-1]===v[v.length-1])x.isValid=!0;else return c(x);else return c(x);return x.displayValue=w.displayValue,w.fontSize>w.width*10?x.fontSize=w.width*10:x.fontSize=w.fontSize,x.guardHeight=w.height+x.fontSize/2+w.textMargin,x}return n(b,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var w="";return w+="101",w+=this.encodeMiddleDigits(),w+="010101",{data:w,text:this.text}}},{key:"guardedEncoding",value:function(){var w=[];return this.displayValue&&w.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),w.push({data:"101",options:{height:this.guardHeight}}),w.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),w.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&w.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),w}},{key:"encodeMiddleDigits",value:function(){var w=this.upcA[0],x=this.upcA[this.upcA.length-1],S=d[parseInt(x)][parseInt(w)];return(0,t.default)(this.middleDigits,S)}}]),b})(r.default);function p(g,b){for(var v=parseInt(g[g.length-1]),w=f[v],x="",S=0,C=0;C<w.length;C++){var M=w[C];M==="X"?x+=g[S++]:x+=M}return x=""+b+x,""+x+(0,a.checksum)(x)}return bA.default=h,bA}var gJ;function Brt(){if(gJ)return Du;gJ=1,Object.defineProperty(Du,"__esModule",{value:!0}),Du.UPCE=Du.UPC=Du.EAN2=Du.EAN5=Du.EAN8=Du.EAN13=void 0;var n=$rt(),e=h(n),t=jrt(),s=h(t),r=Rrt(),a=h(r),o=Frt(),l=h(o),c=Cme(),u=h(c),f=zrt(),d=h(f);function h(p){return p&&p.__esModule?p:{default:p}}return Du.EAN13=e.default,Du.EAN8=s.default,Du.EAN5=a.default,Du.EAN2=l.default,Du.UPC=u.default,Du.UPCE=d.default,Du}var _y={},wA={},vv={},yJ;function Urt(){return yJ||(yJ=1,Object.defineProperty(vv,"__esModule",{value:!0}),vv.START_BIN="1010",vv.END_BIN="11101",vv.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]),vv}var bJ;function Sme(){if(bJ)return wA;bJ=1,Object.defineProperty(wA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=Urt(),t=Ed(),s=r(t);function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(){return a(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return n(f,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var h=this,p=this.data.match(/.{2}/g).map(function(g){return h.encodePair(g)}).join("");return{data:e.START_BIN+p+e.END_BIN,text:this.text}}},{key:"encodePair",value:function(h){var p=e.BINARIES[h[1]];return e.BINARIES[h[0]].split("").map(function(g,b){return(g==="1"?"111":"1")+(p[b]==="1"?"000":"0")}).join("")}}]),f})(s.default);return wA.default=c,wA}var vA={},wJ;function Vrt(){if(wJ)return vA;wJ=1,Object.defineProperty(vA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=Sme(),t=s(e);function s(u){return u&&u.__esModule?u:{default:u}}function r(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function a(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function o(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var l=function(f){var d=f.substr(0,13).split("").map(function(h){return parseInt(h,10)}).reduce(function(h,p,g){return h+p*(3-g%2*2)},0);return Math.ceil(d/10)*10-d},c=(function(u){o(f,u);function f(d,h){return r(this,f),d.search(/^[0-9]{13}$/)!==-1&&(d+=l(d)),a(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,d,h))}return n(f,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===l(this.data)}}]),f})(t.default);return vA.default=c,vA}var vJ;function Wrt(){if(vJ)return _y;vJ=1,Object.defineProperty(_y,"__esModule",{value:!0}),_y.ITF14=_y.ITF=void 0;var n=Sme(),e=r(n),t=Vrt(),s=r(t);function r(a){return a&&a.__esModule?a:{default:a}}return _y.ITF=e.default,_y.ITF14=s.default,_y}var rd={},_A={},_J;function yE(){if(_J)return _A;_J=1,Object.defineProperty(_A,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=Ed(),t=s(e);function s(u){return u&&u.__esModule?u:{default:u}}function r(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function a(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function o(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var l=(function(u){o(f,u);function f(d,h){return r(this,f),a(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,d,h))}return n(f,[{key:"encode",value:function(){for(var h="110",p=0;p<this.data.length;p++){var g=parseInt(this.data[p]),b=g.toString(2);b=c(b,4-b.length);for(var v=0;v<b.length;v++)h+=b[v]=="0"?"100":"110"}return h+="1001",{data:h,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),f})(t.default);function c(u,f){for(var d=0;d<f;d++)u="0"+u;return u}return _A.default=l,_A}var xA={},uS={},xJ;function uP(){if(xJ)return uS;xJ=1,Object.defineProperty(uS,"__esModule",{value:!0}),uS.mod10=n,uS.mod11=e;function n(t){for(var s=0,r=0;r<t.length;r++){var a=parseInt(t[r]);(r+t.length)%2===0?s+=a:s+=a*2%10+Math.floor(a*2/10)}return(10-s%10)%10}function e(t){for(var s=0,r=[2,3,4,5,6,7],a=0;a<t.length;a++){var o=parseInt(t[t.length-1-a]);s+=r[a%r.length]*o}return(11-s%11)%11}return uS}var CJ;function Grt(){if(CJ)return xA;CJ=1,Object.defineProperty(xA,"__esModule",{value:!0});var n=yE(),e=s(n),t=uP();function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){return r(this,u),a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f+(0,t.mod10)(f),d))}return u})(e.default);return xA.default=l,xA}var CA={},SJ;function Hrt(){if(SJ)return CA;SJ=1,Object.defineProperty(CA,"__esModule",{value:!0});var n=yE(),e=s(n),t=uP();function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){return r(this,u),a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f+(0,t.mod11)(f),d))}return u})(e.default);return CA.default=l,CA}var SA={},MJ;function qrt(){if(MJ)return SA;MJ=1,Object.defineProperty(SA,"__esModule",{value:!0});var n=yE(),e=s(n),t=uP();function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){return r(this,u),f+=(0,t.mod10)(f),f+=(0,t.mod10)(f),a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f,d))}return u})(e.default);return SA.default=l,SA}var MA={},TJ;function Yrt(){if(TJ)return MA;TJ=1,Object.defineProperty(MA,"__esModule",{value:!0});var n=yE(),e=s(n),t=uP();function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){return r(this,u),f+=(0,t.mod11)(f),f+=(0,t.mod10)(f),a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f,d))}return u})(e.default);return MA.default=l,MA}var kJ;function Krt(){if(kJ)return rd;kJ=1,Object.defineProperty(rd,"__esModule",{value:!0}),rd.MSI1110=rd.MSI1010=rd.MSI11=rd.MSI10=rd.MSI=void 0;var n=yE(),e=f(n),t=Grt(),s=f(t),r=Hrt(),a=f(r),o=qrt(),l=f(o),c=Yrt(),u=f(c);function f(d){return d&&d.__esModule?d:{default:d}}return rd.MSI=e.default,rd.MSI10=s.default,rd.MSI11=a.default,rd.MSI1010=l.default,rd.MSI1110=u.default,rd}var fS={},EJ;function Xrt(){if(EJ)return fS;EJ=1,Object.defineProperty(fS,"__esModule",{value:!0}),fS.pharmacode=void 0;var n=(function(){function c(u,f){for(var d=0;d<f.length;d++){var h=f[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}})(),e=Ed(),t=s(e);function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){r(this,u);var h=a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f,d));return h.number=parseInt(f,10),h}return n(u,[{key:"encode",value:function(){for(var d=this.number,h="";!isNaN(d)&&d!=0;)d%2===0?(h="11100"+h,d=(d-2)/2):(h="100"+h,d=(d-1)/2);return h=h.slice(0,-2),{data:h,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),u})(t.default);return fS.pharmacode=l,fS}var dS={},IJ;function Qrt(){if(IJ)return dS;IJ=1,Object.defineProperty(dS,"__esModule",{value:!0}),dS.codabar=void 0;var n=(function(){function c(u,f){for(var d=0;d<f.length;d++){var h=f[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}})(),e=Ed(),t=s(e);function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){r(this,u),f.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(f="A"+f+"A");var h=a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f.toUpperCase(),d));return h.text=h.options.text||h.text.replace(/[A-D]/g,""),h}return n(u,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var d=[],h=this.getEncodings(),p=0;p<this.data.length;p++)d.push(h[this.data.charAt(p)]),p!==this.data.length-1&&d.push("0");return{text:this.text,data:d.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),u})(t.default);return dS.codabar=l,dS}var xy={},TA={},_v={},AJ;function Jrt(){return AJ||(AJ=1,Object.defineProperty(_v,"__esModule",{value:!0}),_v.SYMBOLS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","($)","(%)","(/)","(+)",""],_v.BINARIES=["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"],_v.MULTI_SYMBOLS={"\0":["(%)","U"],"":["($)","A"],"":["($)","B"],"":["($)","C"],"":["($)","D"],"":["($)","E"],"":["($)","F"],"\x07":["($)","G"],"\b":["($)","H"],"	":["($)","I"],"\n":["($)","J"],"\v":["($)","K"],"\f":["($)","L"],"\r":["($)","M"],"":["($)","N"],"":["($)","O"],"":["($)","P"],"":["($)","Q"],"":["($)","R"],"":["($)","S"],"":["($)","T"],"":["($)","U"],"":["($)","V"],"":["($)","W"],"":["($)","X"],"":["($)","Y"],"":["($)","Z"],"\x1B":["(%)","A"],"":["(%)","B"],"":["(%)","C"],"":["(%)","D"],"":["(%)","E"],"!":["(/)","A"],'"':["(/)","B"],"#":["(/)","C"],"&":["(/)","F"],"'":["(/)","G"],"(":["(/)","H"],")":["(/)","I"],"*":["(/)","J"],",":["(/)","L"],":":["(/)","Z"],";":["(%)","F"],"<":["(%)","G"],"=":["(%)","H"],">":["(%)","I"],"?":["(%)","J"],"@":["(%)","V"],"[":["(%)","K"],"\\":["(%)","L"],"]":["(%)","M"],"^":["(%)","N"],_:["(%)","O"],"`":["(%)","W"],a:["(+)","A"],b:["(+)","B"],c:["(+)","C"],d:["(+)","D"],e:["(+)","E"],f:["(+)","F"],g:["(+)","G"],h:["(+)","H"],i:["(+)","I"],j:["(+)","J"],k:["(+)","K"],l:["(+)","L"],m:["(+)","M"],n:["(+)","N"],o:["(+)","O"],p:["(+)","P"],q:["(+)","Q"],r:["(+)","R"],s:["(+)","S"],t:["(+)","T"],u:["(+)","U"],v:["(+)","V"],w:["(+)","W"],x:["(+)","X"],y:["(+)","Y"],z:["(+)","Z"],"{":["(%)","P"],"|":["(%)","Q"],"}":["(%)","R"],"~":["(%)","S"],"":["(%)","T"]}),_v}var LJ;function Mme(){if(LJ)return TA;LJ=1,Object.defineProperty(TA,"__esModule",{value:!0});var n=(function(){function u(f,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}return function(f,d,h){return d&&u(f.prototype,d),h&&u(f,h),f}})(),e=Jrt(),t=Ed(),s=r(t);function r(u){return u&&u.__esModule?u:{default:u}}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function o(u,f){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:u}function l(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(u,f):u.__proto__=f)}var c=(function(u){l(f,u);function f(d,h){return a(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,d,h))}return n(f,[{key:"valid",value:function(){return/^[0-9A-Z\-. $/+%]+$/.test(this.data)}},{key:"encode",value:function(){var h=this.data.split("").flatMap(function(v){return e.MULTI_SYMBOLS[v]||v}),p=h.map(function(v){return f.getEncoding(v)}).join(""),g=f.checksum(h,20),b=f.checksum(h.concat(g),15);return{text:this.text,data:f.getEncoding("")+p+f.getEncoding(g)+f.getEncoding(b)+f.getEncoding("")+"1"}}}],[{key:"getEncoding",value:function(h){return e.BINARIES[f.symbolValue(h)]}},{key:"getSymbol",value:function(h){return e.SYMBOLS[h]}},{key:"symbolValue",value:function(h){return e.SYMBOLS.indexOf(h)}},{key:"checksum",value:function(h,p){var g=h.slice().reverse().reduce(function(b,v,w){var x=w%p+1;return b+f.symbolValue(v)*x},0);return f.getSymbol(g%47)}}]),f})(s.default);return TA.default=c,TA}var kA={},NJ;function Zrt(){if(NJ)return kA;NJ=1,Object.defineProperty(kA,"__esModule",{value:!0});var n=(function(){function c(u,f){for(var d=0;d<f.length;d++){var h=f[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}})(),e=Mme(),t=s(e);function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){return r(this,u),a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f,d))}return n(u,[{key:"valid",value:function(){return/^[\x00-\x7f]+$/.test(this.data)}}]),u})(t.default);return kA.default=l,kA}var DJ;function eit(){if(DJ)return xy;DJ=1,Object.defineProperty(xy,"__esModule",{value:!0}),xy.CODE93FullASCII=xy.CODE93=void 0;var n=Mme(),e=r(n),t=Zrt(),s=r(t);function r(a){return a&&a.__esModule?a:{default:a}}return xy.CODE93=e.default,xy.CODE93FullASCII=s.default,xy}var hS={},OJ;function tit(){if(OJ)return hS;OJ=1,Object.defineProperty(hS,"__esModule",{value:!0}),hS.GenericBarcode=void 0;var n=(function(){function c(u,f){for(var d=0;d<f.length;d++){var h=f[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}})(),e=Ed(),t=s(e);function s(c){return c&&c.__esModule?c:{default:c}}function r(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}function a(c,u){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:c}function o(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);c.prototype=Object.create(u&&u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(c,u):c.__proto__=u)}var l=(function(c){o(u,c);function u(f,d){return r(this,u),a(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,f,d))}return n(u,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),u})(t.default);return hS.GenericBarcode=l,hS}var PJ;function nit(){if(PJ)return rA;PJ=1,Object.defineProperty(rA,"__esModule",{value:!0});var n=Irt(),e=Prt(),t=Brt(),s=Wrt(),r=Krt(),a=Xrt(),o=Qrt(),l=eit(),c=tit();return rA.default={CODE39:n.CODE39,CODE128:e.CODE128,CODE128A:e.CODE128A,CODE128B:e.CODE128B,CODE128C:e.CODE128C,EAN13:t.EAN13,EAN8:t.EAN8,EAN5:t.EAN5,EAN2:t.EAN2,UPC:t.UPC,UPCE:t.UPCE,ITF14:s.ITF14,ITF:s.ITF,MSI:r.MSI,MSI10:r.MSI10,MSI11:r.MSI11,MSI1010:r.MSI1010,MSI1110:r.MSI1110,pharmacode:a.pharmacode,codabar:o.codabar,CODE93:l.CODE93,CODE93FullASCII:l.CODE93FullASCII,GenericBarcode:c.GenericBarcode},rA}var EA={},$J;function fP(){if($J)return EA;$J=1,Object.defineProperty(EA,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e};return EA.default=function(e,t){return n({},e,t)},EA}var IA={},jJ;function sit(){if(jJ)return IA;jJ=1,Object.defineProperty(IA,"__esModule",{value:!0}),IA.default=n;function n(e){var t=[];function s(r){if(Array.isArray(r))for(var a=0;a<r.length;a++)s(r[a]);else r.text=r.text||"",r.data=r.data||"",t.push(r)}return s(e),t}return IA}var AA={},RJ;function rit(){if(RJ)return AA;RJ=1,Object.defineProperty(AA,"__esModule",{value:!0}),AA.default=n;function n(e){return e.marginTop=e.marginTop||e.margin,e.marginBottom=e.marginBottom||e.margin,e.marginRight=e.marginRight||e.margin,e.marginLeft=e.marginLeft||e.margin,e}return AA}var LA={},NA={},DA={},FJ;function Tme(){if(FJ)return DA;FJ=1,Object.defineProperty(DA,"__esModule",{value:!0}),DA.default=n;function n(e){var t=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var s in t)t.hasOwnProperty(s)&&(s=t[s],typeof e[s]=="string"&&(e[s]=parseInt(e[s],10)));return typeof e.displayValue=="string"&&(e.displayValue=e.displayValue!="false"),e}return DA}var OA={},zJ;function kme(){if(zJ)return OA;zJ=1,Object.defineProperty(OA,"__esModule",{value:!0});var n={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};return OA.default=n,OA}var BJ;function iit(){if(BJ)return NA;BJ=1,Object.defineProperty(NA,"__esModule",{value:!0});var n=Tme(),e=r(n),t=kme(),s=r(t);function r(o){return o&&o.__esModule?o:{default:o}}function a(o){var l={};for(var c in s.default)s.default.hasOwnProperty(c)&&(o.hasAttribute("jsbarcode-"+c.toLowerCase())&&(l[c]=o.getAttribute("jsbarcode-"+c.toLowerCase())),o.hasAttribute("data-"+c.toLowerCase())&&(l[c]=o.getAttribute("data-"+c.toLowerCase())));return l.value=o.getAttribute("jsbarcode-value")||o.getAttribute("data-value"),l=(0,e.default)(l),l}return NA.default=a,NA}var PA={},$A={},id={},UJ;function Eme(){if(UJ)return id;UJ=1,Object.defineProperty(id,"__esModule",{value:!0}),id.getTotalWidthOfEncodings=id.calculateEncodingAttributes=id.getBarcodePadding=id.getEncodingHeight=id.getMaximumHeightOfEncodings=void 0;var n=fP(),e=t(n);function t(u){return u&&u.__esModule?u:{default:u}}function s(u,f){return f.height+(f.displayValue&&u.text.length>0?f.fontSize+f.textMargin:0)+f.marginTop+f.marginBottom}function r(u,f,d){if(d.displayValue&&f<u){if(d.textAlign=="center")return Math.floor((u-f)/2);if(d.textAlign=="left")return 0;if(d.textAlign=="right")return Math.floor(u-f)}return 0}function a(u,f,d){for(var h=0;h<u.length;h++){var p=u[h],g=(0,e.default)(f,p.options),b;g.displayValue?b=c(p.text,g,d):b=0;var v=p.data.length*g.width;p.width=Math.ceil(Math.max(b,v)),p.height=s(p,g),p.barcodePadding=r(b,v,g)}}function o(u){for(var f=0,d=0;d<u.length;d++)f+=u[d].width;return f}function l(u){for(var f=0,d=0;d<u.length;d++)u[d].height>f&&(f=u[d].height);return f}function c(u,f,d){var h;if(d)h=d;else if(typeof document<"u")h=document.createElement("canvas").getContext("2d");else return 0;h.font=f.fontOptions+" "+f.fontSize+"px "+f.font;var p=h.measureText(u);if(!p)return 0;var g=p.width;return g}return id.getMaximumHeightOfEncodings=l,id.getEncodingHeight=s,id.getBarcodePadding=r,id.calculateEncodingAttributes=a,id.getTotalWidthOfEncodings=o,id}var VJ;function ait(){if(VJ)return $A;VJ=1,Object.defineProperty($A,"__esModule",{value:!0});var n=(function(){function l(c,u){for(var f=0;f<u.length;f++){var d=u[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(c,u,f){return u&&l(c.prototype,u),f&&l(c,f),c}})(),e=fP(),t=r(e),s=Eme();function r(l){return l&&l.__esModule?l:{default:l}}function a(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=(function(){function l(c,u,f){a(this,l),this.canvas=c,this.encodings=u,this.options=f}return n(l,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var u=0;u<this.encodings.length;u++){var f=(0,t.default)(this.options,this.encodings[u].options);this.drawCanvasBarcode(f,this.encodings[u]),this.drawCanvasText(f,this.encodings[u]),this.moveCanvasDrawing(this.encodings[u])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var u=this.canvas.getContext("2d");u.save(),(0,s.calculateEncodingAttributes)(this.encodings,this.options,u);var f=(0,s.getTotalWidthOfEncodings)(this.encodings),d=(0,s.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=f+this.options.marginLeft+this.options.marginRight,this.canvas.height=d,u.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(u.fillStyle=this.options.background,u.fillRect(0,0,this.canvas.width,this.canvas.height)),u.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(u,f){var d=this.canvas.getContext("2d"),h=f.data,p;u.textPosition=="top"?p=u.marginTop+u.fontSize+u.textMargin:p=u.marginTop,d.fillStyle=u.lineColor;for(var g=0;g<h.length;g++){var b=g*u.width+f.barcodePadding;h[g]==="1"?d.fillRect(b,p,u.width,u.height):h[g]&&d.fillRect(b,p,u.width,u.height*h[g])}}},{key:"drawCanvasText",value:function(u,f){var d=this.canvas.getContext("2d"),h=u.fontOptions+" "+u.fontSize+"px "+u.font;if(u.displayValue){var p,g;u.textPosition=="top"?g=u.marginTop+u.fontSize-u.textMargin:g=u.height+u.textMargin+u.marginTop+u.fontSize,d.font=h,u.textAlign=="left"||f.barcodePadding>0?(p=0,d.textAlign="left"):u.textAlign=="right"?(p=f.width-1,d.textAlign="right"):(p=f.width/2,d.textAlign="center"),d.fillText(f.text,p,g)}}},{key:"moveCanvasDrawing",value:function(u){var f=this.canvas.getContext("2d");f.translate(u.width,0)}},{key:"restoreCanvas",value:function(){var u=this.canvas.getContext("2d");u.restore()}}]),l})();return $A.default=o,$A}var jA={},WJ;function oit(){if(WJ)return jA;WJ=1,Object.defineProperty(jA,"__esModule",{value:!0});var n=(function(){function c(u,f){for(var d=0;d<f.length;d++){var h=f[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}return function(u,f,d){return f&&c(u.prototype,f),d&&c(u,d),u}})(),e=fP(),t=r(e),s=Eme();function r(c){return c&&c.__esModule?c:{default:c}}function a(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var o="http://www.w3.org/2000/svg",l=(function(){function c(u,f,d){a(this,c),this.svg=u,this.encodings=f,this.options=d,this.document=d.xmlDocument||document}return n(c,[{key:"render",value:function(){var f=this.options.marginLeft;this.prepareSVG();for(var d=0;d<this.encodings.length;d++){var h=this.encodings[d],p=(0,t.default)(this.options,h.options),g=this.createGroup(f,p.marginTop,this.svg);this.setGroupOptions(g,p),this.drawSvgBarcode(g,p,h),this.drawSVGText(g,p,h),f+=h.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,s.calculateEncodingAttributes)(this.encodings,this.options);var f=(0,s.getTotalWidthOfEncodings)(this.encodings),d=(0,s.getMaximumHeightOfEncodings)(this.encodings),h=f+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(h,d),this.options.background&&this.drawRect(0,0,h,d,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(f,d,h){var p=h.data,g;d.textPosition=="top"?g=d.fontSize+d.textMargin:g=0;for(var b=0,v=0,w=0;w<p.length;w++)v=w*d.width+h.barcodePadding,p[w]==="1"?b++:b>0&&(this.drawRect(v-d.width*b,g,d.width*b,d.height,f),b=0);b>0&&this.drawRect(v-d.width*(b-1),g,d.width*b,d.height,f)}},{key:"drawSVGText",value:function(f,d,h){var p=this.document.createElementNS(o,"text");if(d.displayValue){var g,b;p.setAttribute("style","font:"+d.fontOptions+" "+d.fontSize+"px "+d.font),d.textPosition=="top"?b=d.fontSize-d.textMargin:b=d.height+d.textMargin+d.fontSize,d.textAlign=="left"||h.barcodePadding>0?(g=0,p.setAttribute("text-anchor","start")):d.textAlign=="right"?(g=h.width-1,p.setAttribute("text-anchor","end")):(g=h.width/2,p.setAttribute("text-anchor","middle")),p.setAttribute("x",g),p.setAttribute("y",b),p.appendChild(this.document.createTextNode(h.text)),f.appendChild(p)}}},{key:"setSvgAttributes",value:function(f,d){var h=this.svg;h.setAttribute("width",f+"px"),h.setAttribute("height",d+"px"),h.setAttribute("x","0px"),h.setAttribute("y","0px"),h.setAttribute("viewBox","0 0 "+f+" "+d),h.setAttribute("xmlns",o),h.setAttribute("version","1.1"),h.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(f,d,h){var p=this.document.createElementNS(o,"g");return p.setAttribute("transform","translate("+f+", "+d+")"),h.appendChild(p),p}},{key:"setGroupOptions",value:function(f,d){f.setAttribute("style","fill:"+d.lineColor+";")}},{key:"drawRect",value:function(f,d,h,p,g){var b=this.document.createElementNS(o,"rect");return b.setAttribute("x",f),b.setAttribute("y",d),b.setAttribute("width",h),b.setAttribute("height",p),g.appendChild(b),b}}]),c})();return jA.default=l,jA}var RA={},GJ;function lit(){if(GJ)return RA;GJ=1,Object.defineProperty(RA,"__esModule",{value:!0});var n=(function(){function s(r,a){for(var o=0;o<a.length;o++){var l=a[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,l.key,l)}}return function(r,a,o){return a&&s(r.prototype,a),o&&s(r,o),r}})();function e(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var t=(function(){function s(r,a,o){e(this,s),this.object=r,this.encodings=a,this.options=o}return n(s,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),s})();return RA.default=t,RA}var HJ;function cit(){if(HJ)return PA;HJ=1,Object.defineProperty(PA,"__esModule",{value:!0});var n=ait(),e=o(n),t=oit(),s=o(t),r=lit(),a=o(r);function o(l){return l&&l.__esModule?l:{default:l}}return PA.default={CanvasRenderer:e.default,SVGRenderer:s.default,ObjectRenderer:a.default},PA}var xv={},qJ;function Ime(){if(qJ)return xv;qJ=1,Object.defineProperty(xv,"__esModule",{value:!0});function n(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}function e(o,l){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l&&(typeof l=="object"||typeof l=="function")?l:o}function t(o,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof l);o.prototype=Object.create(l&&l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(o,l):o.__proto__=l)}var s=(function(o){t(l,o);function l(c,u){n(this,l);var f=e(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return f.name="InvalidInputException",f.symbology=c,f.input=u,f.message='"'+f.input+'" is not a valid input for '+f.symbology,f}return l})(Error),r=(function(o){t(l,o);function l(){n(this,l);var c=e(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return c.name="InvalidElementException",c.message="Not supported type to render on",c}return l})(Error),a=(function(o){t(l,o);function l(){n(this,l);var c=e(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return c.name="NoElementException",c.message="No element to render on.",c}return l})(Error);return xv.InvalidInputException=s,xv.InvalidElementException=r,xv.NoElementException=a,xv}var YJ;function uit(){if(YJ)return LA;YJ=1,Object.defineProperty(LA,"__esModule",{value:!0});var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},e=iit(),t=o(e),s=cit(),r=o(s),a=Ime();function o(f){return f&&f.__esModule?f:{default:f}}function l(f){if(typeof f=="string")return c(f);if(Array.isArray(f)){for(var d=[],h=0;h<f.length;h++)d.push(l(f[h]));return d}else{if(typeof HTMLCanvasElement<"u"&&f instanceof HTMLImageElement)return u(f);if(f&&f.nodeName&&f.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&f instanceof SVGElement)return{element:f,options:(0,t.default)(f),renderer:r.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement)return{element:f,options:(0,t.default)(f),renderer:r.default.CanvasRenderer};if(f&&f.getContext)return{element:f,renderer:r.default.CanvasRenderer};if(f&&(typeof f>"u"?"undefined":n(f))==="object"&&!f.nodeName)return{element:f,renderer:r.default.ObjectRenderer};throw new a.InvalidElementException}}function c(f){var d=document.querySelectorAll(f);if(d.length!==0){for(var h=[],p=0;p<d.length;p++)h.push(l(d[p]));return h}}function u(f){var d=document.createElement("canvas");return{element:d,options:(0,t.default)(f),renderer:r.default.CanvasRenderer,afterRender:function(){f.setAttribute("src",d.toDataURL())}}}return LA.default=l,LA}var FA={},KJ;function fit(){if(KJ)return FA;KJ=1,Object.defineProperty(FA,"__esModule",{value:!0});var n=(function(){function s(r,a){for(var o=0;o<a.length;o++){var l=a[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,l.key,l)}}return function(r,a,o){return a&&s(r.prototype,a),o&&s(r,o),r}})();function e(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")}var t=(function(){function s(r){e(this,s),this.api=r}return n(s,[{key:"handleCatch",value:function(a){if(a.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw a.message;else throw a;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(a){try{var o=a.apply(void 0,arguments);return this.api._options.valid(!0),o}catch(l){return this.handleCatch(l),this.api}}}]),s})();return FA.default=t,FA}var uj,XJ;function dit(){if(XJ)return uj;XJ=1;var n=nit(),e=w(n),t=fP(),s=w(t),r=sit(),a=w(r),o=rit(),l=w(o),c=uit(),u=w(c),f=Tme(),d=w(f),h=fit(),p=w(h),g=Ime(),b=kme(),v=w(b);function w(A){return A&&A.__esModule?A:{default:A}}var x=function(){},S=function(D,L,P){var j=new x;if(typeof D>"u")throw Error("No element to render on was provided.");return j._renderProperties=(0,u.default)(D),j._encodings=[],j._options=v.default,j._errorHandler=new p.default(j),typeof L<"u"&&(P=P||{},P.format||(P.format=E()),j.options(P)[P.format](L,P).render()),j};S.getModule=function(A){return e.default[A]};for(var C in e.default)e.default.hasOwnProperty(C)&&M(e.default,C);function M(A,D){x.prototype[D]=x.prototype[D.toUpperCase()]=x.prototype[D.toLowerCase()]=function(L,P){var j=this;return j._errorHandler.wrapBarcodeCall(function(){P.text=typeof P.text>"u"?void 0:""+P.text;var G=(0,s.default)(j._options,P);G=(0,d.default)(G);var Q=A[D],q=k(L,Q,G);return j._encodings.push(q),j})}}function k(A,D,L){A=""+A;var P=new D(A,L);if(!P.valid())throw new g.InvalidInputException(P.constructor.name,A);var j=P.encode();j=(0,a.default)(j);for(var G=0;G<j.length;G++)j[G].options=(0,s.default)(L,j[G].options);return j}function E(){return e.default.CODE128?"CODE128":Object.keys(e.default)[0]}x.prototype.options=function(A){return this._options=(0,s.default)(this._options,A),this},x.prototype.blank=function(A){var D=new Array(A+1).join("0");return this._encodings.push({data:D}),this},x.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var A;for(var D in this._renderProperties){A=this._renderProperties[D];var L=(0,s.default)(this._options,A.options);L.format=="auto"&&(L.format=E()),this._errorHandler.wrapBarcodeCall(function(){var P=L.value,j=e.default[L.format.toUpperCase()],G=k(P,j,L);I(A,G,L)})}}},x.prototype.render=function(){if(!this._renderProperties)throw new g.NoElementException;if(Array.isArray(this._renderProperties))for(var A=0;A<this._renderProperties.length;A++)I(this._renderProperties[A],this._encodings,this._options);else I(this._renderProperties,this._encodings,this._options);return this},x.prototype._defaults=v.default;function I(A,D,L){D=(0,a.default)(D);for(var P=0;P<D.length;P++)D[P].options=(0,s.default)(L,D[P].options),(0,l.default)(D[P].options);(0,l.default)(L);var j=A.renderer,G=new j(A.element,D,L);G.render(),A.afterRender&&A.afterRender()}return typeof window<"u"&&(window.JsBarcode=S),typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(A,D){var L=[];return jQuery(this).each(function(){L.push(this)}),S(L,A,D)}),uj=S,uj}var hit=dit();const pit=k2(hit);function j6(n){return[].concat(n)}function UU(n){return n.startsWith(":")}function Ame(n){return dP(n)&&(n==="*"||n.length>1&&":>~.+*".includes(n.slice(0,1))||Ome(n))}function Lme(n,e){return(dP(e)||typeof e=="number")&&!Dme(n)&&!UU(n)&&!Nme(n)}function Nme(n){return n.startsWith("@media")}function mit(n){return n==="."}function Dme(n){return n==="--"}function dP(n){return n+""===n}function Ome(n){return dP(n)&&(n.startsWith("&")||UU(n))}function r4(n,e=""){return n.filter(Boolean).join(e)}function Pme(n,e){let t=0;if(e.length===0)return t.toString();for(let s=0;s<e.length;s++){const r=e.charCodeAt(s);t=(t<<5)-t+r,t=t&t}return`${n??"cl"}_${t.toString(36)}`}function git(n,e){return n==="content"?`"${e}"`:e}function yit(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function QJ(n,e){return`${n}:${e}`}function bit(n){return n?`.${n}`:""}function wit(n,e){return n?`${n}
${e}`:e}var $me=class jme{constructor(e,t,s,r){this.sheet=e,this.property=t,this.value=s,this.selector=r,this.property=t,this.value=s,this.joined=QJ(t,s);const a=this.selector.preconditions.concat(this.selector.postconditions);this.hash=this.selector.hasConditions?this.selector.scopeClassName:Pme(this.sheet.name,this.joined),this.key=r4([this.joined,a,this.hash])}toString(){let e=R6(this.selector.preconditions,{right:this.hash});return e=R6(this.selector.postconditions,{left:e}),`${e} {${jme.genRule(this.property,this.value)}}`}static genRule(e,t){const s=yit(e);return QJ(s,git(e,t))+";"}};function R6(n,{left:e="",right:t=""}={}){const s=n.reduce((r,a)=>UU(a)?r+a:Ome(a)?r+a.slice(1):r4([r,a]," "),e);return r4([s,bit(t)]," ")}var vit=class RL{constructor(e,t=null,{preconditions:s,postconditions:r}={}){this.sheet=e,this.preconditions=[],this.scopeClassName=null,this.scopeName=null,this.postconditions=[],this.preconditions=s?j6(s):[],this.postconditions=r?j6(r):[],this.setScope(t)}setScope(e){return e?(this.scopeClassName||(this.scopeName=e,this.scopeClassName=Pme(this.sheet.name,e+this.sheet.count)),this):this}get hasConditions(){return this.preconditions.length>0||this.postconditions.length>0}addScope(e){return new RL(this.sheet,e,{preconditions:this.preconditions,postconditions:this.postconditions})}addPrecondition(e){return new RL(this.sheet,this.scopeClassName,{postconditions:this.postconditions,preconditions:this.preconditions.concat(e)})}addPostcondition(e){return new RL(this.sheet,this.scopeClassName,{preconditions:this.preconditions,postconditions:this.postconditions.concat(e)})}createRule(e,t){return new $me(this.sheet,e,t,this)}},_it=class{constructor(n,e){this.name=n,this.rootNode=e,this.storedStyles={},this.storedClasses={},this.style="",this.count=0,this.id=`flairup-${n}`,this.styleTag=this.createStyleTag()}getStyle(){return this.style}append(n){this.style=wit(this.style,n)}apply(){this.count++,this.styleTag&&(this.styleTag.innerHTML=this.style)}isApplied(){return!!this.styleTag}createStyleTag(){if(typeof document>"u"||this.isApplied()||this.rootNode===null)return this.styleTag;const n=document.createElement("style");return n.type="text/css",n.id=this.id,(this.rootNode??document.head).appendChild(n),n}addRule(n){const e=this.storedClasses[n.key];return dP(e)?e:(this.storedClasses[n.key]=n.hash,this.storedStyles[n.hash]=[n.property,n.value],this.append(n.toString()),n.hash)}};function VU(n,e){for(const t in n)e(t.trim(),n[t])}function Ur(...n){const e=n.reduce((t,s)=>(s instanceof Set?t.push(...s):typeof s=="string"?t.push(s):Array.isArray(s)?t.push(Ur(...s)):typeof s=="object"&&Object.entries(s).forEach(([r,a])=>{a&&t.push(r)}),t),[]);return r4(e," ").trim()}function xit(n,e){const t=new _it(n,e);return{create:s,getStyle:t.getStyle.bind(t),isApplied:t.isApplied.bind(t)};function s(r){const a={};return Rme(t,r,new vit(t)).forEach(([l,c,u])=>{hP(t,c,u).forEach(f=>{o(l,f)})}),t.apply(),a;function o(l,c){a[l]=a[l]??new Set,a[l].add(c)}}}function Rme(n,e,t){const s=[];return VU(e,(r,a)=>{if(Ame(r))return Rme(n,a,t.addPrecondition(r)).forEach(o=>s.push(o));s.push([r,e[r],t.addScope(r)])}),s}function hP(n,e,t){const s=new Set;return VU(e,(r,a)=>{let o=[];if(Ame(r))o=hP(n,a,t.addPostcondition(r));else if(mit(r))o=j6(a);else if(Nme(r))o=Sit(n,a,r,t);else if(Dme(r))o=Cit(n,a,t);else if(Lme(r,a)){const l=t.createRule(r,a);n.addRule(l),s.add(l.hash)}return Fme(o,s)}),s}function Fme(n,e){return n.forEach(t=>e.add(t)),e}function Cit(n,e,t){const s=new Set,r=[];if(VU(e,(a,o)=>{if(Lme(a,o)){r.push($me.genRule(a,o));return}const l=hP(n,o??{},t);Fme(l,s)}),!t.scopeClassName)return s;if(r.length){const a=r.join(" ");n.append(`${R6(t.preconditions,{right:t.scopeClassName})} {${a}}`)}return s.add(t.scopeClassName),s}function Sit(n,e,t,s){n.append(t+" {");const r=hP(n,e,s);return n.append("}"),r}function Ua(){return Ua=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Ua.apply(this,arguments)}function Mit(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,F6(n,e)}function F6(n,e){return F6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,r){return s.__proto__=r,s},F6(n,e)}function zme(n,e){if(n==null)return{};var t={},s=Object.keys(n),r,a;for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Tit(n,e){if(n){if(typeof n=="string")return JJ(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return JJ(n,e)}}function JJ(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=new Array(e);t<e;t++)s[t]=n[t];return s}function kit(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=Tit(n))||e){t&&(n=t);var s=0;return function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ri;(function(n){n.hiddenOnSearch="epr-hidden-on-search",n.searchActive="epr-search-active",n.hidden="epr-hidden",n.visible="epr-visible",n.active="epr-active",n.emoji="epr-emoji",n.category="epr-emoji-category",n.label="epr-emoji-category-label",n.categoryContent="epr-emoji-category-content",n.emojiHasVariations="epr-emoji-has-variations",n.scrollBody="epr-body",n.emojiList="epr-emoji-list",n.external="__EmojiPicker__",n.emojiPicker="EmojiPickerReact",n.open="epr-open",n.vertical="epr-vertical",n.horizontal="epr-horizontal",n.variationPicker="epr-emoji-variation-picker",n.darkTheme="epr-dark-theme",n.autoTheme="epr-auto-theme"})(ri||(ri={}));function yh(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.map(function(s){return"."+s}).join("")}var so=xit("epr",null),FL={display:"none",opacity:"0",pointerEvents:"none",visibility:"hidden",overflow:"hidden"},WU=so.create({hidden:Ua({".":ri.hidden},FL)}),Eit=Ie.memo(function(){return Ie.createElement("style",{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:so.getStyle()}})}),uw=so.create({".epr-main":{":has(input:not(:placeholder-shown))":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},hiddenOnSearch:Ua({".":ri.hiddenOnSearch},FL)},":has(input:placeholder-shown)":{visibleOnSearchOnly:FL}},hiddenOnReactions:{transition:"all 0.5s ease-in-out"},".epr-reactions":{hiddenOnReactions:{height:"0px",width:"0px",opacity:"0",pointerEvents:"none",overflow:"hidden"}},".EmojiPickerReact:not(.epr-search-active)":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"},"&.epr-active":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},visibleOnSearchOnly:Ua({".":"epr-visible-on-search-only"},FL)}});function v1(n,e){var t,s;return{".epr-dark-theme":(t={},t[n]=e,t),".epr-auto-theme":(s={},s[n]={"@media (prefers-color-scheme: dark)":e},s)}}function Bme(n,e){var t,s,r=(t=n.customEmojis)!=null?t:[],a=(s=e.customEmojis)!=null?s:[];return n.open===e.open&&n.emojiVersion===e.emojiVersion&&n.reactionsDefaultOpen===e.reactionsDefaultOpen&&n.searchPlaceHolder===e.searchPlaceHolder&&n.searchPlaceholder===e.searchPlaceholder&&n.searchClearButtonLabel===e.searchClearButtonLabel&&n.defaultSkinTone===e.defaultSkinTone&&n.skinTonesDisabled===e.skinTonesDisabled&&n.autoFocusSearch===e.autoFocusSearch&&n.emojiStyle===e.emojiStyle&&n.theme===e.theme&&n.suggestedEmojisMode===e.suggestedEmojisMode&&n.lazyLoadEmojis===e.lazyLoadEmojis&&n.className===e.className&&n.height===e.height&&n.width===e.width&&n.style===e.style&&n.searchDisabled===e.searchDisabled&&n.skinTonePickerLocation===e.skinTonePickerLocation&&r.length===a.length}var Iit=["1f44d","2764-fe0f","1f603","1f622","1f64f","1f44e","1f621"],yM={};setTimeout(function(){yP.reduce(function(n,e){return Ume(e),n},yM)});function Ume(n){var e=wE(n).flat().join("").toLowerCase().replace(/[^a-zA-Z\d]/g,"").split("");e.forEach(function(t){var s;yM[t]=(s=yM[t])!=null?s:{},yM[t][Vc(n)]=n})}function ZJ(n,e){e===void 0&&(e=0);var t=Ie.useState(n),s=t[0],r=t[1],a=Ie.useRef(null);function o(l){return new Promise(function(c){var u;a.current&&clearTimeout(a.current),a.current=(u=window)==null?void 0:u.setTimeout(function(){r(l),c(l)},e)})}return[s,o]}function Ait(){var n=Aat();return function(e){return n.has(e)}}function Vme(){var n=Ie.useRef({}),e=Iat();return Ie.useMemo(function(){var t=parseFloat(""+e);return!e||Number.isNaN(t)?n.current:yP.reduce(function(s,r){return Nit(r,t)&&(s[Vc(r)]=!0),s},n.current)},[e])}function Lit(){var n=Vme(),e=Ait();return function(s){var r=YU(Vc(s));return!!(n[r]||e(r))}}function Nit(n,e){return nat(n)>e}function Dit(n){Ie.useEffect(function(){n(!0)},[n])}var ZM;(function(n){n.RECENT="recent",n.FREQUENT="frequent"})(ZM||(ZM={}));var gd;(function(n){n.NATIVE="native",n.APPLE="apple",n.TWITTER="twitter",n.GOOGLE="google",n.FACEBOOK="facebook"})(gd||(gd={}));var eT;(function(n){n.DARK="dark",n.LIGHT="light",n.AUTO="auto"})(eT||(eT={}));var tp;(function(n){n.NEUTRAL="neutral",n.LIGHT="1f3fb",n.MEDIUM_LIGHT="1f3fc",n.MEDIUM="1f3fd",n.MEDIUM_DARK="1f3fe",n.DARK="1f3ff"})(tp||(tp={}));var Er;(function(n){n.SUGGESTED="suggested",n.CUSTOM="custom",n.SMILEYS_PEOPLE="smileys_people",n.ANIMALS_NATURE="animals_nature",n.FOOD_DRINK="food_drink",n.TRAVEL_PLACES="travel_places",n.ACTIVITIES="activities",n.OBJECTS="objects",n.SYMBOLS="symbols",n.FLAGS="flags"})(Er||(Er={}));var x2;(function(n){n.SEARCH="SEARCH",n.PREVIEW="PREVIEW"})(x2||(x2={}));function Oit(n){var e=n.children,t=Vme(),s=bat(),r=Eat(),a=Ie.useRef(yM),o=Ie.useRef(!1),l=Ie.useRef(!1),c=Ie.useRef(t),u=ZJ(Date.now(),200),f=ZJ("",100),d=Ie.useState(!1),h=Ie.useState(s),p=Ie.useState(null),g=Ie.useState(new Set),b=Ie.useState(null),v=Ie.useState(r),w=Ie.useState(!1),x=w[0],S=w[1],C=Ie.useState([]),M=Ie.useState(null);return Dit(S),Ie.createElement(Id.Provider,{value:{activeCategoryState:p,activeSkinTone:h,disallowClickRef:o,disallowMouseRef:l,disallowedEmojisRef:c,emojiVariationPickerState:b,emojisThatFailedToLoadState:g,filterRef:a,isPastInitialLoad:x,searchTerm:f,skinToneFanOpenState:d,suggestedUpdateState:u,reactionsModeState:v,visibleCategoriesState:C,emojiSizeState:M}},e)}var Id=Ie.createContext({activeCategoryState:[null,function(){}],activeSkinTone:[tp.NEUTRAL,function(){}],disallowClickRef:{current:!1},disallowMouseRef:{current:!1},disallowedEmojisRef:{current:{}},emojiVariationPickerState:[null,function(){}],emojisThatFailedToLoadState:[new Set,function(){}],filterRef:{current:{}},isPastInitialLoad:!0,searchTerm:["",function(){return new Promise(function(){})}],skinToneFanOpenState:[!1,function(){}],suggestedUpdateState:[Date.now(),function(){}],reactionsModeState:[!1,function(){}],visibleCategoriesState:[[],function(){return[]}],emojiSizeState:[null,function(){}]});function GU(){var n=Ie.useContext(Id),e=n.filterRef;return e}function Pit(){var n=Ie.useContext(Id),e=n.disallowClickRef;return e}function HU(){var n=Ie.useContext(Id),e=n.disallowMouseRef;return e}function fw(){var n=Ie.useContext(Id),e=n.reactionsModeState;return e}function pP(){var n=Ie.useContext(Id),e=n.searchTerm;return e}function mP(){var n=Ie.useContext(Id),e=n.activeSkinTone;return e}function Wme(){var n=Ie.useContext(Id),e=n.emojisThatFailedToLoadState;return e}function ix(){var n=Ie.useContext(Id),e=n.emojiVariationPickerState;return e}function bE(){var n=Ie.useContext(Id),e=n.skinToneFanOpenState;return e}function qU(){var n=Ie.useContext(Id),e=n.visibleCategoriesState;return e}function Gme(){var n=Ie.useContext(Id),e=n.emojiSizeState;return e}function Hme(){var n=Ie.useContext(Id),e=n.suggestedUpdateState,t=e[0],s=e[1];return[t,function(){s(Date.now())}]}var Jd,$it=[Er.SUGGESTED,Er.CUSTOM,Er.SMILEYS_PEOPLE,Er.ANIMALS_NATURE,Er.FOOD_DRINK,Er.TRAVEL_PLACES,Er.ACTIVITIES,Er.OBJECTS,Er.SYMBOLS,Er.FLAGS],jit={name:"Recently Used",category:Er.SUGGESTED},qme=(Jd={},Jd[Er.SUGGESTED]={category:Er.SUGGESTED,name:"Frequently Used"},Jd[Er.CUSTOM]={category:Er.CUSTOM,name:"Custom Emojis"},Jd[Er.SMILEYS_PEOPLE]={category:Er.SMILEYS_PEOPLE,name:"Smileys & People"},Jd[Er.ANIMALS_NATURE]={category:Er.ANIMALS_NATURE,name:"Animals & Nature"},Jd[Er.FOOD_DRINK]={category:Er.FOOD_DRINK,name:"Food & Drink"},Jd[Er.TRAVEL_PLACES]={category:Er.TRAVEL_PLACES,name:"Travel & Places"},Jd[Er.ACTIVITIES]={category:Er.ACTIVITIES,name:"Activities"},Jd[Er.OBJECTS]={category:Er.OBJECTS,name:"Objects"},Jd[Er.SYMBOLS]={category:Er.SYMBOLS,name:"Symbols"},Jd[Er.FLAGS]={category:Er.FLAGS,name:"Flags"},Jd);function Yme(n){return $it.map(function(e){return Ua({},qme[e],n&&n[e]&&n[e])})}function gP(n){return n.category}function Kme(n){return n.name}function Rit(n,e){var t;n===void 0&&(n=[]),e===void 0&&(e={});var s={};e.suggestionMode===ZM.RECENT&&(s[Er.SUGGESTED]=jit);var r=Yme(s);return(t=n)!=null&&t.length?n.map(function(a){return typeof a=="string"?eZ(a,s[a]):Ua({},eZ(a.category,s[a.category]),a)}):r}function eZ(n,e){return e===void 0&&(e={}),Object.assign(qme[n],e)}var Fit="https://cdn.jsdelivr.net/npm/emoji-datasource-apple/img/apple/64/",zit="https://cdn.jsdelivr.net/npm/emoji-datasource-facebook/img/facebook/64/",Bit="https://cdn.jsdelivr.net/npm/emoji-datasource-twitter/img/twitter/64/",Uit="https://cdn.jsdelivr.net/npm/emoji-datasource-google/img/google/64/";function Vit(n){switch(n){case gd.TWITTER:return Bit;case gd.GOOGLE:return Uit;case gd.FACEBOOK:return zit;case gd.APPLE:default:return Fit}}var Wit=[],Git=[{n:["grinning","grinning face"],u:"1f600",a:"1.0"},{n:["smiley","smiling face with open mouth"],u:"1f603",a:"0.6"},{n:["smile","smiling face with open mouth and smiling eyes"],u:"1f604",a:"0.6"},{n:["grin","grinning face with smiling eyes"],u:"1f601",a:"0.6"},{n:["laughing","satisfied","smiling face with open mouth and tightly-closed eyes"],u:"1f606",a:"0.6"},{n:["sweat smile","smiling face with open mouth and cold sweat"],u:"1f605",a:"0.6"},{n:["rolling on the floor laughing"],u:"1f923",a:"3.0"},{n:["joy","face with tears of joy"],u:"1f602",a:"0.6"},{n:["slightly smiling face"],u:"1f642",a:"1.0"},{n:["upside-down face","upside down face"],u:"1f643",a:"1.0"},{n:["melting face"],u:"1fae0",a:"14.0"},{n:["wink","winking face"],u:"1f609",a:"0.6"},{n:["blush","smiling face with smiling eyes"],u:"1f60a",a:"0.6"},{n:["innocent","smiling face with halo"],u:"1f607",a:"1.0"},{n:["smiling face with 3 hearts","smiling face with smiling eyes and three hearts"],u:"1f970",a:"11.0"},{n:["heart eyes","smiling face with heart-shaped eyes"],u:"1f60d",a:"0.6"},{n:["star-struck","grinning face with star eyes"],u:"1f929",a:"5.0"},{n:["kissing heart","face throwing a kiss"],u:"1f618",a:"0.6"},{n:["kissing","kissing face"],u:"1f617",a:"1.0"},{n:["relaxed","white smiling face"],u:"263a-fe0f",a:"0.6"},{n:["kissing closed eyes","kissing face with closed eyes"],u:"1f61a",a:"0.6"},{n:["kissing smiling eyes","kissing face with smiling eyes"],u:"1f619",a:"1.0"},{n:["smiling face with tear"],u:"1f972",a:"13.0"},{n:["yum","face savouring delicious food"],u:"1f60b",a:"0.6"},{n:["stuck out tongue","face with stuck-out tongue"],u:"1f61b",a:"1.0"},{n:["stuck out tongue winking eye","face with stuck-out tongue and winking eye"],u:"1f61c",a:"0.6"},{n:["zany face","grinning face with one large and one small eye"],u:"1f92a",a:"5.0"},{n:["stuck out tongue closed eyes","face with stuck-out tongue and tightly-closed eyes"],u:"1f61d",a:"0.6"},{n:["money-mouth face","money mouth face"],u:"1f911",a:"1.0"},{n:["hugging face"],u:"1f917",a:"1.0"},{n:["face with hand over mouth","smiling face with smiling eyes and hand covering mouth"],u:"1f92d",a:"5.0"},{n:["face with open eyes and hand over mouth"],u:"1fae2",a:"14.0"},{n:["face with peeking eye"],u:"1fae3",a:"14.0"},{n:["shushing face","face with finger covering closed lips"],u:"1f92b",a:"5.0"},{n:["thinking face"],u:"1f914",a:"1.0"},{n:["saluting face"],u:"1fae1",a:"14.0"},{n:["zipper-mouth face","zipper mouth face"],u:"1f910",a:"1.0"},{n:["face with raised eyebrow","face with one eyebrow raised"],u:"1f928",a:"5.0"},{n:["neutral face"],u:"1f610",a:"0.7"},{n:["expressionless","expressionless face"],u:"1f611",a:"1.0"},{n:["no mouth","face without mouth"],u:"1f636",a:"1.0"},{n:["dotted line face"],u:"1fae5",a:"14.0"},{n:["face in clouds"],u:"1f636-200d-1f32b-fe0f",a:"13.1"},{n:["smirk","smirking face"],u:"1f60f",a:"0.6"},{n:["unamused","unamused face"],u:"1f612",a:"0.6"},{n:["face with rolling eyes"],u:"1f644",a:"1.0"},{n:["grimacing","grimacing face"],u:"1f62c",a:"1.0"},{n:["face exhaling"],u:"1f62e-200d-1f4a8",a:"13.1"},{n:["lying face"],u:"1f925",a:"3.0"},{n:["shaking face"],u:"1fae8",a:"15.0"},{n:["head shaking horizontally"],u:"1f642-200d-2194-fe0f",a:"15.1"},{n:["head shaking vertically"],u:"1f642-200d-2195-fe0f",a:"15.1"},{n:["relieved","relieved face"],u:"1f60c",a:"0.6"},{n:["pensive","pensive face"],u:"1f614",a:"0.6"},{n:["sleepy","sleepy face"],u:"1f62a",a:"0.6"},{n:["drooling face"],u:"1f924",a:"3.0"},{n:["sleeping","sleeping face"],u:"1f634",a:"1.0"},{n:["mask","face with medical mask"],u:"1f637",a:"0.6"},{n:["face with thermometer"],u:"1f912",a:"1.0"},{n:["face with head-bandage","face with head bandage"],u:"1f915",a:"1.0"},{n:["nauseated face"],u:"1f922",a:"3.0"},{n:["face vomiting","face with open mouth vomiting"],u:"1f92e",a:"5.0"},{n:["sneezing face"],u:"1f927",a:"3.0"},{n:["hot face","overheated face"],u:"1f975",a:"11.0"},{n:["cold face","freezing face"],u:"1f976",a:"11.0"},{n:["woozy face","face with uneven eyes and wavy mouth"],u:"1f974",a:"11.0"},{n:["dizzy face"],u:"1f635",a:"0.6"},{n:["face with spiral eyes"],u:"1f635-200d-1f4ab",a:"13.1"},{n:["exploding head","shocked face with exploding head"],u:"1f92f",a:"5.0"},{n:["face with cowboy hat"],u:"1f920",a:"3.0"},{n:["partying face","face with party horn and party hat"],u:"1f973",a:"11.0"},{n:["disguised face"],u:"1f978",a:"13.0"},{n:["sunglasses","smiling face with sunglasses"],u:"1f60e",a:"1.0"},{n:["nerd face"],u:"1f913",a:"1.0"},{n:["face with monocle"],u:"1f9d0",a:"5.0"},{n:["confused","confused face"],u:"1f615",a:"1.0"},{n:["face with diagonal mouth"],u:"1fae4",a:"14.0"},{n:["worried","worried face"],u:"1f61f",a:"1.0"},{n:["slightly frowning face"],u:"1f641",a:"1.0"},{n:["frowning face","white frowning face"],u:"2639-fe0f",a:"0.7"},{n:["open mouth","face with open mouth"],u:"1f62e",a:"1.0"},{n:["hushed","hushed face"],u:"1f62f",a:"1.0"},{n:["astonished","astonished face"],u:"1f632",a:"0.6"},{n:["flushed","flushed face"],u:"1f633",a:"0.6"},{n:["pleading face","face with pleading eyes"],u:"1f97a",a:"11.0"},{n:["face holding back tears"],u:"1f979",a:"14.0"},{n:["frowning","frowning face with open mouth"],u:"1f626",a:"1.0"},{n:["anguished","anguished face"],u:"1f627",a:"1.0"},{n:["fearful","fearful face"],u:"1f628",a:"0.6"},{n:["cold sweat","face with open mouth and cold sweat"],u:"1f630",a:"0.6"},{n:["disappointed relieved","disappointed but relieved face"],u:"1f625",a:"0.6"},{n:["cry","crying face"],u:"1f622",a:"0.6"},{n:["sob","loudly crying face"],u:"1f62d",a:"0.6"},{n:["scream","face screaming in fear"],u:"1f631",a:"0.6"},{n:["confounded","confounded face"],u:"1f616",a:"0.6"},{n:["persevere","persevering face"],u:"1f623",a:"0.6"},{n:["disappointed","disappointed face"],u:"1f61e",a:"0.6"},{n:["sweat","face with cold sweat"],u:"1f613",a:"0.6"},{n:["weary","weary face"],u:"1f629",a:"0.6"},{n:["tired face"],u:"1f62b",a:"0.6"},{n:["yawning face"],u:"1f971",a:"12.0"},{n:["triumph","face with look of triumph"],u:"1f624",a:"0.6"},{n:["rage","pouting face"],u:"1f621",a:"0.6"},{n:["angry","angry face"],u:"1f620",a:"0.6"},{n:["face with symbols on mouth","serious face with symbols covering mouth"],u:"1f92c",a:"5.0"},{n:["smiling imp","smiling face with horns"],u:"1f608",a:"1.0"},{n:["imp"],u:"1f47f",a:"0.6"},{n:["skull"],u:"1f480",a:"0.6"},{n:["skull and crossbones"],u:"2620-fe0f",a:"1.0"},{n:["poop","shit","hankey","pile of poo"],u:"1f4a9",a:"0.6"},{n:["clown face"],u:"1f921",a:"3.0"},{n:["japanese ogre"],u:"1f479",a:"0.6"},{n:["japanese goblin"],u:"1f47a",a:"0.6"},{n:["ghost"],u:"1f47b",a:"0.6"},{n:["alien","extraterrestrial alien"],u:"1f47d",a:"0.6"},{n:["alien monster","space invader"],u:"1f47e",a:"0.6"},{n:["robot face"],u:"1f916",a:"1.0"},{n:["smiley cat","smiling cat face with open mouth"],u:"1f63a",a:"0.6"},{n:["smile cat","grinning cat face with smiling eyes"],u:"1f638",a:"0.6"},{n:["joy cat","cat face with tears of joy"],u:"1f639",a:"0.6"},{n:["heart eyes cat","smiling cat face with heart-shaped eyes"],u:"1f63b",a:"0.6"},{n:["smirk cat","cat face with wry smile"],u:"1f63c",a:"0.6"},{n:["kissing cat","kissing cat face with closed eyes"],u:"1f63d",a:"0.6"},{n:["scream cat","weary cat face"],u:"1f640",a:"0.6"},{n:["crying cat face"],u:"1f63f",a:"0.6"},{n:["pouting cat","pouting cat face"],u:"1f63e",a:"0.6"},{n:["see no evil","see-no-evil monkey"],u:"1f648",a:"0.6"},{n:["hear no evil","hear-no-evil monkey"],u:"1f649",a:"0.6"},{n:["speak no evil","speak-no-evil monkey"],u:"1f64a",a:"0.6"},{n:["love letter"],u:"1f48c",a:"0.6"},{n:["cupid","heart with arrow"],u:"1f498",a:"0.6"},{n:["gift heart","heart with ribbon"],u:"1f49d",a:"0.6"},{n:["sparkling heart"],u:"1f496",a:"0.6"},{n:["heartpulse","growing heart"],u:"1f497",a:"0.6"},{n:["heartbeat","beating heart"],u:"1f493",a:"0.6"},{n:["revolving hearts"],u:"1f49e",a:"0.6"},{n:["two hearts"],u:"1f495",a:"0.6"},{n:["heart decoration"],u:"1f49f",a:"0.6"},{n:["heart exclamation","heavy heart exclamation mark ornament"],u:"2763-fe0f",a:"1.0"},{n:["broken heart"],u:"1f494",a:"0.6"},{n:["heart on fire"],u:"2764-fe0f-200d-1f525",a:"13.1"},{n:["mending heart"],u:"2764-fe0f-200d-1fa79",a:"13.1"},{n:["heart","heavy black heart"],u:"2764-fe0f",a:"0.6"},{n:["pink heart"],u:"1fa77",a:"15.0"},{n:["orange heart"],u:"1f9e1",a:"5.0"},{n:["yellow heart"],u:"1f49b",a:"0.6"},{n:["green heart"],u:"1f49a",a:"0.6"},{n:["blue heart"],u:"1f499",a:"0.6"},{n:["light blue heart"],u:"1fa75",a:"15.0"},{n:["purple heart"],u:"1f49c",a:"0.6"},{n:["brown heart"],u:"1f90e",a:"12.0"},{n:["black heart"],u:"1f5a4",a:"3.0"},{n:["grey heart"],u:"1fa76",a:"15.0"},{n:["white heart"],u:"1f90d",a:"12.0"},{n:["kiss","kiss mark"],u:"1f48b",a:"0.6"},{n:["100","hundred points symbol"],u:"1f4af",a:"0.6"},{n:["anger","anger symbol"],u:"1f4a2",a:"0.6"},{n:["boom","collision","collision symbol"],u:"1f4a5",a:"0.6"},{n:["dizzy","dizzy symbol"],u:"1f4ab",a:"0.6"},{n:["sweat drops","splashing sweat symbol"],u:"1f4a6",a:"0.6"},{n:["dash","dash symbol"],u:"1f4a8",a:"0.6"},{n:["hole"],u:"1f573-fe0f",a:"0.7"},{n:["speech balloon"],u:"1f4ac",a:"0.6"},{n:["eye in speech bubble","eye-in-speech-bubble"],u:"1f441-fe0f-200d-1f5e8-fe0f",a:"2.0"},{n:["left speech bubble"],u:"1f5e8-fe0f",a:"2.0"},{n:["right anger bubble"],u:"1f5ef-fe0f",a:"0.7"},{n:["thought balloon"],u:"1f4ad",a:"1.0"},{n:["zzz","sleeping symbol"],u:"1f4a4",a:"0.6"},{n:["wave","waving hand sign"],u:"1f44b",v:["1f44b-1f3fb","1f44b-1f3fc","1f44b-1f3fd","1f44b-1f3fe","1f44b-1f3ff"],a:"0.6"},{n:["raised back of hand"],u:"1f91a",v:["1f91a-1f3fb","1f91a-1f3fc","1f91a-1f3fd","1f91a-1f3fe","1f91a-1f3ff"],a:"3.0"},{n:["hand with fingers splayed","raised hand with fingers splayed"],u:"1f590-fe0f",v:["1f590-1f3fb","1f590-1f3fc","1f590-1f3fd","1f590-1f3fe","1f590-1f3ff"],a:"0.7"},{n:["hand","raised hand"],u:"270b",v:["270b-1f3fb","270b-1f3fc","270b-1f3fd","270b-1f3fe","270b-1f3ff"],a:"0.6"},{n:["spock-hand","raised hand with part between middle and ring fingers"],u:"1f596",v:["1f596-1f3fb","1f596-1f3fc","1f596-1f3fd","1f596-1f3fe","1f596-1f3ff"],a:"1.0"},{n:["rightwards hand"],u:"1faf1",v:["1faf1-1f3fb","1faf1-1f3fc","1faf1-1f3fd","1faf1-1f3fe","1faf1-1f3ff"],a:"14.0"},{n:["leftwards hand"],u:"1faf2",v:["1faf2-1f3fb","1faf2-1f3fc","1faf2-1f3fd","1faf2-1f3fe","1faf2-1f3ff"],a:"14.0"},{n:["palm down hand"],u:"1faf3",v:["1faf3-1f3fb","1faf3-1f3fc","1faf3-1f3fd","1faf3-1f3fe","1faf3-1f3ff"],a:"14.0"},{n:["palm up hand"],u:"1faf4",v:["1faf4-1f3fb","1faf4-1f3fc","1faf4-1f3fd","1faf4-1f3fe","1faf4-1f3ff"],a:"14.0"},{n:["leftwards pushing hand"],u:"1faf7",v:["1faf7-1f3fb","1faf7-1f3fc","1faf7-1f3fd","1faf7-1f3fe","1faf7-1f3ff"],a:"15.0"},{n:["rightwards pushing hand"],u:"1faf8",v:["1faf8-1f3fb","1faf8-1f3fc","1faf8-1f3fd","1faf8-1f3fe","1faf8-1f3ff"],a:"15.0"},{n:["ok hand","ok hand sign"],u:"1f44c",v:["1f44c-1f3fb","1f44c-1f3fc","1f44c-1f3fd","1f44c-1f3fe","1f44c-1f3ff"],a:"0.6"},{n:["pinched fingers"],u:"1f90c",v:["1f90c-1f3fb","1f90c-1f3fc","1f90c-1f3fd","1f90c-1f3fe","1f90c-1f3ff"],a:"13.0"},{n:["pinching hand"],u:"1f90f",v:["1f90f-1f3fb","1f90f-1f3fc","1f90f-1f3fd","1f90f-1f3fe","1f90f-1f3ff"],a:"12.0"},{n:["v","victory hand"],u:"270c-fe0f",v:["270c-1f3fb","270c-1f3fc","270c-1f3fd","270c-1f3fe","270c-1f3ff"],a:"0.6"},{n:["crossed fingers","hand with index and middle fingers crossed"],u:"1f91e",v:["1f91e-1f3fb","1f91e-1f3fc","1f91e-1f3fd","1f91e-1f3fe","1f91e-1f3ff"],a:"3.0"},{n:["hand with index finger and thumb crossed"],u:"1faf0",v:["1faf0-1f3fb","1faf0-1f3fc","1faf0-1f3fd","1faf0-1f3fe","1faf0-1f3ff"],a:"14.0"},{n:["i love you hand sign"],u:"1f91f",v:["1f91f-1f3fb","1f91f-1f3fc","1f91f-1f3fd","1f91f-1f3fe","1f91f-1f3ff"],a:"5.0"},{n:["the horns","sign of the horns"],u:"1f918",v:["1f918-1f3fb","1f918-1f3fc","1f918-1f3fd","1f918-1f3fe","1f918-1f3ff"],a:"1.0"},{n:["call me hand"],u:"1f919",v:["1f919-1f3fb","1f919-1f3fc","1f919-1f3fd","1f919-1f3fe","1f919-1f3ff"],a:"3.0"},{n:["point left","white left pointing backhand index"],u:"1f448",v:["1f448-1f3fb","1f448-1f3fc","1f448-1f3fd","1f448-1f3fe","1f448-1f3ff"],a:"0.6"},{n:["point right","white right pointing backhand index"],u:"1f449",v:["1f449-1f3fb","1f449-1f3fc","1f449-1f3fd","1f449-1f3fe","1f449-1f3ff"],a:"0.6"},{n:["point up 2","white up pointing backhand index"],u:"1f446",v:["1f446-1f3fb","1f446-1f3fc","1f446-1f3fd","1f446-1f3fe","1f446-1f3ff"],a:"0.6"},{n:["middle finger","reversed hand with middle finger extended"],u:"1f595",v:["1f595-1f3fb","1f595-1f3fc","1f595-1f3fd","1f595-1f3fe","1f595-1f3ff"],a:"1.0"},{n:["point down","white down pointing backhand index"],u:"1f447",v:["1f447-1f3fb","1f447-1f3fc","1f447-1f3fd","1f447-1f3fe","1f447-1f3ff"],a:"0.6"},{n:["point up","white up pointing index"],u:"261d-fe0f",v:["261d-1f3fb","261d-1f3fc","261d-1f3fd","261d-1f3fe","261d-1f3ff"],a:"0.6"},{n:["index pointing at the viewer"],u:"1faf5",v:["1faf5-1f3fb","1faf5-1f3fc","1faf5-1f3fd","1faf5-1f3fe","1faf5-1f3ff"],a:"14.0"},{n:["+1","thumbsup","thumbs up sign"],u:"1f44d",v:["1f44d-1f3fb","1f44d-1f3fc","1f44d-1f3fd","1f44d-1f3fe","1f44d-1f3ff"],a:"0.6"},{n:["-1","thumbsdown","thumbs down sign"],u:"1f44e",v:["1f44e-1f3fb","1f44e-1f3fc","1f44e-1f3fd","1f44e-1f3fe","1f44e-1f3ff"],a:"0.6"},{n:["fist","raised fist"],u:"270a",v:["270a-1f3fb","270a-1f3fc","270a-1f3fd","270a-1f3fe","270a-1f3ff"],a:"0.6"},{n:["punch","facepunch","fisted hand sign"],u:"1f44a",v:["1f44a-1f3fb","1f44a-1f3fc","1f44a-1f3fd","1f44a-1f3fe","1f44a-1f3ff"],a:"0.6"},{n:["left-facing fist"],u:"1f91b",v:["1f91b-1f3fb","1f91b-1f3fc","1f91b-1f3fd","1f91b-1f3fe","1f91b-1f3ff"],a:"3.0"},{n:["right-facing fist"],u:"1f91c",v:["1f91c-1f3fb","1f91c-1f3fc","1f91c-1f3fd","1f91c-1f3fe","1f91c-1f3ff"],a:"3.0"},{n:["clap","clapping hands sign"],u:"1f44f",v:["1f44f-1f3fb","1f44f-1f3fc","1f44f-1f3fd","1f44f-1f3fe","1f44f-1f3ff"],a:"0.6"},{n:["raised hands","person raising both hands in celebration"],u:"1f64c",v:["1f64c-1f3fb","1f64c-1f3fc","1f64c-1f3fd","1f64c-1f3fe","1f64c-1f3ff"],a:"0.6"},{n:["heart hands"],u:"1faf6",v:["1faf6-1f3fb","1faf6-1f3fc","1faf6-1f3fd","1faf6-1f3fe","1faf6-1f3ff"],a:"14.0"},{n:["open hands","open hands sign"],u:"1f450",v:["1f450-1f3fb","1f450-1f3fc","1f450-1f3fd","1f450-1f3fe","1f450-1f3ff"],a:"0.6"},{n:["palms up together"],u:"1f932",v:["1f932-1f3fb","1f932-1f3fc","1f932-1f3fd","1f932-1f3fe","1f932-1f3ff"],a:"5.0"},{n:["handshake"],u:"1f91d",v:["1f91d-1f3fb","1f91d-1f3fc","1f91d-1f3fd","1f91d-1f3fe","1f91d-1f3ff","1faf1-1f3fb-200d-1faf2-1f3fc","1faf1-1f3fb-200d-1faf2-1f3fd","1faf1-1f3fb-200d-1faf2-1f3fe","1faf1-1f3fb-200d-1faf2-1f3ff","1faf1-1f3fc-200d-1faf2-1f3fb","1faf1-1f3fc-200d-1faf2-1f3fd","1faf1-1f3fc-200d-1faf2-1f3fe","1faf1-1f3fc-200d-1faf2-1f3ff","1faf1-1f3fd-200d-1faf2-1f3fb","1faf1-1f3fd-200d-1faf2-1f3fc","1faf1-1f3fd-200d-1faf2-1f3fe","1faf1-1f3fd-200d-1faf2-1f3ff","1faf1-1f3fe-200d-1faf2-1f3fb","1faf1-1f3fe-200d-1faf2-1f3fc","1faf1-1f3fe-200d-1faf2-1f3fd","1faf1-1f3fe-200d-1faf2-1f3ff","1faf1-1f3ff-200d-1faf2-1f3fb","1faf1-1f3ff-200d-1faf2-1f3fc","1faf1-1f3ff-200d-1faf2-1f3fd","1faf1-1f3ff-200d-1faf2-1f3fe"],a:"3.0"},{n:["pray","person with folded hands"],u:"1f64f",v:["1f64f-1f3fb","1f64f-1f3fc","1f64f-1f3fd","1f64f-1f3fe","1f64f-1f3ff"],a:"0.6"},{n:["writing hand"],u:"270d-fe0f",v:["270d-1f3fb","270d-1f3fc","270d-1f3fd","270d-1f3fe","270d-1f3ff"],a:"0.7"},{n:["nail care","nail polish"],u:"1f485",v:["1f485-1f3fb","1f485-1f3fc","1f485-1f3fd","1f485-1f3fe","1f485-1f3ff"],a:"0.6"},{n:["selfie"],u:"1f933",v:["1f933-1f3fb","1f933-1f3fc","1f933-1f3fd","1f933-1f3fe","1f933-1f3ff"],a:"3.0"},{n:["muscle","flexed biceps"],u:"1f4aa",v:["1f4aa-1f3fb","1f4aa-1f3fc","1f4aa-1f3fd","1f4aa-1f3fe","1f4aa-1f3ff"],a:"0.6"},{n:["mechanical arm"],u:"1f9be",a:"12.0"},{n:["mechanical leg"],u:"1f9bf",a:"12.0"},{n:["leg"],u:"1f9b5",v:["1f9b5-1f3fb","1f9b5-1f3fc","1f9b5-1f3fd","1f9b5-1f3fe","1f9b5-1f3ff"],a:"11.0"},{n:["foot"],u:"1f9b6",v:["1f9b6-1f3fb","1f9b6-1f3fc","1f9b6-1f3fd","1f9b6-1f3fe","1f9b6-1f3ff"],a:"11.0"},{n:["ear"],u:"1f442",v:["1f442-1f3fb","1f442-1f3fc","1f442-1f3fd","1f442-1f3fe","1f442-1f3ff"],a:"0.6"},{n:["ear with hearing aid"],u:"1f9bb",v:["1f9bb-1f3fb","1f9bb-1f3fc","1f9bb-1f3fd","1f9bb-1f3fe","1f9bb-1f3ff"],a:"12.0"},{n:["nose"],u:"1f443",v:["1f443-1f3fb","1f443-1f3fc","1f443-1f3fd","1f443-1f3fe","1f443-1f3ff"],a:"0.6"},{n:["brain"],u:"1f9e0",a:"5.0"},{n:["anatomical heart"],u:"1fac0",a:"13.0"},{n:["lungs"],u:"1fac1",a:"13.0"},{n:["tooth"],u:"1f9b7",a:"11.0"},{n:["bone"],u:"1f9b4",a:"11.0"},{n:["eyes"],u:"1f440",a:"0.6"},{n:["eye"],u:"1f441-fe0f",a:"0.7"},{n:["tongue"],u:"1f445",a:"0.6"},{n:["lips","mouth"],u:"1f444",a:"0.6"},{n:["biting lip"],u:"1fae6",a:"14.0"},{n:["baby"],u:"1f476",v:["1f476-1f3fb","1f476-1f3fc","1f476-1f3fd","1f476-1f3fe","1f476-1f3ff"],a:"0.6"},{n:["child"],u:"1f9d2",v:["1f9d2-1f3fb","1f9d2-1f3fc","1f9d2-1f3fd","1f9d2-1f3fe","1f9d2-1f3ff"],a:"5.0"},{n:["boy"],u:"1f466",v:["1f466-1f3fb","1f466-1f3fc","1f466-1f3fd","1f466-1f3fe","1f466-1f3ff"],a:"0.6"},{n:["girl"],u:"1f467",v:["1f467-1f3fb","1f467-1f3fc","1f467-1f3fd","1f467-1f3fe","1f467-1f3ff"],a:"0.6"},{n:["adult"],u:"1f9d1",v:["1f9d1-1f3fb","1f9d1-1f3fc","1f9d1-1f3fd","1f9d1-1f3fe","1f9d1-1f3ff"],a:"5.0"},{n:["person with blond hair"],u:"1f471",v:["1f471-1f3fb","1f471-1f3fc","1f471-1f3fd","1f471-1f3fe","1f471-1f3ff"],a:"0.6"},{n:["man"],u:"1f468",v:["1f468-1f3fb","1f468-1f3fc","1f468-1f3fd","1f468-1f3fe","1f468-1f3ff"],a:"0.6"},{n:["bearded person"],u:"1f9d4",v:["1f9d4-1f3fb","1f9d4-1f3fc","1f9d4-1f3fd","1f9d4-1f3fe","1f9d4-1f3ff"],a:"5.0"},{n:["man: beard","man with beard"],u:"1f9d4-200d-2642-fe0f",v:["1f9d4-1f3fb-200d-2642-fe0f","1f9d4-1f3fc-200d-2642-fe0f","1f9d4-1f3fd-200d-2642-fe0f","1f9d4-1f3fe-200d-2642-fe0f","1f9d4-1f3ff-200d-2642-fe0f"],a:"13.1"},{n:["woman: beard","woman with beard"],u:"1f9d4-200d-2640-fe0f",v:["1f9d4-1f3fb-200d-2640-fe0f","1f9d4-1f3fc-200d-2640-fe0f","1f9d4-1f3fd-200d-2640-fe0f","1f9d4-1f3fe-200d-2640-fe0f","1f9d4-1f3ff-200d-2640-fe0f"],a:"13.1"},{n:["man: red hair","red haired man"],u:"1f468-200d-1f9b0",v:["1f468-1f3fb-200d-1f9b0","1f468-1f3fc-200d-1f9b0","1f468-1f3fd-200d-1f9b0","1f468-1f3fe-200d-1f9b0","1f468-1f3ff-200d-1f9b0"],a:"11.0"},{n:["man: curly hair","curly haired man"],u:"1f468-200d-1f9b1",v:["1f468-1f3fb-200d-1f9b1","1f468-1f3fc-200d-1f9b1","1f468-1f3fd-200d-1f9b1","1f468-1f3fe-200d-1f9b1","1f468-1f3ff-200d-1f9b1"],a:"11.0"},{n:["man: white hair","white haired man"],u:"1f468-200d-1f9b3",v:["1f468-1f3fb-200d-1f9b3","1f468-1f3fc-200d-1f9b3","1f468-1f3fd-200d-1f9b3","1f468-1f3fe-200d-1f9b3","1f468-1f3ff-200d-1f9b3"],a:"11.0"},{n:["bald man","man: bald"],u:"1f468-200d-1f9b2",v:["1f468-1f3fb-200d-1f9b2","1f468-1f3fc-200d-1f9b2","1f468-1f3fd-200d-1f9b2","1f468-1f3fe-200d-1f9b2","1f468-1f3ff-200d-1f9b2"],a:"11.0"},{n:["woman"],u:"1f469",v:["1f469-1f3fb","1f469-1f3fc","1f469-1f3fd","1f469-1f3fe","1f469-1f3ff"],a:"0.6"},{n:["woman: red hair","red haired woman"],u:"1f469-200d-1f9b0",v:["1f469-1f3fb-200d-1f9b0","1f469-1f3fc-200d-1f9b0","1f469-1f3fd-200d-1f9b0","1f469-1f3fe-200d-1f9b0","1f469-1f3ff-200d-1f9b0"],a:"11.0"},{n:["person: red hair","red haired person"],u:"1f9d1-200d-1f9b0",v:["1f9d1-1f3fb-200d-1f9b0","1f9d1-1f3fc-200d-1f9b0","1f9d1-1f3fd-200d-1f9b0","1f9d1-1f3fe-200d-1f9b0","1f9d1-1f3ff-200d-1f9b0"],a:"12.1"},{n:["woman: curly hair","curly haired woman"],u:"1f469-200d-1f9b1",v:["1f469-1f3fb-200d-1f9b1","1f469-1f3fc-200d-1f9b1","1f469-1f3fd-200d-1f9b1","1f469-1f3fe-200d-1f9b1","1f469-1f3ff-200d-1f9b1"],a:"11.0"},{n:["person: curly hair","curly haired person"],u:"1f9d1-200d-1f9b1",v:["1f9d1-1f3fb-200d-1f9b1","1f9d1-1f3fc-200d-1f9b1","1f9d1-1f3fd-200d-1f9b1","1f9d1-1f3fe-200d-1f9b1","1f9d1-1f3ff-200d-1f9b1"],a:"12.1"},{n:["woman: white hair","white haired woman"],u:"1f469-200d-1f9b3",v:["1f469-1f3fb-200d-1f9b3","1f469-1f3fc-200d-1f9b3","1f469-1f3fd-200d-1f9b3","1f469-1f3fe-200d-1f9b3","1f469-1f3ff-200d-1f9b3"],a:"11.0"},{n:["person: white hair","white haired person"],u:"1f9d1-200d-1f9b3",v:["1f9d1-1f3fb-200d-1f9b3","1f9d1-1f3fc-200d-1f9b3","1f9d1-1f3fd-200d-1f9b3","1f9d1-1f3fe-200d-1f9b3","1f9d1-1f3ff-200d-1f9b3"],a:"12.1"},{n:["bald woman","woman: bald"],u:"1f469-200d-1f9b2",v:["1f469-1f3fb-200d-1f9b2","1f469-1f3fc-200d-1f9b2","1f469-1f3fd-200d-1f9b2","1f469-1f3fe-200d-1f9b2","1f469-1f3ff-200d-1f9b2"],a:"11.0"},{n:["bald person","person: bald"],u:"1f9d1-200d-1f9b2",v:["1f9d1-1f3fb-200d-1f9b2","1f9d1-1f3fc-200d-1f9b2","1f9d1-1f3fd-200d-1f9b2","1f9d1-1f3fe-200d-1f9b2","1f9d1-1f3ff-200d-1f9b2"],a:"12.1"},{n:["woman: blond hair","blond-haired-woman"],u:"1f471-200d-2640-fe0f",v:["1f471-1f3fb-200d-2640-fe0f","1f471-1f3fc-200d-2640-fe0f","1f471-1f3fd-200d-2640-fe0f","1f471-1f3fe-200d-2640-fe0f","1f471-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["man: blond hair","blond-haired-man"],u:"1f471-200d-2642-fe0f",v:["1f471-1f3fb-200d-2642-fe0f","1f471-1f3fc-200d-2642-fe0f","1f471-1f3fd-200d-2642-fe0f","1f471-1f3fe-200d-2642-fe0f","1f471-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["older adult"],u:"1f9d3",v:["1f9d3-1f3fb","1f9d3-1f3fc","1f9d3-1f3fd","1f9d3-1f3fe","1f9d3-1f3ff"],a:"5.0"},{n:["older man"],u:"1f474",v:["1f474-1f3fb","1f474-1f3fc","1f474-1f3fd","1f474-1f3fe","1f474-1f3ff"],a:"0.6"},{n:["older woman"],u:"1f475",v:["1f475-1f3fb","1f475-1f3fc","1f475-1f3fd","1f475-1f3fe","1f475-1f3ff"],a:"0.6"},{n:["person frowning"],u:"1f64d",v:["1f64d-1f3fb","1f64d-1f3fc","1f64d-1f3fd","1f64d-1f3fe","1f64d-1f3ff"],a:"0.6"},{n:["man frowning","man-frowning"],u:"1f64d-200d-2642-fe0f",v:["1f64d-1f3fb-200d-2642-fe0f","1f64d-1f3fc-200d-2642-fe0f","1f64d-1f3fd-200d-2642-fe0f","1f64d-1f3fe-200d-2642-fe0f","1f64d-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman frowning","woman-frowning"],u:"1f64d-200d-2640-fe0f",v:["1f64d-1f3fb-200d-2640-fe0f","1f64d-1f3fc-200d-2640-fe0f","1f64d-1f3fd-200d-2640-fe0f","1f64d-1f3fe-200d-2640-fe0f","1f64d-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person with pouting face"],u:"1f64e",v:["1f64e-1f3fb","1f64e-1f3fc","1f64e-1f3fd","1f64e-1f3fe","1f64e-1f3ff"],a:"0.6"},{n:["man pouting","man-pouting"],u:"1f64e-200d-2642-fe0f",v:["1f64e-1f3fb-200d-2642-fe0f","1f64e-1f3fc-200d-2642-fe0f","1f64e-1f3fd-200d-2642-fe0f","1f64e-1f3fe-200d-2642-fe0f","1f64e-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman pouting","woman-pouting"],u:"1f64e-200d-2640-fe0f",v:["1f64e-1f3fb-200d-2640-fe0f","1f64e-1f3fc-200d-2640-fe0f","1f64e-1f3fd-200d-2640-fe0f","1f64e-1f3fe-200d-2640-fe0f","1f64e-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["no good","face with no good gesture"],u:"1f645",v:["1f645-1f3fb","1f645-1f3fc","1f645-1f3fd","1f645-1f3fe","1f645-1f3ff"],a:"0.6"},{n:["man gesturing no","man-gesturing-no"],u:"1f645-200d-2642-fe0f",v:["1f645-1f3fb-200d-2642-fe0f","1f645-1f3fc-200d-2642-fe0f","1f645-1f3fd-200d-2642-fe0f","1f645-1f3fe-200d-2642-fe0f","1f645-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman gesturing no","woman-gesturing-no"],u:"1f645-200d-2640-fe0f",v:["1f645-1f3fb-200d-2640-fe0f","1f645-1f3fc-200d-2640-fe0f","1f645-1f3fd-200d-2640-fe0f","1f645-1f3fe-200d-2640-fe0f","1f645-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["ok woman","face with ok gesture"],u:"1f646",v:["1f646-1f3fb","1f646-1f3fc","1f646-1f3fd","1f646-1f3fe","1f646-1f3ff"],a:"0.6"},{n:["man gesturing ok","man-gesturing-ok"],u:"1f646-200d-2642-fe0f",v:["1f646-1f3fb-200d-2642-fe0f","1f646-1f3fc-200d-2642-fe0f","1f646-1f3fd-200d-2642-fe0f","1f646-1f3fe-200d-2642-fe0f","1f646-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman gesturing ok","woman-gesturing-ok"],u:"1f646-200d-2640-fe0f",v:["1f646-1f3fb-200d-2640-fe0f","1f646-1f3fc-200d-2640-fe0f","1f646-1f3fd-200d-2640-fe0f","1f646-1f3fe-200d-2640-fe0f","1f646-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["information desk person"],u:"1f481",v:["1f481-1f3fb","1f481-1f3fc","1f481-1f3fd","1f481-1f3fe","1f481-1f3ff"],a:"0.6"},{n:["man tipping hand","man-tipping-hand"],u:"1f481-200d-2642-fe0f",v:["1f481-1f3fb-200d-2642-fe0f","1f481-1f3fc-200d-2642-fe0f","1f481-1f3fd-200d-2642-fe0f","1f481-1f3fe-200d-2642-fe0f","1f481-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman tipping hand","woman-tipping-hand"],u:"1f481-200d-2640-fe0f",v:["1f481-1f3fb-200d-2640-fe0f","1f481-1f3fc-200d-2640-fe0f","1f481-1f3fd-200d-2640-fe0f","1f481-1f3fe-200d-2640-fe0f","1f481-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["raising hand","happy person raising one hand"],u:"1f64b",v:["1f64b-1f3fb","1f64b-1f3fc","1f64b-1f3fd","1f64b-1f3fe","1f64b-1f3ff"],a:"0.6"},{n:["man raising hand","man-raising-hand"],u:"1f64b-200d-2642-fe0f",v:["1f64b-1f3fb-200d-2642-fe0f","1f64b-1f3fc-200d-2642-fe0f","1f64b-1f3fd-200d-2642-fe0f","1f64b-1f3fe-200d-2642-fe0f","1f64b-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman raising hand","woman-raising-hand"],u:"1f64b-200d-2640-fe0f",v:["1f64b-1f3fb-200d-2640-fe0f","1f64b-1f3fc-200d-2640-fe0f","1f64b-1f3fd-200d-2640-fe0f","1f64b-1f3fe-200d-2640-fe0f","1f64b-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["deaf person"],u:"1f9cf",v:["1f9cf-1f3fb","1f9cf-1f3fc","1f9cf-1f3fd","1f9cf-1f3fe","1f9cf-1f3ff"],a:"12.0"},{n:["deaf man"],u:"1f9cf-200d-2642-fe0f",v:["1f9cf-1f3fb-200d-2642-fe0f","1f9cf-1f3fc-200d-2642-fe0f","1f9cf-1f3fd-200d-2642-fe0f","1f9cf-1f3fe-200d-2642-fe0f","1f9cf-1f3ff-200d-2642-fe0f"],a:"12.0"},{n:["deaf woman"],u:"1f9cf-200d-2640-fe0f",v:["1f9cf-1f3fb-200d-2640-fe0f","1f9cf-1f3fc-200d-2640-fe0f","1f9cf-1f3fd-200d-2640-fe0f","1f9cf-1f3fe-200d-2640-fe0f","1f9cf-1f3ff-200d-2640-fe0f"],a:"12.0"},{n:["bow","person bowing deeply"],u:"1f647",v:["1f647-1f3fb","1f647-1f3fc","1f647-1f3fd","1f647-1f3fe","1f647-1f3ff"],a:"0.6"},{n:["man bowing","man-bowing"],u:"1f647-200d-2642-fe0f",v:["1f647-1f3fb-200d-2642-fe0f","1f647-1f3fc-200d-2642-fe0f","1f647-1f3fd-200d-2642-fe0f","1f647-1f3fe-200d-2642-fe0f","1f647-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman bowing","woman-bowing"],u:"1f647-200d-2640-fe0f",v:["1f647-1f3fb-200d-2640-fe0f","1f647-1f3fc-200d-2640-fe0f","1f647-1f3fd-200d-2640-fe0f","1f647-1f3fe-200d-2640-fe0f","1f647-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["face palm"],u:"1f926",v:["1f926-1f3fb","1f926-1f3fc","1f926-1f3fd","1f926-1f3fe","1f926-1f3ff"],a:"3.0"},{n:["man facepalming","man-facepalming"],u:"1f926-200d-2642-fe0f",v:["1f926-1f3fb-200d-2642-fe0f","1f926-1f3fc-200d-2642-fe0f","1f926-1f3fd-200d-2642-fe0f","1f926-1f3fe-200d-2642-fe0f","1f926-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman facepalming","woman-facepalming"],u:"1f926-200d-2640-fe0f",v:["1f926-1f3fb-200d-2640-fe0f","1f926-1f3fc-200d-2640-fe0f","1f926-1f3fd-200d-2640-fe0f","1f926-1f3fe-200d-2640-fe0f","1f926-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["shrug"],u:"1f937",v:["1f937-1f3fb","1f937-1f3fc","1f937-1f3fd","1f937-1f3fe","1f937-1f3ff"],a:"3.0"},{n:["man shrugging","man-shrugging"],u:"1f937-200d-2642-fe0f",v:["1f937-1f3fb-200d-2642-fe0f","1f937-1f3fc-200d-2642-fe0f","1f937-1f3fd-200d-2642-fe0f","1f937-1f3fe-200d-2642-fe0f","1f937-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman shrugging","woman-shrugging"],u:"1f937-200d-2640-fe0f",v:["1f937-1f3fb-200d-2640-fe0f","1f937-1f3fc-200d-2640-fe0f","1f937-1f3fd-200d-2640-fe0f","1f937-1f3fe-200d-2640-fe0f","1f937-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["health worker"],u:"1f9d1-200d-2695-fe0f",v:["1f9d1-1f3fb-200d-2695-fe0f","1f9d1-1f3fc-200d-2695-fe0f","1f9d1-1f3fd-200d-2695-fe0f","1f9d1-1f3fe-200d-2695-fe0f","1f9d1-1f3ff-200d-2695-fe0f"],a:"12.1"},{n:["male-doctor","man health worker"],u:"1f468-200d-2695-fe0f",v:["1f468-1f3fb-200d-2695-fe0f","1f468-1f3fc-200d-2695-fe0f","1f468-1f3fd-200d-2695-fe0f","1f468-1f3fe-200d-2695-fe0f","1f468-1f3ff-200d-2695-fe0f"],a:"4.0"},{n:["female-doctor","woman health worker"],u:"1f469-200d-2695-fe0f",v:["1f469-1f3fb-200d-2695-fe0f","1f469-1f3fc-200d-2695-fe0f","1f469-1f3fd-200d-2695-fe0f","1f469-1f3fe-200d-2695-fe0f","1f469-1f3ff-200d-2695-fe0f"],a:"4.0"},{n:["student"],u:"1f9d1-200d-1f393",v:["1f9d1-1f3fb-200d-1f393","1f9d1-1f3fc-200d-1f393","1f9d1-1f3fd-200d-1f393","1f9d1-1f3fe-200d-1f393","1f9d1-1f3ff-200d-1f393"],a:"12.1"},{n:["man student","male-student"],u:"1f468-200d-1f393",v:["1f468-1f3fb-200d-1f393","1f468-1f3fc-200d-1f393","1f468-1f3fd-200d-1f393","1f468-1f3fe-200d-1f393","1f468-1f3ff-200d-1f393"],a:"4.0"},{n:["woman student","female-student"],u:"1f469-200d-1f393",v:["1f469-1f3fb-200d-1f393","1f469-1f3fc-200d-1f393","1f469-1f3fd-200d-1f393","1f469-1f3fe-200d-1f393","1f469-1f3ff-200d-1f393"],a:"4.0"},{n:["teacher"],u:"1f9d1-200d-1f3eb",v:["1f9d1-1f3fb-200d-1f3eb","1f9d1-1f3fc-200d-1f3eb","1f9d1-1f3fd-200d-1f3eb","1f9d1-1f3fe-200d-1f3eb","1f9d1-1f3ff-200d-1f3eb"],a:"12.1"},{n:["man teacher","male-teacher"],u:"1f468-200d-1f3eb",v:["1f468-1f3fb-200d-1f3eb","1f468-1f3fc-200d-1f3eb","1f468-1f3fd-200d-1f3eb","1f468-1f3fe-200d-1f3eb","1f468-1f3ff-200d-1f3eb"],a:"4.0"},{n:["woman teacher","female-teacher"],u:"1f469-200d-1f3eb",v:["1f469-1f3fb-200d-1f3eb","1f469-1f3fc-200d-1f3eb","1f469-1f3fd-200d-1f3eb","1f469-1f3fe-200d-1f3eb","1f469-1f3ff-200d-1f3eb"],a:"4.0"},{n:["judge"],u:"1f9d1-200d-2696-fe0f",v:["1f9d1-1f3fb-200d-2696-fe0f","1f9d1-1f3fc-200d-2696-fe0f","1f9d1-1f3fd-200d-2696-fe0f","1f9d1-1f3fe-200d-2696-fe0f","1f9d1-1f3ff-200d-2696-fe0f"],a:"12.1"},{n:["man judge","male-judge"],u:"1f468-200d-2696-fe0f",v:["1f468-1f3fb-200d-2696-fe0f","1f468-1f3fc-200d-2696-fe0f","1f468-1f3fd-200d-2696-fe0f","1f468-1f3fe-200d-2696-fe0f","1f468-1f3ff-200d-2696-fe0f"],a:"4.0"},{n:["woman judge","female-judge"],u:"1f469-200d-2696-fe0f",v:["1f469-1f3fb-200d-2696-fe0f","1f469-1f3fc-200d-2696-fe0f","1f469-1f3fd-200d-2696-fe0f","1f469-1f3fe-200d-2696-fe0f","1f469-1f3ff-200d-2696-fe0f"],a:"4.0"},{n:["farmer"],u:"1f9d1-200d-1f33e",v:["1f9d1-1f3fb-200d-1f33e","1f9d1-1f3fc-200d-1f33e","1f9d1-1f3fd-200d-1f33e","1f9d1-1f3fe-200d-1f33e","1f9d1-1f3ff-200d-1f33e"],a:"12.1"},{n:["man farmer","male-farmer"],u:"1f468-200d-1f33e",v:["1f468-1f3fb-200d-1f33e","1f468-1f3fc-200d-1f33e","1f468-1f3fd-200d-1f33e","1f468-1f3fe-200d-1f33e","1f468-1f3ff-200d-1f33e"],a:"4.0"},{n:["woman farmer","female-farmer"],u:"1f469-200d-1f33e",v:["1f469-1f3fb-200d-1f33e","1f469-1f3fc-200d-1f33e","1f469-1f3fd-200d-1f33e","1f469-1f3fe-200d-1f33e","1f469-1f3ff-200d-1f33e"],a:"4.0"},{n:["cook"],u:"1f9d1-200d-1f373",v:["1f9d1-1f3fb-200d-1f373","1f9d1-1f3fc-200d-1f373","1f9d1-1f3fd-200d-1f373","1f9d1-1f3fe-200d-1f373","1f9d1-1f3ff-200d-1f373"],a:"12.1"},{n:["man cook","male-cook"],u:"1f468-200d-1f373",v:["1f468-1f3fb-200d-1f373","1f468-1f3fc-200d-1f373","1f468-1f3fd-200d-1f373","1f468-1f3fe-200d-1f373","1f468-1f3ff-200d-1f373"],a:"4.0"},{n:["woman cook","female-cook"],u:"1f469-200d-1f373",v:["1f469-1f3fb-200d-1f373","1f469-1f3fc-200d-1f373","1f469-1f3fd-200d-1f373","1f469-1f3fe-200d-1f373","1f469-1f3ff-200d-1f373"],a:"4.0"},{n:["mechanic"],u:"1f9d1-200d-1f527",v:["1f9d1-1f3fb-200d-1f527","1f9d1-1f3fc-200d-1f527","1f9d1-1f3fd-200d-1f527","1f9d1-1f3fe-200d-1f527","1f9d1-1f3ff-200d-1f527"],a:"12.1"},{n:["man mechanic","male-mechanic"],u:"1f468-200d-1f527",v:["1f468-1f3fb-200d-1f527","1f468-1f3fc-200d-1f527","1f468-1f3fd-200d-1f527","1f468-1f3fe-200d-1f527","1f468-1f3ff-200d-1f527"],a:"4.0"},{n:["woman mechanic","female-mechanic"],u:"1f469-200d-1f527",v:["1f469-1f3fb-200d-1f527","1f469-1f3fc-200d-1f527","1f469-1f3fd-200d-1f527","1f469-1f3fe-200d-1f527","1f469-1f3ff-200d-1f527"],a:"4.0"},{n:["factory worker"],u:"1f9d1-200d-1f3ed",v:["1f9d1-1f3fb-200d-1f3ed","1f9d1-1f3fc-200d-1f3ed","1f9d1-1f3fd-200d-1f3ed","1f9d1-1f3fe-200d-1f3ed","1f9d1-1f3ff-200d-1f3ed"],a:"12.1"},{n:["man factory worker","male-factory-worker"],u:"1f468-200d-1f3ed",v:["1f468-1f3fb-200d-1f3ed","1f468-1f3fc-200d-1f3ed","1f468-1f3fd-200d-1f3ed","1f468-1f3fe-200d-1f3ed","1f468-1f3ff-200d-1f3ed"],a:"4.0"},{n:["woman factory worker","female-factory-worker"],u:"1f469-200d-1f3ed",v:["1f469-1f3fb-200d-1f3ed","1f469-1f3fc-200d-1f3ed","1f469-1f3fd-200d-1f3ed","1f469-1f3fe-200d-1f3ed","1f469-1f3ff-200d-1f3ed"],a:"4.0"},{n:["office worker"],u:"1f9d1-200d-1f4bc",v:["1f9d1-1f3fb-200d-1f4bc","1f9d1-1f3fc-200d-1f4bc","1f9d1-1f3fd-200d-1f4bc","1f9d1-1f3fe-200d-1f4bc","1f9d1-1f3ff-200d-1f4bc"],a:"12.1"},{n:["man office worker","male-office-worker"],u:"1f468-200d-1f4bc",v:["1f468-1f3fb-200d-1f4bc","1f468-1f3fc-200d-1f4bc","1f468-1f3fd-200d-1f4bc","1f468-1f3fe-200d-1f4bc","1f468-1f3ff-200d-1f4bc"],a:"4.0"},{n:["woman office worker","female-office-worker"],u:"1f469-200d-1f4bc",v:["1f469-1f3fb-200d-1f4bc","1f469-1f3fc-200d-1f4bc","1f469-1f3fd-200d-1f4bc","1f469-1f3fe-200d-1f4bc","1f469-1f3ff-200d-1f4bc"],a:"4.0"},{n:["scientist"],u:"1f9d1-200d-1f52c",v:["1f9d1-1f3fb-200d-1f52c","1f9d1-1f3fc-200d-1f52c","1f9d1-1f3fd-200d-1f52c","1f9d1-1f3fe-200d-1f52c","1f9d1-1f3ff-200d-1f52c"],a:"12.1"},{n:["man scientist","male-scientist"],u:"1f468-200d-1f52c",v:["1f468-1f3fb-200d-1f52c","1f468-1f3fc-200d-1f52c","1f468-1f3fd-200d-1f52c","1f468-1f3fe-200d-1f52c","1f468-1f3ff-200d-1f52c"],a:"4.0"},{n:["woman scientist","female-scientist"],u:"1f469-200d-1f52c",v:["1f469-1f3fb-200d-1f52c","1f469-1f3fc-200d-1f52c","1f469-1f3fd-200d-1f52c","1f469-1f3fe-200d-1f52c","1f469-1f3ff-200d-1f52c"],a:"4.0"},{n:["technologist"],u:"1f9d1-200d-1f4bb",v:["1f9d1-1f3fb-200d-1f4bb","1f9d1-1f3fc-200d-1f4bb","1f9d1-1f3fd-200d-1f4bb","1f9d1-1f3fe-200d-1f4bb","1f9d1-1f3ff-200d-1f4bb"],a:"12.1"},{n:["man technologist","male-technologist"],u:"1f468-200d-1f4bb",v:["1f468-1f3fb-200d-1f4bb","1f468-1f3fc-200d-1f4bb","1f468-1f3fd-200d-1f4bb","1f468-1f3fe-200d-1f4bb","1f468-1f3ff-200d-1f4bb"],a:"4.0"},{n:["woman technologist","female-technologist"],u:"1f469-200d-1f4bb",v:["1f469-1f3fb-200d-1f4bb","1f469-1f3fc-200d-1f4bb","1f469-1f3fd-200d-1f4bb","1f469-1f3fe-200d-1f4bb","1f469-1f3ff-200d-1f4bb"],a:"4.0"},{n:["singer"],u:"1f9d1-200d-1f3a4",v:["1f9d1-1f3fb-200d-1f3a4","1f9d1-1f3fc-200d-1f3a4","1f9d1-1f3fd-200d-1f3a4","1f9d1-1f3fe-200d-1f3a4","1f9d1-1f3ff-200d-1f3a4"],a:"12.1"},{n:["man singer","male-singer"],u:"1f468-200d-1f3a4",v:["1f468-1f3fb-200d-1f3a4","1f468-1f3fc-200d-1f3a4","1f468-1f3fd-200d-1f3a4","1f468-1f3fe-200d-1f3a4","1f468-1f3ff-200d-1f3a4"],a:"4.0"},{n:["woman singer","female-singer"],u:"1f469-200d-1f3a4",v:["1f469-1f3fb-200d-1f3a4","1f469-1f3fc-200d-1f3a4","1f469-1f3fd-200d-1f3a4","1f469-1f3fe-200d-1f3a4","1f469-1f3ff-200d-1f3a4"],a:"4.0"},{n:["artist"],u:"1f9d1-200d-1f3a8",v:["1f9d1-1f3fb-200d-1f3a8","1f9d1-1f3fc-200d-1f3a8","1f9d1-1f3fd-200d-1f3a8","1f9d1-1f3fe-200d-1f3a8","1f9d1-1f3ff-200d-1f3a8"],a:"12.1"},{n:["man artist","male-artist"],u:"1f468-200d-1f3a8",v:["1f468-1f3fb-200d-1f3a8","1f468-1f3fc-200d-1f3a8","1f468-1f3fd-200d-1f3a8","1f468-1f3fe-200d-1f3a8","1f468-1f3ff-200d-1f3a8"],a:"4.0"},{n:["woman artist","female-artist"],u:"1f469-200d-1f3a8",v:["1f469-1f3fb-200d-1f3a8","1f469-1f3fc-200d-1f3a8","1f469-1f3fd-200d-1f3a8","1f469-1f3fe-200d-1f3a8","1f469-1f3ff-200d-1f3a8"],a:"4.0"},{n:["pilot"],u:"1f9d1-200d-2708-fe0f",v:["1f9d1-1f3fb-200d-2708-fe0f","1f9d1-1f3fc-200d-2708-fe0f","1f9d1-1f3fd-200d-2708-fe0f","1f9d1-1f3fe-200d-2708-fe0f","1f9d1-1f3ff-200d-2708-fe0f"],a:"12.1"},{n:["man pilot","male-pilot"],u:"1f468-200d-2708-fe0f",v:["1f468-1f3fb-200d-2708-fe0f","1f468-1f3fc-200d-2708-fe0f","1f468-1f3fd-200d-2708-fe0f","1f468-1f3fe-200d-2708-fe0f","1f468-1f3ff-200d-2708-fe0f"],a:"4.0"},{n:["woman pilot","female-pilot"],u:"1f469-200d-2708-fe0f",v:["1f469-1f3fb-200d-2708-fe0f","1f469-1f3fc-200d-2708-fe0f","1f469-1f3fd-200d-2708-fe0f","1f469-1f3fe-200d-2708-fe0f","1f469-1f3ff-200d-2708-fe0f"],a:"4.0"},{n:["astronaut"],u:"1f9d1-200d-1f680",v:["1f9d1-1f3fb-200d-1f680","1f9d1-1f3fc-200d-1f680","1f9d1-1f3fd-200d-1f680","1f9d1-1f3fe-200d-1f680","1f9d1-1f3ff-200d-1f680"],a:"12.1"},{n:["man astronaut","male-astronaut"],u:"1f468-200d-1f680",v:["1f468-1f3fb-200d-1f680","1f468-1f3fc-200d-1f680","1f468-1f3fd-200d-1f680","1f468-1f3fe-200d-1f680","1f468-1f3ff-200d-1f680"],a:"4.0"},{n:["woman astronaut","female-astronaut"],u:"1f469-200d-1f680",v:["1f469-1f3fb-200d-1f680","1f469-1f3fc-200d-1f680","1f469-1f3fd-200d-1f680","1f469-1f3fe-200d-1f680","1f469-1f3ff-200d-1f680"],a:"4.0"},{n:["firefighter"],u:"1f9d1-200d-1f692",v:["1f9d1-1f3fb-200d-1f692","1f9d1-1f3fc-200d-1f692","1f9d1-1f3fd-200d-1f692","1f9d1-1f3fe-200d-1f692","1f9d1-1f3ff-200d-1f692"],a:"12.1"},{n:["man firefighter","male-firefighter"],u:"1f468-200d-1f692",v:["1f468-1f3fb-200d-1f692","1f468-1f3fc-200d-1f692","1f468-1f3fd-200d-1f692","1f468-1f3fe-200d-1f692","1f468-1f3ff-200d-1f692"],a:"4.0"},{n:["woman firefighter","female-firefighter"],u:"1f469-200d-1f692",v:["1f469-1f3fb-200d-1f692","1f469-1f3fc-200d-1f692","1f469-1f3fd-200d-1f692","1f469-1f3fe-200d-1f692","1f469-1f3ff-200d-1f692"],a:"4.0"},{n:["cop","police officer"],u:"1f46e",v:["1f46e-1f3fb","1f46e-1f3fc","1f46e-1f3fd","1f46e-1f3fe","1f46e-1f3ff"],a:"0.6"},{n:["man police officer","male-police-officer"],u:"1f46e-200d-2642-fe0f",v:["1f46e-1f3fb-200d-2642-fe0f","1f46e-1f3fc-200d-2642-fe0f","1f46e-1f3fd-200d-2642-fe0f","1f46e-1f3fe-200d-2642-fe0f","1f46e-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman police officer","female-police-officer"],u:"1f46e-200d-2640-fe0f",v:["1f46e-1f3fb-200d-2640-fe0f","1f46e-1f3fc-200d-2640-fe0f","1f46e-1f3fd-200d-2640-fe0f","1f46e-1f3fe-200d-2640-fe0f","1f46e-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["detective","sleuth or spy"],u:"1f575-fe0f",v:["1f575-1f3fb","1f575-1f3fc","1f575-1f3fd","1f575-1f3fe","1f575-1f3ff"],a:"0.7"},{n:["man detective","male-detective"],u:"1f575-fe0f-200d-2642-fe0f",v:["1f575-1f3fb-200d-2642-fe0f","1f575-1f3fc-200d-2642-fe0f","1f575-1f3fd-200d-2642-fe0f","1f575-1f3fe-200d-2642-fe0f","1f575-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman detective","female-detective"],u:"1f575-fe0f-200d-2640-fe0f",v:["1f575-1f3fb-200d-2640-fe0f","1f575-1f3fc-200d-2640-fe0f","1f575-1f3fd-200d-2640-fe0f","1f575-1f3fe-200d-2640-fe0f","1f575-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["guardsman"],u:"1f482",v:["1f482-1f3fb","1f482-1f3fc","1f482-1f3fd","1f482-1f3fe","1f482-1f3ff"],a:"0.6"},{n:["man guard","male-guard"],u:"1f482-200d-2642-fe0f",v:["1f482-1f3fb-200d-2642-fe0f","1f482-1f3fc-200d-2642-fe0f","1f482-1f3fd-200d-2642-fe0f","1f482-1f3fe-200d-2642-fe0f","1f482-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman guard","female-guard"],u:"1f482-200d-2640-fe0f",v:["1f482-1f3fb-200d-2640-fe0f","1f482-1f3fc-200d-2640-fe0f","1f482-1f3fd-200d-2640-fe0f","1f482-1f3fe-200d-2640-fe0f","1f482-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["ninja"],u:"1f977",v:["1f977-1f3fb","1f977-1f3fc","1f977-1f3fd","1f977-1f3fe","1f977-1f3ff"],a:"13.0"},{n:["construction worker"],u:"1f477",v:["1f477-1f3fb","1f477-1f3fc","1f477-1f3fd","1f477-1f3fe","1f477-1f3ff"],a:"0.6"},{n:["man construction worker","male-construction-worker"],u:"1f477-200d-2642-fe0f",v:["1f477-1f3fb-200d-2642-fe0f","1f477-1f3fc-200d-2642-fe0f","1f477-1f3fd-200d-2642-fe0f","1f477-1f3fe-200d-2642-fe0f","1f477-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman construction worker","female-construction-worker"],u:"1f477-200d-2640-fe0f",v:["1f477-1f3fb-200d-2640-fe0f","1f477-1f3fc-200d-2640-fe0f","1f477-1f3fd-200d-2640-fe0f","1f477-1f3fe-200d-2640-fe0f","1f477-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person with crown"],u:"1fac5",v:["1fac5-1f3fb","1fac5-1f3fc","1fac5-1f3fd","1fac5-1f3fe","1fac5-1f3ff"],a:"14.0"},{n:["prince"],u:"1f934",v:["1f934-1f3fb","1f934-1f3fc","1f934-1f3fd","1f934-1f3fe","1f934-1f3ff"],a:"3.0"},{n:["princess"],u:"1f478",v:["1f478-1f3fb","1f478-1f3fc","1f478-1f3fd","1f478-1f3fe","1f478-1f3ff"],a:"0.6"},{n:["man with turban"],u:"1f473",v:["1f473-1f3fb","1f473-1f3fc","1f473-1f3fd","1f473-1f3fe","1f473-1f3ff"],a:"0.6"},{n:["man wearing turban","man-wearing-turban"],u:"1f473-200d-2642-fe0f",v:["1f473-1f3fb-200d-2642-fe0f","1f473-1f3fc-200d-2642-fe0f","1f473-1f3fd-200d-2642-fe0f","1f473-1f3fe-200d-2642-fe0f","1f473-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman wearing turban","woman-wearing-turban"],u:"1f473-200d-2640-fe0f",v:["1f473-1f3fb-200d-2640-fe0f","1f473-1f3fc-200d-2640-fe0f","1f473-1f3fd-200d-2640-fe0f","1f473-1f3fe-200d-2640-fe0f","1f473-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["man with gua pi mao"],u:"1f472",v:["1f472-1f3fb","1f472-1f3fc","1f472-1f3fd","1f472-1f3fe","1f472-1f3ff"],a:"0.6"},{n:["person with headscarf"],u:"1f9d5",v:["1f9d5-1f3fb","1f9d5-1f3fc","1f9d5-1f3fd","1f9d5-1f3fe","1f9d5-1f3ff"],a:"5.0"},{n:["man in tuxedo","person in tuxedo"],u:"1f935",v:["1f935-1f3fb","1f935-1f3fc","1f935-1f3fd","1f935-1f3fe","1f935-1f3ff"],a:"3.0"},{n:["man in tuxedo"],u:"1f935-200d-2642-fe0f",v:["1f935-1f3fb-200d-2642-fe0f","1f935-1f3fc-200d-2642-fe0f","1f935-1f3fd-200d-2642-fe0f","1f935-1f3fe-200d-2642-fe0f","1f935-1f3ff-200d-2642-fe0f"],a:"13.0"},{n:["woman in tuxedo"],u:"1f935-200d-2640-fe0f",v:["1f935-1f3fb-200d-2640-fe0f","1f935-1f3fc-200d-2640-fe0f","1f935-1f3fd-200d-2640-fe0f","1f935-1f3fe-200d-2640-fe0f","1f935-1f3ff-200d-2640-fe0f"],a:"13.0"},{n:["bride with veil"],u:"1f470",v:["1f470-1f3fb","1f470-1f3fc","1f470-1f3fd","1f470-1f3fe","1f470-1f3ff"],a:"0.6"},{n:["man with veil"],u:"1f470-200d-2642-fe0f",v:["1f470-1f3fb-200d-2642-fe0f","1f470-1f3fc-200d-2642-fe0f","1f470-1f3fd-200d-2642-fe0f","1f470-1f3fe-200d-2642-fe0f","1f470-1f3ff-200d-2642-fe0f"],a:"13.0"},{n:["woman with veil"],u:"1f470-200d-2640-fe0f",v:["1f470-1f3fb-200d-2640-fe0f","1f470-1f3fc-200d-2640-fe0f","1f470-1f3fd-200d-2640-fe0f","1f470-1f3fe-200d-2640-fe0f","1f470-1f3ff-200d-2640-fe0f"],a:"13.0"},{n:["pregnant woman"],u:"1f930",v:["1f930-1f3fb","1f930-1f3fc","1f930-1f3fd","1f930-1f3fe","1f930-1f3ff"],a:"3.0"},{n:["pregnant man"],u:"1fac3",v:["1fac3-1f3fb","1fac3-1f3fc","1fac3-1f3fd","1fac3-1f3fe","1fac3-1f3ff"],a:"14.0"},{n:["pregnant person"],u:"1fac4",v:["1fac4-1f3fb","1fac4-1f3fc","1fac4-1f3fd","1fac4-1f3fe","1fac4-1f3ff"],a:"14.0"},{n:["breast-feeding"],u:"1f931",v:["1f931-1f3fb","1f931-1f3fc","1f931-1f3fd","1f931-1f3fe","1f931-1f3ff"],a:"5.0"},{n:["woman feeding baby"],u:"1f469-200d-1f37c",v:["1f469-1f3fb-200d-1f37c","1f469-1f3fc-200d-1f37c","1f469-1f3fd-200d-1f37c","1f469-1f3fe-200d-1f37c","1f469-1f3ff-200d-1f37c"],a:"13.0"},{n:["man feeding baby"],u:"1f468-200d-1f37c",v:["1f468-1f3fb-200d-1f37c","1f468-1f3fc-200d-1f37c","1f468-1f3fd-200d-1f37c","1f468-1f3fe-200d-1f37c","1f468-1f3ff-200d-1f37c"],a:"13.0"},{n:["person feeding baby"],u:"1f9d1-200d-1f37c",v:["1f9d1-1f3fb-200d-1f37c","1f9d1-1f3fc-200d-1f37c","1f9d1-1f3fd-200d-1f37c","1f9d1-1f3fe-200d-1f37c","1f9d1-1f3ff-200d-1f37c"],a:"13.0"},{n:["angel","baby angel"],u:"1f47c",v:["1f47c-1f3fb","1f47c-1f3fc","1f47c-1f3fd","1f47c-1f3fe","1f47c-1f3ff"],a:"0.6"},{n:["santa","father christmas"],u:"1f385",v:["1f385-1f3fb","1f385-1f3fc","1f385-1f3fd","1f385-1f3fe","1f385-1f3ff"],a:"0.6"},{n:["mrs claus","mother christmas"],u:"1f936",v:["1f936-1f3fb","1f936-1f3fc","1f936-1f3fd","1f936-1f3fe","1f936-1f3ff"],a:"3.0"},{n:["mx claus"],u:"1f9d1-200d-1f384",v:["1f9d1-1f3fb-200d-1f384","1f9d1-1f3fc-200d-1f384","1f9d1-1f3fd-200d-1f384","1f9d1-1f3fe-200d-1f384","1f9d1-1f3ff-200d-1f384"],a:"13.0"},{n:["superhero"],u:"1f9b8",v:["1f9b8-1f3fb","1f9b8-1f3fc","1f9b8-1f3fd","1f9b8-1f3fe","1f9b8-1f3ff"],a:"11.0"},{n:["man superhero","male superhero"],u:"1f9b8-200d-2642-fe0f",v:["1f9b8-1f3fb-200d-2642-fe0f","1f9b8-1f3fc-200d-2642-fe0f","1f9b8-1f3fd-200d-2642-fe0f","1f9b8-1f3fe-200d-2642-fe0f","1f9b8-1f3ff-200d-2642-fe0f"],a:"11.0"},{n:["woman superhero","female superhero"],u:"1f9b8-200d-2640-fe0f",v:["1f9b8-1f3fb-200d-2640-fe0f","1f9b8-1f3fc-200d-2640-fe0f","1f9b8-1f3fd-200d-2640-fe0f","1f9b8-1f3fe-200d-2640-fe0f","1f9b8-1f3ff-200d-2640-fe0f"],a:"11.0"},{n:["supervillain"],u:"1f9b9",v:["1f9b9-1f3fb","1f9b9-1f3fc","1f9b9-1f3fd","1f9b9-1f3fe","1f9b9-1f3ff"],a:"11.0"},{n:["man supervillain","male supervillain"],u:"1f9b9-200d-2642-fe0f",v:["1f9b9-1f3fb-200d-2642-fe0f","1f9b9-1f3fc-200d-2642-fe0f","1f9b9-1f3fd-200d-2642-fe0f","1f9b9-1f3fe-200d-2642-fe0f","1f9b9-1f3ff-200d-2642-fe0f"],a:"11.0"},{n:["woman supervillain","female supervillain"],u:"1f9b9-200d-2640-fe0f",v:["1f9b9-1f3fb-200d-2640-fe0f","1f9b9-1f3fc-200d-2640-fe0f","1f9b9-1f3fd-200d-2640-fe0f","1f9b9-1f3fe-200d-2640-fe0f","1f9b9-1f3ff-200d-2640-fe0f"],a:"11.0"},{n:["mage"],u:"1f9d9",v:["1f9d9-1f3fb","1f9d9-1f3fc","1f9d9-1f3fd","1f9d9-1f3fe","1f9d9-1f3ff"],a:"5.0"},{n:["man mage","male mage"],u:"1f9d9-200d-2642-fe0f",v:["1f9d9-1f3fb-200d-2642-fe0f","1f9d9-1f3fc-200d-2642-fe0f","1f9d9-1f3fd-200d-2642-fe0f","1f9d9-1f3fe-200d-2642-fe0f","1f9d9-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman mage","female mage"],u:"1f9d9-200d-2640-fe0f",v:["1f9d9-1f3fb-200d-2640-fe0f","1f9d9-1f3fc-200d-2640-fe0f","1f9d9-1f3fd-200d-2640-fe0f","1f9d9-1f3fe-200d-2640-fe0f","1f9d9-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["fairy"],u:"1f9da",v:["1f9da-1f3fb","1f9da-1f3fc","1f9da-1f3fd","1f9da-1f3fe","1f9da-1f3ff"],a:"5.0"},{n:["man fairy","male fairy"],u:"1f9da-200d-2642-fe0f",v:["1f9da-1f3fb-200d-2642-fe0f","1f9da-1f3fc-200d-2642-fe0f","1f9da-1f3fd-200d-2642-fe0f","1f9da-1f3fe-200d-2642-fe0f","1f9da-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman fairy","female fairy"],u:"1f9da-200d-2640-fe0f",v:["1f9da-1f3fb-200d-2640-fe0f","1f9da-1f3fc-200d-2640-fe0f","1f9da-1f3fd-200d-2640-fe0f","1f9da-1f3fe-200d-2640-fe0f","1f9da-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["vampire"],u:"1f9db",v:["1f9db-1f3fb","1f9db-1f3fc","1f9db-1f3fd","1f9db-1f3fe","1f9db-1f3ff"],a:"5.0"},{n:["man vampire","male vampire"],u:"1f9db-200d-2642-fe0f",v:["1f9db-1f3fb-200d-2642-fe0f","1f9db-1f3fc-200d-2642-fe0f","1f9db-1f3fd-200d-2642-fe0f","1f9db-1f3fe-200d-2642-fe0f","1f9db-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman vampire","female vampire"],u:"1f9db-200d-2640-fe0f",v:["1f9db-1f3fb-200d-2640-fe0f","1f9db-1f3fc-200d-2640-fe0f","1f9db-1f3fd-200d-2640-fe0f","1f9db-1f3fe-200d-2640-fe0f","1f9db-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["merperson"],u:"1f9dc",v:["1f9dc-1f3fb","1f9dc-1f3fc","1f9dc-1f3fd","1f9dc-1f3fe","1f9dc-1f3ff"],a:"5.0"},{n:["merman"],u:"1f9dc-200d-2642-fe0f",v:["1f9dc-1f3fb-200d-2642-fe0f","1f9dc-1f3fc-200d-2642-fe0f","1f9dc-1f3fd-200d-2642-fe0f","1f9dc-1f3fe-200d-2642-fe0f","1f9dc-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["mermaid"],u:"1f9dc-200d-2640-fe0f",v:["1f9dc-1f3fb-200d-2640-fe0f","1f9dc-1f3fc-200d-2640-fe0f","1f9dc-1f3fd-200d-2640-fe0f","1f9dc-1f3fe-200d-2640-fe0f","1f9dc-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["elf"],u:"1f9dd",v:["1f9dd-1f3fb","1f9dd-1f3fc","1f9dd-1f3fd","1f9dd-1f3fe","1f9dd-1f3ff"],a:"5.0"},{n:["man elf","male elf"],u:"1f9dd-200d-2642-fe0f",v:["1f9dd-1f3fb-200d-2642-fe0f","1f9dd-1f3fc-200d-2642-fe0f","1f9dd-1f3fd-200d-2642-fe0f","1f9dd-1f3fe-200d-2642-fe0f","1f9dd-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman elf","female elf"],u:"1f9dd-200d-2640-fe0f",v:["1f9dd-1f3fb-200d-2640-fe0f","1f9dd-1f3fc-200d-2640-fe0f","1f9dd-1f3fd-200d-2640-fe0f","1f9dd-1f3fe-200d-2640-fe0f","1f9dd-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["genie"],u:"1f9de",a:"5.0"},{n:["man genie","male genie"],u:"1f9de-200d-2642-fe0f",a:"5.0"},{n:["woman genie","female genie"],u:"1f9de-200d-2640-fe0f",a:"5.0"},{n:["zombie"],u:"1f9df",a:"5.0"},{n:["man zombie","male zombie"],u:"1f9df-200d-2642-fe0f",a:"5.0"},{n:["woman zombie","female zombie"],u:"1f9df-200d-2640-fe0f",a:"5.0"},{n:["troll"],u:"1f9cc",a:"14.0"},{n:["massage","face massage"],u:"1f486",v:["1f486-1f3fb","1f486-1f3fc","1f486-1f3fd","1f486-1f3fe","1f486-1f3ff"],a:"0.6"},{n:["man getting massage","man-getting-massage"],u:"1f486-200d-2642-fe0f",v:["1f486-1f3fb-200d-2642-fe0f","1f486-1f3fc-200d-2642-fe0f","1f486-1f3fd-200d-2642-fe0f","1f486-1f3fe-200d-2642-fe0f","1f486-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman getting massage","woman-getting-massage"],u:"1f486-200d-2640-fe0f",v:["1f486-1f3fb-200d-2640-fe0f","1f486-1f3fc-200d-2640-fe0f","1f486-1f3fd-200d-2640-fe0f","1f486-1f3fe-200d-2640-fe0f","1f486-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["haircut"],u:"1f487",v:["1f487-1f3fb","1f487-1f3fc","1f487-1f3fd","1f487-1f3fe","1f487-1f3ff"],a:"0.6"},{n:["man getting haircut","man-getting-haircut"],u:"1f487-200d-2642-fe0f",v:["1f487-1f3fb-200d-2642-fe0f","1f487-1f3fc-200d-2642-fe0f","1f487-1f3fd-200d-2642-fe0f","1f487-1f3fe-200d-2642-fe0f","1f487-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman getting haircut","woman-getting-haircut"],u:"1f487-200d-2640-fe0f",v:["1f487-1f3fb-200d-2640-fe0f","1f487-1f3fc-200d-2640-fe0f","1f487-1f3fd-200d-2640-fe0f","1f487-1f3fe-200d-2640-fe0f","1f487-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["walking","pedestrian"],u:"1f6b6",v:["1f6b6-1f3fb","1f6b6-1f3fc","1f6b6-1f3fd","1f6b6-1f3fe","1f6b6-1f3ff"],a:"0.6"},{n:["man walking","man-walking"],u:"1f6b6-200d-2642-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f","1f6b6-1f3fc-200d-2642-fe0f","1f6b6-1f3fd-200d-2642-fe0f","1f6b6-1f3fe-200d-2642-fe0f","1f6b6-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman walking","woman-walking"],u:"1f6b6-200d-2640-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f","1f6b6-1f3fc-200d-2640-fe0f","1f6b6-1f3fd-200d-2640-fe0f","1f6b6-1f3fe-200d-2640-fe0f","1f6b6-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person walking facing right"],u:"1f6b6-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-27a1-fe0f","1f6b6-1f3fc-200d-27a1-fe0f","1f6b6-1f3fd-200d-27a1-fe0f","1f6b6-1f3fe-200d-27a1-fe0f","1f6b6-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman walking facing right"],u:"1f6b6-200d-2640-fe0f-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man walking facing right"],u:"1f6b6-200d-2642-fe0f-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["standing person"],u:"1f9cd",v:["1f9cd-1f3fb","1f9cd-1f3fc","1f9cd-1f3fd","1f9cd-1f3fe","1f9cd-1f3ff"],a:"12.0"},{n:["man standing"],u:"1f9cd-200d-2642-fe0f",v:["1f9cd-1f3fb-200d-2642-fe0f","1f9cd-1f3fc-200d-2642-fe0f","1f9cd-1f3fd-200d-2642-fe0f","1f9cd-1f3fe-200d-2642-fe0f","1f9cd-1f3ff-200d-2642-fe0f"],a:"12.0"},{n:["woman standing"],u:"1f9cd-200d-2640-fe0f",v:["1f9cd-1f3fb-200d-2640-fe0f","1f9cd-1f3fc-200d-2640-fe0f","1f9cd-1f3fd-200d-2640-fe0f","1f9cd-1f3fe-200d-2640-fe0f","1f9cd-1f3ff-200d-2640-fe0f"],a:"12.0"},{n:["kneeling person"],u:"1f9ce",v:["1f9ce-1f3fb","1f9ce-1f3fc","1f9ce-1f3fd","1f9ce-1f3fe","1f9ce-1f3ff"],a:"12.0"},{n:["man kneeling"],u:"1f9ce-200d-2642-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f","1f9ce-1f3fc-200d-2642-fe0f","1f9ce-1f3fd-200d-2642-fe0f","1f9ce-1f3fe-200d-2642-fe0f","1f9ce-1f3ff-200d-2642-fe0f"],a:"12.0"},{n:["woman kneeling"],u:"1f9ce-200d-2640-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f","1f9ce-1f3fc-200d-2640-fe0f","1f9ce-1f3fd-200d-2640-fe0f","1f9ce-1f3fe-200d-2640-fe0f","1f9ce-1f3ff-200d-2640-fe0f"],a:"12.0"},{n:["person kneeling facing right"],u:"1f9ce-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-27a1-fe0f","1f9ce-1f3fc-200d-27a1-fe0f","1f9ce-1f3fd-200d-27a1-fe0f","1f9ce-1f3fe-200d-27a1-fe0f","1f9ce-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman kneeling facing right"],u:"1f9ce-200d-2640-fe0f-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man kneeling facing right"],u:"1f9ce-200d-2642-fe0f-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["person with white cane","person with probing cane"],u:"1f9d1-200d-1f9af",v:["1f9d1-1f3fb-200d-1f9af","1f9d1-1f3fc-200d-1f9af","1f9d1-1f3fd-200d-1f9af","1f9d1-1f3fe-200d-1f9af","1f9d1-1f3ff-200d-1f9af"],a:"12.1"},{n:["person with white cane facing right"],u:"1f9d1-200d-1f9af-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["man with white cane","man with probing cane"],u:"1f468-200d-1f9af",v:["1f468-1f3fb-200d-1f9af","1f468-1f3fc-200d-1f9af","1f468-1f3fd-200d-1f9af","1f468-1f3fe-200d-1f9af","1f468-1f3ff-200d-1f9af"],a:"12.0"},{n:["man with white cane facing right"],u:"1f468-200d-1f9af-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9af-200d-27a1-fe0f","1f468-1f3fc-200d-1f9af-200d-27a1-fe0f","1f468-1f3fd-200d-1f9af-200d-27a1-fe0f","1f468-1f3fe-200d-1f9af-200d-27a1-fe0f","1f468-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["woman with white cane","woman with probing cane"],u:"1f469-200d-1f9af",v:["1f469-1f3fb-200d-1f9af","1f469-1f3fc-200d-1f9af","1f469-1f3fd-200d-1f9af","1f469-1f3fe-200d-1f9af","1f469-1f3ff-200d-1f9af"],a:"12.0"},{n:["woman with white cane facing right"],u:"1f469-200d-1f9af-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9af-200d-27a1-fe0f","1f469-1f3fc-200d-1f9af-200d-27a1-fe0f","1f469-1f3fd-200d-1f9af-200d-27a1-fe0f","1f469-1f3fe-200d-1f9af-200d-27a1-fe0f","1f469-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["person in motorized wheelchair"],u:"1f9d1-200d-1f9bc",v:["1f9d1-1f3fb-200d-1f9bc","1f9d1-1f3fc-200d-1f9bc","1f9d1-1f3fd-200d-1f9bc","1f9d1-1f3fe-200d-1f9bc","1f9d1-1f3ff-200d-1f9bc"],a:"12.1"},{n:["person in motorized wheelchair facing right"],u:"1f9d1-200d-1f9bc-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["man in motorized wheelchair"],u:"1f468-200d-1f9bc",v:["1f468-1f3fb-200d-1f9bc","1f468-1f3fc-200d-1f9bc","1f468-1f3fd-200d-1f9bc","1f468-1f3fe-200d-1f9bc","1f468-1f3ff-200d-1f9bc"],a:"12.0"},{n:["man in motorized wheelchair facing right"],u:"1f468-200d-1f9bc-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f468-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["woman in motorized wheelchair"],u:"1f469-200d-1f9bc",v:["1f469-1f3fb-200d-1f9bc","1f469-1f3fc-200d-1f9bc","1f469-1f3fd-200d-1f9bc","1f469-1f3fe-200d-1f9bc","1f469-1f3ff-200d-1f9bc"],a:"12.0"},{n:["woman in motorized wheelchair facing right"],u:"1f469-200d-1f9bc-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f469-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["person in manual wheelchair"],u:"1f9d1-200d-1f9bd",v:["1f9d1-1f3fb-200d-1f9bd","1f9d1-1f3fc-200d-1f9bd","1f9d1-1f3fd-200d-1f9bd","1f9d1-1f3fe-200d-1f9bd","1f9d1-1f3ff-200d-1f9bd"],a:"12.1"},{n:["person in manual wheelchair facing right"],u:"1f9d1-200d-1f9bd-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["man in manual wheelchair"],u:"1f468-200d-1f9bd",v:["1f468-1f3fb-200d-1f9bd","1f468-1f3fc-200d-1f9bd","1f468-1f3fd-200d-1f9bd","1f468-1f3fe-200d-1f9bd","1f468-1f3ff-200d-1f9bd"],a:"12.0"},{n:["man in manual wheelchair facing right"],u:"1f468-200d-1f9bd-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f468-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["woman in manual wheelchair"],u:"1f469-200d-1f9bd",v:["1f469-1f3fb-200d-1f9bd","1f469-1f3fc-200d-1f9bd","1f469-1f3fd-200d-1f9bd","1f469-1f3fe-200d-1f9bd","1f469-1f3ff-200d-1f9bd"],a:"12.0"},{n:["woman in manual wheelchair facing right"],u:"1f469-200d-1f9bd-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f469-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["runner","running"],u:"1f3c3",v:["1f3c3-1f3fb","1f3c3-1f3fc","1f3c3-1f3fd","1f3c3-1f3fe","1f3c3-1f3ff"],a:"0.6"},{n:["man running","man-running"],u:"1f3c3-200d-2642-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f","1f3c3-1f3fc-200d-2642-fe0f","1f3c3-1f3fd-200d-2642-fe0f","1f3c3-1f3fe-200d-2642-fe0f","1f3c3-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman running","woman-running"],u:"1f3c3-200d-2640-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f","1f3c3-1f3fc-200d-2640-fe0f","1f3c3-1f3fd-200d-2640-fe0f","1f3c3-1f3fe-200d-2640-fe0f","1f3c3-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person running facing right"],u:"1f3c3-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-27a1-fe0f","1f3c3-1f3fc-200d-27a1-fe0f","1f3c3-1f3fd-200d-27a1-fe0f","1f3c3-1f3fe-200d-27a1-fe0f","1f3c3-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman running facing right"],u:"1f3c3-200d-2640-fe0f-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man running facing right"],u:"1f3c3-200d-2642-fe0f-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["dancer"],u:"1f483",v:["1f483-1f3fb","1f483-1f3fc","1f483-1f3fd","1f483-1f3fe","1f483-1f3ff"],a:"0.6"},{n:["man dancing"],u:"1f57a",v:["1f57a-1f3fb","1f57a-1f3fc","1f57a-1f3fd","1f57a-1f3fe","1f57a-1f3ff"],a:"3.0"},{n:["person in suit levitating","man in business suit levitating"],u:"1f574-fe0f",v:["1f574-1f3fb","1f574-1f3fc","1f574-1f3fd","1f574-1f3fe","1f574-1f3ff"],a:"0.7"},{n:["dancers","woman with bunny ears"],u:"1f46f",a:"0.6"},{n:["men with bunny ears","men-with-bunny-ears-partying","man-with-bunny-ears-partying"],u:"1f46f-200d-2642-fe0f",a:"4.0"},{n:["women with bunny ears","women-with-bunny-ears-partying","woman-with-bunny-ears-partying"],u:"1f46f-200d-2640-fe0f",a:"4.0"},{n:["person in steamy room"],u:"1f9d6",v:["1f9d6-1f3fb","1f9d6-1f3fc","1f9d6-1f3fd","1f9d6-1f3fe","1f9d6-1f3ff"],a:"5.0"},{n:["man in steamy room"],u:"1f9d6-200d-2642-fe0f",v:["1f9d6-1f3fb-200d-2642-fe0f","1f9d6-1f3fc-200d-2642-fe0f","1f9d6-1f3fd-200d-2642-fe0f","1f9d6-1f3fe-200d-2642-fe0f","1f9d6-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman in steamy room"],u:"1f9d6-200d-2640-fe0f",v:["1f9d6-1f3fb-200d-2640-fe0f","1f9d6-1f3fc-200d-2640-fe0f","1f9d6-1f3fd-200d-2640-fe0f","1f9d6-1f3fe-200d-2640-fe0f","1f9d6-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["person climbing"],u:"1f9d7",v:["1f9d7-1f3fb","1f9d7-1f3fc","1f9d7-1f3fd","1f9d7-1f3fe","1f9d7-1f3ff"],a:"5.0"},{n:["man climbing"],u:"1f9d7-200d-2642-fe0f",v:["1f9d7-1f3fb-200d-2642-fe0f","1f9d7-1f3fc-200d-2642-fe0f","1f9d7-1f3fd-200d-2642-fe0f","1f9d7-1f3fe-200d-2642-fe0f","1f9d7-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman climbing"],u:"1f9d7-200d-2640-fe0f",v:["1f9d7-1f3fb-200d-2640-fe0f","1f9d7-1f3fc-200d-2640-fe0f","1f9d7-1f3fd-200d-2640-fe0f","1f9d7-1f3fe-200d-2640-fe0f","1f9d7-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["fencer"],u:"1f93a",a:"3.0"},{n:["horse racing"],u:"1f3c7",v:["1f3c7-1f3fb","1f3c7-1f3fc","1f3c7-1f3fd","1f3c7-1f3fe","1f3c7-1f3ff"],a:"1.0"},{n:["skier"],u:"26f7-fe0f",a:"0.7"},{n:["snowboarder"],u:"1f3c2",v:["1f3c2-1f3fb","1f3c2-1f3fc","1f3c2-1f3fd","1f3c2-1f3fe","1f3c2-1f3ff"],a:"0.6"},{n:["golfer","person golfing"],u:"1f3cc-fe0f",v:["1f3cc-1f3fb","1f3cc-1f3fc","1f3cc-1f3fd","1f3cc-1f3fe","1f3cc-1f3ff"],a:"0.7"},{n:["man golfing","man-golfing"],u:"1f3cc-fe0f-200d-2642-fe0f",v:["1f3cc-1f3fb-200d-2642-fe0f","1f3cc-1f3fc-200d-2642-fe0f","1f3cc-1f3fd-200d-2642-fe0f","1f3cc-1f3fe-200d-2642-fe0f","1f3cc-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman golfing","woman-golfing"],u:"1f3cc-fe0f-200d-2640-fe0f",v:["1f3cc-1f3fb-200d-2640-fe0f","1f3cc-1f3fc-200d-2640-fe0f","1f3cc-1f3fd-200d-2640-fe0f","1f3cc-1f3fe-200d-2640-fe0f","1f3cc-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["surfer"],u:"1f3c4",v:["1f3c4-1f3fb","1f3c4-1f3fc","1f3c4-1f3fd","1f3c4-1f3fe","1f3c4-1f3ff"],a:"0.6"},{n:["man surfing","man-surfing"],u:"1f3c4-200d-2642-fe0f",v:["1f3c4-1f3fb-200d-2642-fe0f","1f3c4-1f3fc-200d-2642-fe0f","1f3c4-1f3fd-200d-2642-fe0f","1f3c4-1f3fe-200d-2642-fe0f","1f3c4-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman surfing","woman-surfing"],u:"1f3c4-200d-2640-fe0f",v:["1f3c4-1f3fb-200d-2640-fe0f","1f3c4-1f3fc-200d-2640-fe0f","1f3c4-1f3fd-200d-2640-fe0f","1f3c4-1f3fe-200d-2640-fe0f","1f3c4-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["rowboat"],u:"1f6a3",v:["1f6a3-1f3fb","1f6a3-1f3fc","1f6a3-1f3fd","1f6a3-1f3fe","1f6a3-1f3ff"],a:"1.0"},{n:["man rowing boat","man-rowing-boat"],u:"1f6a3-200d-2642-fe0f",v:["1f6a3-1f3fb-200d-2642-fe0f","1f6a3-1f3fc-200d-2642-fe0f","1f6a3-1f3fd-200d-2642-fe0f","1f6a3-1f3fe-200d-2642-fe0f","1f6a3-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman rowing boat","woman-rowing-boat"],u:"1f6a3-200d-2640-fe0f",v:["1f6a3-1f3fb-200d-2640-fe0f","1f6a3-1f3fc-200d-2640-fe0f","1f6a3-1f3fd-200d-2640-fe0f","1f6a3-1f3fe-200d-2640-fe0f","1f6a3-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["swimmer"],u:"1f3ca",v:["1f3ca-1f3fb","1f3ca-1f3fc","1f3ca-1f3fd","1f3ca-1f3fe","1f3ca-1f3ff"],a:"0.6"},{n:["man swimming","man-swimming"],u:"1f3ca-200d-2642-fe0f",v:["1f3ca-1f3fb-200d-2642-fe0f","1f3ca-1f3fc-200d-2642-fe0f","1f3ca-1f3fd-200d-2642-fe0f","1f3ca-1f3fe-200d-2642-fe0f","1f3ca-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman swimming","woman-swimming"],u:"1f3ca-200d-2640-fe0f",v:["1f3ca-1f3fb-200d-2640-fe0f","1f3ca-1f3fc-200d-2640-fe0f","1f3ca-1f3fd-200d-2640-fe0f","1f3ca-1f3fe-200d-2640-fe0f","1f3ca-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person with ball","person bouncing ball"],u:"26f9-fe0f",v:["26f9-1f3fb","26f9-1f3fc","26f9-1f3fd","26f9-1f3fe","26f9-1f3ff"],a:"0.7"},{n:["man bouncing ball","man-bouncing-ball"],u:"26f9-fe0f-200d-2642-fe0f",v:["26f9-1f3fb-200d-2642-fe0f","26f9-1f3fc-200d-2642-fe0f","26f9-1f3fd-200d-2642-fe0f","26f9-1f3fe-200d-2642-fe0f","26f9-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman bouncing ball","woman-bouncing-ball"],u:"26f9-fe0f-200d-2640-fe0f",v:["26f9-1f3fb-200d-2640-fe0f","26f9-1f3fc-200d-2640-fe0f","26f9-1f3fd-200d-2640-fe0f","26f9-1f3fe-200d-2640-fe0f","26f9-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["weight lifter","person lifting weights"],u:"1f3cb-fe0f",v:["1f3cb-1f3fb","1f3cb-1f3fc","1f3cb-1f3fd","1f3cb-1f3fe","1f3cb-1f3ff"],a:"0.7"},{n:["man lifting weights","man-lifting-weights"],u:"1f3cb-fe0f-200d-2642-fe0f",v:["1f3cb-1f3fb-200d-2642-fe0f","1f3cb-1f3fc-200d-2642-fe0f","1f3cb-1f3fd-200d-2642-fe0f","1f3cb-1f3fe-200d-2642-fe0f","1f3cb-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman lifting weights","woman-lifting-weights"],u:"1f3cb-fe0f-200d-2640-fe0f",v:["1f3cb-1f3fb-200d-2640-fe0f","1f3cb-1f3fc-200d-2640-fe0f","1f3cb-1f3fd-200d-2640-fe0f","1f3cb-1f3fe-200d-2640-fe0f","1f3cb-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["bicyclist"],u:"1f6b4",v:["1f6b4-1f3fb","1f6b4-1f3fc","1f6b4-1f3fd","1f6b4-1f3fe","1f6b4-1f3ff"],a:"1.0"},{n:["man biking","man-biking"],u:"1f6b4-200d-2642-fe0f",v:["1f6b4-1f3fb-200d-2642-fe0f","1f6b4-1f3fc-200d-2642-fe0f","1f6b4-1f3fd-200d-2642-fe0f","1f6b4-1f3fe-200d-2642-fe0f","1f6b4-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman biking","woman-biking"],u:"1f6b4-200d-2640-fe0f",v:["1f6b4-1f3fb-200d-2640-fe0f","1f6b4-1f3fc-200d-2640-fe0f","1f6b4-1f3fd-200d-2640-fe0f","1f6b4-1f3fe-200d-2640-fe0f","1f6b4-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["mountain bicyclist"],u:"1f6b5",v:["1f6b5-1f3fb","1f6b5-1f3fc","1f6b5-1f3fd","1f6b5-1f3fe","1f6b5-1f3ff"],a:"1.0"},{n:["man mountain biking","man-mountain-biking"],u:"1f6b5-200d-2642-fe0f",v:["1f6b5-1f3fb-200d-2642-fe0f","1f6b5-1f3fc-200d-2642-fe0f","1f6b5-1f3fd-200d-2642-fe0f","1f6b5-1f3fe-200d-2642-fe0f","1f6b5-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman mountain biking","woman-mountain-biking"],u:"1f6b5-200d-2640-fe0f",v:["1f6b5-1f3fb-200d-2640-fe0f","1f6b5-1f3fc-200d-2640-fe0f","1f6b5-1f3fd-200d-2640-fe0f","1f6b5-1f3fe-200d-2640-fe0f","1f6b5-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person doing cartwheel"],u:"1f938",v:["1f938-1f3fb","1f938-1f3fc","1f938-1f3fd","1f938-1f3fe","1f938-1f3ff"],a:"3.0"},{n:["man cartwheeling","man-cartwheeling"],u:"1f938-200d-2642-fe0f",v:["1f938-1f3fb-200d-2642-fe0f","1f938-1f3fc-200d-2642-fe0f","1f938-1f3fd-200d-2642-fe0f","1f938-1f3fe-200d-2642-fe0f","1f938-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman cartwheeling","woman-cartwheeling"],u:"1f938-200d-2640-fe0f",v:["1f938-1f3fb-200d-2640-fe0f","1f938-1f3fc-200d-2640-fe0f","1f938-1f3fd-200d-2640-fe0f","1f938-1f3fe-200d-2640-fe0f","1f938-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["wrestlers"],u:"1f93c",a:"3.0"},{n:["men wrestling","man-wrestling"],u:"1f93c-200d-2642-fe0f",a:"4.0"},{n:["women wrestling","woman-wrestling"],u:"1f93c-200d-2640-fe0f",a:"4.0"},{n:["water polo"],u:"1f93d",v:["1f93d-1f3fb","1f93d-1f3fc","1f93d-1f3fd","1f93d-1f3fe","1f93d-1f3ff"],a:"3.0"},{n:["man playing water polo","man-playing-water-polo"],u:"1f93d-200d-2642-fe0f",v:["1f93d-1f3fb-200d-2642-fe0f","1f93d-1f3fc-200d-2642-fe0f","1f93d-1f3fd-200d-2642-fe0f","1f93d-1f3fe-200d-2642-fe0f","1f93d-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman playing water polo","woman-playing-water-polo"],u:"1f93d-200d-2640-fe0f",v:["1f93d-1f3fb-200d-2640-fe0f","1f93d-1f3fc-200d-2640-fe0f","1f93d-1f3fd-200d-2640-fe0f","1f93d-1f3fe-200d-2640-fe0f","1f93d-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["handball"],u:"1f93e",v:["1f93e-1f3fb","1f93e-1f3fc","1f93e-1f3fd","1f93e-1f3fe","1f93e-1f3ff"],a:"3.0"},{n:["man playing handball","man-playing-handball"],u:"1f93e-200d-2642-fe0f",v:["1f93e-1f3fb-200d-2642-fe0f","1f93e-1f3fc-200d-2642-fe0f","1f93e-1f3fd-200d-2642-fe0f","1f93e-1f3fe-200d-2642-fe0f","1f93e-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman playing handball","woman-playing-handball"],u:"1f93e-200d-2640-fe0f",v:["1f93e-1f3fb-200d-2640-fe0f","1f93e-1f3fc-200d-2640-fe0f","1f93e-1f3fd-200d-2640-fe0f","1f93e-1f3fe-200d-2640-fe0f","1f93e-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["juggling"],u:"1f939",v:["1f939-1f3fb","1f939-1f3fc","1f939-1f3fd","1f939-1f3fe","1f939-1f3ff"],a:"3.0"},{n:["man juggling","man-juggling"],u:"1f939-200d-2642-fe0f",v:["1f939-1f3fb-200d-2642-fe0f","1f939-1f3fc-200d-2642-fe0f","1f939-1f3fd-200d-2642-fe0f","1f939-1f3fe-200d-2642-fe0f","1f939-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman juggling","woman-juggling"],u:"1f939-200d-2640-fe0f",v:["1f939-1f3fb-200d-2640-fe0f","1f939-1f3fc-200d-2640-fe0f","1f939-1f3fd-200d-2640-fe0f","1f939-1f3fe-200d-2640-fe0f","1f939-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person in lotus position"],u:"1f9d8",v:["1f9d8-1f3fb","1f9d8-1f3fc","1f9d8-1f3fd","1f9d8-1f3fe","1f9d8-1f3ff"],a:"5.0"},{n:["man in lotus position"],u:"1f9d8-200d-2642-fe0f",v:["1f9d8-1f3fb-200d-2642-fe0f","1f9d8-1f3fc-200d-2642-fe0f","1f9d8-1f3fd-200d-2642-fe0f","1f9d8-1f3fe-200d-2642-fe0f","1f9d8-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman in lotus position"],u:"1f9d8-200d-2640-fe0f",v:["1f9d8-1f3fb-200d-2640-fe0f","1f9d8-1f3fc-200d-2640-fe0f","1f9d8-1f3fd-200d-2640-fe0f","1f9d8-1f3fe-200d-2640-fe0f","1f9d8-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["bath"],u:"1f6c0",v:["1f6c0-1f3fb","1f6c0-1f3fc","1f6c0-1f3fd","1f6c0-1f3fe","1f6c0-1f3ff"],a:"0.6"},{n:["sleeping accommodation"],u:"1f6cc",v:["1f6cc-1f3fb","1f6cc-1f3fc","1f6cc-1f3fd","1f6cc-1f3fe","1f6cc-1f3ff"],a:"1.0"},{n:["people holding hands"],u:"1f9d1-200d-1f91d-200d-1f9d1",v:["1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff"],a:"12.0"},{n:["women holding hands","two women holding hands"],u:"1f46d",v:["1f46d-1f3fb","1f46d-1f3fc","1f46d-1f3fd","1f46d-1f3fe","1f46d-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe"],a:"1.0"},{n:["couple","man and woman holding hands","woman and man holding hands"],u:"1f46b",v:["1f46b-1f3fb","1f46b-1f3fc","1f46b-1f3fd","1f46b-1f3fe","1f46b-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"0.6"},{n:["men holding hands","two men holding hands"],u:"1f46c",v:["1f46c-1f3fb","1f46c-1f3fc","1f46c-1f3fd","1f46c-1f3fe","1f46c-1f3ff","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"1.0"},{n:["kiss","couplekiss"],u:"1f48f",v:["1f48f-1f3fb","1f48f-1f3fc","1f48f-1f3fd","1f48f-1f3fe","1f48f-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe"],a:"0.6"},{n:["woman-kiss-man","kiss: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2.0"},{n:["man-kiss-man","kiss: man, man"],u:"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2.0"},{n:["woman-kiss-woman","kiss: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff"],a:"2.0"},{n:["couple with heart"],u:"1f491",v:["1f491-1f3fb","1f491-1f3fc","1f491-1f3fd","1f491-1f3fe","1f491-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fe"],a:"0.6"},{n:["woman-heart-man","couple with heart: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2.0"},{n:["man-heart-man","couple with heart: man, man"],u:"1f468-200d-2764-fe0f-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2.0"},{n:["woman-heart-woman","couple with heart: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3ff"],a:"2.0"},{n:["man-woman-boy","family: man, woman, boy"],u:"1f468-200d-1f469-200d-1f466",a:"2.0"},{n:["man-woman-girl","family: man, woman, girl"],u:"1f468-200d-1f469-200d-1f467",a:"2.0"},{n:["man-woman-girl-boy","family: man, woman, girl, boy"],u:"1f468-200d-1f469-200d-1f467-200d-1f466",a:"2.0"},{n:["man-woman-boy-boy","family: man, woman, boy, boy"],u:"1f468-200d-1f469-200d-1f466-200d-1f466",a:"2.0"},{n:["man-woman-girl-girl","family: man, woman, girl, girl"],u:"1f468-200d-1f469-200d-1f467-200d-1f467",a:"2.0"},{n:["man-man-boy","family: man, man, boy"],u:"1f468-200d-1f468-200d-1f466",a:"2.0"},{n:["man-man-girl","family: man, man, girl"],u:"1f468-200d-1f468-200d-1f467",a:"2.0"},{n:["man-man-girl-boy","family: man, man, girl, boy"],u:"1f468-200d-1f468-200d-1f467-200d-1f466",a:"2.0"},{n:["man-man-boy-boy","family: man, man, boy, boy"],u:"1f468-200d-1f468-200d-1f466-200d-1f466",a:"2.0"},{n:["man-man-girl-girl","family: man, man, girl, girl"],u:"1f468-200d-1f468-200d-1f467-200d-1f467",a:"2.0"},{n:["woman-woman-boy","family: woman, woman, boy"],u:"1f469-200d-1f469-200d-1f466",a:"2.0"},{n:["woman-woman-girl","family: woman, woman, girl"],u:"1f469-200d-1f469-200d-1f467",a:"2.0"},{n:["woman-woman-girl-boy","family: woman, woman, girl, boy"],u:"1f469-200d-1f469-200d-1f467-200d-1f466",a:"2.0"},{n:["woman-woman-boy-boy","family: woman, woman, boy, boy"],u:"1f469-200d-1f469-200d-1f466-200d-1f466",a:"2.0"},{n:["woman-woman-girl-girl","family: woman, woman, girl, girl"],u:"1f469-200d-1f469-200d-1f467-200d-1f467",a:"2.0"},{n:["man-boy","family: man, boy"],u:"1f468-200d-1f466",a:"4.0"},{n:["man-boy-boy","family: man, boy, boy"],u:"1f468-200d-1f466-200d-1f466",a:"4.0"},{n:["man-girl","family: man, girl"],u:"1f468-200d-1f467",a:"4.0"},{n:["man-girl-boy","family: man, girl, boy"],u:"1f468-200d-1f467-200d-1f466",a:"4.0"},{n:["man-girl-girl","family: man, girl, girl"],u:"1f468-200d-1f467-200d-1f467",a:"4.0"},{n:["woman-boy","family: woman, boy"],u:"1f469-200d-1f466",a:"4.0"},{n:["woman-boy-boy","family: woman, boy, boy"],u:"1f469-200d-1f466-200d-1f466",a:"4.0"},{n:["woman-girl","family: woman, girl"],u:"1f469-200d-1f467",a:"4.0"},{n:["woman-girl-boy","family: woman, girl, boy"],u:"1f469-200d-1f467-200d-1f466",a:"4.0"},{n:["woman-girl-girl","family: woman, girl, girl"],u:"1f469-200d-1f467-200d-1f467",a:"4.0"},{n:["speaking head","speaking head in silhouette"],u:"1f5e3-fe0f",a:"0.7"},{n:["bust in silhouette"],u:"1f464",a:"0.6"},{n:["busts in silhouette"],u:"1f465",a:"1.0"},{n:["people hugging"],u:"1fac2",a:"13.0"},{n:["family"],u:"1f46a",a:"0.6"},{n:["family adult adult child","family: adult, adult, child"],u:"1f9d1-200d-1f9d1-200d-1f9d2",a:"15.1"},{n:["family adult adult child child","family: adult, adult, child, child"],u:"1f9d1-200d-1f9d1-200d-1f9d2-200d-1f9d2",a:"15.1"},{n:["family adult child","family: adult, child"],u:"1f9d1-200d-1f9d2",a:"15.1"},{n:["family adult child child","family: adult, child, child"],u:"1f9d1-200d-1f9d2-200d-1f9d2",a:"15.1"},{n:["footprints"],u:"1f463",a:"0.6"}],Hit=[{n:["monkey face"],u:"1f435",a:"0.6"},{n:["monkey"],u:"1f412",a:"0.6"},{n:["gorilla"],u:"1f98d",a:"3.0"},{n:["orangutan"],u:"1f9a7",a:"12.0"},{n:["dog","dog face"],u:"1f436",a:"0.6"},{n:["dog","dog2"],u:"1f415",a:"0.7"},{n:["guide dog"],u:"1f9ae",a:"12.0"},{n:["service dog"],u:"1f415-200d-1f9ba",a:"12.0"},{n:["poodle"],u:"1f429",a:"0.6"},{n:["wolf","wolf face"],u:"1f43a",a:"0.6"},{n:["fox face"],u:"1f98a",a:"3.0"},{n:["raccoon"],u:"1f99d",a:"11.0"},{n:["cat","cat face"],u:"1f431",a:"0.6"},{n:["cat","cat2"],u:"1f408",a:"0.7"},{n:["black cat"],u:"1f408-200d-2b1b",a:"13.0"},{n:["lion face"],u:"1f981",a:"1.0"},{n:["tiger","tiger face"],u:"1f42f",a:"0.6"},{n:["tiger","tiger2"],u:"1f405",a:"1.0"},{n:["leopard"],u:"1f406",a:"1.0"},{n:["horse","horse face"],u:"1f434",a:"0.6"},{n:["moose"],u:"1face",a:"15.0"},{n:["donkey"],u:"1facf",a:"15.0"},{n:["horse","racehorse"],u:"1f40e",a:"0.6"},{n:["unicorn face"],u:"1f984",a:"1.0"},{n:["zebra face"],u:"1f993",a:"5.0"},{n:["deer"],u:"1f98c",a:"3.0"},{n:["bison"],u:"1f9ac",a:"13.0"},{n:["cow","cow face"],u:"1f42e",a:"0.6"},{n:["ox"],u:"1f402",a:"1.0"},{n:["water buffalo"],u:"1f403",a:"1.0"},{n:["cow","cow2"],u:"1f404",a:"1.0"},{n:["pig","pig face"],u:"1f437",a:"0.6"},{n:["pig","pig2"],u:"1f416",a:"1.0"},{n:["boar"],u:"1f417",a:"0.6"},{n:["pig nose"],u:"1f43d",a:"0.6"},{n:["ram"],u:"1f40f",a:"1.0"},{n:["sheep"],u:"1f411",a:"0.6"},{n:["goat"],u:"1f410",a:"1.0"},{n:["dromedary camel"],u:"1f42a",a:"1.0"},{n:["camel","bactrian camel"],u:"1f42b",a:"0.6"},{n:["llama"],u:"1f999",a:"11.0"},{n:["giraffe face"],u:"1f992",a:"5.0"},{n:["elephant"],u:"1f418",a:"0.6"},{n:["mammoth"],u:"1f9a3",a:"13.0"},{n:["rhinoceros"],u:"1f98f",a:"3.0"},{n:["hippopotamus"],u:"1f99b",a:"11.0"},{n:["mouse","mouse face"],u:"1f42d",a:"0.6"},{n:["mouse","mouse2"],u:"1f401",a:"1.0"},{n:["rat"],u:"1f400",a:"1.0"},{n:["hamster","hamster face"],u:"1f439",a:"0.6"},{n:["rabbit","rabbit face"],u:"1f430",a:"0.6"},{n:["rabbit","rabbit2"],u:"1f407",a:"1.0"},{n:["chipmunk"],u:"1f43f-fe0f",a:"0.7"},{n:["beaver"],u:"1f9ab",a:"13.0"},{n:["hedgehog"],u:"1f994",a:"5.0"},{n:["bat"],u:"1f987",a:"3.0"},{n:["bear","bear face"],u:"1f43b",a:"0.6"},{n:["polar bear"],u:"1f43b-200d-2744-fe0f",a:"13.0"},{n:["koala"],u:"1f428",a:"0.6"},{n:["panda face"],u:"1f43c",a:"0.6"},{n:["sloth"],u:"1f9a5",a:"12.0"},{n:["otter"],u:"1f9a6",a:"12.0"},{n:["skunk"],u:"1f9a8",a:"12.0"},{n:["kangaroo"],u:"1f998",a:"11.0"},{n:["badger"],u:"1f9a1",a:"11.0"},{n:["feet","paw prints"],u:"1f43e",a:"0.6"},{n:["turkey"],u:"1f983",a:"1.0"},{n:["chicken"],u:"1f414",a:"0.6"},{n:["rooster"],u:"1f413",a:"1.0"},{n:["hatching chick"],u:"1f423",a:"0.6"},{n:["baby chick"],u:"1f424",a:"0.6"},{n:["hatched chick","front-facing baby chick"],u:"1f425",a:"0.6"},{n:["bird"],u:"1f426",a:"0.6"},{n:["penguin"],u:"1f427",a:"0.6"},{n:["dove","dove of peace"],u:"1f54a-fe0f",a:"0.7"},{n:["eagle"],u:"1f985",a:"3.0"},{n:["duck"],u:"1f986",a:"3.0"},{n:["swan"],u:"1f9a2",a:"11.0"},{n:["owl"],u:"1f989",a:"3.0"},{n:["dodo"],u:"1f9a4",a:"13.0"},{n:["feather"],u:"1fab6",a:"13.0"},{n:["flamingo"],u:"1f9a9",a:"12.0"},{n:["peacock"],u:"1f99a",a:"11.0"},{n:["parrot"],u:"1f99c",a:"11.0"},{n:["wing"],u:"1fabd",a:"15.0"},{n:["black bird"],u:"1f426-200d-2b1b",a:"15.0"},{n:["goose"],u:"1fabf",a:"15.0"},{n:["phoenix"],u:"1f426-200d-1f525",a:"15.1"},{n:["frog","frog face"],u:"1f438",a:"0.6"},{n:["crocodile"],u:"1f40a",a:"1.0"},{n:["turtle"],u:"1f422",a:"0.6"},{n:["lizard"],u:"1f98e",a:"3.0"},{n:["snake"],u:"1f40d",a:"0.6"},{n:["dragon face"],u:"1f432",a:"0.6"},{n:["dragon"],u:"1f409",a:"1.0"},{n:["sauropod"],u:"1f995",a:"5.0"},{n:["t-rex"],u:"1f996",a:"5.0"},{n:["whale","spouting whale"],u:"1f433",a:"0.6"},{n:["whale","whale2"],u:"1f40b",a:"1.0"},{n:["dolphin","flipper"],u:"1f42c",a:"0.6"},{n:["seal"],u:"1f9ad",a:"13.0"},{n:["fish"],u:"1f41f",a:"0.6"},{n:["tropical fish"],u:"1f420",a:"0.6"},{n:["blowfish"],u:"1f421",a:"0.6"},{n:["shark"],u:"1f988",a:"3.0"},{n:["octopus"],u:"1f419",a:"0.6"},{n:["shell","spiral shell"],u:"1f41a",a:"0.6"},{n:["coral"],u:"1fab8",a:"14.0"},{n:["jellyfish"],u:"1fabc",a:"15.0"},{n:["snail"],u:"1f40c",a:"0.6"},{n:["butterfly"],u:"1f98b",a:"3.0"},{n:["bug"],u:"1f41b",a:"0.6"},{n:["ant"],u:"1f41c",a:"0.6"},{n:["bee","honeybee"],u:"1f41d",a:"0.6"},{n:["beetle"],u:"1fab2",a:"13.0"},{n:["ladybug","lady beetle"],u:"1f41e",a:"0.6"},{n:["cricket"],u:"1f997",a:"5.0"},{n:["cockroach"],u:"1fab3",a:"13.0"},{n:["spider"],u:"1f577-fe0f",a:"0.7"},{n:["spider web"],u:"1f578-fe0f",a:"0.7"},{n:["scorpion"],u:"1f982",a:"1.0"},{n:["mosquito"],u:"1f99f",a:"11.0"},{n:["fly"],u:"1fab0",a:"13.0"},{n:["worm"],u:"1fab1",a:"13.0"},{n:["microbe"],u:"1f9a0",a:"11.0"},{n:["bouquet"],u:"1f490",a:"0.6"},{n:["cherry blossom"],u:"1f338",a:"0.6"},{n:["white flower"],u:"1f4ae",a:"0.6"},{n:["lotus"],u:"1fab7",a:"14.0"},{n:["rosette"],u:"1f3f5-fe0f",a:"0.7"},{n:["rose"],u:"1f339",a:"0.6"},{n:["wilted flower"],u:"1f940",a:"3.0"},{n:["hibiscus"],u:"1f33a",a:"0.6"},{n:["sunflower"],u:"1f33b",a:"0.6"},{n:["blossom"],u:"1f33c",a:"0.6"},{n:["tulip"],u:"1f337",a:"0.6"},{n:["hyacinth"],u:"1fabb",a:"15.0"},{n:["seedling"],u:"1f331",a:"0.6"},{n:["potted plant"],u:"1fab4",a:"13.0"},{n:["evergreen tree"],u:"1f332",a:"1.0"},{n:["deciduous tree"],u:"1f333",a:"1.0"},{n:["palm tree"],u:"1f334",a:"0.6"},{n:["cactus"],u:"1f335",a:"0.6"},{n:["ear of rice"],u:"1f33e",a:"0.6"},{n:["herb"],u:"1f33f",a:"0.6"},{n:["shamrock"],u:"2618-fe0f",a:"1.0"},{n:["four leaf clover"],u:"1f340",a:"0.6"},{n:["maple leaf"],u:"1f341",a:"0.6"},{n:["fallen leaf"],u:"1f342",a:"0.6"},{n:["leaves","leaf fluttering in wind"],u:"1f343",a:"0.6"},{n:["empty nest"],u:"1fab9",a:"14.0"},{n:["nest with eggs"],u:"1faba",a:"14.0"},{n:["mushroom"],u:"1f344",a:"0.6"}],qit=[{n:["grapes"],u:"1f347",a:"0.6"},{n:["melon"],u:"1f348",a:"0.6"},{n:["watermelon"],u:"1f349",a:"0.6"},{n:["tangerine"],u:"1f34a",a:"0.6"},{n:["lemon"],u:"1f34b",a:"1.0"},{n:["lime"],u:"1f34b-200d-1f7e9",a:"15.1"},{n:["banana"],u:"1f34c",a:"0.6"},{n:["pineapple"],u:"1f34d",a:"0.6"},{n:["mango"],u:"1f96d",a:"11.0"},{n:["apple","red apple"],u:"1f34e",a:"0.6"},{n:["green apple"],u:"1f34f",a:"0.6"},{n:["pear"],u:"1f350",a:"1.0"},{n:["peach"],u:"1f351",a:"0.6"},{n:["cherries"],u:"1f352",a:"0.6"},{n:["strawberry"],u:"1f353",a:"0.6"},{n:["blueberries"],u:"1fad0",a:"13.0"},{n:["kiwifruit"],u:"1f95d",a:"3.0"},{n:["tomato"],u:"1f345",a:"0.6"},{n:["olive"],u:"1fad2",a:"13.0"},{n:["coconut"],u:"1f965",a:"5.0"},{n:["avocado"],u:"1f951",a:"3.0"},{n:["eggplant","aubergine"],u:"1f346",a:"0.6"},{n:["potato"],u:"1f954",a:"3.0"},{n:["carrot"],u:"1f955",a:"3.0"},{n:["corn","ear of maize"],u:"1f33d",a:"0.6"},{n:["hot pepper"],u:"1f336-fe0f",a:"0.7"},{n:["bell pepper"],u:"1fad1",a:"13.0"},{n:["cucumber"],u:"1f952",a:"3.0"},{n:["leafy green"],u:"1f96c",a:"11.0"},{n:["broccoli"],u:"1f966",a:"5.0"},{n:["garlic"],u:"1f9c4",a:"12.0"},{n:["onion"],u:"1f9c5",a:"12.0"},{n:["peanuts"],u:"1f95c",a:"3.0"},{n:["beans"],u:"1fad8",a:"14.0"},{n:["chestnut"],u:"1f330",a:"0.6"},{n:["ginger root"],u:"1fada",a:"15.0"},{n:["pea pod"],u:"1fadb",a:"15.0"},{n:["brown mushroom"],u:"1f344-200d-1f7eb",a:"15.1"},{n:["bread"],u:"1f35e",a:"0.6"},{n:["croissant"],u:"1f950",a:"3.0"},{n:["baguette bread"],u:"1f956",a:"3.0"},{n:["flatbread"],u:"1fad3",a:"13.0"},{n:["pretzel"],u:"1f968",a:"5.0"},{n:["bagel"],u:"1f96f",a:"11.0"},{n:["pancakes"],u:"1f95e",a:"3.0"},{n:["waffle"],u:"1f9c7",a:"12.0"},{n:["cheese wedge"],u:"1f9c0",a:"1.0"},{n:["meat on bone"],u:"1f356",a:"0.6"},{n:["poultry leg"],u:"1f357",a:"0.6"},{n:["cut of meat"],u:"1f969",a:"5.0"},{n:["bacon"],u:"1f953",a:"3.0"},{n:["hamburger"],u:"1f354",a:"0.6"},{n:["fries","french fries"],u:"1f35f",a:"0.6"},{n:["pizza","slice of pizza"],u:"1f355",a:"0.6"},{n:["hotdog","hot dog"],u:"1f32d",a:"1.0"},{n:["sandwich"],u:"1f96a",a:"5.0"},{n:["taco"],u:"1f32e",a:"1.0"},{n:["burrito"],u:"1f32f",a:"1.0"},{n:["tamale"],u:"1fad4",a:"13.0"},{n:["stuffed flatbread"],u:"1f959",a:"3.0"},{n:["falafel"],u:"1f9c6",a:"12.0"},{n:["egg"],u:"1f95a",a:"3.0"},{n:["cooking","fried egg"],u:"1f373",a:"0.6"},{n:["shallow pan of food"],u:"1f958",a:"3.0"},{n:["stew","pot of food"],u:"1f372",a:"0.6"},{n:["fondue"],u:"1fad5",a:"13.0"},{n:["bowl with spoon"],u:"1f963",a:"5.0"},{n:["green salad"],u:"1f957",a:"3.0"},{n:["popcorn"],u:"1f37f",a:"1.0"},{n:["butter"],u:"1f9c8",a:"12.0"},{n:["salt","salt shaker"],u:"1f9c2",a:"11.0"},{n:["canned food"],u:"1f96b",a:"5.0"},{n:["bento","bento box"],u:"1f371",a:"0.6"},{n:["rice cracker"],u:"1f358",a:"0.6"},{n:["rice ball"],u:"1f359",a:"0.6"},{n:["rice","cooked rice"],u:"1f35a",a:"0.6"},{n:["curry","curry and rice"],u:"1f35b",a:"0.6"},{n:["ramen","steaming bowl"],u:"1f35c",a:"0.6"},{n:["spaghetti"],u:"1f35d",a:"0.6"},{n:["sweet potato","roasted sweet potato"],u:"1f360",a:"0.6"},{n:["oden"],u:"1f362",a:"0.6"},{n:["sushi"],u:"1f363",a:"0.6"},{n:["fried shrimp"],u:"1f364",a:"0.6"},{n:["fish cake","fish cake with swirl design"],u:"1f365",a:"0.6"},{n:["moon cake"],u:"1f96e",a:"11.0"},{n:["dango"],u:"1f361",a:"0.6"},{n:["dumpling"],u:"1f95f",a:"5.0"},{n:["fortune cookie"],u:"1f960",a:"5.0"},{n:["takeout box"],u:"1f961",a:"5.0"},{n:["crab"],u:"1f980",a:"1.0"},{n:["lobster"],u:"1f99e",a:"11.0"},{n:["shrimp"],u:"1f990",a:"3.0"},{n:["squid"],u:"1f991",a:"3.0"},{n:["oyster"],u:"1f9aa",a:"12.0"},{n:["icecream","soft ice cream"],u:"1f366",a:"0.6"},{n:["shaved ice"],u:"1f367",a:"0.6"},{n:["ice cream"],u:"1f368",a:"0.6"},{n:["doughnut"],u:"1f369",a:"0.6"},{n:["cookie"],u:"1f36a",a:"0.6"},{n:["birthday","birthday cake"],u:"1f382",a:"0.6"},{n:["cake","shortcake"],u:"1f370",a:"0.6"},{n:["cupcake"],u:"1f9c1",a:"11.0"},{n:["pie"],u:"1f967",a:"5.0"},{n:["chocolate bar"],u:"1f36b",a:"0.6"},{n:["candy"],u:"1f36c",a:"0.6"},{n:["lollipop"],u:"1f36d",a:"0.6"},{n:["custard"],u:"1f36e",a:"0.6"},{n:["honey pot"],u:"1f36f",a:"0.6"},{n:["baby bottle"],u:"1f37c",a:"1.0"},{n:["glass of milk"],u:"1f95b",a:"3.0"},{n:["coffee","hot beverage"],u:"2615",a:"0.6"},{n:["teapot"],u:"1fad6",a:"13.0"},{n:["tea","teacup without handle"],u:"1f375",a:"0.6"},{n:["sake","sake bottle and cup"],u:"1f376",a:"0.6"},{n:["champagne","bottle with popping cork"],u:"1f37e",a:"1.0"},{n:["wine glass"],u:"1f377",a:"0.6"},{n:["cocktail","cocktail glass"],u:"1f378",a:"0.6"},{n:["tropical drink"],u:"1f379",a:"0.6"},{n:["beer","beer mug"],u:"1f37a",a:"0.6"},{n:["beers","clinking beer mugs"],u:"1f37b",a:"0.6"},{n:["clinking glasses"],u:"1f942",a:"3.0"},{n:["tumbler glass"],u:"1f943",a:"3.0"},{n:["pouring liquid"],u:"1fad7",a:"14.0"},{n:["cup with straw"],u:"1f964",a:"5.0"},{n:["bubble tea"],u:"1f9cb",a:"13.0"},{n:["beverage box"],u:"1f9c3",a:"12.0"},{n:["mate drink"],u:"1f9c9",a:"12.0"},{n:["ice cube"],u:"1f9ca",a:"12.0"},{n:["chopsticks"],u:"1f962",a:"5.0"},{n:["knife fork plate","fork and knife with plate"],u:"1f37d-fe0f",a:"0.7"},{n:["fork and knife"],u:"1f374",a:"0.6"},{n:["spoon"],u:"1f944",a:"3.0"},{n:["hocho","knife"],u:"1f52a",a:"0.6"},{n:["jar"],u:"1fad9",a:"14.0"},{n:["amphora"],u:"1f3fa",a:"1.0"}],Yit=[{n:["earth africa","earth globe europe-africa"],u:"1f30d",a:"0.7"},{n:["earth americas","earth globe americas"],u:"1f30e",a:"0.7"},{n:["earth asia","earth globe asia-australia"],u:"1f30f",a:"0.6"},{n:["globe with meridians"],u:"1f310",a:"1.0"},{n:["world map"],u:"1f5fa-fe0f",a:"0.7"},{n:["japan","silhouette of japan"],u:"1f5fe",a:"0.6"},{n:["compass"],u:"1f9ed",a:"11.0"},{n:["snow-capped mountain","snow capped mountain"],u:"1f3d4-fe0f",a:"0.7"},{n:["mountain"],u:"26f0-fe0f",a:"0.7"},{n:["volcano"],u:"1f30b",a:"0.6"},{n:["mount fuji"],u:"1f5fb",a:"0.6"},{n:["camping"],u:"1f3d5-fe0f",a:"0.7"},{n:["beach with umbrella"],u:"1f3d6-fe0f",a:"0.7"},{n:["desert"],u:"1f3dc-fe0f",a:"0.7"},{n:["desert island"],u:"1f3dd-fe0f",a:"0.7"},{n:["national park"],u:"1f3de-fe0f",a:"0.7"},{n:["stadium"],u:"1f3df-fe0f",a:"0.7"},{n:["classical building"],u:"1f3db-fe0f",a:"0.7"},{n:["building construction"],u:"1f3d7-fe0f",a:"0.7"},{n:["brick","bricks"],u:"1f9f1",a:"11.0"},{n:["rock"],u:"1faa8",a:"13.0"},{n:["wood"],u:"1fab5",a:"13.0"},{n:["hut"],u:"1f6d6",a:"13.0"},{n:["houses","house buildings"],u:"1f3d8-fe0f",a:"0.7"},{n:["derelict house","derelict house building"],u:"1f3da-fe0f",a:"0.7"},{n:["house","house building"],u:"1f3e0",a:"0.6"},{n:["house with garden"],u:"1f3e1",a:"0.6"},{n:["office","office building"],u:"1f3e2",a:"0.6"},{n:["post office","japanese post office"],u:"1f3e3",a:"0.6"},{n:["european post office"],u:"1f3e4",a:"1.0"},{n:["hospital"],u:"1f3e5",a:"0.6"},{n:["bank"],u:"1f3e6",a:"0.6"},{n:["hotel"],u:"1f3e8",a:"0.6"},{n:["love hotel"],u:"1f3e9",a:"0.6"},{n:["convenience store"],u:"1f3ea",a:"0.6"},{n:["school"],u:"1f3eb",a:"0.6"},{n:["department store"],u:"1f3ec",a:"0.6"},{n:["factory"],u:"1f3ed",a:"0.6"},{n:["japanese castle"],u:"1f3ef",a:"0.6"},{n:["european castle"],u:"1f3f0",a:"0.6"},{n:["wedding"],u:"1f492",a:"0.6"},{n:["tokyo tower"],u:"1f5fc",a:"0.6"},{n:["statue of liberty"],u:"1f5fd",a:"0.6"},{n:["church"],u:"26ea",a:"0.6"},{n:["mosque"],u:"1f54c",a:"1.0"},{n:["hindu temple"],u:"1f6d5",a:"12.0"},{n:["synagogue"],u:"1f54d",a:"1.0"},{n:["shinto shrine"],u:"26e9-fe0f",a:"0.7"},{n:["kaaba"],u:"1f54b",a:"1.0"},{n:["fountain"],u:"26f2",a:"0.6"},{n:["tent"],u:"26fa",a:"0.6"},{n:["foggy"],u:"1f301",a:"0.6"},{n:["night with stars"],u:"1f303",a:"0.6"},{n:["cityscape"],u:"1f3d9-fe0f",a:"0.7"},{n:["sunrise over mountains"],u:"1f304",a:"0.6"},{n:["sunrise"],u:"1f305",a:"0.6"},{n:["city sunset","cityscape at dusk"],u:"1f306",a:"0.6"},{n:["city sunrise","sunset over buildings"],u:"1f307",a:"0.6"},{n:["bridge at night"],u:"1f309",a:"0.6"},{n:["hotsprings","hot springs"],u:"2668-fe0f",a:"0.6"},{n:["carousel horse"],u:"1f3a0",a:"0.6"},{n:["playground slide"],u:"1f6dd",a:"14.0"},{n:["ferris wheel"],u:"1f3a1",a:"0.6"},{n:["roller coaster"],u:"1f3a2",a:"0.6"},{n:["barber","barber pole"],u:"1f488",a:"0.6"},{n:["circus tent"],u:"1f3aa",a:"0.6"},{n:["steam locomotive"],u:"1f682",a:"1.0"},{n:["railway car"],u:"1f683",a:"0.6"},{n:["high-speed train","bullettrain side"],u:"1f684",a:"0.6"},{n:["bullettrain front","high-speed train with bullet nose"],u:"1f685",a:"0.6"},{n:["train","train2"],u:"1f686",a:"1.0"},{n:["metro"],u:"1f687",a:"0.6"},{n:["light rail"],u:"1f688",a:"1.0"},{n:["station"],u:"1f689",a:"0.6"},{n:["tram"],u:"1f68a",a:"1.0"},{n:["monorail"],u:"1f69d",a:"1.0"},{n:["mountain railway"],u:"1f69e",a:"1.0"},{n:["train","tram car"],u:"1f68b",a:"1.0"},{n:["bus"],u:"1f68c",a:"0.6"},{n:["oncoming bus"],u:"1f68d",a:"0.7"},{n:["trolleybus"],u:"1f68e",a:"1.0"},{n:["minibus"],u:"1f690",a:"1.0"},{n:["ambulance"],u:"1f691",a:"0.6"},{n:["fire engine"],u:"1f692",a:"0.6"},{n:["police car"],u:"1f693",a:"0.6"},{n:["oncoming police car"],u:"1f694",a:"0.7"},{n:["taxi"],u:"1f695",a:"0.6"},{n:["oncoming taxi"],u:"1f696",a:"1.0"},{n:["car","red car","automobile"],u:"1f697",a:"0.6"},{n:["oncoming automobile"],u:"1f698",a:"0.7"},{n:["blue car","recreational vehicle"],u:"1f699",a:"0.6"},{n:["pickup truck"],u:"1f6fb",a:"13.0"},{n:["truck","delivery truck"],u:"1f69a",a:"0.6"},{n:["articulated lorry"],u:"1f69b",a:"1.0"},{n:["tractor"],u:"1f69c",a:"1.0"},{n:["racing car"],u:"1f3ce-fe0f",a:"0.7"},{n:["motorcycle","racing motorcycle"],u:"1f3cd-fe0f",a:"0.7"},{n:["motor scooter"],u:"1f6f5",a:"3.0"},{n:["manual wheelchair"],u:"1f9bd",a:"12.0"},{n:["motorized wheelchair"],u:"1f9bc",a:"12.0"},{n:["auto rickshaw"],u:"1f6fa",a:"12.0"},{n:["bike","bicycle"],u:"1f6b2",a:"0.6"},{n:["scooter"],u:"1f6f4",a:"3.0"},{n:["skateboard"],u:"1f6f9",a:"11.0"},{n:["roller skate"],u:"1f6fc",a:"13.0"},{n:["busstop","bus stop"],u:"1f68f",a:"0.6"},{n:["motorway"],u:"1f6e3-fe0f",a:"0.7"},{n:["railway track"],u:"1f6e4-fe0f",a:"0.7"},{n:["oil drum"],u:"1f6e2-fe0f",a:"0.7"},{n:["fuelpump","fuel pump"],u:"26fd",a:"0.6"},{n:["wheel"],u:"1f6de",a:"14.0"},{n:["rotating light","police cars revolving light"],u:"1f6a8",a:"0.6"},{n:["traffic light","horizontal traffic light"],u:"1f6a5",a:"0.6"},{n:["vertical traffic light"],u:"1f6a6",a:"1.0"},{n:["octagonal sign"],u:"1f6d1",a:"3.0"},{n:["construction","construction sign"],u:"1f6a7",a:"0.6"},{n:["anchor"],u:"2693",a:"0.6"},{n:["ring buoy"],u:"1f6df",a:"14.0"},{n:["boat","sailboat"],u:"26f5",a:"0.6"},{n:["canoe"],u:"1f6f6",a:"3.0"},{n:["speedboat"],u:"1f6a4",a:"0.6"},{n:["passenger ship"],u:"1f6f3-fe0f",a:"0.7"},{n:["ferry"],u:"26f4-fe0f",a:"0.7"},{n:["motor boat"],u:"1f6e5-fe0f",a:"0.7"},{n:["ship"],u:"1f6a2",a:"0.6"},{n:["airplane"],u:"2708-fe0f",a:"0.6"},{n:["small airplane"],u:"1f6e9-fe0f",a:"0.7"},{n:["airplane departure"],u:"1f6eb",a:"1.0"},{n:["airplane arriving"],u:"1f6ec",a:"1.0"},{n:["parachute"],u:"1fa82",a:"12.0"},{n:["seat"],u:"1f4ba",a:"0.6"},{n:["helicopter"],u:"1f681",a:"1.0"},{n:["suspension railway"],u:"1f69f",a:"1.0"},{n:["mountain cableway"],u:"1f6a0",a:"1.0"},{n:["aerial tramway"],u:"1f6a1",a:"1.0"},{n:["satellite"],u:"1f6f0-fe0f",a:"0.7"},{n:["rocket"],u:"1f680",a:"0.6"},{n:["flying saucer"],u:"1f6f8",a:"5.0"},{n:["bellhop bell"],u:"1f6ce-fe0f",a:"0.7"},{n:["luggage"],u:"1f9f3",a:"11.0"},{n:["hourglass"],u:"231b",a:"0.6"},{n:["hourglass flowing sand","hourglass with flowing sand"],u:"23f3",a:"0.6"},{n:["watch"],u:"231a",a:"0.6"},{n:["alarm clock"],u:"23f0",a:"0.6"},{n:["stopwatch"],u:"23f1-fe0f",a:"1.0"},{n:["timer clock"],u:"23f2-fe0f",a:"1.0"},{n:["mantelpiece clock"],u:"1f570-fe0f",a:"0.7"},{n:["clock12","clock face twelve oclock"],u:"1f55b",a:"0.6"},{n:["clock1230","clock face twelve-thirty"],u:"1f567",a:"0.7"},{n:["clock1","clock face one oclock"],u:"1f550",a:"0.6"},{n:["clock130","clock face one-thirty"],u:"1f55c",a:"0.7"},{n:["clock2","clock face two oclock"],u:"1f551",a:"0.6"},{n:["clock230","clock face two-thirty"],u:"1f55d",a:"0.7"},{n:["clock3","clock face three oclock"],u:"1f552",a:"0.6"},{n:["clock330","clock face three-thirty"],u:"1f55e",a:"0.7"},{n:["clock4","clock face four oclock"],u:"1f553",a:"0.6"},{n:["clock430","clock face four-thirty"],u:"1f55f",a:"0.7"},{n:["clock5","clock face five oclock"],u:"1f554",a:"0.6"},{n:["clock530","clock face five-thirty"],u:"1f560",a:"0.7"},{n:["clock6","clock face six oclock"],u:"1f555",a:"0.6"},{n:["clock630","clock face six-thirty"],u:"1f561",a:"0.7"},{n:["clock7","clock face seven oclock"],u:"1f556",a:"0.6"},{n:["clock730","clock face seven-thirty"],u:"1f562",a:"0.7"},{n:["clock8","clock face eight oclock"],u:"1f557",a:"0.6"},{n:["clock830","clock face eight-thirty"],u:"1f563",a:"0.7"},{n:["clock9","clock face nine oclock"],u:"1f558",a:"0.6"},{n:["clock930","clock face nine-thirty"],u:"1f564",a:"0.7"},{n:["clock10","clock face ten oclock"],u:"1f559",a:"0.6"},{n:["clock1030","clock face ten-thirty"],u:"1f565",a:"0.7"},{n:["clock11","clock face eleven oclock"],u:"1f55a",a:"0.6"},{n:["clock1130","clock face eleven-thirty"],u:"1f566",a:"0.7"},{n:["new moon","new moon symbol"],u:"1f311",a:"0.6"},{n:["waxing crescent moon","waxing crescent moon symbol"],u:"1f312",a:"1.0"},{n:["first quarter moon","first quarter moon symbol"],u:"1f313",a:"0.6"},{n:["moon","waxing gibbous moon","waxing gibbous moon symbol"],u:"1f314",a:"0.6"},{n:["full moon","full moon symbol"],u:"1f315",a:"0.6"},{n:["waning gibbous moon","waning gibbous moon symbol"],u:"1f316",a:"1.0"},{n:["last quarter moon","last quarter moon symbol"],u:"1f317",a:"1.0"},{n:["waning crescent moon","waning crescent moon symbol"],u:"1f318",a:"1.0"},{n:["crescent moon"],u:"1f319",a:"0.6"},{n:["new moon with face"],u:"1f31a",a:"1.0"},{n:["first quarter moon with face"],u:"1f31b",a:"0.6"},{n:["last quarter moon with face"],u:"1f31c",a:"0.7"},{n:["thermometer"],u:"1f321-fe0f",a:"0.7"},{n:["sunny","black sun with rays"],u:"2600-fe0f",a:"0.6"},{n:["full moon with face"],u:"1f31d",a:"1.0"},{n:["sun with face"],u:"1f31e",a:"1.0"},{n:["ringed planet"],u:"1fa90",a:"12.0"},{n:["star","white medium star"],u:"2b50",a:"0.6"},{n:["star2","glowing star"],u:"1f31f",a:"0.6"},{n:["stars","shooting star"],u:"1f320",a:"0.6"},{n:["milky way"],u:"1f30c",a:"0.6"},{n:["cloud"],u:"2601-fe0f",a:"0.6"},{n:["partly sunny","sun behind cloud"],u:"26c5",a:"0.6"},{n:["thunder cloud and rain","cloud with lightning and rain"],u:"26c8-fe0f",a:"0.7"},{n:["mostly sunny","sun small cloud","sun behind small cloud"],u:"1f324-fe0f",a:"0.7"},{n:["barely sunny","sun behind cloud","sun behind large cloud"],u:"1f325-fe0f",a:"0.7"},{n:["partly sunny rain","sun behind rain cloud"],u:"1f326-fe0f",a:"0.7"},{n:["rain cloud","cloud with rain"],u:"1f327-fe0f",a:"0.7"},{n:["snow cloud","cloud with snow"],u:"1f328-fe0f",a:"0.7"},{n:["lightning","lightning cloud","cloud with lightning"],u:"1f329-fe0f",a:"0.7"},{n:["tornado","tornado cloud"],u:"1f32a-fe0f",a:"0.7"},{n:["fog"],u:"1f32b-fe0f",a:"0.7"},{n:["wind face","wind blowing face"],u:"1f32c-fe0f",a:"0.7"},{n:["cyclone"],u:"1f300",a:"0.6"},{n:["rainbow"],u:"1f308",a:"0.6"},{n:["closed umbrella"],u:"1f302",a:"0.6"},{n:["umbrella"],u:"2602-fe0f",a:"0.7"},{n:["umbrella with rain drops"],u:"2614",a:"0.6"},{n:["umbrella on ground"],u:"26f1-fe0f",a:"0.7"},{n:["zap","high voltage sign"],u:"26a1",a:"0.6"},{n:["snowflake"],u:"2744-fe0f",a:"0.6"},{n:["snowman"],u:"2603-fe0f",a:"0.7"},{n:["snowman without snow"],u:"26c4",a:"0.6"},{n:["comet"],u:"2604-fe0f",a:"1.0"},{n:["fire"],u:"1f525",a:"0.6"},{n:["droplet"],u:"1f4a7",a:"0.6"},{n:["ocean","water wave"],u:"1f30a",a:"0.6"}],Kit=[{n:["jack-o-lantern","jack o lantern"],u:"1f383",a:"0.6"},{n:["christmas tree"],u:"1f384",a:"0.6"},{n:["fireworks"],u:"1f386",a:"0.6"},{n:["sparkler","firework sparkler"],u:"1f387",a:"0.6"},{n:["firecracker"],u:"1f9e8",a:"11.0"},{n:["sparkles"],u:"2728",a:"0.6"},{n:["balloon"],u:"1f388",a:"0.6"},{n:["tada","party popper"],u:"1f389",a:"0.6"},{n:["confetti ball"],u:"1f38a",a:"0.6"},{n:["tanabata tree"],u:"1f38b",a:"0.6"},{n:["bamboo","pine decoration"],u:"1f38d",a:"0.6"},{n:["dolls","japanese dolls"],u:"1f38e",a:"0.6"},{n:["flags","carp streamer"],u:"1f38f",a:"0.6"},{n:["wind chime"],u:"1f390",a:"0.6"},{n:["rice scene","moon viewing ceremony"],u:"1f391",a:"0.6"},{n:["red envelope","red gift envelope"],u:"1f9e7",a:"11.0"},{n:["ribbon"],u:"1f380",a:"0.6"},{n:["gift","wrapped present"],u:"1f381",a:"0.6"},{n:["reminder ribbon"],u:"1f397-fe0f",a:"0.7"},{n:["admission tickets"],u:"1f39f-fe0f",a:"0.7"},{n:["ticket"],u:"1f3ab",a:"0.6"},{n:["medal","military medal"],u:"1f396-fe0f",a:"0.7"},{n:["trophy"],u:"1f3c6",a:"0.6"},{n:["sports medal"],u:"1f3c5",a:"1.0"},{n:["first place medal"],u:"1f947",a:"3.0"},{n:["second place medal"],u:"1f948",a:"3.0"},{n:["third place medal"],u:"1f949",a:"3.0"},{n:["soccer","soccer ball"],u:"26bd",a:"0.6"},{n:["baseball"],u:"26be",a:"0.6"},{n:["softball"],u:"1f94e",a:"11.0"},{n:["basketball","basketball and hoop"],u:"1f3c0",a:"0.6"},{n:["volleyball"],u:"1f3d0",a:"1.0"},{n:["football","american football"],u:"1f3c8",a:"0.6"},{n:["rugby football"],u:"1f3c9",a:"1.0"},{n:["tennis","tennis racquet and ball"],u:"1f3be",a:"0.6"},{n:["flying disc"],u:"1f94f",a:"11.0"},{n:["bowling"],u:"1f3b3",a:"0.6"},{n:["cricket bat and ball"],u:"1f3cf",a:"1.0"},{n:["field hockey stick and ball"],u:"1f3d1",a:"1.0"},{n:["ice hockey stick and puck"],u:"1f3d2",a:"1.0"},{n:["lacrosse","lacrosse stick and ball"],u:"1f94d",a:"11.0"},{n:["table tennis paddle and ball"],u:"1f3d3",a:"1.0"},{n:["badminton racquet and shuttlecock"],u:"1f3f8",a:"1.0"},{n:["boxing glove"],u:"1f94a",a:"3.0"},{n:["martial arts uniform"],u:"1f94b",a:"3.0"},{n:["goal net"],u:"1f945",a:"3.0"},{n:["golf","flag in hole"],u:"26f3",a:"0.6"},{n:["ice skate"],u:"26f8-fe0f",a:"0.7"},{n:["fishing pole and fish"],u:"1f3a3",a:"0.6"},{n:["diving mask"],u:"1f93f",a:"12.0"},{n:["running shirt with sash"],u:"1f3bd",a:"0.6"},{n:["ski","ski and ski boot"],u:"1f3bf",a:"0.6"},{n:["sled"],u:"1f6f7",a:"5.0"},{n:["curling stone"],u:"1f94c",a:"5.0"},{n:["dart","direct hit"],u:"1f3af",a:"0.6"},{n:["yo-yo"],u:"1fa80",a:"12.0"},{n:["kite"],u:"1fa81",a:"12.0"},{n:["gun","pistol"],u:"1f52b",a:"0.6"},{n:["8ball","billiards"],u:"1f3b1",a:"0.6"},{n:["crystal ball"],u:"1f52e",a:"0.6"},{n:["magic wand"],u:"1fa84",a:"13.0"},{n:["video game"],u:"1f3ae",a:"0.6"},{n:["joystick"],u:"1f579-fe0f",a:"0.7"},{n:["slot machine"],u:"1f3b0",a:"0.6"},{n:["game die"],u:"1f3b2",a:"0.6"},{n:["jigsaw","jigsaw puzzle piece"],u:"1f9e9",a:"11.0"},{n:["teddy bear"],u:"1f9f8",a:"11.0"},{n:["pinata"],u:"1fa85",a:"13.0"},{n:["mirror ball"],u:"1faa9",a:"14.0"},{n:["nesting dolls"],u:"1fa86",a:"13.0"},{n:["spades","black spade suit"],u:"2660-fe0f",a:"0.6"},{n:["hearts","black heart suit"],u:"2665-fe0f",a:"0.6"},{n:["diamonds","black diamond suit"],u:"2666-fe0f",a:"0.6"},{n:["clubs","black club suit"],u:"2663-fe0f",a:"0.6"},{n:["chess pawn"],u:"265f-fe0f",a:"11.0"},{n:["black joker","playing card black joker"],u:"1f0cf",a:"0.6"},{n:["mahjong","mahjong tile red dragon"],u:"1f004",a:"0.6"},{n:["flower playing cards"],u:"1f3b4",a:"0.6"},{n:["performing arts"],u:"1f3ad",a:"0.6"},{n:["framed picture","frame with picture"],u:"1f5bc-fe0f",a:"0.7"},{n:["art","artist palette"],u:"1f3a8",a:"0.6"},{n:["thread","spool of thread"],u:"1f9f5",a:"11.0"},{n:["sewing needle"],u:"1faa1",a:"13.0"},{n:["yarn","ball of yarn"],u:"1f9f6",a:"11.0"},{n:["knot"],u:"1faa2",a:"13.0"}],Xit=[{n:["eyeglasses"],u:"1f453",a:"0.6"},{n:["sunglasses","dark sunglasses"],u:"1f576-fe0f",a:"0.7"},{n:["goggles"],u:"1f97d",a:"11.0"},{n:["lab coat"],u:"1f97c",a:"11.0"},{n:["safety vest"],u:"1f9ba",a:"12.0"},{n:["necktie"],u:"1f454",a:"0.6"},{n:["shirt","tshirt","t-shirt"],u:"1f455",a:"0.6"},{n:["jeans"],u:"1f456",a:"0.6"},{n:["scarf"],u:"1f9e3",a:"5.0"},{n:["gloves"],u:"1f9e4",a:"5.0"},{n:["coat"],u:"1f9e5",a:"5.0"},{n:["socks"],u:"1f9e6",a:"5.0"},{n:["dress"],u:"1f457",a:"0.6"},{n:["kimono"],u:"1f458",a:"0.6"},{n:["sari"],u:"1f97b",a:"12.0"},{n:["one-piece swimsuit"],u:"1fa71",a:"12.0"},{n:["briefs"],u:"1fa72",a:"12.0"},{n:["shorts"],u:"1fa73",a:"12.0"},{n:["bikini"],u:"1f459",a:"0.6"},{n:["womans clothes"],u:"1f45a",a:"0.6"},{n:["folding hand fan"],u:"1faad",a:"15.0"},{n:["purse"],u:"1f45b",a:"0.6"},{n:["handbag"],u:"1f45c",a:"0.6"},{n:["pouch"],u:"1f45d",a:"0.6"},{n:["shopping bags"],u:"1f6cd-fe0f",a:"0.7"},{n:["school satchel"],u:"1f392",a:"0.6"},{n:["thong sandal"],u:"1fa74",a:"13.0"},{n:["shoe","mans shoe"],u:"1f45e",a:"0.6"},{n:["athletic shoe"],u:"1f45f",a:"0.6"},{n:["hiking boot"],u:"1f97e",a:"11.0"},{n:["flat shoe","womans flat shoe"],u:"1f97f",a:"11.0"},{n:["high heel","high-heeled shoe"],u:"1f460",a:"0.6"},{n:["sandal","womans sandal"],u:"1f461",a:"0.6"},{n:["ballet shoes"],u:"1fa70",a:"12.0"},{n:["boot","womans boots"],u:"1f462",a:"0.6"},{n:["hair pick"],u:"1faae",a:"15.0"},{n:["crown"],u:"1f451",a:"0.6"},{n:["womans hat"],u:"1f452",a:"0.6"},{n:["tophat","top hat"],u:"1f3a9",a:"0.6"},{n:["mortar board","graduation cap"],u:"1f393",a:"0.6"},{n:["billed cap"],u:"1f9e2",a:"5.0"},{n:["military helmet"],u:"1fa96",a:"13.0"},{n:["rescue workers helmet","helmet with white cross"],u:"26d1-fe0f",a:"0.7"},{n:["prayer beads"],u:"1f4ff",a:"1.0"},{n:["lipstick"],u:"1f484",a:"0.6"},{n:["ring"],u:"1f48d",a:"0.6"},{n:["gem","gem stone"],u:"1f48e",a:"0.6"},{n:["mute","speaker with cancellation stroke"],u:"1f507",a:"1.0"},{n:["speaker"],u:"1f508",a:"0.7"},{n:["sound","speaker with one sound wave"],u:"1f509",a:"1.0"},{n:["loud sound","speaker with three sound waves"],u:"1f50a",a:"0.6"},{n:["loudspeaker","public address loudspeaker"],u:"1f4e2",a:"0.6"},{n:["mega","cheering megaphone"],u:"1f4e3",a:"0.6"},{n:["postal horn"],u:"1f4ef",a:"1.0"},{n:["bell"],u:"1f514",a:"0.6"},{n:["no bell","bell with cancellation stroke"],u:"1f515",a:"1.0"},{n:["musical score"],u:"1f3bc",a:"0.6"},{n:["musical note"],u:"1f3b5",a:"0.6"},{n:["notes","multiple musical notes"],u:"1f3b6",a:"0.6"},{n:["studio microphone"],u:"1f399-fe0f",a:"0.7"},{n:["level slider"],u:"1f39a-fe0f",a:"0.7"},{n:["control knobs"],u:"1f39b-fe0f",a:"0.7"},{n:["microphone"],u:"1f3a4",a:"0.6"},{n:["headphone","headphones"],u:"1f3a7",a:"0.6"},{n:["radio"],u:"1f4fb",a:"0.6"},{n:["saxophone"],u:"1f3b7",a:"0.6"},{n:["accordion"],u:"1fa97",a:"13.0"},{n:["guitar"],u:"1f3b8",a:"0.6"},{n:["musical keyboard"],u:"1f3b9",a:"0.6"},{n:["trumpet"],u:"1f3ba",a:"0.6"},{n:["violin"],u:"1f3bb",a:"0.6"},{n:["banjo"],u:"1fa95",a:"12.0"},{n:["drum with drumsticks"],u:"1f941",a:"3.0"},{n:["long drum"],u:"1fa98",a:"13.0"},{n:["maracas"],u:"1fa87",a:"15.0"},{n:["flute"],u:"1fa88",a:"15.0"},{n:["iphone","mobile phone"],u:"1f4f1",a:"0.6"},{n:["calling","mobile phone with rightwards arrow at left"],u:"1f4f2",a:"0.6"},{n:["phone","telephone","black telephone"],u:"260e-fe0f",a:"0.6"},{n:["telephone receiver"],u:"1f4de",a:"0.6"},{n:["pager"],u:"1f4df",a:"0.6"},{n:["fax","fax machine"],u:"1f4e0",a:"0.6"},{n:["battery"],u:"1f50b",a:"0.6"},{n:["low battery"],u:"1faab",a:"14.0"},{n:["electric plug"],u:"1f50c",a:"0.6"},{n:["computer","personal computer"],u:"1f4bb",a:"0.6"},{n:["desktop computer"],u:"1f5a5-fe0f",a:"0.7"},{n:["printer"],u:"1f5a8-fe0f",a:"0.7"},{n:["keyboard"],u:"2328-fe0f",a:"1.0"},{n:["computer mouse","three button mouse"],u:"1f5b1-fe0f",a:"0.7"},{n:["trackball"],u:"1f5b2-fe0f",a:"0.7"},{n:["minidisc"],u:"1f4bd",a:"0.6"},{n:["floppy disk"],u:"1f4be",a:"0.6"},{n:["cd","optical disc"],u:"1f4bf",a:"0.6"},{n:["dvd"],u:"1f4c0",a:"0.6"},{n:["abacus"],u:"1f9ee",a:"11.0"},{n:["movie camera"],u:"1f3a5",a:"0.6"},{n:["film frames"],u:"1f39e-fe0f",a:"0.7"},{n:["film projector"],u:"1f4fd-fe0f",a:"0.7"},{n:["clapper","clapper board"],u:"1f3ac",a:"0.6"},{n:["tv","television"],u:"1f4fa",a:"0.6"},{n:["camera"],u:"1f4f7",a:"0.6"},{n:["camera with flash"],u:"1f4f8",a:"1.0"},{n:["video camera"],u:"1f4f9",a:"0.6"},{n:["vhs","videocassette"],u:"1f4fc",a:"0.6"},{n:["mag","left-pointing magnifying glass"],u:"1f50d",a:"0.6"},{n:["mag right","right-pointing magnifying glass"],u:"1f50e",a:"0.6"},{n:["candle"],u:"1f56f-fe0f",a:"0.7"},{n:["bulb","electric light bulb"],u:"1f4a1",a:"0.6"},{n:["flashlight","electric torch"],u:"1f526",a:"0.6"},{n:["lantern","izakaya lantern"],u:"1f3ee",a:"0.6"},{n:["diya lamp"],u:"1fa94",a:"12.0"},{n:["notebook with decorative cover"],u:"1f4d4",a:"0.6"},{n:["closed book"],u:"1f4d5",a:"0.6"},{n:["book","open book"],u:"1f4d6",a:"0.6"},{n:["green book"],u:"1f4d7",a:"0.6"},{n:["blue book"],u:"1f4d8",a:"0.6"},{n:["orange book"],u:"1f4d9",a:"0.6"},{n:["books"],u:"1f4da",a:"0.6"},{n:["notebook"],u:"1f4d3",a:"0.6"},{n:["ledger"],u:"1f4d2",a:"0.6"},{n:["page with curl"],u:"1f4c3",a:"0.6"},{n:["scroll"],u:"1f4dc",a:"0.6"},{n:["page facing up"],u:"1f4c4",a:"0.6"},{n:["newspaper"],u:"1f4f0",a:"0.6"},{n:["rolled-up newspaper","rolled up newspaper"],u:"1f5de-fe0f",a:"0.7"},{n:["bookmark tabs"],u:"1f4d1",a:"0.6"},{n:["bookmark"],u:"1f516",a:"0.6"},{n:["label"],u:"1f3f7-fe0f",a:"0.7"},{n:["moneybag","money bag"],u:"1f4b0",a:"0.6"},{n:["coin"],u:"1fa99",a:"13.0"},{n:["yen","banknote with yen sign"],u:"1f4b4",a:"0.6"},{n:["dollar","banknote with dollar sign"],u:"1f4b5",a:"0.6"},{n:["euro","banknote with euro sign"],u:"1f4b6",a:"1.0"},{n:["pound","banknote with pound sign"],u:"1f4b7",a:"1.0"},{n:["money with wings"],u:"1f4b8",a:"0.6"},{n:["credit card"],u:"1f4b3",a:"0.6"},{n:["receipt"],u:"1f9fe",a:"11.0"},{n:["chart","chart with upwards trend and yen sign"],u:"1f4b9",a:"0.6"},{n:["email","envelope"],u:"2709-fe0f",a:"0.6"},{n:["e-mail","e-mail symbol"],u:"1f4e7",a:"0.6"},{n:["incoming envelope"],u:"1f4e8",a:"0.6"},{n:["envelope with arrow","envelope with downwards arrow above"],u:"1f4e9",a:"0.6"},{n:["outbox tray"],u:"1f4e4",a:"0.6"},{n:["inbox tray"],u:"1f4e5",a:"0.6"},{n:["package"],u:"1f4e6",a:"0.6"},{n:["mailbox","closed mailbox with raised flag"],u:"1f4eb",a:"0.6"},{n:["mailbox closed","closed mailbox with lowered flag"],u:"1f4ea",a:"0.6"},{n:["mailbox with mail","open mailbox with raised flag"],u:"1f4ec",a:"0.7"},{n:["mailbox with no mail","open mailbox with lowered flag"],u:"1f4ed",a:"0.7"},{n:["postbox"],u:"1f4ee",a:"0.6"},{n:["ballot box with ballot"],u:"1f5f3-fe0f",a:"0.7"},{n:["pencil","pencil2"],u:"270f-fe0f",a:"0.6"},{n:["black nib"],u:"2712-fe0f",a:"0.6"},{n:["fountain pen","lower left fountain pen"],u:"1f58b-fe0f",a:"0.7"},{n:["pen","lower left ballpoint pen"],u:"1f58a-fe0f",a:"0.7"},{n:["paintbrush","lower left paintbrush"],u:"1f58c-fe0f",a:"0.7"},{n:["crayon","lower left crayon"],u:"1f58d-fe0f",a:"0.7"},{n:["memo","pencil"],u:"1f4dd",a:"0.6"},{n:["briefcase"],u:"1f4bc",a:"0.6"},{n:["file folder"],u:"1f4c1",a:"0.6"},{n:["open file folder"],u:"1f4c2",a:"0.6"},{n:["card index dividers"],u:"1f5c2-fe0f",a:"0.7"},{n:["date","calendar"],u:"1f4c5",a:"0.6"},{n:["calendar","tear-off calendar"],u:"1f4c6",a:"0.6"},{n:["spiral notepad","spiral note pad"],u:"1f5d2-fe0f",a:"0.7"},{n:["spiral calendar","spiral calendar pad"],u:"1f5d3-fe0f",a:"0.7"},{n:["card index"],u:"1f4c7",a:"0.6"},{n:["chart with upwards trend"],u:"1f4c8",a:"0.6"},{n:["chart with downwards trend"],u:"1f4c9",a:"0.6"},{n:["bar chart"],u:"1f4ca",a:"0.6"},{n:["clipboard"],u:"1f4cb",a:"0.6"},{n:["pushpin"],u:"1f4cc",a:"0.6"},{n:["round pushpin"],u:"1f4cd",a:"0.6"},{n:["paperclip"],u:"1f4ce",a:"0.6"},{n:["linked paperclips"],u:"1f587-fe0f",a:"0.7"},{n:["straight ruler"],u:"1f4cf",a:"0.6"},{n:["triangular ruler"],u:"1f4d0",a:"0.6"},{n:["scissors","black scissors"],u:"2702-fe0f",a:"0.6"},{n:["card file box"],u:"1f5c3-fe0f",a:"0.7"},{n:["file cabinet"],u:"1f5c4-fe0f",a:"0.7"},{n:["wastebasket"],u:"1f5d1-fe0f",a:"0.7"},{n:["lock"],u:"1f512",a:"0.6"},{n:["unlock","open lock"],u:"1f513",a:"0.6"},{n:["lock with ink pen"],u:"1f50f",a:"0.6"},{n:["closed lock with key"],u:"1f510",a:"0.6"},{n:["key"],u:"1f511",a:"0.6"},{n:["old key"],u:"1f5dd-fe0f",a:"0.7"},{n:["hammer"],u:"1f528",a:"0.6"},{n:["axe"],u:"1fa93",a:"12.0"},{n:["pick"],u:"26cf-fe0f",a:"0.7"},{n:["hammer and pick"],u:"2692-fe0f",a:"1.0"},{n:["hammer and wrench"],u:"1f6e0-fe0f",a:"0.7"},{n:["dagger","dagger knife"],u:"1f5e1-fe0f",a:"0.7"},{n:["crossed swords"],u:"2694-fe0f",a:"1.0"},{n:["bomb"],u:"1f4a3",a:"0.6"},{n:["boomerang"],u:"1fa83",a:"13.0"},{n:["bow and arrow"],u:"1f3f9",a:"1.0"},{n:["shield"],u:"1f6e1-fe0f",a:"0.7"},{n:["carpentry saw"],u:"1fa9a",a:"13.0"},{n:["wrench"],u:"1f527",a:"0.6"},{n:["screwdriver"],u:"1fa9b",a:"13.0"},{n:["nut and bolt"],u:"1f529",a:"0.6"},{n:["gear"],u:"2699-fe0f",a:"1.0"},{n:["clamp","compression"],u:"1f5dc-fe0f",a:"0.7"},{n:["scales","balance scale"],u:"2696-fe0f",a:"1.0"},{n:["probing cane"],u:"1f9af",a:"12.0"},{n:["link","link symbol"],u:"1f517",a:"0.6"},{n:["broken chain"],u:"26d3-fe0f-200d-1f4a5",a:"15.1"},{n:["chains"],u:"26d3-fe0f",a:"0.7"},{n:["hook"],u:"1fa9d",a:"13.0"},{n:["toolbox"],u:"1f9f0",a:"11.0"},{n:["magnet"],u:"1f9f2",a:"11.0"},{n:["ladder"],u:"1fa9c",a:"13.0"},{n:["alembic"],u:"2697-fe0f",a:"1.0"},{n:["test tube"],u:"1f9ea",a:"11.0"},{n:["petri dish"],u:"1f9eb",a:"11.0"},{n:["dna","dna double helix"],u:"1f9ec",a:"11.0"},{n:["microscope"],u:"1f52c",a:"1.0"},{n:["telescope"],u:"1f52d",a:"1.0"},{n:["satellite antenna"],u:"1f4e1",a:"0.6"},{n:["syringe"],u:"1f489",a:"0.6"},{n:["drop of blood"],u:"1fa78",a:"12.0"},{n:["pill"],u:"1f48a",a:"0.6"},{n:["adhesive bandage"],u:"1fa79",a:"12.0"},{n:["crutch"],u:"1fa7c",a:"14.0"},{n:["stethoscope"],u:"1fa7a",a:"12.0"},{n:["x-ray"],u:"1fa7b",a:"14.0"},{n:["door"],u:"1f6aa",a:"0.6"},{n:["elevator"],u:"1f6d7",a:"13.0"},{n:["mirror"],u:"1fa9e",a:"13.0"},{n:["window"],u:"1fa9f",a:"13.0"},{n:["bed"],u:"1f6cf-fe0f",a:"0.7"},{n:["couch and lamp"],u:"1f6cb-fe0f",a:"0.7"},{n:["chair"],u:"1fa91",a:"12.0"},{n:["toilet"],u:"1f6bd",a:"0.6"},{n:["plunger"],u:"1faa0",a:"13.0"},{n:["shower"],u:"1f6bf",a:"1.0"},{n:["bathtub"],u:"1f6c1",a:"1.0"},{n:["mouse trap"],u:"1faa4",a:"13.0"},{n:["razor"],u:"1fa92",a:"12.0"},{n:["lotion bottle"],u:"1f9f4",a:"11.0"},{n:["safety pin"],u:"1f9f7",a:"11.0"},{n:["broom"],u:"1f9f9",a:"11.0"},{n:["basket"],u:"1f9fa",a:"11.0"},{n:["roll of paper"],u:"1f9fb",a:"11.0"},{n:["bucket"],u:"1faa3",a:"13.0"},{n:["soap","bar of soap"],u:"1f9fc",a:"11.0"},{n:["bubbles"],u:"1fae7",a:"14.0"},{n:["toothbrush"],u:"1faa5",a:"13.0"},{n:["sponge"],u:"1f9fd",a:"11.0"},{n:["fire extinguisher"],u:"1f9ef",a:"11.0"},{n:["shopping trolley"],u:"1f6d2",a:"3.0"},{n:["smoking","smoking symbol"],u:"1f6ac",a:"0.6"},{n:["coffin"],u:"26b0-fe0f",a:"1.0"},{n:["headstone"],u:"1faa6",a:"13.0"},{n:["funeral urn"],u:"26b1-fe0f",a:"1.0"},{n:["nazar amulet"],u:"1f9ff",a:"11.0"},{n:["hamsa"],u:"1faac",a:"14.0"},{n:["moyai"],u:"1f5ff",a:"0.6"},{n:["placard"],u:"1faa7",a:"13.0"},{n:["identification card"],u:"1faaa",a:"14.0"}],Qit=[{n:["atm","automated teller machine"],u:"1f3e7",a:"0.6"},{n:["put litter in its place","put litter in its place symbol"],u:"1f6ae",a:"1.0"},{n:["potable water","potable water symbol"],u:"1f6b0",a:"1.0"},{n:["wheelchair","wheelchair symbol"],u:"267f",a:"0.6"},{n:["mens","mens symbol"],u:"1f6b9",a:"0.6"},{n:["womens","womens symbol"],u:"1f6ba",a:"0.6"},{n:["restroom"],u:"1f6bb",a:"0.6"},{n:["baby symbol"],u:"1f6bc",a:"0.6"},{n:["wc","water closet"],u:"1f6be",a:"0.6"},{n:["passport control"],u:"1f6c2",a:"1.0"},{n:["customs"],u:"1f6c3",a:"1.0"},{n:["baggage claim"],u:"1f6c4",a:"1.0"},{n:["left luggage"],u:"1f6c5",a:"1.0"},{n:["warning","warning sign"],u:"26a0-fe0f",a:"0.6"},{n:["children crossing"],u:"1f6b8",a:"1.0"},{n:["no entry"],u:"26d4",a:"0.6"},{n:["no entry sign"],u:"1f6ab",a:"0.6"},{n:["no bicycles"],u:"1f6b3",a:"1.0"},{n:["no smoking","no smoking symbol"],u:"1f6ad",a:"0.6"},{n:["do not litter","do not litter symbol"],u:"1f6af",a:"1.0"},{n:["non-potable water","non-potable water symbol"],u:"1f6b1",a:"1.0"},{n:["no pedestrians"],u:"1f6b7",a:"1.0"},{n:["no mobile phones"],u:"1f4f5",a:"1.0"},{n:["underage","no one under eighteen symbol"],u:"1f51e",a:"0.6"},{n:["radioactive","radioactive sign"],u:"2622-fe0f",a:"1.0"},{n:["biohazard","biohazard sign"],u:"2623-fe0f",a:"1.0"},{n:["arrow up","upwards black arrow"],u:"2b06-fe0f",a:"0.6"},{n:["north east arrow","arrow upper right"],u:"2197-fe0f",a:"0.6"},{n:["arrow right","black rightwards arrow"],u:"27a1-fe0f",a:"0.6"},{n:["south east arrow","arrow lower right"],u:"2198-fe0f",a:"0.6"},{n:["arrow down","downwards black arrow"],u:"2b07-fe0f",a:"0.6"},{n:["south west arrow","arrow lower left"],u:"2199-fe0f",a:"0.6"},{n:["arrow left","leftwards black arrow"],u:"2b05-fe0f",a:"0.6"},{n:["north west arrow","arrow upper left"],u:"2196-fe0f",a:"0.6"},{n:["up down arrow","arrow up down"],u:"2195-fe0f",a:"0.6"},{n:["left right arrow"],u:"2194-fe0f",a:"0.6"},{n:["leftwards arrow with hook"],u:"21a9-fe0f",a:"0.6"},{n:["arrow right hook","rightwards arrow with hook"],u:"21aa-fe0f",a:"0.6"},{n:["arrow heading up","arrow pointing rightwards then curving upwards"],u:"2934-fe0f",a:"0.6"},{n:["arrow heading down","arrow pointing rightwards then curving downwards"],u:"2935-fe0f",a:"0.6"},{n:["arrows clockwise","clockwise downwards and upwards open circle arrows"],u:"1f503",a:"0.6"},{n:["arrows counterclockwise","anticlockwise downwards and upwards open circle arrows"],u:"1f504",a:"1.0"},{n:["back","back with leftwards arrow above"],u:"1f519",a:"0.6"},{n:["end","end with leftwards arrow above"],u:"1f51a",a:"0.6"},{n:["on","on with exclamation mark with left right arrow above"],u:"1f51b",a:"0.6"},{n:["soon","soon with rightwards arrow above"],u:"1f51c",a:"0.6"},{n:["top","top with upwards arrow above"],u:"1f51d",a:"0.6"},{n:["place of worship"],u:"1f6d0",a:"1.0"},{n:["atom symbol"],u:"269b-fe0f",a:"1.0"},{n:["om","om symbol"],u:"1f549-fe0f",a:"0.7"},{n:["star of david"],u:"2721-fe0f",a:"0.7"},{n:["wheel of dharma"],u:"2638-fe0f",a:"0.7"},{n:["yin yang"],u:"262f-fe0f",a:"0.7"},{n:["latin cross"],u:"271d-fe0f",a:"0.7"},{n:["orthodox cross"],u:"2626-fe0f",a:"1.0"},{n:["star and crescent"],u:"262a-fe0f",a:"0.7"},{n:["peace symbol"],u:"262e-fe0f",a:"1.0"},{n:["menorah with nine branches"],u:"1f54e",a:"1.0"},{n:["six pointed star","six pointed star with middle dot"],u:"1f52f",a:"0.6"},{n:["khanda"],u:"1faaf",a:"15.0"},{n:["aries"],u:"2648",a:"0.6"},{n:["taurus"],u:"2649",a:"0.6"},{n:["gemini"],u:"264a",a:"0.6"},{n:["cancer"],u:"264b",a:"0.6"},{n:["leo"],u:"264c",a:"0.6"},{n:["virgo"],u:"264d",a:"0.6"},{n:["libra"],u:"264e",a:"0.6"},{n:["scorpius"],u:"264f",a:"0.6"},{n:["sagittarius"],u:"2650",a:"0.6"},{n:["capricorn"],u:"2651",a:"0.6"},{n:["aquarius"],u:"2652",a:"0.6"},{n:["pisces"],u:"2653",a:"0.6"},{n:["ophiuchus"],u:"26ce",a:"0.6"},{n:["twisted rightwards arrows"],u:"1f500",a:"1.0"},{n:["repeat","clockwise rightwards and leftwards open circle arrows"],u:"1f501",a:"1.0"},{n:["repeat one","clockwise rightwards and leftwards open circle arrows with circled one overlay"],u:"1f502",a:"1.0"},{n:["arrow forward","black right-pointing triangle"],u:"25b6-fe0f",a:"0.6"},{n:["fast forward","black right-pointing double triangle"],u:"23e9",a:"0.6"},{n:["next track button","black right pointing double triangle with vertical bar"],u:"23ed-fe0f",a:"0.7"},{n:["play or pause button","black right pointing triangle with double vertical bar"],u:"23ef-fe0f",a:"1.0"},{n:["arrow backward","black left-pointing triangle"],u:"25c0-fe0f",a:"0.6"},{n:["rewind","black left-pointing double triangle"],u:"23ea",a:"0.6"},{n:["last track button","black left pointing double triangle with vertical bar"],u:"23ee-fe0f",a:"0.7"},{n:["arrow up small","up-pointing small red triangle"],u:"1f53c",a:"0.6"},{n:["arrow double up","black up-pointing double triangle"],u:"23eb",a:"0.6"},{n:["arrow down small","down-pointing small red triangle"],u:"1f53d",a:"0.6"},{n:["arrow double down","black down-pointing double triangle"],u:"23ec",a:"0.6"},{n:["pause button","double vertical bar"],u:"23f8-fe0f",a:"0.7"},{n:["stop button","black square for stop"],u:"23f9-fe0f",a:"0.7"},{n:["record button","black circle for record"],u:"23fa-fe0f",a:"0.7"},{n:["eject","eject button"],u:"23cf-fe0f",a:"1.0"},{n:["cinema"],u:"1f3a6",a:"0.6"},{n:["low brightness","low brightness symbol"],u:"1f505",a:"1.0"},{n:["high brightness","high brightness symbol"],u:"1f506",a:"1.0"},{n:["signal strength","antenna with bars"],u:"1f4f6",a:"0.6"},{n:["wireless"],u:"1f6dc",a:"15.0"},{n:["vibration mode"],u:"1f4f3",a:"0.6"},{n:["mobile phone off"],u:"1f4f4",a:"0.6"},{n:["female sign"],u:"2640-fe0f",a:"4.0"},{n:["male sign"],u:"2642-fe0f",a:"4.0"},{n:["transgender symbol"],u:"26a7-fe0f",a:"13.0"},{n:["heavy multiplication x"],u:"2716-fe0f",a:"0.6"},{n:["heavy plus sign"],u:"2795",a:"0.6"},{n:["heavy minus sign"],u:"2796",a:"0.6"},{n:["heavy division sign"],u:"2797",a:"0.6"},{n:["heavy equals sign"],u:"1f7f0",a:"14.0"},{n:["infinity"],u:"267e-fe0f",a:"11.0"},{n:["bangbang","double exclamation mark"],u:"203c-fe0f",a:"0.6"},{n:["interrobang","exclamation question mark"],u:"2049-fe0f",a:"0.6"},{n:["question","black question mark ornament"],u:"2753",a:"0.6"},{n:["grey question","white question mark ornament"],u:"2754",a:"0.6"},{n:["grey exclamation","white exclamation mark ornament"],u:"2755",a:"0.6"},{n:["exclamation","heavy exclamation mark","heavy exclamation mark symbol"],u:"2757",a:"0.6"},{n:["wavy dash"],u:"3030-fe0f",a:"0.6"},{n:["currency exchange"],u:"1f4b1",a:"0.6"},{n:["heavy dollar sign"],u:"1f4b2",a:"0.6"},{n:["medical symbol","staff of aesculapius"],u:"2695-fe0f",a:"4.0"},{n:["recycle","black universal recycling symbol"],u:"267b-fe0f",a:"0.6"},{n:["fleur-de-lis","fleur de lis"],u:"269c-fe0f",a:"1.0"},{n:["trident","trident emblem"],u:"1f531",a:"0.6"},{n:["name badge"],u:"1f4db",a:"0.6"},{n:["beginner","japanese symbol for beginner"],u:"1f530",a:"0.6"},{n:["o","heavy large circle"],u:"2b55",a:"0.6"},{n:["white check mark","white heavy check mark"],u:"2705",a:"0.6"},{n:["ballot box with check"],u:"2611-fe0f",a:"0.6"},{n:["heavy check mark"],u:"2714-fe0f",a:"0.6"},{n:["x","cross mark"],u:"274c",a:"0.6"},{n:["negative squared cross mark"],u:"274e",a:"0.6"},{n:["curly loop"],u:"27b0",a:"0.6"},{n:["loop","double curly loop"],u:"27bf",a:"1.0"},{n:["part alternation mark"],u:"303d-fe0f",a:"0.6"},{n:["eight spoked asterisk"],u:"2733-fe0f",a:"0.6"},{n:["eight pointed black star"],u:"2734-fe0f",a:"0.6"},{n:["sparkle"],u:"2747-fe0f",a:"0.6"},{n:["copyright","copyright sign"],u:"00a9-fe0f",a:"0.6"},{n:["registered","registered sign"],u:"00ae-fe0f",a:"0.6"},{n:["tm","trade mark sign"],u:"2122-fe0f",a:"0.6"},{n:["hash","hash key"],u:"0023-fe0f-20e3",a:"0.6"},{n:["keycap: *","keycap star"],u:"002a-fe0f-20e3",a:"2.0"},{n:["zero","keycap 0"],u:"0030-fe0f-20e3",a:"0.6"},{n:["one","keycap 1"],u:"0031-fe0f-20e3",a:"0.6"},{n:["two","keycap 2"],u:"0032-fe0f-20e3",a:"0.6"},{n:["three","keycap 3"],u:"0033-fe0f-20e3",a:"0.6"},{n:["four","keycap 4"],u:"0034-fe0f-20e3",a:"0.6"},{n:["five","keycap 5"],u:"0035-fe0f-20e3",a:"0.6"},{n:["six","keycap 6"],u:"0036-fe0f-20e3",a:"0.6"},{n:["seven","keycap 7"],u:"0037-fe0f-20e3",a:"0.6"},{n:["eight","keycap 8"],u:"0038-fe0f-20e3",a:"0.6"},{n:["nine","keycap 9"],u:"0039-fe0f-20e3",a:"0.6"},{n:["keycap ten"],u:"1f51f",a:"0.6"},{n:["capital abcd","input symbol for latin capital letters"],u:"1f520",a:"0.6"},{n:["abcd","input symbol for latin small letters"],u:"1f521",a:"0.6"},{n:["1234","input symbol for numbers"],u:"1f522",a:"0.6"},{n:["symbols","input symbol for symbols"],u:"1f523",a:"0.6"},{n:["abc","input symbol for latin letters"],u:"1f524",a:"0.6"},{n:["a","negative squared latin capital letter a"],u:"1f170-fe0f",a:"0.6"},{n:["ab","negative squared ab"],u:"1f18e",a:"0.6"},{n:["b","negative squared latin capital letter b"],u:"1f171-fe0f",a:"0.6"},{n:["cl","squared cl"],u:"1f191",a:"0.6"},{n:["cool","squared cool"],u:"1f192",a:"0.6"},{n:["free","squared free"],u:"1f193",a:"0.6"},{n:["information source"],u:"2139-fe0f",a:"0.6"},{n:["id","squared id"],u:"1f194",a:"0.6"},{n:["m","circled latin capital letter m"],u:"24c2-fe0f",a:"0.6"},{n:["new","squared new"],u:"1f195",a:"0.6"},{n:["ng","squared ng"],u:"1f196",a:"0.6"},{n:["o2","negative squared latin capital letter o"],u:"1f17e-fe0f",a:"0.6"},{n:["ok","squared ok"],u:"1f197",a:"0.6"},{n:["parking","negative squared latin capital letter p"],u:"1f17f-fe0f",a:"0.6"},{n:["sos","squared sos"],u:"1f198",a:"0.6"},{n:["up","squared up with exclamation mark"],u:"1f199",a:"0.6"},{n:["vs","squared vs"],u:"1f19a",a:"0.6"},{n:["koko","squared katakana koko"],u:"1f201",a:"0.6"},{n:["sa","squared katakana sa"],u:"1f202-fe0f",a:"0.6"},{n:["u6708","squared cjk unified ideograph-6708"],u:"1f237-fe0f",a:"0.6"},{n:["u6709","squared cjk unified ideograph-6709"],u:"1f236",a:"0.6"},{n:["u6307","squared cjk unified ideograph-6307"],u:"1f22f",a:"0.6"},{n:["ideograph advantage","circled ideograph advantage"],u:"1f250",a:"0.6"},{n:["u5272","squared cjk unified ideograph-5272"],u:"1f239",a:"0.6"},{n:["u7121","squared cjk unified ideograph-7121"],u:"1f21a",a:"0.6"},{n:["u7981","squared cjk unified ideograph-7981"],u:"1f232",a:"0.6"},{n:["accept","circled ideograph accept"],u:"1f251",a:"0.6"},{n:["u7533","squared cjk unified ideograph-7533"],u:"1f238",a:"0.6"},{n:["u5408","squared cjk unified ideograph-5408"],u:"1f234",a:"0.6"},{n:["u7a7a","squared cjk unified ideograph-7a7a"],u:"1f233",a:"0.6"},{n:["congratulations","circled ideograph congratulation"],u:"3297-fe0f",a:"0.6"},{n:["secret","circled ideograph secret"],u:"3299-fe0f",a:"0.6"},{n:["u55b6","squared cjk unified ideograph-55b6"],u:"1f23a",a:"0.6"},{n:["u6e80","squared cjk unified ideograph-6e80"],u:"1f235",a:"0.6"},{n:["red circle","large red circle"],u:"1f534",a:"0.6"},{n:["large orange circle"],u:"1f7e0",a:"12.0"},{n:["large yellow circle"],u:"1f7e1",a:"12.0"},{n:["large green circle"],u:"1f7e2",a:"12.0"},{n:["large blue circle"],u:"1f535",a:"0.6"},{n:["large purple circle"],u:"1f7e3",a:"12.0"},{n:["large brown circle"],u:"1f7e4",a:"12.0"},{n:["black circle","medium black circle"],u:"26ab",a:"0.6"},{n:["white circle","medium white circle"],u:"26aa",a:"0.6"},{n:["large red square"],u:"1f7e5",a:"12.0"},{n:["large orange square"],u:"1f7e7",a:"12.0"},{n:["large yellow square"],u:"1f7e8",a:"12.0"},{n:["large green square"],u:"1f7e9",a:"12.0"},{n:["large blue square"],u:"1f7e6",a:"12.0"},{n:["large purple square"],u:"1f7ea",a:"12.0"},{n:["large brown square"],u:"1f7eb",a:"12.0"},{n:["black large square"],u:"2b1b",a:"0.6"},{n:["white large square"],u:"2b1c",a:"0.6"},{n:["black medium square"],u:"25fc-fe0f",a:"0.6"},{n:["white medium square"],u:"25fb-fe0f",a:"0.6"},{n:["black medium small square"],u:"25fe",a:"0.6"},{n:["white medium small square"],u:"25fd",a:"0.6"},{n:["black small square"],u:"25aa-fe0f",a:"0.6"},{n:["white small square"],u:"25ab-fe0f",a:"0.6"},{n:["large orange diamond"],u:"1f536",a:"0.6"},{n:["large blue diamond"],u:"1f537",a:"0.6"},{n:["small orange diamond"],u:"1f538",a:"0.6"},{n:["small blue diamond"],u:"1f539",a:"0.6"},{n:["small red triangle","up-pointing red triangle"],u:"1f53a",a:"0.6"},{n:["small red triangle down","down-pointing red triangle"],u:"1f53b",a:"0.6"},{n:["diamond shape with a dot inside"],u:"1f4a0",a:"0.6"},{n:["radio button"],u:"1f518",a:"0.6"},{n:["white square button"],u:"1f533",a:"0.6"},{n:["black square button"],u:"1f532",a:"0.6"}],Jit=[{n:["chequered flag","checkered flag"],u:"1f3c1",a:"0.6"},{n:["triangular flag on post"],u:"1f6a9",a:"0.6"},{n:["crossed flags"],u:"1f38c",a:"0.6"},{n:["waving black flag"],u:"1f3f4",a:"1.0"},{n:["white flag","waving white flag"],u:"1f3f3-fe0f",a:"0.7"},{n:["rainbow flag","rainbow-flag"],u:"1f3f3-fe0f-200d-1f308",a:"4.0"},{n:["transgender flag"],u:"1f3f3-fe0f-200d-26a7-fe0f",a:"13.0"},{n:["pirate flag"],u:"1f3f4-200d-2620-fe0f",a:"11.0"},{n:["flag-ac","ascension island flag"],u:"1f1e6-1f1e8",a:"2.0"},{n:["flag-ad","andorra flag"],u:"1f1e6-1f1e9",a:"2.0"},{n:["flag-ae","united arab emirates flag"],u:"1f1e6-1f1ea",a:"2.0"},{n:["flag-af","afghanistan flag"],u:"1f1e6-1f1eb",a:"2.0"},{n:["flag-ag","antigua & barbuda flag"],u:"1f1e6-1f1ec",a:"2.0"},{n:["flag-ai","anguilla flag"],u:"1f1e6-1f1ee",a:"2.0"},{n:["flag-al","albania flag"],u:"1f1e6-1f1f1",a:"2.0"},{n:["flag-am","armenia flag"],u:"1f1e6-1f1f2",a:"2.0"},{n:["flag-ao","angola flag"],u:"1f1e6-1f1f4",a:"2.0"},{n:["flag-aq","antarctica flag"],u:"1f1e6-1f1f6",a:"2.0"},{n:["flag-ar","argentina flag"],u:"1f1e6-1f1f7",a:"2.0"},{n:["flag-as","american samoa flag"],u:"1f1e6-1f1f8",a:"2.0"},{n:["flag-at","austria flag"],u:"1f1e6-1f1f9",a:"2.0"},{n:["flag-au","australia flag"],u:"1f1e6-1f1fa",a:"2.0"},{n:["flag-aw","aruba flag"],u:"1f1e6-1f1fc",a:"2.0"},{n:["flag-ax","land islands flag"],u:"1f1e6-1f1fd",a:"2.0"},{n:["flag-az","azerbaijan flag"],u:"1f1e6-1f1ff",a:"2.0"},{n:["flag-ba","bosnia & herzegovina flag"],u:"1f1e7-1f1e6",a:"2.0"},{n:["flag-bb","barbados flag"],u:"1f1e7-1f1e7",a:"2.0"},{n:["flag-bd","bangladesh flag"],u:"1f1e7-1f1e9",a:"2.0"},{n:["flag-be","belgium flag"],u:"1f1e7-1f1ea",a:"2.0"},{n:["flag-bf","burkina faso flag"],u:"1f1e7-1f1eb",a:"2.0"},{n:["flag-bg","bulgaria flag"],u:"1f1e7-1f1ec",a:"2.0"},{n:["flag-bh","bahrain flag"],u:"1f1e7-1f1ed",a:"2.0"},{n:["flag-bi","burundi flag"],u:"1f1e7-1f1ee",a:"2.0"},{n:["flag-bj","benin flag"],u:"1f1e7-1f1ef",a:"2.0"},{n:["flag-bl","st. barthlemy flag"],u:"1f1e7-1f1f1",a:"2.0"},{n:["flag-bm","bermuda flag"],u:"1f1e7-1f1f2",a:"2.0"},{n:["flag-bn","brunei flag"],u:"1f1e7-1f1f3",a:"2.0"},{n:["flag-bo","bolivia flag"],u:"1f1e7-1f1f4",a:"2.0"},{n:["flag-bq","caribbean netherlands flag"],u:"1f1e7-1f1f6",a:"2.0"},{n:["flag-br","brazil flag"],u:"1f1e7-1f1f7",a:"2.0"},{n:["flag-bs","bahamas flag"],u:"1f1e7-1f1f8",a:"2.0"},{n:["flag-bt","bhutan flag"],u:"1f1e7-1f1f9",a:"2.0"},{n:["flag-bv","bouvet island flag"],u:"1f1e7-1f1fb",a:"2.0"},{n:["flag-bw","botswana flag"],u:"1f1e7-1f1fc",a:"2.0"},{n:["flag-by","belarus flag"],u:"1f1e7-1f1fe",a:"2.0"},{n:["flag-bz","belize flag"],u:"1f1e7-1f1ff",a:"2.0"},{n:["flag-ca","canada flag"],u:"1f1e8-1f1e6",a:"2.0"},{n:["flag-cc","cocos (keeling) islands flag"],u:"1f1e8-1f1e8",a:"2.0"},{n:["flag-cd","congo - kinshasa flag"],u:"1f1e8-1f1e9",a:"2.0"},{n:["flag-cf","central african republic flag"],u:"1f1e8-1f1eb",a:"2.0"},{n:["flag-cg","congo - brazzaville flag"],u:"1f1e8-1f1ec",a:"2.0"},{n:["flag-ch","switzerland flag"],u:"1f1e8-1f1ed",a:"2.0"},{n:["flag-ci","cte divoire flag"],u:"1f1e8-1f1ee",a:"2.0"},{n:["flag-ck","cook islands flag"],u:"1f1e8-1f1f0",a:"2.0"},{n:["flag-cl","chile flag"],u:"1f1e8-1f1f1",a:"2.0"},{n:["flag-cm","cameroon flag"],u:"1f1e8-1f1f2",a:"2.0"},{n:["cn","flag-cn","china flag"],u:"1f1e8-1f1f3",a:"0.6"},{n:["flag-co","colombia flag"],u:"1f1e8-1f1f4",a:"2.0"},{n:["flag-cp","clipperton island flag"],u:"1f1e8-1f1f5",a:"2.0"},{n:["flag-cr","costa rica flag"],u:"1f1e8-1f1f7",a:"2.0"},{n:["flag-cu","cuba flag"],u:"1f1e8-1f1fa",a:"2.0"},{n:["flag-cv","cape verde flag"],u:"1f1e8-1f1fb",a:"2.0"},{n:["flag-cw","curaao flag"],u:"1f1e8-1f1fc",a:"2.0"},{n:["flag-cx","christmas island flag"],u:"1f1e8-1f1fd",a:"2.0"},{n:["flag-cy","cyprus flag"],u:"1f1e8-1f1fe",a:"2.0"},{n:["flag-cz","czechia flag"],u:"1f1e8-1f1ff",a:"2.0"},{n:["de","flag-de","germany flag"],u:"1f1e9-1f1ea",a:"0.6"},{n:["flag-dg","diego garcia flag"],u:"1f1e9-1f1ec",a:"2.0"},{n:["flag-dj","djibouti flag"],u:"1f1e9-1f1ef",a:"2.0"},{n:["flag-dk","denmark flag"],u:"1f1e9-1f1f0",a:"2.0"},{n:["flag-dm","dominica flag"],u:"1f1e9-1f1f2",a:"2.0"},{n:["flag-do","dominican republic flag"],u:"1f1e9-1f1f4",a:"2.0"},{n:["flag-dz","algeria flag"],u:"1f1e9-1f1ff",a:"2.0"},{n:["flag-ea","ceuta & melilla flag"],u:"1f1ea-1f1e6",a:"2.0"},{n:["flag-ec","ecuador flag"],u:"1f1ea-1f1e8",a:"2.0"},{n:["flag-ee","estonia flag"],u:"1f1ea-1f1ea",a:"2.0"},{n:["flag-eg","egypt flag"],u:"1f1ea-1f1ec",a:"2.0"},{n:["flag-eh","western sahara flag"],u:"1f1ea-1f1ed",a:"2.0"},{n:["flag-er","eritrea flag"],u:"1f1ea-1f1f7",a:"2.0"},{n:["es","flag-es","spain flag"],u:"1f1ea-1f1f8",a:"0.6"},{n:["flag-et","ethiopia flag"],u:"1f1ea-1f1f9",a:"2.0"},{n:["flag-eu","european union flag"],u:"1f1ea-1f1fa",a:"2.0"},{n:["flag-fi","finland flag"],u:"1f1eb-1f1ee",a:"2.0"},{n:["flag-fj","fiji flag"],u:"1f1eb-1f1ef",a:"2.0"},{n:["flag-fk","falkland islands flag"],u:"1f1eb-1f1f0",a:"2.0"},{n:["flag-fm","micronesia flag"],u:"1f1eb-1f1f2",a:"2.0"},{n:["flag-fo","faroe islands flag"],u:"1f1eb-1f1f4",a:"2.0"},{n:["fr","flag-fr","france flag"],u:"1f1eb-1f1f7",a:"0.6"},{n:["flag-ga","gabon flag"],u:"1f1ec-1f1e6",a:"2.0"},{n:["gb","uk","flag-gb","united kingdom flag"],u:"1f1ec-1f1e7",a:"0.6"},{n:["flag-gd","grenada flag"],u:"1f1ec-1f1e9",a:"2.0"},{n:["flag-ge","georgia flag"],u:"1f1ec-1f1ea",a:"2.0"},{n:["flag-gf","french guiana flag"],u:"1f1ec-1f1eb",a:"2.0"},{n:["flag-gg","guernsey flag"],u:"1f1ec-1f1ec",a:"2.0"},{n:["flag-gh","ghana flag"],u:"1f1ec-1f1ed",a:"2.0"},{n:["flag-gi","gibraltar flag"],u:"1f1ec-1f1ee",a:"2.0"},{n:["flag-gl","greenland flag"],u:"1f1ec-1f1f1",a:"2.0"},{n:["flag-gm","gambia flag"],u:"1f1ec-1f1f2",a:"2.0"},{n:["flag-gn","guinea flag"],u:"1f1ec-1f1f3",a:"2.0"},{n:["flag-gp","guadeloupe flag"],u:"1f1ec-1f1f5",a:"2.0"},{n:["flag-gq","equatorial guinea flag"],u:"1f1ec-1f1f6",a:"2.0"},{n:["flag-gr","greece flag"],u:"1f1ec-1f1f7",a:"2.0"},{n:["flag-gs","south georgia & south sandwich islands flag"],u:"1f1ec-1f1f8",a:"2.0"},{n:["flag-gt","guatemala flag"],u:"1f1ec-1f1f9",a:"2.0"},{n:["flag-gu","guam flag"],u:"1f1ec-1f1fa",a:"2.0"},{n:["flag-gw","guinea-bissau flag"],u:"1f1ec-1f1fc",a:"2.0"},{n:["flag-gy","guyana flag"],u:"1f1ec-1f1fe",a:"2.0"},{n:["flag-hk","hong kong sar china flag"],u:"1f1ed-1f1f0",a:"2.0"},{n:["flag-hm","heard & mcdonald islands flag"],u:"1f1ed-1f1f2",a:"2.0"},{n:["flag-hn","honduras flag"],u:"1f1ed-1f1f3",a:"2.0"},{n:["flag-hr","croatia flag"],u:"1f1ed-1f1f7",a:"2.0"},{n:["flag-ht","haiti flag"],u:"1f1ed-1f1f9",a:"2.0"},{n:["flag-hu","hungary flag"],u:"1f1ed-1f1fa",a:"2.0"},{n:["flag-ic","canary islands flag"],u:"1f1ee-1f1e8",a:"2.0"},{n:["flag-id","indonesia flag"],u:"1f1ee-1f1e9",a:"2.0"},{n:["flag-ie","ireland flag"],u:"1f1ee-1f1ea",a:"2.0"},{n:["flag-il","israel flag"],u:"1f1ee-1f1f1",a:"2.0"},{n:["flag-im","isle of man flag"],u:"1f1ee-1f1f2",a:"2.0"},{n:["flag-in","india flag"],u:"1f1ee-1f1f3",a:"2.0"},{n:["flag-io","british indian ocean territory flag"],u:"1f1ee-1f1f4",a:"2.0"},{n:["flag-iq","iraq flag"],u:"1f1ee-1f1f6",a:"2.0"},{n:["flag-ir","iran flag"],u:"1f1ee-1f1f7",a:"2.0"},{n:["flag-is","iceland flag"],u:"1f1ee-1f1f8",a:"2.0"},{n:["it","flag-it","italy flag"],u:"1f1ee-1f1f9",a:"0.6"},{n:["flag-je","jersey flag"],u:"1f1ef-1f1ea",a:"2.0"},{n:["flag-jm","jamaica flag"],u:"1f1ef-1f1f2",a:"2.0"},{n:["flag-jo","jordan flag"],u:"1f1ef-1f1f4",a:"2.0"},{n:["jp","flag-jp","japan flag"],u:"1f1ef-1f1f5",a:"0.6"},{n:["flag-ke","kenya flag"],u:"1f1f0-1f1ea",a:"2.0"},{n:["flag-kg","kyrgyzstan flag"],u:"1f1f0-1f1ec",a:"2.0"},{n:["flag-kh","cambodia flag"],u:"1f1f0-1f1ed",a:"2.0"},{n:["flag-ki","kiribati flag"],u:"1f1f0-1f1ee",a:"2.0"},{n:["flag-km","comoros flag"],u:"1f1f0-1f1f2",a:"2.0"},{n:["flag-kn","st. kitts & nevis flag"],u:"1f1f0-1f1f3",a:"2.0"},{n:["flag-kp","north korea flag"],u:"1f1f0-1f1f5",a:"2.0"},{n:["kr","flag-kr","south korea flag"],u:"1f1f0-1f1f7",a:"0.6"},{n:["flag-kw","kuwait flag"],u:"1f1f0-1f1fc",a:"2.0"},{n:["flag-ky","cayman islands flag"],u:"1f1f0-1f1fe",a:"2.0"},{n:["flag-kz","kazakhstan flag"],u:"1f1f0-1f1ff",a:"2.0"},{n:["flag-la","laos flag"],u:"1f1f1-1f1e6",a:"2.0"},{n:["flag-lb","lebanon flag"],u:"1f1f1-1f1e7",a:"2.0"},{n:["flag-lc","st. lucia flag"],u:"1f1f1-1f1e8",a:"2.0"},{n:["flag-li","liechtenstein flag"],u:"1f1f1-1f1ee",a:"2.0"},{n:["flag-lk","sri lanka flag"],u:"1f1f1-1f1f0",a:"2.0"},{n:["flag-lr","liberia flag"],u:"1f1f1-1f1f7",a:"2.0"},{n:["flag-ls","lesotho flag"],u:"1f1f1-1f1f8",a:"2.0"},{n:["flag-lt","lithuania flag"],u:"1f1f1-1f1f9",a:"2.0"},{n:["flag-lu","luxembourg flag"],u:"1f1f1-1f1fa",a:"2.0"},{n:["flag-lv","latvia flag"],u:"1f1f1-1f1fb",a:"2.0"},{n:["flag-ly","libya flag"],u:"1f1f1-1f1fe",a:"2.0"},{n:["flag-ma","morocco flag"],u:"1f1f2-1f1e6",a:"2.0"},{n:["flag-mc","monaco flag"],u:"1f1f2-1f1e8",a:"2.0"},{n:["flag-md","moldova flag"],u:"1f1f2-1f1e9",a:"2.0"},{n:["flag-me","montenegro flag"],u:"1f1f2-1f1ea",a:"2.0"},{n:["flag-mf","st. martin flag"],u:"1f1f2-1f1eb",a:"2.0"},{n:["flag-mg","madagascar flag"],u:"1f1f2-1f1ec",a:"2.0"},{n:["flag-mh","marshall islands flag"],u:"1f1f2-1f1ed",a:"2.0"},{n:["flag-mk","north macedonia flag"],u:"1f1f2-1f1f0",a:"2.0"},{n:["flag-ml","mali flag"],u:"1f1f2-1f1f1",a:"2.0"},{n:["flag-mm","myanmar (burma) flag"],u:"1f1f2-1f1f2",a:"2.0"},{n:["flag-mn","mongolia flag"],u:"1f1f2-1f1f3",a:"2.0"},{n:["flag-mo","macao sar china flag"],u:"1f1f2-1f1f4",a:"2.0"},{n:["flag-mp","northern mariana islands flag"],u:"1f1f2-1f1f5",a:"2.0"},{n:["flag-mq","martinique flag"],u:"1f1f2-1f1f6",a:"2.0"},{n:["flag-mr","mauritania flag"],u:"1f1f2-1f1f7",a:"2.0"},{n:["flag-ms","montserrat flag"],u:"1f1f2-1f1f8",a:"2.0"},{n:["flag-mt","malta flag"],u:"1f1f2-1f1f9",a:"2.0"},{n:["flag-mu","mauritius flag"],u:"1f1f2-1f1fa",a:"2.0"},{n:["flag-mv","maldives flag"],u:"1f1f2-1f1fb",a:"2.0"},{n:["flag-mw","malawi flag"],u:"1f1f2-1f1fc",a:"2.0"},{n:["flag-mx","mexico flag"],u:"1f1f2-1f1fd",a:"2.0"},{n:["flag-my","malaysia flag"],u:"1f1f2-1f1fe",a:"2.0"},{n:["flag-mz","mozambique flag"],u:"1f1f2-1f1ff",a:"2.0"},{n:["flag-na","namibia flag"],u:"1f1f3-1f1e6",a:"2.0"},{n:["flag-nc","new caledonia flag"],u:"1f1f3-1f1e8",a:"2.0"},{n:["flag-ne","niger flag"],u:"1f1f3-1f1ea",a:"2.0"},{n:["flag-nf","norfolk island flag"],u:"1f1f3-1f1eb",a:"2.0"},{n:["flag-ng","nigeria flag"],u:"1f1f3-1f1ec",a:"2.0"},{n:["flag-ni","nicaragua flag"],u:"1f1f3-1f1ee",a:"2.0"},{n:["flag-nl","netherlands flag"],u:"1f1f3-1f1f1",a:"2.0"},{n:["flag-no","norway flag"],u:"1f1f3-1f1f4",a:"2.0"},{n:["flag-np","nepal flag"],u:"1f1f3-1f1f5",a:"2.0"},{n:["flag-nr","nauru flag"],u:"1f1f3-1f1f7",a:"2.0"},{n:["flag-nu","niue flag"],u:"1f1f3-1f1fa",a:"2.0"},{n:["flag-nz","new zealand flag"],u:"1f1f3-1f1ff",a:"2.0"},{n:["flag-om","oman flag"],u:"1f1f4-1f1f2",a:"2.0"},{n:["flag-pa","panama flag"],u:"1f1f5-1f1e6",a:"2.0"},{n:["flag-pe","peru flag"],u:"1f1f5-1f1ea",a:"2.0"},{n:["flag-pf","french polynesia flag"],u:"1f1f5-1f1eb",a:"2.0"},{n:["flag-pg","papua new guinea flag"],u:"1f1f5-1f1ec",a:"2.0"},{n:["flag-ph","philippines flag"],u:"1f1f5-1f1ed",a:"2.0"},{n:["flag-pk","pakistan flag"],u:"1f1f5-1f1f0",a:"2.0"},{n:["flag-pl","poland flag"],u:"1f1f5-1f1f1",a:"2.0"},{n:["flag-pm","st. pierre & miquelon flag"],u:"1f1f5-1f1f2",a:"2.0"},{n:["flag-pn","pitcairn islands flag"],u:"1f1f5-1f1f3",a:"2.0"},{n:["flag-pr","puerto rico flag"],u:"1f1f5-1f1f7",a:"2.0"},{n:["flag-ps","palestinian territories flag"],u:"1f1f5-1f1f8",a:"2.0"},{n:["flag-pt","portugal flag"],u:"1f1f5-1f1f9",a:"2.0"},{n:["flag-pw","palau flag"],u:"1f1f5-1f1fc",a:"2.0"},{n:["flag-py","paraguay flag"],u:"1f1f5-1f1fe",a:"2.0"},{n:["flag-qa","qatar flag"],u:"1f1f6-1f1e6",a:"2.0"},{n:["flag-re","runion flag"],u:"1f1f7-1f1ea",a:"2.0"},{n:["flag-ro","romania flag"],u:"1f1f7-1f1f4",a:"2.0"},{n:["flag-rs","serbia flag"],u:"1f1f7-1f1f8",a:"2.0"},{n:["ru","flag-ru","russia flag"],u:"1f1f7-1f1fa",a:"0.6"},{n:["flag-rw","rwanda flag"],u:"1f1f7-1f1fc",a:"2.0"},{n:["flag-sa","saudi arabia flag"],u:"1f1f8-1f1e6",a:"2.0"},{n:["flag-sb","solomon islands flag"],u:"1f1f8-1f1e7",a:"2.0"},{n:["flag-sc","seychelles flag"],u:"1f1f8-1f1e8",a:"2.0"},{n:["flag-sd","sudan flag"],u:"1f1f8-1f1e9",a:"2.0"},{n:["flag-se","sweden flag"],u:"1f1f8-1f1ea",a:"2.0"},{n:["flag-sg","singapore flag"],u:"1f1f8-1f1ec",a:"2.0"},{n:["flag-sh","st. helena flag"],u:"1f1f8-1f1ed",a:"2.0"},{n:["flag-si","slovenia flag"],u:"1f1f8-1f1ee",a:"2.0"},{n:["flag-sj","svalbard & jan mayen flag"],u:"1f1f8-1f1ef",a:"2.0"},{n:["flag-sk","slovakia flag"],u:"1f1f8-1f1f0",a:"2.0"},{n:["flag-sl","sierra leone flag"],u:"1f1f8-1f1f1",a:"2.0"},{n:["flag-sm","san marino flag"],u:"1f1f8-1f1f2",a:"2.0"},{n:["flag-sn","senegal flag"],u:"1f1f8-1f1f3",a:"2.0"},{n:["flag-so","somalia flag"],u:"1f1f8-1f1f4",a:"2.0"},{n:["flag-sr","suriname flag"],u:"1f1f8-1f1f7",a:"2.0"},{n:["flag-ss","south sudan flag"],u:"1f1f8-1f1f8",a:"2.0"},{n:["flag-st","so tom & prncipe flag"],u:"1f1f8-1f1f9",a:"2.0"},{n:["flag-sv","el salvador flag"],u:"1f1f8-1f1fb",a:"2.0"},{n:["flag-sx","sint maarten flag"],u:"1f1f8-1f1fd",a:"2.0"},{n:["flag-sy","syria flag"],u:"1f1f8-1f1fe",a:"2.0"},{n:["flag-sz","eswatini flag"],u:"1f1f8-1f1ff",a:"2.0"},{n:["flag-ta","tristan da cunha flag"],u:"1f1f9-1f1e6",a:"2.0"},{n:["flag-tc","turks & caicos islands flag"],u:"1f1f9-1f1e8",a:"2.0"},{n:["flag-td","chad flag"],u:"1f1f9-1f1e9",a:"2.0"},{n:["flag-tf","french southern territories flag"],u:"1f1f9-1f1eb",a:"2.0"},{n:["flag-tg","togo flag"],u:"1f1f9-1f1ec",a:"2.0"},{n:["flag-th","thailand flag"],u:"1f1f9-1f1ed",a:"2.0"},{n:["flag-tj","tajikistan flag"],u:"1f1f9-1f1ef",a:"2.0"},{n:["flag-tk","tokelau flag"],u:"1f1f9-1f1f0",a:"2.0"},{n:["flag-tl","timor-leste flag"],u:"1f1f9-1f1f1",a:"2.0"},{n:["flag-tm","turkmenistan flag"],u:"1f1f9-1f1f2",a:"2.0"},{n:["flag-tn","tunisia flag"],u:"1f1f9-1f1f3",a:"2.0"},{n:["flag-to","tonga flag"],u:"1f1f9-1f1f4",a:"2.0"},{n:["flag-tr","trkiye flag"],u:"1f1f9-1f1f7",a:"2.0"},{n:["flag-tt","trinidad & tobago flag"],u:"1f1f9-1f1f9",a:"2.0"},{n:["flag-tv","tuvalu flag"],u:"1f1f9-1f1fb",a:"2.0"},{n:["flag-tw","taiwan flag"],u:"1f1f9-1f1fc",a:"2.0"},{n:["flag-tz","tanzania flag"],u:"1f1f9-1f1ff",a:"2.0"},{n:["flag-ua","ukraine flag"],u:"1f1fa-1f1e6",a:"2.0"},{n:["flag-ug","uganda flag"],u:"1f1fa-1f1ec",a:"2.0"},{n:["flag-um","u.s. outlying islands flag"],u:"1f1fa-1f1f2",a:"2.0"},{n:["flag-un","united nations flag"],u:"1f1fa-1f1f3",a:"4.0"},{n:["us","flag-us","united states flag"],u:"1f1fa-1f1f8",a:"0.6"},{n:["flag-uy","uruguay flag"],u:"1f1fa-1f1fe",a:"2.0"},{n:["flag-uz","uzbekistan flag"],u:"1f1fa-1f1ff",a:"2.0"},{n:["flag-va","vatican city flag"],u:"1f1fb-1f1e6",a:"2.0"},{n:["flag-vc","st. vincent & grenadines flag"],u:"1f1fb-1f1e8",a:"2.0"},{n:["flag-ve","venezuela flag"],u:"1f1fb-1f1ea",a:"2.0"},{n:["flag-vg","british virgin islands flag"],u:"1f1fb-1f1ec",a:"2.0"},{n:["flag-vi","u.s. virgin islands flag"],u:"1f1fb-1f1ee",a:"2.0"},{n:["flag-vn","vietnam flag"],u:"1f1fb-1f1f3",a:"2.0"},{n:["flag-vu","vanuatu flag"],u:"1f1fb-1f1fa",a:"2.0"},{n:["flag-wf","wallis & futuna flag"],u:"1f1fc-1f1eb",a:"2.0"},{n:["flag-ws","samoa flag"],u:"1f1fc-1f1f8",a:"2.0"},{n:["flag-xk","kosovo flag"],u:"1f1fd-1f1f0",a:"2.0"},{n:["flag-ye","yemen flag"],u:"1f1fe-1f1ea",a:"2.0"},{n:["flag-yt","mayotte flag"],u:"1f1fe-1f1f9",a:"2.0"},{n:["flag-za","south africa flag"],u:"1f1ff-1f1e6",a:"2.0"},{n:["flag-zm","zambia flag"],u:"1f1ff-1f1f2",a:"2.0"},{n:["flag-zw","zimbabwe flag"],u:"1f1ff-1f1fc",a:"2.0"},{n:["england flag","flag-england"],u:"1f3f4-e0067-e0062-e0065-e006e-e0067-e007f",a:"5.0"},{n:["scotland flag","flag-scotland"],u:"1f3f4-e0067-e0062-e0073-e0063-e0074-e007f",a:"5.0"},{n:["wales flag","flag-wales"],u:"1f3f4-e0067-e0062-e0077-e006c-e0073-e007f",a:"5.0"}],i4={custom:Wit,smileys_people:Git,animals_nature:Hit,food_drink:qit,travel_places:Yit,activities:Kit,objects:Xit,symbols:Qit,flags:Jit},a4=[tp.NEUTRAL,tp.LIGHT,tp.MEDIUM_LIGHT,tp.MEDIUM,tp.MEDIUM_DARK,tp.DARK],Zit=Object.entries(tp).reduce(function(n,e){var t=e[0],s=e[1];return n[s]=t,n},{}),eat=a4.reduce(function(n,e){var t;return Object.assign(n,(t={},t[e]=e,t))},{}),fh;(function(n){n.name="n",n.unified="u",n.variations="v",n.added_in="a",n.imgUrl="imgUrl"})(fh||(fh={}));var Xme="epr_suggested";function Qme(n){try{var e,t,s;if(!((e=window)!=null&&e.localStorage))return[];var r=JSON.parse((t=(s=window)==null?void 0:s.localStorage.getItem(Xme))!=null?t:"[]");return n===ZM.FREQUENT?r.sort(function(a,o){return o.count-a.count}):r}catch{return[]}}function tat(n,e){var t=Qme(),s=Vc(n,e),r=Vc(n),a=t.find(function(c){var u=c.unified;return u===s}),o;a?o=[a].concat(t.filter(function(c){return c!==a})):(a={unified:s,original:r,count:0},o=[a].concat(t)),a.count++,o.length=Math.min(o.length,14);try{var l;(l=window)==null||l.localStorage.setItem(Xme,JSON.stringify(o))}catch{}}function wE(n){var e;return(e=n[fh.name])!=null?e:[]}function nat(n){return parseFloat(n[fh.added_in])}function z6(n){return n?wE(n)[0]:""}function YU(n){var e=n.split("-"),t=e.splice(1,1),s=t[0];return eat[s]?e.join("-"):n}function Vc(n,e){var t,s=n[fh.unified];return!e||!ax(n)?s:(t=sat(n,e))!=null?t:s}function Jme(){var n=Mat(),e=Hme(),t=e[0],s=Hr.useMemo(function(){var r,a=(r=Qme(n))!=null?r:[];return a.map(function(o){return C2(o.unified)}).filter(Boolean)},[t,n]);return function(a){var o;return a===Er.SUGGESTED?s:(o=i4[a])!=null?o:[]}}function Zme(n,e){return""+Vit(e)+n+".png"}function vE(n){var e;return(e=n[fh.variations])!=null?e:[]}function ax(n){return vE(n).length>0}function sat(n,e){return e?vE(n).find(function(t){return t.includes(e)}):Vc(n)}function C2(n){if(n){if(Qv[n])return Qv[n];var e=YU(n);return Qv[e]}}var yP=Object.values(i4).flat();function rat(n){i4[Er.CUSTOM].length=0,n.forEach(function(e){var t=iat(e);i4[Er.CUSTOM].push(t),!Qv[t[fh.unified]]&&(yP.push(t),Qv[t[fh.unified]]=t,Ume(t))})}function iat(n){var e;return e={},e[fh.name]=n.names.map(function(t){return t.toLowerCase()}),e[fh.unified]=n.id.toLowerCase(),e[fh.added_in]="0",e[fh.imgUrl]=n.imgUrl,e}var Qv={};setTimeout(function(){yP.reduce(function(n,e){return n[Vc(e)]=e,ax(e)&&vE(e).forEach(function(t){n[t]=e}),n},Qv)});function aat(n){var e=n.split("-"),t=e[1];return a4.includes(t)?t:null}var oat=["2640-fe0f","2642-fe0f","2695-fe0f"],o4="Search",ege="Clear",lat="No results found",tge=" found. Use up and down arrow keys to navigate.",cat="1 result"+tge,uat="%n results"+tge;function tZ(n){var e,t;n===void 0&&(n={});var s=nge(),r=Object.assign(s.previewConfig,(e=n.previewConfig)!=null?e:{}),a=Object.assign(s,n),o=Rit(n.categories,{suggestionMode:a.suggestedEmojisMode});a.hiddenEmojis.forEach(function(c){a.unicodeToHide.add(c)}),rat((t=a.customEmojis)!=null?t:[]);var l=a.searchDisabled?x2.PREVIEW:a.skinTonePickerLocation;return Ua({},a,{categories:o,previewConfig:r,skinTonePickerLocation:l})}function nge(){return{autoFocusSearch:!0,categories:Yme(),className:"",customEmojis:[],defaultSkinTone:tp.NEUTRAL,emojiStyle:gd.APPLE,emojiVersion:null,getEmojiUrl:Zme,height:450,lazyLoadEmojis:!1,previewConfig:Ua({},fat),searchDisabled:!1,searchPlaceHolder:o4,searchPlaceholder:o4,searchClearButtonLabel:ege,skinTonePickerLocation:x2.SEARCH,skinTonesDisabled:!1,style:{},suggestedEmojisMode:ZM.FREQUENT,theme:eT.LIGHT,unicodeToHide:new Set(oat),width:350,reactionsDefaultOpen:!1,reactions:Iit,open:!0,allowExpandReactions:!0,hiddenEmojis:[]}}var fat={defaultEmoji:"1f60a",defaultCaption:"What's your mood?",showPreview:!0},dat=["children"],sge=Ie.createContext(nge());function hat(n){var e=n.children,t=zme(n,dat),s=pat(t);return Ie.createElement(sge.Provider,{value:s},e)}function pat(n){var e,t=Ie.useState(function(){return tZ(n)}),s=t[0],r=t[1];return Ie.useEffect(function(){Bme(s,n)||r(tZ(n))},[(e=n.customEmojis)==null?void 0:e.length,n.open,n.emojiVersion,n.reactionsDefaultOpen,n.searchPlaceHolder,n.searchPlaceholder,n.searchClearButtonLabel,n.defaultSkinTone,n.skinTonesDisabled,n.autoFocusSearch,n.emojiStyle,n.theme,n.suggestedEmojisMode,n.lazyLoadEmojis,n.className,n.height,n.width,n.searchDisabled,n.skinTonePickerLocation,n.allowExpandReactions]),s}function go(){return Ie.useContext(sge)}var rge=Hr.createContext({});function ige(){var n=Hr.useContext(rge);return n}function mat(n){var e=Hr.useRef({onEmojiClick:n.onEmojiClick||zA,onReactionClick:n.onReactionClick||n.onEmojiClick,onSkinToneChange:n.onSkinToneChange||zA});return Hr.useEffect(function(){e.current.onEmojiClick=n.onEmojiClick||zA,e.current.onReactionClick=n.onReactionClick||n.onEmojiClick},[n.onEmojiClick,n.onReactionClick]),Hr.useEffect(function(){e.current.onSkinToneChange=n.onSkinToneChange||zA},[n.onSkinToneChange]),e}function zA(){}var tT;(function(n){n.REACTIONS="reactions",n.PICKER="picker"})(tT||(tT={}));function gat(){var n,e=go(),t=e.searchPlaceHolder,s=e.searchPlaceholder;return(n=[t,s].find(function(r){return r!==o4}))!=null?n:o4}function yat(){var n=go(),e=n.searchClearButtonLabel;return e??ege}function bat(){var n=go(),e=n.defaultSkinTone;return e}function age(){var n=go(),e=n.allowExpandReactions;return e}function oge(){var n=go(),e=n.skinTonesDisabled;return e}function dw(){var n=go(),e=n.emojiStyle;return e}function wat(){var n=go(),e=n.autoFocusSearch;return e}function KU(){var n=go(),e=n.categories;return e}function vat(){var n=go(),e=n.customEmojis;return e}function _at(){var n=go(),e=n.open;return e}function xat(n){var e=ige(),t=e.current,s=fw(),r=s[1],a=t.onEmojiClick||function(){},o=t.onReactionClick;return n===tT.REACTIONS&&o?function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return o.apply(void 0,c.concat([{collapseToReactions:function(){r(function(d){return d})}}]))}:function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];a.apply(void 0,c.concat([{collapseToReactions:function(){r(!0)}}]))}}function Cat(){var n=ige(),e=n.current;return e.onSkinToneChange||function(){}}function lge(){var n=go(),e=n.previewConfig;return e}function Sat(){var n=go(),e=n.theme;return e}function Mat(){var n=go(),e=n.suggestedEmojisMode;return e}function cge(){var n=go(),e=n.lazyLoadEmojis;return e}function Tat(){var n=go(),e=n.className;return e}function kat(){var n=go(),e=n.height,t=n.width,s=n.style;return Ua({height:nZ(e),width:nZ(t)},s)}function Eat(){var n=go(),e=n.reactionsDefaultOpen;return e}function Iat(){var n=go(),e=n.emojiVersion;return e}function uge(){var n=go(),e=n.searchDisabled;return e}function fge(){var n=go(),e=n.skinTonePickerLocation;return e}function Aat(){var n=go(),e=n.unicodeToHide;return e}function Lat(){var n=go(),e=n.reactions;return e}function hw(){var n=go(),e=n.getEmojiUrl;return e}function nZ(n){return typeof n=="number"?n+"px":n}function Nat(n){var e=n>0,t=n>1;return e?t?uat.replace("%n",n.toString()):cat:lat}function bP(){var n=pP(),e=n[0];return!!e}function Ad(n){n&&requestAnimationFrame(function(){n.focus()})}function dge(n){if(n){var e=n.previousElementSibling;Ad(e)}}function hge(n){if(n){var e=n.nextElementSibling;Ad(e)}}function pge(n){if(n){var e=n.firstElementChild;Ad(e)}}function nT(){return document.activeElement}function Dat(n){var e=n.children,t=Ie.useRef(null),s=Ie.useRef(null),r=Ie.useRef(null),a=Ie.useRef(null),o=Ie.useRef(null),l=Ie.useRef(null),c=Ie.useRef(null),u=Ie.useRef(null),f=Ie.useRef(null);return Ie.createElement(mge.Provider,{value:{AnchoredEmojiRef:s,BodyRef:r,EmojiListRef:a,CategoryNavigationRef:c,PickerMainRef:t,SearchInputRef:o,SkinTonePickerRef:l,VariationPickerRef:u,ReactionsRef:f}},e)}var mge=Ie.createContext({AnchoredEmojiRef:Ie.createRef(),BodyRef:Ie.createRef(),CategoryNavigationRef:Ie.createRef(),EmojiListRef:Ie.createRef(),PickerMainRef:Ie.createRef(),SearchInputRef:Ie.createRef(),SkinTonePickerRef:Ie.createRef(),VariationPickerRef:Ie.createRef(),ReactionsRef:Ie.createRef()});function Zg(){return Ie.useContext(mge)}function gge(){return Zg().EmojiListRef}function ox(){return Zg().PickerMainRef}function wP(){return Zg().AnchoredEmojiRef}function yge(){var n=wP();return function(e){e===null&&n.current!==null&&Ad(n.current),n.current=e}}function Ld(){return Zg().BodyRef}function Oat(){return Zg().ReactionsRef}function O1(){return Zg().SearchInputRef}function XU(){return Zg().SkinTonePickerRef}function QU(){return Zg().CategoryNavigationRef}function Pat(){return Zg().VariationPickerRef}function bge(n,e){e===void 0&&(e=0);var t=Lge(n);t&&requestAnimationFrame(function(){t.scrollTop=e})}function $at(n,e){var t=Lge(n);t&&requestAnimationFrame(function(){t.scrollTop=t.scrollTop+e})}function jat(){var n=Ld();return Ie.useCallback(function(e){requestAnimationFrame(function(){n.current&&(n.current.scrollTop=e)})},[n])}function vP(n){if(!(!n||!xot(n))&&!n.closest(yh(ri.variationPicker))){var e=Dge(n),t=Nge(n);$at(e,-(n7(P1(n))-t))}}function _P(n){var e=a7(n);Ad(e),vP(e)}function Rat(n){var e=a7(n);Ad(e),e?.click()}function Fat(n){Ad(jge(n))}function zat(n){if(n){var e=Rge(n);if(!e)return _P(CP(n));Ad(e),vP(e)}}function Bat(n){if(n){var e=i7(n);if(!e)return Fat(xP(n));Ad(e),vP(e)}}function Uat(n,e){if(n){var t=Wat(n);if(!t)return e();Ad(t),vP(t)}}function Vat(n){if(n){var e=Gat(n);return Ad(e)}}function Wat(n){if(!n)return null;var e=Fge(n),t=P1(e),s=Ege(e,n),r=S2(t),a=r.indexOf(n),o=a%s;if(a===-1)return null;if(r[a-s])return r[a-s];var l=xP(t);if(!l)return null;var c=S2(l),u=c.length%s-1;if(o>u)return c.at(-1);for(var f=c.length-1;f>=0;f--)if(f%s===o)return c[f];return c.at(-1)}function Gat(n){var e;if(!n)return null;var t=Fge(n),s=P1(t),r=Ege(t,n),a=S2(s),o=a.indexOf(n);if(o===-1)return null;var l=r-o%r-1,c=o+l+1;if(a[c]){for(var u=o+r;u%r>=0;u--)if(a[u])return a[u]}var f=o%r,d=CP(s),h=S2(d);return h[f]?h[f]:(e=h.at(0))!=null?e:null}function pw(){var n=ix(),e=n[0],t=n[1],s=bE(),r=s[0],a=s[1],o=Ie.useCallback(function(){e&&t(null),r&&a(!1)},[e,r,t,a]);return o}function wge(){var n=ix(),e=n[0],t=bE(),s=t[0];return function(){return!!e||s}}function Hat(){var n=HU();return function(){n.current=!0}}function vge(){var n=HU();return function(){n.current=!1}}function _ge(){var n=HU();return function(){return n.current}}function qat(){var n=Ld(),e=vge(),t=_ge();Ie.useEffect(function(){var s=n.current;s?.addEventListener("mousemove",r,{passive:!0});function r(){t()&&e()}return function(){s?.removeEventListener("mousemove",r)}},[n,e,t])}function mw(){var n=O1();return Ie.useCallback(function(){Ad(n.current)},[n])}function Yat(){var n=XU();return Ie.useCallback(function(){n.current&&pge(n.current)},[n])}function xge(){var n=QU();return Ie.useCallback(function(){n.current&&pge(n.current)},[n])}function Kat(){var n=GU();return function e(t){if(typeof t=="function")return e(t(n.current));n.current=t}}function Cge(){var n=JU(),e=O1(),t=mw();return function(){e.current&&(e.current.value=""),n(""),t()}}function Xat(){var n=O1(),e=JU();return function(s){n.current?(n.current.value=""+n.current.value+s,e(sZ(n.current.value))):e(sZ(s))}}function Qat(){var n=O1(),e=GU(),t=Kat(),s=JU(),r=pP(),a=r[0],o=sot(e.current,a);return{onChange:l,searchTerm:a,SearchInputRef:n,statusSearchResults:o};function l(c){var u=e.current,f=c.toLowerCase();if(u!=null&&u[f]||f.length<=1)return s(f);var d=not(f,u);if(!d)return s(f);t(function(h){var p;return Object.assign(h,(p={},p[f]=Jat(d,f),p))}),s(f)}}function JU(){var n=pP(),e=n[1],t=ox();return function(r){requestAnimationFrame(function(){e(r&&r?.toLowerCase()).then(function(){bge(t.current,0)})})}}function Jat(n,e){var t={};for(var s in n){var r=n[s];Zat(r,e)&&(t[s]=r)}return t}function Zat(n,e){return wE(n).some(function(t){return t.includes(e)})}function eot(){var n=GU(),e=n.current,t=pP(),s=t[0];return function(r){return tot(r,e,s)}}function tot(n,e,t){var s;return!e||!t?!1:!((s=e[t])!=null&&s[n])}function not(n,e){if(!e)return null;if(e[n])return e[n];var t=Object.keys(e).sort(function(s,r){return r.length-s.length}).find(function(s){return n.includes(s)});return t?e[t]:null}function sZ(n){return!n||typeof n!="string"?"":n.trim().toLowerCase()}function sot(n,e){var t;if(!(n!=null&&n[e]))return"";var s=((t=Object.entries(n?.[e]))==null?void 0:t.length)||0;return Nat(s)}function Sge(){var n=yge(),e=ix(),t=e[1];return function(r){var a=t7(r),o=a[0];o&&(n(r),t(o))}}function ZU(){var n=fge();return n===x2.SEARCH}function Mge(){var n=fge();return n===x2.PREVIEW}var yl;(function(n){n.ArrowDown="ArrowDown",n.ArrowUp="ArrowUp",n.ArrowLeft="ArrowLeft",n.ArrowRight="ArrowRight",n.Escape="Escape",n.Enter="Enter",n.Space=" "})(yl||(yl={}));function rot(){iot(),aot(),oot(),lot(),cot()}function iot(){var n=ox(),e=Cge(),t=jat(),s=O1(),r=mw(),a=wge(),o=Hat(),l=pw(),c=Ie.useMemo(function(){return function(f){var d=f.key;switch(o(),d){case yl.Escape:if(f.preventDefault(),a()){l();return}e(),t(0),r();break}}},[t,e,l,r,a,o]);Ie.useEffect(function(){var u=n.current;if(u)return u.addEventListener("keydown",c),function(){u.removeEventListener("keydown",c)}},[n,s,t,c])}function aot(){var n=Yat(),e=ox(),t=Ld(),s=O1(),r=bE(),a=r[1],o=Tge(),l=ZU(),c=Ie.useMemo(function(){return function(f){var d=f.key;switch(d){case yl.ArrowRight:if(!l)return;f.preventDefault(),a(!0),n();break;case yl.ArrowDown:f.preventDefault(),o();break;case yl.Enter:f.preventDefault(),Rat(t.current);break}}},[n,o,a,t,l]);Ie.useEffect(function(){var u=s.current;if(u)return u.addEventListener("keydown",c),function(){u.removeEventListener("keydown",c)}},[e,s,c])}function oot(){var n=XU(),e=mw(),t=O1(),s=Tge(),r=bE(),a=r[0],o=r[1],l=Mge(),c=ZU(),u=e7(),f=Ie.useMemo(function(){return(function(h){var p=h.key;if(c)switch(p){case yl.ArrowLeft:if(h.preventDefault(),!a)return e();rZ(e);break;case yl.ArrowRight:if(h.preventDefault(),!a)return e();iZ();break;case yl.ArrowDown:h.preventDefault(),a&&o(!1),s();break;default:u(h);break}if(l)switch(p){case yl.ArrowUp:if(h.preventDefault(),!a)return e();rZ(e);break;case yl.ArrowDown:if(h.preventDefault(),!a)return e();iZ();break;default:u(h);break}})},[a,e,o,s,u,l,c]);Ie.useEffect(function(){var d=n.current;if(d)return d.addEventListener("keydown",f),function(){d.removeEventListener("keydown",f)}},[n,t,a,f])}function lot(){var n=mw(),e=QU(),t=Ld(),s=e7(),r=Ie.useMemo(function(){return function(o){var l=o.key;switch(l){case yl.ArrowUp:o.preventDefault(),n();break;case yl.ArrowRight:o.preventDefault(),hge(nT());break;case yl.ArrowLeft:o.preventDefault(),dge(nT());break;case yl.ArrowDown:o.preventDefault(),_P(t.current);break;default:s(o);break}}},[t,n,s]);Ie.useEffect(function(){var a=e.current;if(a)return a.addEventListener("keydown",r),function(){a.removeEventListener("keydown",r)}},[e,t,r])}function cot(){var n=Ld(),e=uot(),t=Sge(),s=wge(),r=pw(),a=e7(),o=Ie.useMemo(function(){return(function(c){var u=c.key,f=dp(nT());switch(u){case yl.ArrowRight:c.preventDefault(),zat(f);break;case yl.ArrowLeft:c.preventDefault(),Bat(f);break;case yl.ArrowDown:if(c.preventDefault(),s()){r();break}Vat(f);break;case yl.ArrowUp:if(c.preventDefault(),s()){r();break}Uat(f,e);break;case yl.Space:c.preventDefault(),t(c.target);break;default:a(c);break}})},[e,a,t,s,r]);Ie.useEffect(function(){var l=n.current;if(l)return l.addEventListener("keydown",o),function(){l.removeEventListener("keydown",o)}},[n,o])}function Tge(){var n=xge(),e=bP(),t=Ld();return Ie.useCallback(function(){return e?_P(t.current):n()},[t,n,e])}function uot(){var n=mw(),e=xge(),t=bP();return Ie.useCallback(function(){return t?n():e()},[n,t,e])}function rZ(n){var e=nT();e&&(wot(e)||n(),hge(e))}function iZ(){var n=nT();n&&dge(n)}function e7(){var n=Xat(),e=mw(),t=uge(),s=pw();return function(a){var o=a.key;fot(a)||t||o.match(/(^[a-zA-Z0-9]$){1}/)&&(a.preventDefault(),s(),e(),n(o))}}function fot(n){var e=n.metaKey,t=n.ctrlKey,s=n.altKey;return e||t||s}function dot(n,e,t,s,r,a,o,l){if(n&&e!==gd.NATIVE){var c=Vc(n);B6.has(c)||!a||!o||setTimeout(function(){var u=r+a.top,f=t+s,d=u>=f&&u<f+o.emojiSize*2;d&&kge(l,n,e)})}}function kge(n,e,t){if(e){var s=Vc(e);B6.has(s)||(B6.add(s),vE(e).concat(s).forEach(function(r){var a=n(r,t);hot(a)}))}}var B6=new Set;function hot(n){var e=new Image;e.src=n}function pot(){var n=Ld(),e=dw(),t=hw();Ie.useEffect(function(){if(e===gd.NATIVE)return;var s=n.current;return s?.addEventListener("focusin",r),function(){s?.removeEventListener("focusin",r)};function r(a){var o=dp(a.target);if(o){var l=t7(o),c=l[0];c&&ax(c)&&kge(t,c,e)}}},[n,e,t])}var mot=["width","height"],U6=40;function got(n){var e=n.children;return Ie.createElement(Oit,null,Ie.createElement(yot,null,e))}function yot(n){var e,t=n.children,s=fw(),r=s[0],a=Sat(),o=bP(),l=ox(),c=Tat(),u=kat();rot(),pot();var f=u||{},d=f.width,h=f.height,p=zme(f,mot);return Ie.createElement("aside",{className:Ur(pS.main,pS.baseVariables,a===eT.DARK&&pS.darkTheme,a===eT.AUTO&&pS.autoThemeDark,(e={},e[ri.searchActive]=o,e),r&&pS.reactionsMenu,c),ref:l,style:Ua({},p,!r&&{height:h,width:d})},t)}var aZ={"--epr-emoji-variation-picker-bg-color":"var(--epr-dark-emoji-variation-picker-bg-color)","--epr-hover-bg-color-reduced-opacity":"var(--epr-dark-hover-bg-color-reduced-opacity)","--epr-highlight-color":"var(--epr-dark-highlight-color)","--epr-text-color":"var(--epr-dark-text-color)","--epr-hover-bg-color":"var(--epr-dark-hover-bg-color)","--epr-focus-bg-color":"var(--epr-dark-focus-bg-color)","--epr-search-input-bg-color":"var(--epr-dark-search-input-bg-color)","--epr-category-label-bg-color":"var(--epr-dark-category-label-bg-color)","--epr-picker-border-color":"var(--epr-dark-picker-border-color)","--epr-bg-color":"var(--epr-dark-bg-color)","--epr-reactions-bg-color":"var(--epr-dark-reactions-bg-color)","--epr-search-input-bg-color-active":"var(--epr-dark-search-input-bg-color-active)","--epr-emoji-variation-indicator-color":"var(--epr-dark-emoji-variation-indicator-color)","--epr-category-icon-active-color":"var(--epr-dark-category-icon-active-color)","--epr-skin-tone-picker-menu-color":"var(--epr-dark-skin-tone-picker-menu-color)","--epr-skin-tone-outer-border-color":"var(--epr-dark-skin-tone-outer-border-color)","--epr-skin-tone-inner-border-color":"var(--epr-dark-skin-tone-inner-border-color)"},pS=so.create({main:{".":["epr-main",ri.emojiPicker],position:"relative",display:"flex",flexDirection:"column",borderWidth:"1px",borderStyle:"solid",borderRadius:"var(--epr-picker-border-radius)",borderColor:"var(--epr-picker-border-color)",backgroundColor:"var(--epr-bg-color)",overflow:"hidden",transition:"height 0.3s ease-in-out, background-color 0.1s ease-in-out","*":{boxSizing:"border-box",fontFamily:"sans-serif"}},baseVariables:{"--":{"--epr-highlight-color":"#007aeb","--epr-hover-bg-color":"#e5f0fa","--epr-hover-bg-color-reduced-opacity":"#e5f0fa80","--epr-focus-bg-color":"#e0f0ff","--epr-text-color":"#858585","--epr-search-input-bg-color":"#f6f6f6","--epr-picker-border-color":"#e7e7e7","--epr-bg-color":"#fff","--epr-reactions-bg-color":"#ffffff90","--epr-category-icon-active-color":"#6aa8de","--epr-skin-tone-picker-menu-color":"#ffffff95","--epr-skin-tone-outer-border-color":"#555555","--epr-skin-tone-inner-border-color":"var(--epr-bg-color)","--epr-horizontal-padding":"10px","--epr-picker-border-radius":"8px","--epr-header-padding":"15px var(--epr-horizontal-padding)","--epr-active-skin-tone-indicator-border-color":"var(--epr-highlight-color)","--epr-active-skin-hover-color":"var(--epr-hover-bg-color)","--epr-search-input-bg-color-active":"var(--epr-search-input-bg-color)","--epr-search-input-padding":"0 30px","--epr-search-input-border-radius":"8px","--epr-search-input-height":"40px","--epr-search-input-text-color":"var(--epr-text-color)","--epr-search-input-placeholder-color":"var(--epr-text-color)","--epr-search-bar-inner-padding":"var(--epr-horizontal-padding)","--epr-search-border-color":"var(--epr-search-input-bg-color)","--epr-search-border-color-active":"var(--epr-highlight-color)","--epr-category-navigation-button-size":"30px","--epr-emoji-variation-picker-height":"45px","--epr-emoji-variation-picker-bg-color":"var(--epr-bg-color)","--epr-preview-height":"70px","--epr-preview-text-size":"14px","--epr-preview-text-padding":"0 var(--epr-horizontal-padding)","--epr-preview-border-color":"var(--epr-picker-border-color)","--epr-preview-text-color":"var(--epr-text-color)","--epr-category-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-bg-color":"#ffffffe6","--epr-category-label-text-color":"var(--epr-text-color)","--epr-category-label-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-height":U6+"px","--epr-emoji-size":"30px","--epr-emoji-padding":"5px","--epr-emoji-fullsize":"calc(var(--epr-emoji-size) + var(--epr-emoji-padding) * 2)","--epr-emoji-hover-color":"var(--epr-hover-bg-color)","--epr-emoji-variation-indicator-color":"var(--epr-picker-border-color)","--epr-emoji-variation-indicator-color-hover":"var(--epr-text-color)","--epr-header-overlay-z-index":"3","--epr-emoji-variations-indictator-z-index":"1","--epr-category-label-z-index":"2","--epr-skin-variation-picker-z-index":"5","--epr-preview-z-index":"6","--epr-dark":"#000","--epr-dark-emoji-variation-picker-bg-color":"var(--epr-dark)","--epr-dark-highlight-color":"#c0c0c0","--epr-dark-text-color":"var(--epr-highlight-color)","--epr-dark-hover-bg-color":"#363636f6","--epr-dark-hover-bg-color-reduced-opacity":"#36363680","--epr-dark-focus-bg-color":"#474747","--epr-dark-search-input-bg-color":"#333333","--epr-dark-category-label-bg-color":"#222222e6","--epr-dark-picker-border-color":"#151617","--epr-dark-bg-color":"#222222","--epr-dark-reactions-bg-color":"#22222290","--epr-dark-search-input-bg-color-active":"var(--epr-dark)","--epr-dark-emoji-variation-indicator-color":"#444","--epr-dark-category-icon-active-color":"#3271b7","--epr-dark-skin-tone-picker-menu-color":"#22222295","--epr-dark-skin-tone-outer-border-color":"var(--epr-dark-picker-border-color)","--epr-dark-skin-tone-inner-border-color":"#00000000"}},autoThemeDark:{".":ri.autoTheme,"@media (prefers-color-scheme: dark)":{"--":aZ}},darkTheme:{".":ri.darkTheme,"--":aZ},reactionsMenu:{".":"epr-reactions",height:"50px",display:"inline-flex",backgroundColor:"var(--epr-reactions-bg-color)",backdropFilter:"blur(8px)","--":{"--epr-picker-border-radius":"50px"}}});function Ege(n,e){if(!n||!e)return 0;var t=n.getBoundingClientRect().width,s=e.getBoundingClientRect().width;return Math.floor(t/s)}function bot(n,e,t){if(!n||!e.length)return null;var s=n.getBoundingClientRect().top,r=n.getBoundingClientRect().bottom,a=s+Ige(n),o=e.find(function(l){var c=l.getBoundingClientRect().top,u=l.getBoundingClientRect().bottom,f=l.clientHeight*t,d=c+f,h=u-f;return d<a?!1:d>=s&&d<=r||h>=s&&h<=r});return o||null}function wot(n){return!!n.nextElementSibling}function Ige(n){if(!n)return U6;var e=n.querySelector(yh(ri.label));if(e){var t=e.getBoundingClientRect().height;if(t>0)return t}return U6}var sT="button"+yh(ri.emoji),vot=[sT,yh(ri.visible),":not("+yh(ri.hidden)+")"].join("");function dp(n){var e;return(e=n?.closest(sT))!=null?e:null}function t7(n){var e=Oge(n),t=s7(n);if(!e)return[];var s=C2(t??e);return s?[s,t]:[]}function _ot(n){var e;return!!(n?.matches(sT)||!(n==null||(e=n.parentElement)==null)&&e.matches(sT))}function oZ(n){var e;return(e=n?.clientHeight)!=null?e:0}function Age(n){if(!n)return 0;var e=dp(n),t=P1(e),s=n7(t);return lZ(e)+lZ(t)+s}function n7(n){var e,t;if(!n)return 0;var s=n.querySelector(yh(ri.categoryContent));return((e=n?.clientHeight)!=null?e:0)-((t=s?.clientHeight)!=null?t:0)}function xot(n){return n?Nge(n)<n7(P1(n)):!1}function Lge(n){return n?n.matches(yh(ri.scrollBody))?n:n.querySelector(yh(ri.scrollBody)):null}function Nge(n){var e,t;return n?Age(n)-((e=(t=Dge(n))==null?void 0:t.scrollTop)!=null?e:0):0}function Dge(n){var e;return n&&(e=n.closest(yh(ri.scrollBody)))!=null?e:null}function Cot(n){var e=dp(n),t=P1(e);return cZ(e)+cZ(t)}function lZ(n){var e;return(e=n?.offsetTop)!=null?e:0}function cZ(n){var e;return(e=n?.offsetLeft)!=null?e:0}function s7(n){var e;return(e=Sot(dp(n),"unified"))!=null?e:null}function Oge(n){var e=s7(n);return e?YU(e):null}function Pge(n){return n?{unified:s7(n),originalUnified:Oge(n)}:{unified:null,originalUnified:null}}function Sot(n,e){var t;return(t=Mot(n)[e])!=null?t:null}function Mot(n){var e;return(e=n?.dataset)!=null?e:{}}function r7(n){return n.classList.contains(ri.visible)}function $ge(n){return n?n.classList.contains(ri.hidden):!0}function S2(n){return n?Array.from(n.querySelectorAll(vot)):[]}function jge(n){if(!n)return null;var e=S2(n),t=e.slice(-1),s=t[0];return s?r7(s)?s:i7(s):null}function Rge(n){var e=n.nextElementSibling;return e?r7(e)?e:Rge(e):a7(CP(n))}function i7(n){var e=n.previousElementSibling;return e?r7(e)?e:i7(e):jge(xP(n))}function a7(n){if(!n)return null;var e=S2(n);return bot(n,e,.1)}function xP(n){var e=P1(n);if(!e)return null;var t=e.previousElementSibling;return t?$ge(t)?xP(t):t:null}function CP(n){var e=P1(n);if(!e)return null;var t=e.nextElementSibling;return t?$ge(t)?CP(t):t:null}function P1(n){return n?n.closest(yh(ri.category)):null}function Fge(n){return n?n.closest(yh(ri.categoryContent)):null}function zge(n){return n.split("-").map(function(e){return String.fromCodePoint(parseInt(e,16))}).join("")}function Tot(n){return n.category===Er.CUSTOM}function Bge(n){return n.imgUrl!==void 0}function Uge(n,e){var t=Ie.useRef(),s=Sge(),r=Pit(),a=ix(),o=a[1],l=pw(),c=mP(),u=c[0],f=xat(e),d=Hme(),h=d[1],p=hw(),g=dw(),b=Ie.useCallback(function(S){if(!r.current){l();var C=uZ(S),M=C[0],k=C[1];if(!(!M||!k)){var E=aat(k)||u;h(),tat(M,E),f(kot(M,E,g,p),S)}}},[u,l,r,f,h,p,g]),v=Ie.useCallback(function(S){var C;t.current&&clearTimeout(t.current);var M=uZ(S),k=M[0];!k||!ax(k)||(t.current=(C=window)==null?void 0:C.setTimeout(function(){r.current=!0,t.current=void 0,l(),s(S.target),o(k)},500))},[r,l,s,o]),w=Ie.useCallback(function(){t.current?(clearTimeout(t.current),t.current=void 0):r.current&&requestAnimationFrame(function(){r.current=!1})},[r]);Ie.useEffect(function(){if(n.current){var x=n.current;return x.addEventListener("click",b,{passive:!0}),x.addEventListener("mousedown",v,{passive:!0}),x.addEventListener("mouseup",w,{passive:!0}),function(){x?.removeEventListener("click",b),x?.removeEventListener("mousedown",v),x?.removeEventListener("mouseup",w)}}},[n,b,v,w])}function uZ(n){var e=n?.target;return _ot(e)?t7(e):[]}function kot(n,e,t,s){var r=wE(n);if(Bge(n)){var a=Vc(n);return{activeSkinTone:e,emoji:a,getImageUrl:function(){return n.imgUrl},imageUrl:n.imgUrl,isCustom:!0,names:r,unified:a,unifiedWithoutSkinTone:a}}var o=Vc(n,e);return{activeSkinTone:e,emoji:zge(o),getImageUrl:function(c){return c===void 0&&(c=t??gd.APPLE),s(o,c)},imageUrl:s(o,t??gd.APPLE),isCustom:!1,names:r,unified:o,unifiedWithoutSkinTone:Vc(n)}}function _E(n){return Ie.createElement("button",Object.assign({type:"button"},n,{className:Ur(Eot.button,n.className)}),n.children)}var Eot=so.create({button:{".":"epr-btn",cursor:"pointer",border:"0",background:"none",outline:"none"}});function Iot(n){var e,t=n.emojiNames,s=n.unified,r=n.hidden,a=n.hiddenOnSearch,o=n.showVariations,l=o===void 0?!0:o,c=n.hasVariations,u=n.children,f=n.className,d=n.noBackground,h=d===void 0?!1:d,p=n.style;return Ie.createElement(_E,{className:Ur(fj.emoji,r&&WU.hidden,a&&uw.hiddenOnSearch,(e={},e[ri.visible]=!r&&!a,e),!!(c&&l)&&fj.hasVariations,h&&fj.noBackground,f),"data-unified":s,"aria-label":Aot(t),"data-full-name":t,style:p},u)}function Aot(n){var e;return n[0].match("flag-")&&(e=n[1])!=null?e:n[0]}var fj=so.create({emoji:{".":ri.emoji,position:"relative",width:"var(--epr-emoji-fullsize)",height:"var(--epr-emoji-fullsize)",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",borderRadius:"8px",overflow:"hidden",transition:"background-color 0.2s",":hover":{backgroundColor:"var(--epr-emoji-hover-color)"},":focus":{backgroundColor:"var(--epr-focus-bg-color)"}},noBackground:{background:"none",":hover":{backgroundColor:"transparent",background:"none"},":focus":{backgroundColor:"transparent",background:"none"}},hasVariations:{".":ri.emojiHasVariations,":after":{content:"",display:"block",width:"0",height:"0",right:"0px",bottom:"1px",position:"absolute",borderLeft:"4px solid transparent",borderRight:"4px solid transparent",transform:"rotate(135deg)",borderBottom:"4px solid var(--epr-emoji-variation-indicator-color)",zIndex:"var(--epr-emoji-variations-indictator-z-index)"},":hover:after":{borderBottom:"4px solid var(--epr-emoji-variation-indicator-color-hover)"}}}),l4=so.create({external:{".":ri.external,fontSize:"0"},common:{alignSelf:"center",justifySelf:"center",display:"block"}});function fZ(n){var e=n.emojiName,t=n.style,s=n.lazyLoad,r=s===void 0?!1:s,a=n.imgUrl,o=n.onError,l=n.className;return Ie.createElement("img",{src:a,alt:e,className:Ur(Lot.emojiImag,l4.external,l4.common,l),loading:r?"lazy":"eager",onError:o,style:t})}var Lot=so.create({emojiImag:{".":"epr-emoji-img",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",minWidth:"var(--epr-emoji-fullsize)",minHeight:"var(--epr-emoji-fullsize)",padding:"var(--epr-emoji-padding)"}});function Not(n){var e=n.unified,t=n.style,s=n.className;return Ie.createElement("span",{className:Ur(Dot.nativeEmoji,l4.common,l4.external,s),"data-unified":e,style:t},zge(e))}var Dot=so.create({nativeEmoji:{".":"epr-emoji-native",fontFamily:'"Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji"!important',position:"relative",lineHeight:"100%",fontSize:"var(--epr-emoji-size)",textAlign:"center",alignSelf:"center",justifySelf:"center",letterSpacing:"0",padding:"var(--epr-emoji-padding)"}});function V6(n){var e=n.emoji,t=n.unified,s=n.emojiStyle,r=n.size,a=n.lazyLoad,o=n.getEmojiUrl,l=o===void 0?Zme:o,c=n.className,u=Wme(),f=u[1],d={};r&&(d.width=d.height=d.fontSize=r+"px");var h=e||C2(t);if(!h)return null;if(Bge(h))return Ie.createElement(fZ,{style:d,emojiName:t,emojiStyle:gd.NATIVE,lazyLoad:a,imgUrl:h.imgUrl,onError:p,className:c});return Ie.createElement(Ie.Fragment,null,s===gd.NATIVE?Ie.createElement(Not,{unified:t,style:d,className:c}):Ie.createElement(fZ,{style:d,emojiName:z6(h),emojiStyle:s,lazyLoad:a,imgUrl:l(t,s),onError:p,className:c}));function p(){f(function(g){return new Set(g).add(t)})}}function SP(n){var e=n.emoji,t=n.unified,s=n.hidden,r=n.hiddenOnSearch,a=n.emojiStyle,o=n.showVariations,l=o===void 0?!0:o,c=n.size,u=n.lazyLoad,f=n.getEmojiUrl,d=n.className,h=n.noBackground,p=h===void 0?!1:h,g=n.style,b=ax(e);return Ie.createElement(Iot,{hasVariations:b,showVariations:l,hidden:s,hiddenOnSearch:r,emojiNames:wE(e),unified:t,noBackground:p,style:g},Ie.createElement(V6,{unified:t,emoji:e,size:c,emojiStyle:a,lazyLoad:u,getEmojiUrl:f,className:d}))}var Oot="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI4LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNS43LDEwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsMTAuOSw2LjEsMTEsNi4zLDExaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjRWNi43YzAtMC4zLTAuMi0wLjUtMC41LTAuNQoJQzkuOCw2LDkuNiw2LjIsOS42LDYuNXYzLjRINi4yQzUuOSw5LjksNS43LDEwLjEsNS43LDEwLjRMNS43LDEwLjR6Ii8+CjxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik01LjcsMzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDMxLDYuMywzMWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuMgoJQzUuOSwyOS45LDUuNywzMC4xLDUuNywzMC40TDUuNywzMC40eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNS43LDUwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsNTAuOSw2LjEsNTEsNi4zLDUxaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjR2LTMuNGMwLTAuMy0wLjItMC41LTAuNS0wLjUKCXMtMC41LDAuMi0wLjUsMC41djMuNEg2LjJDNS45LDQ5LjksNS43LDUwLjEsNS43LDUwLjRMNS43LDUwLjR6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik01LjcsNzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDcxLDYuMyw3MWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuNAoJQzUuOSw2OS45LDUuNyw3MC4xLDUuNyw3MC40TDUuNyw3MC40eiIvPgo8L3N2Zz4=";function Pot(){var n=fw(),e=n[1];return Ie.createElement(_E,{"aria-label":"Show all Emojis",title:"Show all Emojis",tabIndex:0,className:Ur($ot.plusSign),onClick:function(){return e(!1)}})}var $ot=so.create(Ua({plusSign:{fontSize:"20px",padding:"17px",color:"var(--epr-text-color)",borderRadius:"50%",textAlign:"center",lineHeight:"100%",width:"20px",height:"20px",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease-in-out",":after":{content:"",minWidth:"20px",minHeight:"20px",backgroundImage:"url("+Oot+")",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",backgroundPositionY:"0"},":hover":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-20px"}},":focus":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-40px"}}}},v1("plusSign",{":after":{backgroundPositionY:"-40px"},":hover:after":{backgroundPositionY:"-60px"}})));function jot(){var n=fw(),e=n[0],t=Oat(),s=Lat();Uge(t,tT.REACTIONS);var r=dw(),a=age(),o=hw();return e?Ie.createElement("ul",{className:Ur(dZ.list,!e&&WU.hidden),ref:t},s.map(function(l){return Ie.createElement("li",{key:l},Ie.createElement(SP,{emoji:C2(l),emojiStyle:r,unified:l,showVariations:!1,className:Ur(dZ.emojiButton),noBackground:!0,getEmojiUrl:o}))}),a?Ie.createElement("li",null,Ie.createElement(Pot,null)):null):null}var dZ=so.create({list:{listStyle:"none",margin:"0",padding:"0 5px",display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%"},emojiButton:{":hover":{transform:"scale(1.2)"},":focus":{transform:"scale(1.2)"},":active":{transform:"scale(1.1)"},transition:"transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.5)"}});function Rot(n){var e=pw(),t=Ie.useState(0),s=t[0],r=t[1];return Ie.useEffect(function(){var a=n.current;if(!a)return;a.addEventListener("scroll",o,{passive:!0});function o(){var l;r((l=a?.scrollTop)!=null?l:0),e()}return function(){a?.removeEventListener("scroll",o)}},[n,e]),s}function Fot(n){var e=n.scrollTop,t=n.clientHeight,s=n.topOffset,r=n.style,a=n.dimensions;if(!r||!a)return!1;var o=s+r.top,l=o+a.emojiSize,c=l+a.emojiSize*2>=e&&o<=e+t+a.emojiSize;return!c}function zot(n,e){return n?{top:Math.floor(e/n.emojisPerRow)*n.emojiSize,left:e%n.emojisPerRow*n.emojiSize}:void 0}var Bot=40;function Uot(n){var e=gge(),t=fw(),s=t[0],r=ox(),a=Ie.useRef(),o=qU(),l=o[0],c=Gme(),u=c[0],f=Ie.useState(),d=f[0],h=f[1],p=Ie.useCallback(function(){var g=e.current;if(g){var b=g.querySelector(sT),v=b?.clientHeight;v&&(a.current=v);var w=u||v||a.current||Bot,x=g.clientWidth;if(!(x===0||w===0)){var S=Math.max(1,Math.floor(x/w)),C=Math.ceil(n/S),M=C*w;h({categoryHeight:M,emojisPerRow:S,emojiSize:w})}}},[e,n,u]);return Ie.useEffect(function(){p()},[n,s,p,l.length]),Ie.useEffect(function(){var g=r.current;if(g){var b=function(w){var x=w,S=x.propertyName;(S==="width"||S==="max-width"||S==="min-width"||S==="height"||S==="max-height"||S==="min-height")&&(typeof queueMicrotask=="function"?queueMicrotask(function(){return p()}):requestAnimationFrame(function(){return p()}))};return g.addEventListener("transitionend",b,{passive:!0}),function(){g.removeEventListener("transitionend",b)}}},[r,p]),d}function Vot(){var n=Wme(),e=n[0],t=eot();return function(s){var r=Vc(s),a=e.has(r),o=t(r);return{failedToLoad:a,filteredOut:o,hidden:a||o}}}function Wot(n){var e=n.categoryEmojis,t=n.topOffset,s=n.onHeightReady,r=n.scrollTop,a=n.isCategoryVisible,o=Vot(),l=cge(),c=dw(),u=mP(),f=u[0],d=Lit(),h=hw(),p=!oge(),g=Ld(),b=0,v=e.filter(function(C){var M=d(C),k=o(C),E=k.failedToLoad,I=k.filteredOut,A=k.hidden;return!E&&!I&&!A&&!M}),w=Uot(v.length);Ie.useEffect(function(){w&&s(w.categoryHeight)},[w,s,v.length]);var x=function(M){var k,E;return w&&g.current&&Fot({scrollTop:r,clientHeight:(k=(E=g.current)==null?void 0:E.clientHeight)!=null?k:0,topOffset:t,style:M,dimensions:w})},S=v.reduce(function(C,M,k){var E=Vc(M,f),I=zot(w,k);if(x(I)){var A,D;return b++,dot(M,c,r,(A=(D=g.current)==null?void 0:D.clientHeight)!=null?A:0,t,I,w,h),C}return a?(C.push(Ie.createElement(SP,{showVariations:p,key:E,emoji:M,unified:E,emojiStyle:c,lazyLoad:l,getEmojiUrl:h,style:Ua({},I,{position:"absolute"})})),C):(b++,C)},[]);return{virtualizedCounter:b,emojis:S,dimensions:w}}function Got(n){var e=n.categoryConfig,t=n.children,s=n.hidden,r=n.hiddenOnSearch,a=n.height,o=gP(e),l=Kme(e);return Ie.createElement("li",{className:Ur(dj.category,s&&WU.hidden,r&&uw.hiddenOnSearch),"data-name":o,"aria-label":l},Ie.createElement("h2",{className:Ur(dj.label)},l),Ie.createElement("div",{className:Ur(dj.categoryContent),style:{height:a}},t))}var dj=so.create({category:{".":ri.category,minHeight:"calc(var(--epr-emoji-fullsize) + var(--epr-category-label-height))",position:"relative"},categoryContent:{".":ri.categoryContent,display:"grid",gridGap:"0",gridTemplateColumns:"repeat(auto-fill, var(--epr-emoji-fullsize))",justifyContent:"space-between",margin:"var(--epr-category-padding)",position:"relative"},label:{".":ri.label,alignItems:"center",backdropFilter:"blur(3px)",backgroundColor:"var(--epr-category-label-bg-color)",color:"var(--epr-category-label-text-color)",display:"flex",fontSize:"16px",fontWeight:"bold",height:"var(--epr-category-label-height)",margin:"0",padding:"var(--epr-category-label-padding)",position:"sticky",textTransform:"capitalize",top:"0",width:"100%",zIndex:"var(--epr-category-label-z-index)"}});function Hot(){var n=KU(),e=Jme(),t=dw(),s=hw(),r=cge(),a=mP(),o=a[0],l=Gme(),c=l[0],u=l[1],f=Ie.useRef(null);if(Ie.useLayoutEffect(function(){f.current&&u(f.current.clientHeight)}),c)return null;var d=n[0],h=e(gP(d))[0],p=h?Vc(h,o):"";return h?Ie.createElement("div",{ref:f},Ie.createElement(SP,{emoji:h,unified:p,emojiStyle:t,getEmojiUrl:s,lazyLoad:r,showVariations:!1,hidden:!1,style:{opacity:0,pointerEvents:"none",position:"absolute",top:0,left:0,zIndex:-1,height:"var(--epr-emoji-fullsize)",width:"var(--epr-emoji-fullsize)"}})):null}function qot(n){var e=n.scrollTop,t=KU(),s=Ie.useState({}),r=s[0],a=s[1],o=gge(),l=Jme(),c=Ige(o.current),u=0;return Ie.createElement("ul",{className:Ur(Kot.emojiList),ref:o},Ie.createElement(Hot,null),t.map(function(f){var d=gP(f),h=u,p=r[d];return p&&(u+=p+c),Ie.createElement(Ie.Suspense,{key:d},Ie.createElement(Yot,{categoryEmojis:l(d),categoryConfig:f,topOffset:h,onHeightReady:function(b){r[d]!==b&&a(function(v){var w;return Ua({},v,(w={},w[d]=b,w))})},scrollTop:e}))}))}function Yot(n){var e=n.categoryEmojis,t=n.categoryConfig,s=n.topOffset,r=n.onHeightReady,a=n.scrollTop,o=qU(),l=o[0],c=Wot({categoryEmojis:e,topOffset:s,onHeightReady:r,scrollTop:a,isCategoryVisible:l.includes(t.category)}),u=c.virtualizedCounter,f=c.emojis,d=c.dimensions;return Ie.createElement(Got,{categoryConfig:t,height:d?.categoryHeight,hidden:!f.length&&u===0},f)}var Kot=so.create({emojiList:{".":ri.emojiList,listStyle:"none",margin:"0",padding:"0"}}),Xot="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IgoJIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDUwIDE1IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MCAxNSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnIGlkPSJMYXllcl8xIj4KPC9nPgo8ZyBpZD0iTGF5ZXJfMiI+Cgk8cGF0aCBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiNFOEU3RTciIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KCTxwYXRoIGZpbGw9IiMwMTAyMDIiIHN0cm9rZT0iIzE1MTYxNyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjYuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KPC9nPgo8L3N2Zz4=",Jv;(function(n){n[n.Up=0]="Up",n[n.Down=1]="Down"})(Jv||(Jv={}));function Qot(){var n=wP(),e=Pat(),t=ix(),s=t[0],r=dw(),a=Zot(e),o=a.getTop,l=a.getMenuDirection,c=yge(),u=Jot(e),f=hw(),d=dp(n.current),h=!!(s&&d&&ax(s)&&d.classList.contains(ri.emojiHasVariations));Ie.useEffect(function(){h&&_P(e.current)},[e,h,n]);var p,g;return!h&&n.current?c(null):(p=o(),g=u()),Ie.createElement("div",{ref:e,className:Ur(BA.variationPicker,l()===Jv.Down&&BA.pointingUp,h&&BA.visible),style:{top:p}},h&&s?[Vc(s)].concat(vE(s)).slice(0,6).map(function(b){return Ie.createElement(SP,{key:b,emoji:s,unified:b,emojiStyle:r,showVariations:!1,getEmojiUrl:f})}):null,Ie.createElement("div",{className:Ur(BA.pointer),style:g}))}function Jot(n){var e=wP();return function(){var s={};if(!n.current)return s;if(e.current){var r=dp(e.current),a=Cot(r);if(!r)return s;s.left=a+r?.clientWidth/2}return s}}function Zot(n){var e=wP(),t=Ld(),s=Jv.Up;return{getMenuDirection:r,getTop:a};function r(){return s}function a(){s=Jv.Up;var o=0;if(!n.current)return 0;var l=oZ(n.current);if(e.current){var c,u=t.current,f=dp(e.current),d=oZ(f);o=Age(f);var h=(c=u?.scrollTop)!=null?c:0;h>o-l&&(s=Jv.Down,o+=d+l)}return o-l}}var BA=so.create(Ua({variationPicker:{".":ri.variationPicker,position:"absolute",right:"15px",left:"15px",padding:"5px",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.2)",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-around",opacity:"0",visibility:"hidden",pointerEvents:"none",top:"-100%",border:"1px solid var(--epr-picker-border-color)",height:"var(--epr-emoji-variation-picker-height)",zIndex:"var(--epr-skin-variation-picker-z-index)",background:"var(--epr-emoji-variation-picker-bg-color)",transform:"scale(0.9)",transition:"transform 0.1s ease-out, opacity 0.2s ease-out"},visible:{opacity:"1",visibility:"visible",pointerEvents:"all",transform:"scale(1)"},pointingUp:{".":"pointing-up",transformOrigin:"center 0%",transform:"scale(0.9)"},".pointing-up":{pointer:{top:"0",transform:"rotate(180deg) translateY(100%) translateX(18px)"}},pointer:{".":"epr-emoji-pointer",content:"",position:"absolute",width:"25px",height:"15px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"50px 15px",top:"100%",transform:"translateX(-18px)",backgroundImage:"url("+Xot+")"}},v1("pointer",{backgroundPosition:"-25px 0"})));function elt(){var n=Ld(),e=Rot(n);return Uge(n,tT.PICKER),qat(),Ie.createElement("div",{className:Ur(tlt.body,uw.hiddenOnReactions),ref:n},Ie.createElement(Qot,null),Ie.createElement(qot,{scrollTop:e}))}var tlt=so.create({body:{".":ri.scrollBody,flex:"1",overflowY:"scroll",overflowX:"hidden",position:"relative"}});function nlt(n,e){if(!n||!e)return 0;var t=n.getBoundingClientRect(),s=e.getBoundingClientRect();return s.height-(t.y-s.y)}function slt(n,e){var t=Ld(),s=_ge(),r=vge();Ie.useEffect(function(){if(!n)return;var a=t.current;a?.addEventListener("keydown",c,{passive:!0}),a?.addEventListener("mouseover",u,!0),a?.addEventListener("focus",o,!0),a?.addEventListener("mouseout",l,{passive:!0}),a?.addEventListener("blur",l,!0);function o(f){var d=dp(f.target);if(!d)return l();var h=Pge(d),p=h.unified,g=h.originalUnified;if(!p||!g)return l();e({unified:p,originalUnified:g})}function l(f){if(f){var d=f.relatedTarget;if(!dp(d))return e(null)}e(null)}function c(f){f.key==="Escape"&&e(null)}function u(f){if(!s()){var d=dp(f.target);if(d){var h=nlt(d,a),p=d.getBoundingClientRect().height;if(h<p)return rlt(d,e);Ad(d)}}}return function(){a?.removeEventListener("mouseover",u),a?.removeEventListener("mouseout",l),a?.removeEventListener("focus",o,!0),a?.removeEventListener("blur",l,!0),a?.removeEventListener("keydown",c)}},[t,n,e,s,r])}function rlt(n,e){var t,s=Pge(n),r=s.unified,a=s.originalUnified;!r||!a||((t=document.activeElement)==null||t.blur==null||t.blur(),e({unified:r,originalUnified:a}))}var UA,rT;(function(n){n.ROW="FlexRow",n.COLUMN="FlexColumn"})(rT||(rT={}));function Vge(n){var e=n.children,t=n.className,s=n.style,r=s===void 0?{}:s,a=n.direction,o=a===void 0?rT.ROW:a;return Ie.createElement("div",{style:Ua({},r),className:Ur(hZ.flex,t,hZ[o])},e)}var hZ=so.create((UA={flex:{display:"flex"}},UA[rT.ROW]={flexDirection:"row"},UA[rT.COLUMN]={flexDirection:"column"},UA));function ilt(n){var e=n.className,t=n.style,s=t===void 0?{}:t;return Ie.createElement("div",{style:Ua({flex:1},s),className:Ur(e)})}function alt(n){var e=n.children,t=n.className,s=n.style;return Ie.createElement("div",{style:Ua({},s,{position:"absolute"}),className:t},e)}function MP(n){var e=n.children,t=n.className,s=n.style;return Ie.createElement("div",{style:Ua({},s,{position:"relative"}),className:t},e)}function olt(n){var e=n.isOpen,t=n.onClick,s=n.isActive,r=n.skinToneVariation,a=n.style;return Ie.createElement(_E,{style:a,onClick:t,className:Ur("epr-tone-"+r,hj.tone,!e&&hj.closedTone,s&&hj.active),"aria-pressed":s,"aria-label":"Skin tone "+Zit[r]})}var hj=so.create({closedTone:{opacity:"0",zIndex:"0"},active:{".":"epr-active",zIndex:"1",opacity:"1"},tone:{".":"epr-tone",width:"var(--epr-skin-tone-size)",display:"block",cursor:"pointer",borderRadius:"4px",height:"var(--epr-skin-tone-size)",position:"absolute",right:"0",transition:"transform 0.3s ease-in-out, opacity 0.35s ease-in-out",zIndex:"0",border:"1px solid var(--epr-skin-tone-outer-border-color)",boxShadow:"inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)",":hover":{boxShadow:"0 0 0 3px var(--epr-active-skin-hover-color), inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)"},":focus":{boxShadow:"0 0 0 3px var(--epr-focus-bg-color)"},"&.epr-tone-neutral":{backgroundColor:"#ffd225"},"&.epr-tone-1f3fb":{backgroundColor:"#ffdfbd"},"&.epr-tone-1f3fc":{backgroundColor:"#e9c197"},"&.epr-tone-1f3fd":{backgroundColor:"#c88e62"},"&.epr-tone-1f3fe":{backgroundColor:"#a86637"},"&.epr-tone-1f3ff":{backgroundColor:"#60463a"}}}),ZS=28;function llt(){return Ie.createElement(MP,{style:{height:ZS}},Ie.createElement(alt,{style:{bottom:0,right:0}},Ie.createElement(Wge,{direction:iT.VERTICAL})))}function Wge(n){var e=n.direction,t=e===void 0?iT.HORIZONTAL:e,s=XU(),r=oge(),a=bE(),o=a[0],l=a[1],c=mP(),u=c[0],f=c[1],d=Cat(),h=pw(),p=mw();if(r)return null;var g=ZS*a4.length+"px",b=o?g:ZS+"px",v=t===iT.VERTICAL;return Ie.createElement(MP,{className:Ur(mS.skinTones,v&&mS.vertical,o&&mS.open,v&&o&&mS.verticalShadow),style:v?{flexBasis:b,height:b}:{flexBasis:b}},Ie.createElement("div",{className:Ur(mS.select),ref:s},a4.map(function(w,x){var S=w===u;return Ie.createElement(olt,{key:w,skinToneVariation:w,isOpen:o,style:{transform:Ur(v?"translateY(-"+x*(o?ZS:0)+"px)":"translateX(-"+x*(o?ZS:0)+"px)",o&&S&&"scale(1.3)")},isActive:S,onClick:function(){o?(f(w),d(w),p()):l(!0),h()}})})))}var iT;(function(n){n.VERTICAL="epr-vertical",n.HORIZONTAL="epr-horizontal"})(iT||(iT={}));var mS=so.create({skinTones:{".":"epr-skin-tones","--":{"--epr-skin-tone-size":"15px"},display:"flex",alignItems:"center",justifyContent:"flex-end",transition:"all 0.3s ease-in-out",padding:"10px 0"},vertical:{padding:"9px",alignItems:"flex-end",flexDirection:"column",borderRadius:"6px",border:"1px solid var(--epr-bg-color)"},verticalShadow:{boxShadow:"0px 0 7px var(--epr-picker-border-color)"},open:{backdropFilter:"blur(5px)",background:"var(--epr-skin-tone-picker-menu-color)",".epr-active":{border:"1px solid var(--epr-active-skin-tone-indicator-border-color)"}},select:{".":"epr-skin-tone-select",position:"relative",width:"var(--epr-skin-tone-size)",height:"var(--epr-skin-tone-size)"}});function clt(){var n=lge(),e=Mge(),t=fw(),s=t[0];return n.showPreview?Ie.createElement(Vge,{className:Ur(bM.preview,uw.hiddenOnReactions,s&&bM.hideOnReactions)},Ie.createElement(ult,null),Ie.createElement(ilt,null),e?Ie.createElement(llt,null):null):null}function ult(){var n,e=lge(),t=Ie.useState(null),s=t[0],r=t[1],a=dw(),o=ix(),l=o[0],c=hw();slt(e.showPreview,r);var u=C2((n=s?.unified)!=null?n:s?.originalUnified),f=u!=null&&s!=null;return Ie.createElement(d,null);function d(){var h=l??C2(e.defaultEmoji);if(!h)return null;var p=l?z6(l):e.defaultCaption;return Ie.createElement(Ie.Fragment,null,Ie.createElement("div",null,f?Ie.createElement(V6,{unified:s?.unified,emoji:u,emojiStyle:a,size:45,getEmojiUrl:c,className:Ur(bM.emoji)}):h?Ie.createElement(V6,{unified:Vc(h),emoji:h,emojiStyle:a,size:45,getEmojiUrl:c,className:Ur(bM.emoji)}):null),Ie.createElement("div",{className:Ur(bM.label)},f?z6(u):p))}}var bM=so.create({preview:{alignItems:"center",borderTop:"1px solid var(--epr-preview-border-color)",height:"var(--epr-preview-height)",padding:"0 var(--epr-horizontal-padding)",position:"relative",zIndex:"var(--epr-preview-z-index)"},label:{color:"var(--epr-preview-text-color)",fontSize:"var(--epr-preview-text-size)",padding:"var(--epr-preview-text-padding)",textTransform:"capitalize"},emoji:{padding:"0"},hideOnReactions:{opacity:"0",transition:"opacity 0.5s ease-in-out"}});function flt(n){var e;return(e=n?.getAttribute("data-name"))!=null?e:null}function dlt(n){var e=n.setActiveCategory,t=n.setVisibleCategories,s=Ld();Ie.useEffect(function(){var r=new Map,a=new Map,o=s.current,l=new IntersectionObserver(function(c){if(o){for(var u=kit(c),f;!(f=u()).done;){var d=f.value,h=flt(d.target);h&&(r.set(h,d.intersectionRatio),a.set(h,d.isIntersecting))}var p=Array.from(r),g=p.filter(function(M){var k=M[0],E=M[1];return E>0||a.get(k)}).map(function(M){var k=M[0];return k});t(g);var b=p[p.length-1];if(b?.[1]==1)return e(b[0]);for(var v=0,w=p;v<w.length;v++){var x=w[v],S=x[0],C=x[1];if(C){e(S);break}}}},{root:o,threshold:[0,1]});return o?.querySelectorAll(yh(ri.category)).forEach(function(c){l.observe(c)}),function(){l.disconnect()}},[s,e,t])}function hlt(){var n=Ld(),e=ox();return function(s){var r;if(n.current){var a=(r=n.current)==null?void 0:r.querySelector('[data-name="'+s+'"]');if(a){var o=a.offsetTop||0;bge(e.current,o)}}}}function plt(){var n=vat();return n?n.length===0:!1}var mlt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMDBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgMjAwIDgwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyMDAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyBpZD0iTGF5ZXJfMTEiPgoJPGc+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTIuOCwyOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjEtMS4yYy0wLjYsMC0xLjIsMC41LTEuMiwxLjJDMTEuNiwyOSwxMi4yLDI5LjUsMTIuOCwyOS41eiBNMTIuOCwyOGMwLjIsMCwwLjQsMC4yLDAuNCwwLjQKCQkJYzAsMC4yLTAuMiwwLjQtMC40LDAuNGMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzEyLjQsMjguMSwxMi42LDI4LDEyLjgsMjh6Ii8+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsMjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNywyNi4yLDEzLjgsMjMsMTAsMjN6IE0xMCwzNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiwzMy40LDEzLjQsMzYuMiwxMCwzNi4yeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsMzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDMxLjUsMTQuNywzMS4zLDE0LjYsMzEuMnogTTEwLDM0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywzMy4yLDExLjYsMzQuMSwxMCwzNC4xeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiwyOS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDI5LDYuNiwyOS41LDcuMiwyOS41eiBNNy4yLDI4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDI4LjEsNywyOCw3LjIsMjh6Ii8+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjQuMSwzMy40bDIuMywwYzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjMKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40di0yLjFDNjMuNywzMy42LDYzLjgsMzMuNCw2NC4xLDMzLjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTczLjUsMzMuNWgyLjRjMC4yLDAsMC40LDAuMiwwLjQsMC40djJjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMkM3My4xLDMzLjYsNzMuMywzMy41LDczLjUsMzMuNXoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjMuNywyOC40aDEyLjZ2NUg2My43VjI4LjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTY1LjUsMjMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN3YtMy4xQzYzLjcsMjQuNSw2NC41LDIzLjYsNjUuNSwyMy42eiIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNjYuMiIgY3k9IjMwLjkiIHJ4PSIwLjkiIHJ5PSIxIi8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSI3My44IiBjeT0iMzAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNOTYuNCwzMGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCwyNi40LDk2LjQsMzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTk2LjMsMjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4xYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xYy0wLjEtMC4xLTAuMS0wLjEtMC4xLTAuMmMwLjUtMC4xLDEuMi0wLjIsMi0wLjFjMS4yLDAsMi41LDAuMywzLjUsMS4xYzEsMC44LDEuNywxLjgsMi4xLDIuOAoJCQkJQzk2LjEsMjcuOSw5Ni4yLDI4LjMsOTYuMywyOC42eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik04NCwzMi4yYzAsMCwwLTAuMSwwLTAuMWMwLjktMC4yLDIuOS0wLjQsNC43LDAuNmMxLjEsMC43LDEuOSwxLjUsMi40LDIuMwoJCQkJYzAuNCwwLjUsMC42LDEsMC43LDEuM2MtMC40LDAuMS0xLDAuMi0xLjcsMC4zYy0xLDAtMi4xLTAuMS0zLjItMC44cy0xLjktMS42LTIuNC0yLjVDODQuMiwzMi44LDg0LjEsMzIuNSw4NCwzMi4yeiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTExNi4zLDI2LjhsLTEuNCwybC0wLjgtMC44bC0wLjYtMC42bDAsMC45bC0wLjEsOC4yaC02LjgKCQkJCWwtMC4xLTguMmwwLTAuOWwtMC42LDAuNmwtMC44LDAuOGwtMS40LTJsMi42LTIuOWMwLjEtMC4xLDAuMi0wLjEsMC4zLTAuMWgxLjNsMC40LDAuN2MwLjcsMS4zLDIuNiwxLjMsMy4zLTAuMWwwLjMtMC42aDEuMgoJCQkJYzAuMSwwLDAuMiwwLDAuMywwLjFsMC4zLTAuM2wtMC4zLDAuM0wxMTYuMywyNi44eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMTAuMSwyNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDI3LjdMMTEwLjEsMjcuN3oiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMTI2LjgsMzQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMzMuMSwxMjYuOCwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNiwzNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDMyLjEsMTM3LjYsMzMuMSwxMzcuNiwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNywyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDI2LjIsMTI2LjgsMjMuNSwxMjYuOCwyMy41eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSIjMzM3MUI3IiBkPSJNMTcwLjgsMjMuMUwxNzAuOCwyMy4xYy0wLjMsMC0wLjUsMC0wLjgsMGMtMi4xLDAtNCwxLTUuMywyLjVsLTAuMSwwbC0wLjEtMC4xbC0xLTEuMmwtMC4zLDMuNGwzLjQsMC4zCgkJCQlsLTEuMS0xLjNsLTAuMS0wLjFsMC4xLTAuMWMxLjEtMS41LDMtMi4zLDUtMi4xbDAsMGMzLjIsMC4zLDUuNSwzLjEsNS4yLDYuM2MtMC4zLDMtMy4xLDUuMy02LjEsNS4xYy0zLjEtMC4yLTUuNC0yLjktNS4zLTYKCQkJCWwtMS4zLTAuMWMtMC4yLDMuOCwyLjYsNy4xLDYuMyw3LjRjMy45LDAuMyw3LjMtMi42LDcuNi02LjVDMTc3LjIsMjYuOCwxNzQuNCwyMy41LDE3MC44LDIzLjF6Ii8+CgkJCTxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik0xNzAuMywyNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNnMtMC42LDAuMy0wLjYsMC42djMuMmMwLDAuMiwwLjEsMC4zLDAuMiwwLjRjMC4xLDAuMSwwLjMsMC4yLDAuNCwwLjIKCQkJCWgyLjRjMC40LDAsMC42LTAuMywwLjYtMC42YzAtMC40LTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJ2LTAuMkwxNzAuMywyNy40TDE3MC4zLDI3LjR6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTE4Ni4yLDIzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43di03LjdDMTgzLjQsMjQuNiwxODQuNywyMy40LDE4Ni4yLDIzLjR6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxODYiIGN5PSIyOC45IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxOTQiIGN5PSIyNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDMzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjI1IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNTYsMjQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgkJYzAsMC0wLjIsMC4xLTAuOSwwLjJjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMC44LTAuMy0xLjctMC41LTIuNS0wLjVjLTAuMiwwLTAuNCwwLTAuNSwwYy0xLjMsMC0yLjUsMC4zLTMuNiwxCgkJYy0wLjIsMC4xLTAuMiwwLjItMC4yLDAuNHYxMS42YzAsMC4zLDAuMSwwLjUsMC4zLDAuNWMwLjYsMCwwLjUtMC40LDAuNS0wLjZ2LTUuN2MwLjctMC4zLDMuMi0xLjEsNS44LTAuMQoJCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjR2LTUuN0MxNTYuMiwyNC42LDE1Ni4xLDI0LjQsMTU2LDI0LjN6IE0xNTUuNiwzMC4yCgkJYy0wLjEsMC0wLjcsMC4xLTEsMC4xYy0wLjcsMC0yLjQtMC4xLTMuOC0wLjZjLTIuNS0xLTUtMC41LTYuMi0wLjF2LTQuOWMwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMAoJCWMwLjcsMCwxLjUsMC4yLDIuMiwwLjRjMS42LDAuNiwzLjUsMC43LDQuMywwLjdjMC4yLDAsMC44LDAsMS0wLjFWMzAuMnoiLz4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTQ4LjEsMjMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCUM0My42LDI1LjUsNDUuNiwyMy41LDQ4LjEsMjMuNXoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMjguOGMtMC4yLDAuMS0wLjUsMS4yLDAsMS41YzEuNCwxLDguNSwwLjgsMTEuMywwLjYKCQkJYzAuOC0wLjEsMS42LTAuNCwxLjctMS4yYzAtMC4zLTAuMS0wLjYtMC42LTAuOSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMC42TDQzLjMsMzFjLTAuMiwwLjUsMC4yLDEsMC43LDAuOWMwLjMtMC4xLDAuNSwwLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMiwwbDAuMi0wLjFjMC4zLTAuMiwwLjgtMC4yLDEuMSwwLjFsMC4yLDAuMmMwLjMsMC4zLDAuOCwwLjIsMS0wLjJsMC4xLTAuMmMwLjEtMC4yLDAtMC4zLDAuMi0wLjMKCQkJYzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMi4yYy0wLjEsMC4yLTAuMywwLjgsMCwxLjFjMC4zLDAuNCwzLDEuMSw2LjQsMS4xCgkJCWMyLjIsMCw0LjYtMC4zLDYtMC42YzAuNS0wLjEsMC45LTAuNSwwLjgtMC45YzAtMC4yLTAuMi0wLjUtMC40LTAuNyIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMy4zYzAsMC41LDAuNiwyLjMsMS4zLDIuN2MxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQljMS4zLTAuMSwyLjUtMC43LDMuMi0xLjhjMC4zLTAuNSwwLjUtMSwwLjUtMS40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUxLjYiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUzIiBjeT0iMjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNTMiIGN5PSIyNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjU0LjMiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUwLjkiIGN5PSIyNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJPC9nPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMjQuMiwzMXYtNy42YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjYsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDMyLjksMjQuMiwzMiwyNC4yLDMxeiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiwzMGw1LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDM0LjFsNS40LTEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzMGwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzNC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMzMzcxQjciIGQ9Ik0yOS41LDMyLjRMMjksMzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVzMC40LDAsMC41LDAuMmwwLjEsMC4yCgkJCUMyOC4zLDMyLjgsMjkuMSwzMi45LDI5LjUsMzIuNHoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTMyLjQsMzIuMWwtMC4xLDAuMmMtMC40LDEtMS44LDEuMS0yLjMsMC4yIi8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjI3LjYiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjMyLjQiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xMi44LDQ5LjVjMC42LDAsMS4xLTAuNSwxLjEtMS4xCgkJCWMwLTAuNi0wLjUtMS4yLTEuMS0xLjJjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMkMxMS42LDQ5LDEyLjIsNDkuNSwxMi44LDQ5LjV6IE0xMi44LDQ4YzAuMiwwLDAuNCwwLjIsMC40LDAuNAoJCQljMCwwLjItMC4yLDAuNC0wLjQsMC40Yy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDMTIuNCw0OC4xLDEyLjYsNDgsMTIuOCw0OHoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNC42LDUxLjJjLTAuMS0wLjEtMC4yLTAuMi0wLjMtMC4ySDUuNwoJCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNyw1MS41LDE0LjcsNTEuMywxNC42LDUxLjJ6IE0xMCw1NC4xCgkJCWMtMS42LDAtMy0wLjktMy43LTIuMmg3LjNDMTMsNTMuMiwxMS42LDU0LjEsMTAsNTQuMXoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik03LjIsNDkuNWMwLjYsMCwxLjItMC41LDEuMi0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4yLTEuMmMtMC42LDAtMS4xLDAuNS0xLjEsMS4yQzYuMSw0OSw2LjYsNDkuNSw3LjIsNDkuNXogTTcuMiw0OGMwLjIsMCwwLjQsMC4yLDAuNCwwLjRjMCwwLjItMC4yLDAuNC0wLjQsMC40CgkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzYuOCw0OC4xLDcsNDgsNy4yLDQ4eiIvPgoJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEwLDQzYy0zLjgsMC03LDMuMS03LDdjMCwzLjgsMy4xLDcsNyw3CgkJCXM3LTMuMSw3LTdDMTcsNDYuMiwxMy44LDQzLDEwLDQzeiBNMTAsNTYuMmMtMy40LDAtNi4yLTIuOC02LjItNi4yYzAtMy40LDIuOC02LjIsNi4yLTYuMnM2LjIsMi44LDYuMiw2LjIKCQkJQzE2LjIsNTMuNCwxMy40LDU2LjIsMTAsNTYuMnoiLz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02NC4xLDUzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDUzLjYsNjMuOCw1My40LDY0LjEsNTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNzMuNSw1My41aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2MmMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuNAoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRsMC0yQzczLjEsNTMuNiw3My4zLDUzLjUsNzMuNSw1My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02My43LDQ4LjRoMTIuNnY1SDYzLjdWNDguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNjUuNSw0My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw0NC41LDY0LjUsNDMuNiw2NS41LDQzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI2Ni4yIiBjeT0iNTAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjczLjgiIGN5PSI1MC45IiByeD0iMC45IiByeT0iMSIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik05Ni40LDUwYzAsMy42LTIuOSw2LjUtNi40LDYuNXMtNi40LTIuOS02LjQtNi41czIuOS02LjUsNi40LTYuNVM5Ni40LDQ2LjQsOTYuNCw1MHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNOTYuMyw0OC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw0Ny45LDk2LjIsNDguMyw5Ni4zLDQ4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTg0LDUyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDUyLjgsODQuMSw1Mi41LDg0LDUyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNDYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDQ2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTExMC4xLDQ3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNDcuN0wxMTAuMSw0Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0xMjYuOCw1NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw1My4xLDEyNi44LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy42LDU0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNTIuMSwxMzcuNiw1My4xLDEzNy42LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy43LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNDYuMiwxMjYuOCw0My41LDEyNi44LDQzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIGQ9Ik0xNzAuOCw0My4xTDE3MC44LDQzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjUsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw0Ni44LDE3NC40LDQzLjUsMTcwLjgsNDMuMXoiLz4KCQkJPHBhdGggZmlsbD0iI0MwQzBCRiIgZD0iTTE3MC4zLDQ3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZjMC0wLjMtMC4zLTAuNi0wLjYtMC42aC0xLjZoLTAuMnYtMC4yTDE3MC4zLDQ3LjRMMTcwLjMsNDcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNMTg2LjIsNDMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw0NC43LDE4NC43LDQzLjQsMTg2LjIsNDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE4NiIgY3k9IjQ4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE5NCIgY3k9IjQ2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNTMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iI0MwQzBCRiIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw0NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDQ0LjYsMTU2LjEsNDQuNCwxNTYsNDQuM3ogTTE1NS42LDUwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY1MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNDguMSw0My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNDUuNSw0NS42LDQzLjUsNDguMSw0My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw0OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDEsOC41LDAuOCwxMS4zLDAuNgoJCQljMC44LTAuMSwxLjYtMC40LDEuNy0xLjJjMC0wLjMtMC4xLTAuNi0wLjYtMC45Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUwLjZMNDMuMyw1MWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45YzAuMy0wLjEsMC41LDAsMC43LDAuMwoJCQlsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjIsMC44LDAuMSwxLjIsMGwwLjUtMC4yYzAuNC0wLjIsMC45LTAuMiwxLjMsMGwwLjUsMC4yCgkJCWMwLjQsMC4yLDAuOCwwLjIsMS4yLDBsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC41LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUzLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTEuNiIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTMiIGN5PSI0NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI1MyIgY3k9IjQ3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTQuMyIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTAuOSIgY3k9IjQ1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0yNC4yLDUxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNTIuOSwyNC4yLDUyLDI0LjIsNTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDUwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsNTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDUwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDU0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTI5LjUsNTIuNEwyOSw1MS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNTIuOCwyOS4xLDUyLjksMjkuNSw1Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw1Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMjcuNiIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMzIuNCIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KCTxnPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsNzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDcxLjUsMTQuNyw3MS4zLDE0LjYsNzEuMnogTTEwLDc0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMyw3My4yLDExLjYsNzQuMSwxMCw3NC4xeiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsNjkuNWMwLjYsMCwxLjEtMC41LDEuMS0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4xLTEuMmMtMC42LDAtMS4yLDAuNS0xLjIsMS4yQzExLjYsNjksMTIuMiw2OS41LDEyLjgsNjkuNXogTTEyLjgsNjhjMC4yLDAsMC40LDAuMiwwLjQsMC40CgkJCWMwLDAuMi0wLjIsMC40LTAuNCwwLjRjLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDY4LjEsMTIuNiw2OCwxMi44LDY4eiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw2OS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDY5LDYuNiw2OS41LDcuMiw2OS41eiBNNy4yLDY4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDY4LjEsNyw2OCw3LjIsNjh6Ii8+CgkJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsNjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNyw2Ni4yLDEzLjgsNjMsMTAsNjN6IE0xMCw3Ni4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiw3My40LDEzLjQsNzYuMiwxMCw3Ni4yeiIvPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTY0LjEsNzMuNGwyLjMsMGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi4zCgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNHYtMi4xQzYzLjcsNzMuNiw2My44LDczLjQsNjQuMSw3My40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik03My41LDczLjVoMi40YzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMi4xQzczLjEsNzMuNiw3My4zLDczLjUsNzMuNSw3My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik02My43LDY4LjRoMTIuNnY1SDYzLjdWNjguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNjUuNSw2My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw2NC41LDY0LjUsNjMuNiw2NS41LDYzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI2Ni4yIiBjeT0iNzAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNzMuOCIgY3k9IjcwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNOTYuNCw3MGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCw2Ni40LDk2LjQsNzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTk2LjMsNjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4yYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xLjFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw2Ny45LDk2LjIsNjguMyw5Ni4zLDY4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTg0LDcyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDcyLjgsODQuMSw3Mi40LDg0LDcyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNjYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDY2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTExMC4xLDY3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNjcuN0wxMTAuMSw2Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0xMjYuOCw3NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw3My4xLDEyNi44LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy42LDc0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNzIuMSwxMzcuNiw3My4xLDEzNy42LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy43LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDYzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNjYuMiwxMjYuOCw2My41LDEyNi44LDYzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xNzAuOCw2My4xTDE3MC44LDYzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw2Ni44LDE3NC40LDYzLjUsMTcwLjgsNjMuMXoiLz4KCQkJPHBhdGggZmlsbD0iIzZBQTlERCIgZD0iTTE3MC4zLDY3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZTMTcyLjQsNzAsMTcyLDcwaC0xLjZoLTAuMnYtMC4yTDE3MC4zLDY3LjRMMTcwLjMsNjcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNMTg2LjIsNjMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw2NC43LDE4NC43LDYzLjQsMTg2LjIsNjMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE4NiIgY3k9IjY4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE5NCIgY3k9IjY2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNzMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw2NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDY0LjYsMTU2LjEsNjQuNCwxNTYsNjQuM3ogTTE1NS42LDcwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY3MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNDguMSw2My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNjUuNSw0NS42LDYzLjUsNDguMSw2My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw2OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDAuOSw4LjUsMC44LDExLjMsMC42CgkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsNzAuNkw0My4zLDcxYy0wLjIsMC41LDAuMiwxLDAuNywwLjljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDcyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDczLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTEuNiIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTMiIGN5PSI2NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI1MyIgY3k9IjY3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTQuMyIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTAuOSIgY3k9IjY1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0yNC4yLDcxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNzIuOSwyNC4yLDcyLDI0LjIsNzF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDcwLjFsNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiw3NC4xbDUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTM4LjgsNzAuMWwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCw3NC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiM2QUE5REQiIGQ9Ik0yOS41LDcyLjRMMjksNzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVjMC4yLTAuMSwwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNzIuOCwyOS4xLDcyLjksMjkuNSw3Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw3Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMjcuNiIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMzIuNCIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KPC9nPgo8Zz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMgoJCWMwLTAuNi0wLjUtMS4xLTEuMS0xLjFjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMVMxMi4yLDkuNSwxMi44LDkuNXogTTEyLjgsNy45YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDguMSwxMi42LDcuOSwxMi44LDcuOXoiLz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw5LjVjMC42LDAsMS4yLTAuNSwxLjItMS4yCgkJYzAtMC42LTAuNS0xLjEtMS4yLTEuMWMtMC42LDAtMS4xLDAuNS0xLjEsMS4xUzYuNiw5LjUsNy4yLDkuNXogTTcuMiw3LjljMC4yLDAsMC40LDAuMiwwLjQsMC40YzAsMC4yLTAuMiwwLjQtMC40LDAuNAoJCUM3LDguNyw2LjgsOC41LDYuOCw4LjNDNi44LDguMSw3LDcuOSw3LjIsNy45eiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTQuNiwxMS4yYy0wLjEtMC4xLTAuMi0wLjItMC4zLTAuMkg1LjcKCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNywxMS40LDE0LjcsMTEuMywxNC42LDExLjJ6IE0xMCwxNC4xCgkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywxMy4yLDExLjYsMTQuMSwxMCwxNC4xeiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsM2MtMy44LDAtNywzLjEtNyw3czMuMSw3LDcsN3M3LTMuMSw3LTcKCQlTMTMuOCwzLDEwLDN6IE0xMCwxNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJTNi42LDMuOCwxMCwzLjhzNi4yLDIuOCw2LjIsNi4yUzEzLjQsMTYuMiwxMCwxNi4yeiIvPgo8L2c+CjxnIGlkPSJDYXJfMDAwMDAwMTg5MzUzOTUwODU0MTM0MTM3NTAwMDAwMDA4MjUyNzM4Nzc4NDI3NzU3MTVfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NC4xLDEzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDEzLjYsNjMuOCwxMy40LDY0LjEsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNzMuNSwxMy40aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi40CgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNGwwLTIuMUM3My4xLDEzLjYsNzMuMywxMy40LDczLjUsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNjMuNyw4LjRoMTIuNnY1SDYzLjdWOC40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NS41LDMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN1Y1LjVDNjMuNyw0LjQsNjQuNSwzLjYsNjUuNSwzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI2Ni4yIiBjeT0iMTAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNzMuOCIgY3k9IjEwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+CjwvZz4KPGcgaWQ9IkFjdGl2aXRpZXMiPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjQsMTBjMCwzLjYtMi45LDYuNS02LjQsNi41cy02LjQtMi45LTYuNC02LjVzMi45LTYuNSw2LjQtNi41Uzk2LjQsNi40LDk2LjQsMTB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjMsOC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTEuMWMtMC4xLTAuMS0wLjEtMC4yLTAuMS0wLjJjMC41LTAuMSwxLjItMC4yLDItMC4yYzEuMiwwLDIuNSwwLjMsMy41LDEuMWMxLDAuOCwxLjcsMS44LDIuMSwyLjgKCQkJCUM5Ni4xLDcuOSw5Ni4yLDguMyw5Ni4zLDguNnoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNODQsMTIuMWMwLDAsMC0wLjEsMC0wLjFjMC45LTAuMiwyLjktMC40LDQuNywwLjZjMS4xLDAuNiwxLjksMS41LDIuNCwyLjMKCQkJCWMwLjQsMC41LDAuNiwxLDAuNywxLjNjLTAuNCwwLjEtMSwwLjItMS43LDAuM2MtMSwwLTIuMS0wLjEtMy4yLTAuOGMtMS4xLTAuNi0xLjktMS42LTIuNC0yLjVDODQuMiwxMi44LDg0LjEsMTIuNCw4NCwxMi4xeiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iT2JqZWN0c18wMDAwMDA2NDMxMjM3MTczOTEzMDMxNTI1MDAwMDAxMDIyNTg4OTAzMjIyODYzMjk3NV8iPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNi44bC0xLjQsMkwxMTQuMSw4bC0wLjYtMC43bDAsMC45bC0wLjEsOC4yaC02LjhsLTAuMS04LjIKCQkJCWwwLTAuOUwxMDUuOSw4bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDYuOHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTEwLjEsNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDcuN0wxMTAuMSw3Ljd6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJTeW1ib2xzXzAwMDAwMDk2NzQ2OTA3ODY5OTI5OTIxMTgwMDAwMDA2NDg0ODEyODMwMjgyNTgyNDE2XyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMTQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMTMuMSwxMjYuOCwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMzcuNiwxNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDEyLjEsMTM3LjYsMTMuMSwxMzcuNiwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMjYuOCw0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTEzNy43LDQuNHY5LjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDYuMiwxMjYuOCwzLjUsMTI2LjgsMy41eiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iUmVjZW50cyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTE3MC44LDMuMUwxNzAuOCwzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJTDE2Myw5LjVjLTAuMiwzLjgsMi42LDcuMSw2LjMsNy40YzMuOSwwLjQsNy4zLTIuNiw3LjYtNi41QzE3Ny4yLDYuOCwxNzQuNCwzLjUsMTcwLjgsMy4xeiIvPgoJCQk8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNMTcwLjMsNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNlMxNjksNy4xLDE2OSw3LjR2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZzLTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJWOS44TDE3MC4zLDcuNEwxNzAuMyw3LjR6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJDdXN0b21fMDAwMDAxODEwODcyMjk0MzQzMDIzMzY3ODAwMDAwMDUxNTIyNzc5NDU5NDA2NzQ0ODhfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xODYuMiwzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43VjYuMUMxODMuNCw0LjYsMTg0LjcsMy40LDE4Ni4yLDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjE4NiIgY3k9IjguOSIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMTk0IiBjeT0iNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDEzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS13aWR0aD0iMC4yNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTU2LDQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgljMCwwLTAuMiwwLjEtMC45LDAuMWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCWMtMC4yLDAuMS0wLjIsMC4yLTAuMiwwLjR2MTEuNmMwLDAuMywwLjEsMC41LDAuMywwLjVjMC42LDAsMC41LTAuNCwwLjUtMC42di01LjdjMC43LTAuMywzLjItMS4xLDUuOC0wLjFjMS42LDAuNiwzLjUsMC43LDQuMywwLjcKCWMwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjRWNC43QzE1Ni4yLDQuNSwxNTYuMSw0LjQsMTU2LDQuM3ogTTE1NS42LDEwLjJjLTAuMSwwLTAuNywwLjEtMSwwLjEKCWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0yLjUtMS01LTAuNS02LjItMC4xVjQuN2MwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMGMwLjcsMCwxLjUsMC4yLDIuMiwwLjQKCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVYxMC4yeiIvPgo8ZyBpZD0iRm9vZCI+Cgk8ZyBpZD0iTGF5ZXJfMTIiPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik00OC4xLDMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCQlDNDMuNiw1LjUsNDUuNiwzLjUsNDguMSwzLjV6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw4LjdjLTAuMiwwLjEtMC41LDEuMiwwLDEuNWMxLjQsMC45LDguNSwwLjgsMTEuMywwLjYKCQkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDEwLjZMNDMuMywxMWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45CgkJCQljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjNsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjEsMC44LDAuMSwxLjIsMGwwLjUtMC4yCgkJCQljMC40LTAuMiwwLjktMC4yLDEuMywwbDAuNSwwLjJjMC40LDAuMiwwLjgsMC4xLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjEsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yCgkJCQljMC4xLTAuMiwwLTAuMywwLjItMC40YzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMTIuMWMtMC4xLDAuMi0wLjMsMC44LDAsMS4xYzAuMywwLjQsMywxLjEsNi40LDEuMQoJCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwxMy4zYzAsMC41LDAuNiwyLjQsMS4zLDIuNmMxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQkJYzEuMy0wLjEsMi41LTAuNywzLjItMS44YzAuMy0wLjUsMC41LTEsMC41LTEuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTEuNiIgY3k9IjYuNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTMiIGN5PSI0LjkiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjUzIiBjeT0iNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1NC4zIiBjeT0iNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1MC45IiBjeT0iNC45IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJBbmltYWxzIj4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTI0LjIsMTFWMy41YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjcsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDEyLjksMjQuMiwxMS45LDI0LjIsMTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDEwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsMTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDEwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDE0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTI5LjUsMTIuNEwyOSwxMS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsMTIuNywyOS4xLDEyLjksMjkuNSwxMi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCwxMi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMjcuNiIgY3k9IjkuNyIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSIzMi40IiBjeT0iOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+CjwvZz4KPC9zdmc+";function glt(n){var e,t=n.isActiveCategory,s=n.category,r=n.allowNavigation,a=n.categoryConfig,o=n.onClick;return Ie.createElement(_E,{tabIndex:r?0:-1,className:Ur(blt.catBtn,uw.categoryBtn,"epr-icn-"+s,(e={},e[ri.active]=t,e)),onClick:o,"aria-label":Kme(a),"aria-selected":t,role:"tab","aria-controls":"epr-category-nav-id"})}var pZ={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 3)"},ylt={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 2)"},mZ={":not(.epr-search-active)":{catBtn:{":hover":pZ,"&.epr-active":pZ}}},blt=so.create(Ua({catBtn:{".":"epr-cat-btn",display:"inline-block",transition:"opacity 0.2s ease-in-out",position:"relative",height:"var(--epr-category-navigation-button-size)",width:"var(--epr-category-navigation-button-size)",backgroundSize:"calc(var(--epr-category-navigation-button-size) * 10)",outline:"none",backgroundPosition:"0 0",backgroundImage:"url("+mlt+")",":focus:before":{content:"",position:"absolute",top:"-2px",left:"-2px",right:"-2px",bottom:"-2px",border:"2px solid var(--epr-category-icon-active-color)",borderRadius:"50%"},"&.epr-icn-suggested":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -8)"},"&.epr-icn-custom":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -9)"},"&.epr-icn-activities":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -4)"},"&.epr-icn-animals_nature":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -1)"},"&.epr-icn-flags":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -7)"},"&.epr-icn-food_drink":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -2)"},"&.epr-icn-objects":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -5)"},"&.epr-icn-smileys_people":{backgroundPositionX:"0px"},"&.epr-icn-symbols":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -6)"},"&.epr-icn-travel_places":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -3)"}}},v1("catBtn",ylt),{".epr-dark-theme":Ua({},mZ),".epr-auto-theme":Ua({},mZ)}));function wlt(){var n=Ie.useState(null),e=n[0],t=n[1],s=qU(),r=s[1],a=hlt();dlt({setActiveCategory:t,setVisibleCategories:r});var o=bP(),l=KU(),c=QU(),u=plt();return Ie.createElement("div",{className:Ur(vlt.nav),role:"tablist","aria-label":"Category navigation",id:"epr-category-nav-id",ref:c},l.map(function(f){var d=gP(f),h=d===e;if(Tot(f)&&u)return null;var p=!o&&!h;return Ie.createElement(glt,{key:d,category:d,isActiveCategory:h,allowNavigation:p,categoryConfig:f,onClick:function(){a(d),setTimeout(function(){t(d)},10)}})}))}var vlt=so.create({nav:{".":"epr-category-nav",display:"flex",flexDirection:"row",justifyContent:"space-around",padding:"var(--epr-header-padding)"},".epr-search-active":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}},".epr-main:has(input:not(:placeholder-shown))":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}}}),Gge="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNi45OCwxMy41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsOAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQyTDcuNzQsNy4yN2MtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywxMy4wNSw2Ljc3LDEzLjM5LDYuOTgsMTMuNTlMNi45OCwxMy41OXoiLz4KPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTEwLjE1LDE4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDE0Ljg0LDUuNzQsMTguNDMsMTAuMTUsMTguNDN6CgkgTTEwLjE1LDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0QzMuMjEsNi42LDYuMzMsMy40OSwxMC4xNSwzLjQ5CglMMTAuMTUsMy40OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTYuOTgsMzMuNTljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1czAuMjctMC4wNSwwLjM3LTAuMTVsMi40Mi0yLjQybDIuNDMsMi40MwoJYzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNWMwLjE0LDAsMC4yNy0wLjA1LDAuMzctMC4xNWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWwtMi40My0yLjQzTDEzLjMyLDI4CgljMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwbC0yLjQyLDIuNDJsLTIuNDEtMi40MWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywzMy4wNSw2Ljc3LDMzLjM5LDYuOTgsMzMuNTlMNi45OCwzMy41OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTEwLjE1LDM4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDM0Ljg0LDUuNzQsMzguNDMsMTAuMTUsMzguNDN6CgkgTTEwLjE1LDIzLjQ5YzMuODMsMCw2Ljk0LDMuMTEsNi45NCw2Ljk0YzAsMy44My0zLjExLDYuOTQtNi45NCw2Ljk0Yy0zLjgzLDAtNi45NC0zLjExLTYuOTQtNi45NAoJQzMuMjEsMjYuNiw2LjMzLDIzLjQ5LDEwLjE1LDIzLjQ5TDEwLjE1LDIzLjQ5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNi45OCw1My41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsNDgKCWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDBsLTIuNDIsMi40MmwtMi40MS0yLjQxYy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMAoJYy0wLjIxLDAuMjEtMC4yMSwwLjU0LDAsMC43NWwyLjQxLDIuNDFsLTIuNDIsMi40MkM2Ljc3LDUzLjA1LDYuNzcsNTMuMzksNi45OCw1My41OUw2Ljk4LDUzLjU5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNMTAuMTUsNTguNDNjNC40MSwwLDgtMy41OSw4LThjMC00LjQxLTMuNTktOC04LThjLTQuNDEsMC04LDMuNTktOCw4QzIuMTUsNTQuODQsNS43NCw1OC40MywxMC4xNSw1OC40M3oKCSBNMTAuMTUsNDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0CglDMy4yMSw0Ni42LDYuMzMsNDMuNDksMTAuMTUsNDMuNDlMMTAuMTUsNDMuNDl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik02Ljk4LDczLjU5YzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNXMwLjI3LTAuMDUsMC4zNy0wLjE1bDIuNDItMi40MmwyLjQzLDIuNDMKCWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVjMC4xNCwwLDAuMjctMC4wNSwwLjM3LTAuMTVjMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVsLTIuNDMtMi40M0wxMy4zMiw2OAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQybC0yLjQxLTIuNDFjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwCgljLTAuMjEsMC4yMS0wLjIxLDAuNTQsMCwwLjc1bDIuNDEsMi40MWwtMi40MiwyLjQyQzYuNzcsNzMuMDUsNi43Nyw3My4zOSw2Ljk4LDczLjU5TDYuOTgsNzMuNTl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xMC4xNSw3OC40M2M0LjQxLDAsOC0zLjU5LDgtOGMwLTQuNDEtMy41OS04LTgtOGMtNC40MSwwLTgsMy41OS04LDhDMi4xNSw3NC44NCw1Ljc0LDc4LjQzLDEwLjE1LDc4LjQzegoJIE0xMC4xNSw2My40OWMzLjgzLDAsNi45NCwzLjExLDYuOTQsNi45NGMwLDMuODMtMy4xMSw2Ljk0LTYuOTQsNi45NGMtMy44MywwLTYuOTQtMy4xMS02Ljk0LTYuOTQKCUMzLjIxLDY2LjYsNi4zMyw2My40OSwxMC4xNSw2My40OUwxMC4xNSw2My40OXoiLz4KPC9zdmc+";function _lt(){var n=Cge(),e=yat();return Ie.createElement(_E,{className:Ur(gZ.btnClearSearch,uw.visibleOnSearchOnly),onClick:n,"aria-label":e,title:e},Ie.createElement("div",{className:Ur(gZ.icnClearnSearch)}))}var xlt={":hover":{"> .epr-icn-clear-search":{backgroundPositionY:"-60px"}}},gZ=so.create(Ua({btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+Gge+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},v1("icnClearnSearch",{backgroundPositionY:"-40px"}),v1("btnClearSearch",xlt))),Clt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjAgMCAyMCA0MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgNDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTEyLDguODFjMCwyLjA4LTEuNjgsMy43Ni0zLjc2LDMuNzZjLTIuMDgsMC0zLjc2LTEuNjgtMy43Ni0zLjc2CgljMC0yLjA4LDEuNjgtMy43NiwzLjc2LTMuNzZDMTAuMzIsNS4wNSwxMiw2LjczLDEyLDguODF6IE0xMS4yMywxMi43MmMtMC44MywwLjY0LTEuODcsMS4wMS0yLjk5LDEuMDFjLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTIKCWMwLTIuNzIsMi4yLTQuOTIsNC45Mi00LjkyYzIuNzIsMCw0LjkyLDIuMiw0LjkyLDQuOTJjMCwxLjEzLTAuMzgsMi4xNi0xLjAxLDIuOTlsMy45NCwzLjkzYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyCgljLTAuMjUsMC4yNS0wLjY2LDAuMjUtMC45MiwwTDExLjIzLDEyLjcyeiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTEyLDI4LjgxYzAsMi4wOC0xLjY4LDMuNzYtMy43NiwzLjc2Yy0yLjA4LDAtMy43Ni0xLjY4LTMuNzYtMy43NgoJYzAtMi4wOCwxLjY4LTMuNzYsMy43Ni0zLjc2QzEwLjMyLDI1LjA1LDEyLDI2LjczLDEyLDI4LjgxeiBNMTEuMjMsMzIuNzJjLTAuODMsMC42NC0xLjg3LDEuMDEtMi45OSwxLjAxCgljLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTJjMC0yLjcyLDIuMi00LjkyLDQuOTItNC45MmMyLjcyLDAsNC45MiwyLjIsNC45Miw0LjkyYzAsMS4xMy0wLjM4LDIuMTYtMS4wMSwyLjk5bDMuOTQsMy45MwoJYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyYy0wLjI1LDAuMjUtMC42NiwwLjI1LTAuOTIsMEwxMS4yMywzMi43MnoiLz4KPC9zdmc+";function Slt(){return Ie.createElement("div",{className:Ur(Mlt.icnSearch)})}var Mlt=so.create(Ua({icnSearch:{".":"epr-icn-search",content:"",position:"absolute",top:"50%",left:"var(--epr-search-bar-inner-padding)",transform:"translateY(-50%)",width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"20px",backgroundImage:"url("+Clt+")"}},v1("icnSearch",{backgroundPositionY:"-20px"})));function Tlt(){var n=uge(),e=ZU();return n?null:Ie.createElement(Vge,{className:Ur(zL.overlay)},Ie.createElement(klt,null),e?Ie.createElement(Wge,null):null)}function klt(){var n=pw(),e=O1(),t=gat(),s=wat(),r=Qat(),a=r.statusSearchResults,o=r.searchTerm,l=r.onChange,c=e?.current,u=c?.value;return Ie.createElement(MP,{className:Ur(zL.searchContainer)},Ie.createElement("input",{autoFocus:s,"aria-label":"Type to search for an emoji",onFocus:n,className:Ur(zL.search),type:"text","aria-controls":"epr-search-id",placeholder:t,onChange:function(d){var h,p;l((h=d==null||(p=d.target)==null?void 0:p.value)!=null?h:u)},ref:e}),o?Ie.createElement("div",{role:"status",className:Ur("epr-status-search-results",zL.visuallyHidden),"aria-live":"polite",id:"epr-search-id","aria-atomic":"true"},a):null,Ie.createElement(Slt,null),Ie.createElement(_lt,null))}var zL=so.create(Ua({overlay:{padding:"var(--epr-header-padding)",zIndex:"var(--epr-header-overlay-z-index)"},searchContainer:{".":"epr-search-container",flex:"1",display:"block",minWidth:"0"},visuallyHidden:{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:"1px"},search:{outline:"none",transition:"all 0.2s ease-in-out",color:"var(--epr-search-input-text-color)",borderRadius:"var(--epr-search-input-border-radius)",padding:"var(--epr-search-input-padding)",height:"var(--epr-search-input-height)",backgroundColor:"var(--epr-search-input-bg-color)",border:"1px solid var(--epr-search-border-color)",width:"100%",":focus":{backgroundColor:"var(--epr-search-input-bg-color-active)",border:"1px solid var(--epr-search-border-color-active)"},"::placeholder":{color:"var(--epr-search-input-placeholder-color)"}},btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+Gge+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},v1("icnClearnSearch",{backgroundPositionY:"-40px"}),v1("btnClearSearch",{":hover > .epr-icn-clear-search":{backgroundPositionY:"-60px"}})));function Elt(){return Ie.createElement(MP,{className:Ur("epr-header",uw.hiddenOnReactions)},Ie.createElement(Tlt,null),Ie.createElement(wlt,null))}function Ilt(n){return Ie.createElement(Dat,null,Ie.createElement(Eit,null),Ie.createElement(hat,Object.assign({},n),Ie.createElement(Alt,null)))}function Alt(){var n=fw(),e=n[0],t=age(),s=Ie.useState(!e),r=s[0],a=s[1],o=_at();return Ie.useEffect(function(){e&&!t||r||a(!0)},[r,t,e]),o?Ie.createElement(got,null,Ie.createElement(jot,null),Ie.createElement(Llt,{renderAll:r})):null}function Llt(n){var e=n.renderAll;return e?Ie.createElement(Ie.Fragment,null,Ie.createElement(Elt,null),Ie.createElement(elt,null),Ie.createElement(clt,null)):null}var Nlt=Ie.memo(Ilt,Bme),Dlt=(function(n){Mit(e,n);function e(s){var r;return r=n.call(this,s)||this,r.state={hasError:!1},r}e.getDerivedStateFromError=function(){return{hasError:!0}};var t=e.prototype;return t.componentDidCatch=function(r,a){console.error("Emoji Picker React failed to render:",r,a)},t.render=function(){return this.state.hasError?null:this.props.children},e})(Ie.Component);function Olt(n){var e=mat({onEmojiClick:n.onEmojiClick,onReactionClick:n.onReactionClick,onSkinToneChange:n.onSkinToneChange});return Ie.createElement(Dlt,null,Ie.createElement(rge.Provider,{value:e},Ie.createElement(Nlt,Object.assign({},n))))}function xE(n){return n+.5|0}const J0=(n,e,t)=>Math.max(Math.min(n,t),e);function eM(n){return J0(xE(n*2.55),0,255)}function a1(n){return J0(xE(n*255),0,255)}function xg(n){return J0(xE(n/2.55)/100,0,1)}function yZ(n){return J0(xE(n*100),0,100)}const Zd={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},W6=[..."0123456789ABCDEF"],Plt=n=>W6[n&15],$lt=n=>W6[(n&240)>>4]+W6[n&15],VA=n=>(n&240)>>4===(n&15),jlt=n=>VA(n.r)&&VA(n.g)&&VA(n.b)&&VA(n.a);function Rlt(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Zd[n[1]]*17,g:255&Zd[n[2]]*17,b:255&Zd[n[3]]*17,a:e===5?Zd[n[4]]*17:255}:(e===7||e===9)&&(t={r:Zd[n[1]]<<4|Zd[n[2]],g:Zd[n[3]]<<4|Zd[n[4]],b:Zd[n[5]]<<4|Zd[n[6]],a:e===9?Zd[n[7]]<<4|Zd[n[8]]:255})),t}const Flt=(n,e)=>n<255?e(n):"";function zlt(n){var e=jlt(n)?Plt:$lt;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Flt(n.a,e):void 0}const Blt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Hge(n,e,t){const s=e*Math.min(t,1-t),r=(a,o=(a+n/30)%12)=>t-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function Ult(n,e,t){const s=(r,a=(r+n/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[s(5),s(3),s(1)]}function Vlt(n,e,t){const s=Hge(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)s[r]*=1-e-t,s[r]+=e;return s}function Wlt(n,e,t,s,r){return n===r?(e-t)/s+(e<t?6:0):e===r?(t-n)/s+2:(n-e)/s+4}function o7(n){const t=n.r/255,s=n.g/255,r=n.b/255,a=Math.max(t,s,r),o=Math.min(t,s,r),l=(a+o)/2;let c,u,f;return a!==o&&(f=a-o,u=l>.5?f/(2-a-o):f/(a+o),c=Wlt(t,s,r,f,a),c=c*60+.5),[c|0,u||0,l]}function l7(n,e,t,s){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,s)).map(a1)}function c7(n,e,t){return l7(Hge,n,e,t)}function Glt(n,e,t){return l7(Vlt,n,e,t)}function Hlt(n,e,t){return l7(Ult,n,e,t)}function qge(n){return(n%360+360)%360}function qlt(n){const e=Blt.exec(n);let t=255,s;if(!e)return;e[5]!==s&&(t=e[6]?eM(+e[5]):a1(+e[5]));const r=qge(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=Glt(r,a,o):e[1]==="hsv"?s=Hlt(r,a,o):s=c7(r,a,o),{r:s[0],g:s[1],b:s[2],a:t}}function Ylt(n,e){var t=o7(n);t[0]=qge(t[0]+e),t=c7(t),n.r=t[0],n.g=t[1],n.b=t[2]}function Klt(n){if(!n)return;const e=o7(n),t=e[0],s=yZ(e[1]),r=yZ(e[2]);return n.a<255?`hsla(${t}, ${s}%, ${r}%, ${xg(n.a)})`:`hsl(${t}, ${s}%, ${r}%)`}const bZ={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wZ={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Xlt(){const n={},e=Object.keys(wZ),t=Object.keys(bZ);let s,r,a,o,l;for(s=0;s<e.length;s++){for(o=l=e[s],r=0;r<t.length;r++)a=t[r],l=l.replace(a,bZ[a]);a=parseInt(wZ[o],16),n[l]=[a>>16&255,a>>8&255,a&255]}return n}let WA;function Qlt(n){WA||(WA=Xlt(),WA.transparent=[0,0,0,0]);const e=WA[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Jlt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Zlt(n){const e=Jlt.exec(n);let t=255,s,r,a;if(e){if(e[7]!==s){const o=+e[7];t=e[8]?eM(o):J0(o*255,0,255)}return s=+e[1],r=+e[3],a=+e[5],s=255&(e[2]?eM(s):J0(s,0,255)),r=255&(e[4]?eM(r):J0(r,0,255)),a=255&(e[6]?eM(a):J0(a,0,255)),{r:s,g:r,b:a,a:t}}}function ect(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${xg(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const pj=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Cv=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function tct(n,e,t){const s=Cv(xg(n.r)),r=Cv(xg(n.g)),a=Cv(xg(n.b));return{r:a1(pj(s+t*(Cv(xg(e.r))-s))),g:a1(pj(r+t*(Cv(xg(e.g))-r))),b:a1(pj(a+t*(Cv(xg(e.b))-a))),a:n.a+t*(e.a-n.a)}}function GA(n,e,t){if(n){let s=o7(n);s[e]=Math.max(0,Math.min(s[e]+s[e]*t,e===0?360:1)),s=c7(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function Yge(n,e){return n&&Object.assign(e||{},n)}function vZ(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=a1(n[3]))):(e=Yge(n,{r:0,g:0,b:0,a:1}),e.a=a1(e.a)),e}function nct(n){return n.charAt(0)==="r"?Zlt(n):qlt(n)}class aT{constructor(e){if(e instanceof aT)return e;const t=typeof e;let s;t==="object"?s=vZ(e):t==="string"&&(s=Rlt(e)||Qlt(e)||nct(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=Yge(this._rgb);return e&&(e.a=xg(e.a)),e}set rgb(e){this._rgb=vZ(e)}rgbString(){return this._valid?ect(this._rgb):void 0}hexString(){return this._valid?zlt(this._rgb):void 0}hslString(){return this._valid?Klt(this._rgb):void 0}mix(e,t){if(e){const s=this.rgb,r=e.rgb;let a;const o=t===a?.5:t,l=2*o-1,c=s.a-r.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-u,s.r=255&u*s.r+a*r.r+.5,s.g=255&u*s.g+a*r.g+.5,s.b=255&u*s.b+a*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,t){return e&&(this._rgb=tct(this._rgb,e._rgb,t)),this}clone(){return new aT(this.rgb)}alpha(e){return this._rgb.a=a1(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=xE(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return GA(this._rgb,2,e),this}darken(e){return GA(this._rgb,2,-e),this}saturate(e){return GA(this._rgb,1,e),this}desaturate(e){return GA(this._rgb,1,-e),this}rotate(e){return Ylt(this._rgb,e),this}}function pg(){}const sct=(()=>{let n=0;return()=>n++})();function ji(n){return n==null}function $l(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function di(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function bh(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function am(n,e){return bh(n)?n:e}function _r(n,e){return typeof n>"u"?e:n}const rct=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,Kge=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Ra(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Vi(n,e,t,s){let r,a,o;if($l(n))for(a=n.length,r=0;r<a;r++)e.call(t,n[r],r);else if(di(n))for(o=Object.keys(n),a=o.length,r=0;r<a;r++)e.call(t,n[o[r]],o[r])}function c4(n,e){let t,s,r,a;if(!n||!e||n.length!==e.length)return!1;for(t=0,s=n.length;t<s;++t)if(r=n[t],a=e[t],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function u4(n){if($l(n))return n.map(u4);if(di(n)){const e=Object.create(null),t=Object.keys(n),s=t.length;let r=0;for(;r<s;++r)e[t[r]]=u4(n[t[r]]);return e}return n}function Xge(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function ict(n,e,t,s){if(!Xge(n))return;const r=e[n],a=t[n];di(r)&&di(a)?oT(r,a,s):e[n]=u4(a)}function oT(n,e,t){const s=$l(e)?e:[e],r=s.length;if(!di(n))return n;t=t||{};const a=t.merger||ict;let o;for(let l=0;l<r;++l){if(o=s[l],!di(o))continue;const c=Object.keys(o);for(let u=0,f=c.length;u<f;++u)a(c[u],n,o,t)}return n}function wM(n,e){return oT(n,e,{merger:act})}function act(n,e,t){if(!Xge(n))return;const s=e[n],r=t[n];di(s)&&di(r)?wM(s,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=u4(r))}const _Z={"":n=>n,x:n=>n.x,y:n=>n.y};function oct(n){const e=n.split("."),t=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(t.push(s),s="");return t}function lct(n){const e=oct(n);return t=>{for(const s of e){if(s==="")break;t=t&&t[s]}return t}}function $b(n,e){return(_Z[e]||(_Z[e]=lct(e)))(n)}function u7(n){return n.charAt(0).toUpperCase()+n.slice(1)}const lT=n=>typeof n<"u",_1=n=>typeof n=="function",xZ=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function cct(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Gi=Math.PI,Oo=2*Gi,uct=Oo+Gi,f4=Number.POSITIVE_INFINITY,fct=Gi/180,Rl=Gi/2,Cy=Gi/4,CZ=Gi*2/3,Qge=Math.log10,Em=Math.sign;function vM(n,e,t){return Math.abs(n-e)<t}function SZ(n){const e=Math.round(n);n=vM(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(Qge(n))),s=n/t;return(s<=1?1:s<=2?2:s<=5?5:10)*t}function dct(n){const e=[],t=Math.sqrt(n);let s;for(s=1;s<t;s++)n%s===0&&(e.push(s),e.push(n/s));return t===(t|0)&&e.push(t),e.sort((r,a)=>r-a).pop(),e}function hct(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function cT(n){return!hct(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function pct(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function mct(n,e,t){let s,r,a;for(s=0,r=n.length;s<r;s++)a=n[s][t],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function Eg(n){return n*(Gi/180)}function gct(n){return n*(180/Gi)}function MZ(n){if(!bh(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function Jge(n,e){const t=e.x-n.x,s=e.y-n.y,r=Math.sqrt(t*t+s*s);let a=Math.atan2(s,t);return a<-.5*Gi&&(a+=Oo),{angle:a,distance:r}}function G6(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function yct(n,e){return(n-e+uct)%Oo-Gi}function Qh(n){return(n%Oo+Oo)%Oo}function uT(n,e,t,s){const r=Qh(n),a=Qh(e),o=Qh(t),l=Qh(a-r),c=Qh(o-r),u=Qh(r-a),f=Qh(r-o);return r===a||r===o||s&&a===o||l>c&&u<f}function yu(n,e,t){return Math.max(e,Math.min(t,n))}function bct(n){return yu(n,-32768,32767)}function Z0(n,e,t,s=1e-6){return n>=Math.min(e,t)-s&&n<=Math.max(e,t)+s}function f7(n,e,t){t=t||(o=>n[o]<e);let s=n.length-1,r=0,a;for(;s-r>1;)a=r+s>>1,t(a)?r=a:s=a;return{lo:r,hi:s}}const Ky=(n,e,t,s)=>f7(n,t,s?r=>{const a=n[r][e];return a<t||a===t&&n[r+1][e]===t}:r=>n[r][e]<t),wct=(n,e,t)=>f7(n,t,s=>n[s][e]>=t);function vct(n,e,t){let s=0,r=n.length;for(;s<r&&n[s]<e;)s++;for(;r>s&&n[r-1]>t;)r--;return s>0||r<n.length?n.slice(s,r):n}const Zge=["push","pop","shift","splice","unshift"];function _ct(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Zge.forEach(t=>{const s="_onData"+u7(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...a){const o=r.apply(this,a);return n._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...a)}),o}})})}function TZ(n,e){const t=n._chartjs;if(!t)return;const s=t.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(Zge.forEach(a=>{delete n[a]}),delete n._chartjs)}function e0e(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const t0e=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function n0e(n,e){let t=[],s=!1;return function(...r){t=r,s||(s=!0,t0e.call(window,()=>{s=!1,n.apply(e,t)}))}}function xct(n,e){let t;return function(...s){return e?(clearTimeout(t),t=setTimeout(n,e,s)):n.apply(this,s),e}}const d7=n=>n==="start"?"left":n==="end"?"right":"center",uu=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Cct=(n,e,t,s)=>n===(s?"left":"right")?t:n==="center"?(e+t)/2:e;function Sct(n,e,t){const s=e.length;let r=0,a=s;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,u=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,f=o.axis,{min:d,max:h,minDefined:p,maxDefined:g}=o.getUserBounds();if(p){if(r=Math.min(Ky(c,f,d).lo,t?s:Ky(e,f,o.getPixelForValue(d)).lo),u){const b=c.slice(0,r+1).reverse().findIndex(v=>!ji(v[l.axis]));r-=Math.max(0,b)}r=yu(r,0,s-1)}if(g){let b=Math.max(Ky(c,o.axis,h,!0).hi+1,t?0:Ky(e,f,o.getPixelForValue(h),!0).hi+1);if(u){const v=c.slice(b-1).findIndex(w=>!ji(w[l.axis]));b+=Math.max(0,v)}a=yu(b,r,s)-r}else a=s-r}return{start:r,count:a}}function Mct(n){const{xScale:e,yScale:t,_scaleRanges:s}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!s)return n._scaleRanges=r,!0;const a=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==t.min||s.ymax!==t.max;return Object.assign(s,r),a}const HA=n=>n===0||n===1,kZ=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Oo/t)),EZ=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Oo/t)+1,_M={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Rl)+1,easeOutSine:n=>Math.sin(n*Rl),easeInOutSine:n=>-.5*(Math.cos(Gi*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>HA(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>HA(n)?n:kZ(n,.075,.3),easeOutElastic:n=>HA(n)?n:EZ(n,.075,.3),easeInOutElastic(n){return HA(n)?n:n<.5?.5*kZ(n*2,.1125,.45):.5+.5*EZ(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-_M.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?_M.easeInBounce(n*2)*.5:_M.easeOutBounce(n*2-1)*.5+.5};function h7(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function IZ(n){return h7(n)?n:new aT(n)}function mj(n){return h7(n)?n:new aT(n).saturate(.5).darken(.1).hexString()}const Tct=["x","y","borderWidth","radius","tension"],kct=["color","borderColor","backgroundColor"];function Ect(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:kct},numbers:{type:"number",properties:Tct}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Ict(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const AZ=new Map;function Act(n,e){e=e||{};const t=n+JSON.stringify(e);let s=AZ.get(t);return s||(s=new Intl.NumberFormat(n,e),AZ.set(t,s)),s}function p7(n,e,t){return Act(e,t).format(n)}const Lct={values(n){return $l(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const s=this.chart.options.locale;let r,a=n;if(t.length>1){const u=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),a=Nct(n,t)}const o=Qge(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),p7(n,s,c)}};function Nct(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var s0e={formatters:Lct};function Dct(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:s0e.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const jb=Object.create(null),H6=Object.create(null);function xM(n,e){if(!e)return n;const t=e.split(".");for(let s=0,r=t.length;s<r;++s){const a=t[s];n=n[a]||(n[a]=Object.create(null))}return n}function gj(n,e,t){return typeof e=="string"?oT(xM(n,e),t):oT(xM(n,""),e)}class Oct{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>mj(r.backgroundColor),this.hoverBorderColor=(s,r)=>mj(r.borderColor),this.hoverColor=(s,r)=>mj(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return gj(this,e,t)}get(e){return xM(this,e)}describe(e,t){return gj(H6,e,t)}override(e,t){return gj(jb,e,t)}route(e,t,s,r){const a=xM(this,e),o=xM(this,s),l="_"+t;Object.defineProperties(a,{[l]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],u=o[r];return di(c)?Object.assign({},u,c):_r(c,u)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var Zo=new Oct({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ect,Ict,Dct]);function Pct(n){return!n||ji(n.size)||ji(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function LZ(n,e,t,s,r){let a=e[r];return a||(a=e[r]=n.measureText(r).width,t.push(r)),a>s&&(s=a),s}function Sy(n,e,t){const s=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*s)/s+r}function NZ(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function q6(n,e,t,s){r0e(n,e,t,s,null)}function r0e(n,e,t,s,r){let a,o,l,c,u,f,d,h;const p=e.pointStyle,g=e.rotation,b=e.radius;let v=(g||0)*fct;if(p&&typeof p=="object"&&(a=p.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(t,s),n.rotate(v),n.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),n.restore();return}if(!(isNaN(b)||b<=0)){switch(n.beginPath(),p){default:r?n.ellipse(t,s,r/2,b,0,0,Oo):n.arc(t,s,b,0,Oo),n.closePath();break;case"triangle":f=r?r/2:b,n.moveTo(t+Math.sin(v)*f,s-Math.cos(v)*b),v+=CZ,n.lineTo(t+Math.sin(v)*f,s-Math.cos(v)*b),v+=CZ,n.lineTo(t+Math.sin(v)*f,s-Math.cos(v)*b),n.closePath();break;case"rectRounded":u=b*.516,c=b-u,o=Math.cos(v+Cy)*c,d=Math.cos(v+Cy)*(r?r/2-u:c),l=Math.sin(v+Cy)*c,h=Math.sin(v+Cy)*(r?r/2-u:c),n.arc(t-d,s-l,u,v-Gi,v-Rl),n.arc(t+h,s-o,u,v-Rl,v),n.arc(t+d,s+l,u,v,v+Rl),n.arc(t-h,s+o,u,v+Rl,v+Gi),n.closePath();break;case"rect":if(!g){c=Math.SQRT1_2*b,f=r?r/2:c,n.rect(t-f,s-c,2*f,2*c);break}v+=Cy;case"rectRot":d=Math.cos(v)*(r?r/2:b),o=Math.cos(v)*b,l=Math.sin(v)*b,h=Math.sin(v)*(r?r/2:b),n.moveTo(t-d,s-l),n.lineTo(t+h,s-o),n.lineTo(t+d,s+l),n.lineTo(t-h,s+o),n.closePath();break;case"crossRot":v+=Cy;case"cross":d=Math.cos(v)*(r?r/2:b),o=Math.cos(v)*b,l=Math.sin(v)*b,h=Math.sin(v)*(r?r/2:b),n.moveTo(t-d,s-l),n.lineTo(t+d,s+l),n.moveTo(t+h,s-o),n.lineTo(t-h,s+o);break;case"star":d=Math.cos(v)*(r?r/2:b),o=Math.cos(v)*b,l=Math.sin(v)*b,h=Math.sin(v)*(r?r/2:b),n.moveTo(t-d,s-l),n.lineTo(t+d,s+l),n.moveTo(t+h,s-o),n.lineTo(t-h,s+o),v+=Cy,d=Math.cos(v)*(r?r/2:b),o=Math.cos(v)*b,l=Math.sin(v)*b,h=Math.sin(v)*(r?r/2:b),n.moveTo(t-d,s-l),n.lineTo(t+d,s+l),n.moveTo(t+h,s-o),n.lineTo(t-h,s+o);break;case"line":o=r?r/2:Math.cos(v)*b,l=Math.sin(v)*b,n.moveTo(t-o,s-l),n.lineTo(t+o,s+l);break;case"dash":n.moveTo(t,s),n.lineTo(t+Math.cos(v)*(r?r/2:b),s+Math.sin(v)*b);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function fT(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function m7(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function g7(n){n.restore()}function $ct(n,e,t,s,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const a=(e.x+t.x)/2;n.lineTo(a,e.y),n.lineTo(a,t.y)}else r==="after"!=!!s?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function jct(n,e,t,s){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?t.cp2x:t.cp1x,s?t.cp2y:t.cp1y,t.x,t.y)}function Rct(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),ji(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Fct(n,e,t,s,r){if(r.strikethrough||r.underline){const a=n.measureText(s),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=t-a.actualBoundingBoxAscent,u=t+a.actualBoundingBoxDescent,f=r.strikethrough?(c+u)/2:u;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(o,f),n.lineTo(l,f),n.stroke()}}function zct(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function dT(n,e,t,s,r,a={}){const o=$l(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,u;for(n.save(),n.font=r.string,Rct(n,a),c=0;c<o.length;++c)u=o[c],a.backdrop&&zct(n,a.backdrop),l&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),ji(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(u,t,s,a.maxWidth)),n.fillText(u,t,s,a.maxWidth),Fct(n,t,s,u,a),s+=Number(r.lineHeight);n.restore()}function d4(n,e){const{x:t,y:s,w:r,h:a,radius:o}=e;n.arc(t+o.topLeft,s+o.topLeft,o.topLeft,1.5*Gi,Gi,!0),n.lineTo(t,s+a-o.bottomLeft),n.arc(t+o.bottomLeft,s+a-o.bottomLeft,o.bottomLeft,Gi,Rl,!0),n.lineTo(t+r-o.bottomRight,s+a),n.arc(t+r-o.bottomRight,s+a-o.bottomRight,o.bottomRight,Rl,0,!0),n.lineTo(t+r,s+o.topRight),n.arc(t+r-o.topRight,s+o.topRight,o.topRight,0,-Rl,!0),n.lineTo(t+o.topLeft,s)}const Bct=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Uct=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Vct(n,e){const t=(""+n).match(Bct);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const Wct=n=>+n||0;function y7(n,e){const t={},s=di(e),r=s?Object.keys(e):e,a=di(n)?s?o=>_r(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of r)t[o]=Wct(a(o));return t}function i0e(n){return y7(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Zv(n){return y7(n,["topLeft","topRight","bottomLeft","bottomRight"])}function wh(n){const e=i0e(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function bu(n,e){n=n||{},e=e||Zo.font;let t=_r(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let s=_r(n.style,e.style);s&&!(""+s).match(Uct)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:_r(n.family,e.family),lineHeight:Vct(_r(n.lineHeight,e.lineHeight),t),size:t,style:s,weight:_r(n.weight,e.weight),string:""};return r.string=Pct(r),r}function qA(n,e,t,s){let r,a,o;for(r=0,a=n.length;r<a;++r)if(o=n[r],o!==void 0&&o!==void 0)return o}function Gct(n,e,t){const{min:s,max:r}=n,a=Kge(e,(r-s)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(s,-Math.abs(a)),max:o(r,a)}}function gw(n,e){return Object.assign(Object.create(n),e)}function b7(n,e=[""],t,s,r=()=>n[0]){const a=t||n;typeof s>"u"&&(s=c0e("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:s,_getTarget:r,override:l=>b7([l,...n],e,a,s)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return o0e(l,c,()=>Zct(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return OZ(l).includes(c)},ownKeys(l){return OZ(l)},set(l,c,u){const f=l._storage||(l._storage=r());return l[c]=f[c]=u,delete l._keys,!0}})}function M2(n,e,t,s){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:a0e(n,s),setContext:a=>M2(n,a,t,s),override:a=>M2(n.override(a),e,t,s)};return new Proxy(r,{deleteProperty(a,o){return delete a[o],delete n[o],!0},get(a,o,l){return o0e(a,o,()=>qct(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(a,o,l){return n[o]=l,delete a[o],!0}})}function a0e(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:s,isScriptable:_1(t)?t:()=>t,isIndexable:_1(s)?s:()=>s}}const Hct=(n,e)=>n?n+u7(e):e,w7=(n,e)=>di(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function o0e(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const s=t();return n[e]=s,s}function qct(n,e,t){const{_proxy:s,_context:r,_subProxy:a,_descriptors:o}=n;let l=s[e];return _1(l)&&o.isScriptable(e)&&(l=Yct(e,l,n,t)),$l(l)&&l.length&&(l=Kct(e,l,n,o.isIndexable)),w7(e,l)&&(l=M2(l,r,a&&a[e],o)),l}function Yct(n,e,t,s){const{_proxy:r,_context:a,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(a,o||s);return l.delete(n),w7(n,c)&&(c=v7(r._scopes,r,n,c)),c}function Kct(n,e,t,s){const{_proxy:r,_context:a,_subProxy:o,_descriptors:l}=t;if(typeof a.index<"u"&&s(n))return e[a.index%e.length];if(di(e[0])){const c=e,u=r._scopes.filter(f=>f!==c);e=[];for(const f of c){const d=v7(u,r,n,f);e.push(M2(d,a,o&&o[n],l))}}return e}function l0e(n,e,t){return _1(n)?n(e,t):n}const Xct=(n,e)=>n===!0?e:typeof n=="string"?$b(e,n):void 0;function Qct(n,e,t,s,r){for(const a of e){const o=Xct(t,a);if(o){n.add(o);const l=l0e(o._fallback,t,r);if(typeof l<"u"&&l!==t&&l!==s)return l}else if(o===!1&&typeof s<"u"&&t!==s)return null}return!1}function v7(n,e,t,s){const r=e._rootScopes,a=l0e(e._fallback,t,s),o=[...n,...r],l=new Set;l.add(s);let c=DZ(l,o,t,a||t,s);return c===null||typeof a<"u"&&a!==t&&(c=DZ(l,o,a,c,s),c===null)?!1:b7(Array.from(l),[""],r,a,()=>Jct(e,t,s))}function DZ(n,e,t,s,r){for(;t;)t=Qct(n,e,t,s,r);return t}function Jct(n,e,t){const s=n._getTarget();e in s||(s[e]={});const r=s[e];return $l(r)&&di(t)?t:r||{}}function Zct(n,e,t,s){let r;for(const a of e)if(r=c0e(Hct(a,n),t),typeof r<"u")return w7(n,r)?v7(t,s,n,r):r}function c0e(n,e){for(const t of e){if(!t)continue;const s=t[n];if(typeof s<"u")return s}}function OZ(n){let e=n._keys;return e||(e=n._keys=eut(n._scopes)),e}function eut(n){const e=new Set;for(const t of n)for(const s of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const tut=Number.EPSILON||1e-14,T2=(n,e)=>e<n.length&&!n[e].skip&&n[e],u0e=n=>n==="x"?"y":"x";function nut(n,e,t,s){const r=n.skip?e:n,a=e,o=t.skip?e:t,l=G6(a,r),c=G6(o,a);let u=l/(l+c),f=c/(l+c);u=isNaN(u)?0:u,f=isNaN(f)?0:f;const d=s*u,h=s*f;return{previous:{x:a.x-d*(o.x-r.x),y:a.y-d*(o.y-r.y)},next:{x:a.x+h*(o.x-r.x),y:a.y+h*(o.y-r.y)}}}function sut(n,e,t){const s=n.length;let r,a,o,l,c,u=T2(n,0);for(let f=0;f<s-1;++f)if(c=u,u=T2(n,f+1),!(!c||!u)){if(vM(e[f],0,tut)){t[f]=t[f+1]=0;continue}r=t[f]/e[f],a=t[f+1]/e[f],l=Math.pow(r,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),t[f]=r*o*e[f],t[f+1]=a*o*e[f])}}function rut(n,e,t="x"){const s=u0e(t),r=n.length;let a,o,l,c=T2(n,0);for(let u=0;u<r;++u){if(o=l,l=c,c=T2(n,u+1),!l)continue;const f=l[t],d=l[s];o&&(a=(f-o[t])/3,l[`cp1${t}`]=f-a,l[`cp1${s}`]=d-a*e[u]),c&&(a=(c[t]-f)/3,l[`cp2${t}`]=f+a,l[`cp2${s}`]=d+a*e[u])}}function iut(n,e="x"){const t=u0e(e),s=n.length,r=Array(s).fill(0),a=Array(s);let o,l,c,u=T2(n,0);for(o=0;o<s;++o)if(l=c,c=u,u=T2(n,o+1),!!c){if(u){const f=u[e]-c[e];r[o]=f!==0?(u[t]-c[t])/f:0}a[o]=l?u?Em(r[o-1])!==Em(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}sut(n,r,a),rut(n,a,e)}function YA(n,e,t){return Math.max(Math.min(n,t),e)}function aut(n,e){let t,s,r,a,o,l=fT(n[0],e);for(t=0,s=n.length;t<s;++t)o=a,a=l,l=t<s-1&&fT(n[t+1],e),a&&(r=n[t],o&&(r.cp1x=YA(r.cp1x,e.left,e.right),r.cp1y=YA(r.cp1y,e.top,e.bottom)),l&&(r.cp2x=YA(r.cp2x,e.left,e.right),r.cp2y=YA(r.cp2y,e.top,e.bottom)))}function out(n,e,t,s,r){let a,o,l,c;if(e.spanGaps&&(n=n.filter(u=>!u.skip)),e.cubicInterpolationMode==="monotone")iut(n,r);else{let u=s?n[n.length-1]:n[0];for(a=0,o=n.length;a<o;++a)l=n[a],c=nut(u,l,n[Math.min(a+1,o-(s?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}e.capBezierPoints&&aut(n,t)}function _7(){return typeof window<"u"&&typeof document<"u"}function x7(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function h4(n,e,t){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*e.parentNode[t])):s=n,s}const TP=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function lut(n,e){return TP(n).getPropertyValue(e)}const cut=["top","right","bottom","left"];function ob(n,e,t){const s={};t=t?"-"+t:"";for(let r=0;r<4;r++){const a=cut[r];s[a]=parseFloat(n[e+"-"+a+t])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const uut=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function fut(n,e){const t=n.touches,s=t&&t.length?t[0]:n,{offsetX:r,offsetY:a}=s;let o=!1,l,c;if(uut(r,a,n.target))l=r,c=a;else{const u=e.getBoundingClientRect();l=s.clientX-u.left,c=s.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function Ny(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:s}=e,r=TP(t),a=r.boxSizing==="border-box",o=ob(r,"padding"),l=ob(r,"border","width"),{x:c,y:u,box:f}=fut(n,t),d=o.left+(f&&l.left),h=o.top+(f&&l.top);let{width:p,height:g}=e;return a&&(p-=o.width+l.width,g-=o.height+l.height),{x:Math.round((c-d)/p*t.width/s),y:Math.round((u-h)/g*t.height/s)}}function dut(n,e,t){let s,r;if(e===void 0||t===void 0){const a=n&&x7(n);if(!a)e=n.clientWidth,t=n.clientHeight;else{const o=a.getBoundingClientRect(),l=TP(a),c=ob(l,"border","width"),u=ob(l,"padding");e=o.width-u.width-c.width,t=o.height-u.height-c.height,s=h4(l.maxWidth,a,"clientWidth"),r=h4(l.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:s||f4,maxHeight:r||f4}}const e1=n=>Math.round(n*10)/10;function hut(n,e,t,s){const r=TP(n),a=ob(r,"margin"),o=h4(r.maxWidth,n,"clientWidth")||f4,l=h4(r.maxHeight,n,"clientHeight")||f4,c=dut(n,e,t);let{width:u,height:f}=c;if(r.boxSizing==="content-box"){const h=ob(r,"border","width"),p=ob(r,"padding");u-=p.width+h.width,f-=p.height+h.height}return u=Math.max(0,u-a.width),f=Math.max(0,s?u/s:f-a.height),u=e1(Math.min(u,o,c.maxWidth)),f=e1(Math.min(f,l,c.maxHeight)),u&&!f&&(f=e1(u/2)),(e!==void 0||t!==void 0)&&s&&c.height&&f>c.height&&(f=c.height,u=e1(Math.floor(f*s))),{width:u,height:f}}function PZ(n,e,t){const s=e||1,r=e1(n.height*s),a=e1(n.width*s);n.height=e1(n.height),n.width=e1(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||o.height!==r||o.width!==a?(n.currentDevicePixelRatio=s,o.height=r,o.width=a,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const put=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};_7()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function $Z(n,e){const t=lut(n,e),s=t&&t.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Dy(n,e,t,s){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function mut(n,e,t,s){return{x:n.x+t*(e.x-n.x),y:s==="middle"?t<.5?n.y:e.y:s==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function gut(n,e,t,s){const r={x:n.cp2x,y:n.cp2y},a={x:e.cp1x,y:e.cp1y},o=Dy(n,r,t),l=Dy(r,a,t),c=Dy(a,e,t),u=Dy(o,l,t),f=Dy(l,c,t);return Dy(u,f,t)}const yut=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,s){return t-s},leftForLtr(t,s){return t-s}}},but=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function e2(n,e,t){return n?yut(e,t):but()}function f0e(n,e){let t,s;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,s=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=s)}function d0e(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function h0e(n){return n==="angle"?{between:uT,compare:yct,normalize:Qh}:{between:Z0,compare:(e,t)=>e-t,normalize:e=>e}}function jZ({start:n,end:e,count:t,loop:s,style:r}){return{start:n%t,end:e%t,loop:s&&(e-n+1)%t===0,style:r}}function wut(n,e,t){const{property:s,start:r,end:a}=t,{between:o,normalize:l}=h0e(s),c=e.length;let{start:u,end:f,loop:d}=n,h,p;if(d){for(u+=c,f+=c,h=0,p=c;h<p&&o(l(e[u%c][s]),r,a);++h)u--,f--;u%=c,f%=c}return f<u&&(f+=c),{start:u,end:f,loop:d,style:n.style}}function vut(n,e,t){if(!t)return[n];const{property:s,start:r,end:a}=t,o=e.length,{compare:l,between:c,normalize:u}=h0e(s),{start:f,end:d,loop:h,style:p}=wut(n,e,t),g=[];let b=!1,v=null,w,x,S;const C=()=>c(r,S,w)&&l(r,S)!==0,M=()=>l(a,w)===0||c(a,S,w),k=()=>b||C(),E=()=>!b||M();for(let I=f,A=f;I<=d;++I)x=e[I%o],!x.skip&&(w=u(x[s]),w!==S&&(b=c(w,r,a),v===null&&k()&&(v=l(w,r)===0?I:A),v!==null&&E()&&(g.push(jZ({start:v,end:I,loop:h,count:o,style:p})),v=null),A=I,S=w));return v!==null&&g.push(jZ({start:v,end:d,loop:h,count:o,style:p})),g}function _ut(n,e){const t=[],s=n.segments;for(let r=0;r<s.length;r++){const a=vut(s[r],n.points,e);a.length&&t.push(...a)}return t}function xut(n,e,t,s){let r=0,a=e-1;if(t&&!s)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(a+=r);a>r&&n[a%e].skip;)a--;return a%=e,{start:r,end:a}}function Cut(n,e,t,s){const r=n.length,a=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const u=n[c%r];u.skip||u.stop?l.skip||(s=!1,a.push({start:e%r,end:(c-1)%r,loop:s}),e=o=u.stop?c:null):(o=c,l.skip&&(e=c)),l=u}return o!==null&&a.push({start:e%r,end:o%r,loop:s}),a}function Sut(n,e){const t=n.points,s=n.options.spanGaps,r=t.length;if(!r)return[];const a=!!n._loop,{start:o,end:l}=xut(t,r,a,s);if(s===!0)return RZ(n,[{start:o,end:l,loop:a}],t,e);const c=l<o?l+r:l,u=!!n._fullLoop&&o===0&&l===r-1;return RZ(n,Cut(t,o,c,u),t,e)}function RZ(n,e,t,s){return!s||!s.setContext||!t?e:Mut(n,e,t,s)}function Mut(n,e,t,s){const r=n._chart.getContext(),a=FZ(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,u=[];let f=a,d=e[0].start,h=d;function p(g,b,v,w){const x=l?-1:1;if(g!==b){for(g+=c;t[g%c].skip;)g-=x;for(;t[b%c].skip;)b+=x;g%c!==b%c&&(u.push({start:g%c,end:b%c,loop:v,style:w}),f=w,d=b%c)}}for(const g of e){d=l?d:g.start;let b=t[d%c],v;for(h=d+1;h<=g.end;h++){const w=t[h%c];v=FZ(s.setContext(gw(r,{type:"segment",p0:b,p1:w,p0DataIndex:(h-1)%c,p1DataIndex:h%c,datasetIndex:o}))),Tut(v,f)&&p(d,h-1,g.loop,f),b=w,f=v}d<h-1&&p(d,h-1,g.loop,f)}return u}function FZ(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Tut(n,e){if(!e)return!1;const t=[],s=function(r,a){return h7(a)?(t.includes(a)||t.push(a),t.indexOf(a)):a};return JSON.stringify(n,s)!==JSON.stringify(e,s)}function KA(n,e,t){return n.options.clip?n[t]:e[t]}function kut(n,e){const{xScale:t,yScale:s}=n;return t&&s?{left:KA(t,e,"left"),right:KA(t,e,"right"),top:KA(s,e,"top"),bottom:KA(s,e,"bottom")}:e}function Eut(n,e){const t=e._clip;if(t.disabled)return!1;const s=kut(e,n.chartArea);return{left:t.left===!1?0:s.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:s.right+(t.right===!0?0:t.right),top:t.top===!1?0:s.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:s.bottom+(t.bottom===!0?0:t.bottom)}}class Iut{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,s,r){const a=t.listeners[r],o=t.duration;a.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(s-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=t0e.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const a=s.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(r.draw(),this._notify(r,s,e,"progress")),a.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let s=t.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,s)),s}listen(e,t,s){this._getAnims(e).listeners[t].push(s)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const s=t.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var gg=new Iut;const zZ="transparent",Aut={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const s=IZ(n||zZ),r=s.valid&&IZ(e||zZ);return r&&r.valid?r.mix(s,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Lut{constructor(e,t,s,r){const a=t[s];r=qA([e.to,r,a,e.from]);const o=qA([e.from,a,r]);this._active=!0,this._fn=e.fn||Aut[e.type||typeof o],this._easing=_M[e.easing]||_M.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,s){if(this._active){this._notify(!1);const r=this._target[this._prop],a=s-this._start,o=this._duration-a;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=qA([e.to,t,r,e.from]),this._from=qA([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,s=this._duration,r=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||t<s),!this._active){this._target[r]=l,this._notify(!0);return}if(t<0){this._target[r]=a;return}c=t/s%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,s)=>{e.push({res:t,rej:s})})}_notify(e){const t=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][t]()}}class p0e{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!di(e))return;const t=Object.keys(Zo.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const a=e[r];if(!di(a))return;const o={};for(const l of t)o[l]=a[l];($l(a.properties)&&a.properties||[r]).forEach(l=>{(l===r||!s.has(l))&&s.set(l,o)})})}_animateOptions(e,t){const s=t.options,r=Dut(e,s);if(!r)return[];const a=this._createAnimations(r,s);return s.$shared&&Nut(e.options.$animations,s).then(()=>{e.options=s},()=>{}),a}_createAnimations(e,t){const s=this._properties,r=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,t));continue}const f=t[u];let d=a[u];const h=s.get(u);if(d)if(h&&d.active()){d.update(h,f,l);continue}else d.cancel();if(!h||!h.duration){e[u]=f;continue}a[u]=d=new Lut(h,e,u,f),r.push(d)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const s=this._createAnimations(e,t);if(s.length)return gg.add(this._chart,s),!0}}function Nut(n,e){const t=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const a=n[s[r]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function Dut(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function BZ(n,e){const t=n&&n.options||{},s=t.reverse,r=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:s?a:r,end:s?r:a}}function Out(n,e,t){if(t===!1)return!1;const s=BZ(n,t),r=BZ(e,t);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function Put(n){let e,t,s,r;return di(n)?(e=n.top,t=n.right,s=n.bottom,r=n.left):e=t=s=r=n,{top:e,right:t,bottom:s,left:r,disabled:n===!1}}function m0e(n,e){const t=[],s=n._getSortedDatasetMetas(e);let r,a;for(r=0,a=s.length;r<a;++r)t.push(s[r].index);return t}function UZ(n,e,t,s={}){const r=n.keys,a=s.mode==="single";let o,l,c,u;if(e===null)return;let f=!1;for(o=0,l=r.length;o<l;++o){if(c=+r[o],c===t){if(f=!0,s.all)continue;break}u=n.values[c],bh(u)&&(a||e===0||Em(e)===Em(u))&&(e+=u)}return!f&&!s.all?0:e}function $ut(n,e){const{iScale:t,vScale:s}=e,r=t.axis==="x"?"x":"y",a=s.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,u,f;for(c=0,u=o.length;c<u;++c)f=o[c],l[c]={[r]:f,[a]:n[f]};return l}function yj(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function jut(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Rut(n){const{min:e,max:t,minDefined:s,maxDefined:r}=n.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function Fut(n,e,t){const s=n[e]||(n[e]={});return s[t]||(s[t]={})}function VZ(n,e,t,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const a=n[r.index];if(t&&a>0||!t&&a<0)return r.index}return null}function WZ(n,e){const{chart:t,_cachedMeta:s}=n,r=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:l}=s,c=a.axis,u=o.axis,f=jut(a,o,s),d=e.length;let h;for(let p=0;p<d;++p){const g=e[p],{[c]:b,[u]:v}=g,w=g._stacks||(g._stacks={});h=w[u]=Fut(r,f,b),h[l]=v,h._top=VZ(h,o,!0,s.type),h._bottom=VZ(h,o,!1,s.type);const x=h._visualValues||(h._visualValues={});x[l]=v}}function bj(n,e){const t=n.scales;return Object.keys(t).filter(s=>t[s].axis===e).shift()}function zut(n,e){return gw(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function But(n,e,t){return gw(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function gS(n,e){const t=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){e=e||n._parsed;for(const r of e){const a=r._stacks;if(!a||a[s]===void 0||a[s][t]===void 0)return;delete a[s][t],a[s]._visualValues!==void 0&&a[s]._visualValues[t]!==void 0&&delete a[s]._visualValues[t]}}}const wj=n=>n==="reset"||n==="none",GZ=(n,e)=>e?n:Object.assign({},n),Uut=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:m0e(t,!0),values:null};class kP{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=yj(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&gS(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,s=this.getDataset(),r=(d,h,p,g)=>d==="x"?h:d==="r"?g:p,a=t.xAxisID=_r(s.xAxisID,bj(e,"x")),o=t.yAxisID=_r(s.yAxisID,bj(e,"y")),l=t.rAxisID=_r(s.rAxisID,bj(e,"r")),c=t.indexAxis,u=t.iAxisID=r(c,a,o,l),f=t.vAxisID=r(c,o,a,l);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(u),t.vScale=this.getScaleForId(f)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&TZ(this._data,this),e._stacked&&gS(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),s=this._data;if(di(t)){const r=this._cachedMeta;this._data=$ut(t,r)}else if(s!==t){if(s){TZ(s,this);const r=this._cachedMeta;gS(r),r._parsed=[]}t&&Object.isExtensible(t)&&_ct(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const a=t._stacked;t._stacked=yj(t.vScale,t),t.stack!==s.stack&&(r=!0,gS(t),t.stack=s.stack),this._resyncElements(e),(r||a!==t._stacked)&&(WZ(this,t._parsed),t._stacked=yj(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:s,_data:r}=this,{iScale:a,_stacked:o}=s,l=a.axis;let c=e===0&&t===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],f,d,h;if(this._parsing===!1)s._parsed=r,s._sorted=!0,h=r;else{$l(r[e])?h=this.parseArrayData(s,r,e,t):di(r[e])?h=this.parseObjectData(s,r,e,t):h=this.parsePrimitiveData(s,r,e,t);const p=()=>d[l]===null||u&&d[l]<u[l];for(f=0;f<t;++f)s._parsed[f+e]=d=h[f],c&&(p()&&(c=!1),u=d);s._sorted=c}o&&WZ(this,h)}parsePrimitiveData(e,t,s,r){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,u=a.getLabels(),f=a===o,d=new Array(r);let h,p,g;for(h=0,p=r;h<p;++h)g=h+s,d[h]={[l]:f||a.parse(u[g],g),[c]:o.parse(t[g],g)};return d}parseArrayData(e,t,s,r){const{xScale:a,yScale:o}=e,l=new Array(r);let c,u,f,d;for(c=0,u=r;c<u;++c)f=c+s,d=t[f],l[c]={x:a.parse(d[0],f),y:o.parse(d[1],f)};return l}parseObjectData(e,t,s,r){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(r);let f,d,h,p;for(f=0,d=r;f<d;++f)h=f+s,p=t[h],u[f]={x:a.parse($b(p,l),h),y:o.parse($b(p,c),h)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,s){const r=this.chart,a=this._cachedMeta,o=t[e.axis],l={keys:m0e(r,!0),values:t._stacks[e.axis]._visualValues};return UZ(l,o,a.index,{mode:s})}updateRangeFromParsed(e,t,s,r){const a=s[t.axis];let o=a===null?NaN:a;const l=r&&s._stacks[t.axis];r&&l&&(r.values=l,o=UZ(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const s=this._cachedMeta,r=s._parsed,a=s._sorted&&e===s.iScale,o=r.length,l=this._getOtherScale(e),c=Uut(t,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:f,max:d}=Rut(l);let h,p;function g(){p=r[h];const b=p[l.axis];return!bh(p[e.axis])||f>b||d<b}for(h=0;h<o&&!(!g()&&(this.updateRangeFromParsed(u,e,p,c),a));++h);if(a){for(h=o-1;h>=0;--h)if(!g()){this.updateRangeFromParsed(u,e,p,c);break}}return u}getAllParsedValues(e){const t=this._cachedMeta._parsed,s=[];let r,a,o;for(r=0,a=t.length;r<a;++r)o=t[r][e.axis],bh(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,s=t.iScale,r=t.vScale,a=this.getParsed(e);return{label:s?""+s.getLabelForValue(a[s.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Put(_r(this.options.clip,Out(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,s=this._cachedMeta,r=s.data||[],a=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||r.length-l,u=this.options.drawActiveElementsOnTop;let f;for(s.dataset&&s.dataset.draw(e,a,l,c),f=l;f<l+c;++f){const d=r[f];d.hidden||(d.active&&u?o.push(d):d.draw(e,a))}for(f=0;f<o.length;++f)o[f].draw(e,a)}getStyle(e,t){const s=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,t,s){const r=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=But(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=r.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=zut(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=s,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",s){const r=t==="active",a=this._cachedDataOpts,o=e+"-"+t,l=a[o],c=this.enableOptionSharing&&lT(s);if(l)return GZ(l,c);const u=this.chart.config,f=u.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],h=u.getOptionScopes(this.getDataset(),f),p=Object.keys(Zo.elements[e]),g=()=>this.getContext(s,r,t),b=u.resolveNamedOptions(h,p,g,d);return b.$shared&&(b.$shared=c,a[o]=Object.freeze(GZ(b,c))),b}_resolveAnimations(e,t,s){const r=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,l=a[o];if(l)return l;let c;if(r.options.animation!==!1){const f=this.chart.config,d=f.datasetAnimationScopeKeys(this._type,t),h=f.getOptionScopes(this.getDataset(),d);c=f.createResolver(h,this.getContext(e,s,t))}const u=new p0e(r,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||wj(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const s=this.resolveDataElementOptions(e,t),r=this._sharedOptions,a=this.getSharedOptions(s),o=this.includeOptions(t,a)||a!==r;return this.updateSharedOptions(a,t,s),{sharedOptions:a,includeOptions:o}}updateElement(e,t,s,r){wj(r)?Object.assign(e,s):this._resolveAnimations(t,r).update(e,s)}updateSharedOptions(e,t,s){e&&!wj(t)&&this._resolveAnimations(void 0,t).update(e,s)}_setStyle(e,t,s,r){e.active=r;const a=this.getStyle(t,r);this._resolveAnimations(t,s,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,t,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,s=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const r=s.length,a=t.length,o=Math.min(a,r);o&&this.parse(0,o),a>r?this._insertElements(r,a-r,e):a<r&&this._removeElements(a,r-a)}_insertElements(e,t,s=!0){const r=this._cachedMeta,a=r.data,o=e+t;let l;const c=u=>{for(u.length+=t,l=u.length-1;l>=o;l--)u[l]=u[l-t]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(e,t),s&&this.updateElements(a,e,t,"reset")}updateElements(e,t,s,r){}_removeElements(e,t){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,t);s._stacked&&gS(s,r)}s.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,s,r]=e;this[t](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Vut(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let s=[];for(let r=0,a=t.length;r<a;r++)s=s.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=e0e(s.sort((r,a)=>r-a))}return n._cache.$bar}function Wut(n){const e=n.iScale,t=Vut(e,n.type);let s=e._length,r,a,o,l;const c=()=>{o===32767||o===-32768||(lT(l)&&(s=Math.min(s,Math.abs(o-l)||s)),l=o)};for(r=0,a=t.length;r<a;++r)o=e.getPixelForValue(t[r]),c();for(l=void 0,r=0,a=e.ticks.length;r<a;++r)o=e.getPixelForTick(r),c();return s}function Gut(n,e,t,s){const r=t.barThickness;let a,o;return ji(r)?(a=e.min*t.categoryPercentage,o=t.barPercentage):(a=r*s,o=1),{chunk:a/s,ratio:o,start:e.pixels[n]-a/2}}function Hut(n,e,t,s){const r=e.pixels,a=r[n];let o=n>0?r[n-1]:null,l=n<r.length-1?r[n+1]:null;const c=t.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const u=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/s,ratio:t.barPercentage,start:u}}function qut(n,e,t,s){const r=t.parse(n[0],s),a=t.parse(n[1],s),o=Math.min(r,a),l=Math.max(r,a);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),e[t.axis]=u,e._custom={barStart:c,barEnd:u,start:r,end:a,min:o,max:l}}function g0e(n,e,t,s){return $l(n)?qut(n,e,t,s):e[t.axis]=t.parse(n,s),e}function HZ(n,e,t,s){const r=n.iScale,a=n.vScale,o=r.getLabels(),l=r===a,c=[];let u,f,d,h;for(u=t,f=t+s;u<f;++u)h=e[u],d={},d[r.axis]=l||r.parse(o[u],u),c.push(g0e(h,d,a,u));return c}function vj(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Yut(n,e,t){return n!==0?Em(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Kut(n){let e,t,s,r,a;return n.horizontal?(e=n.base>n.x,t="left",s="right"):(e=n.base<n.y,t="bottom",s="top"),e?(r="end",a="start"):(r="start",a="end"),{start:t,end:s,reverse:e,top:r,bottom:a}}function Xut(n,e,t,s){let r=e.borderSkipped;const a={};if(!r){n.borderSkipped=a;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:f}=Kut(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===s?r=u:(t._bottom||0)===s?r=f:(a[qZ(f,o,l,c)]=!0,r=u)),a[qZ(r,o,l,c)]=!0,n.borderSkipped=a}function qZ(n,e,t,s){return s?(n=Qut(n,e,t),n=YZ(n,t,e)):n=YZ(n,e,t),n}function Qut(n,e,t){return n===e?t:n===t?e:n}function YZ(n,e,t){return n==="start"?e:n==="end"?t:n}function Jut(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Zut extends kP{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,s,r){return HZ(e,t,s,r)}parseArrayData(e,t,s,r){return HZ(e,t,s,r)}parseObjectData(e,t,s,r){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=a.axis==="x"?l:c,f=o.axis==="x"?l:c,d=[];let h,p,g,b;for(h=s,p=s+r;h<p;++h)b=t[h],g={},g[a.axis]=a.parse($b(b,u),h),d.push(g0e($b(b,f),g,o,h));return d}updateRangeFromParsed(e,t,s,r){super.updateRangeFromParsed(e,t,s,r);const a=s._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:s,vScale:r}=t,a=this.getParsed(e),o=a._custom,l=vj(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+s.getLabelForValue(a[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,s,r){const a=r==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),f=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(t,r);for(let p=t;p<t+s;p++){const g=this.getParsed(p),b=a||ji(g[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(p),v=this._calculateBarIndexPixels(p,f),w=(g._stacks||{})[l.axis],x={horizontal:u,base:b.base,enableBorderRadius:!w||vj(g._custom)||o===w._top||o===w._bottom,x:u?b.head:v.center,y:u?v.center:b.head,height:u?v.size:Math.abs(b.size),width:u?Math.abs(b.size):v.size};h&&(x.options=d||this.resolveDataElementOptions(p,e[p].active?"active":r));const S=x.options||e[p].options;Xut(x,S,w,o),Jut(x,S,f.ratio),this.updateElement(e[p],p,x,r)}}_getStacks(e,t){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(f=>f.controller.options.grouped),a=s.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[s.axis],u=f=>{const d=f._parsed.find(p=>p[s.axis]===c),h=d&&d[f.vScale.axis];if(ji(h)||isNaN(h))return!0};for(const f of r)if(!(t!==void 0&&u(f))&&((a===!1||o.indexOf(f.stack)===-1||a===void 0&&f.stack===void 0)&&o.push(f.stack),f.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[_r(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,s){const r=this._getStacks(e,s),a=t!==void 0?r.indexOf(t):-1;return a===-1?r.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,s=t.iScale,r=[];let a,o;for(a=0,o=t.data.length;a<o;++a)r.push(s.getPixelForValue(this.getParsed(a)[s.axis],a));const l=e.barThickness;return{min:l||Wut(t),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:s,index:r},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),u=c._custom,f=vj(u);let d=c[t.axis],h=0,p=s?this.applyStack(t,c,s):d,g,b;p!==d&&(h=p-d,p=d),f&&(d=u.barStart,p=u.barEnd-u.barStart,d!==0&&Em(d)!==Em(u.barEnd)&&(h=0),h+=d);const v=!ji(a)&&!f?a:h;let w=t.getPixelForValue(v);if(this.chart.getDataVisibility(e)?g=t.getPixelForValue(h+p):g=w,b=g-w,Math.abs(b)<o){b=Yut(b,t,l)*o,d===l&&(w-=b/2);const x=t.getPixelForDecimal(0),S=t.getPixelForDecimal(1),C=Math.min(x,S),M=Math.max(x,S);w=Math.max(Math.min(w,M),C),g=w+b,s&&!f&&(c._stacks[t.axis]._visualValues[r]=t.getValueForPixel(g)-t.getValueForPixel(w))}if(w===t.getPixelForValue(l)){const x=Em(b)*t.getLineWidthForValue(l)/2;w+=x,b-=x}return{size:b,base:w,head:g,center:g+b/2}}_calculateBarIndexPixels(e,t){const s=t.scale,r=this.options,a=r.skipNull,o=_r(r.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(t.grouped){const f=a?this._getStackCount(e):t.stackCount,d=r.barThickness==="flex"?Hut(e,t,r,f*u):Gut(e,t,r,f*u),h=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(_r(h,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+p;l=d.start+d.chunk*g+d.chunk/2,c=Math.min(o,d.chunk*d.ratio)}else l=s.getPixelForValue(this.getParsed(e)[s.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,s=e.data,r=s.length;let a=0;for(;a<r;++a)this.getParsed(a)[t.axis]!==null&&!s[a].hidden&&s[a].draw(this._ctx)}}function eft(n,e,t){let s=1,r=1,a=0,o=0;if(e<Oo){const l=n,c=l+e,u=Math.cos(l),f=Math.sin(l),d=Math.cos(c),h=Math.sin(c),p=(S,C,M)=>uT(S,l,c,!0)?1:Math.max(C,C*t,M,M*t),g=(S,C,M)=>uT(S,l,c,!0)?-1:Math.min(C,C*t,M,M*t),b=p(0,u,d),v=p(Rl,f,h),w=g(Gi,u,d),x=g(Gi+Rl,f,h);s=(b-w)/2,r=(v-x)/2,a=-(b+w)/2,o=-(v+x)/2}return{ratioX:s,ratioY:r,offsetX:a,offsetY:o}}class y0e extends kP{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:s,textAlign:r,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,u)=>{const d=e.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:d.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(u),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(l||d.borderRadius),index:u}}):[]}},onClick(e,t,s){s.chart.toggleDataVisibility(t.index),s.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let a=c=>+s[c];if(di(s[e])){const{key:c="value"}=this._parsing;a=u=>+$b(s[u],c)}let o,l;for(o=e,l=e+t;o<l;++o)r._parsed[o]=a(o)}}_getRotation(){return Eg(this.options.rotation-90)}_getCircumference(){return Eg(this.options.circumference)}_getRotationExtents(){let e=Oo,t=-Oo;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,a=r._getRotation(),o=r._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:s}=t,r=this._cachedMeta,a=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-o)/2,0),c=Math.min(rct(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:f,rotation:d}=this._getRotationExtents(),{ratioX:h,ratioY:p,offsetX:g,offsetY:b}=eft(d,f,c),v=(s.width-o)/h,w=(s.height-o)/p,x=Math.max(Math.min(v,w)/2,0),S=Kge(this.options.radius,x),C=Math.max(S*c,0),M=(S-C)/this._getVisibleDatasetWeightTotal();this.offsetX=g*S,this.offsetY=b*S,r.total=this.calculateTotal(),this.outerRadius=S-M*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-M*u,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const s=this.options,r=this._cachedMeta,a=this._getCircumference();return t&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/Oo)}updateElements(e,t,s,r){const a=r==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,f=(l.left+l.right)/2,d=(l.top+l.bottom)/2,h=a&&u.animateScale,p=h?0:this.innerRadius,g=h?0:this.outerRadius,{sharedOptions:b,includeOptions:v}=this._getSharedOptions(t,r);let w=this._getRotation(),x;for(x=0;x<t;++x)w+=this._circumference(x,a);for(x=t;x<t+s;++x){const S=this._circumference(x,a),C=e[x],M={x:f+this.offsetX,y:d+this.offsetY,startAngle:w,endAngle:w+S,circumference:S,outerRadius:g,innerRadius:p};v&&(M.options=b||this.resolveDataElementOptions(x,C.active?"active":r)),w+=S,this.updateElement(C,x,M,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let s=0,r;for(r=0;r<t.length;r++){const a=e._parsed[r];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(s+=Math.abs(a))}return s}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Oo*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,s=this.chart,r=s.data.labels||[],a=p7(t._parsed[e],s.options.locale);return{label:r[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const s=this.chart;let r,a,o,l,c;if(!e){for(r=0,a=s.data.datasets.length;r<a;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,l=o.controller;break}}if(!e)return 0;for(r=0,a=e.length;r<a;++r)c=l.resolveDataElementOptions(r),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let s=0,r=e.length;s<r;++s){const a=this.resolveDataElementOptions(s);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(t+=this._getRingWeight(s));return t}_getRingWeight(e){return Math.max(_r(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class tft extends kP{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:s,data:r=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=Sct(t,r,o);this._drawStart=l,this._drawCount=c,Mct(t)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!a._decimated,s.points=r;const u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:u},e),this.updateElements(r,l,c,e)}updateElements(e,t,s,r){const a=r==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:f,includeOptions:d}=this._getSharedOptions(t,r),h=o.axis,p=l.axis,{spanGaps:g,segment:b}=this.options,v=cT(g)?g:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||a||r==="none",x=t+s,S=e.length;let C=t>0&&this.getParsed(t-1);for(let M=0;M<S;++M){const k=e[M],E=w?k:{};if(M<t||M>=x){E.skip=!0;continue}const I=this.getParsed(M),A=ji(I[p]),D=E[h]=o.getPixelForValue(I[h],M),L=E[p]=a||A?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,I,c):I[p],M);E.skip=isNaN(D)||isNaN(L)||A,E.stop=M>0&&Math.abs(I[h]-C[h])>v,b&&(E.parsed=I,E.raw=u.data[M]),d&&(E.options=f||this.resolveDataElementOptions(M,k.active?"active":r)),w||this.updateElement(k,M,E,r),C=I}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,s=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const a=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class nft extends y0e{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function My(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class C7{static override(e){Object.assign(C7.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return My()}parse(){return My()}format(){return My()}add(){return My()}diff(){return My()}startOf(){return My()}endOf(){return My()}}var sft={_date:C7};function rft(n,e,t,s){const{controller:r,data:a,_sorted:o}=n,l=r._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const u=l._reversePixels?wct:Ky;if(s){if(r._sharedOptions){const f=a[0],d=typeof f.getRange=="function"&&f.getRange(e);if(d){const h=u(a,e,t-d),p=u(a,e,t+d);return{lo:h.lo,hi:p.hi}}}}else{const f=u(a,e,t);if(c){const{vScale:d}=r._cachedMeta,{_parsed:h}=n,p=h.slice(0,f.lo+1).reverse().findIndex(b=>!ji(b[d.axis]));f.lo-=Math.max(0,p);const g=h.slice(f.hi).findIndex(b=>!ji(b[d.axis]));f.hi+=Math.max(0,g)}return f}}return{lo:0,hi:a.length-1}}function EP(n,e,t,s,r){const a=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=a.length;l<c;++l){const{index:u,data:f}=a[l],{lo:d,hi:h}=rft(a[l],e,o,r);for(let p=d;p<=h;++p){const g=f[p];g.skip||s(g,u,p)}}}function ift(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(s,r){const a=e?Math.abs(s.x-r.x):0,o=t?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function _j(n,e,t,s,r){const a=[];return!r&&!n.isPointInArea(e)||EP(n,t,e,function(l,c,u){!r&&!fT(l,n.chartArea,0)||l.inRange(e.x,e.y,s)&&a.push({element:l,datasetIndex:c,index:u})},!0),a}function aft(n,e,t,s){let r=[];function a(o,l,c){const{startAngle:u,endAngle:f}=o.getProps(["startAngle","endAngle"],s),{angle:d}=Jge(o,{x:e.x,y:e.y});uT(d,u,f)&&r.push({element:o,datasetIndex:l,index:c})}return EP(n,t,e,a),r}function oft(n,e,t,s,r,a){let o=[];const l=ift(t);let c=Number.POSITIVE_INFINITY;function u(f,d,h){const p=f.inRange(e.x,e.y,r);if(s&&!p)return;const g=f.getCenterPoint(r);if(!(!!a||n.isPointInArea(g))&&!p)return;const v=l(e,g);v<c?(o=[{element:f,datasetIndex:d,index:h}],c=v):v===c&&o.push({element:f,datasetIndex:d,index:h})}return EP(n,t,e,u),o}function xj(n,e,t,s,r,a){return!a&&!n.isPointInArea(e)?[]:t==="r"&&!s?aft(n,e,t,r):oft(n,e,t,s,r,a)}function KZ(n,e,t,s,r){const a=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return EP(n,t,e,(c,u,f)=>{c[o]&&c[o](e[t],r)&&(a.push({element:c,datasetIndex:u,index:f}),l=l||c.inRange(e.x,e.y,r))}),s&&!l?[]:a}var lft={modes:{index(n,e,t,s){const r=Ny(e,n),a=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?_j(n,r,a,s,o):xj(n,r,a,!1,s,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(u=>{const f=l[0].index,d=u.data[f];d&&!d.skip&&c.push({element:d,datasetIndex:u.index,index:f})}),c):[]},dataset(n,e,t,s){const r=Ny(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?_j(n,r,a,s,o):xj(n,r,a,!1,s,o);if(l.length>0){const c=l[0].datasetIndex,u=n.getDatasetMeta(c).data;l=[];for(let f=0;f<u.length;++f)l.push({element:u[f],datasetIndex:c,index:f})}return l},point(n,e,t,s){const r=Ny(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return _j(n,r,a,s,o)},nearest(n,e,t,s){const r=Ny(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return xj(n,r,a,t.intersect,s,o)},x(n,e,t,s){const r=Ny(e,n);return KZ(n,r,"x",t.intersect,s)},y(n,e,t,s){const r=Ny(e,n);return KZ(n,r,"y",t.intersect,s)}}};const b0e=["left","top","right","bottom"];function yS(n,e){return n.filter(t=>t.pos===e)}function XZ(n,e){return n.filter(t=>b0e.indexOf(t.pos)===-1&&t.box.axis===e)}function bS(n,e){return n.sort((t,s)=>{const r=e?s:t,a=e?t:s;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function cft(n){const e=[];let t,s,r,a,o,l;for(t=0,s=(n||[]).length;t<s;++t)r=n[t],{position:a,options:{stack:o,stackWeight:l=1}}=r,e.push({index:t,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&a+o,stackWeight:l});return e}function uft(n){const e={};for(const t of n){const{stack:s,pos:r,stackWeight:a}=t;if(!s||!b0e.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function fft(n,e){const t=uft(n),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let a,o,l;for(a=0,o=n.length;a<o;++a){l=n[a];const{fullSize:c}=l.box,u=t[l.stack],f=u&&l.stackWeight/u.weight;l.horizontal?(l.width=f?f*s:c&&e.availableWidth,l.height=r):(l.width=s,l.height=f?f*r:c&&e.availableHeight)}return t}function dft(n){const e=cft(n),t=bS(e.filter(u=>u.box.fullSize),!0),s=bS(yS(e,"left"),!0),r=bS(yS(e,"right")),a=bS(yS(e,"top"),!0),o=bS(yS(e,"bottom")),l=XZ(e,"x"),c=XZ(e,"y");return{fullSize:t,leftAndTop:s.concat(a),rightAndBottom:r.concat(c).concat(o).concat(l),chartArea:yS(e,"chartArea"),vertical:s.concat(r).concat(c),horizontal:a.concat(o).concat(l)}}function QZ(n,e,t,s){return Math.max(n[t],e[t])+Math.max(n[s],e[s])}function w0e(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function hft(n,e,t,s){const{pos:r,box:a}=t,o=n.maxPadding;if(!di(r)){t.size&&(n[r]-=t.size);const d=s[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?a.height:a.width),t.size=d.size/d.count,n[r]+=t.size}a.getPadding&&w0e(o,a.getPadding());const l=Math.max(0,e.outerWidth-QZ(o,n,"left","right")),c=Math.max(0,e.outerHeight-QZ(o,n,"top","bottom")),u=l!==n.w,f=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:u,other:f}:{same:f,other:u}}function pft(n){const e=n.maxPadding;function t(s){const r=Math.max(e[s]-n[s],0);return n[s]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function mft(n,e){const t=e.maxPadding;function s(r){const a={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return s(n?["left","right"]:["top","bottom"])}function tM(n,e,t,s){const r=[];let a,o,l,c,u,f;for(a=0,o=n.length,u=0;a<o;++a){l=n[a],c=l.box,c.update(l.width||e.w,l.height||e.h,mft(l.horizontal,e));const{same:d,other:h}=hft(e,t,l,s);u|=d&&r.length,f=f||h,c.fullSize||r.push(l)}return u&&tM(r,e,t,s)||f}function XA(n,e,t,s,r){n.top=t,n.left=e,n.right=e+s,n.bottom=t+r,n.width=s,n.height=r}function JZ(n,e,t,s){const r=t.padding;let{x:a,y:o}=e;for(const l of n){const c=l.box,u=s[l.stack]||{placed:0,weight:1},f=l.stackWeight/u.weight||1;if(l.horizontal){const d=e.w*f,h=u.size||c.height;lT(u.start)&&(o=u.start),c.fullSize?XA(c,r.left,o,t.outerWidth-r.right-r.left,h):XA(c,e.left+u.placed,o,d,h),u.start=o,u.placed+=d,o=c.bottom}else{const d=e.h*f,h=u.size||c.width;lT(u.start)&&(a=u.start),c.fullSize?XA(c,a,r.top,h,t.outerHeight-r.bottom-r.top):XA(c,a,e.top+u.placed,h,d),u.start=a,u.placed+=d,a=c.right}}e.x=a,e.y=o}var dh={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,s){if(!n)return;const r=wh(n.options.layout.padding),a=Math.max(e-r.width,0),o=Math.max(t-r.height,0),l=dft(n.boxes),c=l.vertical,u=l.horizontal;Vi(n.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const f=c.reduce((b,v)=>v.box.options&&v.box.options.display===!1?b:b+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/f,hBoxMaxHeight:o/2}),h=Object.assign({},r);w0e(h,wh(s));const p=Object.assign({maxPadding:h,w:a,h:o,x:r.left,y:r.top},r),g=fft(c.concat(u),d);tM(l.fullSize,p,d,g),tM(c,p,d,g),tM(u,p,d,g)&&tM(c,p,d,g),pft(p),JZ(l.leftAndTop,p,d,g),p.x+=p.w,p.y+=p.h,JZ(l.rightAndBottom,p,d,g),n.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Vi(l.chartArea,b=>{const v=b.box;Object.assign(v,n.chartArea),v.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class v0e{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,s){}removeEventListener(e,t,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,s,r){return t=Math.max(0,t||e.width),s=s||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):s)}}isAttached(e){return!0}updateConfig(e){}}class gft extends v0e{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const BL="$chartjs",yft={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ZZ=n=>n===null||n==="";function bft(n,e){const t=n.style,s=n.getAttribute("height"),r=n.getAttribute("width");if(n[BL]={initial:{height:s,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",ZZ(r)){const a=$Z(n,"width");a!==void 0&&(n.width=a)}if(ZZ(s))if(n.style.height==="")n.height=n.width/(e||2);else{const a=$Z(n,"height");a!==void 0&&(n.height=a)}return n}const _0e=put?{passive:!0}:!1;function wft(n,e,t){n&&n.addEventListener(e,t,_0e)}function vft(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,_0e)}function _ft(n,e){const t=yft[n.type]||n.type,{x:s,y:r}=Ny(n,e);return{type:t,chart:e,native:n,x:s!==void 0?s:null,y:r!==void 0?r:null}}function p4(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function xft(n,e,t){const s=n.canvas,r=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||p4(l.addedNodes,s),o=o&&!p4(l.removedNodes,s);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function Cft(n,e,t){const s=n.canvas,r=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||p4(l.removedNodes,s),o=o&&!p4(l.addedNodes,s);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const hT=new Map;let eee=0;function x0e(){const n=window.devicePixelRatio;n!==eee&&(eee=n,hT.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function Sft(n,e){hT.size||window.addEventListener("resize",x0e),hT.set(n,e)}function Mft(n){hT.delete(n),hT.size||window.removeEventListener("resize",x0e)}function Tft(n,e,t){const s=n.canvas,r=s&&x7(s);if(!r)return;const a=n0e((l,c)=>{const u=r.clientWidth;t(l,c),u<r.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,f=c.contentRect.height;u===0&&f===0||a(u,f)});return o.observe(r),Sft(n,a),o}function Cj(n,e,t){t&&t.disconnect(),e==="resize"&&Mft(n)}function kft(n,e,t){const s=n.canvas,r=n0e(a=>{n.ctx!==null&&t(_ft(a,n))},n);return wft(s,e,r),r}class Eft extends v0e{acquireContext(e,t){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(bft(e,t),s):null}releaseContext(e){const t=e.canvas;if(!t[BL])return!1;const s=t[BL].initial;["height","width"].forEach(a=>{const o=s[a];ji(o)?t.removeAttribute(a):t.setAttribute(a,o)});const r=s.style||{};return Object.keys(r).forEach(a=>{t.style[a]=r[a]}),t.width=t.width,delete t[BL],!0}addEventListener(e,t,s){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),o={attach:xft,detach:Cft,resize:Tft}[t]||kft;r[t]=o(e,t,s)}removeEventListener(e,t){const s=e.$proxies||(e.$proxies={}),r=s[t];if(!r)return;({attach:Cj,detach:Cj,resize:Cj}[t]||vft)(e,t,r),s[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,s,r){return hut(e,t,s,r)}isAttached(e){const t=e&&x7(e);return!!(t&&t.isConnected)}}function Ift(n){return!_7()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?gft:Eft}let e0=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}hasValue(){return cT(this.x)&&cT(this.y)}getProps(e,t){const s=this.$animations;if(!t||!s)return this;const r={};return e.forEach(a=>{r[a]=s[a]&&s[a].active()?s[a]._to:this[a]}),r}};function Aft(n,e){const t=n.options.ticks,s=Lft(n),r=Math.min(t.maxTicksLimit||s,s),a=t.major.enabled?Dft(e):[],o=a.length,l=a[0],c=a[o-1],u=[];if(o>r)return Oft(e,u,a,o/r),u;const f=Nft(a,e,r);if(o>0){let d,h;const p=o>1?Math.round((c-l)/(o-1)):null;for(QA(e,u,f,ji(p)?0:l-p,l),d=0,h=o-1;d<h;d++)QA(e,u,f,a[d],a[d+1]);return QA(e,u,f,c,ji(p)?e.length:c+p),u}return QA(e,u,f),u}function Lft(n){const e=n.options.offset,t=n._tickSize(),s=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(s,r))}function Nft(n,e,t){const s=Pft(n),r=e.length/t;if(!s)return Math.max(r,1);const a=dct(s);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>r)return c}return Math.max(r,1)}function Dft(n){const e=[];let t,s;for(t=0,s=n.length;t<s;t++)n[t].major&&e.push(t);return e}function Oft(n,e,t,s){let r=0,a=t[0],o;for(s=Math.ceil(s),o=0;o<n.length;o++)o===a&&(e.push(n[o]),r++,a=t[r*s])}function QA(n,e,t,s,r){const a=_r(s,0),o=Math.min(_r(r,n.length),n.length);let l=0,c,u,f;for(t=Math.ceil(t),r&&(c=r-s,t=c/Math.floor(c/t)),f=a;f<0;)l++,f=Math.round(a+l*t);for(u=Math.max(a,0);u<o;u++)u===f&&(e.push(n[u]),l++,f=Math.round(a+l*t))}function Pft(n){const e=n.length;let t,s;if(e<2)return!1;for(s=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==s)return!1;return s}const $ft=n=>n==="left"?"right":n==="right"?"left":n,tee=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,nee=(n,e)=>Math.min(e||n,n);function see(n,e){const t=[],s=n.length/e,r=n.length;let a=0;for(;a<r;a+=s)t.push(n[Math.floor(a)]);return t}function jft(n,e,t){const s=n.ticks.length,r=Math.min(e,s-1),a=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(r),u;if(!(t&&(s===1?u=Math.max(c-a,o-c):e===0?u=(n.getPixelForTick(1)-c)/2:u=(c-n.getPixelForTick(r-1))/2,c+=r<e?u:-u,c<a-l||c>o+l)))return c}function Rft(n,e){Vi(n,t=>{const s=t.gc,r=s.length/2;let a;if(r>e){for(a=0;a<r;++a)delete t.data[s[a]];s.splice(0,r)}})}function wS(n){return n.drawTicks?n.tickLength:0}function ree(n,e){if(!n.display)return 0;const t=bu(n.font,e),s=wh(n.padding);return($l(n.text)?n.text.length:1)*t.lineHeight+s.height}function Fft(n,e){return gw(n,{scale:e,type:"scale"})}function zft(n,e,t){return gw(n,{tick:t,index:e,type:"tick"})}function Bft(n,e,t){let s=d7(n);return(t&&e!=="right"||!t&&e==="right")&&(s=$ft(s)),s}function Uft(n,e,t,s){const{top:r,left:a,bottom:o,right:l,chart:c}=n,{chartArea:u,scales:f}=c;let d=0,h,p,g;const b=o-r,v=l-a;if(n.isHorizontal()){if(p=uu(s,a,l),di(t)){const w=Object.keys(t)[0],x=t[w];g=f[w].getPixelForValue(x)+b-e}else t==="center"?g=(u.bottom+u.top)/2+b-e:g=tee(n,t,e);h=l-a}else{if(di(t)){const w=Object.keys(t)[0],x=t[w];p=f[w].getPixelForValue(x)-v+e}else t==="center"?p=(u.left+u.right)/2-v+e:p=tee(n,t,e);g=uu(s,o,r),d=t==="left"?-Rl:Rl}return{titleX:p,titleY:g,maxWidth:h,rotation:d}}class lx extends e0{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:s,_suggestedMax:r}=this;return e=am(e,Number.POSITIVE_INFINITY),t=am(t,Number.NEGATIVE_INFINITY),s=am(s,Number.POSITIVE_INFINITY),r=am(r,Number.NEGATIVE_INFINITY),{min:am(e,s),max:am(t,r),minDefined:bh(e),maxDefined:bh(t)}}getMinMax(e){let{min:t,max:s,minDefined:r,maxDefined:a}=this.getUserBounds(),o;if(r&&a)return{min:t,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,e),r||(t=Math.min(t,o.min)),a||(s=Math.max(s,o.max));return t=a&&t>s?s:t,s=r&&t>s?t:s,{min:am(t,am(s,t)),max:am(s,am(t,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ra(this.options.beforeUpdate,[this])}update(e,t,s){const{beginAtZero:r,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Gct(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?see(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Aft(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,s;this.isHorizontal()?(t=this.left,s=this.right):(t=this.top,s=this.bottom,e=!e),this._startPixel=t,this._endPixel=s,this._reversePixels=e,this._length=s-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ra(this.options.afterUpdate,[this])}beforeSetDimensions(){Ra(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ra(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ra(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ra(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let s,r,a;for(s=0,r=e.length;s<r;s++)a=e[s],a.label=Ra(t.callback,[a.value,s,e],this)}afterTickToLabelConversion(){Ra(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ra(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,s=nee(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,a=t.maxRotation;let o=r,l,c,u;if(!this._isVisible()||!t.display||r>=a||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const f=this._getLabelSizes(),d=f.widest.width,h=f.highest.height,p=yu(this.chart.width-d,0,this.maxWidth);l=e.offset?this.maxWidth/s:p/(s-1),d+6>l&&(l=p/(s-(e.offset?.5:1)),c=this.maxHeight-wS(e.grid)-t.padding-ree(e.title,this.chart.options.font),u=Math.sqrt(d*d+h*h),o=gct(Math.min(Math.asin(yu((f.highest.height+6)/l,-1,1)),Math.asin(yu(c/u,-1,1))-Math.asin(yu(h/u,-1,1)))),o=Math.max(r,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){Ra(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ra(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:s,title:r,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=ree(r,t.options.font);if(l?(e.width=this.maxWidth,e.height=wS(a)+c):(e.height=this.maxHeight,e.width=wS(a)+c),s.display&&this.ticks.length){const{first:u,last:f,widest:d,highest:h}=this._getLabelSizes(),p=s.padding*2,g=Eg(this.labelRotation),b=Math.cos(g),v=Math.sin(g);if(l){const w=s.mirror?0:v*d.width+b*h.height;e.height=Math.min(this.maxHeight,e.height+w+p)}else{const w=s.mirror?0:b*d.width+v*h.height;e.width=Math.min(this.maxWidth,e.width+w+p)}this._calculatePadding(u,f,v,b)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,s,r){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const f=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,p=0;c?u?(h=r*e.width,p=s*t.height):(h=s*e.height,p=r*t.width):a==="start"?p=t.width:a==="end"?h=e.width:a!=="inner"&&(h=e.width/2,p=t.width/2),this.paddingLeft=Math.max((h-f+o)*this.width/(this.width-f),0),this.paddingRight=Math.max((p-d+o)*this.width/(this.width-d),0)}else{let f=t.height/2,d=e.height/2;a==="start"?(f=0,d=e.height):a==="end"&&(f=t.height,d=0),this.paddingTop=f+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ra(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,s;for(t=0,s=e.length;t<s;t++)ji(e[t].label)&&(e.splice(t,1),s--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let s=this.ticks;t<s.length&&(s=see(s,t)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,s){const{ctx:r,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(t/nee(t,s));let u=0,f=0,d,h,p,g,b,v,w,x,S,C,M;for(d=0;d<t;d+=c){if(g=e[d].label,b=this._resolveTickFontOptions(d),r.font=v=b.string,w=a[v]=a[v]||{data:{},gc:[]},x=b.lineHeight,S=C=0,!ji(g)&&!$l(g))S=LZ(r,w.data,w.gc,S,g),C=x;else if($l(g))for(h=0,p=g.length;h<p;++h)M=g[h],!ji(M)&&!$l(M)&&(S=LZ(r,w.data,w.gc,S,M),C+=x);o.push(S),l.push(C),u=Math.max(S,u),f=Math.max(C,f)}Rft(a,t);const k=o.indexOf(u),E=l.indexOf(f),I=A=>({width:o[A]||0,height:l[A]||0});return{first:I(0),last:I(t-1),widest:I(k),highest:I(E),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return bct(this._alignToPixels?Sy(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const s=t[e];return s.$context||(s.$context=zft(this.getContext(),e,s))}return this.$context||(this.$context=Fft(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Eg(this.labelRotation),s=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*s>l*r?l/s:c/r:c*r<l*s?c/s:l/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,s=this.chart,r=this.options,{grid:a,position:o,border:l}=r,c=a.offset,u=this.isHorizontal(),d=this.ticks.length+(c?1:0),h=wS(a),p=[],g=l.setContext(this.getContext()),b=g.display?g.width:0,v=b/2,w=function(q){return Sy(s,q,b)};let x,S,C,M,k,E,I,A,D,L,P,j;if(o==="top")x=w(this.bottom),E=this.bottom-h,A=x-v,L=w(e.top)+v,j=e.bottom;else if(o==="bottom")x=w(this.top),L=e.top,j=w(e.bottom)-v,E=x+v,A=this.top+h;else if(o==="left")x=w(this.right),k=this.right-h,I=x-v,D=w(e.left)+v,P=e.right;else if(o==="right")x=w(this.left),D=e.left,P=w(e.right)-v,k=x+v,I=this.left+h;else if(t==="x"){if(o==="center")x=w((e.top+e.bottom)/2+.5);else if(di(o)){const q=Object.keys(o)[0],te=o[q];x=w(this.chart.scales[q].getPixelForValue(te))}L=e.top,j=e.bottom,E=x+v,A=E+h}else if(t==="y"){if(o==="center")x=w((e.left+e.right)/2);else if(di(o)){const q=Object.keys(o)[0],te=o[q];x=w(this.chart.scales[q].getPixelForValue(te))}k=x-v,I=k-h,D=e.left,P=e.right}const G=_r(r.ticks.maxTicksLimit,d),Q=Math.max(1,Math.ceil(d/G));for(S=0;S<d;S+=Q){const q=this.getContext(S),te=a.setContext(q),Z=l.setContext(q),ne=te.lineWidth,le=te.color,H=Z.dash||[],R=Z.dashOffset,B=te.tickWidth,W=te.tickColor,se=te.tickBorderDash||[],ue=te.tickBorderDashOffset;C=jft(this,S,c),C!==void 0&&(M=Sy(s,C,ne),u?k=I=D=P=M:E=A=L=j=M,p.push({tx1:k,ty1:E,tx2:I,ty2:A,x1:D,y1:L,x2:P,y2:j,width:ne,color:le,borderDash:H,borderDashOffset:R,tickWidth:B,tickColor:W,tickBorderDash:se,tickBorderDashOffset:ue}))}return this._ticksLength=d,this._borderValue=x,p}_computeLabelItems(e){const t=this.axis,s=this.options,{position:r,ticks:a}=s,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:f,mirror:d}=a,h=wS(s.grid),p=h+f,g=d?-f:p,b=-Eg(this.labelRotation),v=[];let w,x,S,C,M,k,E,I,A,D,L,P,j="middle";if(r==="top")k=this.bottom-g,E=this._getXAxisLabelAlignment();else if(r==="bottom")k=this.top+g,E=this._getXAxisLabelAlignment();else if(r==="left"){const Q=this._getYAxisLabelAlignment(h);E=Q.textAlign,M=Q.x}else if(r==="right"){const Q=this._getYAxisLabelAlignment(h);E=Q.textAlign,M=Q.x}else if(t==="x"){if(r==="center")k=(e.top+e.bottom)/2+p;else if(di(r)){const Q=Object.keys(r)[0],q=r[Q];k=this.chart.scales[Q].getPixelForValue(q)+p}E=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")M=(e.left+e.right)/2-p;else if(di(r)){const Q=Object.keys(r)[0],q=r[Q];M=this.chart.scales[Q].getPixelForValue(q)}E=this._getYAxisLabelAlignment(h).textAlign}t==="y"&&(c==="start"?j="top":c==="end"&&(j="bottom"));const G=this._getLabelSizes();for(w=0,x=l.length;w<x;++w){S=l[w],C=S.label;const Q=a.setContext(this.getContext(w));I=this.getPixelForTick(w)+a.labelOffset,A=this._resolveTickFontOptions(w),D=A.lineHeight,L=$l(C)?C.length:1;const q=L/2,te=Q.color,Z=Q.textStrokeColor,ne=Q.textStrokeWidth;let le=E;o?(M=I,E==="inner"&&(w===x-1?le=this.options.reverse?"left":"right":w===0?le=this.options.reverse?"right":"left":le="center"),r==="top"?u==="near"||b!==0?P=-L*D+D/2:u==="center"?P=-G.highest.height/2-q*D+D:P=-G.highest.height+D/2:u==="near"||b!==0?P=D/2:u==="center"?P=G.highest.height/2-q*D:P=G.highest.height-L*D,d&&(P*=-1),b!==0&&!Q.showLabelBackdrop&&(M+=D/2*Math.sin(b))):(k=I,P=(1-L)*D/2);let H;if(Q.showLabelBackdrop){const R=wh(Q.backdropPadding),B=G.heights[w],W=G.widths[w];let se=P-R.top,ue=0-R.left;switch(j){case"middle":se-=B/2;break;case"bottom":se-=B;break}switch(E){case"center":ue-=W/2;break;case"right":ue-=W;break;case"inner":w===x-1?ue-=W:w>0&&(ue-=W/2);break}H={left:ue,top:se,width:W+R.width,height:B+R.height,color:Q.backdropColor}}v.push({label:C,font:A,textOffset:P,options:{rotation:b,color:te,strokeColor:Z,strokeWidth:ne,textAlign:le,textBaseline:j,translation:[M,k],backdrop:H}})}return v}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Eg(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:s,mirror:r,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let u,f;return t==="left"?r?(f=this.right+a,s==="near"?u="left":s==="center"?(u="center",f+=c/2):(u="right",f+=c)):(f=this.right-l,s==="near"?u="right":s==="center"?(u="center",f-=c/2):(u="left",f=this.left)):t==="right"?r?(f=this.left+a,s==="near"?u="right":s==="center"?(u="center",f-=c/2):(u="left",f-=c)):(f=this.left+l,s==="near"?u="left":s==="center"?(u="center",f+=c/2):(u="right",f=this.right)):u="right",{textAlign:u,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:s,top:r,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(s,r,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(a=>a.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,u,f)=>{!f.width||!f.color||(s.save(),s.lineWidth=f.width,s.strokeStyle=f.color,s.setLineDash(f.borderDash||[]),s.lineDashOffset=f.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(t.display)for(a=0,o=r.length;a<o;++a){const c=r[a];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:s,grid:r}}=this,a=s.setContext(this.getContext()),o=s.display?a.width:0;if(!o)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,f,d,h;this.isHorizontal()?(u=Sy(e,this.left,o)-o/2,f=Sy(e,this.right,l)+l/2,d=h=c):(d=Sy(e,this.top,o)-o/2,h=Sy(e,this.bottom,l)+l/2,u=f=c),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(u,d),t.lineTo(f,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&m7(s,r);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,u=o.label,f=o.textOffset;dT(s,u,0,f,c,l)}r&&g7(s)}drawTitle(){const{ctx:e,options:{position:t,title:s,reverse:r}}=this;if(!s.display)return;const a=bu(s.font),o=wh(s.padding),l=s.align;let c=a.lineHeight/2;t==="bottom"||t==="center"||di(t)?(c+=o.bottom,$l(s.text)&&(c+=a.lineHeight*(s.text.length-1))):c+=o.top;const{titleX:u,titleY:f,maxWidth:d,rotation:h}=Uft(this,c,t,l);dT(e,s.text,0,0,a,{color:s.color,maxWidth:d,rotation:h,textAlign:Bft(l,t,r),textBaseline:"middle",translation:[u,f]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,s=_r(e.grid&&e.grid.z,-1),r=_r(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==lx.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:s,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];l[s]===this.id&&(!e||l.type===e)&&r.push(l)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return bu(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class JA{constructor(e,t,s){this.type=e,this.scope=t,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let s;Gft(t)&&(s=this.register(t));const r=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,Vft(e,o,s),this.override&&Zo.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,s=e.id,r=this.scope;s in t&&delete t[s],r&&s in Zo[r]&&(delete Zo[r][s],this.override&&delete jb[s])}}function Vft(n,e,t){const s=oT(Object.create(null),[t?Zo.get(t):{},Zo.get(e),n.defaults]);Zo.set(e,s),n.defaultRoutes&&Wft(e,n.defaultRoutes),n.descriptors&&Zo.describe(e,n.descriptors)}function Wft(n,e){Object.keys(e).forEach(t=>{const s=t.split("."),r=s.pop(),a=[n].concat(s).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");Zo.route(a,r,c,l)})}function Gft(n){return"id"in n&&"defaults"in n}class Hft{constructor(){this.controllers=new JA(kP,"datasets",!0),this.elements=new JA(e0,"elements"),this.plugins=new JA(Object,"plugins"),this.scales=new JA(lx,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,s){[...t].forEach(r=>{const a=s||this._getRegistryForType(r);s||a.isForType(r)||a===this.plugins&&r.id?this._exec(e,a,r):Vi(r,o=>{const l=s||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,s){const r=u7(e);Ra(s["before"+r],[],s),t[e](s),Ra(s["after"+r],[],s)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const s=this._typedRegistries[t];if(s.isForType(e))return s}return this.plugins}_get(e,t,s){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var um=new Hft;class qft{constructor(){this._init=void 0}notify(e,t,s,r){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(a,e,t,s);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,s,r){r=r||{};for(const a of e){const o=a.plugin,l=o[s],c=[t,r,a.options];if(Ra(l,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){ji(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const s=e&&e.config,r=_r(s.options&&s.options.plugins,{}),a=Yft(s);return r===!1&&!t?[]:Xft(e,a,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],s=this._cache,r=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(r(t,s),e,"stop"),this._notify(r(s,t),e,"start")}}function Yft(n){const e={},t=[],s=Object.keys(um.plugins.items);for(let a=0;a<s.length;a++)t.push(um.getPlugin(s[a]));const r=n.plugins||[];for(let a=0;a<r.length;a++){const o=r[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function Kft(n,e){return!e&&n===!1?null:n===!0?{}:n}function Xft(n,{plugins:e,localIds:t},s,r){const a=[],o=n.getContext();for(const l of e){const c=l.id,u=Kft(s[c],r);u!==null&&a.push({plugin:l,options:Qft(n.config,{plugin:l,local:t[c]},u,o)})}return a}function Qft(n,{plugin:e,local:t},s,r){const a=n.pluginScopeKeys(e),o=n.getOptionScopes(s,a);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Y6(n,e){const t=Zo.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function Jft(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Zft(n,e){return n===e?"_index_":"_value_"}function iee(n){if(n==="x"||n==="y"||n==="r")return n}function edt(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function K6(n,...e){if(iee(n))return n;for(const t of e){const s=t.axis||edt(t.position)||n.length>1&&iee(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function aee(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function tdt(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(t.length)return aee(n,"x",t[0])||aee(n,"y",t[0])}return{}}function ndt(n,e){const t=jb[n.type]||{scales:{}},s=e.scales||{},r=Y6(n.type,e),a=Object.create(null);return Object.keys(s).forEach(o=>{const l=s[o];if(!di(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=K6(o,l,tdt(o,n),Zo.scales[l.type]),u=Zft(c,r),f=t.scales||{};a[o]=wM(Object.create(null),[{axis:c},l,f[c],f[u]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||Y6(l,e),f=(jb[l]||{}).scales||{};Object.keys(f).forEach(d=>{const h=Jft(d,c),p=o[h+"AxisID"]||h;a[p]=a[p]||Object.create(null),wM(a[p],[{axis:h},s[p],f[d]])})}),Object.keys(a).forEach(o=>{const l=a[o];wM(l,[Zo.scales[l.type],Zo.scale])}),a}function C0e(n){const e=n.options||(n.options={});e.plugins=_r(e.plugins,{}),e.scales=ndt(n,e)}function S0e(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function sdt(n){return n=n||{},n.data=S0e(n.data),C0e(n),n}const oee=new Map,M0e=new Set;function ZA(n,e){let t=oee.get(n);return t||(t=e(),oee.set(n,t),M0e.add(t)),t}const vS=(n,e,t)=>{const s=$b(e,t);s!==void 0&&n.add(s)};class rdt{constructor(e){this._config=sdt(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=S0e(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),C0e(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ZA(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return ZA(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return ZA(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,s=this.type;return ZA(`${s}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const s=this._scopeCache;let r=s.get(e);return(!r||t)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,t,s){const{options:r,type:a}=this,o=this._cachedScopes(e,s),l=o.get(t);if(l)return l;const c=new Set;t.forEach(f=>{e&&(c.add(e),f.forEach(d=>vS(c,e,d))),f.forEach(d=>vS(c,r,d)),f.forEach(d=>vS(c,jb[a]||{},d)),f.forEach(d=>vS(c,Zo,d)),f.forEach(d=>vS(c,H6,d))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),M0e.has(t)&&o.set(t,u),u}chartOptionScopes(){const{options:e,type:t}=this;return[e,jb[t]||{},Zo.datasets[t]||{},{type:t},Zo,H6]}resolveNamedOptions(e,t,s,r=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=lee(this._resolverCache,e,r);let c=o;if(adt(o,t)){a.$shared=!1,s=_1(s)?s():s;const u=this.createResolver(e,s,l);c=M2(o,s,u)}for(const u of t)a[u]=c[u];return a}createResolver(e,t,s=[""],r){const{resolver:a}=lee(this._resolverCache,e,s);return di(t)?M2(a,t,void 0,r):a}}function lee(n,e,t){let s=n.get(e);s||(s=new Map,n.set(e,s));const r=t.join();let a=s.get(r);return a||(a={resolver:b7(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},s.set(r,a)),a}const idt=n=>di(n)&&Object.getOwnPropertyNames(n).some(e=>_1(n[e]));function adt(n,e){const{isScriptable:t,isIndexable:s}=a0e(n);for(const r of e){const a=t(r),o=s(r),l=(o||a)&&n[r];if(a&&(_1(l)||idt(l))||o&&$l(l))return!0}return!1}var odt="4.5.1";const ldt=["top","bottom","left","right","chartArea"];function cee(n,e){return n==="top"||n==="bottom"||ldt.indexOf(n)===-1&&e==="x"}function uee(n,e){return function(t,s){return t[n]===s[n]?t[e]-s[e]:t[n]-s[n]}}function fee(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Ra(t&&t.onComplete,[n],e)}function cdt(n){const e=n.chart,t=e.options.animation;Ra(t&&t.onProgress,[n],e)}function T0e(n){return _7()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const UL={},dee=n=>{const e=T0e(n);return Object.values(UL).filter(t=>t.canvas===e).pop()};function udt(n,e,t){const s=Object.keys(n);for(const r of s){const a=+r;if(a>=e){const o=n[r];delete n[r],(t>0||a>e)&&(n[a+t]=o)}}}function fdt(n,e,t,s){return!t||n.type==="mouseout"?null:s?e:n}let IP=class{static defaults=Zo;static instances=UL;static overrides=jb;static registry=um;static version=odt;static getChart=dee;static register(...e){um.add(...e),hee()}static unregister(...e){um.remove(...e),hee()}constructor(e,t){const s=this.config=new rdt(t),r=T0e(e),a=dee(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||Ift(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,f=c&&c.width;if(this.id=sct(),this.ctx=l,this.canvas=c,this.width=f,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new qft,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=xct(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],UL[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}gg.listen(this,"complete",fee),gg.listen(this,"progress",cdt),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:s,height:r,_aspectRatio:a}=this;return ji(e)?t&&a?a:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return um}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():PZ(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return NZ(this.canvas,this.ctx),this}stop(){return gg.stop(this),this}resize(e,t){gg.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const s=this.options,r=this.canvas,a=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,a),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,PZ(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Ra(s.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Vi(t,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,s=this.scales,r=Object.keys(s).reduce((o,l)=>(o[l]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const l=t[o],c=K6(o,l),u=c==="r",f=c==="x";return{options:l,dposition:u?"chartArea":f?"bottom":"left",dtype:u?"radialLinear":f?"category":"linear"}}))),Vi(a,o=>{const l=o.options,c=l.id,u=K6(c,l),f=_r(l.type,o.dtype);(l.position===void 0||cee(l.position,u)!==cee(o.dposition))&&(l.position=o.dposition),r[c]=!0;let d=null;if(c in s&&s[c].type===f)d=s[c];else{const h=um.getScale(f);d=new h({id:c,type:f,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(l,e)}),Vi(r,(o,l)=>{o||delete s[l]}),Vi(s,o=>{dh.configure(this,o,o.options),dh.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,s=e.length;if(e.sort((r,a)=>r.index-a.index),s>t){for(let r=t;r<s;++r)this._destroyDatasetMeta(r);e.splice(t,s-t)}this._sortedMetasets=e.slice(0).sort(uee("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((s,r)=>{t.filter(a=>a===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=t.length;s<r;s++){const a=t[s];let o=this.getDatasetMeta(s);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=l,o.indexAxis=a.indexAxis||Y6(l,this.options),o.order=a.order||0,o.index=s,o.label=""+a.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const c=um.getController(l),{datasetElementType:u,dataElementType:f}=Zo.datasets[l];Object.assign(c,{dataElementType:um.getElement(f),datasetElementType:u&&um.getElement(u)}),o.controller=new c(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Vi(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const s=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,f=this.data.datasets.length;u<f;u++){const{controller:d}=this.getDatasetMeta(u),h=!r&&a.indexOf(d)===-1;d.buildOrUpdateElements(h),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||Vi(a,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(uee("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Vi(this.scales,e=>{dh.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!xZ(t,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:a}of t){const o=s==="_removeElements"?-a:a;udt(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,s=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),r=s(0);for(let a=1;a<t;a++)if(!xZ(r,s(a)))return;return Array.from(r).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;dh.update(this,this.width,this.height,e);const t=this.chartArea,s=t.width<=0||t.height<=0;this._layers=[],Vi(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,a)=>{r._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,s=this.data.datasets.length;t<s;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,s=this.data.datasets.length;t<s;++t)this._updateDataset(t,_1(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(gg.has(this)?this.attached&&!gg.running(this)&&gg.start(this):(this.draw(),fee({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,s=[];let r,a;for(r=0,a=t.length;r<a;++r){const o=t[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Eut(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&m7(t,r),e.controller.draw(),r&&g7(t),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return fT(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,s,r){const a=lft.modes[t];return typeof a=="function"?a(this,e,s,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],s=this._metasets;let r=s.filter(a=>a&&a._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=gw(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!t.hidden}setDatasetVisibility(e,t){const s=this.getDatasetMeta(e);s.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,s){const r=s?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,r);lT(t)?(a.data[t].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(a,{visible:s}),this.update(l=>l.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),gg.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),NZ(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete UL[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,s=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},r=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};Vi(this.options.events,a=>s(a,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,s=(c,u)=>{t.addEventListener(this,c,u),e[c]=u},r=(c,u)=>{e[c]&&(t.removeEventListener(this,c,u),delete e[c])},a=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",a),s("detach",o)};o=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),s("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){Vi(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Vi(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,s){const r=s?"set":"remove";let a,o,l,c;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],s=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!c4(s,t)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,t))}notifyPlugins(e,t,s){return this._plugins.notify(this,e,t,s)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,s){const r=this.options.hover,a=(c,u)=>c.filter(f=>!u.some(d=>f.datasetIndex===d.datasetIndex&&f.index===d.index)),o=a(t,e),l=s?e:a(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(e,t){const s={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const a=this._handleEvent(e,t,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(a||s.changed)&&this.render(),this}_handleEvent(e,t,s){const{_active:r=[],options:a}=this,o=t,l=this._getActiveElements(e,r,s,o),c=cct(e),u=fdt(e,this._lastEvent,s,c);s&&(this._lastEvent=null,Ra(a.onHover,[e,l,this],this),c&&Ra(a.onClick,[e,l,this],this));const f=!c4(l,r);return(f||t)&&(this._active=l,this._updateHoverStyles(l,r,t)),this._lastEvent=u,f}_getActiveElements(e,t,s,r){if(e.type==="mouseout")return[];if(!s)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}};function hee(){return Vi(IP.instances,n=>n._plugins.invalidate())}function ddt(n,e,t){const{startAngle:s,x:r,y:a,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:u,borderJoinStyle:f}=c,d=Math.min(u/o,Qh(s-t));if(n.beginPath(),n.arc(r,a,o-u/2,s+d/2,t-d/2),l>0){const h=Math.min(u/l,Qh(s-t));n.arc(r,a,l+u/2,t-h/2,s+h/2,!0)}else{const h=Math.min(u/2,o*Qh(s-t));if(f==="round")n.arc(r,a,h,t-Gi/2,s+Gi/2,!0);else if(f==="bevel"){const p=2*h*h,g=-p*Math.cos(t+Gi/2)+r,b=-p*Math.sin(t+Gi/2)+a,v=p*Math.cos(s+Gi/2)+r,w=p*Math.sin(s+Gi/2)+a;n.lineTo(g,b),n.lineTo(v,w)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function hdt(n,e,t){const{startAngle:s,pixelMargin:r,x:a,y:o,outerRadius:l,innerRadius:c}=e;let u=r/l;n.beginPath(),n.arc(a,o,l,s-u,t+u),c>r?(u=r/c,n.arc(a,o,c,t+u,s-u,!0)):n.arc(a,o,r,t+Rl,s-Rl),n.closePath(),n.clip()}function pdt(n){return y7(n,["outerStart","outerEnd","innerStart","innerEnd"])}function mdt(n,e,t,s){const r=pdt(n.options.borderRadius),a=(t-e)/2,o=Math.min(a,s*e/2),l=c=>{const u=(t-Math.min(a,c))*s/2;return yu(c,0,Math.min(a,u))};return{outerStart:l(r.outerStart),outerEnd:l(r.outerEnd),innerStart:yu(r.innerStart,0,o),innerEnd:yu(r.innerEnd,0,o)}}function Sv(n,e,t,s){return{x:t+n*Math.cos(e),y:s+n*Math.sin(e)}}function m4(n,e,t,s,r,a){const{x:o,y:l,startAngle:c,pixelMargin:u,innerRadius:f}=e,d=Math.max(e.outerRadius+s+t-u,0),h=f>0?f+s+t+u:0;let p=0;const g=r-c;if(s){const Q=f>0?f-s:0,q=d>0?d-s:0,te=(Q+q)/2,Z=te!==0?g*te/(te+s):g;p=(g-Z)/2}const b=Math.max(.001,g*d-t/Gi)/d,v=(g-b)/2,w=c+v+p,x=r-v-p,{outerStart:S,outerEnd:C,innerStart:M,innerEnd:k}=mdt(e,h,d,x-w),E=d-S,I=d-C,A=w+S/E,D=x-C/I,L=h+M,P=h+k,j=w+M/L,G=x-k/P;if(n.beginPath(),a){const Q=(A+D)/2;if(n.arc(o,l,d,A,Q),n.arc(o,l,d,Q,D),C>0){const ne=Sv(I,D,o,l);n.arc(ne.x,ne.y,C,D,x+Rl)}const q=Sv(P,x,o,l);if(n.lineTo(q.x,q.y),k>0){const ne=Sv(P,G,o,l);n.arc(ne.x,ne.y,k,x+Rl,G+Math.PI)}const te=(x-k/h+(w+M/h))/2;if(n.arc(o,l,h,x-k/h,te,!0),n.arc(o,l,h,te,w+M/h,!0),M>0){const ne=Sv(L,j,o,l);n.arc(ne.x,ne.y,M,j+Math.PI,w-Rl)}const Z=Sv(E,w,o,l);if(n.lineTo(Z.x,Z.y),S>0){const ne=Sv(E,A,o,l);n.arc(ne.x,ne.y,S,w-Rl,A)}}else{n.moveTo(o,l);const Q=Math.cos(A)*d+o,q=Math.sin(A)*d+l;n.lineTo(Q,q);const te=Math.cos(D)*d+o,Z=Math.sin(D)*d+l;n.lineTo(te,Z)}n.closePath()}function gdt(n,e,t,s,r){const{fullCircles:a,startAngle:o,circumference:l}=e;let c=e.endAngle;if(a){m4(n,e,t,s,c,r);for(let u=0;u<a;++u)n.fill();isNaN(l)||(c=o+(l%Oo||Oo))}return m4(n,e,t,s,c,r),n.fill(),c}function ydt(n,e,t,s,r){const{fullCircles:a,startAngle:o,circumference:l,options:c}=e,{borderWidth:u,borderJoinStyle:f,borderDash:d,borderDashOffset:h,borderRadius:p}=c,g=c.borderAlign==="inner";if(!u)return;n.setLineDash(d||[]),n.lineDashOffset=h,g?(n.lineWidth=u*2,n.lineJoin=f||"round"):(n.lineWidth=u,n.lineJoin=f||"bevel");let b=e.endAngle;if(a){m4(n,e,t,s,b,r);for(let v=0;v<a;++v)n.stroke();isNaN(l)||(b=o+(l%Oo||Oo))}g&&hdt(n,e,b),c.selfJoin&&b-o>=Gi&&p===0&&f!=="miter"&&ddt(n,e,b),a||(m4(n,e,t,s,b,r),n.stroke())}class bdt extends e0{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,s){const r=this.getProps(["x","y"],s),{angle:a,distance:o}=Jge(r,{x:e,y:t}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:f,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),h=(this.options.spacing+this.options.borderWidth)/2,p=_r(d,c-l),g=uT(a,l,c)&&l!==c,b=p>=Oo||g,v=Z0(o,u+h,f+h);return b&&v}getCenterPoint(e){const{x:t,y:s,startAngle:r,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:u}=this.options,f=(r+a)/2,d=(o+l+u+c)/2;return{x:t+Math.cos(f)*d,y:s+Math.sin(f)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:s}=this,r=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=s>Oo?Math.floor(s/Oo):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*r,Math.sin(l)*r);const c=1-Math.sin(Math.min(Gi,s||0)),u=r*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,gdt(e,this,u,a,o),ydt(e,this,u,a,o),e.restore()}}function k0e(n,e,t=e){n.lineCap=_r(t.borderCapStyle,e.borderCapStyle),n.setLineDash(_r(t.borderDash,e.borderDash)),n.lineDashOffset=_r(t.borderDashOffset,e.borderDashOffset),n.lineJoin=_r(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=_r(t.borderWidth,e.borderWidth),n.strokeStyle=_r(t.borderColor,e.borderColor)}function wdt(n,e,t){n.lineTo(t.x,t.y)}function vdt(n){return n.stepped?$ct:n.tension||n.cubicInterpolationMode==="monotone"?jct:wdt}function E0e(n,e,t={}){const s=n.length,{start:r=0,end:a=s-1}=t,{start:o,end:l}=e,c=Math.max(r,o),u=Math.min(a,l),f=r<o&&a<o||r>l&&a>l;return{count:s,start:c,loop:e.loop,ilen:u<c&&!f?s+u-c:u-c}}function _dt(n,e,t,s){const{points:r,options:a}=e,{count:o,start:l,loop:c,ilen:u}=E0e(r,t,s),f=vdt(a);let{move:d=!0,reverse:h}=s||{},p,g,b;for(p=0;p<=u;++p)g=r[(l+(h?u-p:p))%o],!g.skip&&(d?(n.moveTo(g.x,g.y),d=!1):f(n,b,g,h,a.stepped),b=g);return c&&(g=r[(l+(h?u:0))%o],f(n,b,g,h,a.stepped)),!!c}function xdt(n,e,t,s){const r=e.points,{count:a,start:o,ilen:l}=E0e(r,t,s),{move:c=!0,reverse:u}=s||{};let f=0,d=0,h,p,g,b,v,w;const x=C=>(o+(u?l-C:C))%a,S=()=>{b!==v&&(n.lineTo(f,v),n.lineTo(f,b),n.lineTo(f,w))};for(c&&(p=r[x(0)],n.moveTo(p.x,p.y)),h=0;h<=l;++h){if(p=r[x(h)],p.skip)continue;const C=p.x,M=p.y,k=C|0;k===g?(M<b?b=M:M>v&&(v=M),f=(d*f+C)/++d):(S(),n.lineTo(C,M),g=k,d=0,b=v=M),w=M}S()}function X6(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?xdt:_dt}function Cdt(n){return n.stepped?mut:n.tension||n.cubicInterpolationMode==="monotone"?gut:Dy}function Sdt(n,e,t,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,s)&&r.closePath()),k0e(n,e.options),n.stroke(r)}function Mdt(n,e,t,s){const{segments:r,options:a}=e,o=X6(e);for(const l of r)k0e(n,a,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+s-1})&&n.closePath(),n.stroke()}const Tdt=typeof Path2D=="function";function kdt(n,e,t,s){Tdt&&!e.options.segment?Sdt(n,e,t,s):Mdt(n,e,t,s)}class Edt extends e0{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;out(this._points,s,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Sut(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,s=e.length;return s&&t[e[s-1].end]}interpolate(e,t){const s=this.options,r=e[t],a=this.points,o=_ut(this,{property:t,start:r,end:r});if(!o.length)return;const l=[],c=Cdt(s);let u,f;for(u=0,f=o.length;u<f;++u){const{start:d,end:h}=o[u],p=a[d],g=a[h];if(p===g){l.push(p);continue}const b=Math.abs((r-p[t])/(g[t]-p[t])),v=c(p,g,b,s.stepped);v[t]=e[t],l.push(v)}return l.length===1?l[0]:l}pathSegment(e,t,s){return X6(this)(e,this,t,s)}path(e,t,s){const r=this.segments,a=X6(this);let o=this._loop;t=t||0,s=s||this.points.length-t;for(const l of r)o&=a(e,this,l,{start:t,end:t+s-1});return!!o}draw(e,t,s,r){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),kdt(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function pee(n,e,t,s){const r=n.options,{[t]:a}=n.getProps([t],s);return Math.abs(e-a)<r.radius+r.hitRadius}class Idt extends e0{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,s){const r=this.options,{x:a,y:o}=this.getProps(["x","y"],s);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return pee(this,e,"x",t)}inYRange(e,t){return pee(this,e,"y",t)}getCenterPoint(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const s=t&&e.borderWidth||0;return(t+s)*2}draw(e,t){const s=this.options;this.skip||s.radius<.1||!fT(this,t,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,q6(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function I0e(n,e){const{x:t,y:s,base:r,width:a,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,u,f,d;return n.horizontal?(d=o/2,l=Math.min(t,r),c=Math.max(t,r),u=s-d,f=s+d):(d=a/2,l=t-d,c=t+d,u=Math.min(s,r),f=Math.max(s,r)),{left:l,top:u,right:c,bottom:f}}function t1(n,e,t,s){return n?0:yu(e,t,s)}function Adt(n,e,t){const s=n.options.borderWidth,r=n.borderSkipped,a=i0e(s);return{t:t1(r.top,a.top,0,t),r:t1(r.right,a.right,0,e),b:t1(r.bottom,a.bottom,0,t),l:t1(r.left,a.left,0,e)}}function Ldt(n,e,t){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,a=Zv(r),o=Math.min(e,t),l=n.borderSkipped,c=s||di(r);return{topLeft:t1(!c||l.top||l.left,a.topLeft,0,o),topRight:t1(!c||l.top||l.right,a.topRight,0,o),bottomLeft:t1(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:t1(!c||l.bottom||l.right,a.bottomRight,0,o)}}function Ndt(n){const e=I0e(n),t=e.right-e.left,s=e.bottom-e.top,r=Adt(n,t/2,s/2),a=Ldt(n,t/2,s/2);return{outer:{x:e.left,y:e.top,w:t,h:s,radius:a},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function Sj(n,e,t,s){const r=e===null,a=t===null,l=n&&!(r&&a)&&I0e(n,s);return l&&(r||Z0(e,l.left,l.right))&&(a||Z0(t,l.top,l.bottom))}function Ddt(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Odt(n,e){n.rect(e.x,e.y,e.w,e.h)}function Mj(n,e,t={}){const s=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,a=(n.x+n.w!==t.x+t.w?e:0)-s,o=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+s,y:n.y+r,w:n.w+a,h:n.h+o,radius:n.radius}}class Pdt extends e0{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:s,backgroundColor:r}}=this,{inner:a,outer:o}=Ndt(this),l=Ddt(o.radius)?d4:Odt;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,Mj(o,t,a)),e.clip(),l(e,Mj(a,-t,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),l(e,Mj(a,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,s){return Sj(this,e,t,s)}inXRange(e,t){return Sj(this,e,null,t)}inYRange(e,t){return Sj(this,null,e,t)}getCenterPoint(e){const{x:t,y:s,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+r)/2:t,y:a?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const mee=(n,e)=>{let{boxHeight:t=e,boxWidth:s=e}=n;return n.usePointStyle&&(t=Math.min(t,e),s=n.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:t,itemHeight:Math.max(e,t)}},$dt=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class gee extends e0{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,s){this.maxWidth=e,this.maxHeight=t,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Ra(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(s=>e.filter(s,this.chart.data))),e.sort&&(t=t.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=bu(s.font),a=r.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=mee(s,a);let u,f;t.font=r.string,this.isHorizontal()?(u=this.maxWidth,f=this._fitRows(o,a,l,c)+10):(f=this.maxHeight,u=this._fitCols(o,r,l,c)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(f,e.maxHeight||this.maxHeight)}_fitRows(e,t,s,r){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],f=r+l;let d=e;a.textAlign="left",a.textBaseline="middle";let h=-1,p=-f;return this.legendItems.forEach((g,b)=>{const v=s+t/2+a.measureText(g.text).width;(b===0||u[u.length-1]+v+2*l>o)&&(d+=f,u[u.length-(b>0?0:1)]=0,p+=f,h++),c[b]={left:0,top:p,row:h,width:v,height:r},u[u.length-1]+=v+l}),d}_fitCols(e,t,s,r){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],f=o-e;let d=l,h=0,p=0,g=0,b=0;return this.legendItems.forEach((v,w)=>{const{itemWidth:x,itemHeight:S}=jdt(s,t,a,v,r);w>0&&p+S+2*l>f&&(d+=h+l,u.push({width:h,height:p}),g+=h+l,b++,h=p=0),c[w]={left:g,top:p,col:b,width:x,height:S},h=Math.max(h,x),p+=S+l}),d+=h,u.push({width:h,height:p}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:s,labels:{padding:r},rtl:a}}=this,o=e2(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=uu(s,this.left+r,this.right-this.lineWidths[l]);for(const u of t)l!==u.row&&(l=u.row,c=uu(s,this.left+r,this.right-this.lineWidths[l])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+r}else{let l=0,c=uu(s,this.top+e+r,this.bottom-this.columnSizes[l].height);for(const u of t)u.col!==l&&(l=u.col,c=uu(s,this.top+e+r,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;m7(e,this),this._draw(),g7(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:s,ctx:r}=this,{align:a,labels:o}=e,l=Zo.color,c=e2(e.rtl,this.left,this.width),u=bu(o.font),{padding:f}=o,d=u.size,h=d/2;let p;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:g,boxHeight:b,itemHeight:v}=mee(o,d),w=function(k,E,I){if(isNaN(g)||g<=0||isNaN(b)||b<0)return;r.save();const A=_r(I.lineWidth,1);if(r.fillStyle=_r(I.fillStyle,l),r.lineCap=_r(I.lineCap,"butt"),r.lineDashOffset=_r(I.lineDashOffset,0),r.lineJoin=_r(I.lineJoin,"miter"),r.lineWidth=A,r.strokeStyle=_r(I.strokeStyle,l),r.setLineDash(_r(I.lineDash,[])),o.usePointStyle){const D={radius:b*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:A},L=c.xPlus(k,g/2),P=E+h;r0e(r,D,L,P,o.pointStyleWidth&&g)}else{const D=E+Math.max((d-b)/2,0),L=c.leftForLtr(k,g),P=Zv(I.borderRadius);r.beginPath(),Object.values(P).some(j=>j!==0)?d4(r,{x:L,y:D,w:g,h:b,radius:P}):r.rect(L,D,g,b),r.fill(),A!==0&&r.stroke()}r.restore()},x=function(k,E,I){dT(r,I.text,k,E+v/2,u,{strikethrough:I.hidden,textAlign:c.textAlign(I.textAlign)})},S=this.isHorizontal(),C=this._computeTitleHeight();S?p={x:uu(a,this.left+f,this.right-s[0]),y:this.top+f+C,line:0}:p={x:this.left+f,y:uu(a,this.top+C+f,this.bottom-t[0].height),line:0},f0e(this.ctx,e.textDirection);const M=v+f;this.legendItems.forEach((k,E)=>{r.strokeStyle=k.fontColor,r.fillStyle=k.fontColor;const I=r.measureText(k.text).width,A=c.textAlign(k.textAlign||(k.textAlign=o.textAlign)),D=g+h+I;let L=p.x,P=p.y;c.setWidth(this.width),S?E>0&&L+D+f>this.right&&(P=p.y+=M,p.line++,L=p.x=uu(a,this.left+f,this.right-s[p.line])):E>0&&P+M>this.bottom&&(L=p.x=L+t[p.line].width+f,p.line++,P=p.y=uu(a,this.top+C+f,this.bottom-t[p.line].height));const j=c.x(L);if(w(j,P,k),L=Cct(A,L+g+h,S?L+D:this.right,e.rtl),x(c.x(L),P,k),S)p.x+=D+f;else if(typeof k.text!="string"){const G=u.lineHeight;p.y+=A0e(k,G)+f}else p.y+=M}),d0e(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,s=bu(t.font),r=wh(t.padding);if(!t.display)return;const a=e2(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=s.size/2,u=r.top+c;let f,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),f=this.top+u,d=uu(e.align,d,this.right-h);else{const g=this.columnSizes.reduce((b,v)=>Math.max(b,v.height),0);f=u+uu(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const p=uu(l,d,d+h);o.textAlign=a.textAlign(d7(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=s.string,dT(o,t.text,p,f,s)}_computeTitleHeight(){const e=this.options.title,t=bu(e.font),s=wh(e.padding);return e.display?t.lineHeight+s.height:0}_getLegendItemAt(e,t){let s,r,a;if(Z0(e,this.left,this.right)&&Z0(t,this.top,this.bottom)){for(a=this.legendHitBoxes,s=0;s<a.length;++s)if(r=a[s],Z0(e,r.left,r.left+r.width)&&Z0(t,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const t=this.options;if(!zdt(e.type,t))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,a=$dt(r,s);r&&!a&&Ra(t.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!a&&Ra(t.onHover,[e,s,this],this)}else s&&Ra(t.onClick,[e,s,this],this)}}function jdt(n,e,t,s,r){const a=Rdt(s,n,e,t),o=Fdt(r,s,e.lineHeight);return{itemWidth:a,itemHeight:o}}function Rdt(n,e,t,s){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+s.measureText(r).width}function Fdt(n,e,t){let s=n;return typeof e.text!="string"&&(s=A0e(e,t)),s}function A0e(n,e){const t=n.text?n.text.length:0;return e*t}function zdt(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Bdt={id:"legend",_element:gee,start(n,e,t){const s=n.legend=new gee({ctx:n.ctx,options:t,chart:n});dh.configure(n,s,t),dh.addBox(n,s)},stop(n){dh.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const s=n.legend;dh.configure(n,s,t),s.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const s=e.datasetIndex,r=t.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:s,textAlign:r,color:a,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(t?0:void 0),f=wh(u.borderWidth);return{text:e[c.index].label,fillStyle:u.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(f.width+f.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class L0e extends e0{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=$l(s.text)?s.text.length:1;this._padding=wh(s.padding);const a=r*bu(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:s,bottom:r,right:a,options:o}=this,l=o.align;let c=0,u,f,d;return this.isHorizontal()?(f=uu(l,s,a),d=t+e,u=a-s):(o.position==="left"?(f=s+e,d=uu(l,r,t),c=Gi*-.5):(f=a-e,d=uu(l,t,r),c=Gi*.5),u=r-t),{titleX:f,titleY:d,maxWidth:u,rotation:c}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const s=bu(t.font),a=s.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(a);dT(e,t.text,0,0,s,{color:t.color,maxWidth:c,rotation:u,textAlign:d7(t.align),textBaseline:"middle",translation:[o,l]})}}function Udt(n,e){const t=new L0e({ctx:n.ctx,options:e,chart:n});dh.configure(n,t,e),dh.addBox(n,t),n.titleBlock=t}var Vdt={id:"title",_element:L0e,start(n,e,t){Udt(n,t)},stop(n){const e=n.titleBlock;dh.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const s=n.titleBlock;dh.configure(n,s,t),s.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const nM={average(n){if(!n.length)return!1;let e,t,s=new Set,r=0,a=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),r+=c.y,++a}}return a===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:r/a}},nearest(n,e){if(!n.length)return!1;let t=e.x,s=e.y,r=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=n.length;a<o;++a){const c=n[a].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),f=G6(e,u);f<r&&(r=f,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,s=c.y}return{x:t,y:s}}};function cm(n,e){return e&&($l(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function yg(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function Wdt(n,e){const{element:t,datasetIndex:s,index:r}=e,a=n.getDatasetMeta(s).controller,{label:o,value:l}=a.getLabelAndValue(r);return{chart:n,label:o,parsed:a.getParsed(r),raw:n.data.datasets[s].data[r],formattedValue:l,dataset:a.getDataset(),dataIndex:r,datasetIndex:s,element:t}}function yee(n,e){const t=n.chart.ctx,{body:s,footer:r,title:a}=n,{boxWidth:o,boxHeight:l}=e,c=bu(e.bodyFont),u=bu(e.titleFont),f=bu(e.footerFont),d=a.length,h=r.length,p=s.length,g=wh(e.padding);let b=g.height,v=0,w=s.reduce((C,M)=>C+M.before.length+M.lines.length+M.after.length,0);if(w+=n.beforeBody.length+n.afterBody.length,d&&(b+=d*u.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),w){const C=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;b+=p*C+(w-p)*c.lineHeight+(w-1)*e.bodySpacing}h&&(b+=e.footerMarginTop+h*f.lineHeight+(h-1)*e.footerSpacing);let x=0;const S=function(C){v=Math.max(v,t.measureText(C).width+x)};return t.save(),t.font=u.string,Vi(n.title,S),t.font=c.string,Vi(n.beforeBody.concat(n.afterBody),S),x=e.displayColors?o+2+e.boxPadding:0,Vi(s,C=>{Vi(C.before,S),Vi(C.lines,S),Vi(C.after,S)}),x=0,t.font=f.string,Vi(n.footer,S),t.restore(),v+=g.width,{width:v,height:b}}function Gdt(n,e){const{y:t,height:s}=e;return t<s/2?"top":t>n.height-s/2?"bottom":"center"}function Hdt(n,e,t,s){const{x:r,width:a}=s,o=t.caretSize+t.caretPadding;if(n==="left"&&r+a+o>e.width||n==="right"&&r-a-o<0)return!0}function qdt(n,e,t,s){const{x:r,width:a}=t,{width:o,chartArea:{left:l,right:c}}=n;let u="center";return s==="center"?u=r<=(l+c)/2?"left":"right":r<=a/2?u="left":r>=o-a/2&&(u="right"),Hdt(u,n,e,t)&&(u="center"),u}function bee(n,e,t){const s=t.yAlign||e.yAlign||Gdt(n,t);return{xAlign:t.xAlign||e.xAlign||qdt(n,e,t,s),yAlign:s}}function Ydt(n,e){let{x:t,width:s}=n;return e==="right"?t-=s:e==="center"&&(t-=s/2),t}function Kdt(n,e,t){let{y:s,height:r}=n;return e==="top"?s+=t:e==="bottom"?s-=r+t:s-=r/2,s}function wee(n,e,t,s){const{caretSize:r,caretPadding:a,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,u=r+a,{topLeft:f,topRight:d,bottomLeft:h,bottomRight:p}=Zv(o);let g=Ydt(e,l);const b=Kdt(e,c,u);return c==="center"?l==="left"?g+=u:l==="right"&&(g-=u):l==="left"?g-=Math.max(f,h)+r:l==="right"&&(g+=Math.max(d,p)+r),{x:yu(g,0,s.width-e.width),y:yu(b,0,s.height-e.height)}}function eL(n,e,t){const s=wh(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-s.right:n.x+s.left}function vee(n){return cm([],yg(n))}function Xdt(n,e,t){return gw(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function _ee(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const N0e={beforeTitle:pg,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,s=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return t[e.dataIndex]}return""},afterTitle:pg,beforeBody:pg,beforeLabel:pg,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return ji(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:pg,afterBody:pg,beforeFooter:pg,footer:pg,afterFooter:pg};function bf(n,e,t,s){const r=n[e].call(t,s);return typeof r>"u"?N0e[e].call(t,s):r}class xee extends e0{static positioners=nM;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&t.options.animation&&s.animations,a=new p0e(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=Xdt(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:s}=t,r=bf(s,"beforeTitle",this,e),a=bf(s,"title",this,e),o=bf(s,"afterTitle",this,e);let l=[];return l=cm(l,yg(r)),l=cm(l,yg(a)),l=cm(l,yg(o)),l}getBeforeBody(e,t){return vee(bf(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:s}=t,r=[];return Vi(e,a=>{const o={before:[],lines:[],after:[]},l=_ee(s,a);cm(o.before,yg(bf(l,"beforeLabel",this,a))),cm(o.lines,bf(l,"label",this,a)),cm(o.after,yg(bf(l,"afterLabel",this,a))),r.push(o)}),r}getAfterBody(e,t){return vee(bf(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:s}=t,r=bf(s,"beforeFooter",this,e),a=bf(s,"footer",this,e),o=bf(s,"afterFooter",this,e);let l=[];return l=cm(l,yg(r)),l=cm(l,yg(a)),l=cm(l,yg(o)),l}_createItems(e){const t=this._active,s=this.chart.data,r=[],a=[],o=[];let l=[],c,u;for(c=0,u=t.length;c<u;++c)l.push(Wdt(this.chart,t[c]));return e.filter&&(l=l.filter((f,d,h)=>e.filter(f,d,h,s))),e.itemSort&&(l=l.sort((f,d)=>e.itemSort(f,d,s))),Vi(l,f=>{const d=_ee(e.callbacks,f);r.push(bf(d,"labelColor",this,f)),a.push(bf(d,"labelPointStyle",this,f)),o.push(bf(d,"labelTextColor",this,f))}),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const s=this.options.setContext(this.getContext()),r=this._active;let a,o=[];if(!r.length)this.opacity!==0&&(a={opacity:0});else{const l=nM[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const c=this._size=yee(this,s),u=Object.assign({},l,c),f=bee(this.chart,s,u),d=wee(s,u,f,this.chart);this.xAlign=f.xAlign,this.yAlign=f.yAlign,a={opacity:1,x:d.x,y:d.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,s,r){const a=this.getCaretPosition(e,s,r);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,s){const{xAlign:r,yAlign:a}=this,{caretSize:o,cornerRadius:l}=s,{topLeft:c,topRight:u,bottomLeft:f,bottomRight:d}=Zv(l),{x:h,y:p}=e,{width:g,height:b}=t;let v,w,x,S,C,M;return a==="center"?(C=p+b/2,r==="left"?(v=h,w=v-o,S=C+o,M=C-o):(v=h+g,w=v+o,S=C-o,M=C+o),x=v):(r==="left"?w=h+Math.max(c,f)+o:r==="right"?w=h+g-Math.max(u,d)-o:w=this.caretX,a==="top"?(S=p,C=S-o,v=w-o,x=w+o):(S=p+b,C=S+o,v=w+o,x=w-o),M=S),{x1:v,x2:w,x3:x,y1:S,y2:C,y3:M}}drawTitle(e,t,s){const r=this.title,a=r.length;let o,l,c;if(a){const u=e2(s.rtl,this.x,this.width);for(e.x=eL(this,s.titleAlign,s),t.textAlign=u.textAlign(s.titleAlign),t.textBaseline="middle",o=bu(s.titleFont),l=s.titleSpacing,t.fillStyle=s.titleColor,t.font=o.string,c=0;c<a;++c)t.fillText(r[c],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,t,s,r,a){const o=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:u}=a,f=bu(a.bodyFont),d=eL(this,"left",a),h=r.x(d),p=c<f.lineHeight?(f.lineHeight-c)/2:0,g=t.y+p;if(a.usePointStyle){const b={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},v=r.leftForLtr(h,u)+u/2,w=g+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,q6(e,b,v,w),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,q6(e,b,v,w)}else{e.lineWidth=di(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const b=r.leftForLtr(h,u),v=r.leftForLtr(r.xPlus(h,1),u-2),w=Zv(o.borderRadius);Object.values(w).some(x=>x!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,d4(e,{x:b,y:g,w:u,h:c,radius:w}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),d4(e,{x:v,y:g+1,w:u-2,h:c-2,radius:w}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(b,g,u,c),e.strokeRect(b,g,u,c),e.fillStyle=o.backgroundColor,e.fillRect(v,g+1,u-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,t,s){const{body:r}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:f}=s,d=bu(s.bodyFont);let h=d.lineHeight,p=0;const g=e2(s.rtl,this.x,this.width),b=function(I){t.fillText(I,g.x(e.x+p),e.y+h/2),e.y+=h+a},v=g.textAlign(o);let w,x,S,C,M,k,E;for(t.textAlign=o,t.textBaseline="middle",t.font=d.string,e.x=eL(this,v,s),t.fillStyle=s.bodyColor,Vi(this.beforeBody,b),p=l&&v!=="right"?o==="center"?u/2+f:u+2+f:0,C=0,k=r.length;C<k;++C){for(w=r[C],x=this.labelTextColors[C],t.fillStyle=x,Vi(w.before,b),S=w.lines,l&&S.length&&(this._drawColorBox(t,e,C,g,s),h=Math.max(d.lineHeight,c)),M=0,E=S.length;M<E;++M)b(S[M]),h=d.lineHeight;Vi(w.after,b)}p=0,h=d.lineHeight,Vi(this.afterBody,b),e.y-=a}drawFooter(e,t,s){const r=this.footer,a=r.length;let o,l;if(a){const c=e2(s.rtl,this.x,this.width);for(e.x=eL(this,s.footerAlign,s),e.y+=s.footerMarginTop,t.textAlign=c.textAlign(s.footerAlign),t.textBaseline="middle",o=bu(s.footerFont),t.fillStyle=s.footerColor,t.font=o.string,l=0;l<a;++l)t.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,t,s,r){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:u,height:f}=s,{topLeft:d,topRight:h,bottomLeft:p,bottomRight:g}=Zv(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(l+d,c),o==="top"&&this.drawCaret(e,t,s,r),t.lineTo(l+u-h,c),t.quadraticCurveTo(l+u,c,l+u,c+h),o==="center"&&a==="right"&&this.drawCaret(e,t,s,r),t.lineTo(l+u,c+f-g),t.quadraticCurveTo(l+u,c+f,l+u-g,c+f),o==="bottom"&&this.drawCaret(e,t,s,r),t.lineTo(l+p,c+f),t.quadraticCurveTo(l,c+f,l,c+f-p),o==="center"&&a==="left"&&this.drawCaret(e,t,s,r),t.lineTo(l,c+d),t.quadraticCurveTo(l,c,l+d,c),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,s=this.$animations,r=s&&s.x,a=s&&s.y;if(r||a){const o=nM[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=yee(this,e),c=Object.assign({},o,this._size),u=bee(t,e,c),f=wee(e,c,u,t);(r._to!==f.x||a._to!==f.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,f))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=wh(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=s,this.drawBackground(a,e,r,t),f0e(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),d0e(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const s=this._active,r=e.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),a=!c4(s,r),o=this._positionChanged(r,t);(a||o)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,s=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,s),l=this._positionChanged(o,e),c=t||!c4(o,a)||l;return c&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,s,r){const a=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,s);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:s,caretY:r,options:a}=this,o=nM[a.position].call(this,e,t);return o!==!1&&(s!==o.x||r!==o.y)}}var Qdt={id:"tooltip",_element:xee,positioners:nM,afterInit(n,e,t){t&&(n.tooltip=new xee({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:N0e},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Jdt=(n,e,t,s)=>(typeof e=="string"?(t=n.push(e)-1,s.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function Zdt(n,e,t,s){const r=n.indexOf(e);if(r===-1)return Jdt(n,e,t,s);const a=n.lastIndexOf(e);return r!==a?t:r}const eht=(n,e)=>n===null?null:yu(Math.round(n),0,e);function Cee(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class tht extends lx{static id="category";static defaults={ticks:{callback:Cee}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const s=this.getLabels();for(const{index:r,label:a}of t)s[r]===a&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(ji(e))return null;const s=this.getLabels();return t=isFinite(t)&&s[t]===e?t:Zdt(s,e,_r(t,e),this._addedLabels),eht(t,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),t||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,t=this.max,s=this.options.offset,r=[];let a=this.getLabels();a=e===0&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=t;o++)r.push({value:o});return r}getLabelForValue(e){return Cee.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function nht(n,e){const t=[],{bounds:r,step:a,min:o,max:l,precision:c,count:u,maxTicks:f,maxDigits:d,includeBounds:h}=n,p=a||1,g=f-1,{min:b,max:v}=e,w=!ji(o),x=!ji(l),S=!ji(u),C=(v-b)/(d+1);let M=SZ((v-b)/g/p)*p,k,E,I,A;if(M<1e-14&&!w&&!x)return[{value:b},{value:v}];A=Math.ceil(v/M)-Math.floor(b/M),A>g&&(M=SZ(A*M/g/p)*p),ji(c)||(k=Math.pow(10,c),M=Math.ceil(M*k)/k),r==="ticks"?(E=Math.floor(b/M)*M,I=Math.ceil(v/M)*M):(E=b,I=v),w&&x&&a&&pct((l-o)/a,M/1e3)?(A=Math.round(Math.min((l-o)/M,f)),M=(l-o)/A,E=o,I=l):S?(E=w?o:E,I=x?l:I,A=u-1,M=(I-E)/A):(A=(I-E)/M,vM(A,Math.round(A),M/1e3)?A=Math.round(A):A=Math.ceil(A));const D=Math.max(MZ(M),MZ(E));k=Math.pow(10,ji(c)?D:c),E=Math.round(E*k)/k,I=Math.round(I*k)/k;let L=0;for(w&&(h&&E!==o?(t.push({value:o}),E<o&&L++,vM(Math.round((E+L*M)*k)/k,o,See(o,C,n))&&L++):E<o&&L++);L<A;++L){const P=Math.round((E+L*M)*k)/k;if(x&&P>l)break;t.push({value:P})}return x&&h&&I!==l?t.length&&vM(t[t.length-1].value,l,See(l,C,n))?t[t.length-1].value=l:t.push({value:l}):(!x||I===l)&&t.push({value:I}),t}function See(n,e,{horizontal:t,minRotation:s}){const r=Eg(s),a=(t?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+n).length;return Math.min(e/a,o)}class sht extends lx{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return ji(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:r,max:a}=this;const o=c=>r=t?r:c,l=c=>a=s?a:c;if(e){const c=Em(r),u=Em(a);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(r===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(r-c)}this.min=r,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},a=this._range||this,o=nht(r,a);return e.bounds==="ticks"&&mct(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-t)/Math.max(e.length-1,1)/2;t-=r,s+=r}this._startValue=t,this._endValue=s,this._valueRange=s-t}getLabelForValue(e){return p7(e,this.chart.options.locale,this.options.ticks.format)}}class rht extends sht{static id="linear";static defaults={ticks:{callback:s0e.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=bh(e)?e:0,this.max=bh(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,s=Eg(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const AP={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},xf=Object.keys(AP);function Mee(n,e){return n-e}function Tee(n,e){if(ji(e))return null;const t=n._adapter,{parser:s,round:r,isoWeekday:a}=n._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),bh(o)||(o=typeof s=="string"?t.parse(o,s):t.parse(o)),o===null?null:(r&&(o=r==="week"&&(cT(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,r)),+o)}function kee(n,e,t,s){const r=xf.length;for(let a=xf.indexOf(n);a<r-1;++a){const o=AP[xf[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=s)return xf[a]}return xf[r-1]}function iht(n,e,t,s,r){for(let a=xf.length-1;a>=xf.indexOf(t);a--){const o=xf[a];if(AP[o].common&&n._adapter.diff(r,s,o)>=e-1)return o}return xf[t?xf.indexOf(t):0]}function aht(n){for(let e=xf.indexOf(n)+1,t=xf.length;e<t;++e)if(AP[xf[e]].common)return xf[e]}function Eee(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:s,hi:r}=f7(t,e),a=t[s]>=e?t[s]:t[r];n[a]=!0}}function oht(n,e,t,s){const r=n._adapter,a=+r.startOf(e[0].value,s),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+r.add(l,1,s))c=t[l],c>=0&&(e[c].major=!0);return e}function Iee(n,e,t){const s=[],r={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],r[l]=o,s.push({value:l,major:!1});return a===0||!t?s:oht(n,s,r,t)}class Aee extends lx{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const s=e.time||(e.time={}),r=this._adapter=new sft._date(e.adapters.date);r.init(t),wM(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Tee(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,s=e.time.unit||"day";let{min:r,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!l&&!isNaN(u.max)&&(a=Math.max(a,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=bh(r)&&!isNaN(r)?r:+t.startOf(Date.now(),s),a=bh(a)&&!isNaN(a)?a:+t.endOf(Date.now(),s)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],s=e[e.length-1]),{min:t,max:s}}buildTicks(){const e=this.options,t=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,o=this.max,l=vct(r,a,o);return this._unit=t.unit||(s.autoSkip?kee(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):iht(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:aht(this._unit),this.initOffsets(r),e.reverse&&l.reverse(),Iee(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,s=0,r,a;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?s=a:s=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=yu(t,0,o),s=yu(s,0,o),this._offsets={start:t,end:s,factor:1/(t+1+s)}}_generate(){const e=this._adapter,t=this.min,s=this.max,r=this.options,a=r.time,o=a.unit||kee(a.minUnit,t,s,this._getLabelCapacity(t)),l=_r(r.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,u=cT(c)||c===!0,f={};let d=t,h,p;if(u&&(d=+e.startOf(d,"isoWeek",c)),d=+e.startOf(d,u?"day":o),e.diff(s,t,o)>1e5*l)throw new Error(t+" and "+s+" are too far apart with stepSize of "+l+" "+o);const g=r.ticks.source==="data"&&this.getDataTimestamps();for(h=d,p=0;h<s;h=+e.add(h,l,o),p++)Eee(f,h,g);return(h===s||r.bounds==="ticks"||p===1)&&Eee(f,h,g),Object.keys(f).sort(Mee).map(b=>+b)}getLabelForValue(e){const t=this._adapter,s=this.options.time;return s.tooltipFormat?t.format(e,s.tooltipFormat):t.format(e,s.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,a=this._unit,o=t||r[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,s,r){const a=this.options,o=a.ticks.callback;if(o)return Ra(o,[e,t,s],this);const l=a.time.displayFormats,c=this._unit,u=this._majorUnit,f=c&&l[c],d=u&&l[u],h=s[t],p=u&&d&&h&&h.major;return this._adapter.format(e,r||(p?d:f))}generateTickLabels(e){let t,s,r;for(t=0,s=e.length;t<s;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+s)*t.factor)}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,s=this.ctx.measureText(e).width,r=Eg(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(r),o=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*a+l*o,h:s*o+l*a}}_getLabelCapacity(e){const t=this.options.time,s=t.displayFormats,r=s[t.unit]||s.millisecond,a=this._tickFormatFunction(e,0,Iee(this,[e],this._majorUnit),r),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,s=r.length;t<s;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,s;if(e.length)return e;const r=this.getLabels();for(t=0,s=r.length;t<s;++t)e.push(Tee(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return e0e(e.sort(Mee))}}function tL(n,e,t){let s=0,r=n.length-1,a,o,l,c;t?(e>=n[s].pos&&e<=n[r].pos&&({lo:s,hi:r}=Ky(n,"pos",e)),{pos:a,time:l}=n[s],{pos:o,time:c}=n[r]):(e>=n[s].time&&e<=n[r].time&&({lo:s,hi:r}=Ky(n,"time",e)),{time:a,pos:l}=n[s],{time:o,pos:c}=n[r]);const u=o-a;return u?l+(c-l)*(e-a)/u:l}class Mpt extends Aee{static id="timeseries";static defaults=Aee.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=tL(t,this.min),this._tableRange=tL(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:s}=this,r=[],a=[];let o,l,c,u,f;for(o=0,l=e.length;o<l;++o)u=e[o],u>=t&&u<=s&&r.push(u);if(r.length<2)return[{time:t,pos:0},{time:s,pos:1}];for(o=0,l=r.length;o<l;++o)f=r[o+1],c=r[o-1],u=r[o],Math.round((f+c)/2)!==u&&a.push({time:u,pos:o/(l-1)});return a}_generate(){const e=this.min,t=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(t)||s.length===1)&&s.push(t),s.sort((r,a)=>r-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),s=this.getLabelTimestamps();return t.length&&s.length?e=this.normalize(t.concat(s)):e=t.length?t:s,e=this._cache.all=e,e}getDecimalForValue(e){return(tL(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return tL(this._table,s*this._tableRange+this._minPos,!0)}}const D0e="label";function Lee(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function lht(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function O0e(n,e){n.labels=e}function P0e(n,e,t=D0e){const s=[];n.datasets=e.map(r=>{const a=n.datasets.find(o=>o[t]===r[t]);return!a||!r.data||s.includes(a)?{...r}:(s.push(a),Object.assign(a,r),a)})}function cht(n,e=D0e){const t={labels:[],datasets:[]};return O0e(t,n.labels),P0e(t,n.datasets,e),t}function uht(n,e){const{height:t=150,width:s=300,redraw:r=!1,datasetIdKey:a,type:o,data:l,options:c,plugins:u=[],fallbackContent:f,updateMode:d,...h}=n,p=Ie.useRef(null),g=Ie.useRef(null),b=()=>{p.current&&(g.current=new IP(p.current,{type:o,data:cht(l,a),options:c&&{...c},plugins:u}),Lee(e,g.current))},v=()=>{Lee(e,null),g.current&&(g.current.destroy(),g.current=null)};return Ie.useEffect(()=>{!r&&g.current&&c&&lht(g.current,c)},[r,c]),Ie.useEffect(()=>{!r&&g.current&&O0e(g.current.config.data,l.labels)},[r,l.labels]),Ie.useEffect(()=>{!r&&g.current&&l.datasets&&P0e(g.current.config.data,l.datasets,a)},[r,l.datasets]),Ie.useEffect(()=>{g.current&&(r?(v(),setTimeout(b)):g.current.update(d))},[r,c,l.labels,l.datasets,d]),Ie.useEffect(()=>{g.current&&(v(),setTimeout(b))},[o]),Ie.useEffect(()=>(b(),()=>v()),[]),V.jsx("canvas",{ref:p,role:"img",height:t,width:s,...h,children:f})}const fht=Ie.forwardRef(uht);function LP(n,e){return IP.register(e),Ie.forwardRef((t,s)=>V.jsx(fht,{...t,ref:s,type:n}))}const dht=LP("line",tft),hht=LP("bar",Zut),pht=LP("doughnut",y0e),mht=LP("pie",nft);IP.register(tht,rht,Pdt,Idt,Edt,Vdt,Qdt,Bdt,bdt);function ght({canvasManager:n}){const[e,t]=Ie.useState([]),[s,r]=Ie.useState("All"),[a,o]=Ie.useState(""),[l,c]=Ie.useState(20),[u,f]=Ie.useState(!0),[d,h]=Ie.useState("default"),[p,g]=Ie.useState(""),[b,v]=Ie.useState([]),[w,x]=Ie.useState(!1),[S,C]=Ie.useState(V0.getApiKey()),[M,k]=Ie.useState(!!V0.getApiKey()),[E,I]=Ie.useState(1),[A,D]=Ie.useState(""),[L,P]=Ie.useState("#000000"),[j,G]=Ie.useState(""),[Q,q]=Ie.useState("CODE128"),[te,Z]=Ie.useState("#000000"),[ne,le]=Ie.useState(!0),[H,R]=Ie.useState(""),[B,W]=Ie.useState([]),[se,ue]=Ie.useState(!1),[ge,Ce]=Ie.useState("bar"),[Se,Me]=Ie.useState("Jan,Feb,Mar,Apr,May"),[pe,fe]=Ie.useState("12,19,3,5,2"),[$e,We]=Ie.useState("Sales"),[de,Be]=Ie.useState("#3498db"),[st,He]=Ie.useState("Arial"),Xe=Ie.useRef(null),Ke=Ie.useRef(null),Ze=Ie.useRef(null),xt=Ie.useRef(null),dt=Ie.useRef(null);Ie.useEffect(()=>{fetch("data/elements.json").then(Mt=>Mt.json()).then(Mt=>{t(Mt),f(!1)}).catch(Mt=>{console.error("Error loading elements:",Mt),f(!1)})},[]);const Ft=["All",...e.map(Mt=>Mt.category)],It=Mt=>{xt.current&&(Mt==="left"?xt.current.scrollBy({left:-150,behavior:"smooth"}):xt.current.scrollBy({left:150,behavior:"smooth"}))},Bt=()=>{if(Ze.current){const{scrollTop:Mt,scrollHeight:sn,clientHeight:Tn}=Ze.current;Mt+Tn>=sn-50&&c(ai=>ai+20)}},Gt=()=>{S.trim()&&(V0.setApiKey(S.trim()),k(!0))},At=()=>{V0.removeApiKey(),k(!1),C(""),v([])},ht=async()=>{if(p.trim()){x(!0),v([]);try{const Mt=await V0.searchPhotos(p,1,30);Mt&&Mt.results&&v(Mt.results)}catch(Mt){console.error("Stock search failed:",Mt),Mt.message==="Invalid Access Key"?(alert("Invalid Access Key. Please check and try again."),At()):alert("Failed to search photos. Check console.")}finally{x(!1)}}},Qt=async Mt=>{if(!n)return;const sn=Mt.urls.regular;V0.triggerDownload(Mt.links.download_location),await n.addImage(sn)},Xt=async()=>{if(!(!n||!A.trim()))try{const Mt=await Ert.toString(A,{type:"svg",color:{dark:L,light:"#00000000"},margin:1});await n.addSVGString(Mt,{scaleX:1,scaleY:1})}catch(Mt){console.error(Mt)}},us=async()=>{if(!(!n||!j.trim()))try{const Mt=document.createElementNS("http://www.w3.org/2000/svg","svg");pit(Mt,j,{format:Q,lineColor:te,displayValue:ne,background:"#ffffff00",margin:0});const Tn=new XMLSerializer().serializeToString(Mt);await n.addSVGString(Tn,{scaleX:1,scaleY:1})}catch(Mt){console.error("Barcode generation failed:",Mt),alert("Failed to generate Barcode. Check format or value.")}},yn=async()=>{if(H.trim()){ue(!0),W([]);try{const Mt=await z$.searchIcons(H);W(Mt)}catch(Mt){console.error("Icon search failed:",Mt)}finally{ue(!1)}}},En=async Mt=>{if(n)try{const sn=await z$.getIconSVG(Mt);sn&&await n.addSVGString(sn,{scaleX:5,scaleY:5})}catch(sn){console.error("Failed to add icon:",sn)}},Vn=()=>{if(!(!Xe.current||!n))try{const Mt=Xe.current.toBase64Image();n.addImage(Mt)}catch(Mt){console.error("Failed to add chart to canvas",Mt)}},Nn=Mt=>{n&&n.addText(Mt.emoji,{fontSize:72})},Dn=()=>{n&&n.addText("Heading",{fontSize:48,fontWeight:"bold"})},gr=()=>{Ke.current.click()},os=Mt=>{n&&(Mt.type==="shape"?n.addShape(Mt.shapeType,Mt.options):Mt.type==="svg"?n.addSVG(Mt.src):Mt.type==="image"&&n.addImage(Mt.src))},ps=Mt=>{const sn=Mt.target.files[0];if(sn&&n){const Tn=new FileReader;Tn.onload=ai=>{n.addImage(ai.target.result)},Tn.readAsDataURL(sn)}Mt.target.value=""},Qn=e.flatMap(Mt=>Mt.items.map(sn=>({...sn,category:Mt.category}))).filter(Mt=>{const sn=s==="All"||Mt.category===s,Tn=Mt.label.toLowerCase().includes(a.toLowerCase());return sn&&Tn}).slice(0,l);if(u)return V.jsx("div",{style:{padding:"20px",color:"#888"},children:"Loading..."});if(d==="stock")return V.jsxs("div",{className:"elements-panel",children:[V.jsxs("div",{className:"panel-header-row",style:{padding:"10px 15px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[V.jsx("button",{className:"icon-btn",onClick:()=>h("default"),title:"Back",children:V.jsx(yv,{size:18})}),V.jsx("span",{style:{fontWeight:600},children:"Unsplash Photos"}),M&&V.jsx("button",{className:"icon-btn",onClick:At,title:"Change Key",style:{marginLeft:"auto"},children:V.jsx(Pet,{size:16})})]}),M?V.jsxs(V.Fragment,{children:[V.jsxs("div",{className:"panel-search-box",style:{margin:"10px 15px"},children:[V.jsx(DL,{size:16,className:"search-icon-sm"}),V.jsx("input",{type:"text",placeholder:"Search Unsplash...",value:p,onChange:Mt=>g(Mt.target.value),onKeyDown:Mt=>Mt.key==="Enter"&&ht()})]}),V.jsx("div",{className:"panel-scroll-area",ref:dt,children:w?V.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"Searching..."}):V.jsxs("div",{className:"elements-grid-flat",style:{padding:"0 15px 20px"},children:[b.map(Mt=>V.jsxs("div",{className:"stock-photo-item",style:{position:"relative",cursor:"pointer"},onClick:()=>Qt(Mt),children:[V.jsx("img",{src:Mt.urls.small,alt:Mt.alt_description,style:{width:"100%",borderRadius:"4px",display:"block"},loading:"lazy"}),V.jsxs("div",{style:{fontSize:"0.7rem",color:"#888",marginTop:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:["by ",Mt.user.name]})]},Mt.id)),b.length===0&&p&&!w&&V.jsx("div",{className:"empty-state",style:{textAlign:"center",padding:"20px",color:"#888"},children:"No photos found"})]})}),V.jsxs("div",{style:{padding:"5px 15px",fontSize:"0.7rem",color:"#666",textAlign:"center",borderTop:"1px solid var(--border-color)"},children:["Photos provided by ",V.jsx("a",{href:"https://unsplash.com/?utm_source=PosterDesignerPro&utm_medium=referral",target:"_blank",rel:"noreferrer",style:{color:"var(--accent-primary)"},children:"Unsplash"})]})]}):V.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"10px"},children:[V.jsxs("div",{style:{fontSize:"0.9rem",color:"#aaa",lineHeight:"1.4"},children:["Please enter your ",V.jsx("b",{children:"Unsplash Access Key"})," to search for photos.",V.jsx("br",{}),V.jsx("a",{href:"https://unsplash.com/developers",target:"_blank",rel:"noreferrer",style:{color:"var(--accent-primary)"},children:"Get a key here"}),"."]}),V.jsx("input",{type:"password",className:"panel-input",placeholder:"Paste Access Key",value:S,onChange:Mt=>C(Mt.target.value)}),V.jsx("button",{className:"btn btn-primary",onClick:Gt,children:"Save Key"})]})]});if(d==="qrcode")return V.jsxs("div",{className:"elements-panel",children:[V.jsxs("div",{className:"panel-header-row",style:{padding:"10px 15px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[V.jsx("button",{className:"icon-btn",onClick:()=>h("default"),title:"Back",children:V.jsx(yv,{size:18})}),V.jsx("span",{style:{fontWeight:600},children:"QR Code Generator"})]}),V.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Content / URL"}),V.jsx("input",{type:"text",className:"panel-input",placeholder:"https://example.com",value:A,onChange:Mt=>D(Mt.target.value)})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Color"}),V.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[V.jsx("input",{type:"color",value:L,onChange:Mt=>P(Mt.target.value),style:{width:"40px",height:"40px",padding:0,border:"none",cursor:"pointer",background:"none"}}),V.jsx("span",{style:{fontSize:"0.85rem",color:"#888"},children:L})]})]}),V.jsx("button",{className:"btn btn-primary",onClick:Xt,disabled:!A.trim(),style:{marginTop:"10px"},children:"Generate QR Code"}),V.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"0.8rem",color:"#888",lineHeight:"1.5"},children:[V.jsx("strong",{style:{color:"var(--text-primary)"},children:"Tip:"})," The QR Code is generated as a ",V.jsx("b",{children:"Vector (SVG)"})," object. You can scale it infinitely without losing quality!"]})]})]});if(d==="barcode")return V.jsxs("div",{className:"elements-panel",children:[V.jsxs("div",{className:"panel-header-row",style:{padding:"10px 15px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[V.jsx("button",{className:"icon-btn",onClick:()=>h("default"),title:"Back",children:V.jsx(yv,{size:18})}),V.jsx("span",{style:{fontWeight:600},children:"Barcode Generator"})]}),V.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Value"}),V.jsx("input",{type:"text",className:"panel-input",placeholder:"12345678",value:j,onChange:Mt=>G(Mt.target.value)})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Format"}),V.jsxs("select",{className:"panel-select",value:Q,onChange:Mt=>q(Mt.target.value),children:[V.jsx("option",{value:"CODE128",children:"CODE128 (Standard)"}),V.jsx("option",{value:"EAN13",children:"EAN13 (Product)"}),V.jsx("option",{value:"UPC",children:"UPC (US Retail)"}),V.jsx("option",{value:"ITF",children:"ITF"}),V.jsx("option",{value:"MSI",children:"MSI"}),V.jsx("option",{value:"codabar",children:"Codabar"})]})]}),V.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[V.jsxs("div",{children:[V.jsx("label",{className:"input-label",style:{marginBottom:0},children:"Color"}),V.jsx("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"5px"},children:V.jsx("input",{type:"color",value:te,onChange:Mt=>Z(Mt.target.value),style:{width:"40px",height:"40px",padding:0,border:"none",cursor:"pointer",background:"none"}})})]}),V.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[V.jsx("input",{type:"checkbox",checked:ne,onChange:Mt=>le(Mt.target.checked),id:"showTextCheck"}),V.jsx("label",{htmlFor:"showTextCheck",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Show Numbers"})]})]}),V.jsx("button",{className:"btn btn-primary",onClick:us,disabled:!j.trim(),style:{marginTop:"10px"},children:"Generate Barcode"})]})]});if(d==="emoji")return V.jsxs("div",{className:"elements-panel",children:[V.jsxs("div",{className:"panel-header-row",style:{padding:"10px 15px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[V.jsx("button",{className:"icon-btn",onClick:()=>h("default"),title:"Back",children:V.jsx(yv,{size:18})}),V.jsx("span",{style:{fontWeight:600},children:"Emoji Picker"})]}),V.jsx("div",{style:{flex:1,overflow:"hidden"},children:V.jsx(Olt,{onEmojiClick:Nn,theme:"dark",width:"100%",height:"100%",searchDisabled:!1,skinTonesDisabled:!0,previewConfig:{showPreview:!1}})})]});if(d==="icon")return V.jsxs("div",{className:"elements-panel",children:[V.jsxs("div",{className:"panel-header-row",style:{padding:"10px 15px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[V.jsx("button",{className:"icon-btn",onClick:()=>h("default"),title:"Back",children:V.jsx(yv,{size:18})}),V.jsx("span",{style:{fontWeight:600},children:"Icon Library"})]}),V.jsxs("div",{className:"panel-search-box",style:{margin:"10px 15px"},children:[V.jsx(DL,{size:16,className:"search-icon-sm"}),V.jsx("input",{type:"text",placeholder:"Search icons (e.g. home, user)...",value:H,onChange:Mt=>R(Mt.target.value),onKeyDown:Mt=>Mt.key==="Enter"&&yn()})]}),V.jsx("div",{className:"panel-scroll-area",children:se?V.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"Searching..."}):V.jsxs("div",{className:"elements-grid-flat",style:{padding:"0 15px 20px",gridTemplateColumns:"repeat(auto-fill, minmax(60px, 1fr))"},children:[B.map(Mt=>V.jsx("button",{className:"btn-element-flat",onClick:()=>En(Mt),title:Mt,style:{padding:"10px"},children:V.jsx("img",{src:z$.getIconPreviewUrl(Mt),alt:Mt,style:{width:"100%",height:"100%",objectFit:"contain"},loading:"lazy"})},Mt)),B.length===0&&H&&!se&&V.jsx("div",{className:"empty-state",style:{textAlign:"center",padding:"20px",color:"#888",gridColumn:"1 / -1"},children:"No icons found"}),!H&&B.length===0&&V.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#666",fontSize:"0.85rem",lineHeight:"1.4",gridColumn:"1 / -1"},children:["Search for thousands of vector icons.",V.jsx("br",{}),"Powered by ",V.jsx("b",{children:"Iconify"}),"."]})]})})]});if(d==="chart"){const Mt=Se.split(",").map(ir=>ir.trim()),sn=pe.split(",").map(ir=>parseFloat(ir.trim())||0),Tn={labels:Mt,datasets:[{label:$e,data:sn,backgroundColor:ge==="pie"||ge==="doughnut"?[de,"#e74c3c","#f1c40f","#2ecc71","#9b59b6","#34495e"]:de,borderColor:ge==="line"?de:"rgba(0,0,0,0.1)",borderWidth:1}]},ai={responsive:!0,maintainAspectRatio:!1,devicePixelRatio:2.5,plugins:{legend:{position:"bottom",labels:{font:{family:st}}},title:{display:!0,text:$e,font:{family:st,size:16}},tooltip:{bodyFont:{family:st},titleFont:{family:st}}},scales:{x:{ticks:{font:{family:st}}},y:{ticks:{font:{family:st}}}}};return(ge==="pie"||ge==="doughnut")&&delete ai.scales,V.jsxs("div",{className:"elements-panel",children:[V.jsxs("div",{className:"panel-header-row",style:{padding:"10px 15px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[V.jsx("button",{className:"icon-btn",onClick:()=>h("default"),title:"Back",children:V.jsx(yv,{size:18})}),V.jsx("span",{style:{fontWeight:600},children:"Chart Generator"})]}),V.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"15px",overflowY:"auto"},children:[V.jsxs("div",{style:{height:"200px",background:"var(--bg-secondary)",borderRadius:"8px",padding:"10px"},children:[ge==="bar"&&V.jsx(hht,{ref:Xe,data:Tn,options:ai}),ge==="line"&&V.jsx(dht,{ref:Xe,data:Tn,options:ai}),ge==="pie"&&V.jsx(mht,{ref:Xe,data:Tn,options:ai}),ge==="doughnut"&&V.jsx(pht,{ref:Xe,data:Tn,options:ai})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Chart Type"}),V.jsxs("select",{className:"panel-select",value:ge,onChange:ir=>Ce(ir.target.value),children:[V.jsx("option",{value:"bar",children:"Bar Chart"}),V.jsx("option",{value:"line",children:"Line Chart"}),V.jsx("option",{value:"pie",children:"Pie Chart"}),V.jsx("option",{value:"doughnut",children:"Doughnut Chart"})]})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Font Family"}),V.jsxs("select",{className:"panel-select",value:st,onChange:ir=>He(ir.target.value),children:[V.jsx("option",{value:"Arial",children:"Arial (Standard)"}),V.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),V.jsx("option",{value:"Courier New",children:"Courier New"}),V.jsx("option",{value:"Verdana",children:"Verdana"}),V.jsx("option",{value:"Tahoma",children:"Tahoma"}),V.jsx("option",{value:"Impact",children:"Impact"}),V.jsx("option",{value:"'Phetsarath OT', sans-serif",children:"Phetsarath OT (Lao)"}),V.jsx("option",{value:"'Noto Sans Lao', sans-serif",children:"Noto Sans Lao"})]})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Dataset Label"}),V.jsx("input",{type:"text",className:"panel-input",value:$e,onChange:ir=>We(ir.target.value)})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Labels (comma separated)"}),V.jsx("input",{type:"text",className:"panel-input",value:Se,onChange:ir=>Me(ir.target.value)})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Data (comma separated)"}),V.jsx("input",{type:"text",className:"panel-input",value:pe,onChange:ir=>fe(ir.target.value)})]}),V.jsxs("div",{children:[V.jsx("label",{className:"input-label",children:"Primary Color"}),V.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[V.jsx("input",{type:"color",value:de,onChange:ir=>Be(ir.target.value),style:{width:"40px",height:"40px",padding:0,border:"none",cursor:"pointer",background:"none"}}),V.jsx("span",{style:{fontSize:"0.85rem",color:"#888"},children:de})]})]}),V.jsx("button",{className:"btn btn-primary",onClick:Vn,style:{marginTop:"10px"},children:"Add Chart to Canvas"}),V.jsx("div",{style:{fontSize:"0.8rem",color:"#666",textAlign:"center"},children:"Added as a high-res Image object"})]})]})}const On=(Mt,sn="#ccc")=>{const Tn={width:"100%",height:"100%",display:"block"};switch(Mt){case"rect":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("rect",{x:"10",y:"25",width:"80",height:"50",fill:sn,rx:"4"})});case"circle":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("circle",{cx:"50",cy:"50",r:"40",fill:sn})});case"triangle":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"50,15 15,85 85,85",fill:sn})});case"right_triangle":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"20,20 20,80 80,80",fill:sn})});case"diamond":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"50,20 80,50 50,80 20,50",fill:sn})});case"parallelogram":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"30,20 90,20 70,80 10,80",fill:sn})});case"trapezoid":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"30,20 70,20 90,80 10,80",fill:sn})});case"star":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})});case"pentagon":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M12 2l9.5 6.9-3.6 11.1H6.1L2.5 8.9 12 2z"})});case"hexagon":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M21 16.5l-9 5.2-9-5.2v-9l9-5.2 9 5.2v9z"})});case"cross":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"35,20 65,20 65,35 80,35 80,65 65,65 65,80 35,80 35,65 20,65 20,35 35,35",fill:sn})});case"cloud":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"})});case"burst":return V.jsx("svg",{viewBox:"0 0 100 100",style:Tn,children:V.jsx("polygon",{points:"50,10 60,35 85,25 75,45 95,60 70,70 65,95 50,80 35,95 30,70 5,60 25,45 15,25 40,35",fill:sn})});case"lightning":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M7 2v11h3v9l7-12h-4l4-8z"})});case"arrow":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M5 12h10v5l5-5-5-5v5H5v-5z"})});case"message_box":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"})});case"heart":return V.jsx("svg",{viewBox:"0 0 24 24",style:Tn,children:V.jsx("path",{fill:sn,d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})});default:return V.jsx("div",{style:{width:"100%",height:"100%",background:"#333",borderRadius:"4px"}})}};return V.jsxs("div",{className:"elements-panel",children:[V.jsx("input",{type:"file",ref:Ke,style:{display:"none"},accept:"image/*",onChange:ps}),V.jsxs("div",{className:"elements-basics-section",children:[V.jsx("div",{className:"section-title",children:"BASICS"}),V.jsxs("div",{className:"elements-basics-grid",children:[V.jsxs("button",{className:"btn-element-primary",onClick:Dn,title:"Add Text",children:[V.jsx(Mfe,{size:18}),V.jsx("span",{children:"Text"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:gr,title:"Upload Image",children:[V.jsx(Ltt,{size:18}),V.jsx("span",{children:"Upload"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:()=>h("stock"),title:"Stock Photos",children:[V.jsx(Aet,{size:18}),V.jsx("span",{children:"Stock"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:()=>h("icon"),title:"Icons",children:[V.jsx(_fe,{size:18}),V.jsx("span",{children:"Icons"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:()=>h("qrcode"),title:"QR Code",children:[V.jsx(ett,{size:18}),V.jsx("span",{children:"QR Code"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:()=>h("barcode"),title:"Barcode",children:[V.jsx(ftt,{size:18}),V.jsx("span",{children:"Barcode"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:()=>h("emoji"),title:"Emoji",children:[V.jsx(ytt,{size:18}),V.jsx("span",{children:"Emoji"})]}),V.jsxs("button",{className:"btn-element-primary",onClick:()=>h("chart"),title:"Charts",children:[V.jsx(YZe,{size:18}),V.jsx("span",{children:"Charts"})]})]})]}),V.jsxs("div",{className:"panel-search-box",children:[V.jsx(DL,{size:16,className:"search-icon-sm"}),V.jsx("input",{type:"text",placeholder:"Search elements...",value:a,onChange:Mt=>o(Mt.target.value)})]}),V.jsxs("div",{className:"panel-category-wrapper",children:[V.jsx("button",{className:"category-nav-btn",onClick:()=>It("left"),title:"Scroll Left",children:V.jsx(hfe,{size:16})}),V.jsx("div",{className:"panel-filter-bar",ref:xt,children:Ft.map(Mt=>V.jsx("button",{className:`filter-chip ${s===Mt?"active":""}`,onClick:()=>r(Mt),children:Mt},Mt))}),V.jsx("button",{className:"category-nav-btn",onClick:()=>It("right"),title:"Scroll Right",children:V.jsx(pfe,{size:16})})]}),V.jsx("div",{className:"panel-scroll-area",ref:Ze,onScroll:Bt,children:V.jsxs("div",{className:"elements-grid-flat",children:[Qn.map((Mt,sn)=>V.jsx("button",{className:"btn-element-flat",onClick:()=>os(Mt),title:Mt.label,children:V.jsx("div",{className:"element-preview",style:{width:"100%",height:"50px",display:"flex",alignItems:"center",justifyContent:"center"},children:Mt.type==="shape"?V.jsx("div",{style:{width:"40px",height:"40px"},children:On(Mt.shapeType,Mt.options?.fill||"#888")}):V.jsx("img",{src:Mt.icon||Mt.src,alt:Mt.label,loading:"lazy",style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"}})})},sn)),Qn.length===0&&V.jsx("div",{className:"empty-state",style:{textAlign:"center",padding:"20px",color:"#888"},children:"No elements found"})]})})]})}function yht({canvasManager:n}){const[e,t]=Ie.useState("presets"),[s,r]=Ie.useState([]),[a,o]=Ie.useState([]),[l,c]=Ie.useState("All"),[u,f]=Ie.useState(""),d=Ie.useRef(null),h=C=>{d.current&&d.current.scrollBy({left:C==="left"?-150:150,behavior:"smooth"})};Ie.useEffect(()=>{fetch("data/templates.json").then(C=>C.json()).then(C=>r(C)).catch(C=>console.error("Error loading templates:",C)),p()},[]);const p=()=>{try{const C=localStorage.getItem("canvas_pro_my_templates");C&&o(JSON.parse(C))}catch(C){console.error("Failed to load custom templates",C)}},g=["All",...new Set(s.map(C=>C.category).filter(Boolean))],v=(e==="presets"?s:a).filter(M=>{const k=e==="custom"||l==="All"||M.category===l,E=M.title.toLowerCase().includes(u.toLowerCase());return k&&E}),w=async C=>{if(n&&confirm("Load template? Unsaved changes will be replaced."))try{if(e==="presets"&&C.file){const k=await(await fetch(C.file)).json();n.loadProject(k)}else e==="custom"&&C.data&&n.loadProject(C.data)}catch(M){console.error("Failed to load template",M),alert("Failed to load template.")}},x=()=>{if(!n)return;const C=prompt("Enter a name for your template:","My New Design");if(C)try{const M=n.canvas.toDataURL({format:"jpeg",quality:.7,multiplier:.2}),k=n.canvas.toJSON(),I=[{id:Date.now().toString(),title:C,thumbnail:M,data:k,createdAt:Date.now(),category:"Custom"},...a];o(I),localStorage.setItem("canvas_pro_my_templates",JSON.stringify(I)),t("custom")}catch(M){console.error("Failed to save template",M),M.name==="QuotaExceededError"?alert("Storage full! Please delete some old templates."):alert("Failed to save template.")}},S=(C,M)=>{if(C.stopPropagation(),confirm("Delete this template?")){const k=a.filter(E=>E.id!==M);o(k),localStorage.setItem("canvas_pro_my_templates",JSON.stringify(k))}};return V.jsxs("div",{className:"templates-panel",children:[V.jsxs("div",{className:"panel-tabs-segment",children:[V.jsx("button",{className:`tab-segment-btn ${e==="presets"?"active":""}`,onClick:()=>t("presets"),children:"Presets"}),V.jsx("button",{className:`tab-segment-btn ${e==="custom"?"active":""}`,onClick:()=>t("custom"),children:"My Templates"})]}),V.jsxs("div",{className:"panel-search-box",children:[V.jsx(DL,{className:"search-icon-sm"}),V.jsx("input",{type:"text",placeholder:e==="presets"?"Search presets...":"Search my templates...",value:u,onChange:C=>f(C.target.value)})]}),e==="presets"&&V.jsxs("div",{className:"panel-category-wrapper",children:[V.jsx("button",{className:"category-nav-btn",onClick:()=>h("left"),title:"Scroll Left",children:V.jsx(hfe,{size:16})}),V.jsx("div",{className:"panel-filter-bar",ref:d,children:g.map(C=>V.jsx("button",{className:`filter-chip ${l===C?"active":""}`,onClick:()=>c(C),children:C},C))}),V.jsx("button",{className:"category-nav-btn",onClick:()=>h("right"),title:"Scroll Right",children:V.jsx(pfe,{size:16})})]}),V.jsxs("div",{className:"templates-grid panel-scroll-area",children:[e==="custom"&&!u&&V.jsxs("div",{className:"template-card add-new-card",onClick:x,title:"Save current design",children:[V.jsx("div",{className:"add-btn-circle",children:V.jsx(wfe,{size:24,color:"white"})}),V.jsx("span",{className:"add-new-text",children:"Save Current"})]}),v.length===0&&!(!u&&e==="custom")&&V.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#888",gridColumn:"1 / -1"},children:e==="custom"?"No saved templates yet.":"No templates found."}),v.map(C=>V.jsxs("div",{className:"template-card",onClick:()=>w(C),children:[V.jsx("div",{className:"template-thumb",children:V.jsx("img",{src:C.thumbnail||"placeholder.png",alt:C.title,loading:"lazy"})}),V.jsxs("div",{className:"template-info",children:[V.jsx("h4",{children:C.title}),V.jsx("span",{className:"template-cat",children:e==="presets"?C.category:new Date(C.createdAt).toLocaleDateString()})]}),e==="custom"&&V.jsx("button",{className:"btn-delete-template",onClick:M=>S(M,C.id),title:"Delete Template",children:V.jsx(oP,{size:14})})]},C.id))]})]})}function bht(){const{canvasManager:n}=aP(),e=Ie.useRef(null),[t,s]=Ie.useState(!1),[r,a]=Ie.useState({x:0,y:0}),[o,l]=Ie.useState(null);Ie.useEffect(()=>{if(!n)return;const p=b=>{const v=document.getElementById("canvas-wrapper");if(v&&v.contains(b.target)){b.preventDefault();const w=n.canvas.findTarget(b);w?(n.canvas.setActiveObject(w),n.canvas.requestRenderAll(),l(w),a({x:b.clientX,y:b.clientY}),s(!0)):s(!1)}},g=b=>{const{target:v,x:w,y:x}=b.detail;v&&(n.canvas.setActiveObject(v),n.canvas.requestRenderAll(),l(v),a({x:w,y:x}),s(!0))};return document.addEventListener("contextmenu",p),document.addEventListener("canvas:contextmenu",g),()=>{document.removeEventListener("contextmenu",p),document.removeEventListener("canvas:contextmenu",g)}},[n]),Ie.useEffect(()=>{const p=g=>{e.current&&!e.current.contains(g.target)&&s(!1)};if(t&&(document.addEventListener("mousedown",p),e.current)){const g=e.current,b=g.getBoundingClientRect(),v=window.innerWidth,w=window.innerHeight;let{x,y:S}=r;S+b.height>w&&(S=w-b.height-10),x+b.width>v&&(x=v-b.width-10),S<0&&(S=10),x<0&&(x=10),g.style.top=`${S}px`,g.style.left=`${x}px`}return()=>{document.removeEventListener("mousedown",p)}},[t,r]);const c=async p=>{if(n){switch(p){case"duplicate":n.duplicateActiveObject();break;case"delete":n.removeActiveObject();break;case"layer-up":n.layerActiveObject("up");break;case"layer-down":n.layerActiveObject("down");break;case"group":n.group();break;case"ungroup":n.ungroup();break;case"lock":n.toggleLockActiveObject();break;case"flip-h":n.flipActiveObject("horizontal");break;case"flip-v":n.flipActiveObject("vertical");break;case"start-crop":n.startCropMode(),s(!1);break;case"remove-bg":s(!1),$s.info("Removing background...",2e3);try{const g=o.getSrc(),b=await sh.removeBackground(g),v=URL.createObjectURL(b);await n.replaceImage(o,v),$s.success("Background removed!")}catch(g){console.error("BG Removal error:",g),$s.error("Failed to remove background")}return;case"vectorize":s(!1),await n.vectorizeActiveImage();break}s(!1)}};if(!t)return null;const u=o?.lockMovementX,f=o?.type==="group",d=o?.type==="activeSelection"||o?.type==="activeselection",h=o&&(o.type==="image"||o.type==="fabric-image");return V.jsxs("div",{ref:e,className:"context-menu",style:{top:r.y,left:r.x},children:[h&&V.jsxs(V.Fragment,{children:[V.jsx(eh,{icon:V.jsx(oU,{size:16}),label:"Crop Image",onClick:()=>c("start-crop")}),V.jsx(eh,{icon:V.jsx(cU,{size:16}),label:"Remove Background",onClick:()=>c("remove-bg")}),V.jsx(eh,{icon:V.jsx(pM,{size:16}),label:"Convert to Vector",onClick:()=>c("vectorize")}),V.jsx("div",{className:"menu-divider"})]}),V.jsx(eh,{icon:V.jsx(aU,{size:16}),label:"Duplicate",shortcut:"Ctrl+D",onClick:()=>c("duplicate")}),V.jsx("div",{className:"menu-divider"}),V.jsx(eh,{icon:V.jsx(cfe,{size:16}),label:"Flip Horizontal",onClick:()=>c("flip-h")}),V.jsx(eh,{icon:V.jsx(ufe,{size:16}),label:"Flip Vertical",onClick:()=>c("flip-v")}),V.jsx("div",{className:"menu-divider"}),V.jsx(eh,{icon:V.jsx(iU,{size:16}),label:"Bring Forward",shortcut:"Ctrl+]",onClick:()=>c("layer-up")}),V.jsx(eh,{icon:V.jsx(rU,{size:16}),label:"Send Backward",shortcut:"Ctrl+[",onClick:()=>c("layer-down")}),V.jsx("div",{className:"menu-divider"}),V.jsx(eh,{icon:u?V.jsx(bfe,{size:16}):V.jsx(lU,{size:16}),label:u?"Unlock":"Lock",shortcut:"Ctrl+L",onClick:()=>c("lock")}),f&&V.jsx(eh,{icon:V.jsx(pM,{size:16}),label:"Ungroup",onClick:()=>c("ungroup")}),!f&&d&&V.jsx(eh,{icon:V.jsx(pM,{size:16}),label:"Group",shortcut:"Ctrl+G",onClick:()=>c("group")}),V.jsx("div",{className:"menu-divider"}),V.jsx(eh,{icon:V.jsx(oP,{size:16}),label:"Delete",shortcut:"Del",danger:!0,onClick:()=>c("delete")})]})}function eh({icon:n,label:e,shortcut:t,onClick:s,danger:r=!1}){return V.jsxs("button",{className:`menu-item ${r?"danger":""}`,onClick:s,children:[V.jsx("span",{className:"menu-icon",children:n}),V.jsx("span",{className:"menu-label",children:e}),t&&V.jsx("span",{className:"menu-shortcut",children:t})]})}function Nee({type:n="horizontal",canvasManager:e}){const t=Ie.useRef(null),[s,r]=Ie.useState({zoom:1,offset:{x:0,y:0}});Ie.useEffect(()=>{if(!e)return;const o=()=>{if(!e.canvas)return;const l=e.canvas.getZoom(),c=e.canvas.viewportTransform;r({zoom:l,offset:{x:c[4],y:c[5]}})};if(o(),!!e.canvas)return e.canvas.on("mouse:wheel",o),e.canvas.on("mouse:move",l=>{e.canvas.isDragging&&o()}),e.canvas.on("mouse:up",o),e.canvas.on("after:render",o),()=>{e.canvas&&(e.canvas.off("mouse:wheel",o),e.canvas.off("after:render",o),e.canvas.off("mouse:move",o),e.canvas.off("mouse:up",o))}},[e]),Ie.useEffect(()=>{const o=t.current;if(!o)return;const l=o.getContext("2d"),{zoom:c,offset:u}=s,f=o.getBoundingClientRect();o.width=f.width,o.height=f.height,l.clearRect(0,0,o.width,o.height),l.fillStyle="#f3f4f6",l.fillRect(0,0,o.width,o.height),l.fillStyle="#6b7280",l.strokeStyle="#9ca3af",l.lineWidth=1,l.font="10px Inter, sans-serif";const d=0,h=n==="horizontal"?o.width:o.height;let p=50;c>2&&(p=10),c>5&&(p=5),c<.5&&(p=100),c<.2&&(p=500);const g=n==="horizontal"?(d-u.x)/c:(d-u.y)/c,b=Math.ceil(g/p)*p;let v=n==="horizontal"?b*c+u.x:b*c+u.y;const w=p*c;let x=b;for(l.beginPath();v<h;){const S=x%(p*2)===0?12:6;n==="horizontal"?(l.moveTo(v,o.height-S),l.lineTo(v,o.height),x%(p*2)===0&&l.fillText(Math.round(x),v+2,14)):(l.moveTo(o.width-S,v),l.lineTo(o.width,v),x%(p*2)===0&&(l.save(),l.translate(12,v+10),l.rotate(-Math.PI/2),l.fillText(Math.round(x),0,0),l.restore())),x+=p,v+=w}l.stroke()},[s,n]);const a=o=>{if(!e)return;o.preventDefault();const l=e.canvas.getZoom(),c=e.canvas.viewportTransform,u=(b,v)=>{const w=e.canvas.getElement().getBoundingClientRect(),x=b-w.left,S=v-w.top,C=(x-c[4])/l,M=(S-c[5])/l;return{x:C,y:M}},f=u(o.clientX,o.clientY),d=n==="horizontal"?f.y:f.x,h=e.addGuide(n,d),p=b=>{const v=u(b.clientX,b.clientY);n==="horizontal"?h.set("top",v.y):h.set("left",v.x),h.setCoords(),e.canvas.requestRenderAll()},g=()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",g)};window.addEventListener("mousemove",p),window.addEventListener("mouseup",g)};return V.jsx("canvas",{ref:t,onMouseDown:a,style:{width:"100%",height:"100%",display:"block",background:"var(--bg-tertiary)",cursor:n==="horizontal"?"ns-resize":"ew-resize"}})}const wht=[{category:"General",items:[{keys:["Del"],desc:"Delete"},{keys:["Esc"],desc:"Deselect / Cancel"}]},{category:"Clipboard",items:[{keys:["Ctrl","C"],desc:"Copy"},{keys:["Ctrl","V"],desc:"Paste"},{keys:["Ctrl","D"],desc:"Duplicate"}]},{category:"Manipulation",items:[{keys:["Arrows"],desc:"Nudge Object"},{keys:["Shift","Arrows"],desc:"Nudge x10"},{keys:["Shift","Drag"],desc:"Constrain Rotate/Scale"}]},{category:"View",items:[{keys:["Space","Drag"],desc:"Pan Canvas (Hand Tool)"},{keys:["Alt","Wheel"],desc:"Zoom In/Out"}]}];function vht({isOpen:n,onClose:e}){return n?(Ie.useEffect(()=>{const t=s=>{s.key==="Escape"&&e()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e]),V.jsxs("div",{className:"modal-overlay",onClick:e,children:[V.jsxs("div",{className:"modal-content shortcuts-modal",onClick:t=>t.stopPropagation(),children:[V.jsxs("div",{className:"modal-header",children:[V.jsx("h2",{children:"Keyboard Shortcuts"}),V.jsx("button",{className:"close-btn",onClick:e,children:V.jsx(hE,{size:20})})]}),V.jsx("div",{className:"shortcuts-grid",children:wht.map(t=>V.jsxs("div",{className:"shortcut-category",children:[V.jsx("h3",{children:t.category}),V.jsx("ul",{children:t.items.map((s,r)=>V.jsxs("li",{children:[V.jsx("div",{className:"keys",children:s.keys.map((a,o)=>V.jsxs(Hr.Fragment,{children:[V.jsx("span",{className:"kbd",children:a}),o<s.keys.length-1&&V.jsx("span",{className:"plus",children:"+"})]},a))}),V.jsx("span",{className:"desc",children:s.desc})]},r))})]},t.category))})]}),V.jsx("style",{children:`
                .shortcuts-modal {
                    max-width: 800px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                    background: #1e1e1e;
                    color: #fff;
                    border: 1px solid #333;
                }
                .shortcuts-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                    gap: 24px;
                    padding: 20px;
                }
                .shortcut-category h3 {
                    margin-bottom: 12px;
                    color: #888;
                    font-size: 14px;
                    text-transform: uppercase;
                    letter-spacing: 1px;
                    border-bottom: 1px solid #333;
                    padding-bottom: 8px;
                }
                .shortcut-category ul {
                    list-style: none;
                    padding: 0;
                    margin: 0;
                }
                .shortcut-category li {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 8px 0;
                    border-bottom: 1px solid #2a2a2a;
                }
                .shortcut-category li:last-child {
                    border-bottom: none;
                }
                .keys {
                    display: flex;
                    align-items: center;
                    gap: 4px;
                }
                .kbd {
                    background: #333;
                    border: 1px solid #444;
                    border-radius: 4px;
                    padding: 2px 6px;
                    font-family: monospace;
                    font-size: 12px;
                    color: #eee;
                    box-shadow: 0 2px 0 #222;
                }
                .plus {
                    color: #666;
                    font-size: 12px;
                }
                .desc {
                    color: #ccc;
                    font-size: 14px;
                }
            `})]})):null}function _ht({isOpen:n,onClose:e,onExport:t}){if(!n)return null;const[s,r]=Ie.useState("png"),[a,o]=Ie.useState(.8),[l,c]=Ie.useState(2),u=()=>{t({format:s,quality:parseFloat(a),multiplier:parseFloat(l)}),e()};return V.jsx("div",{className:"modal-overlay",onClick:e,children:V.jsxs("div",{className:"modal-content export-modal",onClick:f=>f.stopPropagation(),style:{width:"420px"},children:[V.jsxs("div",{className:"modal-header",children:[V.jsx("h2",{children:"Export Design"}),V.jsx("button",{className:"close-btn",onClick:e,children:V.jsx(hE,{size:20})})]}),V.jsxs("div",{className:"export-content",children:[V.jsxs("div",{className:"form-group",children:[V.jsx("label",{className:"form-label",children:"Format"}),V.jsx("div",{className:"format-grid",children:["png","jpeg","pdf"].map(f=>V.jsxs("button",{className:`format-btn ${s===f?"active":""}`,onClick:()=>r(f),children:[f==="pdf"?V.jsx(het,{size:16}):V.jsx(fet,{size:16}),f.toUpperCase()]},f))})]}),V.jsxs("div",{className:"form-group",children:[V.jsxs("label",{className:"form-label",children:["Resolution (Scale)",V.jsxs("span",{className:"info-text",children:["Target: ",800*l," x ",600*l," px"]})]}),V.jsx("div",{className:"scale-options",children:[1,2,3,4].map(f=>V.jsxs("button",{className:`scale-btn ${l===f?"active":""}`,onClick:()=>c(f),children:[f,"x"]},f))})]}),s==="jpeg"&&V.jsxs("div",{className:"form-group",children:[V.jsxs("label",{className:"form-label",children:["Quality",V.jsxs("span",{className:"value-display",children:[Math.round(a*100),"%"]})]}),V.jsx("div",{className:"quality-slider-container",children:V.jsx("input",{type:"range",className:"range-slider",min:"0.1",max:"1",step:"0.1",value:a,onChange:f=>o(f.target.value)})})]})]}),V.jsxs("div",{className:"modal-footer",children:[V.jsx("button",{className:"btn-cancel",onClick:e,children:"Cancel"}),V.jsxs("button",{className:"btn-export",onClick:u,children:[V.jsx(mfe,{size:18}),"Export ",s.toUpperCase()]})]})]})})}const F0=37.7952755906;function xht({isOpen:n,onClose:e,onApply:t,currentWidth:s,currentHeight:r}){const[a,o]=Ie.useState(()=>localStorage.getItem("canvas-unit")||"px"),[l,c]=Ie.useState(s),[u,f]=Ie.useState(r),[d,h]=Ie.useState([]);Ie.useEffect(()=>{fetch("data/size_templates.json").then(b=>b.json()).then(b=>h(b)).catch(b=>console.error("Failed to load size templates:",b))},[]),Ie.useEffect(()=>{n&&(a==="cm"?(c(Number((s/F0).toFixed(2))),f(Number((r/F0).toFixed(2)))):(c(s),f(r)))},[n,s,r,a]);const p=b=>{b!==a&&(b==="cm"?(c(Number((l/F0).toFixed(2))),f(Number((u/F0).toFixed(2)))):(c(Math.round(l*F0)),f(Math.round(u*F0))),o(b),localStorage.setItem("canvas-unit",b))},g=()=>{let b=l,v=u;a==="cm"&&(b=Math.round(l*F0),v=Math.round(u*F0)),t(b,v),e()};return n?V.jsx("div",{className:"modal-overlay",onClick:e,children:V.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),style:{width:"360px",borderRadius:"16px"},children:[V.jsxs("div",{className:"modal-header",children:[V.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[V.jsx("div",{style:{background:"var(--accent-gradient)",padding:"8px",borderRadius:"10px",display:"flex"},children:V.jsx(vfe,{size:20,color:"white"})}),V.jsx("h2",{style:{margin:0,fontSize:"1.2rem"},children:"Resize Canvas"})]}),V.jsx("button",{className:"close-btn",onClick:e,children:V.jsx(hE,{size:20})})]}),V.jsxs("div",{className:"modal-body",style:{display:"flex",flexDirection:"column",gap:"20px",padding:"10px 0"},children:[V.jsxs("div",{className:"input-group",children:[V.jsx("label",{style:{marginBottom:"8px",display:"block",fontWeight:"500"},children:"Size Templates"}),V.jsxs("select",{onChange:b=>{const[v,w,x]=b.target.value.split(",");v&&w&&(o(x),localStorage.setItem("canvas-unit",x),c(parseFloat(v)),f(parseFloat(w)))},style:{height:"44px",cursor:"pointer",width:"100%"},defaultValue:"",children:[V.jsx("option",{value:"",children:"Custom Size"}),d.map((b,v)=>V.jsx("optgroup",{label:b.category,children:b.items.map((w,x)=>V.jsxs("option",{value:`${w.width},${w.height},${w.unit}`,children:[w.label," (",w.width," x ",w.height," ",w.unit,")"]},x))},v))]})]}),V.jsxs("div",{className:"input-group",children:[V.jsx("label",{style:{marginBottom:"8px",display:"block",fontWeight:"500"},children:"Measurement Unit"}),V.jsxs("select",{value:a,onChange:b=>p(b.target.value),style:{height:"44px",cursor:"pointer"},children:[V.jsx("option",{value:"px",children:"Pixels (px) - Web Standard"}),V.jsx("option",{value:"cm",children:"Centimeters (cm) - Print Ready"})]})]}),V.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[V.jsxs("div",{className:"input-group",style:{flex:1,minWidth:0},children:[V.jsx("label",{style:{marginBottom:"8px",display:"block",fontWeight:"500",fontSize:"0.8rem"},children:"Width"}),V.jsxs("div",{className:"input-row",style:{height:"40px",padding:"0 8px",display:"flex",alignItems:"center",gap:"4px",minWidth:0},children:[V.jsx("input",{type:"number",value:l,onChange:b=>c(parseFloat(b.target.value)||0),step:a==="cm"?"0.01":"1",style:{textAlign:"left",padding:"0",flex:1,width:"0",minWidth:"0",border:"none",background:"transparent"}}),V.jsx("span",{style:{opacity:.5,fontSize:"0.7rem",flexShrink:0},children:a})]})]}),V.jsx("div",{style:{marginTop:"20px",color:"var(--text-secondary)",fontWeight:"bold",opacity:.4,flexShrink:0},children:""}),V.jsxs("div",{className:"input-group",style:{flex:1,minWidth:0},children:[V.jsx("label",{style:{marginBottom:"8px",display:"block",fontWeight:"500",fontSize:"0.8rem"},children:"Height"}),V.jsxs("div",{className:"input-row",style:{height:"40px",padding:"0 8px",display:"flex",alignItems:"center",gap:"4px",minWidth:0},children:[V.jsx("input",{type:"number",value:u,onChange:b=>f(parseFloat(b.target.value)||0),step:a==="cm"?"0.01":"1",style:{textAlign:"left",padding:"0",flex:1,width:"0",minWidth:"0",border:"none",background:"transparent"}}),V.jsx("span",{style:{opacity:.5,fontSize:"0.7rem",flexShrink:0},children:a})]})]})]})]}),V.jsxs("div",{className:"modal-footer",style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},children:[V.jsx("button",{className:"btn",onClick:e,style:{padding:"10px 20px"},children:"Cancel"}),V.jsx("button",{className:"btn btn-primary",onClick:g,style:{padding:"10px 24px",borderRadius:"10px"},children:"Apply Resize"})]})]})}):null}function Cht({canvasManager:n}){const[e,t]=Ie.useState(!1);return Ie.useEffect(()=>{if(!n)return;t(!!n.isCropping);const s=n.onCropModeChange;return n.onCropModeChange=r=>{t(r),s&&s(r)},()=>{}},[n]),e?V.jsxs("div",{className:"crop-toolbar",children:[V.jsx("span",{className:"crop-label",children:"Crop Mode"}),V.jsxs("div",{className:"crop-actions",children:[V.jsx("button",{className:"icon-btn danger",onClick:()=>n.cancelCrop(),title:"Cancel",children:V.jsx(hE,{size:18})}),V.jsx("button",{className:"icon-btn primary",onClick:()=>n.applyCrop(),title:"Apply Crop",children:V.jsx(dfe,{size:18})})]})]}):null}function Sht(){const n=Ie.useRef(null),{activeTab:e,setActiveTab:t,showRulers:s,setShowRulers:r,showShortcuts:a,setShowShortcuts:o,showExport:l,setShowExport:c,showResize:u,setShowResize:f,colorPickerVisible:d,setColorPickerVisible:h,colorPickerAnchor:p,activeColorProp:g,colorPickerAlign:b}=Nb(),{canvasManager:v,currentColor:w,setCurrentColor:x}=aP();Ie.useEffect(()=>{if(!v)return;const M=new URLSearchParams(window.location.search).get("template");M&&fetch(M).then(k=>k.json()).then(k=>v.loadProject(k)).catch(k=>console.error("Failed to load template:",k))},[v]);const S=C=>{x(C),v&&v.updateActiveObject(g||"fill",C)};return V.jsxs("div",{id:"app-react-root",children:[V.jsx(int,{canvasManager:v,showRulers:s,setShowRulers:r,onOpenShortcuts:()=>o(!0),onOpenExport:()=>c(!0),onOpenResize:()=>f(!0)}),V.jsxs("div",{className:"workspace",children:[V.jsxs("aside",{className:"sidebar",children:[V.jsxs("div",{className:"panel-tabs-container",children:[V.jsx("button",{className:`panel-tab-btn ${e==="elements"?"active":""}`,onClick:()=>t("elements"),children:"Elements"}),V.jsx("button",{className:`panel-tab-btn ${e==="templates"?"active":""}`,onClick:()=>t("templates"),children:"Templates"})]}),V.jsx("div",{id:"elements-wrapper",children:e==="elements"?V.jsx(ght,{canvasManager:v}):V.jsx(yht,{canvasManager:v})})]}),V.jsxs("div",{id:"ruler-wrapper",children:[s&&V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"ruler-corner-box"}),V.jsx("div",{className:"ruler-horizontal-container",children:V.jsx(Nee,{type:"horizontal",canvasManager:v})}),V.jsx("div",{className:"ruler-vertical-container",children:V.jsx(Nee,{type:"vertical",canvasManager:v})})]}),V.jsx("main",{className:"canvas-area",id:"canvas-wrapper",children:V.jsx("div",{className:"canvas-container-wrapper",children:V.jsx("canvas",{id:"c",ref:n})})})]}),V.jsxs("aside",{className:"sidebar-right",children:[V.jsx("div",{className:"section-title",children:"Properties"}),V.jsx(srt,{canvasManager:v}),V.jsx("div",{className:"section-divider"}),V.jsxs("div",{className:"section",style:{flex:1,display:"flex",flexDirection:"column"},children:[V.jsx("div",{className:"section-title",children:"Layers"}),V.jsx(Xst,{canvasManager:v})]})]})]}),V.jsx(Yst,{}),V.jsx(Cht,{canvasManager:v}),V.jsx(bht,{}),d&&V.jsx(Lfe,{color:w,onChange:S,onClose:()=>h(!1),anchorEl:p,align:b}),V.jsx(vht,{isOpen:a,onClose:()=>o(!1)}),V.jsx(_ht,{isOpen:l,onClose:()=>c(!1),onExport:C=>v?.exportImage(C)}),V.jsx(xht,{isOpen:u,onClose:()=>f(!1),onApply:(C,M)=>v?.resize(C,M),currentWidth:v?.originalWidth||800,currentHeight:v?.originalHeight||600})]})}o1e.createRoot(document.getElementById("app")).render(V.jsx(Hr.StrictMode,{children:V.jsx(_Ze,{children:V.jsx(Sht,{})})}));export{Wi as _,k2 as g};
