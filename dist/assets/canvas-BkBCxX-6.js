const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-Qc4JcOqU.js","./lucide-C9PvAY0C.js","./lucide-Cx40Tosd.css"])))=>i.map(i=>d[i]);
import{i as Jn,c as Ds}from"./lucide-C9PvAY0C.js";function G(r,t,e){return(t=(function(i){var n=(function(s,o){if(typeof s!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var l=a.call(s,o);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)})(i,"string");return typeof n=="symbol"?n:n+""})(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function l0(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable}))),e.push.apply(e,i)}return e}function $(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?l0(Object(e),!0).forEach((function(i){G(r,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):l0(Object(e)).forEach((function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))}))}return r}function Ke(r,t){if(r==null)return{};var e,i,n=(function(o,a){if(o==null)return{};var l={};for(var c in o)if({}.hasOwnProperty.call(o,c)){if(a.indexOf(c)>=0)continue;l[c]=o[c]}return l})(r,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)e=s[i],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(r,e)&&(n[e]=r[e])}return n}function as(r,t){return t||(t=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(t)}}))}class c0{constructor(){G(this,"browserShadowBlurConstant",1),G(this,"DPI",96),G(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),G(this,"perfLimitSizeTotal",2097152),G(this,"maxCacheSideLimit",4096),G(this,"minCacheSideLimit",256),G(this,"disableStyleCopyPaste",!1),G(this,"enableGLFiltering",!0),G(this,"textureSize",4096),G(this,"forceGLPutImageData",!1),G(this,"cachesBoundsOfCurve",!1),G(this,"fontPaths",{}),G(this,"NUM_FRACTION_DIGITS",4)}}const Oe=new class extends c0{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=$($({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((r=>{delete this.fontPaths[r]}))}clearFonts(){this.fontPaths={}}restoreDefaults(r){const t=new c0,e=r?.reduce(((i,n)=>(i[n]=t[n],i)),{})||t;this.configure(e)}},js=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return console[r]("fabric",...e)};let $n=class extends Error{constructor(t,e){super("fabric: ".concat(t),e)}},Tp=class extends $n{constructor(t){super("".concat(t," 'options.signal' is in 'aborted' state"))}},Zw=class{},Jw=class extends Zw{testPrecision(t,e){const i="precision ".concat(e,` float;
void main(){}`),n=t.createShader(t.FRAGMENT_SHADER);return!!n&&(t.shaderSource(n,i),t.compileShader(n),!!t.getShaderParameter(n,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((i=>this.testPrecision(e,i))),e.getExtension("WEBGL_lose_context").loseContext(),js("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}};const Qw={};let h0;const is=()=>h0||(h0={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Jw,dispose(){},copyPasteData:Qw}),sl=()=>is().document,ol=()=>is().window,z1=()=>{var r;return Math.max((r=Oe.devicePixelRatio)!==null&&r!==void 0?r:ol().devicePixelRatio,1)},gc=new class{constructor(){G(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(r){let{fontFamily:t,fontStyle:e,fontWeight:i}=r;t=t.toLowerCase();const n=this.charWidthsCache;n.has(t)||n.set(t,new Map);const s=n.get(t),o="".concat(e.toLowerCase(),"_").concat((i+"").toLowerCase());return s.has(o)||s.set(o,new Map),s.get(o)}clearFontCache(r){r?this.charWidthsCache.delete((r||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(r){const{perfLimitSizeTotal:t}=Oe,e=Math.sqrt(t*r);return[Math.floor(e),Math.floor(t/e)]}},Yf="6.9.1";function Ko(){}const wo=Math.PI/2,Fs=2*Math.PI,Ep=Math.PI/180,wr=Object.freeze([1,0,0,1,0,0]),Op=16,no=.4477152502,ue="center",je="left",Lr="top",Gf="bottom",mi="right",mr="none",Pp=/\r?\n/,H1="moving",$u="scaling",U1="rotating",Np="rotate",W1="skewing",Lc="resizing",tb="modifyPoly",eb="modifyPath",pu="changed",Ku="scale",br="scaleX",Vr="scaleY",al="skewX",ll="skewY",Ti="fill",vr="stroke",gu="modified",Aa="json",Xd="svg",Dt=new class{constructor(){this[Aa]=new Map,this[Xd]=new Map}has(r){return this[Aa].has(r)}getClass(r){const t=this[Aa].get(r);if(!t)throw new $n("No class registered for ".concat(r));return t}setClass(r,t){t?this[Aa].set(t,r):(this[Aa].set(r.type,r),this[Aa].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[Xd].get(r)}setSVGClass(r,t){this[Xd].set(t??r.type.toLowerCase(),r)}},mu=new class extends Array{remove(r){const t=this.indexOf(r);t>-1&&this.splice(t,1)}cancelAll(){const r=this.splice(0);return r.forEach((t=>t.abort())),r}cancelByCanvas(r){if(!r)return[];const t=this.filter((e=>{var i;return e.target===r||typeof e.target=="object"&&((i=e.target)===null||i===void 0?void 0:i.canvas)===r}));return t.forEach((e=>e.abort())),t}cancelByTarget(r){if(!r)return[];const t=this.filter((e=>e.target===r));return t.forEach((e=>e.abort())),t}};let ib=class{constructor(){G(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach((i=>{let[n,s]=i;this.on(n,s)})),()=>this.off(t);if(e){const i=t;return this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(e),()=>this.off(i,e)}return()=>!1}once(t,e){if(typeof t=="object"){const i=[];return Object.entries(t).forEach((n=>{let[s,o]=n;i.push(this.once(s,o))})),()=>i.forEach((n=>n()))}if(e){const i=this.on(t,(function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];e.call(this,...s),i()}));return i}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const i=this.__eventListeners[t],n=i.indexOf(e);n>-1&&i.splice(n,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const i in this.__eventListeners)this._removeEventListener(i);else typeof t=="object"?Object.entries(t).forEach((i=>{let[n,s]=i;this._removeEventListener(n,s)})):this._removeEventListener(t,e)}fire(t,e){var i;if(!this.__eventListeners)return;const n=(i=this.__eventListeners[t])===null||i===void 0?void 0:i.concat();if(n)for(let s=0;s<n.length;s++)n[s].call(this,e||{})}};const Vo=(r,t)=>{const e=r.indexOf(t);return e!==-1&&r.splice(e,1),r},Tn=r=>{if(r===0)return 1;switch(Math.abs(r)/wo){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},En=r=>{if(r===0)return 0;const t=r/wo,e=Math.sign(r);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(r)};let ut=class hr{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new hr(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new hr(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new hr(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new hr(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new hr(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new hr(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new hr(this.x/t.x,this.y/t.y)}scalarDivide(t){return new hr(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new hr(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}midPointFrom(t){return this.lerp(t)}min(t){return new hr(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new hr(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}clone(){return new hr(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dp;const i=En(t),n=Tn(t),s=this.subtract(e);return new hr(s.x*n-s.y*i,s.x*i+s.y*n).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new hr(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}};const Dp=new ut(0,0),Jh=r=>!!r&&Array.isArray(r._objects);function V1(r){class t extends r{constructor(){super(...arguments),G(this,"_objects",[])}_onObjectAdded(i){}_onObjectRemoved(i){}_onStackOrderChanged(i){}add(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];const o=this._objects.push(...n);return n.forEach((a=>this._onObjectAdded(a))),o}insertAt(i){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return this._objects.splice(i,0,...s),s.forEach((a=>this._onObjectAdded(a))),this._objects.length}remove(){const i=this._objects,n=[];for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return o.forEach((l=>{const c=i.indexOf(l);c!==-1&&(i.splice(c,1),n.push(l),this._onObjectRemoved(l))})),n}forEachObject(i){this.getObjects().forEach(((n,s,o)=>i(n,s,o)))}getObjects(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return n.length===0?[...this._objects]:this._objects.filter((o=>o.isType(...n)))}item(i){return this._objects[i]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(i,n){return!!this._objects.includes(i)||!!n&&this._objects.some((s=>s instanceof t&&s.contains(i,!0)))}complexity(){return this._objects.reduce(((i,n)=>i+=n.complexity?n.complexity():0),0)}sendObjectToBack(i){return!(!i||i===this._objects[0])&&(Vo(this._objects,i),this._objects.unshift(i),this._onStackOrderChanged(i),!0)}bringObjectToFront(i){return!(!i||i===this._objects[this._objects.length-1])&&(Vo(this._objects,i),this._objects.push(i),this._onStackOrderChanged(i),!0)}sendObjectBackwards(i,n){if(!i)return!1;const s=this._objects.indexOf(i);if(s!==0){const o=this.findNewLowerIndex(i,s,n);return Vo(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}bringObjectForward(i,n){if(!i)return!1;const s=this._objects.indexOf(i);if(s!==this._objects.length-1){const o=this.findNewUpperIndex(i,s,n);return Vo(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}moveObjectTo(i,n){return i!==this._objects[n]&&(Vo(this._objects,i),this._objects.splice(n,0,i),this._onStackOrderChanged(i),!0)}findNewLowerIndex(i,n,s){let o;if(s){o=n;for(let a=n-1;a>=0;--a)if(i.isOverlapping(this._objects[a])){o=a;break}}else o=n-1;return o}findNewUpperIndex(i,n,s){let o;if(s){o=n;for(let a=n+1;a<this._objects.length;++a)if(i.isOverlapping(this._objects[a])){o=a;break}}else o=n+1;return o}collectObjects(i){let{left:n,top:s,width:o,height:a}=i,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],h=new ut(n,s),p=h.add(new ut(o,a));for(let m=this._objects.length-1;m>=0;m--){const f=this._objects[m];f.selectable&&f.visible&&(l&&f.intersectsWithRect(h,p)||f.isContainedWithinRect(h,p)||l&&f.containsPoint(h)||l&&f.containsPoint(p))&&c.push(f)}return c}}return t}let Y1=class extends ib{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}};function mc(r){return ol().requestAnimationFrame(r)}function G1(r){return ol().cancelAnimationFrame(r)}let rb=0;const bo=()=>rb++,rs=()=>{const r=sl().createElement("canvas");if(!r||r.getContext===void 0)throw new $n("Failed to create `canvas` element");return r},X1=()=>sl().createElement("img"),Yr=r=>{const t=rs();return t.width=r.width,t.height=r.height,t},Mp=(r,t,e)=>r.toDataURL("image/".concat(t),e),Ip=(r,t,e)=>new Promise(((i,n)=>{r.toBlob(i,"image/".concat(t),e)})),ci=r=>r*Ep,ns=r=>r/Ep,$1=r=>r.every(((t,e)=>t===wr[e])),ir=(r,t,e)=>new ut(r).transform(t,e),Ar=r=>{const t=1/(r[0]*r[3]-r[1]*r[2]),e=[t*r[3],-t*r[1],-t*r[2],t*r[0],0,0],{x:i,y:n}=new ut(r[4],r[5]).transform(e,!0);return e[4]=-i,e[5]=-n,e},yi=(r,t,e)=>[r[0]*t[0]+r[2]*t[1],r[1]*t[0]+r[3]*t[1],r[0]*t[2]+r[2]*t[3],r[1]*t[2]+r[3]*t[3],e?0:r[0]*t[4]+r[2]*t[5]+r[4],e?0:r[1]*t[4]+r[3]*t[5]+r[5]],Zu=(r,t)=>r.reduceRight(((e,i)=>i&&e?yi(i,e,t):i||e),void 0)||wr.concat(),K1=r=>{let[t,e]=r;return Math.atan2(e,t)},ta=r=>{const t=K1(r),e=Math.pow(r[0],2)+Math.pow(r[1],2),i=Math.sqrt(e),n=(r[0]*r[3]-r[2]*r[1])/i,s=Math.atan2(r[0]*r[2]+r[1]*r[3],e);return{angle:ns(t),scaleX:i,scaleY:n,skewX:ns(s),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},cl=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function oa(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=ci(r),n=Tn(i),s=En(i);return[n,s,-s,n,t?t-(n*t-s*e):0,e?e-(s*t+n*e):0]}const Ju=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},Z1=r=>Math.tan(ci(r)),jp=r=>[1,0,Z1(r),1,0,0],Fp=r=>[1,Z1(r),0,1,0,0],Mc=r=>{let{scaleX:t=1,scaleY:e=1,flipX:i=!1,flipY:n=!1,skewX:s=0,skewY:o=0}=r,a=Ju(i?-t:t,n?-e:e);return s&&(a=yi(a,jp(s),!0)),o&&(a=yi(a,Fp(o),!0)),a},J1=r=>{const{translateX:t=0,translateY:e=0,angle:i=0}=r;let n=cl(t,e);i&&(n=yi(n,oa({angle:i})));const s=Mc(r);return $1(s)||(n=yi(n,s)),n},vc=function(r){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(i,n){if(t&&t.aborted)return n(new Tp("loadImage"));const s=X1();let o;t&&(o=function(l){s.src="",n(l)},t.addEventListener("abort",o,{once:!0}));const a=function(){s.onload=s.onerror=null,o&&t?.removeEventListener("abort",o),i(s)};r?(s.onload=a,s.onerror=function(){o&&t?.removeEventListener("abort",o),n(new $n("Error loading ".concat(s.src)))},e&&(s.crossOrigin=e),s.src=r):a()}))},Qa=function(r){let{signal:t,reviver:e=Ko}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((i,n)=>{const s=[];t&&t.addEventListener("abort",n,{once:!0}),Promise.all(r.map((o=>Dt.getClass(o.type).fromObject(o,{signal:t}).then((a=>(e(o,a),s.push(a),a)))))).then(i).catch((o=>{s.forEach((a=>{a.dispose&&a.dispose()})),n(o)})).finally((()=>{t&&t.removeEventListener("abort",n)}))}))},Ic=function(r){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((e,i)=>{const n=[];t&&t.addEventListener("abort",i,{once:!0});const s=Object.values(r).map((a=>a&&a.type&&Dt.has(a.type)?Qa([a],{signal:t}).then((l=>{let[c]=l;return n.push(c),c})):a)),o=Object.keys(r);Promise.all(s).then((a=>a.reduce(((l,c,h)=>(l[o[h]]=c,l)),{}))).then(e).catch((a=>{n.forEach((l=>{l.dispose&&l.dispose()})),i(a)})).finally((()=>{t&&t.removeEventListener("abort",i)}))}))},aa=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((t,e)=>(e in r&&(t[e]=r[e]),t)),{})},Bp=(r,t)=>Object.keys(r).reduce(((e,i)=>(t(r[i],i,r)&&(e[i]=r[i]),e)),{}),Ue=(r,t)=>parseFloat(Number(r).toFixed(t)),tl=r=>"matrix("+r.map((t=>Ue(t,Oe.NUM_FRACTION_DIGITS))).join(" ")+")",ln=r=>!!r&&r.toLive!==void 0,u0=r=>!!r&&typeof r.toObject=="function",d0=r=>!!r&&r.offsetX!==void 0&&"source"in r,Yo=r=>!!r&&"multiSelectionStacking"in r;function Q1(r){const t=r&&kn(r);let e=0,i=0;if(!r||!t)return{left:e,top:i};let n=r;const s=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;n&&(n.parentNode||n.host)&&(n=n.parentNode||n.host,n===t?(e=o.scrollLeft||s.scrollLeft||0,i=o.scrollTop||s.scrollTop||0):(e+=n.scrollLeft||0,i+=n.scrollTop||0),n.nodeType!==1||n.style.position!=="fixed"););return{left:e,top:i}}const kn=r=>r.ownerDocument||null,t2=r=>{var t;return((t=r.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},e2=function(r,t,e){let{width:i,height:n}=e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=i,r.height=n,s>1&&(r.setAttribute("width",(i*s).toString()),r.setAttribute("height",(n*s).toString()),t.scale(s,s))},Xf=(r,t)=>{let{width:e,height:i}=t;e&&(r.style.width=typeof e=="number"?"".concat(e,"px"):e),i&&(r.style.height=typeof i=="number"?"".concat(i,"px"):i)};function f0(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=mr,r}let i2=class{constructor(t){G(this,"_originalCanvasStyle",void 0),G(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(i=t)&&i.getContext!==void 0?t:t&&sl().getElementById(t)||rs();var i;if(e.hasAttribute("data-fabric"))throw new $n("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:i}=t;const{el:n}=this.lower;n.classList.remove("lower-canvas"),n.removeAttribute("data-fabric"),n.setAttribute("width","".concat(e)),n.setAttribute("height","".concat(i)),n.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:i,ctx:n}=this.lower;e2(i,n,t,e)}setCSSDimensions(t){Xf(this.lower.el,t)}calcOffset(){return(function(t){var e;const i=t&&kn(t),n={left:0,top:0};if(!i)return n;const s=((e=t2(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};n.left+=parseInt(s.borderLeftWidth,10)||0,n.top+=parseInt(s.borderTopWidth,10)||0,n.left+=parseInt(s.paddingLeft,10)||0,n.top+=parseInt(s.paddingTop,10)||0;let o={left:0,top:0};const a=i.documentElement;t.getBoundingClientRect!==void 0&&(o=t.getBoundingClientRect());const l=Q1(t);return{left:o.left+l.left-(a.clientLeft||0)+n.left,top:o.top+l.top-(a.clientTop||0)+n.top}})(this.lower.el)}dispose(){is().dispose(this.lower.el),delete this.lower}};const nb={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...wr]},sb=["objects"];let Rp=class r2 extends V1(Y1){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return r2.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new i2(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];const s=super.insertAt(t,...i);return i.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(js("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?z1():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(t,e){return this.setDimensions({width:t},e)}setHeight(t,e){return this.setDimensions({height:t},e)}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const n=$({width:this.width,height:this.height},t);this.elements.setDimensions(n,this.getRetinaScaling()),this.hasLostContext=!0,this.width=n.width,this.height=n.height}i||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const i=t,n=[...this.viewportTransform],s=ir(t,Ar(n));n[0]=e,n[3]=e;const o=ir(s,n);n[4]+=i.x-o.x,n[5]+=i.y-o.y,this.setViewportTransform(n)}setZoom(t){this.zoomToPoint(new ut(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new ut(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=mc((()=>this.renderAndReset())))}calcViewportBoundaries(){const t=this.width,e=this.height,i=Ar(this.viewportTransform),n=ir({x:0,y:0},i),s=ir({x:t,y:e},i),o=n.min(s),a=n.max(s);return this.vptCoords={tl:o,tr:new ut(a.x,o.y),bl:new ut(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(G1(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const i=this.viewportTransform,n=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality="best",this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),n&&(n._set("canvas",this),n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,n)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const i=this.viewportTransform;t.save(),t.transform(...i),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let i=0,n=e.length;i<n;++i)e[i]&&e[i].render(t)}_renderBackgroundOrOverlay(t,e){const i=this["".concat(e,"Color")],n=this["".concat(e,"Image")],s=this.viewportTransform,o=this["".concat(e,"Vpt")];if(!i&&!n)return;const a=ln(i);if(i){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=a?i.toLive(t):i,o&&t.transform(...s),a){t.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);const l=i.gradientTransform||i.patternTransform;l&&t.transform(...l)}t.fill(),t.restore()}if(n){t.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&t.transform(...s),n.render(t),this.skipOffscreen=l,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new ut(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new ut(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new ut(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new ut(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new ut(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return ir(this.getCenterPoint(),Ar(this.viewportTransform))}_centerObject(t,e){t.setXY(e,ue,ue),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const i=this.clipPath,n=i&&!i.excludeFromExport?this._toObject(i,t,e):null;return $($($({version:Yf},aa(this,e)),{},{objects:this._objects.filter((s=>!s.excludeFromExport)).map((s=>this._toObject(s,t,e)))},this.__serializeBgOverlay(t,e)),n?{clipPath:n}:null)}_toObject(t,e,i){let n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);const s=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=!!n),s}__serializeBgOverlay(t,e){const i={},n=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return ln(o)?o.excludeFromExport||(i.background=o.toObject(e)):o&&(i.background=o),ln(a)?a.excludeFromExport||(i.overlay=a.toObject(e)):a&&(i.overlay=a),n&&!n.excludeFromExport&&(i.backgroundImage=this._toObject(n,t,e)),s&&!s.excludeFromExport&&(i.overlayImage=this._toObject(s,t,e)),i}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this.clipPath&&i.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this.clipPath&&i.push(`</g>
`),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const i=e.width||"".concat(this.width),n=e.height||"".concat(this.height),s=Oe.NUM_FRACTION_DIGITS,o=e.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(Ue(-l[4]/l[0],s)," ").concat(Ue(-l[5]/l[3],s)," ").concat(Ue(this.width/l[0],s)," ").concat(Ue(this.height/l[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',n,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Yf,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId="CLIPPATH_".concat(bo()),'<clipPath id="'.concat(e.clipPathId,`" >
`).concat(e.toClipPathSVG(t.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((t=>{const e=this["".concat(t,"Color")];if(ln(e)){const i=this["".concat(t,"Vpt")],n=this.viewportTransform,s={isType:()=>!1,width:this.width/(i?n[0]:1),height:this.height/(i?n[3]:1)};return e.toSVG(s,{additionalTransform:i?tl(n):""})}})).join("")}createSVGFontFacesMarkup(){const t=[],e={},i=Oe.fontPaths;this._objects.forEach((function s(o){t.push(o),Jh(o)&&o._objects.forEach(s)})),t.forEach((s=>{if(!(o=s)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:l}=s;!e[l]&&i[l]&&(e[l]=!0,a&&Object.values(a).forEach((c=>{Object.values(c).forEach((h=>{let{fontFamily:p=""}=h;!e[p]&&i[p]&&(e[p]=!0)}))})))}));const n=Object.keys(e).map((s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(i[s],`');
		}
`))).join("");return n?`	<style type="text/css"><![CDATA[
`.concat(n,`]]></style>
`):""}_setSVGObjects(t,e){this.forEachObject((i=>{i.excludeFromExport||this._setSVGObject(t,i,e)}))}_setSVGObject(t,e,i){t.push(e.toSVG(i))}_setSVGBgOverlayImage(t,e,i){const n=this[e];n&&!n.excludeFromExport&&n.toSVG&&t.push(n.toSVG(i))}_setSVGBgOverlayColor(t,e){const i=this["".concat(e,"Color")];if(i)if(ln(i)){const n=i.repeat||"",s=this.width,o=this.height,a=this["".concat(e,"Vpt")]?tl(Ar(this.viewportTransform)):"";t.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(o/2,')" x="').concat(i.offsetX-s/2,'" y="').concat(i.offsetY-o/2,'" width="').concat(n!=="repeat-y"&&n!=="no-repeat"||!d0(i)?s:i.source.width,'" height="').concat(n!=="repeat-x"&&n!=="no-repeat"||!d0(i)?o:i.source.height,'" fill="url(#SVGID_').concat(i.id,`)"></rect>
`))}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new $n("`json` is undefined"));const n=typeof t=="string"?JSON.parse(t):t,{objects:s=[]}=n,o=Ke(n,sb),{backgroundImage:a,background:l,overlayImage:c,overlay:h,clipPath:p}=o,m=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Qa(s,{reviver:e,signal:i}),Ic({backgroundImage:a,backgroundColor:l,overlayImage:c,overlayColor:h,clipPath:p},{signal:i})]).then((f=>{let[b,y]=f;return this.clear(),this.add(...b),this.set(o),this.set(y),this.renderOnAddRemove=m,this}))}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Yr(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:i=1,multiplier:n=1,enableRetinaScaling:s=!1}=t,o=n*(s?this.getRetinaScaling():1);return Mp(this.toCanvasElement(o,t),e,i)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:i=1,multiplier:n=1,enableRetinaScaling:s=!1}=t,o=n*(s?this.getRetinaScaling():1);return Ip(this.toCanvasElement(o,t),e,i)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:i,left:n,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(e||this.width)*t,l=(i||this.height)*t,c=this.getZoom(),h=this.width,p=this.height,m=this.skipControlsDrawing,f=c*t,b=this.viewportTransform,y=[f,0,0,f,(b[4]-(n||0))*t,(b[5]-(s||0))*t],_=this.enableRetinaScaling,x=Yr({width:a,height:l}),E=o?this._objects.filter((I=>o(I))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=y,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),E),this.viewportTransform=b,this.width=h,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=_,this.skipControlsDrawing=m,x}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),mu.cancelByCanvas(this),this.disposed=!0,new Promise(((t,e)=>{const i=()=>{this.destroy(),t(!0)};i.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=i:i()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((t=>t.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};G(Rp,"ownDefaults",nb);const ob=["touchstart","touchmove","touchend"],n2=r=>{const t=Q1(r.target),e=(function(i){const n=i.changedTouches;return n&&n[0]?n[0]:i})(r);return new ut(e.clientX+t.left,e.clientY+t.top)},vu=r=>ob.includes(r.type)||r.pointerType==="touch",p0=r=>{r.preventDefault(),r.stopPropagation()},Qn=r=>{let t=0,e=0,i=0,n=0;for(let s=0,o=r.length;s<o;s++){const{x:a,y:l}=r[s];(a>i||!s)&&(i=a),(a<t||!s)&&(t=a),(l>n||!s)&&(n=l),(l<e||!s)&&(e=l)}return{left:t,top:e,width:i-t,height:n-e}},ab=["translateX","translateY","scaleX","scaleY"],s2=(r,t)=>el(r,yi(t,r.calcOwnMatrix())),el=(r,t)=>{const e=ta(t),{translateX:i,translateY:n,scaleX:s,scaleY:o}=e,a=Ke(e,ab),l=new ut(i,n);r.flipX=!1,r.flipY=!1,Object.assign(r,a),r.set({scaleX:s,scaleY:o}),r.setPositionByOrigin(l,ue,ue)},o2=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},qp=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),Qu=(r,t,e)=>{const i=r/2,n=t/2,s=[new ut(-i,-n),new ut(i,-n),new ut(-i,n),new ut(i,n)].map((a=>a.transform(e))),o=Qn(s);return new ut(o.width,o.height)},jc=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wr;return yi(Ar(arguments.length>1&&arguments[1]!==void 0?arguments[1]:wr),r)},Zo=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wr;return r.transform(jc(t,e))},a2=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wr;return r.transform(jc(t,e),!0)},$f=(r,t,e)=>{const i=jc(t,e);return el(r,yi(i,r.calcOwnMatrix())),i},l2=(r,t)=>{var e;const{transform:{target:i}}=t;(e=i.canvas)===null||e===void 0||e.fire("object:".concat(r),$($({},t),{},{target:i})),i.fire(r,t)},lb={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Li=r=>typeof r=="string"?lb[r]:r-.5,wu="not-allowed";function c2(r){return Li(r.originX)===Li(ue)&&Li(r.originY)===Li(ue)}function g0(r){return .5-Li(r)}const Ln=(r,t)=>r[t],h2=(r,t,e,i)=>({e:r,transform:t,pointer:new ut(e,i)});function u2(r,t){const e=r.getTotalAngle()+ns(Math.atan2(t.y,t.x))+360;return Math.round(e%360/45)}function zp(r,t,e,i,n){var s;let{target:o,corner:a}=r;const l=o.controls[a],c=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,h=o.padding/c,p=(function(m,f,b,y){const _=m.getRelativeCenterPoint(),x=b!==void 0&&y!==void 0?m.translateToGivenOrigin(_,ue,ue,b,y):new ut(m.left,m.top);return(m.angle?f.rotate(-ci(m.angle),_):f).subtract(x)})(o,new ut(i,n),t,e);return p.x>=h&&(p.x-=h),p.x<=-h&&(p.x+=h),p.y>=h&&(p.y-=h),p.y<=h&&(p.y+=h),p.x-=l.offsetX,p.y-=l.offsetY,p}const cb=(r,t,e,i)=>{const{target:n,offsetX:s,offsetY:o}=t,a=e-s,l=i-o,c=!Ln(n,"lockMovementX")&&n.left!==a,h=!Ln(n,"lockMovementY")&&n.top!==l;return c&&n.set(je,a),h&&n.set(Lr,l),(c||h)&&l2(H1,h2(r,t,e,i)),c||h},bu=r=>r.replace(/\s+/g," "),m0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},$d=(r,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+6*(t-r)*e:e<.5?t:e<2/3?r+(t-r)*(2/3-e)*6:r),v0=(r,t,e,i)=>{r/=255,t/=255,e/=255;const n=Math.max(r,t,e),s=Math.min(r,t,e);let o,a;const l=(n+s)/2;if(n===s)o=a=0;else{const c=n-s;switch(a=l>.5?c/(2-n-s):c/(n+s),n){case r:o=(t-e)/c+(t<e?6:0);break;case t:o=(e-r)/c+2;break;case e:o=(r-t)/c+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),i]},w0=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Th=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),b0=r=>{let[t,e,i,n=1]=r;const s=Math.round(.3*t+.59*e+.11*i);return[s,s,s,n]};let Er=class er{constructor(t){if(G(this,"isUnrecognised",!1),t)if(t instanceof er)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,i,n,s=1]=t;this.setSource([e,i,n,s])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in m0&&(t=m0[t]),t==="transparent"?[255,255,255,0]:er.sourceFromHex(t)||er.sourceFromRgb(t)||er.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,i]=this.getSource();return"rgb(".concat(t,",").concat(e,",").concat(i,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[t,e,i]=v0(...this.getSource());return"hsl(".concat(t,",").concat(e,"%,").concat(i,"%)")}toHsla(){const[t,e,i,n]=v0(...this.getSource());return"hsla(".concat(t,",").concat(e,"%,").concat(i,"%,").concat(n,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,i,n]=this.getSource();return"".concat(Th(t)).concat(Th(e)).concat(Th(i)).concat(Th(Math.round(255*n)))}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(b0(this.getSource())),this}toBlackWhite(t){const[e,,,i]=b0(this.getSource()),n=e<(t||127)?0:255;return this.setSource([n,n,n,i]),this}overlayWith(t){t instanceof er||(t=new er(t));const e=this.getSource(),i=t.getSource(),[n,s,o]=e.map(((a,l)=>Math.round(.5*a+.5*i[l])));return this.setSource([n,s,o,e[3]]),this}static fromRgb(t){return er.fromRgba(t)}static fromRgba(t){return new er(er.sourceFromRgb(t))}static sourceFromRgb(t){const e=bu(t).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(e){const[i,n,s]=e.slice(1,4).map((o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a}));return[i,n,s,w0(e[4])]}}static fromHsl(t){return er.fromHsla(t)}static fromHsla(t){return new er(er.sourceFromHsl(t))}static sourceFromHsl(t){const e=bu(t).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!e)return;const i=(er.parseAngletoDegrees(e[1])%360+360)%360/360,n=parseFloat(e[2])/100,s=parseFloat(e[3])/100;let o,a,l;if(n===0)o=a=l=s;else{const c=s<=.5?s*(n+1):s+n-s*n,h=2*s-c;o=$d(h,c,i+1/3),a=$d(h,c,i),l=$d(h,c,i-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),w0(e[4])]}static fromHex(t){return new er(er.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let i;i=e.length<=4?e.split("").map((l=>l+l)):e.match(/.{2}/g);const[n,s,o,a=255]=i.map((l=>parseInt(l,16)));return[n,s,o,a/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),i=parseFloat(e);return e.includes("rad")?ns(i):e.includes("turn")?360*i:i}};const fr=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Op;const e=/\D{0,2}$/.exec(r),i=parseFloat(r),n=Oe.DPI;switch(e?.[0]){case"mm":return i*n/25.4;case"cm":return i*n/2.54;case"in":return i*n;case"pt":return i*n/72;case"pc":return i*n/72*12;case"em":return i*t;default:return i}},Hp=r=>{const[t,e]=r.trim().split(" "),[i,n]=(s=t)&&s!==mr?[s.slice(1,4),s.slice(5,8)]:s===mr?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:e||"meet",alignX:i,alignY:n}},Tc=function(r,t){let e,i,n=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e="url(#SVGID_".concat(t.id,")");else{const s=new Er(t),o=s.getAlpha();e=s.toRgb(),o!==1&&(i=o.toString())}else e="none";return n?"".concat(r,": ").concat(e,"; ").concat(i?"".concat(r,"-opacity: ").concat(i,"; "):""):"".concat(r,'="').concat(e,'" ').concat(i?"".concat(r,'-opacity="').concat(i,'" '):"")};class d2{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):mr,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",h=this.visible?"":" visibility: hidden;",p=t?"":this.getSvgFilter(),m=Tc(Ti,this.fill);return[Tc(vr,this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",m,"fill-rule: ",e,"; ","opacity: ",c,";",p,h].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=t?this.calcTransformMatrix():this.calcOwnMatrix(),n='transform="'.concat(tl(i));return"".concat(n).concat(e,'" ')}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),s=t.indexOf("COMMON_PARTS");return t[s]=n,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:i,withShadow:n,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=e?"":'style="'.concat(this.getSvgStyles(),'" '),a=n?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=l&&l.absolutePositioned,p=this.stroke,m=this.fill,f=this.shadow,b=[],y=t.indexOf("COMMON_PARTS");let _;l&&(l.clipPathId="CLIPPATH_".concat(bo()),_='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(i),`</clipPath>
`)),h&&b.push("<g ",a,this.getSvgCommons(),` >
`),b.push("<g ",this.getSvgTransform(!1),h?"":a+this.getSvgCommons(),` >
`);const x=[o,c,e?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return t[y]=x,ln(m)&&b.push(m.toSVG(this)),ln(p)&&b.push(p.toSVG(this)),f&&b.push(f.toSVG(this)),l&&b.push(_),b.push(t.join("")),b.push(`</g>
`),h&&b.push(`</g>
`),i?i(b.join("")):b.join("")}addPaintOrder(){return this.paintFirst!==Ti?' paint-order="'.concat(this.paintFirst,'" '):""}}function td(r){return new RegExp("^("+r.join("|")+")\\b","i")}const ea="textDecorationThickness",f2=["fontSize","fontWeight","fontFamily","fontStyle"],p2=["underline","overline","linethrough"],g2=[...f2,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],m2=[...g2,...p2,"textBackgroundColor","direction",ea],hb=[...f2,...p2,vr,"strokeWidth",Ti,"deltaY","textBackgroundColor",ea],ub={_reNewline:Pp,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:je,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:je,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[ea]:66.667},Yn="justify",yu="justify-left",wc="justify-right",bc="justify-center";var y0,x0,_0;const An=String.raw(y0||(y0=as(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),Kd=String.raw(x0||(x0=as(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),Kf="http://www.w3.org/2000/svg",db=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+An+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+An+"))?\\s+(.*)"),fb={cx:je,x:je,r:"radius",cy:Lr,y:Lr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":ea},Zd="font-size",Jd="clip-path",pb=td(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),gb=td(["symbol","image","marker","pattern","view","svg"]),S0=td(["symbol","g","a","svg","clipPath","defs"]),C0=new RegExp(String.raw(_0||(_0=as(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),An,Kd,An,Kd,An,Kd,An)),mb=new ut(1,0),v2=new ut,Up=(r,t)=>r.rotate(t),xu=(r,t)=>new ut(t).subtract(r),_u=r=>r.distanceFrom(v2),Su=(r,t)=>Math.atan2(Ha(r,t),b2(r,t)),w2=r=>Su(mb,r),ed=r=>r.eq(v2)?r:r.scalarDivide(_u(r)),Wp=function(r){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return ed(new ut(-r.y,r.x).scalarMultiply(t?1:-1))},Ha=(r,t)=>r.x*t.y-r.y*t.x,b2=(r,t)=>r.x*t.x+r.y*t.y,Zf=(r,t,e)=>{if(r.eq(t)||r.eq(e))return!0;const i=Ha(t,e),n=Ha(t,r),s=Ha(e,r);return i>=0?n>=0&&s<=0:!(n<=0&&s>=0)},k0="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",A0=new RegExp("(?:\\s|^)"+k0+k0+"("+An+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class ts{constructor(t){const e=typeof t=="string"?ts.parseShadow(t):t;Object.assign(this,ts.ownDefaults,e),this.id=bo()}static parseShadow(t){const e=t.trim(),[,i=0,n=0,s=0]=(A0.exec(e)||[]).map((o=>parseFloat(o)||0));return{color:(e.replace(A0,"")||"rgb(0,0,0)").trim(),offsetX:i,offsetY:n,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=Up(new ut(this.offsetX,this.offsetY),ci(-t.angle)),i=new Er(this.color);let n=40,s=40;return t.width&&t.height&&(n=100*Ue((Math.abs(e.x)+this.blur)/t.width,Oe.NUM_FRACTION_DIGITS)+20,s=100*Ue((Math.abs(e.y)+this.blur)/t.height,Oe.NUM_FRACTION_DIGITS)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(n,'%" width="').concat(100+2*n,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Ue(this.blur?this.blur/2:0,Oe.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Ue(e.x,Oe.NUM_FRACTION_DIGITS),'" dy="').concat(Ue(e.y,Oe.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(i.toRgb(),'" flood-opacity="').concat(i.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=ts.ownDefaults;return this.includeDefaultValues?t:Bp(t,((i,n)=>i!==e[n]))}static async fromObject(t){return new this(t)}}G(ts,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),G(ts,"type","shadow"),Dt.setClass(ts,"shadow");const ia=(r,t,e)=>Math.max(r,Math.min(t,e)),vb=[Lr,je,br,Vr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",al,ll],Rs=[Ti,vr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],wb={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:je,originY:Lr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Ti,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Qd=(r,t,e,i)=>(r<Math.abs(t)?(r=t,i=e/4):i=t===0&&r===0?e/Fs*Math.asin(1):e/Fs*Math.asin(t/r),{a:r,c:t,p:e,s:i}),L0=(r,t,e,i,n)=>r*Math.pow(2,10*(i-=1))*Math.sin((i*n-t)*Fs/e),y2=(r,t,e,i)=>-e*Math.cos(r/i*wo)+e+t,Jf=(r,t,e,i)=>(r/=i)<1/2.75?e*(7.5625*r*r)+t:r<2/2.75?e*(7.5625*(r-=1.5/2.75)*r+.75)+t:r<2.5/2.75?e*(7.5625*(r-=2.25/2.75)*r+.9375)+t:e*(7.5625*(r-=2.625/2.75)*r+.984375)+t,T0=(r,t,e,i)=>e-Jf(i-r,0,e,i)+t;var bb=Object.freeze({__proto__:null,defaultEasing:y2,easeInBack:function(r,t,e,i){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return e*(r/=i)*r*((n+1)*r-n)+t},easeInBounce:T0,easeInCirc:(r,t,e,i)=>-e*(Math.sqrt(1-(r/=i)*r)-1)+t,easeInCubic:(r,t,e,i)=>e*(r/i)**3+t,easeInElastic:(r,t,e,i)=>{const n=e;let s=0;if(r===0)return t;if((r/=i)===1)return t+e;s||(s=.3*i);const{a:o,s:a,p:l}=Qd(n,e,s,1.70158);return-L0(o,a,l,r,i)+t},easeInExpo:(r,t,e,i)=>r===0?t:e*2**(10*(r/i-1))+t,easeInOutBack:function(r,t,e,i){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=i/2)<1?e/2*(r*r*((1+(n*=1.525))*r-n))+t:e/2*((r-=2)*r*((1+(n*=1.525))*r+n)+2)+t},easeInOutBounce:(r,t,e,i)=>r<i/2?.5*T0(2*r,0,e,i)+t:.5*Jf(2*r-i,0,e,i)+.5*e+t,easeInOutCirc:(r,t,e,i)=>(r/=i/2)<1?-e/2*(Math.sqrt(1-r**2)-1)+t:e/2*(Math.sqrt(1-(r-=2)*r)+1)+t,easeInOutCubic:(r,t,e,i)=>(r/=i/2)<1?e/2*r**3+t:e/2*((r-2)**3+2)+t,easeInOutElastic:(r,t,e,i)=>{const n=e;let s=0;if(r===0)return t;if((r/=i/2)===2)return t+e;s||(s=i*(.3*1.5));const{a:o,s:a,p:l,c}=Qd(n,e,s,1.70158);return r<1?-.5*L0(o,a,l,r,i)+t:o*Math.pow(2,-10*(r-=1))*Math.sin((r*i-a)*Fs/l)*.5+c+t},easeInOutExpo:(r,t,e,i)=>r===0?t:r===i?t+e:(r/=i/2)<1?e/2*2**(10*(r-1))+t:e/2*-(2**(-10*--r)+2)+t,easeInOutQuad:(r,t,e,i)=>(r/=i/2)<1?e/2*r**2+t:-e/2*(--r*(r-2)-1)+t,easeInOutQuart:(r,t,e,i)=>(r/=i/2)<1?e/2*r**4+t:-e/2*((r-=2)*r**3-2)+t,easeInOutQuint:(r,t,e,i)=>(r/=i/2)<1?e/2*r**5+t:e/2*((r-2)**5+2)+t,easeInOutSine:(r,t,e,i)=>-e/2*(Math.cos(Math.PI*r/i)-1)+t,easeInQuad:(r,t,e,i)=>e*(r/=i)*r+t,easeInQuart:(r,t,e,i)=>e*(r/=i)*r**3+t,easeInQuint:(r,t,e,i)=>e*(r/i)**5+t,easeInSine:(r,t,e,i)=>-e*Math.cos(r/i*wo)+e+t,easeOutBack:function(r,t,e,i){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return e*((r=r/i-1)*r*((n+1)*r+n)+1)+t},easeOutBounce:Jf,easeOutCirc:(r,t,e,i)=>e*Math.sqrt(1-(r=r/i-1)*r)+t,easeOutCubic:(r,t,e,i)=>e*((r/i-1)**3+1)+t,easeOutElastic:(r,t,e,i)=>{const n=e;let s=0;if(r===0)return t;if((r/=i)===1)return t+e;s||(s=.3*i);const{a:o,s:a,p:l,c}=Qd(n,e,s,1.70158);return o*2**(-10*r)*Math.sin((r*i-a)*Fs/l)+c+t},easeOutExpo:(r,t,e,i)=>r===i?t+e:e*-(2**(-10*r/i)+1)+t,easeOutQuad:(r,t,e,i)=>-e*(r/=i)*(r-2)+t,easeOutQuart:(r,t,e,i)=>-e*((r=r/i-1)*r**3-1)+t,easeOutQuint:(r,t,e,i)=>e*((r/i-1)**5+1)+t,easeOutSine:(r,t,e,i)=>e*Math.sin(r/i*wo)+t});const yb=()=>!1;class Vp{constructor(t){let{startValue:e,byValue:i,duration:n=500,delay:s=0,easing:o=y2,onStart:a=Ko,onChange:l=Ko,onComplete:c=Ko,abort:h=yb,target:p}=t;G(this,"_state","pending"),G(this,"durationProgress",0),G(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=n,this.delay=s,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=h,this.target=p,this.startValue=e,this.byValue=i,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>mc(t)),this.delay):mc(t)}tick(t){const e=(t||+new Date)-this.startTime,i=Math.min(e,this.duration);this.durationProgress=i/this.duration;const{value:n,valueProgress:s}=this.calculate(i);this.value=Object.freeze(n),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),mc(this.tick)))}register(){mu.push(this)}unregister(){mu.remove(this)}abort(){this._state="aborted",this.unregister()}}const xb=["startValue","endValue"];class _b extends Vp{constructor(t){let{startValue:e=0,endValue:i=100}=t;super($($({},Ke(t,xb)),{},{startValue:e,byValue:i-e}))}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}const Sb=["startValue","endValue"];class Cb extends Vp{constructor(t){let{startValue:e=[0],endValue:i=[100]}=t;super($($({},Ke(t,Sb)),{},{startValue:e,byValue:i.map(((n,s)=>n-e[s]))}))}calculate(t){const e=this.startValue.map(((i,n)=>this.easing(t,i,this.byValue[n],this.duration,n)));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const kb=["startValue","endValue","easing","onChange","onComplete","abort"],Ab=(r,t,e,i)=>t+e*(1-Math.cos(r/i*wo)),tf=r=>r&&((t,e,i)=>r(new Er(t).toRgba(),e,i));class Lb extends Vp{constructor(t){let{startValue:e,endValue:i,easing:n=Ab,onChange:s,onComplete:o,abort:a}=t,l=Ke(t,kb);const c=new Er(e).getSource(),h=new Er(i).getSource();super($($({},l),{},{startValue:c,byValue:h.map(((p,m)=>p-c[m])),easing:n,onChange:tf(s),onComplete:tf(o),abort:tf(a)}))}calculate(t){const[e,i,n,s]=this.startValue.map(((a,l)=>this.easing(t,a,this.byValue[l],this.duration,l))),o=[...[e,i,n].map(Math.round),ia(0,s,1)];return{value:o,valueProgress:o.map(((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0)).find((a=>a!==0))||0}}}function Yp(r){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(r)?new Cb(r):new _b(r);return t.start(),t}function x2(r){const t=new Lb(r);return t.start(),t}class ri{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some((e=>e.eq(t)))}append(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.points=this.points.concat(e.filter((n=>!this.includes(n)))),this}static isPointContained(t,e,i){let n=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(i))return t.eq(e);if(e.x===i.x)return t.x===e.x&&(n||t.y>=Math.min(e.y,i.y)&&t.y<=Math.max(e.y,i.y));if(e.y===i.y)return t.y===e.y&&(n||t.x>=Math.min(e.x,i.x)&&t.x<=Math.max(e.x,i.x));{const s=xu(e,i),o=xu(e,t).divide(s);return n?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(t,e){const i=new ut(t).setX(Math.min(t.x-1,...e.map((s=>s.x))));let n=0;for(let s=0;s<e.length;s++){const o=this.intersectSegmentSegment(e[s],e[(s+1)%e.length],t,i);if(o.includes(t))return!0;n+=+(o.status==="Intersection")}return n%2==1}static intersectLineLine(t,e,i,n){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=e.x-t.x,l=e.y-t.y,c=n.x-i.x,h=n.y-i.y,p=t.x-i.x,m=t.y-i.y,f=c*m-h*p,b=a*m-l*p,y=h*a-c*l;if(y!==0){const _=f/y,x=b/y;return(s||0<=_&&_<=1)&&(o||0<=x&&x<=1)?new ri("Intersection").append(new ut(t.x+_*a,t.y+_*l)):new ri}if(f===0||b===0){const _=s||o||ri.isPointContained(t,i,n)||ri.isPointContained(e,i,n)||ri.isPointContained(i,t,e)||ri.isPointContained(n,t,e);return new ri(_?"Coincident":void 0)}return new ri("Parallel")}static intersectSegmentLine(t,e,i,n){return ri.intersectLineLine(t,e,i,n,!1,!0)}static intersectSegmentSegment(t,e,i,n){return ri.intersectLineLine(t,e,i,n,!1,!1)}static intersectLinePolygon(t,e,i){let n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new ri,o=i.length;for(let a,l,c,h=0;h<o;h++){if(a=i[h],l=i[(h+1)%o],c=ri.intersectLineLine(t,e,a,l,n,!1),c.status==="Coincident")return c;s.append(...c.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(t,e,i){return ri.intersectLinePolygon(t,e,i,!1)}static intersectPolygonPolygon(t,e){const i=new ri,n=t.length,s=[];for(let o=0;o<n;o++){const a=t[o],l=t[(o+1)%n],c=ri.intersectSegmentPolygon(a,l,e);c.status==="Coincident"?(s.push(c),i.append(a,l)):i.append(...c.points)}return s.length>0&&s.length===t.length?new ri("Coincident"):(i.points.length>0&&(i.status="Intersection"),i)}static intersectPolygonRectangle(t,e,i){const n=e.min(i),s=e.max(i),o=new ut(s.x,n.y),a=new ut(n.x,s.y);return ri.intersectPolygonPolygon(t,[n,o,s,a])}}class Tb extends Y1{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?ir(t,this.group.calcTransformMatrix()):t}setXY(t,e,i){this.group&&(t=ir(t,Ar(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,i)}getRelativeXY(){return new ut(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,i)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:i,bl:n}=this.aCoords||(this.aCoords=this.calcACoords()),s=[t,e,i,n];if(this.group){const o=this.group.calcTransformMatrix();return s.map((a=>ir(a,o)))}return s}intersectsWithRect(t,e){return ri.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=ri.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every((e=>t.containsPoint(e)))}isContainedWithinRect(t,e){const{left:i,top:n,width:s,height:o}=this.getBoundingRect();return i>=t.x&&i+s<=e.x&&n>=t.y&&n+o<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return ri.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some((i=>i.x<=e.x&&i.x>=t.x&&i.y<=e.y&&i.y>=t.y))||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every((i=>(i.x>=e.x||i.x<=t.x)&&(i.y>=e.y||i.y<=t.y)))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return Qn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(br,t),this._set(Vr,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?ns(K1(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||wr.concat()}calcACoords(){const t=oa({angle:this.angle}),{x:e,y:i}=this.getRelativeCenterPoint(),n=cl(e,i),s=yi(n,t),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:ir({x:-a,y:-l},s),tr:ir({x:a,y:-l},s),bl:ir({x:-a,y:l},s),br:ir({x:a,y:l},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Li(this.originX),Li(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const i=this.transformMatrixKey(t),n=this.matrixCache;return n&&n.key.every(((s,o)=>s===i[o]))?n.value:(this.group&&(e=yi(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:i,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key===t)return e.value;const i=this.getRelativeCenterPoint(),n={angle:this.angle,translateX:i.x,translateY:i.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=J1(n);return this.ownMatrixCache={key:t,value:s},s}_getNonTransformedDimensions(){return new ut(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=$({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},t),i=e.strokeWidth;let n=i,s=0;this.strokeUniform&&(n=0,s=i);const o=e.width+n,a=e.height+n;let l;return l=e.skewX===0&&e.skewY===0?new ut(o*e.scaleX,a*e.scaleY):Qu(o,a,Mc(e)),l.scalarAdd(s)}translateToGivenOrigin(t,e,i,n,s){let o=t.x,a=t.y;const l=Li(n)-Li(e),c=Li(s)-Li(i);if(l||c){const h=this._getTransformedDimensions();o+=l*h.x,a+=c*h.y}return new ut(o,a)}translateToCenterPoint(t,e,i){if(e===ue&&i===ue)return t;const n=this.translateToGivenOrigin(t,e,i,ue,ue);return this.angle?n.rotate(ci(this.angle),t):n}translateToOriginPoint(t,e,i){const n=this.translateToGivenOrigin(t,ue,ue,e,i);return this.angle?n.rotate(ci(this.angle),t):n}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?ir(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new ut(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,i){const n=this.translateToCenterPoint(t,e,i),s=this.translateToOriginPoint(n,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),je,Lr)}}const Eb=["type"],Ob=["extraParam"];let Es=class Qh extends Tb{static getDefaults(){return Qh.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){js("warn","Setting type has no effect",t)}constructor(t){super(),G(this,"_cacheContext",null),Object.assign(this,Qh.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=rs(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,i=t.height,n=Oe.maxCacheSideLimit,s=Oe.minCacheSideLimit;if(e<=n&&i<=n&&e*i<=Oe.perfLimitSizeTotal)return e<s&&(t.width=s),i<s&&(t.height=s),t;const o=e/i,[a,l]=gc.limitDimsByArea(o),c=ia(s,a,n),h=ia(s,l,n);return e>c&&(t.zoomX/=e/c,t.width=c,t.capped=!0),i>h&&(t.zoomY/=i/h,t.height=h,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),i=e.x*t.x/this.scaleX,n=e.y*t.y/this.scaleY;return{width:Math.ceil(i+2),height:Math.ceil(n+2),zoomX:t.x,zoomY:t.y,x:i,y:n}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:i,height:n,zoomX:s,zoomY:o,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),c=i!==t.width||n!==t.height,h=this.zoomX!==s||this.zoomY!==o;if(!t||!e)return!1;if(c||h){i!==t.width||n!==t.height?(t.width=i,t.height=n):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const p=a/2,m=l/2;return this.cacheTranslationX=Math.round(t.width/2-p)+p,this.cacheTranslationY=Math.round(t.height/2-m)+m,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(s,o),this.zoomX=s,this.zoomY=o,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,i=this.calcTransformMatrix(!e);t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}getObjectScaling(){if(!this.group)return new ut(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=ta(this.calcTransformMatrix());return new ut(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),i=this.getCanvasRetinaScaling();return t.scalarMultiply(e*i)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==br&&t!==Vr||(e=this._constrainScale(e)),t===br&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof ts||(e=new ts(e));const i=this[t]!==e;return this[t]=e,i&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||i&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:i,cacheTranslationX:n,cacheTranslationY:s}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:i,cacheTranslationX:n,cacheTranslationY:s,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===vr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,i){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(i,0,0),t.restore()}drawObject(t,e,i){const n=this.fill,s=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath,i),this.fill=n,this.stroke=s}createClipPathLayer(t,e){const i=Yr(e),n=i.getContext("2d");if(n.translate(e.cacheTranslationX,e.cacheTranslationY),n.scale(e.zoomX,e.zoomY),t._cacheCanvas=i,e.parentClipPaths.forEach((s=>{s.transform(n)})),e.parentClipPaths.push(t),t.absolutePositioned){const s=Ar(this.calcTransformMatrix());n.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return t.transform(n),t.drawObject(n,!0,e),i}_drawClipPath(t,e,i){if(!e)return;e._transformDone=!0;const n=this.createClipPathLayer(e,i);this.drawClipPathOnCache(t,e,n)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,i=this._cacheContext;return!(!e||!i||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&i&&!t&&(i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),i.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const i=e.stroke;i&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,ln(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(t,i):(t.strokeStyle=i.toLive(t),this._applyPatternGradientTransform(t,i)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:i}=e;i&&(ln(i)?(t.fillStyle=i.toLive(t),this._applyPatternGradientTransform(t,i)):t.fillStyle=i)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,i=this.canvas,n=this.getCanvasRetinaScaling(),[s,,,o]=i?.viewportTransform||wr,a=s*n,l=o*n,c=e.nonScaling?new ut(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*Oe.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,t.shadowOffsetX=e.offsetX*a*c.x,t.shadowOffsetY=e.offsetY*l*c.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!ln(e))return{offsetX:0,offsetY:0};const i=e.gradientTransform||e.patternTransform,n=-this.width/2+e.offsetX||0,s=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,n,s):t.transform(1,0,0,1,n,s),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:n,offsetY:s}}_renderPaintInOrder(t){this.paintFirst===vr?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var i;const n=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),o=n.x/this.scaleX/s,a=n.y/this.scaleY/s,l=Yr({width:Math.ceil(o),height:Math.ceil(a)}),c=l.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(o,0),c.lineTo(o,a),c.lineTo(0,a),c.closePath(),c.translate(o/2,a/2),c.scale(n.zoomX/this.scaleX/s,n.zoomY/this.scaleY/s),this._applyPatternGradientTransform(c,e),c.fillStyle=e.toLive(t),c.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(s*this.scaleX/n.zoomX,s*this.scaleY/n.zoomY),t.strokeStyle=(i=c.createPattern(l,"no-repeat"))!==null&&i!==void 0?i:"")}_findCenterFromElement(){return new ut(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(Dt.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=qp(this),i=this.group,n=this.shadow,s=Math.abs,o=t.enableRetinaScaling?z1():1,a=(t.multiplier||1)*o,l=t.canvasProvider||(E=>new Rp(E,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&o2(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&$f(this,this.getViewportTransform()),this.setCoords();const c=rs(),h=this.getBoundingRect(),p=this.shadow,m=new ut;if(p){const E=p.blur,I=p.nonScaling?new ut(1,1):this.getObjectScaling();m.x=2*Math.round(s(p.offsetX)+E)*s(I.x),m.y=2*Math.round(s(p.offsetY)+E)*s(I.y)}const f=h.width+m.x,b=h.height+m.y;c.width=Math.ceil(f),c.height=Math.ceil(b);const y=l(c);t.format==="jpeg"&&(y.backgroundColor="#fff"),this.setPositionByOrigin(new ut(y.width/2,y.height/2),ue,ue);const _=this.canvas;y._objects=[this],this.set("canvas",y),this.setCoords();const x=y.toCanvasElement(a||1,t);return this.set("canvas",_),this.shadow=n,i&&(this.group=i),this.set(e),this.setCoords(),y._objects=[],y.destroy(),x}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Mp(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ip(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:i,originY:n}=this;if(e){const{x:s,y:o}=this.getRelativeCenterPoint();this.originX=ue,this.originY=ue,this.left=s,this.top=o}if(this.set("angle",t),e){const{x:s,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),i,n);this.left=s,this.top=o,this.originX=i,this.originY=n}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){mu.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&is().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce(((i,n)=>{let[s,o]=n;return i[s]=this._animate(s,o,e),i}),{})}_animate(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=t.split("."),s=this.constructor.colorProperties.includes(n[n.length-1]),{abort:o,startValue:a,onChange:l,onComplete:c}=i,h=$($({},i),{},{target:this,startValue:a??n.reduce(((p,m)=>p[m]),this),endValue:e,abort:o?.bind(this),onChange:(p,m,f)=>{n.reduce(((b,y,_)=>(_===n.length-1&&(b[y]=p),b[y])),this),l&&l(p,m,f)},onComplete:(p,m,f)=>{this.setCoords(),c&&c(p,m,f)}});return s?x2(h):Yp(h)}isDescendantOf(t){const{parent:e,group:i}=this;return e===t||i===t||!!e&&e.isDescendantOf(t)||!!i&&i!==e&&i.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),i=t.getAncestors();if(e.length===0&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[t,...i.slice(0,i.length-1)],common:[this]};for(let n,s=0;s<e.length;s++){if(n=e[s],n===t)return{fork:[this,...e.slice(0,s)],otherFork:[],common:e.slice(s)};for(let o=0;o<i.length;o++){if(this===i[o])return{fork:[],otherFork:[t,...i.slice(0,o)],common:[this,...e]};if(n===i[o])return{fork:[this,...e.slice(0,s)],otherFork:[t,...i.slice(0,o)],common:e.slice(s)}}}return{fork:[this,...e],otherFork:[t,...i],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const i=e.common[0]||this.canvas;if(!i)return;const n=e.fork.pop(),s=e.otherFork.pop(),o=i._objects.indexOf(n),a=i._objects.indexOf(s);return o>-1&&o>a}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Qh.customProperties,this.constructor.customProperties||[]);let e;const i=Oe.NUM_FRACTION_DIGITS,{clipPath:n,fill:s,stroke:o,shadow:a,strokeDashArray:l,left:c,top:h,originX:p,originY:m,width:f,height:b,strokeWidth:y,strokeLineCap:_,strokeDashOffset:x,strokeLineJoin:E,strokeUniform:I,strokeMiterLimit:O,scaleX:V,scaleY:Z,angle:nt,flipX:W,flipY:M,opacity:J,visible:L,backgroundColor:N,fillRule:H,paintFirst:z,globalCompositeOperation:st,skewX:lt,skewY:ht}=this;n&&!n.excludeFromExport&&(e=n.toObject(t.concat("inverted","absolutePositioned")));const et=kt=>Ue(kt,i),dt=$($({},aa(this,t)),{},{type:this.constructor.type,version:Yf,originX:p,originY:m,left:et(c),top:et(h),width:et(f),height:et(b),fill:u0(s)?s.toObject():s,stroke:u0(o)?o.toObject():o,strokeWidth:et(y),strokeDashArray:l&&l.concat(),strokeLineCap:_,strokeDashOffset:x,strokeLineJoin:E,strokeUniform:I,strokeMiterLimit:et(O),scaleX:et(V),scaleY:et(Z),angle:et(nt),flipX:W,flipY:M,opacity:et(J),shadow:a&&a.toObject(),visible:L,backgroundColor:N,fillRule:H,paintFirst:z,globalCompositeOperation:st,skewX:et(lt),skewY:et(ht)},e?{clipPath:e}:null);return this.includeDefaultValues?dt:this._removeDefaultValues(dt)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),i=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return Bp(t,((n,s)=>{if(s===je||s===Lr||s==="type")return!0;const o=i[s];return n!==o&&!(Array.isArray(n)&&Array.isArray(o)&&n.length===0&&o.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(t){let e=Ke(t,Eb),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:n}=i,s=Ke(i,Ob);return Ic(e,s).then((o=>n?(delete o[n],new this(e[n],o)):new this(o)))}static fromObject(t,e){return this._fromObject(t,e)}};G(Es,"stateProperties",vb),G(Es,"cacheProperties",Rs),G(Es,"ownDefaults",wb),G(Es,"type","FabricObject"),G(Es,"colorProperties",[Ti,vr,"backgroundColor"]),G(Es,"customProperties",[]),Dt.setClass(Es),Dt.setClass(Es,"object");const hl=(r,t,e)=>(i,n,s,o)=>{const a=t(i,n,s,o);return a&&l2(r,$($({},h2(i,n,s,o)),e)),a};function ul(r){return(t,e,i,n)=>{const{target:s,originX:o,originY:a}=e,l=s.getRelativeCenterPoint(),c=s.translateToOriginPoint(l,o,a),h=r(t,e,i,n);return s.setPositionByOrigin(c,e.originX,e.originY),h}}const E0=hl(Lc,ul(((r,t,e,i)=>{const n=zp(t,t.originX,t.originY,e,i);if(Li(t.originX)===Li(ue)||Li(t.originX)===Li(mi)&&n.x<0||Li(t.originX)===Li(je)&&n.x>0){const{target:s}=t,o=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=c2(t)?2:1,l=s.width,c=Math.abs(n.x*a/s.scaleX)-o;return s.set("width",Math.max(c,1)),l!==s.width}return!1})));function Pb(r,t,e,i,n){i=i||{};const s=this.sizeX||i.cornerSize||n.cornerSize,o=this.sizeY||i.cornerSize||n.cornerSize,a=i.transparentCorners!==void 0?i.transparentCorners:n.transparentCorners,l=a?vr:Ti,c=!a&&(i.cornerStrokeColor||n.cornerStrokeColor);let h,p=t,m=e;r.save(),r.fillStyle=i.cornerColor||n.cornerColor||"",r.strokeStyle=i.cornerStrokeColor||n.cornerStrokeColor||"",s>o?(h=s,r.scale(1,o/s),m=e*s/o):o>s?(h=o,r.scale(s/o,1),p=t*o/s):h=s,r.beginPath(),r.arc(p,m,h/2,0,Fs,!1),r[l](),c&&r.stroke(),r.restore()}function Nb(r,t,e,i,n){i=i||{};const s=this.sizeX||i.cornerSize||n.cornerSize,o=this.sizeY||i.cornerSize||n.cornerSize,a=i.transparentCorners!==void 0?i.transparentCorners:n.transparentCorners,l=a?vr:Ti,c=!a&&(i.cornerStrokeColor||n.cornerStrokeColor),h=s/2,p=o/2;r.save(),r.fillStyle=i.cornerColor||n.cornerColor||"",r.strokeStyle=i.cornerStrokeColor||n.cornerStrokeColor||"",r.translate(t,e);const m=n.getTotalAngle();r.rotate(ci(m)),r["".concat(l,"Rect")](-h,-p,s,o),c&&r.strokeRect(-h,-p,s,o),r.restore()}class _n{constructor(t){G(this,"visible",!0),G(this,"actionName",Ku),G(this,"angle",0),G(this,"x",0),G(this,"y",0),G(this,"offsetX",0),G(this,"offsetY",0),G(this,"sizeX",0),G(this,"sizeY",0),G(this,"touchSizeX",0),G(this,"touchSizeY",0),G(this,"cursorStyle","crosshair"),G(this,"withConnection",!1),Object.assign(this,t)}shouldActivate(t,e,i,n){var s;let{tl:o,tr:a,br:l,bl:c}=n;return((s=e.canvas)===null||s===void 0?void 0:s.getActiveObject())===e&&e.isControlVisible(t)&&ri.isPointInPolygon(i,[o,a,l,c])}getActionHandler(t,e,i){return this.actionHandler}getMouseDownHandler(t,e,i){return this.mouseDownHandler}getMouseUpHandler(t,e,i){return this.mouseUpHandler}cursorStyleHandler(t,e,i){return e.cursorStyle}getActionName(t,e,i){return e.actionName}getVisibility(t,e){var i,n;return(i=(n=t._controlsVisibility)===null||n===void 0?void 0:n[e])!==null&&i!==void 0?i:this.visible}setVisibility(t,e,i){this.visible=t}positionHandler(t,e,i,n){return new ut(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,i,n,s,o){const a=Zu([cl(i,n),oa({angle:t}),Ju((s?this.touchSizeX:this.sizeX)||e,(s?this.touchSizeY:this.sizeY)||e)]);return{tl:new ut(-.5,-.5).transform(a),tr:new ut(.5,-.5).transform(a),br:new ut(.5,.5).transform(a),bl:new ut(-.5,.5).transform(a)}}render(t,e,i,n,s){((n=n||{}).cornerStyle||s.cornerStyle)==="circle"?Pb.call(this,t,e,i,n,s):Nb.call(this,t,e,i,n,s)}}const Db=(r,t,e)=>e.lockRotation?wu:t.cursorStyle,Mb=hl(U1,ul(((r,t,e,i)=>{let{target:n,ex:s,ey:o,theta:a,originX:l,originY:c}=t;const h=n.translateToOriginPoint(n.getRelativeCenterPoint(),l,c);if(Ln(n,"lockRotation"))return!1;const p=Math.atan2(o-h.y,s-h.x),m=Math.atan2(i-h.y,e-h.x);let f=ns(m-p+a);if(n.snapAngle&&n.snapAngle>0){const y=n.snapAngle,_=n.snapThreshold||y,x=Math.ceil(f/y)*y,E=Math.floor(f/y)*y;Math.abs(f-E)<_?f=E:Math.abs(f-x)<_&&(f=x)}f<0&&(f=360+f),f%=360;const b=n.angle!==f;return n.angle=f,b})));function _2(r,t){const e=t.canvas,i=r[e.uniScaleKey];return e.uniformScaling&&!i||!e.uniformScaling&&i}function S2(r,t,e){const i=Ln(r,"lockScalingX"),n=Ln(r,"lockScalingY");if(i&&n||!t&&(i||n)&&e||i&&t==="x"||n&&t==="y")return!0;const{width:s,height:o,strokeWidth:a}=r;return s===0&&a===0&&t!=="y"||o===0&&a===0&&t!=="x"}const Ib=["e","se","s","sw","w","nw","n","ne","e"],Kl=(r,t,e)=>{const i=_2(r,e);if(S2(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",i))return wu;const n=u2(e,t);return"".concat(Ib[n],"-resize")};function Gp(r,t,e,i){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=t.target,o=n.by,a=_2(r,s);let l,c,h,p,m,f;if(S2(s,o,a))return!1;if(t.gestureScale)c=t.scaleX*t.gestureScale,h=t.scaleY*t.gestureScale;else{if(l=zp(t,t.originX,t.originY,e,i),m=o!=="y"?Math.sign(l.x||t.signX||1):1,f=o!=="x"?Math.sign(l.y||t.signY||1):1,t.signX||(t.signX=m),t.signY||(t.signY=f),Ln(s,"lockScalingFlip")&&(t.signX!==m||t.signY!==f))return!1;if(p=s._getTransformedDimensions(),a&&!o){const _=Math.abs(l.x)+Math.abs(l.y),{original:x}=t,E=_/(Math.abs(p.x*x.scaleX/s.scaleX)+Math.abs(p.y*x.scaleY/s.scaleY));c=x.scaleX*E,h=x.scaleY*E}else c=Math.abs(l.x*s.scaleX/p.x),h=Math.abs(l.y*s.scaleY/p.y);c2(t)&&(c*=2,h*=2),t.signX!==m&&o!=="y"&&(t.originX=g0(t.originX),c*=-1,t.signX=m),t.signY!==f&&o!=="x"&&(t.originY=g0(t.originY),h*=-1,t.signY=f)}const b=s.scaleX,y=s.scaleY;return o?(o==="x"&&s.set(br,c),o==="y"&&s.set(Vr,h)):(!Ln(s,"lockScalingX")&&s.set(br,c),!Ln(s,"lockScalingY")&&s.set(Vr,h)),b!==s.scaleX||y!==s.scaleY}const Eh=hl($u,ul(((r,t,e,i)=>Gp(r,t,e,i)))),jb=hl($u,ul(((r,t,e,i)=>Gp(r,t,e,i,{by:"x"})))),Fb=hl($u,ul(((r,t,e,i)=>Gp(r,t,e,i,{by:"y"})))),Bb=["target","ex","ey","skewingSide"],ef={x:{counterAxis:"y",scale:br,skew:al,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Vr,skew:ll,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},Rb=["ns","nesw","ew","nwse"],qb=(r,t,e)=>{if(t.x!==0&&Ln(e,"lockSkewingY")||t.y!==0&&Ln(e,"lockSkewingX"))return wu;const i=u2(e,t)%4;return"".concat(Rb[i],"-resize")};function C2(r,t,e,i,n){const{target:s}=e,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:h}=ef[r];if(Ln(s,l))return!1;const{origin:p,flip:m}=ef[o],f=Li(e[p])*(s[m]?-1:1),b=-Math.sign(f)*(s[h]?-1:1),y=.5*-((s[c]===0&&zp(e,ue,ue,i,n)[r]>0||s[c]>0?1:-1)*b)+.5;return hl(W1,ul(((x,E,I,O)=>(function(V,Z,nt){let{target:W,ex:M,ey:J,skewingSide:L}=Z,N=Ke(Z,Bb);const{skew:H}=ef[V],z=nt.subtract(new ut(M,J)).divide(new ut(W.scaleX,W.scaleY))[V],st=W[H],lt=N[H],ht=Math.tan(ci(lt)),et=V==="y"?W._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:W._getTransformedDimensions({scaleX:1,scaleY:1}).y,dt=2*z*L/Math.max(et,1)+ht,kt=ns(Math.atan(dt));W.set(H,kt);const xt=st!==W[H];if(xt&&V==="y"){const{skewX:T,scaleX:q}=W,U=W._getTransformedDimensions({skewY:st}),X=W._getTransformedDimensions(),Q=T!==0?U.x/X.x:1;Q!==1&&W.set(br,Q*q)}return xt})(r,E,new ut(I,O)))))(t,$($({},e),{},{[a]:y,skewingSide:b}),i,n)}const zb=(r,t,e,i)=>C2("x",r,t,e,i),Hb=(r,t,e,i)=>C2("y",r,t,e,i);function id(r,t){return r[t.canvas.altActionKey]}const Oh=(r,t,e)=>{const i=id(r,e);return t.x===0?i?al:Vr:t.y===0?i?ll:br:""},Fa=(r,t,e)=>id(r,e)?qb(0,t,e):Kl(r,t,e),O0=(r,t,e,i)=>id(r,t.target)?Hb(r,t,e,i):jb(r,t,e,i),P0=(r,t,e,i)=>id(r,t.target)?zb(r,t,e,i):Fb(r,t,e,i),k2=()=>({ml:new _n({x:-.5,y:0,cursorStyleHandler:Fa,actionHandler:O0,getActionName:Oh}),mr:new _n({x:.5,y:0,cursorStyleHandler:Fa,actionHandler:O0,getActionName:Oh}),mb:new _n({x:0,y:.5,cursorStyleHandler:Fa,actionHandler:P0,getActionName:Oh}),mt:new _n({x:0,y:-.5,cursorStyleHandler:Fa,actionHandler:P0,getActionName:Oh}),tl:new _n({x:-.5,y:-.5,cursorStyleHandler:Kl,actionHandler:Eh}),tr:new _n({x:.5,y:-.5,cursorStyleHandler:Kl,actionHandler:Eh}),bl:new _n({x:-.5,y:.5,cursorStyleHandler:Kl,actionHandler:Eh}),br:new _n({x:.5,y:.5,cursorStyleHandler:Kl,actionHandler:Eh}),mtr:new _n({x:0,y:-.5,actionHandler:Mb,cursorStyleHandler:Db,offsetY:-40,withConnection:!0,actionName:Np})}),Ub=()=>({mr:new _n({x:.5,y:0,actionHandler:E0,cursorStyleHandler:Fa,actionName:Lc}),ml:new _n({x:-.5,y:0,actionHandler:E0,cursorStyleHandler:Fa,actionName:Lc})}),Wb=()=>$($({},k2()),Ub());class Ec extends Es{static getDefaults(){return $($({},super.getDefaults()),Ec.ownDefaults)}constructor(t){super(),Object.assign(this,this.constructor.createControls(),Ec.ownDefaults),this.setOptions(t)}static createControls(){return{controls:k2()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,i=e.target,n=e.action;if(this===i&&n&&n.startsWith(Ku))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const i=Object.entries(this.oCoords);for(let n=i.length-1;n>=0;n--){const[s,o]=i[n],a=this.controls[s];if(a.shouldActivate(s,this,t,e?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),i=cl(e.x,e.y),n=oa({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=yi(i,n),o=yi(t,s),a=yi(o,[1/t[0],0,0,1/t[3],0,0]),l=this.group?ta(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const c=this._calculateCurrentDimensions(l),h={};return this.forEachControl(((p,m)=>{const f=p.positionHandler(c,a,this,p);h[m]=Object.assign(f,this._calcCornerCoords(p,f))})),h}_calcCornerCoords(t,e){const i=this.getTotalAngle();return{corner:t.calcCornerCoords(i,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(i,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),i=this._calculateCurrentDimensions(),n=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/n[0],1/n[3]),t.rotate(ci(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=$({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},i);t.save(),t.strokeStyle=n.borderColor,this._setLineDash(t,n.borderDashArray),this.strokeBorders(t,e),n.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:i,hasControls:n}=this,s=$({hasBorders:i,hasControls:n},e),o=this.getViewportTransform(),a=s.hasBorders,l=s.hasControls,c=yi(o,this.calcTransformMatrix()),h=ta(c);t.save(),t.translate(h.translateX,h.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(h.angle-=180),t.rotate(ci(this.group?h.angle:this.angle)),a&&this.drawBorders(t,h,e),l&&this.drawControls(t,e),t.restore()}drawBorders(t,e,i){let n;if(i&&i.forActiveSelection||this.group){const s=Qu(this.width,this.height,Mc(e)),o=this.isStrokeAccountedForInDimensions()?Dp:(this.strokeUniform?new ut().scalarAdd(this.canvas?this.canvas.getZoom():1):new ut(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);n=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else n=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,n,i)}drawControlsConnectingLines(t,e){let i=!1;t.beginPath(),this.forEachControl(((n,s)=>{n.withConnection&&n.getVisibility(this,s)&&(i=!0,t.moveTo(n.x*e.x,n.y*e.y),t.lineTo(n.x*e.x+n.offsetX,n.y*e.y+n.offsetY))})),i&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const i=this.getCanvasRetinaScaling(),{cornerStrokeColor:n,cornerDashArray:s,cornerColor:o}=this,a=$({cornerStrokeColor:n,cornerDashArray:s,cornerColor:o},e);t.setTransform(i,0,0,i,0,0),t.strokeStyle=t.fillStyle=a.cornerColor,this.transparentCorners||(t.strokeStyle=a.cornerStrokeColor),this._setLineDash(t,a.cornerDashArray),this.forEachControl(((l,c)=>{if(l.getVisibility(this,c)){const h=this.oCoords[c];l.render(t,h.x,h.y,a,this)}})),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach((e=>{let[i,n]=e;return this.setControlVisible(i,n)}))}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e);const n=this.width+4,s=this.height+4;return e.clearRect(-n/2,-s/2,n,s),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function A2(r,t){return t.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((i=>{i!=="constructor"&&Object.defineProperty(r.prototype,i,Object.getOwnPropertyDescriptor(e.prototype,i)||Object.create(null))}))})),r}G(Ec,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class nr extends Ec{}A2(nr,[d2]),Dt.setClass(nr),Dt.setClass(nr,"object");const L2=(r,t,e,i)=>{const n=2*(i=Math.round(i))+1,{data:s}=r.getImageData(t-i,e-i,n,n);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0};class T2{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new ut(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new ut(1/this.options.scaleX,1/this.options.scaleY):new ut(1,1)}createSideVector(t,e){const i=xu(t,e);return this.options.strokeUniform?i.multiply(this.scale):i}projectOrthogonally(t,e,i){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,i)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new ut(t);return e.y+=e.x*Math.tan(ci(this.options.skewY)),e.x+=e.y*Math.tan(ci(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const Vb=new ut;class Ua extends T2{static getOrthogonalRotationFactor(t,e){const i=e?Su(t,e):w2(t);return Math.abs(i)<wo?-1:1}constructor(t,e,i,n){super(n),G(this,"AB",void 0),G(this,"AC",void 0),G(this,"alpha",void 0),G(this,"bisector",void 0),this.A=new ut(t),this.B=new ut(e),this.C=new ut(i),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Su(this.AB,this.AC),this.bisector=ed(Up(this.AB.eq(Vb)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const n=this.createSideVector(t,e),s=Wp(n),o=Ua.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,i*o)}projectBevel(){const t=[];return(this.alpha%Fs==0?[this.B]:[this.B,this.C]).forEach((e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))})),t}projectMiter(){const t=[],e=Math.abs(this.alpha),i=1/Math.sin(e/2),n=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*i),s=this.options.strokeUniform?_u(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return _u(n)/this.strokeProjectionMagnitude<=s&&t.push(this.applySkew(this.A.add(n))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const i=[],n=new ut(Ua.getOrthogonalRotationFactor(this.bisector),Ua.getOrthogonalRotationFactor(new ut(this.bisector.y,this.bisector.x)));return[new ut(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n),new ut(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n)].forEach((s=>{Zf(s,t,e)&&i.push(this.A.add(s))})),i}projectRoundWithSkew(t,e){const i=[],{skewX:n,skewY:s,scaleX:o,scaleY:a,strokeUniform:l}=this.options,c=new ut(Math.tan(ci(n)),Math.tan(ci(s))),h=this.strokeProjectionMagnitude,p=l?h/a/Math.sqrt(1/a**2+1/o**2*c.y**2):h/Math.sqrt(1+c.y**2),m=new ut(Math.sqrt(Math.max(h**2-p**2,0)),p),f=l?h/Math.sqrt(1+c.x**2*(1/a)**2/(1/o+1/o*c.x*c.y)**2):h/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),b=new ut(f,Math.sqrt(Math.max(h**2-f**2,0)));return[b,b.scalarMultiply(-1),m,m.scalarMultiply(-1)].map((y=>this.applySkew(l?y.multiply(this.strokeUniformScalar):y))).forEach((y=>{Zf(y,t,e)&&i.push(this.applySkew(this.A).add(y))})),i}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%Fs==0,i=this.applySkew(this.A),n=t[e?0:2].subtract(i),s=t[e?1:0].subtract(i),o=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Ha(n,o)>0,l=a?n:s,c=a?s:n;return this.isSkewed()?t.push(...this.projectRoundWithSkew(l,c)):t.push(...this.projectRoundNoSkew(l,c)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector})))}}class N0 extends T2{constructor(t,e,i){super(i),this.A=new ut(t),this.T=new ut(e)}calcOrthogonalProjection(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const n=this.createSideVector(t,e);return this.scaleUnitVector(Wp(n),i)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new ut(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new Ua(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new ut(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),i=this.scaleUnitVector(ed(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),n=this.A.add(i);t.push(n.add(e),n.subtract(e))}return t.map((e=>this.applySkew(e)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((t=>({originPoint:this.A,projectedPoint:t})))}}const E2=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const i=[];if(r.length===0)return i;const n=r.reduce(((s,o)=>(s[s.length-1].eq(o)||s.push(new ut(o)),s)),[new ut(r[0])]);if(n.length===1)e=!0;else if(!e){const s=n[0],o=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(n,(a=>!a.eq(s)));n.splice(o+1)}return n.forEach(((s,o,a)=>{let l,c;o===0?(c=a[1],l=e?s:a[a.length-1]):o===a.length-1?(l=a[o-1],c=e?s:a[0]):(l=a[o-1],c=a[o+1]),e&&a.length===1?i.push(...new N0(s,s,t).project()):!e||o!==0&&o!==a.length-1?i.push(...new Ua(s,l,c,t).project()):i.push(...new N0(s,o===0?c:l,t).project())})),i},Xp=r=>{const t={};return Object.keys(r).forEach((e=>{t[e]={},Object.keys(r[e]).forEach((i=>{t[e][i]=$({},r[e][i])}))})),t},O2=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Vl;const rd=r=>{if(Vl||Vl||(Vl="Intl"in ol()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Vl){const t=Vl.segment(r);return Array.from(t).map((e=>{let{segment:i}=e;return i}))}return Yb(r)},Yb=r=>{const t=[];for(let e,i=0;i<r.length;i++)(e=Gb(r,i))!==!1&&t.push(e);return t},Gb=(r,t)=>{const e=r.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return r.charAt(t);if(55296<=e&&e<=56319){if(r.length<=t+1)throw"High surrogate without following low surrogate";const n=r.charCodeAt(t+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return r.charAt(t)+r.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const i=r.charCodeAt(t-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1};var Xb=Object.freeze({__proto__:null,capitalize:function(r){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(t?r.slice(1):r.slice(1).toLowerCase())},escapeXml:O2,graphemeSplit:rd});const nd=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==t.fill||r.stroke!==t.stroke||r.strokeWidth!==t.strokeWidth||r.fontSize!==t.fontSize||r.fontFamily!==t.fontFamily||r.fontWeight!==t.fontWeight||r.fontStyle!==t.fontStyle||r.textDecorationThickness!==t.textDecorationThickness||r.textBackgroundColor!==t.textBackgroundColor||r.deltaY!==t.deltaY||e&&(r.overline!==t.overline||r.underline!==t.underline||r.linethrough!==t.linethrough)},P2=(r,t)=>{const e=t.split(`
`),i=[];let n=-1,s={};r=Xp(r);for(let o=0;o<e.length;o++){const a=rd(e[o]);if(r[o])for(let l=0;l<a.length;l++){n++;const c=r[o][l];c&&Object.keys(c).length>0&&(nd(s,c,!0)?i.push({start:n,end:n+1,style:c}):i[i.length-1].end++),s=c||{}}else n+=a.length,s={}}return i},N2=(r,t)=>{if(!Array.isArray(r))return Xp(r);const e=t.split(Pp),i={};let n=-1,s=0;for(let o=0;o<e.length;o++){const a=rd(e[o]);for(let l=0;l<a.length;l++)n++,r[s]&&r[s].start<=n&&n<r[s].end&&(i[o]=i[o]||{},i[o][l]=$({},r[s].style),n===r[s].end-1&&s++)}return i},xo=["display","transform",Ti,"fill-opacity","fill-rule","opacity",vr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function D0(r,t){const e=r.nodeName,i=r.getAttribute("class"),n=r.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+e,"i"),t=t.replace(o,""),n&&t.length&&(o=new RegExp("#"+n+s,"i"),t=t.replace(o,"")),i&&t.length){const a=i.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+s,"i"),t=t.replace(o,"")}return t.length===0}function $b(r,t){let e=!0;const i=D0(r,t.pop());return i&&t.length&&(e=(function(n,s){let o,a=!0;for(;n.parentElement&&n.parentElement.nodeType===1&&s.length;)a&&(o=s.pop()),a=D0(n=n.parentElement,o);return s.length===0})(r,t)),i&&e&&t.length===0}const Kb=r=>{var t;return(t=fb[r])!==null&&t!==void 0?t:r},Zb=new RegExp("(".concat(An,")"),"gi"),Jb=r=>bu(r.replace(Zb," $1 ").replace(/,/gi," "));var M0,I0,j0,F0,B0,R0,q0;const pr="(".concat(An,")"),Qb=String.raw(M0||(M0=as(["(skewX)(",")"],["(skewX)\\(","\\)"])),pr),ty=String.raw(I0||(I0=as(["(skewY)(",")"],["(skewY)\\(","\\)"])),pr),ey=String.raw(j0||(j0=as(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),pr,pr,pr),iy=String.raw(F0||(F0=as(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),pr,pr),ry=String.raw(B0||(B0=as(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),pr,pr),ny=String.raw(R0||(R0=as(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),pr,pr,pr,pr,pr,pr),$p="(?:".concat(ny,"|").concat(ry,"|").concat(ey,"|").concat(iy,"|").concat(Qb,"|").concat(ty,")"),sy="(?:".concat($p,"*)"),oy=String.raw(q0||(q0=as(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),sy),ay=new RegExp(oy),ly=new RegExp($p),cy=new RegExp($p,"g");function Cu(r){const t=[];if(!(r=Jb(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!ay.test(r))return[...wr];for(const e of r.matchAll(cy)){const i=ly.exec(e[0]);if(!i)continue;let n=wr;const s=i.filter((b=>!!b)),[,o,...a]=s,[l,c,h,p,m,f]=a.map((b=>parseFloat(b)));switch(o){case"translate":n=cl(l,c);break;case Np:n=oa({angle:l},{x:c,y:h});break;case Ku:n=Ju(l,c);break;case al:n=jp(l);break;case ll:n=Fp(l);break;case"matrix":n=[l,c,h,p,m,f]}t.push(n)}return Zu(t)}function hy(r,t,e,i){const n=Array.isArray(t);let s,o=t;if(r!==Ti&&r!==vr||t!==mr){if(r==="strokeUniform")return t==="non-scaling-stroke";if(r==="strokeDashArray")o=t===mr?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")o=e&&e.transformMatrix?yi(e.transformMatrix,Cu(t)):Cu(t);else if(r==="visible")o=t!==mr&&t!=="hidden",e&&e.visible===!1&&(o=!1);else if(r==="opacity")o=parseFloat(t),e&&e.opacity!==void 0&&(o*=e.opacity);else if(r==="textAnchor")o=t==="start"?je:t==="end"?mi:ue;else if(r==="charSpacing"||r===ea)s=fr(t,i)/i*1e3;else if(r==="paintFirst"){const a=t.indexOf(Ti),l=t.indexOf(vr);o=Ti,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=vr)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return t;if(r==="imageSmoothing")return t==="optimizeQuality";s=n?t.map(fr):fr(t,i)}}else o="";return!n&&isNaN(s)?o:s}function uy(r,t){const e=r.match(db);if(!e)return;const i=e[1],n=e[3],s=e[4],o=e[5],a=e[6];i&&(t.fontStyle=i),n&&(t.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),s&&(t.fontSize=fr(s)),a&&(t.fontFamily=a),o&&(t.lineHeight=o==="normal"?1:o)}function Qf(r,t){r.replace(/;\s*$/,"").split(";").forEach((e=>{if(!e)return;const[i,n]=e.split(":");t[i.trim().toLowerCase()]=n.trim()}))}function dy(r){const t={},e=r.getAttribute("style");return e&&(typeof e=="string"?Qf(e,t):(function(i,n){Object.entries(i).forEach((s=>{let[o,a]=s;a!==void 0&&(n[o.toLowerCase()]=a)}))})(e,t)),t}const fy={stroke:"strokeOpacity",fill:"fillOpacity"};function qs(r,t,e){if(!r)return{};let i,n={},s=Op;r.parentNode&&S0.test(r.parentNode.nodeName)&&(n=qs(r.parentElement,t,e),n.fontSize&&(i=s=fr(n.fontSize)));const o=$($($({},t.reduce(((c,h)=>{const p=r.getAttribute(h);return p&&(c[h]=p),c}),{})),(function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={};for(const m in h)$b(c,m.split(" "))&&(p=$($({},p),h[m]));return p})(r,e)),dy(r));o[Jd]&&r.setAttribute(Jd,o[Jd]),o[Zd]&&(i=fr(o[Zd],s),o[Zd]="".concat(i));const a={};for(const c in o){const h=Kb(c),p=hy(h,o[c],n,i);a[h]=p}a&&a.font&&uy(a.font,a);const l=$($({},n),a);return S0.test(r.nodeName)?l:(function(c){const h=nr.getDefaults();return Object.entries(fy).forEach((p=>{let[m,f]=p;if(c[f]===void 0||c[m]==="")return;if(c[m]===void 0){if(!h[m])return;c[m]=h[m]}if(c[m].indexOf("url(")===0)return;const b=new Er(c[m]);c[m]=b.setAlpha(Ue(b.getAlpha()*c[f],2)).toRgba()})),c})(l)}const py=["left","top","width","height","visible"],D2=["rx","ry"];class gr extends nr{static getDefaults(){return $($({},super.getDefaults()),gr.ownDefaults)}constructor(t){super(),Object.assign(this,gr.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:i}=this,n=-e/2,s=-i/2,o=this.rx?Math.min(this.rx,e/2):0,a=this.ry?Math.min(this.ry,i/2):0,l=o!==0||a!==0;t.beginPath(),t.moveTo(n+o,s),t.lineTo(n+e-o,s),l&&t.bezierCurveTo(n+e-no*o,s,n+e,s+no*a,n+e,s+a),t.lineTo(n+e,s+i-a),l&&t.bezierCurveTo(n+e,s+i-no*a,n+e-no*o,s+i,n+e-o,s+i),t.lineTo(n+o,s+i),l&&t.bezierCurveTo(n+no*o,s+i,n,s+i-no*a,n,s+i-a),t.lineTo(n,s+a),l&&t.bezierCurveTo(n,s+no*a,n+no*o,s,n+o,s),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...D2,...t])}_toSVG(){const{width:t,height:e,rx:i,ry:n}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-t/2,'" y="').concat(-e/2,'" rx="').concat(i,'" ry="').concat(n,'" width="').concat(t,'" height="').concat(e,`" />
`)]}static async fromElement(t,e,i){const n=qs(t,this.ATTRIBUTE_NAMES,i),{left:s=0,top:o=0,width:a=0,height:l=0,visible:c=!0}=n,h=Ke(n,py);return new this($($($({},e),h),{},{left:s,top:o,width:a,height:l,visible:!!(c&&a&&l)}))}}G(gr,"type","Rect"),G(gr,"cacheProperties",[...Rs,...D2]),G(gr,"ownDefaults",{rx:0,ry:0}),G(gr,"ATTRIBUTE_NAMES",[...xo,"x","y","rx","ry","width","height"]),Dt.setClass(gr),Dt.setSVGClass(gr);const Ns="initialization",ku="added",Kp="removed",Au="imperative",M2=(r,t)=>{const{strokeUniform:e,strokeWidth:i,width:n,height:s,group:o}=t,a=o&&o!==r?jc(o.calcTransformMatrix(),r.calcTransformMatrix()):null,l=a?t.getRelativeCenterPoint().transform(a):t.getRelativeCenterPoint(),c=!t.isStrokeAccountedForInDimensions(),h=e&&c?a2(new ut(i,i),void 0,r.calcTransformMatrix()):Dp,p=!e&&c?i:0,m=Qu(n+p,s+p,Zu([a,t.calcOwnMatrix()],!0)).add(h).scalarDivide(2);return[l.subtract(m),l.add(m)]};class sd{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:i,strategy:n}=t;return e===Ns||e===Au||!!i&&n!==i}shouldLayoutClipPath(t){let{type:e,target:{clipPath:i}}=t;return e!==Ns&&i&&!i.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:i,target:n}=e;if(i===Au&&e.overrides)return e.overrides;if(t.length===0)return;const{left:s,top:o,width:a,height:l}=Qn(t.map((p=>M2(n,p))).reduce(((p,m)=>p.concat(m)),[])),c=new ut(a,l),h=new ut(s,o).add(c.scalarDivide(2));if(i===Ns){const p=this.getInitialSize(e,{size:c,center:h});return{center:h,relativeCorrection:new ut(0,0),size:p}}return{center:h.transform(n.calcOwnMatrix()),size:c}}}G(sd,"type","strategy");class tp extends sd{shouldPerformLayout(t){return!0}}G(tp,"type","fit-content"),Dt.setClass(tp);const gy=["strategy"],my=["target","strategy","bubbles","prevStrategy"],I2="layoutManager";class Oc{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new tp;G(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e=$($({bubbles:!0,strategy:this.strategy},t),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(e);const i=this.getLayoutResult(e);i&&this.commitLayout(e,i),this.onAfterLayout(e,i),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:i}=e;return[gu,H1,Lc,U1,$u,W1,pu,tb,eb].map((n=>t.on(n,(s=>this.performLayout(n===gu?{type:"object_modified",trigger:n,e:s,target:i}:{type:"object_modifying",trigger:n,e:s,target:i})))))}subscribe(t,e){this.unsubscribe(t,e);const i=this.attachHandlers(t,e);this._subscriptions.set(t,i)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach((i=>i())),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach((e=>this.unsubscribe(e,t)))}subscribeTargets(t){t.targets.forEach((e=>this.subscribe(e,t)))}onBeforeLayout(t){const{target:e,type:i}=t,{canvas:n}=e;if(i===Ns||i===ku?this.subscribeTargets(t):i===Kp&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),n&&n.fire("object:layout:before",{target:e,context:t}),i===Au&&t.deep){const s=Ke(t,gy);e.forEachObject((o=>o.layoutManager&&o.layoutManager.performLayout($($({},s),{},{bubbles:!1,target:o}))))}}getLayoutResult(t){const{target:e,strategy:i,type:n}=t,s=i.calcLayoutResult(t,e.getObjects());if(!s)return;const o=n===Ns?new ut:e.getRelativeCenterPoint(),{center:a,correction:l=new ut,relativeCorrection:c=new ut}=s,h=o.subtract(a).add(l).transform(n===Ns?wr:Ar(e.calcOwnMatrix()),!0).add(c);return{result:s,prevCenter:o,nextCenter:a,offset:h}}commitLayout(t,e){const{target:i}=t,{result:{size:n},nextCenter:s}=e;var o,a;i.set({width:n.x,height:n.y}),this.layoutObjects(t,e),t.type===Ns?i.set({left:(o=t.x)!==null&&o!==void 0?o:s.x+n.x*Li(i.originX),top:(a=t.y)!==null&&a!==void 0?a:s.y+n.y*Li(i.originY)}):(i.setPositionByOrigin(s,ue,ue),i.setCoords(),i.set("dirty",!0))}layoutObjects(t,e){const{target:i}=t;i.forEachObject((n=>{n.group===i&&this.layoutObject(t,e,n)})),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,i.clipPath)}layoutObject(t,e,i){let{offset:n}=e;i.set({left:i.left+n.x,top:i.top+n.y})}onAfterLayout(t,e){const{target:i,strategy:n,bubbles:s,prevStrategy:o}=t,a=Ke(t,my),{canvas:l}=i;i.fire("layout:after",{context:t,result:e}),l&&l.fire("object:layout:after",{context:t,result:e,target:i});const c=i.parent;s&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(i),c.layoutManager.performLayout($($({},a),{},{target:c}))),i.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach((e=>e.forEach((i=>i())))),t.clear()}toObject(){return{type:I2,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}Dt.setClass(Oc,I2);const vy=["type","objects","layoutManager"];class wy extends Oc{performLayout(){}}class Wr extends V1(nr){static getDefaults(){return $($({},super.getDefaults()),Wr.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),G(this,"_activeObjects",[]),G(this,"__objectSelectionTracker",void 0),G(this,"__objectSelectionDisposer",void 0),Object.assign(this,Wr.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var i;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((n=>{this.enterGroup(n,!1)})),this.layoutManager=(i=e.layoutManager)!==null&&i!==void 0?i:new Oc,this.layoutManager.performLayout({type:Ns,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(js("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(js("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter(((e,i,n)=>this.canEnterGroup(e)&&n.indexOf(e)===i))}add(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const n=this._filterObjectsBeforeEnteringGroup(e),s=super.add(...n);return this._onAfterObjectsChange(ku,n),s}insertAt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(i),o=super.insertAt(t,...s);return this._onAfterObjectsChange(ku,s),o}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(Kp,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const i=this[t];return super._set(t,e),t==="canvas"&&i!==e&&(this._objects||[]).forEach((n=>{n._set(t,e)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:i}=e;const n=this._activeObjects;if(t)n.push(i),this._set("dirty",!0);else if(n.length>0){const s=n.indexOf(i);s>-1&&(n.splice(s,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&el(t,yi(Ar(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const i=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();i&&(i===t||t.isDescendantOf(i))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(el(t,yi(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const i=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;i>-1&&this._activeObjects.splice(i,1)}shouldCache(){const t=nr.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,i){this._renderBackground(t);for(let s=0;s<this._objects.length;s++){var n;const o=this._objects[s];(n=this.canvas)!==null&&n!==void 0&&n.preserveObjectStacking&&o.group!==this?(t.save(),t.transform(...Ar(this.calcTransformMatrix())),o.render(t),t.restore()):o.group===this&&o.render(t)}this._drawClipPath(t,this.clipPath,i)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((t=>t.setCoords()))}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout($({target:this,type:Au},t))}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const i=this.includeDefaultValues;return this._objects.filter((function(n){return!n.excludeFromExport})).map((function(n){const s=n.includeDefaultValues;n.includeDefaultValues=i;const o=n[t||"toObject"](e);return n.includeDefaultValues=s,o}))}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return $($($({},super.toObject(["subTargetCheck","interactive",...t])),e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{}),{},{objects:this.__serializeObjects("toObject",t)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((t=>{this._watchObject(!1,t),t.dispose()})),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=gr.prototype._toSVG.call(this),i=e.indexOf("COMMON_PARTS");e[i]='for="group" ';const n=e.join("");return t?t(n):n}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],i=this._createSVGBgRect(t);i&&e.push("		",i);for(let n=0;n<this._objects.length;n++)e.push("		",this._objects[n].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],i=this._createSVGBgRect(t);i&&e.push("	",i);for(let n=0;n<this._objects.length;n++)e.push("	",this._objects[n].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:i,objects:n=[],layoutManager:s}=t,o=Ke(t,vy);return Promise.all([Qa(n,e),Ic(o,e)]).then((a=>{let[l,c]=a;const h=new this(l,$($($({},o),c),{},{layoutManager:new wy}));if(s){const p=Dt.getClass(s.type),m=Dt.getClass(s.strategy);h.layoutManager=new p(new m)}else h.layoutManager=new Oc;return h.layoutManager.subscribeTargets({type:Ns,target:h,targets:h.getObjects()}),h.setCoords(),h}))}}G(Wr,"type","Group"),G(Wr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),Dt.setClass(Wr);const j2=(r,t)=>Math.min(t.width/r.width,t.height/r.height),F2=(r,t)=>Math.max(t.width/r.width,t.height/r.height),ep="\\s*,?\\s*",Yl="".concat(ep,"(").concat(An,")"),by="".concat(Yl).concat(Yl).concat(Yl).concat(ep,"([01])").concat(ep,"([01])").concat(Yl).concat(Yl),yy={m:"l",M:"L"},xy=(r,t,e,i,n,s,o,a,l,c,h)=>{const p=Tn(r),m=En(r),f=Tn(t),b=En(t),y=e*n*f-i*s*b+o,_=i*n*f+e*s*b+a;return["C",c+l*(-e*n*m-i*s*p),h+l*(-i*n*m+e*s*p),y+l*(e*n*b+i*s*f),_+l*(i*n*b-e*s*f),y,_]},z0=(r,t,e,i)=>{const n=Math.atan2(t,r),s=Math.atan2(i,e);return s>=n?s-n:2*Math.PI-(n-s)};function ip(r,t,e,i,n,s,o,a){let l;if(Oe.cachesBoundsOfCurve&&(l=[...arguments].join(),gc.boundsOfCurveCache[l]))return gc.boundsOfCurveCache[l];const c=Math.sqrt,h=Math.abs,p=[],m=[[0,0],[0,0]];let f=6*r-12*e+6*n,b=-3*r+9*e-9*n+3*o,y=3*e-3*r;for(let O=0;O<2;++O){if(O>0&&(f=6*t-12*i+6*s,b=-3*t+9*i-9*s+3*a,y=3*i-3*t),h(b)<1e-12){if(h(f)<1e-12)continue;const M=-y/f;0<M&&M<1&&p.push(M);continue}const V=f*f-4*y*b;if(V<0)continue;const Z=c(V),nt=(-f+Z)/(2*b);0<nt&&nt<1&&p.push(nt);const W=(-f-Z)/(2*b);0<W&&W<1&&p.push(W)}let _=p.length;const x=_,E=R2(r,t,e,i,n,s,o,a);for(;_--;){const{x:O,y:V}=E(p[_]);m[0][_]=O,m[1][_]=V}m[0][x]=r,m[1][x]=t,m[0][x+1]=o,m[1][x+1]=a;const I=[new ut(Math.min(...m[0]),Math.min(...m[1])),new ut(Math.max(...m[0]),Math.max(...m[1]))];return Oe.cachesBoundsOfCurve&&(gc.boundsOfCurveCache[l]=I),I}const _y=(r,t,e)=>{let[i,n,s,o,a,l,c,h]=e;const p=((m,f,b,y,_,x,E)=>{if(b===0||y===0)return[];let I=0,O=0,V=0;const Z=Math.PI,nt=E*Ep,W=En(nt),M=Tn(nt),J=.5*(-M*m-W*f),L=.5*(-M*f+W*m),N=b**2,H=y**2,z=L**2,st=J**2,lt=N*H-N*z-H*st;let ht=Math.abs(b),et=Math.abs(y);if(lt<0){const vt=Math.sqrt(1-lt/(N*H));ht*=vt,et*=vt}else V=(_===x?-1:1)*Math.sqrt(lt/(N*z+H*st));const dt=V*ht*L/et,kt=-V*et*J/ht,xt=M*dt-W*kt+.5*m,T=W*dt+M*kt+.5*f;let q=z0(1,0,(J-dt)/ht,(L-kt)/et),U=z0((J-dt)/ht,(L-kt)/et,(-J-dt)/ht,(-L-kt)/et);x===0&&U>0?U-=2*Z:x===1&&U<0&&(U+=2*Z);const X=Math.ceil(Math.abs(U/Z*2)),Q=[],ot=U/X,ft=8/3*Math.sin(ot/4)*Math.sin(ot/4)/Math.sin(ot/2);let pt=q+ot;for(let vt=0;vt<X;vt++)Q[vt]=xy(q,pt,M,W,ht,et,xt,T,ft,I,O),I=Q[vt][5],O=Q[vt][6],q=pt,pt+=ot;return Q})(c-r,h-t,n,s,a,l,o);for(let m=0,f=p.length;m<f;m++)p[m][1]+=r,p[m][2]+=t,p[m][3]+=r,p[m][4]+=t,p[m][5]+=r,p[m][6]+=t;return p},B2=r=>{let t=0,e=0,i=0,n=0;const s=[];let o,a=0,l=0;for(const c of r){const h=[...c];let p;switch(h[0]){case"l":h[1]+=t,h[2]+=e;case"L":t=h[1],e=h[2],p=["L",t,e];break;case"h":h[1]+=t;case"H":t=h[1],p=["L",t,e];break;case"v":h[1]+=e;case"V":e=h[1],p=["L",t,e];break;case"m":h[1]+=t,h[2]+=e;case"M":t=h[1],e=h[2],i=h[1],n=h[2],p=["M",t,e];break;case"c":h[1]+=t,h[2]+=e,h[3]+=t,h[4]+=e,h[5]+=t,h[6]+=e;case"C":a=h[3],l=h[4],t=h[5],e=h[6],p=["C",h[1],h[2],a,l,t,e];break;case"s":h[1]+=t,h[2]+=e,h[3]+=t,h[4]+=e;case"S":o==="C"?(a=2*t-a,l=2*e-l):(a=t,l=e),t=h[3],e=h[4],p=["C",a,l,h[1],h[2],t,e],a=p[3],l=p[4];break;case"q":h[1]+=t,h[2]+=e,h[3]+=t,h[4]+=e;case"Q":a=h[1],l=h[2],t=h[3],e=h[4],p=["Q",a,l,t,e];break;case"t":h[1]+=t,h[2]+=e;case"T":o==="Q"?(a=2*t-a,l=2*e-l):(a=t,l=e),t=h[1],e=h[2],p=["Q",a,l,t,e];break;case"a":h[6]+=t,h[7]+=e;case"A":_y(t,e,h).forEach((m=>s.push(m))),t=h[6],e=h[7];break;case"z":case"Z":t=i,e=n,p=["Z"]}p?(s.push(p),o=p[0]):o=""}return s},Lu=(r,t,e,i)=>Math.sqrt((e-r)**2+(i-t)**2),R2=(r,t,e,i,n,s,o,a)=>l=>{const c=l**3,h=(f=>3*f**2*(1-f))(l),p=(f=>3*f*(1-f)**2)(l),m=(f=>(1-f)**3)(l);return new ut(o*c+n*h+e*p+r*m,a*c+s*h+i*p+t*m)},q2=r=>r**2,z2=r=>2*r*(1-r),H2=r=>(1-r)**2,Sy=(r,t,e,i,n,s,o,a)=>l=>{const c=q2(l),h=z2(l),p=H2(l),m=3*(p*(e-r)+h*(n-e)+c*(o-n)),f=3*(p*(i-t)+h*(s-i)+c*(a-s));return Math.atan2(f,m)},Cy=(r,t,e,i,n,s)=>o=>{const a=q2(o),l=z2(o),c=H2(o);return new ut(n*a+e*l+r*c,s*a+i*l+t*c)},ky=(r,t,e,i,n,s)=>o=>{const a=1-o,l=2*(a*(e-r)+o*(n-e)),c=2*(a*(i-t)+o*(s-i));return Math.atan2(c,l)},H0=(r,t,e)=>{let i=new ut(t,e),n=0;for(let s=1;s<=100;s+=1){const o=r(s/100);n+=Lu(i.x,i.y,o.x,o.y),i=o}return n},Ay=(r,t)=>{let e,i=0,n=0,s={x:r.x,y:r.y},o=$({},s),a=.01,l=0;const c=r.iterator,h=r.angleFinder;for(;n<t&&a>1e-4;)o=c(i),l=i,e=Lu(s.x,s.y,o.x,o.y),e+n>t?(i-=a,a/=2):(s=o,i+=a,n+=e);return $($({},o),{},{angle:h(l)})},Zp=r=>{let t,e,i=0,n=0,s=0,o=0,a=0;const l=[];for(const c of r){const h={x:n,y:s,command:c[0],length:0};switch(c[0]){case"M":e=h,e.x=o=n=c[1],e.y=a=s=c[2];break;case"L":e=h,e.length=Lu(n,s,c[1],c[2]),n=c[1],s=c[2];break;case"C":t=R2(n,s,c[1],c[2],c[3],c[4],c[5],c[6]),e=h,e.iterator=t,e.angleFinder=Sy(n,s,c[1],c[2],c[3],c[4],c[5],c[6]),e.length=H0(t,n,s),n=c[5],s=c[6];break;case"Q":t=Cy(n,s,c[1],c[2],c[3],c[4]),e=h,e.iterator=t,e.angleFinder=ky(n,s,c[1],c[2],c[3],c[4]),e.length=H0(t,n,s),n=c[3],s=c[4];break;case"Z":e=h,e.destX=o,e.destY=a,e.length=Lu(n,s,o,a),n=o,s=a}i+=e.length,l.push(e)}return l.push({length:i,x:n,y:s}),l},U2=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zp(r),i=0;for(;t-e[i].length>0&&i<e.length-2;)t-=e[i].length,i++;const n=e[i],s=t/n.length,o=r[i];switch(n.command){case"M":return{x:n.x,y:n.y,angle:0};case"Z":return $($({},new ut(n.x,n.y).lerp(new ut(n.destX,n.destY),s)),{},{angle:Math.atan2(n.destY-n.y,n.destX-n.x)});case"L":return $($({},new ut(n.x,n.y).lerp(new ut(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-n.y,o[1]-n.x)});case"C":case"Q":return Ay(n,t)}},Ly=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),U0=new RegExp(by,"g"),Ty=new RegExp(An,"gi"),Ey={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},W2=r=>{var t;const e=[],i=(t=r.match(Ly))!==null&&t!==void 0?t:[];for(const n of i){const s=n[0];if(s==="z"||s==="Z"){e.push([s]);continue}const o=Ey[s.toLowerCase()];let a=[];if(s==="a"||s==="A"){U0.lastIndex=0;for(let l=null;l=U0.exec(n);)a.push(...l.slice(1))}else a=n.match(Ty)||[];for(let l=0;l<a.length;l+=o){const c=new Array(o),h=yy[s];c[0]=l>0&&h?h:s;for(let p=0;p<o;p++)c[p+1]=parseFloat(a[l+p]);e.push(c)}}return e},V2=function(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new ut(r[0]),i=new ut(r[1]),n=1,s=0;const o=[],a=r.length,l=a>2;let c;for(l&&(n=r[2].x<i.x?-1:r[2].x===i.x?0:1,s=r[2].y<i.y?-1:r[2].y===i.y?0:1),o.push(["M",e.x-n*t,e.y-s*t]),c=1;c<a;c++){if(!e.eq(i)){const h=e.midPointFrom(i);o.push(["Q",e.x,e.y,h.x,h.y])}e=r[c],c+1<r.length&&(i=r[c+1])}return l&&(n=e.x>r[c-2].x?1:e.x===r[c-2].x?0:-1,s=e.y>r[c-2].y?1:e.y===r[c-2].y?0:-1),o.push(["L",e.x+n*t,e.y+s*t]),o},Jp=(r,t)=>r.map((e=>e.map(((i,n)=>n===0||t===void 0?i:Ue(i,t))).join(" "))).join(" ");function Tu(r,t){const e=r.style;e&&t&&(typeof t=="string"?e.cssText+=";"+t:Object.entries(t).forEach((i=>{let[n,s]=i;return e.setProperty(n,s)})))}const Oy=(r,t)=>Math.floor(Math.random()*(t-r+1))+r;function Y2(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const e=t.onComplete||Ko,i=new(ol()).XMLHttpRequest,n=t.signal,s=function(){i.abort()},o=function(){n&&n.removeEventListener("abort",s),i.onerror=i.ontimeout=Ko};if(n&&n.aborted)throw new Tp("request");return n&&n.addEventListener("abort",s,{once:!0}),i.onreadystatechange=function(){i.readyState===4&&(o(),e(i),i.onreadystatechange=Ko)},i.onerror=i.ontimeout=o,i.open("get",r,!0),i.send(),i}const tu=(r,t)=>{let e=r._findCenterFromElement();r.transformMatrix&&((i=>{if(i.transformMatrix){const{scaleX:n,scaleY:s,angle:o,skewX:a}=ta(i.transformMatrix);i.flipX=!1,i.flipY=!1,i.set(br,n),i.set(Vr,s),i.angle=o,i.skewX=a,i.skewY=0}})(r),e=e.transform(r.transformMatrix)),delete r.transformMatrix,t&&(r.scaleX*=t.scaleX,r.scaleY*=t.scaleY,r.cropX=t.cropX,r.cropY=t.cropY,e.x+=t.offsetLeft,e.y+=t.offsetTop,r.width=t.width,r.height=t.height),r.setPositionByOrigin(e,ue,ue)};var Gl=Object.freeze({__proto__:null,addTransformToObject:s2,animate:Yp,animateColor:x2,applyTransformToObject:el,calcAngleBetweenVectors:Su,calcDimensionsMatrix:Mc,calcPlaneChangeMatrix:jc,calcVectorRotation:w2,cancelAnimFrame:G1,capValue:ia,composeMatrix:J1,copyCanvasElement:r=>{var t;const e=Yr(r);return(t=e.getContext("2d"))===null||t===void 0||t.drawImage(r,0,0),e},cos:Tn,createCanvasElement:rs,createImage:X1,createRotateMatrix:oa,createScaleMatrix:Ju,createSkewXMatrix:jp,createSkewYMatrix:Fp,createTranslateMatrix:cl,createVector:xu,crossProduct:Ha,degreesToRadians:ci,dotProduct:b2,ease:bb,enlivenObjectEnlivables:Ic,enlivenObjects:Qa,findScaleToCover:F2,findScaleToFit:j2,getBoundsOfCurve:ip,getOrthonormalVector:Wp,getPathSegmentsInfo:Zp,getPointOnPath:U2,getPointer:n2,getRandomInt:Oy,getRegularPolygonPath:(r,t)=>{const e=2*Math.PI/r;let i=-wo;r%2==0&&(i+=e/2);const n=new Array(r+1);for(let s=0;s<r;s++){const o=s*e+i,{x:a,y:l}=new ut(Tn(o),En(o)).scalarMultiply(t);n[s]=[s===0?"M":"L",a,l]}return n[r]=["Z"],n},getSmoothPathFromPoints:V2,getSvgAttributes:r=>{const t=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return t.concat(["offset","stop-color","stop-opacity"])}return t},getUnitVector:ed,groupSVGElements:(r,t)=>r&&r.length===1?r[0]:new Wr(r,t),hasStyleChanged:nd,invertTransform:Ar,isBetweenVectors:Zf,isIdentityMatrix:$1,isTouchEvent:vu,isTransparent:L2,joinPath:Jp,loadImage:vc,magnitude:_u,makeBoundingBoxFromPoints:Qn,makePathSimpler:B2,matrixToSVG:tl,mergeClipPaths:(r,t)=>{var e;let i=r,n=t;i.inverted&&!n.inverted&&(i=t,n=r),$f(n,(e=n.group)===null||e===void 0?void 0:e.calcTransformMatrix(),i.calcTransformMatrix());const s=i.inverted&&n.inverted;return s&&(i.inverted=n.inverted=!1),new Wr([i],{clipPath:n,inverted:s})},multiplyTransformMatrices:yi,multiplyTransformMatrixArray:Zu,parsePath:W2,parsePreserveAspectRatioAttribute:Hp,parseUnit:fr,pick:aa,projectStrokeOnPoints:E2,qrDecompose:ta,radiansToDegrees:ns,removeFromArray:Vo,removeTransformFromObject:(r,t)=>{const e=Ar(t),i=yi(e,r.calcOwnMatrix());el(r,i)},removeTransformMatrixForSvgParsing:tu,request:Y2,requestAnimFrame:mc,resetObjectTransform:o2,rotatePoint:(r,t,e)=>r.rotate(e,t),rotateVector:Up,saveObjectTransform:qp,sendObjectToPlane:$f,sendPointToPlane:Zo,sendVectorToPlane:a2,setStyle:Tu,sin:En,sizeAfterTransform:Qu,string:Xb,stylesFromArray:N2,stylesToArray:P2,toBlob:Ip,toDataURL:Mp,toFixed:Ue,transformPath:(r,t,e)=>(e&&(t=yi(t,[1,0,0,1,-e.x,-e.y])),r.map((i=>{const n=[...i];for(let s=1;s<i.length-1;s+=2){const{x:o,y:a}=ir({x:i[s],y:i[s+1]},t);n[s]=o,n[s+1]=a}return n}))),transformPoint:ir});class Py extends i2{constructor(t){let{allowTouchScrolling:e=!1,containerClass:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),G(this,"upper",void 0),G(this,"container",void 0);const{el:n}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(n,{allowTouchScrolling:e}),this.applyCanvasStyle(s,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(i),n.parentNode&&n.parentNode.replaceChild(o,n),o.append(n,s),this.container=o}createUpperCanvas(){const{el:t}=this.lower,e=rs();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=sl().createElement("div");return t.setAttribute("data-fabric","wrapper"),Tu(t,{position:"relative"}),f0(t),t}applyCanvasStyle(t,e){const{styles:i,allowTouchScrolling:n}=e;Tu(t,$($({},i),{},{"touch-action":n?"manipulation":mr})),f0(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:i,ctx:n}=this.upper;e2(i,n,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),Xf(this.upper.el,t),Xf(this.container,t)}cleanupDOM(t){const e=this.container,{el:i}=this.lower,{el:n}=this.upper;super.cleanupDOM(t),e.removeChild(n),e.removeChild(i),e.parentNode&&e.parentNode.replaceChild(i,e)}dispose(){super.dispose(),is().dispose(this.upper.el),delete this.upper,delete this.container}}class od extends Rp{constructor(){super(...arguments),G(this,"targets",[]),G(this,"_hoveredTargets",[]),G(this,"_currentTransform",null),G(this,"_groupSelector",null),G(this,"contextTopDirty",!1)}static getDefaults(){return $($({},super.getDefaults()),od.ownDefaults)}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new Py(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter((e=>!e.group&&e!==t)).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),i=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=i,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,i){const n=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-e+n,-i+n),s.transform(...this.viewportTransform);const o=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(s),t.selectionBackgroundColor=o,s.restore();const a=Math.round(n*this.getRetinaScaling());return L2(s,a,a,a)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find((i=>!!i&&t[i]===!0)):t[e])}_shouldClearSelection(t,e){const i=this.getActiveObjects(),n=this._activeObject;return!!(!e||e&&n&&i.length>1&&i.indexOf(e)===-1&&n!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&n&&n!==e)}_shouldCenterTransform(t,e,i){if(!t)return;let n;return e===Ku||e===br||e===Vr||e===Lc?n=this.centeredScaling||t.centeredScaling:e===Np&&(n=this.centeredRotation||t.centeredRotation),n?!i:i}_getOriginFromCorner(t,e){const i={x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?i.x=mi:["mr","tr","br"].includes(e)&&(i.x=je),["tl","mt","tr"].includes(e)?i.y=Gf:["bl","mb","br"].includes(e)&&(i.y=Lr)),i}_setupCurrentTransform(t,e,i){var n;const s=e.group?Zo(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:o="",control:a}=e.getActiveControl()||{},l=i&&a?(n=a.getActionHandler(t,e,a))===null||n===void 0?void 0:n.bind(a):cb,c=((f,b,y,_)=>{if(!b||!f)return"drag";const x=_.controls[b];return x.getActionName(y,x,_)})(i,o,t,e),h=t[this.centeredKey],p=this._shouldCenterTransform(e,c,h)?{x:ue,y:ue}:this._getOriginFromCorner(e,o),m={target:e,action:c,actionHandler:l,actionPerformed:!1,corner:o,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:s.x-e.left,offsetY:s.y-e.top,originX:p.x,originY:p.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:ci(e.angle),width:e.width,height:e.height,shiftKey:t.shiftKey,altKey:h,original:$($({},qp(e)),{},{originX:p.x,originY:p.y})};this._currentTransform=m,this.fire("before:transform",{e:t,transform:m})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:i,deltaX:n,deltaY:s}=this._groupSelector,o=new ut(e,i).transform(this.viewportTransform),a=new ut(e+n,i+s).transform(this.viewportTransform),l=this.selectionLineWidth/2;let c=Math.min(o.x,a.x),h=Math.min(o.y,a.y),p=Math.max(o.x,a.x),m=Math.max(o.y,a.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(c,h,p-c,m-h)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,c+=l,h+=l,p-=l,m-=l,nr.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(c,h,p-c,m-h))}findTarget(t){if(this.skipTargetFind)return;const e=this.getViewportPoint(t),i=this._activeObject,n=this.getActiveObjects();if(this.targets=[],i&&n.length>=1){if(i.findControl(e,vu(t))||n.length>1&&this.searchPossibleTargets([i],e))return i;if(i===this.searchPossibleTargets([i],e)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,e);return t[this.altSelectionKey]&&o&&o!==i?(this.targets=s,i):o}return i}}return this.searchPossibleTargets(this._objects,e)}_pointIsInObjectSelectionArea(t,e){let i=t.getCoords();const n=this.getZoom(),s=t.padding/n;if(s){const[o,a,l,c]=i,h=Math.atan2(a.y-o.y,a.x-o.x),p=Tn(h)*s,m=En(h)*s,f=p+m,b=p-m;i=[new ut(o.x-b,o.y-f),new ut(a.x+f,a.y-b),new ut(l.x+b,l.y+f),new ut(c.x-f,c.y+b)]}return ri.isPointInPolygon(e,i)}_checkTarget(t,e){return!!(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,Zo(e,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing||!this.isTargetTransparent(t,e.x,e.y)))}_searchPossibleTargets(t,e){let i=t.length;for(;i--;){const n=t[i];if(this._checkTarget(n,e)){if(Jh(n)&&n.subTargetCheck){const s=this._searchPossibleTargets(n._objects,e);s&&this.targets.push(s)}return n}}}searchPossibleTargets(t,e){const i=this._searchPossibleTargets(t,e);if(i&&Jh(i)&&i.interactive&&this.targets[0]){const n=this.targets;for(let s=n.length-1;s>0;s--){const o=n[s];if(!Jh(o)||!o.interactive)return o}return n[0]}return i}getViewportPoint(t){return this._pointer?this._pointer:this.getPointer(t,!0)}getScenePoint(t){return this._absolutePointer?this._absolutePointer:this.getPointer(t)}getPointer(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=this.upperCanvasEl,n=i.getBoundingClientRect();let s=n2(t),o=n.width||0,a=n.height||0;o&&a||(Lr in n&&Gf in n&&(a=Math.abs(n.top-n.bottom)),mi in n&&je in n&&(o=Math.abs(n.right-n.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,e||(s=Zo(s,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(s.x/=l,s.y/=l);const c=o===0||a===0?new ut(1,1):new ut(i.width/o,i.height/a);return s.multiply(c)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=rs(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return Yo(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let i=!1,n=!1;const s=this.getActiveObjects(),o=[],a=[];t.forEach((l=>{s.includes(l)||(i=!0,l.fire("deselected",{e,target:l}),a.push(l))})),s.forEach((l=>{t.includes(l)||(i=!0,l.fire("selected",{e,target:l}),o.push(l))})),t.length>0&&s.length>0?(n=!0,i&&this.fire("selection:updated",{e,selected:o,deselected:a})):s.length>0?(n=!0,this.fire("selection:created",{e,selected:o})):t.length>0&&(n=!0,this.fire("selection:cleared",{e,deselected:a})),n&&(this._objectsToRender=void 0)}setActiveObject(t,e){const i=this.getActiveObjects(),n=this._setActiveObject(t,e);return this._fireSelectionEvents(i,e),n}_setActiveObject(t,e){const i=this._activeObject;return i!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,Yo(t)&&i!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const i=this._activeObject;return!!i&&!i.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===i&&this.endCurrentTransform(t),Yo(i)&&i===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),i=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[i]});const n=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),n}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,i=e.target,n={e:t,target:i,transform:e,action:e.action};i._scaling&&(i._scaling=!1),i.setCoords(),e.actionPerformed&&(this.fire("object:modified",n),i.fire(gu,n))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;Yo(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,i){const n=this._realizeGroupTransformOnObject(t),s=super._toObject(t,e,i);return t.set(n),s}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&Yo(e)&&this._activeObject===e){const i=aa(t,["angle","flipX","flipY",je,br,Vr,al,ll,Lr]);return s2(t,e.calcOwnMatrix()),i}return{}}_setSVGObject(t,e,i){const n=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,i),e.set(n)}}G(od,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Ny{constructor(t){G(this,"targets",[]),G(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:n}=t.getActiveObject()||{};n&&n.focus()},i=t.upperCanvasEl;i.addEventListener("click",e),this.__disposer=()=>i.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach((t=>{t.isEditing&&t.exitEditing()}))}add(t){this.targets.push(t)}remove(t){this.unregister(t),Vo(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Dy=["target","oldTarget","fireCanvas","e"],Rr={passive:!1},La=(r,t)=>{const e=r.getViewportPoint(t),i=r.getScenePoint(t);return{viewportPoint:e,scenePoint:i,pointer:e,absolutePointer:i}},so=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return r.addEventListener(...e)},on=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return r.removeEventListener(...e)},My={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class rp extends od{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),G(this,"_isClick",void 0),G(this,"textEditingManager",new Ny(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((e=>{this[e]=this[e].bind(this)})),this.addOrRemove(so,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t,e){const i=this.upperCanvasEl,n=this._getEventPrefix();t(t2(i),"resize",this._onResize),t(i,n+"down",this._onMouseDown),t(i,"".concat(n,"move"),this._onMouseMove,Rr),t(i,"".concat(n,"out"),this._onMouseOut),t(i,"".concat(n,"enter"),this._onMouseEnter),t(i,"wheel",this._onMouseWheel,{passive:!1}),t(i,"contextmenu",this._onContextMenu),t(i,"click",this._onClick),t(i,"dblclick",this._onClick),t(i,"dragstart",this._onDragStart),t(i,"dragend",this._onDragEnd),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,Rr)}removeListeners(){this.addOrRemove(on,"remove");const t=this._getEventPrefix(),e=kn(this.upperCanvasEl);on(e,"".concat(t,"up"),this._onMouseUp),on(e,"touchend",this._onTouchEnd,Rr),on(e,"".concat(t,"move"),this._onMouseMove,Rr),on(e,"touchmove",this._onMouseMove,Rr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this.__onMouseWheel(t)}_onMouseOut(t){const e=this._hoveredTarget,i=$({e:t},La(this,t));this.fire("mouse:out",$($({},i),{},{target:e})),this._hoveredTarget=void 0,e&&e.fire("mouseout",$({},i)),this._hoveredTargets.forEach((n=>{this.fire("mouse:out",$($({},i),{},{target:n})),n&&n.fire("mouseout",$({},i))})),this._hoveredTargets=[]}_onMouseEnter(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",$({e:t},La(this,t))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const i={e:t,target:e};return this.fire("dragstart",i),e.fire("dragstart",i),void so(this.upperCanvasEl,"drag",this._onDragProgress)}p0(t)}_renderDragEffects(t,e,i){let n=!1;const s=this._dropTarget;s&&s!==e&&s!==i&&(s.clearContextTop(),n=!0),e?.clearContextTop(),i!==e&&i?.clearContextTop();const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),e&&(o.save(),e.transform(o),e.renderDragSourceEffect(t),o.restore(),n=!0),i&&(o.save(),i.transform(o),i.renderDropTargetEffect(t),o.restore(),n=!0),o.restore(),n&&(this.contextTopDirty=!0)}_onDragEnd(t){const e=!!t.dataTransfer&&t.dataTransfer.dropEffect!==mr,i=e?this._activeObject:void 0,n={e:t,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:e,dropTarget:i};on(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",n),this._dragSource&&this._dragSource.fire("dragend",n),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}findDragTargets(t){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(t)),targets:[...this.targets]}}_onDragOver(t){const e="dragover",{target:i,targets:n}=this.findDragTargets(t),s=this._dragSource,o={e:t,target:i,subTargets:n,dragSource:s,canDrop:!1,dropTarget:void 0};let a;this.fire(e,o),this._fireEnterLeaveEvents(i,o),i&&(i.canDrop(t)&&(a=i),i.fire(e,o));for(let l=0;l<n.length;l++){const c=n[l];c.canDrop(t)&&(a=c),c.fire(e,o)}this._renderDragEffects(t,s,a),this._dropTarget=a}_onDragEnter(t){const{target:e,targets:i}=this.findDragTargets(t),n={e:t,target:e,subTargets:i,dragSource:this._dragSource};this.fire("dragenter",n),this._fireEnterLeaveEvents(e,n)}_onDragLeave(t){const e={e:t,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",e),this._fireEnterLeaveEvents(void 0,e),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(t){const{target:e,targets:i}=this.findDragTargets(t),n=this._basicEventHandler("drop:before",$({e:t,target:e,subTargets:i,dragSource:this._dragSource},La(this,t)));n.didDrop=!1,n.dropTarget=void 0,this._basicEventHandler("drop",n),this.fire("drop:after",n)}_onContextMenu(t){const e=this.findTarget(t),i=this.targets||[],n=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:i});return this.stopContextMenu&&p0(t),this._basicEventHandler("contextmenu",n),!1}_onClick(t){const e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){let e=!this.allowTouchScrolling;const i=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),(this.isDrawingMode||i&&this._target===i)&&(e=!0),e&&t.preventDefault(),this._resetTransformEventData();const n=this.upperCanvasEl,s=this._getEventPrefix(),o=kn(n);so(o,"touchend",this._onTouchEnd,Rr),e&&so(o,"touchmove",this._onMouseMove,Rr),on(n,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(t){this.__onMouseDown(t),this._resetTransformEventData();const e=this.upperCanvasEl,i=this._getEventPrefix();on(e,"".concat(i,"move"),this._onMouseMove,Rr);const n=kn(e);so(n,"".concat(i,"up"),this._onMouseUp),so(n,"".concat(i,"move"),this._onMouseMove,Rr)}_onTouchEnd(t){if(t.touches.length>0)return;this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),i=kn(this.upperCanvasEl);on(i,"touchend",this._onTouchEnd,Rr),on(i,"touchmove",this._onMouseMove,Rr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{so(this.upperCanvasEl,"".concat(e,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(t){this.__onMouseUp(t),this._resetTransformEventData();const e=this.upperCanvasEl,i=this._getEventPrefix();if(this._isMainEvent(t)){const n=kn(this.upperCanvasEl);on(n,"".concat(i,"up"),this._onMouseUp),on(n,"".concat(i,"move"),this._onMouseMove,Rr),so(e,"".concat(i,"move"),this._onMouseMove,Rr)}}_onMouseMove(t){const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._cacheTransformEventData(t),this._handleEvent(t,"up:before");const i=this._currentTransform,n=this._isClick,s=this._target,{button:o}=t;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let a,l,c=!1;if(i&&(this._finalizeCurrentTransform(t),c=i.actionPerformed),!n){const h=s===this._activeObject;this.handleSelection(t),c||(c=this._shouldRender(s)||!h&&s===this._activeObject)}if(s){const h=s.findControl(this.getViewportPoint(t),vu(t)),{key:p,control:m}=h||{};if(l=p,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,t),c=!0;else if(m){const f=m.getMouseUpHandler(t,s,m);f&&(a=this.getScenePoint(t),f.call(m,t,i,a.x,a.y))}s.isMoving=!1}if(i&&(i.target!==s||i.corner!==l)){const h=i.target&&i.target.controls[i.corner],p=h&&h.getMouseUpHandler(t,i.target,h);a=a||this.getScenePoint(t),p&&p.call(h,t,i,a.x,a.y)}this._setCursorFromEvent(t,s),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),c?this.requestRenderAll():n||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:i,subTargets:n=[]}=e;this.fire(t,e),i&&i.fire(t,e);for(let s=0;s<n.length;s++)n[s]!==i&&n[s].fire(t,e);return e}_handleEvent(t,e,i){const n=this._target,s=this.targets||[],o=$($($({e:t,target:n,subTargets:s},La(this,t)),{},{transform:this._currentTransform},e==="up:before"||e==="up"?{isClick:this._isClick,currentTarget:this.findTarget(t),currentSubTargets:this.targets}:{}),e==="down:before"||e==="down"?i:{});this.fire("mouse:".concat(e),o),n&&n.fire("mouse".concat(e),o);for(let a=0;a<s.length;a++)s[a]!==n&&s[a].fire("mouse".concat(e),o)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._cacheTransformEventData(t),this._handleEvent(t,"down:before");let e=this._target,i=!!e&&e===this._activeObject;const{button:n}=t;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(t,"down",{alreadySelected:i}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let s=this._shouldRender(e),o=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,o=!0,s=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const a=this.getScenePoint(t);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(i=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const a=e.findControl(this.getViewportPoint(t),vu(t));if(e===this._activeObject&&(a||!o)){this._setupCurrentTransform(t,e,i);const l=a?a.control:void 0,c=this.getScenePoint(t),h=l&&l.getMouseDownHandler(t,e,l);h&&h.call(l,t,this._currentTransform,c.x,c.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:i}),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._pointer=this.getViewportPoint(t),this._absolutePointer=Zo(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)}__onMouseMove(t){if(this._isClick=!1,this._cacheTransformEventData(t),this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const i=this.getScenePoint(t);e.deltaX=i.x-e.x,e.deltaY=i.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const i=this.findTarget(t);this._setCursorFromEvent(t,i),this._fireOverOutEvents(t,i)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move"),this._resetTransformEventData()}_fireOverOutEvents(t,e){const i=this._hoveredTarget,n=this._hoveredTargets,s=this.targets,o=Math.max(n.length,s.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:i,fireCanvas:!0});for(let a=0;a<o;a++)s[a]===e||n[a]&&n[a]===i||this.fireSyntheticInOutEvents("mouse",{e:t,target:s[a],oldTarget:n[a]});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(t,e){const i=this._draggedoverTarget,n=this._hoveredTargets,s=this.targets,o=Math.max(n.length,s.length);this.fireSyntheticInOutEvents("drag",$($({},e),{},{target:t,oldTarget:i,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",$($({},e),{},{target:s[a],oldTarget:n[a]}));this._draggedoverTarget=t}fireSyntheticInOutEvents(t,e){let{target:i,oldTarget:n,fireCanvas:s,e:o}=e,a=Ke(e,Dy);const{targetIn:l,targetOut:c,canvasIn:h,canvasOut:p}=My[t],m=n!==i;if(n&&m){const f=$($({},a),{},{e:o,target:n,nextTarget:i},La(this,o));s&&this.fire(p,f),n.fire(c,f)}if(i&&m){const f=$($({},a),{},{e:o,target:i,previousTarget:n},La(this,o));s&&this.fire(h,f),i.fire(l,f)}}__onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_transformObject(t){const e=this.getScenePoint(t),i=this._currentTransform,n=i.target,s=n.group?Zo(e,void 0,n.group.calcTransformMatrix()):e;i.shiftKey=t.shiftKey,i.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,i,s),i.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,i){const{action:n,actionHandler:s,target:o}=e,a=!!s&&s(t,e,i.x,i.y);a&&o.setCoords(),n==="drag"&&a&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||a}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let i=e.hoverCursor||this.hoverCursor;const n=Yo(this._activeObject)?this._activeObject:null,s=(!n||e.group!==n)&&e.findControl(this.getViewportPoint(t));if(s){const o=s.control;this.setCursor(o.cursorStyleHandler(t,o,e))}else e.subTargetCheck&&this.targets.concat().reverse().map((o=>{i=o.hoverCursor||i})),this.setCursor(i)}handleMultiSelection(t,e){const i=this._activeObject,n=Yo(i);if(i&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(i!==e||n)&&(n||!e.isDescendantOf(i)&&!i.isDescendantOf(e))&&!e.onSelect({e:t})&&!i.getActiveControl()){if(n){const s=i.getObjects();if(e===i){const o=this.getViewportPoint(t);if(!(e=this.searchPossibleTargets(s,o)||this.searchPossibleTargets(this._objects,o))||!e.selectable)return!1}e.group===i?(i.remove(e),this._hoveredTarget=e,this._hoveredTargets=[...this.targets],i.size()===1&&this._setActiveObject(i.item(0),t)):(i.multiSelectAdd(e),this._hoveredTarget=i,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,t)}else{i.isEditing&&i.exitEditing();const s=new(Dt.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(i,e),this._hoveredTarget=s,this._setActiveObject(s,t),this._fireSelectionEvents([i],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:i,deltaX:n,deltaY:s}=this._groupSelector,o=new ut(e,i),a=o.add(new ut(n,s)),l=o.min(a),c=o.max(a).subtract(l),h=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),p=o.eq(a)?h[0]?[h[0]]:[]:h.length>1?h.filter((m=>!m.onSelect({e:t}))).reverse():h;if(p.length===1)this.setActiveObject(p[0],t);else if(p.length>1){const m=Dt.getClass("ActiveSelection");this.setActiveObject(new m(p,{canvas:this}),t)}return this._groupSelector=null,!0}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;const{upper:i}=this.elements;i.ctx=void 0;const n=super.toCanvasElement(t,e);return i.ctx=i.el.getContext("2d"),n}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const G2={x1:0,y1:0,x2:0,y2:0},Iy=$($({},G2),{},{r1:0,r2:0}),Ba=(r,t)=>isNaN(r)&&typeof t=="number"?t:r;function X2(r){return r&&/%$/.test(r)&&Number.isFinite(parseFloat(r))}function $2(r,t){const e=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(X2(r)?100:1):NaN;return ia(0,Ba(e,t),1)}const jy=/\s*;\s*/,Fy=/\s*:\s*/;function By(r,t){let e,i;const n=r.getAttribute("style");if(n){const o=n.split(jy);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,c]=o[a].split(Fy).map((h=>h.trim()));l==="stop-color"?e=c:l==="stop-opacity"&&(i=c)}}const s=new Er(e||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:$2(r.getAttribute("offset"),0),color:s.toRgb(),opacity:Ba(parseFloat(i||r.getAttribute("stop-opacity")||""),1)*s.getAlpha()*t}}function Ry(r,t){const e=[],i=r.getElementsByTagName("stop"),n=$2(t,1);for(let s=i.length;s--;)e.push(By(i[s],n));return e}function K2(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function Z2(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function bn(r,t){return r.getAttribute(t)}function qy(r,t){return(function(e,i){let n,{width:s,height:o,gradientUnits:a}=i;return Object.entries(e).reduce(((l,c)=>{let[h,p]=c;if(p==="Infinity")n=1;else if(p==="-Infinity")n=0;else{const m=typeof p=="string";n=m?parseFloat(p):p,m&&X2(p)&&(n*=.01,a==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(n*=s),h!=="y1"&&h!=="y2"||(n*=o)))}return l[h]=n,l}),{})})(K2(r)==="linear"?(function(e){return{x1:bn(e,"x1")||0,y1:bn(e,"y1")||0,x2:bn(e,"x2")||"100%",y2:bn(e,"y2")||0}})(r):(function(e){return{x1:bn(e,"fx")||bn(e,"cx")||"50%",y1:bn(e,"fy")||bn(e,"cy")||"50%",r1:0,x2:bn(e,"cx")||"50%",y2:bn(e,"cy")||"50%",r2:bn(e,"r")||"50%"}})(r),$($({},t),{},{gradientUnits:Z2(r)}))}class Ra{constructor(t){const{type:e="linear",gradientUnits:i="pixels",coords:n={},colorStops:s=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:c}=t||{};Object.assign(this,{type:e,gradientUnits:i,coords:$($({},e==="radial"?Iy:G2),n),colorStops:s,offsetX:o,offsetY:a,gradientTransform:l,id:c?"".concat(c,"_").concat(bo()):bo()})}addColorStop(t){for(const e in t){const i=new Er(t[e]);this.colorStops.push({offset:parseFloat(e),color:i.toRgb(),opacity:i.getAlpha()})}return this}toObject(t){return $($({},aa(this,t)),{},{type:this.type,coords:$({},this.coords),colorStops:this.colorStops.map((e=>$({},e))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[],n=this.gradientTransform?this.gradientTransform.concat():wr.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map((p=>$({},p))).sort(((p,m)=>p.offset-m.offset));let a=-this.offsetX,l=-this.offsetY;var c;s==="objectBoundingBox"?(a/=t.width,l/=t.height):(a+=t.width/2,l+=t.height/2),(c=t)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=t.pathOffset.x,l-=t.pathOffset.y),n[4]-=a,n[5]-=l;const h=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(e?e+" ":"").concat(tl(n),'"'),""].join(" ");if(this.type==="linear"){const{x1:p,y1:m,x2:f,y2:b}=this.coords;i.push("<linearGradient ",h,' x1="',p,'" y1="',m,'" x2="',f,'" y2="',b,`">
`)}else if(this.type==="radial"){const{x1:p,y1:m,x2:f,y2:b,r1:y,r2:_}=this.coords,x=y>_;i.push("<radialGradient ",h,' cx="',x?p:f,'" cy="',x?m:b,'" r="',x?y:_,'" fx="',x?f:p,'" fy="',x?b:m,`">
`),x&&(o.reverse(),o.forEach((I=>{I.offset=1-I.offset})));const E=Math.min(y,_);if(E>0){const I=E/Math.max(y,_);o.forEach((O=>{O.offset+=I*(1-O.offset)}))}}return o.forEach((p=>{let{color:m,offset:f,opacity:b}=p;i.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',m,b!==void 0?";stop-opacity: "+b:";",`"/>
`)})),i.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),i.join("")}toLive(t){const{x1:e,y1:i,x2:n,y2:s,r1:o,r2:a}=this.coords,l=this.type==="linear"?t.createLinearGradient(e,i,n,s):t.createRadialGradient(e,i,o,n,s,a);return this.colorStops.forEach((c=>{let{color:h,opacity:p,offset:m}=c;l.addColorStop(m,p!==void 0?new Er(h).setAlpha(p).toRgba():h)})),l}static async fromObject(t){const{colorStops:e,gradientTransform:i}=t;return new this($($({},t),{},{colorStops:e?e.map((n=>$({},n))):void 0,gradientTransform:i?[...i]:void 0}))}static fromElement(t,e,i){const n=Z2(t),s=e._findCenterFromElement();return new this($({id:t.getAttribute("id")||void 0,type:K2(t),coords:qy(t,{width:i.viewBoxWidth||i.width,height:i.viewBoxHeight||i.height}),colorStops:Ry(t,i.opacity),gradientUnits:n,gradientTransform:Cu(t.getAttribute("gradientTransform")||"")},n==="pixels"?{offsetX:e.width/2-s.x,offsetY:e.height/2-s.y}:{offsetX:0,offsetY:0}))}}G(Ra,"type","Gradient"),Dt.setClass(Ra,"gradient"),Dt.setClass(Ra,"linear"),Dt.setClass(Ra,"radial");const zy=["type","source","patternTransform"];class eu{get type(){return"pattern"}set type(t){js("warn","Setting type has no effect",t)}constructor(t){G(this,"repeat","repeat"),G(this,"offsetX",0),G(this,"offsetY",0),G(this,"crossOrigin",""),this.id=bo(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:i}=this;return $($({},aa(this,t)),{},{type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:i,offsetX:Ue(this.offsetX,Oe.NUM_FRACTION_DIGITS),offsetY:Ue(this.offsetY,Oe.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(t){let{width:e,height:i}=t;const{source:n,repeat:s,id:o}=this,a=Ba(this.offsetX/e,0),l=Ba(this.offsetY/i,0),c=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):Ba(n.width/e,0),h=s==="repeat-x"||s==="no-repeat"?1+Math.abs(l||0):Ba(n.height/i,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(c,'" height="').concat(h,'">'),'<image x="0" y="0" width="'.concat(n.width,'" height="').concat(n.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:i,source:n,patternTransform:s}=t,o=Ke(t,zy);const a=await vc(n,$($({},e),{},{crossOrigin:o.crossOrigin}));return new this($($({},o),{},{patternTransform:s&&s.slice(0),source:a}))}}G(eu,"type","Pattern"),Dt.setClass(eu),Dt.setClass(eu,"pattern");class Hy{constructor(t){G(this,"color","rgb(0, 0, 0)"),G(this,"width",1),G(this,"shadow",null),G(this,"strokeLineCap","round"),G(this,"strokeLineJoin","round"),G(this,"strokeMiterLimit",10),G(this,"strokeDashArray",null),G(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){const e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new Er(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const t=this.canvas,e=this.shadow,i=t.contextTop,n=t.getZoom()*t.getRetinaScaling();i.shadowColor=e.color,i.shadowBlur=e.blur*n,i.shadowOffsetX=e.offsetX*n,i.shadowOffsetY=e.offsetY*n}_resetShadow(){const t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}const Uy=["path","left","top"],Wy=["d"];class Gn extends nr{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:i,left:n,top:s}=e,o=Ke(e,Uy);super(),Object.assign(this,Gn.ownDefaults),this.setOptions(o),this._setPath(t||[],!0),typeof n=="number"&&this.set(je,n),typeof s=="number"&&this.set(Lr,s)}_setPath(t,e){this.path=B2(Array.isArray(t)?t:W2(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new ut(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,i=-this.pathOffset.y;t.beginPath();for(const n of this.path)switch(n[0]){case"L":t.lineTo(n[1]+e,n[2]+i);break;case"M":t.moveTo(n[1]+e,n[2]+i);break;case"C":t.bezierCurveTo(n[1]+e,n[2]+i,n[3]+e,n[4]+i,n[5]+e,n[6]+i);break;case"Q":t.quadraticCurveTo(n[1]+e,n[2]+i,n[3]+e,n[4]+i);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject(t)),{},{path:this.path.map((e=>e.slice()))})}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){const t=Jp(this.path,Oe.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(t,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const t=Oe.NUM_FRACTION_DIGITS;return" translate(".concat(Ue(-this.pathOffset.x,t),", ").concat(Ue(-this.pathOffset.y,t),")")}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:i,pathOffset:n}=this._calcDimensions();this.set({width:e,height:i,pathOffset:n}),t&&this.setPositionByOrigin(n,ue,ue)}_calcBoundsFromPath(){const t=[];let e=0,i=0,n=0,s=0;for(const o of this.path)switch(o[0]){case"L":n=o[1],s=o[2],t.push({x:e,y:i},{x:n,y:s});break;case"M":n=o[1],s=o[2],e=n,i=s;break;case"C":t.push(...ip(n,s,o[1],o[2],o[3],o[4],o[5],o[6])),n=o[5],s=o[6];break;case"Q":t.push(...ip(n,s,o[1],o[2],o[1],o[2],o[3],o[4])),n=o[3],s=o[4];break;case"Z":n=e,s=i}return Qn(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return $($({},t),{},{pathOffset:new ut(t.left+t.width/2,t.top+t.height/2)})}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,i){const n=qs(t,this.ATTRIBUTE_NAMES,i),{d:s}=n;return new this(s,$($($({},Ke(n,Wy)),e),{},{left:void 0,top:void 0}))}}G(Gn,"type","Path"),G(Gn,"cacheProperties",[...Rs,"path","fillRule"]),G(Gn,"ATTRIBUTE_NAMES",[...xo,"d"]),Dt.setClass(Gn),Dt.setSVGClass(Gn);class Eu extends Hy{constructor(t){super(t),G(this,"decimate",.4),G(this,"drawStraightLine",!1),G(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,i){const n=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,n.x,n.y),n}onMouseDown(t,e){let{e:i}=e;this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:i}=e;if(this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const n=this._points,s=n.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=Eu.drawSegment(o,n[s-2],n[s-1]),o.stroke(),o.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],i=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===i.x&&e.y===i.y){const n=this.width/1e3;e.x-=n,i.x+=n}t.moveTo(e.x,e.y);for(let n=1;n<this._points.length;n++)Eu.drawSegment(t,e,i),e=this._points[n],i=this._points[n+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){const e=this.width/1e3;return V2(t,e)}createPath(t){const e=new Gn(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new ts(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let i,n=t[0];const s=this.canvas.getZoom(),o=Math.pow(e/s,2),a=t.length-1,l=[n];for(let c=1;c<a-1;c++)i=Math.pow(n.x-t[c].x,2)+Math.pow(n.y-t[c].y,2),i>=o&&(n=t[c],l.push(n));return l.push(t[a]),l}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const t=this.convertPointsToSVGPath(this._points);if((function(i){return Jp(i)==="M 0 0 Q 0 0 0 0 L 0 0"})(t))return void this.canvas.requestRenderAll();const e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}const Vy=["left","top","radius"],J2=["radius","startAngle","endAngle","counterClockwise"];class Vn extends nr{static getDefaults(){return $($({},super.getDefaults()),Vn.ownDefaults)}constructor(t){super(),Object.assign(this,Vn.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,ci(this.startAngle),ci(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(br)}getRadiusY(){return this.get("radius")*this.get(Vr)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...J2,...t])}_toSVG(){const t=(this.endAngle-this.startAngle)%360;if(t===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:e}=this,i=ci(this.startAngle),n=ci(this.endAngle),s=Tn(i)*e,o=En(i)*e,a=Tn(n)*e,l=En(n)*e,c=t>180?1:0,h=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(o," A ").concat(e," ").concat(e," 0 ").concat(c," ").concat(h," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(t,e,i){const n=qs(t,this.ATTRIBUTE_NAMES,i),{left:s=0,top:o=0,radius:a=0}=n;return new this($($({},Ke(n,Vy)),{},{radius:a,left:s-a,top:o-a}))}static fromObject(t){return super._fromObject(t)}}G(Vn,"type","Circle"),G(Vn,"cacheProperties",[...Rs,...J2]),G(Vn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),G(Vn,"ATTRIBUTE_NAMES",["cx","cy","r",...xo]),Dt.setClass(Vn),Dt.setSVGClass(Vn);const Yy=["x1","y1","x2","y2"],Gy=["x1","y1","x2","y2"],np=["x1","x2","y1","y2"];class Xn extends nr{constructor(){let[t,e,i,n]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Xn.ownDefaults),this.setOptions(s),this.x1=t,this.x2=i,this.y1=e,this.y2=n,this._setWidthHeight();const{left:o,top:a}=s;typeof o=="number"&&this.set(je,o),typeof a=="number"&&this.set(Lr,a)}_setWidthHeight(){const{x1:t,y1:e,x2:i,y2:n}=this;this.width=Math.abs(i-t),this.height=Math.abs(n-e);const{left:s,top:o,width:a,height:l}=Qn([{x:t,y:e},{x:i,y:n}]),c=new ut(s+a/2,o+l/2);this.setPositionByOrigin(c,ue,ue)}_set(t,e){return super._set(t,e),np.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const i=t.strokeStyle;var n;ln(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(n=this.stroke)!==null&&n!==void 0?n:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i}_findCenterFromElement(){return new ut((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject(t)),this.calcLinePoints())}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:i,y2:n,width:s,height:o}=this,a=t<=e?-1:1,l=i<=n?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:t,x2:e,y1:i,y2:n}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(t,'" y1="').concat(i,'" x2="').concat(e,'" y2="').concat(n,`" />
`)]}static async fromElement(t,e,i){const n=qs(t,this.ATTRIBUTE_NAMES,i),{x1:s=0,y1:o=0,x2:a=0,y2:l=0}=n;return new this([s,o,a,l],Ke(n,Yy))}static fromObject(t){let{x1:e,y1:i,x2:n,y2:s}=t,o=Ke(t,Gy);return this._fromObject($($({},o),{},{points:[e,i,n,s]}),{extraParam:"points"})}}G(Xn,"type","Line"),G(Xn,"cacheProperties",[...Rs,...np]),G(Xn,"ATTRIBUTE_NAMES",xo.concat(np)),Dt.setClass(Xn),Dt.setSVGClass(Xn);class ho extends nr{static getDefaults(){return $($({},super.getDefaults()),ho.ownDefaults)}constructor(t){super(),Object.assign(this,ho.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-t," ").concat(e,",0 ").concat(-e,",").concat(t," ").concat(e),'" />']}}G(ho,"type","Triangle"),G(ho,"ownDefaults",{width:100,height:100}),Dt.setClass(ho),Dt.setSVGClass(ho);const Q2=["rx","ry"];class Os extends nr{static getDefaults(){return $($({},super.getDefaults()),Os.ownDefaults)}constructor(t){super(),Object.assign(this,Os.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(br)}getRy(){return this.get("ry")*this.get(Vr)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Q2,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,Fs,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,i){const n=qs(t,this.ATTRIBUTE_NAMES,i);return n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,new this(n)}}function Xy(r){if(!r)return[];const t=r.replace(/,/g," ").trim().split(/\s+/),e=[];for(let i=0;i<t.length;i+=2)e.push({x:parseFloat(t[i]),y:parseFloat(t[i+1])});return e}G(Os,"type","Ellipse"),G(Os,"cacheProperties",[...Rs,...Q2]),G(Os,"ownDefaults",{rx:0,ry:0}),G(Os,"ATTRIBUTE_NAMES",[...xo,"cx","cy","rx","ry"]),Dt.setClass(Os),Dt.setSVGClass(Os);const $y=["left","top"],tv={exactBoundingBox:!1};class Sn extends nr{static getDefaults(){return $($({},super.getDefaults()),Sn.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),G(this,"strokeDiff",void 0),Object.assign(this,Sn.ownDefaults),this.setOptions(e),this.points=t;const{left:i,top:n}=e;this.initialized=!0,this.setBoundingBox(!0),typeof i=="number"&&this.set(je,i),typeof n=="number"&&this.set(Lr,n)}isOpen(){return!0}_projectStrokeOnPoints(t){return E2(this.points,t,this.isOpen())}_calcDimensions(t){t=$({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},t||{});const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map((c=>c.projectedPoint)):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new ut,strokeOffset:new ut,strokeDiff:new ut};const i=Qn(e),n=Mc($($({},t),{},{scaleX:1,scaleY:1})),s=Qn(this.points.map((c=>ir(c,n,!0)))),o=new ut(this.scaleX,this.scaleY);let a=i.left+i.width/2,l=i.top+i.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(ci(this.skewX)),l-=a*Math.tan(ci(this.skewY))),$($({},i),{},{pathOffset:new ut(a,l),strokeOffset:new ut(s.left,s.top).subtract(new ut(i.left,i.top)).multiply(o),strokeDiff:new ut(i.width,i.height).subtract(new ut(s.width,s.height)).multiply(o)})}_findCenterFromElement(){const t=Qn(this.points);return new ut(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:i,width:n,height:s,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:n,height:s,pathOffset:o,strokeOffset:a,strokeDiff:l}),t&&this.setPositionByOrigin(new ut(e+n/2,i+s/2),ue,ue)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new ut(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(t).some((a=>this.strokeUniform||this.constructor.layoutProperties.includes(a)))){var e,i;const{width:a,height:l}=this._calcDimensions(t);o=new ut((e=t.width)!==null&&e!==void 0?e:a,(i=t.height)!==null&&i!==void 0?i:l)}else{var n,s;o=new ut((n=t.width)!==null&&n!==void 0?n:this.width,(s=t.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new ut(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const i=this.initialized&&this[t]!==e,n=super._set(t,e);return this.exactBoundingBox&&i&&((t===br||t===Vr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),n}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject(t)),{},{points:this.points.map((e=>{let{x:i,y:n}=e;return{x:i,y:n}}))})}_toSVG(){const t=[],e=this.pathOffset.x,i=this.pathOffset.y,n=Oe.NUM_FRACTION_DIGITS;for(let s=0,o=this.points.length;s<o;s++)t.push(Ue(this.points[s].x-e,n),",",Ue(this.points[s].y-i,n)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(t.join(""),`" />
`)]}_render(t){const e=this.points.length,i=this.pathOffset.x,n=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-i,this.points[0].y-n);for(let s=0;s<e;s++){const o=this.points[s];t.lineTo(o.x-i,o.y-n)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,i){return new this(Xy(t.getAttribute("points")),$($({},Ke(qs(t,this.ATTRIBUTE_NAMES,i),$y)),e))}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}G(Sn,"ownDefaults",tv),G(Sn,"type","Polyline"),G(Sn,"layoutProperties",[al,ll,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),G(Sn,"cacheProperties",[...Rs,"points"]),G(Sn,"ATTRIBUTE_NAMES",[...xo]),Dt.setClass(Sn),Dt.setSVGClass(Sn);class uo extends Sn{isOpen(){return!1}}G(uo,"ownDefaults",tv),G(uo,"type","Polygon"),Dt.setClass(uo),Dt.setSVGClass(uo);class ev extends nr{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const i in e)for(const n in e[i])for(const s in e[i][n])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const i=e===void 0?this.styles:{0:this.styles[e]};for(const n in i)for(const s in i[n])if(i[n][s][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let i,n,s=0,o=!0,a=0;for(const l in e){i=0;for(const c in e[l]){const h=e[l][c]||{};s++,h[t]!==void 0?(n?h[t]!==n&&(o=!1):n=h[t],h[t]===this[t]&&delete h[t]):o=!1,Object.keys(h).length!==0?i++:delete e[l][c]}i===0&&delete e[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&s===a&&(this[t]=n,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let i,n,s;for(n in e){for(s in i=e[n],i)delete i[s][t],Object.keys(i[s]).length===0&&delete i[s];Object.keys(i).length===0&&delete e[n]}}_extendStyles(t,e){const{lineIndex:i,charIndex:n}=this.get2DCursorLocation(t);this._getLineStyle(i)||this._setLineStyle(i);const s=Bp($($({},this._getStyleDeclaration(i,n)),e),(o=>o!==void 0));this._setStyleDeclaration(i,n,s)}getSelectionStyles(t,e,i){const n=[];for(let s=t;s<(e||t);s++)n.push(this.getStyleAtPosition(s,i));return n}getStyleAtPosition(t,e){const{lineIndex:i,charIndex:n}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(i,n):this._getStyleDeclaration(i,n)}setSelectionStyles(t,e,i){for(let n=e;n<(i||e);n++)this._extendStyles(n,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var i;const n=this.styles&&this.styles[t];return n&&(i=n[e])!==null&&i!==void 0?i:{}}getCompleteStyleDeclaration(t,e){return $($({},aa(this,this.constructor._styleProperties)),this._getStyleDeclaration(t,e))}_setStyleDeclaration(t,e,i){this.styles[t][e]=i}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}G(ev,"_styleProperties",hb);const Ky=/  +/g,Zy=/"/g;function rf(r,t,e,i,n){return"		".concat((function(s,o){let{left:a,top:l,width:c,height:h}=o,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Oe.NUM_FRACTION_DIGITS;const m=Tc(Ti,s,!1),[f,b,y,_]=[a,l,c,h].map((x=>Ue(x,p)));return"<rect ".concat(m,' x="').concat(f,'" y="').concat(b,'" width="').concat(y,'" height="').concat(_,'"></rect>')})(r,{left:t,top:e,width:i,height:n}),`
`)}const Jy=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let nf;class dr extends ev{static getDefaults(){return $($({},super.getDefaults()),dr.ownDefaults)}constructor(t,e){super(),G(this,"__charBounds",[]),Object.assign(this,dr.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=Zp(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Yn)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,i,n,s,o,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===Yn||l!==c-1&&!this.isEndOfWrapping(l))&&(n=0,s=this._textLines[l],e=this.getLineWidth(l),e<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){i=a.length,t=(this.width-e)/i;for(let h=0;h<=s.length;h++)o=this.__charBounds[l][h],this._reSpaceAndTab.test(s[h])?(o.width+=t,o.kernedWidth+=t,o.left+=n,n+=t):o.left+=n}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const i=e?this._unwrappedTextLines:this._textLines;let n;for(n=0;n<i.length;n++){if(t<=i[n].length)return{lineIndex:n,charIndex:t};t-=i[n].length+this.missingNewlineOffset(n,e)}return{lineIndex:n-1,charIndex:i[n-1].length<t?i[n-1].length:t}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===vr?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,i){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case ue:t.textBaseline="middle";break;case"ascender":t.textBaseline=Lr;break;case"descender":t.textBaseline=Gf}t.font=this._getFontDeclaration(e,i)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,i=this._textLines.length;e<i;e++){const n=this.getLineWidth(e);n>t&&(t=n)}return t}_renderTextLine(t,e,i,n,s,o){this._renderChars(t,e,i,n,s,o)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,i=this._getLeftOffset();let n=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){const a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){n+=a;continue}const l=this._textLines[s].length,c=this._getLineLeftOffset(s);let h,p,m=0,f=0,b=this.getValueOfPropertyAt(s,0,"textBackgroundColor");const y=this.getHeightOfLineImpl(s);for(let _=0;_<l;_++){const x=this.__charBounds[s][_];p=this.getValueOfPropertyAt(s,_,"textBackgroundColor"),this.path?(t.save(),t.translate(x.renderLeft,x.renderTop),t.rotate(x.angle),t.fillStyle=p,p&&t.fillRect(-x.width/2,-y*(1-this._fontSizeFraction),x.width,y),t.restore()):p!==b?(h=i+c+f,this.direction==="rtl"&&(h=this.width-h-m),t.fillStyle=b,b&&t.fillRect(h,n,m,y),f=x.left,m=x.width,b=p):m+=x.kernedWidth}p&&!this.path&&(h=i+c+f,this.direction==="rtl"&&(h=this.width-h-m),t.fillStyle=p,t.fillRect(h,n,m,y)),n+=a}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,i,n){const s=gc.getFontCache(e),o=this._getFontDeclaration(e),a=i?i+t:t,l=i&&o===this._getFontDeclaration(n),c=e.fontSize/this.CACHE_FONT_SIZE;let h,p,m,f;if(i&&s.has(i)&&(m=s.get(i)),s.has(t)&&(f=h=s.get(t)),l&&s.has(a)&&(p=s.get(a),f=p-m),h===void 0||m===void 0||p===void 0){const b=(function(){return nf||(nf=Yr({width:0,height:0}).getContext("2d")),nf})();this._setTextStyles(b,e,!0),h===void 0&&(f=h=b.measureText(t).width,s.set(t,h)),m===void 0&&l&&i&&(m=b.measureText(i).width,s.set(i,m)),l&&p===void 0&&(p=b.measureText(a).width,s.set(a,p),f=p-m)}return{width:h*c,kernedWidth:f*c}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,i,n=0;const s=this.pathSide===mi,o=this.path,a=this._textLines[t],l=a.length,c=new Array(l);this.__charBounds[t]=c;for(let h=0;h<l;h++){const p=a[h];i=this._getGraphemeBox(p,t,h,e),c[h]=i,n+=i.kernedWidth,e=p}if(c[l]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let h=0;const p=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case je:h=s?p-n:0;break;case ue:h=(p-n)/2;break;case mi:h=s?0:p-n}h+=this.pathStartOffset*(s?-1:1);for(let m=s?l-1:0;s?m>=0:m<l;s?m--:m++)i=c[m],h>p?h%=p:h<0&&(h+=p),this._setGraphemeOnPath(h,i),h+=i.kernedWidth}return{width:n,numOfSpaces:0}}_setGraphemeOnPath(t,e){const i=t+e.kernedWidth/2,n=this.path,s=U2(n.path,i,n.segmentsInfo);e.renderLeft=s.x-n.pathOffset.x,e.renderTop=s.y-n.pathOffset.y,e.angle=s.angle+(this.pathSide===mi?Math.PI:0)}_getGraphemeBox(t,e,i,n,s){const o=this.getCompleteStyleDeclaration(e,i),a=n?this.getCompleteStyleDeclaration(e,i-1):{},l=this._measureChar(t,o,n,a);let c,h=l.kernedWidth,p=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),p+=c,h+=c);const m={width:p,left:0,height:o.fontSize,kernedWidth:h,deltaY:o.deltaY};if(i>0&&!s){const f=this.__charBounds[e][i-1];m.left=f.left+f.width+l.kernedWidth-l.width}return m}getHeightOfLineImpl(t){const e=this.__lineHeights;if(e[t])return e[t];let i=this.getHeightOfChar(t,0);for(let n=1,s=this._textLines[t].length;n<s;n++)i=Math.max(this.getHeightOfChar(t,n),i);return e[t]=i*this._fontSizeMult}getHeightOfLine(t){return this.getHeightOfLineImpl(t)*this.lineHeight}calcTextHeight(){let t=0;for(let e=0,i=this._textLines.length;e<i;e++)t+=e===i-1?this.getHeightOfLineImpl(e):this.getHeightOfLine(e);return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let i=0;const n=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++)this._renderTextLine(e,t,this._textLines[o],n+this._getLineLeftOffset(o),s+i+this.getHeightOfLineImpl(o),o),i+=this.getHeightOfLine(o);t.restore()}_renderTextFill(t){(this.fill||this.styleHas(Ti))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,i,n,s,o){const a=this.textAlign.includes(Yn),l=this.path,c=!a&&this.charSpacing===0&&this.isEmptyStyles(o)&&!l,h=this.direction==="ltr",p=this.direction==="ltr"?1:-1,m=e.direction;let f,b,y,_,x,E="",I=0;if(e.save(),m!==this.direction&&(e.canvas.setAttribute("dir",h?"ltr":"rtl"),e.direction=h?"ltr":"rtl",e.textAlign=h?je:mi),s-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,c)return this._renderChar(t,e,o,0,i.join(""),n,s),void e.restore();for(let O=0,V=i.length-1;O<=V;O++)_=O===V||this.charSpacing||l,E+=i[O],y=this.__charBounds[o][O],I===0?(n+=p*(y.kernedWidth-y.width),I+=y.width):I+=y.kernedWidth,a&&!_&&this._reSpaceAndTab.test(i[O])&&(_=!0),_||(f=f||this.getCompleteStyleDeclaration(o,O),b=this.getCompleteStyleDeclaration(o,O+1),_=nd(f,b,!1)),_&&(l?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),this._renderChar(t,e,o,O,E,-I/2,0),e.restore()):(x=n,this._renderChar(t,e,o,O,E,x,s)),E="",f=b,n+=p*I,I=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,i=this.height+this.strokeWidth,n=Yr({width:e,height:i}),s=n.getContext("2d");return n.width=e,n.height=i,s.beginPath(),s.moveTo(0,0),s.lineTo(e,0),s.lineTo(e,i),s.lineTo(0,i),s.closePath(),s.translate(e/2,i/2),s.fillStyle=t.toLive(s),this._applyPatternGradientTransform(s,t),s.fill(),s.createPattern(n,"no-repeat")}handleFiller(t,e,i){let n,s;return ln(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(n=-this.width/2,s=-this.height/2,t.translate(n,s),t[e]=this._applyPatternGradientTransformText(i),{offsetX:n,offsetY:s}):(t[e]=i.toLive(t),this._applyPatternGradientTransform(t,i)):(t[e]=i,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:i,strokeWidth:n}=e;return t.lineWidth=n,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",i)}_setFillStyles(t,e){let{fill:i}=e;return this.handleFiller(t,"fillStyle",i)}_renderChar(t,e,i,n,s,o,a){const l=this._getStyleDeclaration(i,n),c=this.getCompleteStyleDeclaration(i,n),h=t==="fillText"&&c.fill,p=t==="strokeText"&&c.stroke&&c.strokeWidth;if(p||h){if(e.save(),e.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(e),l.deltaY&&(a+=l.deltaY),h){const m=this._setFillStyles(e,c);e.fillText(s,o-m.offsetX,a-m.offsetY)}if(p){const m=this._setStrokeStyles(e,c);e.strokeText(s,o-m.offsetX,a-m.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,i){const n=this.get2DCursorLocation(t,!0),s=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),o=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),a={fontSize:s*i.size,deltaY:o+s*i.baseline};this.setSelectionStyles(a,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),i=this.width-e,n=this.textAlign,s=this.direction,o=this.isEndOfWrapping(t);let a=0;return n===Yn||n===bc&&!o||n===wc&&!o||n===yu&&!o?0:(n===ue&&(a=i/2),n===mi&&(a=i),n===bc&&(a=i/2),n===wc&&(a=i),s==="rtl"&&(n===mi||n===Yn||n===wc?a=0:n===je||n===yu?a=-i:n!==ue&&n!==bc||(a=-i/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,i){var n;return(n=this._getStyleDeclaration(t,e)[i])!==null&&n!==void 0?n:this[i]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let i=this._getTopOffset();const n=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),a=e==="linethrough"?.5:e==="overline"?1:0,l=this.offsets[e];for(let c=0,h=this._textLines.length;c<h;c++){const p=this.getHeightOfLine(c);if(!this[e]&&!this.styleHas(e,c)){i+=p;continue}const m=this._textLines[c],f=p/this.lineHeight,b=this._getLineLeftOffset(c);let y=0,_=0,x=this.getValueOfPropertyAt(c,0,e),E=this.getValueOfPropertyAt(c,0,Ti),I=this.getValueOfPropertyAt(c,0,ea),O=x,V=E,Z=I;const nt=i+f*(1-this._fontSizeFraction);let W=this.getHeightOfChar(c,0),M=this.getValueOfPropertyAt(c,0,"deltaY");for(let N=0,H=m.length;N<H;N++){const z=this.__charBounds[c][N];O=this.getValueOfPropertyAt(c,N,e),V=this.getValueOfPropertyAt(c,N,Ti),Z=this.getValueOfPropertyAt(c,N,ea);const st=this.getHeightOfChar(c,N),lt=this.getValueOfPropertyAt(c,N,"deltaY");if(s&&O&&V){const ht=this.fontSize*Z/1e3;t.save(),t.fillStyle=E,t.translate(z.renderLeft,z.renderTop),t.rotate(z.angle),t.fillRect(-z.kernedWidth/2,l*st+lt-a*ht,z.kernedWidth,ht),t.restore()}else if((O!==x||V!==E||st!==W||Z!==I||lt!==M)&&_>0){const ht=this.fontSize*I/1e3;let et=n+b+y;this.direction==="rtl"&&(et=this.width-et-_),x&&E&&I&&(t.fillStyle=E,t.fillRect(et,nt+l*W+M-a*ht,_,ht)),y=z.left,_=z.width,x=O,I=Z,E=V,W=st,M=lt}else _+=z.kernedWidth}let J=n+b+y;this.direction==="rtl"&&(J=this.width-J-_),t.fillStyle=V;const L=this.fontSize*Z/1e3;O&&V&&Z&&t.fillRect(J,nt+l*W+M-a*L,_-o,L),i+=p}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:i=this.fontWeight,fontSize:n=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const o=t.includes("'")||t.includes('"')||t.includes(",")||dr.genericFonts.includes(t.toLowerCase())?t:'"'.concat(t,'"');return[e,i,"".concat(s?this.CACHE_FONT_SIZE:n,"px"),o].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return rd(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),i=new Array(e.length),n=[`
`];let s=[];for(let o=0;o<e.length;o++)i[o]=this.graphemeSplit(e[o]),s=s.concat(i[o],n);return s.pop(),{_unwrappedLines:i,lines:e,graphemeText:s,graphemeLines:i}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject([...m2,...t])),{},{styles:P2(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(t,e){const{textLayoutProperties:i}=this.constructor;super.set(t,e);let n=!1,s=!1;if(typeof t=="object")for(const o in t)o==="path"&&this.setPathInfo(),n=n||i.includes(o),s=s||o==="path";else n=i.includes(t),s=t==="path";return s&&this.setPathInfo(),n&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,i){const n=qs(t,dr.ATTRIBUTE_NAMES,i),s=$($({},e),n),{textAnchor:o=je,textDecoration:a="",dx:l=0,dy:c=0,top:h=0,left:p=0,fontSize:m=Op,strokeWidth:f=1}=s,b=Ke(s,Jy),y=new this(bu(t.textContent||"").trim(),$({left:p+l,top:h+c,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:m},b)),_=y.getScaledHeight()/y.height,x=((y.height+y.strokeWidth)*y.lineHeight-y.height)*_,E=y.getScaledHeight()+x;let I=0;return o===ue&&(I=y.getScaledWidth()/2),o===mi&&(I=y.getScaledWidth()),y.set({left:y.left-I,top:y.top-(E-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:f}),y}static fromObject(t){return this._fromObject($($({},t),{},{styles:N2(t.styles||{},t.text)}),{extraParam:"text"})}}G(dr,"textLayoutProperties",g2),G(dr,"cacheProperties",[...Rs,...m2]),G(dr,"ownDefaults",ub),G(dr,"type","Text"),G(dr,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),G(dr,"ATTRIBUTE_NAMES",xo.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),A2(dr,[class extends d2{_toSVG(){const r=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(r){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:r,withShadow:!0,additionalTransform:tl(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:t,textSpans:e}=r;const i=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(Zy,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",i?'text-decoration="'.concat(i,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(r,t){const e=[],i=[];let n,s=r;this.backgroundColor&&i.push(...rf(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)n=this._getLineLeftOffset(o),this.direction==="rtl"&&(n+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(i,o,t+n,s),this._setSVGTextLineText(e,o,t+n,s),s+=this.getHeightOfLine(o);return{textSpans:e,textBgRects:i}}_createTextCharSpan(r,t,e,i,n){const s=Oe.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(t,r!==r.trim()||!!r.match(Ky)),a=o?'style="'.concat(o,'"'):"",l=t.deltaY,c=l?' dy="'.concat(Ue(l,s),'" '):"",{angle:h,renderLeft:p,renderTop:m,width:f}=n;let b="";if(p!==void 0){const y=f/2;h&&(b=' rotate="'.concat(Ue(ns(h),s),'"'));const _=oa({angle:ns(h)});_[4]=p,_[5]=m;const x=new ut(-y,0).transform(_);e=x.x,i=x.y}return'<tspan x="'.concat(Ue(e,s),'" y="').concat(Ue(i,s),'" ').concat(c).concat(b).concat(a,">").concat(O2(r),"</tspan>")}_setSVGTextLineText(r,t,e,i){const n=this.getHeightOfLine(t),s=this.textAlign.includes(Yn),o=this._textLines[t];let a,l,c,h,p,m="",f=0;i+=n*(1-this._fontSizeFraction)/this.lineHeight;for(let b=0,y=o.length-1;b<=y;b++)p=b===y||this.charSpacing||this.path,m+=o[b],c=this.__charBounds[t][b],f===0?(e+=c.kernedWidth-c.width,f+=c.width):f+=c.kernedWidth,s&&!p&&this._reSpaceAndTab.test(o[b])&&(p=!0),p||(a=a||this.getCompleteStyleDeclaration(t,b),l=this.getCompleteStyleDeclaration(t,b+1),p=nd(a,l,!0)),p&&(h=this._getStyleDeclaration(t,b),r.push(this._createTextCharSpan(m,h,e,i,c)),m="",a=l,this.direction==="rtl"?e-=f:e+=f,f=0)}_setSVGTextLineBg(r,t,e,i){const n=this._textLines[t],s=this.getHeightOfLine(t)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let h=0;h<n.length;h++){const{left:p,width:m,kernedWidth:f}=this.__charBounds[t][h];o=this.getValueOfPropertyAt(t,h,"textBackgroundColor"),o!==c?(c&&r.push(...rf(c,e+l,i,a,s)),l=p,a=m,c=o):a+=f}o&&r.push(...rf(c,e+l,i,a,s))}_getSVGLineTopOffset(r){let t,e=0;for(t=0;t<r;t++)e+=this.getHeightOfLine(t);const i=this.getHeightOfLine(t);return{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," text-decoration-thickness: ").concat(Ue(this.textDecorationThickness*this.getObjectScaling().y/10,Oe.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(r,t){const{fontFamily:e,strokeWidth:i,stroke:n,fill:s,fontSize:o,fontStyle:a,fontWeight:l,deltaY:c,textDecorationThickness:h,linethrough:p,overline:m,underline:f}=r,b=this.getSvgTextDecoration({underline:f??this.underline,overline:m??this.overline,linethrough:p??this.linethrough}),y=h||this.textDecorationThickness;return[n?Tc(vr,n):"",i?"stroke-width: ".concat(i,"; "):"",e?"font-family: ".concat(e.includes("'")||e.includes('"')?e:"'".concat(e,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",b?"text-decoration: ".concat(b,"; text-decoration-thickness: ").concat(Ue(y*this.getObjectScaling().y/10,Oe.NUM_FRACTION_DIGITS),"%; "):"",s?Tc(Ti,s):"",c?"baseline-shift: ".concat(-c,"; "):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter((t=>r[t.replace("-","")])).join(" ")}}]),Dt.setClass(dr),Dt.setSVGClass(dr);class Qy{constructor(t){G(this,"target",void 0),G(this,"__mouseDownInPlace",!1),G(this,"__dragStartFired",!1),G(this,"__isDraggingOver",!1),G(this,"__dragStartSelection",void 0),G(this,"__dragImageDisposer",void 0),G(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach((i=>i())),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,i=e.getSelectionStartFromPointer(t);return e.isEditing&&i>=e.selectionStart&&i<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var i;let{selectionStart:n,selectionEnd:s}=e;const o=this.target,a=o.canvas,l=new ut(o.flipX?-1:1,o.flipY?-1:1),c=o._getCursorBoundaries(n),h=new ut(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(o.calcTransformMatrix()),p=a.getScenePoint(t).subtract(h),m=o.getCanvasRetinaScaling(),f=o.getBoundingRect(),b=h.subtract(new ut(f.left,f.top)),y=a.viewportTransform,_=b.add(p).transform(y,!0),x=o.backgroundColor,E=Xp(o.styles);o.backgroundColor="";const I={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(I,0,n),o.setSelectionStyles(I,s,o.text.length),o.dirty=!0;const O=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=x,o.styles=E,o.dirty=!0,Tu(O,{position:"fixed",left:"".concat(-O.width,"px"),border:mr,width:"".concat(O.width/m,"px"),height:"".concat(O.height/m,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{O.remove()},kn(t.target||this.target.hiddenTextarea).body.appendChild(O),(i=t.dataTransfer)===null||i===void 0||i.setDragImage(O,_.x,_.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,i=this.isActive();if(i&&t.dataTransfer){const n=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},s=e._text.slice(n.selectionStart,n.selectionEnd).join(""),o=$({text:e.text,value:s},n);t.dataTransfer.setData("text/plain",s),t.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:e.getSelectionStyles(n.selectionStart,n.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,o)}return e.abortCursorAnimation(),i}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),i=this.__dragStartSelection;return e<i.selectionStart||e>i.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const i=this.targetCanDrop(e);!this.__isDraggingOver&&i&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,i=this.targetCanDrop(e);!this.__isDraggingOver&&i?this.__isDraggingOver=!0:this.__isDraggingOver&&!i&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:i}=t,n=i.defaultPrevented;this.__isDraggingOver=!1,i.preventDefault();let s=(e=i.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(s&&!n){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(i);const{styles:c}=i.dataTransfer.types.includes("application/fabric")?JSON.parse(i.dataTransfer.getData("application/fabric")):{},h=s[Math.max(0,s.length-1)],p=0;if(this.__dragStartSelection){const m=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;l>m&&l<=f?l=m:l>f&&(l-=f-m),o.removeChars(m,f),delete this.__dragStartSelection}o._reNewline.test(h)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(s=s.trimEnd()),t.didDrop=!0,t.dropTarget=o,o.insertChars(s,c,l),a.setActiveObject(o),o.enterEditing(i),o.selectionStart=Math.min(l+p,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(pu,{index:l+p,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var i;const n=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((i=e.dataTransfer)===null||i===void 0?void 0:i.dropEffect)||mr;l===mr?(n.selectionStart=o,n.selectionEnd=a,n._updateTextarea(),n.hiddenTextarea.focus()):(n.clearContextTop(),l==="move"&&(n.removeChars(o,a),n.selectionStart=n.selectionEnd=o,n.hiddenTextarea&&(n.hiddenTextarea.value=n.text),n._updateTextarea(),n.fire(pu,{index:o,action:"dragend"}),s.fire("text:changed",{target:n}),s.requestRenderAll()),n.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const W0=/[ \n\.,;!\?\-]/;class tx extends dr{constructor(){super(...arguments),G(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:i,delay:n,onComplete:s}=t;return Yp({startValue:this._currentCursorOpacity,endValue:e,duration:i,delay:n,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach((e=>{e&&!e.isDone()&&(t=!0,e.abort())})),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((t=>!t||t.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e}findWordBoundaryRight(t){let e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e}findLineBoundaryLeft(t){let e=0,i=t-1;for(;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e}findLineBoundaryRight(t){let e=0,i=t;for(;!/\n/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e}searchWordBoundary(t,e){const i=this._text;let n=t>0&&this._reSpace.test(i[t])&&(e===-1||!Pp.test(i[t-1]))?t-1:t,s=i[n];for(;n>0&&n<i.length&&!W0.test(s);)n+=e,s=i[n];return e===-1&&W0.test(s)&&n++,n}selectWord(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;const i=this.searchWordBoundary(t,-1),n=Math.max(i,this.searchWordBoundary(t,1));this.selectionStart=i,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;const i=this.findLineBoundaryLeft(t),n=this.findLineBoundaryRight(t);this.selectionStart=i,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;kn(e).activeElement!==e&&e.focus();const i=this.getSelectionStartFromPointer(t),n=this.selectionStart,s=this.selectionEnd;(i===this.__selectionStartOnMouseDown&&n!==s||n!==i&&s!==i)&&(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,i){const n=i.slice(0,t),s=this.graphemeSplit(n).length;if(t===e)return{selectionStart:s,selectionEnd:s};const o=i.slice(t,e);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(t,e,i){const n=i.slice(0,t).join("").length;return t===e?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+i.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const t=this.hiddenTextarea;this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const e=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),n=i.lineIndex,s=i.charIndex,o=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=e.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,h=c.width/l,p=c.height/l,m=h-o,f=p-o,b=new ut(e.left+a,e.top+e.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new ut(c.clientWidth/h,c.clientHeight/p));return b.x<0&&(b.x=0),b.x>m&&(b.x=m),b.y<0&&(b.y=0),b.y>f&&(b.y=f),b.x+=this.canvas._offset.left,b.y+=this.canvas._offset.top,{left:"".concat(b.x,"px"),top:"".concat(b.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(gu),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:i,charIndex:n}=this.get2DCursorLocation(t,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(e,!0);if(i!==s){if(this.styles[i])for(let a=n;a<this._unwrappedTextLines[i].length;a++)delete this.styles[i][a];if(this.styles[s])for(let a=o;a<this._unwrappedTextLines[s].length;a++){const l=this.styles[s][a];l&&(this.styles[i]||(this.styles[i]={}),this.styles[i][n+a-o]=l)}for(let a=i+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,i-s)}else if(this.styles[i]){const a=this.styles[i],l=o-n;for(let c=n;c<o;c++)delete a[c];for(const c in this.styles[i]){const h=parseInt(c,10);h>=o&&(a[h-l]=a[c],delete a[c])}}}shiftLineStyles(t,e){const i=Object.assign({},this.styles);for(const n in this.styles){const s=parseInt(n,10);s>t&&(this.styles[s+e]=i[s],i[s-e]||delete this.styles[s])}}insertNewlineStyleObject(t,e,i,n){const s={},o=this._unwrappedTextLines[t].length,a=o===e;let l=!1;i||(i=1),this.shiftLineStyles(t,i);const c=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const p in this.styles[t]){const m=parseInt(p,10);m>=e&&(l=!0,s[m-e]=this.styles[t][p],a&&e===0||delete this.styles[t][p])}let h=!1;for(l&&!a&&(this.styles[t+i]=s,h=!0),(h||o>e)&&i--;i>0;)n&&n[i-1]?this.styles[t+i]={0:$({},n[i-1])}:c?this.styles[t+i]={0:$({},c)}:delete this.styles[t+i],i--;this._forceClearCache=!0}insertCharStyleObject(t,e,i,n){this.styles||(this.styles={});const s=this.styles[t],o=s?$({},s):{};i||(i=1);for(const l in o){const c=parseInt(l,10);c>=e&&(s[c+i]=o[c],o[c-i]||delete s[c])}if(this._forceClearCache=!0,n){for(;i--;)Object.keys(n[i]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+i]=$({},n[i]));return}if(!s)return;const a=s[e?e-1:1];for(;a&&i--;)this.styles[t][e+i]=$({},a)}insertNewStyleBlock(t,e,i){const n=this.get2DCursorLocation(e,!0),s=[0];let o,a=0;for(let l=0;l<t.length;l++)t[l]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],i),i=i&&i.slice(s[0]+1)),a&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],a),o=1;o<a;o++)s[o]>0?this.insertCharStyleObject(n.lineIndex+o,0,s[o],i):i&&this.styles[n.lineIndex+o]&&i[0]&&(this.styles[n.lineIndex+o][0]=i[0]),i=i&&i.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(n.lineIndex+o,0,s[o],i)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;n>i&&this.removeStyleFromTo(i,n);const s=this.graphemeSplit(t);this.insertNewStyleBlock(s,i,e),this._text=[...this._text.slice(0,i),...s,...this._text.slice(n)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,i){i<=t?(e===t?this._selectionDirection=je:this._selectionDirection===mi&&(this._selectionDirection=je,this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?this._selectionDirection===mi?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection=mi:this._selectionDirection===je&&(this._selectionDirection=mi,this.selectionStart=e),this.selectionEnd=i)}}class ex extends tx{initHiddenTextarea(){const t=this.canvas&&kn(this.canvas.getElement())||sl(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map((o=>{let[a,l]=o;return e.setAttribute(a,l)}));const{top:i,left:n,fontSize:s}=this._calcTextareaPosition();e.style.cssText="position: absolute; top: ".concat(i,"; left: ").concat(n,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((o=>{let[a,l]=o;return e.addEventListener(a,this[l].bind(this))})),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste,{value:i,selectionStart:n,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(pu),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const a=this._splitTextIntoLines(i).graphemeText,l=this._text.length,c=a.length,h=this.selectionStart,p=this.selectionEnd,m=h!==p;let f,b,y,_,x=c-l;const E=this.fromStringToGraphemeSelection(n,s,i),I=h>E.selectionStart;m?(b=this._text.slice(h,p),x+=p-h):c<l&&(b=I?this._text.slice(p+x,p):this._text.slice(h,h-x));const O=a.slice(E.selectionEnd-x,E.selectionEnd);if(b&&b.length&&(O.length&&(f=this.getSelectionStyles(h,h+1,!1),f=O.map((()=>f[0]))),m?(y=h,_=p):I?(y=p-b.length,_=p):(y=p,_=p+b.length),this.removeStyleFromTo(y,_)),O.length){const{copyPasteData:V}=is();e&&O.join("")===V.copiedText&&!Oe.disableStyleCopyPaste&&(f=V.copiedTextStyle),this.insertNewStyleBlock(O,h,f)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:i,selectionEnd:n}=e;this.compositionStart=i,this.compositionEnd=n,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=is();t.copiedText=this.getSelectedText(),Oe.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let i,n=this._getLineLeftOffset(t);return e>0&&(i=this.__charBounds[t][e-1],n+=i.left+i.width),n}getDownCursorOffset(t,e){const i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),s=n.lineIndex;if(s===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-i;const o=n.charIndex,a=this._getWidthBeforeCursor(s,o),l=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(o).length+l+1+this.missingNewlineOffset(s)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),s=n.lineIndex;if(s===0||t.metaKey||t.keyCode===33)return-i;const o=n.charIndex,a=this._getWidthBeforeCursor(s,o),l=this._getIndexOnLine(s-1,a),c=this._textLines[s].slice(0,o),h=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+l-c.length+(1-h)}_getIndexOnLine(t,e){const i=this._textLines[t];let n,s,o=this._getLineLeftOffset(t),a=0;for(let l=0,c=i.length;l<c;l++)if(n=this.__charBounds[t][l].width,o+=n,o>e){s=!0;const h=o-n,p=o,m=Math.abs(h-e);a=Math.abs(p-e)<m?l:l-1;break}return s||(a=i.length-1),a}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const i=this["get".concat(t,"CursorOffset")](e,this._selectionDirection===mi);if(e.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),i!==0){const n=this.text.length;this.selectionStart=ia(0,this.selectionStart,n),this.selectionEnd=ia(0,this.selectionEnd,n),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===je?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,i){let n;if(t.altKey)n=this["findWordBoundary".concat(i)](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=i==="Left"?-1:1,!0;n=this["findLineBoundary".concat(i)](this[e])}return n!==void 0&&this[e]!==n&&(this[e]=n,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=je,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===mi&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=je,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const i="moveCursor".concat(t).concat(e.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===je&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=mi,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=mi,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const V0=r=>!!r.button;class ix extends ex{constructor(){super(...arguments),G(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Qy(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:i}=t;this.canvas&&this.editable&&!V0(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),i&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=i||this.isEditing)))}mouseUpHandler(t){let{e,transform:i}=t;const n=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||i&&i.actionPerformed||V0(e)||n||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),i=this.selectionStart,n=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,n,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(Ar(this.calcTransformMatrix())).add(new ut(-this._getLeftOffset(),-this._getTopOffset()));let i=0,n=0,s=0;for(let c=0;c<this._textLines.length&&i<=e.y;c++)i+=this.getHeightOfLine(c),s=c,c>0&&(n+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let o=Math.abs(this._getLineLeftOffset(s));const a=this._textLines[s].length,l=this.__charBounds[s];for(let c=0;c<a;c++){const h=o+l[c].kernedWidth;if(e.x<=h){Math.abs(e.x-h)<=Math.abs(e.x-o)&&n++;break}o=h,n++}return Math.min(this.flipX?a-n:n,this._text.length)}}const Ph="moveCursorUp",Nh="moveCursorDown",Dh="moveCursorLeft",Mh="moveCursorRight",Ih="exitEditing",Y0=(r,t)=>{const e=t.getRetinaScaling();r.setTransform(e,0,0,e,0,0);const i=t.viewportTransform;r.transform(i[0],i[1],i[2],i[3],i[4],i[5])},rx=$({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Ih,27:Ih,33:Ph,34:Nh,35:Mh,36:Dh,37:Dh,38:Ph,39:Mh,40:Nh},keysMapRtl:{9:Ih,27:Ih,33:Ph,34:Nh,35:Dh,36:Mh,37:Mh,38:Ph,39:Dh,40:Nh},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Kn extends ix{static getDefaults(){return $($({},super.getDefaults()),Kn.ownDefaults)}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,$($({},Kn.ownDefaults),e)),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof rp&&this.canvas.textEditingManager.remove(this),e instanceof rp&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,i=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,i)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,i)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const i=super.toCanvasElement(t);return this.isEditing=e,i}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries(),i=this.findAncestorsWithClipPath(),n=i.length>0;let s,o=t;if(n){s=Yr(t.canvas),o=s.getContext("2d"),Y0(o,this.canvas);const a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,e):this.renderCursor(o,e),n)for(const a of i){const l=a.clipPath,c=Yr(t.canvas),h=c.getContext("2d");if(Y0(h,this.canvas),!l.absolutePositioned){const p=a.calcTransformMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5])}l.transform(h),l.drawObject(h,!0,{}),this.drawClipPathOnCache(o,l,c)}n&&(t.setTransform(1,0,0,1,0,0),t.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){const t=[];let e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const i=this._getLeftOffset(),n=this._getTopOffset(),s=this._getCursorBoundariesOffsets(t,e);return{left:i,top:n,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,i=0;const{charIndex:n,lineIndex:s}=this.get2DCursorLocation(t);for(let c=0;c<s;c++)e+=this.getHeightOfLine(c);const o=this._getLineLeftOffset(s),a=this.__charBounds[s][n];a&&(i=a.left),this.charSpacing!==0&&n===this._textLines[s].length&&(i-=this._getWidthOfCharSpacing());const l={top:e,left:o+(i>0?i:0)};return this.direction==="rtl"&&(this.textAlign===mi||this.textAlign===Yn||this.textAlign===wc?l.left*=-1:this.textAlign===je||this.textAlign===yu?l.left=o-(i>0?i:0):this.textAlign!==ue&&this.textAlign!==bc||(l.left=o-(i>0?i:0))),l}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const i=this.get2DCursorLocation(t),n=i.lineIndex,s=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,c=this.getValueOfPropertyAt(n,s,"deltaY"),h=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-l/2,top:h+e.top+c,width:l,height:o}}_renderCursor(t,e,i){const{color:n,opacity:s,left:o,top:a,width:l,height:c}=this.getCursorRenderingData(i,e);t.fillStyle=n,t.globalAlpha=s,t.fillRect(o,a,l,c)}renderSelection(t,e){const i={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,i,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,i){const n=e.selectionStart,s=e.selectionEnd,o=this.textAlign.includes(Yn),a=this.get2DCursorLocation(n),l=this.get2DCursorLocation(s),c=a.lineIndex,h=l.lineIndex,p=a.charIndex<0?0:a.charIndex,m=l.charIndex<0?0:l.charIndex;for(let f=c;f<=h;f++){const b=this._getLineLeftOffset(f)||0;let y=this.getHeightOfLine(f),_=0,x=0,E=0;if(f===c&&(x=this.__charBounds[c][p].left),f>=c&&f<h)E=o&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===h)if(m===0)E=this.__charBounds[h][m].left;else{const nt=this._getWidthOfCharSpacing();E=this.__charBounds[h][m-1].left+this.__charBounds[h][m-1].width-nt}_=y,(this.lineHeight<1||f===h&&this.lineHeight>1)&&(y/=this.lineHeight);let I=i.left+b+x,O=y,V=0;const Z=E-x;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",O=1,V=y):t.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===mi||this.textAlign===Yn||this.textAlign===wc?I=this.width-I-Z:this.textAlign===je||this.textAlign===yu?I=i.left+b-E:this.textAlign!==ue&&this.textAlign!==bc||(I=i.left+b-E)),t.fillRect(I,i.top+i.topOffset+V,Z,O),i.topOffset+=_}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,Ti)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}G(Kn,"ownDefaults",rx),G(Kn,"type","IText"),Dt.setClass(Kn),Dt.setClass(Kn,"i-text");class Xo extends Kn{static getDefaults(){return $($({},super.getDefaults()),Xo.ownDefaults)}constructor(t,e){super(t,$($({},Xo.ownDefaults),e))}static createControls(){return{controls:Wb()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Yn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,i=0,n=0;const s={};for(let o=0;o<t.graphemeLines.length;o++)t.graphemeText[n]===`
`&&o>0?(i=0,n++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[n])&&o>0&&(i++,n++),s[o]={line:e,offset:i},n+=t.graphemeLines[o].length,i+=t.graphemeLines[o].length;return s}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[e];i&&(e=i.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,i=0,n=t+1,s=!1;const o=this._styleMap[t],a=this._styleMap[t+1];o&&(t=o.line,i=o.offset),a&&(n=a.line,s=n===t,e=a.offset);const l=t===void 0?this.styles:{line:this.styles[t]};for(const c in l)for(const h in l[c]){const p=parseInt(h,10);if(p>=i&&(!s||p<e))for(const m in l[c][h])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[t];if(!i)return{};t=i.line,e=i.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,i){const n=this._styleMap[t];super._setStyleDeclaration(n.line,n.offset+e,i)}_deleteStyleDeclaration(t,e){const i=this._styleMap[t];super._deleteStyleDeclaration(i.line,i.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const i=this.getGraphemeDataForRender(t),n=[];for(let s=0;s<i.wordsData.length;s++)n.push(...this._wrapLine(s,e,i));return this.isWrapping=!1,n}getGraphemeDataForRender(t){const e=this.splitByGrapheme,i=e?"":" ";let n=0;return{wordsData:t.map(((s,o)=>{let a=0;const l=e?this.graphemeSplit(s):this.wordSplit(s);return l.length===0?[{word:[],width:0}]:l.map((c=>{const h=e?[c]:this.graphemeSplit(c),p=this._measureWord(h,o,a);return n=Math.max(p,n),a+=h.length+i.length,{word:h,width:p}}))})),largestWordWidth:n}}_measureWord(t,e){let i,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,a=t.length;o<a;o++)s+=this._getGraphemeBox(t[o],e,o+n,i,!0).kernedWidth,i=t[o];return s}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,i){let{largestWordWidth:n,wordsData:s}=i,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],h=l?"":" ";let p=0,m=[],f=0,b=0,y=!0;e-=o;const _=Math.max(e,n,this.dynamicMinWidth),x=s[t];let E;for(f=0,E=0;E<x.length;E++){const{word:I,width:O}=x[E];f+=I.length,p+=b+O-a,p>_&&!y?(c.push(m),m=[],p=O,y=!0):p+=a,y||l||m.push(h),m=m.concat(I),b=l?0:this._measureWord([h],t,f),f++,y=!1}return E&&c.push(m),n+o>this.dynamicMinWidth&&(this.dynamicMinWidth=n-a+o),c}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),i=this._wrapText(e.lines,this.width),n=new Array(i.length);for(let s=0;s<i.length;s++)n[s]=i[s].join("");return e.lines=n,e.graphemeLines=i,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const i=parseInt(e,10);if(this._textLines[i]){const n=this._styleMap[e].line;t.set("".concat(n),!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}G(Xo,"type","Textbox"),G(Xo,"textLayoutProperties",[...Kn.textLayoutProperties,"width"]),G(Xo,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),Dt.setClass(Xo);class G0 extends sd{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:i}=t,{clipPath:n,group:s}=i;if(!n||!this.shouldPerformLayout(t))return;const{width:o,height:a}=Qn(M2(i,n)),l=new ut(o,a);if(n.absolutePositioned)return{center:Zo(n.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:l};{const c=n.getRelativeCenterPoint().transform(i.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:h=new ut,correction:p=new ut}=this.calcBoundingBox(e,t)||{};return{center:h.add(c),correction:p.subtract(c),size:l}}return{center:i.getRelativeCenterPoint().add(c),size:l}}}}G(G0,"type","clip-path"),Dt.setClass(G0);class X0 extends sd{getInitialSize(t,e){let{target:i}=t,{size:n}=e;return new ut(i.width||n.x,i.height||n.y)}}G(X0,"type","fixed"),Dt.setClass(X0);class nx extends Oc{subscribeTargets(t){const e=t.target;t.targets.reduce(((i,n)=>(n.parent&&i.add(n.parent),i)),new Set).forEach((i=>{i.layoutManager.subscribeTargets({target:i,targets:[e]})}))}unsubscribeTargets(t){const e=t.target,i=e.getObjects();t.targets.reduce(((n,s)=>(s.parent&&n.add(s.parent),n)),new Set).forEach((n=>{!i.some((s=>s.parent===n))&&n.layoutManager.unsubscribeTargets({target:n,targets:[e]})}))}}class fo extends Wr{static getDefaults(){return $($({},super.getDefaults()),fo.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,fo.ownDefaults),this.setOptions(e);const{left:i,top:n,layoutManager:s}=e;this.groupInit(t,{left:i,top:n,layoutManager:s??new nx})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach((n=>{const s=this._objects.findIndex((a=>a.isInFrontOf(n))),o=s===-1?this.size():s;this.insertAt(o,n)}))}canEnterGroup(t){return this.getObjects().some((e=>e.isDescendantOf(t)||t.isDescendantOf(e)))?(js("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const i=new Set;e.forEach((n=>{const{parent:s}=n;s&&i.add(s)})),t===Kp?i.forEach((n=>{n._onAfterObjectsChange(ku,e)})):i.forEach((n=>{n._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const n=$($({hasControls:!1},i),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(t,n);super._renderControls(t,e),t.restore()}}G(fo,"type","ActiveSelection"),G(fo,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),Dt.setClass(fo),Dt.setClass(fo,"activeSelection");class sx{constructor(){G(this,"resources",{})}applyFilters(t,e,i,n,s){const o=s.getContext("2d");if(!o)return;o.drawImage(e,0,0,i,n);const a={sourceWidth:i,sourceHeight:n,imageData:o.getImageData(0,0,i,n),originalEl:e,originalImageData:o.getImageData(0,0,i,n),canvasEl:s,ctx:o,filterBackend:this};t.forEach((c=>{c.applyTo(a)}));const{imageData:l}=a;return l.width===i&&l.height===n||(s.width=l.width,s.height=l.height),o.putImageData(l,0,0),a}}class iv{constructor(){let{tileSize:t=Oe.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),G(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const i=Yr({width:t,height:e}),n=i.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});n&&(n.clearColor(0,0,0,0),this.canvas=i,this.gl=n)}applyFilters(t,e,i,n,s,o){const a=this.gl,l=s.getContext("2d");if(!a||!l)return;let c;o&&(c=this.getCachedTexture(o,e));const h={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:i,sourceHeight:n,destinationWidth:i,destinationHeight:n,context:a,sourceTexture:this.createTexture(a,i,n,c?void 0:e),targetTexture:this.createTexture(a,i,n),originalTexture:c||this.createTexture(a,i,n,c?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},p=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,p),t.forEach((m=>{m&&m.applyTo(h)})),(function(m){const f=m.targetCanvas,b=f.width,y=f.height,_=m.destinationWidth,x=m.destinationHeight;b===_&&y===x||(f.width=_,f.height=x)})(h),this.copyGLTo2D(a,h),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(h.sourceTexture),a.deleteTexture(h.targetTexture),a.deleteFramebuffer(p),l.setTransform(1,0,0,1,0,0),h}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,i,n,s){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:h,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:m,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:b}=t,y=t.createTexture();return t.bindTexture(a,y),t.texParameteri(a,p,s||o),t.texParameteri(a,m,s||o),t.texParameteri(a,f,h),t.texParameteri(a,b,h),n?t.texImage2D(a,0,l,l,c,n):t.texImage2D(a,0,l,e,i,0,l,c,null),y}getCachedTexture(t,e,i){const{textureCache:n}=this;if(n[t])return n[t];{const s=this.createTexture(this.gl,e.width,e.height,e,i);return s&&(n[t]=s),s}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const i=t.canvas,n=e.targetCanvas,s=n.getContext("2d");if(!s)return;s.translate(0,n.height),s.scale(1,-1);const o=i.height-n.height;s.drawImage(i,0,o,n.width,n.height,0,0,n.width,n.height)}copyGLTo2DPutImageData(t,e){const i=e.targetCanvas.getContext("2d"),n=e.destinationWidth,s=e.destinationHeight,o=n*s*4;if(!i)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,n,s,t.RGBA,t.UNSIGNED_BYTE,a);const c=new ImageData(l,n,s);i.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const i=t.getExtension("WEBGL_debug_renderer_info");if(i){const n=t.getParameter(i.UNMASKED_RENDERER_WEBGL),s=t.getParameter(i.UNMASKED_VENDOR_WEBGL);n&&(e.renderer=n.toLowerCase()),s&&(e.vendor=s.toLowerCase())}return this.gpuInfo=e,e}}let sf;function ox(){const{WebGLProbe:r}=is();return r.queryWebGL(rs()),Oe.enableGLFiltering&&r.isSupported(Oe.textureSize)?new iv({tileSize:Oe.textureSize}):new sx}function of(){return!sf&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(sf=ox()),sf}const ax=["filters","resizeFilter","src","crossOrigin","type"],rv=["cropX","cropY"];class rr extends nr{static getDefaults(){return $($({},super.getDefaults()),rr.ownDefaults)}constructor(t,e){super(),G(this,"_lastScaleX",1),G(this,"_lastScaleY",1),G(this,"_filterScalingX",1),G(this,"_filterScalingY",1),this.filters=[],Object.assign(this,rr.ownDefaults),this.setOptions(e),this.cacheKey="texture".concat(bo()),this.setElement(typeof t=="string"?(this.canvas&&kn(this.canvas.getElement())||sl()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){var e;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=t,this._originalElement=t,this._setWidthHeight(i),(e=t.classList)===null||e===void 0||e.add(rr.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=of(!1);e instanceof iv&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((t=>{const e=this[t];e&&is().dispose(e),this[t]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach((i=>{i&&e.push(i.toObject())})),$($({},super.toObject([...rv,...t])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,i=-this.width/2,n=-this.height/2;let s=[],o=[],a="",l="";if(!e)return[];if(this.hasCrop()){const c=bo();s.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+i+'" y="'+n+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(i-this.cropX,'" y="').concat(n-this.cropY,'" width="').concat(e.width||e.naturalWidth,'" height="').concat(e.height||e.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const c=this.fill;this.fill=null,o=['	<rect x="'.concat(i,'" y="').concat(n,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=c}return s=this.paintFirst!==Ti?s.concat(o,t):s.concat(t,o),s}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vc(t,{crossOrigin:e,signal:i}).then((n=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(n)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),n=i.x,s=i.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||n>e&&s>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=s);const a=Yr(o),{width:l,height:c}=o;this._element=a,this._lastScaleX=t.scaleX=n,this._lastScaleY=t.scaleY=s,of().applyFilters([t],o,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter((s=>s&&!s.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,i=e.naturalWidth||e.width,n=e.naturalHeight||e.height;if(this._element===this._originalElement){const s=Yr({width:i,height:n});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,n),this._lastScaleX=1,this._lastScaleY=1);of().applyFilters(t,this._originalElement,i,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const i=this._filterScalingX,n=this._filterScalingY,s=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=e.naturalWidth||e.width,h=e.naturalHeight||e.height,p=a*i,m=l*n,f=Math.min(s*i,c-p),b=Math.min(o*n,h-m),y=-s/2,_=-o/2,x=Math.min(s,c/i-a),E=Math.min(o,h/n-l);e&&t.drawImage(e,p,m,f,b,y,_,x,E)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=this.getOriginalSize();this.width=t||i.width,this.height=e||i.height}parsePreserveAspectRatioAttribute(){const t=Hp(this.preserveAspectRatio||""),e=this.width,i=this.height,n={width:e,height:i};let s,o=this._element.width,a=this._element.height,l=1,c=1,h=0,p=0,m=0,f=0;return!t||t.alignX===mr&&t.alignY===mr?(l=e/o,c=i/a):(t.meetOrSlice==="meet"&&(l=c=j2(this._element,n),s=(e-o*l)/2,t.alignX==="Min"&&(h=-s),t.alignX==="Max"&&(h=s),s=(i-a*c)/2,t.alignY==="Min"&&(p=-s),t.alignY==="Max"&&(p=s)),t.meetOrSlice==="slice"&&(l=c=F2(this._element,n),s=o-e/l,t.alignX==="Mid"&&(m=s/2),t.alignX==="Max"&&(m=s),s=a-i/c,t.alignY==="Mid"&&(f=s/2),t.alignY==="Max"&&(f=s),o=e/l,a=i/c)),{width:o,height:a,scaleX:l,scaleY:c,offsetLeft:h,offsetTop:p,cropX:m,cropY:f}}static fromObject(t,e){let{filters:i,resizeFilter:n,src:s,crossOrigin:o,type:a}=t,l=Ke(t,ax);return Promise.all([vc(s,$($({},e),{},{crossOrigin:o})),i&&Qa(i,e),n&&Qa([n],e),Ic(l,e)]).then((c=>{let[h,p=[],[m]=[],f={}]=c;return new this(h,$($({},l),{},{src:s,filters:p,resizeFilter:m},f))}))}static fromURL(t){let{crossOrigin:e=null,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return vc(t,{crossOrigin:e,signal:i}).then((s=>new this(s,n)))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const n=qs(t,this.ATTRIBUTE_NAMES,i);return this.fromURL(n["xlink:href"]||n.href,e,n).catch((s=>(js("log","Unable to parse Image",s),null)))}}function af(r){if(!gb.test(r.nodeName))return{};const t=r.getAttribute("viewBox");let e,i,n=1,s=1,o=0,a=0;const l=r.getAttribute("width"),c=r.getAttribute("height"),h=r.getAttribute("x")||0,p=r.getAttribute("y")||0,m=!(t&&C0.test(t)),f=!l||!c||l==="100%"||c==="100%";let b="",y=0,_=0;if(m&&(h||p)&&r.parentNode&&r.parentNode.nodeName!=="#document"&&(b=" translate("+fr(h||"0")+" "+fr(p||"0")+") ",e=(r.getAttribute("transform")||"")+b,r.setAttribute("transform",e),r.removeAttribute("x"),r.removeAttribute("y")),m&&f)return{width:0,height:0};const x={width:0,height:0};if(m)return x.width=fr(l),x.height=fr(c),x;const E=t.match(C0);o=-parseFloat(E[1]),a=-parseFloat(E[2]);const I=parseFloat(E[3]),O=parseFloat(E[4]);x.minX=o,x.minY=a,x.viewBoxWidth=I,x.viewBoxHeight=O,f?(x.width=I,x.height=O):(x.width=fr(l),x.height=fr(c),n=x.width/I,s=x.height/O);const V=Hp(r.getAttribute("preserveAspectRatio")||"");if(V.alignX!==mr&&(V.meetOrSlice==="meet"&&(s=n=n>s?s:n),V.meetOrSlice==="slice"&&(s=n=n>s?n:s),y=x.width-I*n,_=x.height-O*n,V.alignX==="Mid"&&(y/=2),V.alignY==="Mid"&&(_/=2),V.alignX==="Min"&&(y=0),V.alignY==="Min"&&(_=0)),n===1&&s===1&&o===0&&a===0&&h===0&&p===0)return x;if((h||p)&&r.parentNode.nodeName!=="#document"&&(b=" translate("+fr(h||"0")+" "+fr(p||"0")+") "),e=b+" matrix("+n+" 0 0 "+s+" "+(o*n+y)+" "+(a*s+_)+") ",r.nodeName==="svg"){for(i=r.ownerDocument.createElementNS(Kf,"g");r.firstChild;)i.appendChild(r.firstChild);r.appendChild(i)}else i=r,i.removeAttribute("x"),i.removeAttribute("y"),e=i.getAttribute("transform")+e;return i.setAttribute("transform",e),x}G(rr,"type","Image"),G(rr,"cacheProperties",[...Rs,...rv]),G(rr,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),G(rr,"CSS_CANVAS","canvas-img"),G(rr,"ATTRIBUTE_NAMES",[...xo,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),Dt.setClass(rr),Dt.setSVGClass(rr);const Ou=r=>r.tagName.replace("svg:",""),lx=td(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function nv(r,t){let e,i,n,s,o=[];for(n=0,s=t.length;n<s;n++)e=t[n],i=r.getElementsByTagNameNS("http://www.w3.org/2000/svg",e),o=o.concat(Array.from(i));return o}const cx=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],lf="xlink:href";function sv(r,t){var e;const i=((e=t.getAttribute(lf))===null||e===void 0?void 0:e.slice(1))||"",n=r.getElementById(i);if(n&&n.getAttribute(lf)&&sv(r,n),n&&(cx.forEach((s=>{const o=n.getAttribute(s);!t.hasAttribute(s)&&o&&t.setAttribute(s,o)})),!t.children.length)){const s=n.cloneNode(!0);for(;s.firstChild;)t.appendChild(s.firstChild)}t.removeAttribute(lf)}const hx=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"];function ux(r){const t=r.getElementsByTagName("style"),e={};for(let i=0;i<t.length;i++){const n=(t[i].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");n.trim()!==""&&n.split("}").filter(((s,o,a)=>a.length>1&&s.trim())).forEach((s=>{if((s.match(/{/g)||[]).length>1&&s.trim().startsWith("@"))return;const o=s.split("{"),a={},l=o[1].trim().split(";").filter((function(c){return c.trim()}));for(let c=0;c<l.length;c++){const h=l[c].split(":"),p=h[0].trim(),m=h[1].trim();a[p]=m}(s=o[0].trim()).split(",").forEach((c=>{(c=c.replace(/^svg/i,"").trim())!==""&&(e[c]=$($({},e[c]||{}),a))}))}))}return e}const $0=r=>Dt.getSVGClass(Ou(r).toLowerCase());class dx{constructor(t,e,i,n,s){this.elements=t,this.options=e,this.reviver=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=n,this.clipPaths=s,this.gradientDefs=(function(o){const a=nv(o,hx),l={};let c=a.length;for(;c--;){const h=a[c];h.getAttribute("xlink:href")&&sv(o,h);const p=h.getAttribute("id");p&&(l[p]=h)}return l})(n),this.cssRules=ux(n)}parse(){return Promise.all(this.elements.map((t=>this.createObject(t))))}async createObject(t){const e=$0(t);if(e){const i=await e.fromElement(t,this.options,this.cssRules);return this.resolveGradient(i,t,Ti),this.resolveGradient(i,t,vr),i instanceof rr&&i._originalElement?tu(i,i.parsePreserveAspectRatioAttribute()):tu(i),await this.resolveClipPath(i,t),this.reviver&&this.reviver(t,i),i}return null}extractPropertyDefinition(t,e,i){const n=t[e],s=this.regexUrl;if(!s.test(n))return;s.lastIndex=0;const o=s.exec(n)[1];return s.lastIndex=0,i[o]}resolveGradient(t,e,i){const n=this.extractPropertyDefinition(t,i,this.gradientDefs);if(n){const s=e.getAttribute(i+"-opacity"),o=Ra.fromElement(n,t,$($({},this.options),{},{opacity:s}));t.set(i,o)}}async resolveClipPath(t,e,i){const n=this.extractPropertyDefinition(t,"clipPath",this.clipPaths);if(n){const s=Ar(t.calcTransformMatrix()),o=n[0].parentElement;let a=e;for(;!i&&a.parentElement&&a.getAttribute("clip-path")!==t.clipPath;)a=a.parentElement;a.parentElement.appendChild(o);const l=Cu("".concat(a.getAttribute("transform")||""," ").concat(o.getAttribute("originalTransform")||""));o.setAttribute("transform","matrix(".concat(l.join(","),")"));const c=await Promise.all(n.map((E=>$0(E).fromElement(E,this.options,this.cssRules).then((I=>(tu(I),I.fillRule=I.clipRule,delete I.clipRule,I)))))),h=c.length===1?c[0]:new Wr(c),p=yi(s,h.calcTransformMatrix());h.clipPath&&await this.resolveClipPath(h,a,o.getAttribute("clip-path")?a:void 0);const{scaleX:m,scaleY:f,angle:b,skewX:y,translateX:_,translateY:x}=ta(p);h.set({flipX:!1,flipY:!1}),h.set({scaleX:m,scaleY:f,angle:b,skewX:y,skewY:0}),h.setPositionByOrigin(new ut(_,x),ue,ue),t.clipPath=h}else delete t.clipPath}}const K0=r=>pb.test(Ou(r)),sp=()=>({objects:[],elements:[],options:{},allElements:[]});async function ov(r,t){let{crossOrigin:e,signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(i&&i.aborted)return js("log",new Tp("parseSVGDocument")),sp();const n=r.documentElement;(function(h){const p=nv(h,["use","svg:use"]),m=["x","y","xlink:href","href","transform"];for(const f of p){const b=f.attributes,y={};for(const M of b)M.value&&(y[M.name]=M.value);const _=(y["xlink:href"]||y.href||"").slice(1);if(_==="")return;const x=h.getElementById(_);if(x===null)return;let E=x.cloneNode(!0);const I=E.attributes,O={};for(const M of I)M.value&&(O[M.name]=M.value);const{x:V=0,y:Z=0,transform:nt=""}=y,W="".concat(nt," ").concat(O.transform||""," translate(").concat(V,", ").concat(Z,")");if(af(E),/^svg$/i.test(E.nodeName)){const M=E.ownerDocument.createElementNS(Kf,"g");Object.entries(O).forEach((J=>{let[L,N]=J;return M.setAttributeNS(Kf,L,N)})),M.append(...E.childNodes),E=M}for(const M of b){if(!M)continue;const{name:J,value:L}=M;if(!m.includes(J))if(J==="style"){const N={};Qf(L,N),Object.entries(O).forEach((z=>{let[st,lt]=z;N[st]=lt})),Qf(O.style||"",N);const H=Object.entries(N).map((z=>z.join(":"))).join(";");E.setAttribute(J,H)}else!O[J]&&E.setAttribute(J,L)}E.setAttribute("transform",W),E.setAttribute("instantiated_by_use","1"),E.removeAttribute("id"),f.parentNode.replaceChild(E,f)}})(r);const s=Array.from(n.getElementsByTagName("*")),o=$($({},af(n)),{},{crossOrigin:e,signal:i}),a=s.filter((h=>(af(h),K0(h)&&!(function(p){let m=p;for(;m&&(m=m.parentElement);)if(m&&m.nodeName&&lx.test(Ou(m))&&!m.getAttribute("instantiated_by_use"))return!0;return!1})(h))));if(!a||a&&!a.length)return $($({},sp()),{},{options:o,allElements:s});const l={};return s.filter((h=>Ou(h)==="clipPath")).forEach((h=>{h.setAttribute("originalTransform",h.getAttribute("transform")||"");const p=h.getAttribute("id");l[p]=Array.from(h.getElementsByTagName("*")).filter((m=>K0(m)))})),{objects:await new dx(a,o,t,r,l).parse(),elements:a,options:o,allElements:s}}function fx(r,t,e){return ov(new(ol()).DOMParser().parseFromString(r.trim(),"text/xml"),t,e)}function px(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(((i,n)=>{Y2(r.replace(/^\n\s*/,"").trim(),{onComplete:s=>{const o=s.responseXML;o&&i(o),n()},signal:e.signal})})).then((i=>ov(i,t,e))).catch((()=>sp()))}const ad=r=>r.webgl!==void 0,Qp="precision highp float",gx=`
    `.concat(Qp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),mx=["type"],vx=["type"],wx=new RegExp(Qp,"g");class Ei{get type(){return this.constructor.type}constructor(){let t=Ke(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},mx);Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return gx}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:n="highp"}}=is();n!=="highp"&&(e=e.replace(wx,Qp.replace("highp",n)));const s=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER),a=t.createProgram();if(!s||!o||!a)throw new $n("Vertex, fragment shader or program creation error");if(t.shaderSource(s,i),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new $n("Vertex shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(s)));if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new $n("Fragment shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(o)));if(t.attachShader(a,s),t.attachShader(a,o),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new $n('Shader link error for "'.concat(this.type,'" ').concat(t.getProgramInfoLog(a)));const l=this.getUniformLocations(t,a)||{};return l.uStepW=t.getUniformLocation(a,"uStepW"),l.uStepH=t.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(t,a),uniformLocations:l}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const i=this.constructor.uniformLocations,n={};for(let s=0;s<i.length;s++)n[i[s]]=t.getUniformLocation(e,i[s]);return n}sendAttributeData(t,e,i){const n=e.aPosition,s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const i=t.destinationWidth,n=t.destinationHeight;t.sourceWidth===i&&t.sourceHeight===n||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,i,n)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){ad(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,i=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:i}=t,n=Yr({width:e,height:i});t.helpLayer=n}}toObject(){const t=Object.keys(this.constructor.defaults||{});return $({type:this.type},t.reduce(((e,i)=>(e[i]=this[i],e)),{}))}toJSON(){return this.toObject()}static async fromObject(t,e){return new this(Ke(t,vx))}}G(Ei,"type","BaseFilter"),G(Ei,"uniformLocations",[]);const bx={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Zl extends Ei{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(bx[this.mode],`
        }
      }
      `)}applyTo2d(t){let{imageData:{data:e}}=t;const i=new Er(this.color).getSource(),n=this.alpha,s=i[0]*n,o=i[1]*n,a=i[2]*n,l=1-n;for(let c=0;c<e.length;c+=4){const h=e[c],p=e[c+1],m=e[c+2];let f,b,y;switch(this.mode){case"multiply":f=h*s/255,b=p*o/255,y=m*a/255;break;case"screen":f=255-(255-h)*(255-s)/255,b=255-(255-p)*(255-o)/255,y=255-(255-m)*(255-a)/255;break;case"add":f=h+s,b=p+o,y=m+a;break;case"difference":f=Math.abs(h-s),b=Math.abs(p-o),y=Math.abs(m-a);break;case"subtract":f=h-s,b=p-o,y=m-a;break;case"darken":f=Math.min(h,s),b=Math.min(p,o),y=Math.min(m,a);break;case"lighten":f=Math.max(h,s),b=Math.max(p,o),y=Math.max(m,a);break;case"overlay":f=s<128?2*h*s/255:255-2*(255-h)*(255-s)/255,b=o<128?2*p*o/255:255-2*(255-p)*(255-o)/255,y=a<128?2*m*a/255:255-2*(255-m)*(255-a)/255;break;case"exclusion":f=s+h-2*s*h/255,b=o+p-2*o*p/255,y=a+m-2*a*m/255;break;case"tint":f=s+h*l,b=o+p*l,y=a+m*l}e[c]=f,e[c+1]=b,e[c+2]=y}}sendUniformData(t,e){const i=new Er(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,t.uniform4fv(e.uColor,i)}}G(Zl,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),G(Zl,"type","BlendColor"),G(Zl,"uniformLocations",["uColor"]),Dt.setClass(Zl);const yx={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},xx=["type","image"];class Jl extends Ei{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return yx[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:i}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]}applyTo2d(t){let{imageData:{data:e,width:i,height:n},filterBackend:{resources:s}}=t;const o=this.image;s.blendImage||(s.blendImage=rs());const a=s.blendImage,l=a.getContext("2d");a.width!==i||a.height!==n?(a.width=i,a.height=n):l.clearRect(0,0,i,n),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,i,n);const c=l.getImageData(0,0,i,n).data;for(let h=0;h<e.length;h+=4){const p=e[h],m=e[h+1],f=e[h+2],b=e[h+3],y=c[h],_=c[h+1],x=c[h+2],E=c[h+3];switch(this.mode){case"multiply":e[h]=p*y/255,e[h+1]=m*_/255,e[h+2]=f*x/255,e[h+3]=b*E/255;break;case"mask":e[h+3]=E}}}sendUniformData(t,e){const i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)}toObject(){return $($({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(t,e){let{type:i,image:n}=t,s=Ke(t,xx);return rr.fromObject(n,e).then((o=>new this($($({},s),{},{image:o}))))}}G(Jl,"type","BlendImage"),G(Jl,"defaults",{mode:"multiply",alpha:1}),G(Jl,"uniformLocations",["uTransformMatrix","uImage"]),Dt.setClass(Jl);class Ql extends Ei{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){ad(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:i,height:n}}=t;this.aspectRatio=i/n,this.horizontal=!0;let s=this.getBlurValue()*i;const o=new Uint8ClampedArray(e),a=15,l=4*i;for(let c=0;c<e.length;c+=4){let h=0,p=0,m=0,f=0,b=0;const y=c-c%l,_=y+l;for(let x=-14;x<a;x++){const E=x/a,I=4*Math.floor(s*E),O=1-Math.abs(E);let V=c+I;V<y?V=y:V>_&&(V=_);const Z=e[V+3]*O;h+=e[V]*Z,p+=e[V+1]*Z,m+=e[V+2]*Z,f+=Z,b+=O}o[c]=h/f,o[c+1]=p/f,o[c+2]=m/f,o[c+3]=f/b}this.horizontal=!1,s=this.getBlurValue()*n;for(let c=0;c<o.length;c+=4){let h=0,p=0,m=0,f=0,b=0;const y=c%l,_=o.length-l+y;for(let x=-14;x<a;x++){const E=x/a,I=Math.floor(s*E)*l,O=1-Math.abs(E);let V=c+I;V<y?V=y:V>_&&(V=_);const Z=o[V+3]*O;h+=o[V]*Z,p+=o[V+1]*Z,m+=o[V+2]*Z,f+=Z,b+=O}e[c]=h/f,e[c+1]=p/f,e[c+2]=m/f,e[c+3]=f/b}}sendUniformData(t,e){const i=this.chooseRightDelta();t.uniform2fv(e.uDelta,i)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1;const{horizontal:e,aspectRatio:i}=this;return e?i>1&&(t=1/i):i<1&&(t=i),t*this.blur*.12}chooseRightDelta(){const t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}}G(Ql,"type","Blur"),G(Ql,"defaults",{blur:0}),G(Ql,"uniformLocations",["uDelta"]),Dt.setClass(Ql);class tc extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=Math.round(255*this.brightness);for(let n=0;n<e.length;n+=4)e[n]+=i,e[n+1]+=i,e[n+2]+=i}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}G(tc,"type","Brightness"),G(tc,"defaults",{brightness:0}),G(tc,"uniformLocations",["uBrightness"]),Dt.setClass(tc);const av={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class $o extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,i=this.matrix,n=this.colorsOnly;for(let s=0;s<e.length;s+=4){const o=e[s],a=e[s+1],l=e[s+2];if(e[s]=o*i[0]+a*i[1]+l*i[2]+255*i[4],e[s+1]=o*i[5]+a*i[6]+l*i[7]+255*i[9],e[s+2]=o*i[10]+a*i[11]+l*i[12]+255*i[14],!n){const c=e[s+3];e[s]+=c*i[3],e[s+1]+=c*i[8],e[s+2]+=c*i[13],e[s+3]=o*i[15]+a*i[16]+l*i[17]+c*i[18]+255*i[19]}}}sendUniformData(t,e){const i=this.matrix,n=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],s=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,n),t.uniform4fv(e.uConstants,s)}toObject(){return $($({},super.toObject()),{},{matrix:[...this.matrix]})}}function la(r,t){var e;const i=(G(e=class extends $o{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),G(e,"defaults",{colorsOnly:!1,matrix:t}),e);return Dt.setClass(i,r),i}G($o,"type","ColorMatrix"),G($o,"defaults",av),G($o,"uniformLocations",["uColorMatrix","uConstants"]),Dt.setClass($o);const _x=la("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),Sx=la("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),Cx=la("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),kx=la("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),Ax=la("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),Lx=la("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),Tx=la("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class op extends Ei{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){ad(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach((e=>{e.applyTo(t)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((t=>t.toObject()))}}isNeutralState(){return!this.subFilters.some((t=>!t.isNeutralState()))}static fromObject(t,e){return Promise.all((t.subFilters||[]).map((i=>Dt.getClass(i.type).fromObject(i,e)))).then((i=>new this({subFilters:i})))}}G(op,"type","Composed"),Dt.setClass(op);class ec extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const i=Math.floor(255*this.contrast),n=259*(i+255)/(255*(259-i));for(let s=0;s<e.length;s+=4)e[s]=n*(e[s]-128)+128,e[s+1]=n*(e[s+1]-128)+128,e[s+2]=n*(e[s+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}G(ec,"type","Contrast"),G(ec,"defaults",{contrast:0}),G(ec,"uniformLocations",["uContrast"]),Dt.setClass(ec);const Ex={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class ic extends Ei{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return Ex[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,i=e.data,n=this.matrix,s=Math.round(Math.sqrt(n.length)),o=Math.floor(s/2),a=e.width,l=e.height,c=t.ctx.createImageData(a,l),h=c.data,p=this.opaque?1:0;let m,f,b,y,_,x,E,I,O,V,Z,nt,W;for(Z=0;Z<l;Z++)for(V=0;V<a;V++){for(_=4*(Z*a+V),m=0,f=0,b=0,y=0,W=0;W<s;W++)for(nt=0;nt<s;nt++)E=Z+W-o,x=V+nt-o,E<0||E>=l||x<0||x>=a||(I=4*(E*a+x),O=n[W*s+nt],m+=i[I]*O,f+=i[I+1]*O,b+=i[I+2]*O,p||(y+=i[I+3]*O));h[_]=m,h[_+1]=f,h[_+2]=b,h[_+3]=p?i[_+3]:y}t.imageData=c}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return $($({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}G(ic,"type","Convolute"),G(ic,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),G(ic,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),Dt.setClass(ic);const lv="Gamma";class rc extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const i=this.gamma,n=1/i[0],s=1/i[1],o=1/i[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,n),a.g[l]=255*Math.pow(l/255,s),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<e.length;l+=4)e[l]=a.r[e[l]],e[l+1]=a.g[e[l+1]],e[l+2]=a.b[e[l+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:lv,gamma:this.gamma.concat()}}}G(rc,"type",lv),G(rc,"defaults",{gamma:[1,1,1]}),G(rc,"uniformLocations",["uGamma"]),Dt.setClass(rc);const Ox={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class nc extends Ei{applyTo2d(t){let{imageData:{data:e}}=t;for(let i,n=0;n<e.length;n+=4){const s=e[n],o=e[n+1],a=e[n+2];switch(this.mode){case"average":i=(s+o+a)/3;break;case"lightness":i=(Math.min(s,o,a)+Math.max(s,o,a))/2;break;case"luminosity":i=.21*s+.72*o+.07*a}e[n+2]=e[n+1]=e[n]=i}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Ox[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}G(nc,"type","Grayscale"),G(nc,"defaults",{mode:"average"}),G(nc,"uniformLocations",["uMode"]),Dt.setClass(nc);const Px=$($({},av),{},{rotation:0});class iu extends $o{calculateMatrix(){const t=this.rotation*Math.PI,e=Tn(t),i=En(t),n=1/3,s=Math.sqrt(n)*i,o=1-e;this.matrix=[e+o/3,n*o-s,n*o+s,0,0,n*o+s,e+n*o,n*o-s,0,0,n*o-s,n*o+s,e+n*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}G(iu,"type","HueRotation"),G(iu,"defaults",Px),Dt.setClass(iu);class sc extends Ei{applyTo2d(t){let{imageData:{data:e}}=t;for(let i=0;i<e.length;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2],this.alpha&&(e[i+3]=255-e[i+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}G(sc,"type","Invert"),G(sc,"defaults",{alpha:!1,invert:!0}),G(sc,"uniformLocations",["uInvert","uAlpha"]),Dt.setClass(sc);class oc extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=this.noise;for(let n=0;n<e.length;n+=4){const s=(.5-Math.random())*i;e[n]+=s,e[n+1]+=s,e[n+2]+=s}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}G(oc,"type","Noise"),G(oc,"defaults",{noise:0}),G(oc,"uniformLocations",["uNoise","uSeed"]),Dt.setClass(oc);class ac extends Ei{applyTo2d(t){let{imageData:{data:e,width:i,height:n}}=t;for(let s=0;s<n;s+=this.blocksize)for(let o=0;o<i;o+=this.blocksize){const a=4*s*i+4*o,l=e[a],c=e[a+1],h=e[a+2],p=e[a+3];for(let m=s;m<Math.min(s+this.blocksize,n);m++)for(let f=o;f<Math.min(o+this.blocksize,i);f++){const b=4*m*i+4*f;e[b]=l,e[b+1]=c,e[b+2]=h,e[b+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}G(ac,"type","Pixelate"),G(ac,"defaults",{blocksize:4}),G(ac,"uniformLocations",["uBlocksize"]),Dt.setClass(ac);class lc extends Ei{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=255*this.distance,n=new Er(this.color).getSource(),s=[n[0]-i,n[1]-i,n[2]-i],o=[n[0]+i,n[1]+i,n[2]+i];for(let a=0;a<e.length;a+=4){const l=e[a],c=e[a+1],h=e[a+2];l>s[0]&&c>s[1]&&h>s[2]&&l<o[0]&&c<o[1]&&h<o[2]&&(e[a+3]=0)}}sendUniformData(t,e){const i=new Er(this.color).getSource(),n=this.distance,s=[0+i[0]/255-n,0+i[1]/255-n,0+i[2]/255-n,1],o=[i[0]/255+n,i[1]/255+n,i[2]/255+n,1];t.uniform4fv(e.uLow,s),t.uniform4fv(e.uHigh,o)}}G(lc,"type","RemoveColor"),G(lc,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),G(lc,"uniformLocations",["uLow","uHigh"]),Dt.setClass(lc);class cc extends Ei{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return"".concat(this.type,"_").concat(t)}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),n=new Array(i);for(let s=1;s<=i;s++)n[s-1]=t(s*e);return n}generateShader(t){const e=new Array(t);for(let i=1;i<=t;i++)e[i-1]="".concat(i,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(t,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(e.map(((i,n)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(i,") * uTaps[").concat(n,"] + texture2D(uTexture, vTexCoord - ").concat(i,") * uTaps[").concat(n,`];
              sum += 2.0 * uTaps[`).concat(n,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){ad(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const i=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(i)/i}}applyTo2d(t){const e=t.imageData,i=this.scaleX,n=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/n;const s=e.width,o=e.height,a=Math.round(s*i),l=Math.round(o*n);let c;c=this.resizeType==="sliceHack"?this.sliceByTwo(t,s,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(t,s,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(t,s,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(t,s,o,a,l):new ImageData(a,l),t.imageData=c}sliceByTwo(t,e,i,n,s){const o=t.imageData,a=.5;let l=!1,c=!1,h=e*a,p=i*a;const m=t.filterBackend.resources;let f=0,b=0;const y=e;let _=0;m.sliceByTwo||(m.sliceByTwo=rs());const x=m.sliceByTwo;(x.width<1.5*e||x.height<i)&&(x.width=1.5*e,x.height=i);const E=x.getContext("2d");for(E.clearRect(0,0,1.5*e,i),E.putImageData(o,0,0),n=Math.floor(n),s=Math.floor(s);!l||!c;)e=h,i=p,n<Math.floor(h*a)?h=Math.floor(h*a):(h=n,l=!0),s<Math.floor(p*a)?p=Math.floor(p*a):(p=s,c=!0),E.drawImage(x,f,b,e,i,y,_,h,p),f=y,b=_,_+=p;return E.getImageData(f,b,n,s)}lanczosResize(t,e,i,n,s){const o=t.imageData.data,a=t.ctx.createImageData(n,s),l=a.data,c=this.lanczosCreate(this.lanczosLobes),h=this.rcpScaleX,p=this.rcpScaleY,m=2/this.rcpScaleX,f=2/this.rcpScaleY,b=Math.ceil(h*this.lanczosLobes/2),y=Math.ceil(p*this.lanczosLobes/2),_={},x={x:0,y:0},E={x:0,y:0};return(function I(O){let V,Z,nt,W,M,J,L,N,H,z,st;for(x.x=(O+.5)*h,E.x=Math.floor(x.x),V=0;V<s;V++){for(x.y=(V+.5)*p,E.y=Math.floor(x.y),M=0,J=0,L=0,N=0,H=0,Z=E.x-b;Z<=E.x+b;Z++)if(!(Z<0||Z>=e)){z=Math.floor(1e3*Math.abs(Z-x.x)),_[z]||(_[z]={});for(let lt=E.y-y;lt<=E.y+y;lt++)lt<0||lt>=i||(st=Math.floor(1e3*Math.abs(lt-x.y)),_[z][st]||(_[z][st]=c(Math.sqrt(Math.pow(z*m,2)+Math.pow(st*f,2))/1e3)),nt=_[z][st],nt>0&&(W=4*(lt*e+Z),M+=nt,J+=nt*o[W],L+=nt*o[W+1],N+=nt*o[W+2],H+=nt*o[W+3]))}W=4*(V*n+O),l[W]=J/M,l[W+1]=L/M,l[W+2]=N/M,l[W+3]=H/M}return++O<n?I(O):a})(0)}bilinearFiltering(t,e,i,n,s){let o,a,l,c,h,p,m,f,b,y,_,x,E,I=0;const O=this.rcpScaleX,V=this.rcpScaleY,Z=4*(e-1),nt=t.imageData.data,W=t.ctx.createImageData(n,s),M=W.data;for(m=0;m<s;m++)for(f=0;f<n;f++)for(h=Math.floor(O*f),p=Math.floor(V*m),b=O*f-h,y=V*m-p,E=4*(p*e+h),_=0;_<4;_++)o=nt[E+_],a=nt[E+4+_],l=nt[E+Z+_],c=nt[E+Z+4+_],x=o*(1-b)*(1-y)+a*b*(1-y)+l*y*(1-b)+c*b*y,M[I++]=x;return W}hermiteFastResize(t,e,i,n,s){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),c=Math.ceil(a/2),h=t.imageData.data,p=t.ctx.createImageData(n,s),m=p.data;for(let f=0;f<s;f++)for(let b=0;b<n;b++){const y=4*(b+f*n);let _=0,x=0,E=0,I=0,O=0,V=0,Z=0;const nt=(f+.5)*a;for(let W=Math.floor(f*a);W<(f+1)*a;W++){const M=Math.abs(nt-(W+.5))/c,J=(b+.5)*o,L=M*M;for(let N=Math.floor(b*o);N<(b+1)*o;N++){let H=Math.abs(J-(N+.5))/l;const z=Math.sqrt(L+H*H);z>1&&z<-1||(_=2*z*z*z-3*z*z+1,_>0&&(H=4*(N+W*e),Z+=_*h[H+3],E+=_,h[H+3]<255&&(_=_*h[H+3]/250),I+=_*h[H],O+=_*h[H+1],V+=_*h[H+2],x+=_))}}m[y]=I/x,m[y+1]=O/x,m[y+2]=V/x,m[y+3]=Z/E}return p}}G(cc,"type","Resize"),G(cc,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),G(cc,"uniformLocations",["uDelta","uTaps"]),Dt.setClass(cc);class hc extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=-this.saturation;for(let n=0;n<e.length;n+=4){const s=e[n],o=e[n+1],a=e[n+2],l=Math.max(s,o,a);e[n]+=l!==s?(l-s)*i:0,e[n+1]+=l!==o?(l-o)*i:0,e[n+2]+=l!==a?(l-a)*i:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}G(hc,"type","Saturation"),G(hc,"defaults",{saturation:0}),G(hc,"uniformLocations",["uSaturation"]),Dt.setClass(hc);class uc extends Ei{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=-this.vibrance;for(let n=0;n<e.length;n+=4){const s=e[n],o=e[n+1],a=e[n+2],l=Math.max(s,o,a),c=(s+o+a)/3,h=2*Math.abs(l-c)/255*i;e[n]+=l!==s?(l-s)*h:0,e[n+1]+=l!==o?(l-o)*h:0,e[n+2]+=l!==a?(l-a)*h:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}G(uc,"type","Vibrance"),G(uc,"defaults",{vibrance:0}),G(uc,"uniformLocations",["uVibrance"]),Dt.setClass(uc);var Nx=Object.freeze({__proto__:null,BaseFilter:Ei,BlackWhite:Tx,BlendColor:Zl,BlendImage:Jl,Blur:Ql,Brightness:tc,Brownie:_x,ColorMatrix:$o,Composed:op,Contrast:ec,Convolute:ic,Gamma:rc,Grayscale:nc,HueRotation:iu,Invert:sc,Kodachrome:Cx,Noise:oc,Pixelate:ac,Polaroid:Ax,RemoveColor:lc,Resize:cc,Saturation:hc,Sepia:Lx,Technicolor:kx,Vibrance:uc,Vintage:Sx});const Z0={rect:r=>new gr(r),circle:r=>(r.width&&!r.radius&&(r.radius=r.width/2),new Vn(r)),triangle:r=>new ho(r),star:r=>{const t=[{x:350,y:75},{x:380,y:160},{x:470,y:160},{x:400,y:215},{x:423,y:301},{x:350,y:250},{x:277,y:301},{x:303,y:215},{x:231,y:161},{x:321,y:161}],e=new uo(t,{...r,objectCaching:!1});return e.scaleToWidth(r.width||100),e},pentagon:r=>{const t=[{x:50,y:0},{x:100,y:38},{x:82,y:100},{x:18,y:100},{x:0,y:38}],e=new uo(t,{...r,objectCaching:!1});return e.scaleToWidth(r.width||100),e},hexagon:r=>{const t=[{x:50,y:0},{x:100,y:25},{x:100,y:75},{x:50,y:100},{x:0,y:75},{x:0,y:25}],e=new uo(t,{...r,objectCaching:!1});return e.scaleToWidth(r.width||100),e},arrow:r=>{const t=[{x:0,y:25},{x:50,y:25},{x:50,y:0},{x:100,y:50},{x:50,y:100},{x:50,y:75},{x:0,y:75}],e=new uo(t,{...r,objectCaching:!1});return e.scaleToWidth(r.width||100),e},heart:r=>{const t="M 272.70141,238.71731         C 206.46141,238.71731 152.70141,292.47731 152.70141,358.71731          C 152.70141,493.46231 288.63461,521.28716 381.92956,598.5043         C 468.52458,519.8324 611.16641,496.06231 611.16641,358.71731         C 611.16641,292.47731 557.40641,238.71731 491.16641,238.71731         C 449.12141,238.71731 411.66641,262.11731 381.92956,298.5043         C 352.19271,262.11731 314.73141,238.71731 272.70141,238.71731          z",e=new Gn(t,{...r,objectCaching:!1});return e.scaleToWidth(r.width||100),e},message_box:r=>{const t="M20,2H4C2.9,2,2,2.9,2,4v18l4-4h14c1.1,0,2-0.9,2-2V4C22,2.9,21.1,2,20,2z",e=new Gn(t,{...r,objectCaching:!1});return e.scaleToWidth(r.width||100),e}},Dx=(r,t)=>Z0[r]?Z0[r](t):(console.warn(`Shape type "${r}" not found in config.`),null);class Mx{constructor(t){this.canvas=t,this.undoStack=[],this.redoStack=[],this.locked=!1,this.maxDepth=20,this.saveState()}saveState(){if(this.locked)return;const t=JSON.stringify(this.canvas.toJSON());this.undoStack.push(t),this.undoStack.length>this.maxDepth&&this.undoStack.shift(),this.redoStack=[]}async undo(){if(this.undoStack.length<=1)return;this.locked=!0;const t=this.undoStack.pop();this.redoStack.push(t);const e=this.undoStack[this.undoStack.length-1];await this.loadState(e),this.locked=!1}async redo(){if(this.redoStack.length===0)return;this.locked=!0;const t=this.redoStack.pop();this.undoStack.push(t),await this.loadState(t),this.locked=!1}async loadState(t){return new Promise(e=>{this.canvas.loadFromJSON(JSON.parse(t),()=>{this.canvas.requestRenderAll(),e()})})}}function cv(r,t,e){if(typeof r=="function"?r===t:r.has(t))return arguments.length<3?t:e;throw new TypeError("Private element is not present on this object")}function Ix(r,t){if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J0(r,t){return r.get(cv(r,t))}function jx(r,t,e){Ix(r,t),t.set(r,e)}function Fx(r,t,e){return r.set(cv(r,t),e),e}const Bx=100,Gt={},Rx=()=>{Gt.previousActiveElement instanceof HTMLElement?(Gt.previousActiveElement.focus(),Gt.previousActiveElement=null):document.body&&document.body.focus()},qx=r=>new Promise(t=>{if(!r)return t();const e=window.scrollX,i=window.scrollY;Gt.restoreFocusTimeout=setTimeout(()=>{Rx(),t()},Bx),window.scrollTo(e,i)}),hv="swal2-",zx=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],gt=zx.reduce((r,t)=>(r[t]=hv+t,r),{}),Hx=["success","warning","info","question","error"],Pu=Hx.reduce((r,t)=>(r[t]=hv+t,r),{}),uv="SweetAlert2:",tg=r=>r.charAt(0).toUpperCase()+r.slice(1),yr=r=>{console.warn(`${uv} ${typeof r=="object"?r.join(" "):r}`)},ca=r=>{console.error(`${uv} ${r}`)},Q0=[],Ux=r=>{Q0.includes(r)||(Q0.push(r),yr(r))},dv=(r,t=null)=>{Ux(`"${r}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},ld=r=>typeof r=="function"?r():r,eg=r=>r&&typeof r.toPromise=="function",Fc=r=>eg(r)?r.toPromise():Promise.resolve(r),ig=r=>r&&Promise.resolve(r)===r,xr=()=>document.body.querySelector(`.${gt.container}`),Bc=r=>{const t=xr();return t?t.querySelector(r):null},Xr=r=>Bc(`.${r}`),Pe=()=>Xr(gt.popup),dl=()=>Xr(gt.icon),Wx=()=>Xr(gt["icon-content"]),fv=()=>Xr(gt.title),rg=()=>Xr(gt["html-container"]),pv=()=>Xr(gt.image),ng=()=>Xr(gt["progress-steps"]),cd=()=>Xr(gt["validation-message"]),ss=()=>Bc(`.${gt.actions} .${gt.confirm}`),fl=()=>Bc(`.${gt.actions} .${gt.cancel}`),ha=()=>Bc(`.${gt.actions} .${gt.deny}`),Vx=()=>Xr(gt["input-label"]),pl=()=>Bc(`.${gt.loader}`),Rc=()=>Xr(gt.actions),gv=()=>Xr(gt.footer),hd=()=>Xr(gt["timer-progress-bar"]),sg=()=>Xr(gt.close),Yx=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,og=()=>{const r=Pe();if(!r)return[];const t=r.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),e=Array.from(t).sort((s,o)=>{const a=parseInt(s.getAttribute("tabindex")||"0"),l=parseInt(o.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),i=r.querySelectorAll(Yx),n=Array.from(i).filter(s=>s.getAttribute("tabindex")!=="-1");return[...new Set(e.concat(n))].filter(s=>Tr(s))},ag=()=>Ms(document.body,gt.shown)&&!Ms(document.body,gt["toast-shown"])&&!Ms(document.body,gt["no-backdrop"]),ud=()=>{const r=Pe();return r?Ms(r,gt.toast):!1},Gx=()=>{const r=Pe();return r?r.hasAttribute("data-loading"):!1},$r=(r,t)=>{if(r.textContent="",t){const i=new DOMParser().parseFromString(t,"text/html"),n=i.querySelector("head");n&&Array.from(n.childNodes).forEach(o=>{r.appendChild(o)});const s=i.querySelector("body");s&&Array.from(s.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?r.appendChild(o.cloneNode(!0)):r.appendChild(o)})}},Ms=(r,t)=>{if(!t)return!1;const e=t.split(/\s+/);for(let i=0;i<e.length;i++)if(!r.classList.contains(e[i]))return!1;return!0},Xx=(r,t)=>{Array.from(r.classList).forEach(e=>{!Object.values(gt).includes(e)&&!Object.values(Pu).includes(e)&&!Object.values(t.showClass||{}).includes(e)&&r.classList.remove(e)})},Gr=(r,t,e)=>{if(Xx(r,t),!t.customClass)return;const i=t.customClass[e];if(i){if(typeof i!="string"&&!i.forEach){yr(`Invalid type of customClass.${e}! Expected string or iterable object, got "${typeof i}"`);return}Ne(r,i)}},dd=(r,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return r.querySelector(`.${gt.popup} > .${gt[t]}`);case"checkbox":return r.querySelector(`.${gt.popup} > .${gt.checkbox} input`);case"radio":return r.querySelector(`.${gt.popup} > .${gt.radio} input:checked`)||r.querySelector(`.${gt.popup} > .${gt.radio} input:first-child`);case"range":return r.querySelector(`.${gt.popup} > .${gt.range} input`);default:return r.querySelector(`.${gt.popup} > .${gt.input}`)}},mv=r=>{if(r.focus(),r.type!=="file"){const t=r.value;r.value="",r.value=t}},vv=(r,t,e)=>{!r||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(i=>{Array.isArray(r)?r.forEach(n=>{e?n.classList.add(i):n.classList.remove(i)}):e?r.classList.add(i):r.classList.remove(i)}))},Ne=(r,t)=>{vv(r,t,!0)},cn=(r,t)=>{vv(r,t,!1)},po=(r,t)=>{const e=Array.from(r.children);for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof HTMLElement&&Ms(n,t))return n}},Jo=(r,t,e)=>{e===`${parseInt(`${e}`)}`&&(e=parseInt(e)),e||parseInt(`${e}`)===0?r.style.setProperty(t,typeof e=="number"?`${e}px`:e):r.style.removeProperty(t)},Bi=(r,t="flex")=>{r&&(r.style.display=t)},sr=r=>{r&&(r.style.display="none")},lg=(r,t="block")=>{r&&new MutationObserver(()=>{qc(r,r.innerHTML,t)}).observe(r,{childList:!0,subtree:!0})},tm=(r,t,e,i)=>{const n=r.querySelector(t);n&&n.style.setProperty(e,i)},qc=(r,t,e="flex")=>{t?Bi(r,e):sr(r)},Tr=r=>!!(r&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length)),$x=()=>!Tr(ss())&&!Tr(ha())&&!Tr(fl()),ap=r=>r.scrollHeight>r.clientHeight,Kx=(r,t)=>{let e=r;for(;e&&e!==t;){if(ap(e))return!0;e=e.parentElement}return!1},wv=r=>{const t=window.getComputedStyle(r),e=parseFloat(t.getPropertyValue("animation-duration")||"0"),i=parseFloat(t.getPropertyValue("transition-duration")||"0");return e>0||i>0},cg=(r,t=!1)=>{const e=hd();e&&Tr(e)&&(t&&(e.style.transition="none",e.style.width="100%"),setTimeout(()=>{e.style.transition=`width ${r/1e3}s linear`,e.style.width="0%"},10))},Zx=()=>{const r=hd();if(!r)return;const t=parseInt(window.getComputedStyle(r).width);r.style.removeProperty("transition"),r.style.width="100%";const e=parseInt(window.getComputedStyle(r).width),i=t/e*100;r.style.width=`${i}%`},Jx=()=>typeof window>"u"||typeof document>"u",Qx=`
 <div aria-labelledby="${gt.title}" aria-describedby="${gt["html-container"]}" class="${gt.popup}" tabindex="-1">
   <button type="button" class="${gt.close}"></button>
   <ul class="${gt["progress-steps"]}"></ul>
   <div class="${gt.icon}"></div>
   <img class="${gt.image}" />
   <h2 class="${gt.title}" id="${gt.title}"></h2>
   <div class="${gt["html-container"]}" id="${gt["html-container"]}"></div>
   <input class="${gt.input}" id="${gt.input}" />
   <input type="file" class="${gt.file}" />
   <div class="${gt.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${gt.select}" id="${gt.select}"></select>
   <div class="${gt.radio}"></div>
   <label class="${gt.checkbox}">
     <input type="checkbox" id="${gt.checkbox}" />
     <span class="${gt.label}"></span>
   </label>
   <textarea class="${gt.textarea}" id="${gt.textarea}"></textarea>
   <div class="${gt["validation-message"]}" id="${gt["validation-message"]}"></div>
   <div class="${gt.actions}">
     <div class="${gt.loader}"></div>
     <button type="button" class="${gt.confirm}"></button>
     <button type="button" class="${gt.deny}"></button>
     <button type="button" class="${gt.cancel}"></button>
   </div>
   <div class="${gt.footer}"></div>
   <div class="${gt["timer-progress-bar-container"]}">
     <div class="${gt["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),t_=()=>{const r=xr();return r?(r.remove(),cn([document.documentElement,document.body],[gt["no-backdrop"],gt["toast-shown"],gt["has-column"]]),!0):!1},qo=()=>{Gt.currentInstance.resetValidationMessage()},e_=()=>{const r=Pe(),t=po(r,gt.input),e=po(r,gt.file),i=r.querySelector(`.${gt.range} input`),n=r.querySelector(`.${gt.range} output`),s=po(r,gt.select),o=r.querySelector(`.${gt.checkbox} input`),a=po(r,gt.textarea);t.oninput=qo,e.onchange=qo,s.onchange=qo,o.onchange=qo,a.oninput=qo,i.oninput=()=>{qo(),n.value=i.value},i.onchange=()=>{qo(),n.value=i.value}},i_=r=>typeof r=="string"?document.querySelector(r):r,r_=r=>{const t=Pe();t.setAttribute("role",r.toast?"alert":"dialog"),t.setAttribute("aria-live",r.toast?"polite":"assertive"),r.toast||t.setAttribute("aria-modal","true")},n_=r=>{window.getComputedStyle(r).direction==="rtl"&&(Ne(xr(),gt.rtl),Gt.isRTL=!0)},s_=r=>{const t=t_();if(Jx()){ca("SweetAlert2 requires document to initialize");return}const e=document.createElement("div");e.className=gt.container,t&&Ne(e,gt["no-transition"]),$r(e,Qx),e.dataset.swal2Theme=r.theme;const i=i_(r.target);i.appendChild(e),r.topLayer&&(e.setAttribute("popover",""),e.showPopover()),r_(r),n_(i),e_()},hg=(r,t)=>{r instanceof HTMLElement?t.appendChild(r):typeof r=="object"?o_(r,t):r&&$r(t,r)},o_=(r,t)=>{r.jquery?a_(t,r):$r(t,r.toString())},a_=(r,t)=>{if(r.textContent="",0 in t)for(let e=0;e in t;e++)r.appendChild(t[e].cloneNode(!0));else r.appendChild(t.cloneNode(!0))},l_=(r,t)=>{const e=Rc(),i=pl();!e||!i||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?sr(e):Bi(e),Gr(e,t,"actions"),c_(e,i,t),$r(i,t.loaderHtml||""),Gr(i,t,"loader"))};function c_(r,t,e){const i=ss(),n=ha(),s=fl();!i||!n||!s||(hf(i,"confirm",e),hf(n,"deny",e),hf(s,"cancel",e),h_(i,n,s,e),e.reverseButtons&&(e.toast?(r.insertBefore(s,i),r.insertBefore(n,i)):(r.insertBefore(s,t),r.insertBefore(n,t),r.insertBefore(i,t))))}function h_(r,t,e,i){if(!i.buttonsStyling){cn([r,t,e],gt.styled);return}Ne([r,t,e],gt.styled),i.confirmButtonColor&&r.style.setProperty("--swal2-confirm-button-background-color",i.confirmButtonColor),i.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",i.denyButtonColor),i.cancelButtonColor&&e.style.setProperty("--swal2-cancel-button-background-color",i.cancelButtonColor),cf(r),cf(t),cf(e)}function cf(r){const t=window.getComputedStyle(r);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const e=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");r.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${e}`))}function hf(r,t,e){const i=tg(t);qc(r,e[`show${i}Button`],"inline-block"),$r(r,e[`${t}ButtonText`]||""),r.setAttribute("aria-label",e[`${t}ButtonAriaLabel`]||""),r.className=gt[t],Gr(r,e,`${t}Button`)}const u_=(r,t)=>{const e=sg();e&&($r(e,t.closeButtonHtml||""),Gr(e,t,"closeButton"),qc(e,t.showCloseButton),e.setAttribute("aria-label",t.closeButtonAriaLabel||""))},d_=(r,t)=>{const e=xr();e&&(f_(e,t.backdrop),p_(e,t.position),g_(e,t.grow),Gr(e,t,"container"))};function f_(r,t){typeof t=="string"?r.style.background=t:t||Ne([document.documentElement,document.body],gt["no-backdrop"])}function p_(r,t){t&&(t in gt?Ne(r,gt[t]):(yr('The "position" parameter is not valid, defaulting to "center"'),Ne(r,gt.center)))}function g_(r,t){t&&Ne(r,gt[`grow-${t}`])}var Ge={innerParams:new WeakMap,domCache:new WeakMap};const m_=["input","file","range","select","radio","checkbox","textarea"],v_=(r,t)=>{const e=Pe();if(!e)return;const i=Ge.innerParams.get(r),n=!i||t.input!==i.input;m_.forEach(s=>{const o=po(e,gt[s]);o&&(y_(s,t.inputAttributes),o.className=gt[s],n&&sr(o))}),t.input&&(n&&w_(t),x_(t))},w_=r=>{if(!r.input)return;if(!gi[r.input]){ca(`Unexpected type of input! Expected ${Object.keys(gi).join(" | ")}, got "${r.input}"`);return}const t=bv(r.input);if(!t)return;const e=gi[r.input](t,r);Bi(t),r.inputAutoFocus&&setTimeout(()=>{mv(e)})},b_=r=>{for(let t=0;t<r.attributes.length;t++){const e=r.attributes[t].name;["id","type","value","style"].includes(e)||r.removeAttribute(e)}},y_=(r,t)=>{const e=Pe();if(!e)return;const i=dd(e,r);if(i){b_(i);for(const n in t)i.setAttribute(n,t[n])}},x_=r=>{if(!r.input)return;const t=bv(r.input);t&&Gr(t,r,"input")},ug=(r,t)=>{!r.placeholder&&t.inputPlaceholder&&(r.placeholder=t.inputPlaceholder)},zc=(r,t,e)=>{if(e.inputLabel){const i=document.createElement("label"),n=gt["input-label"];i.setAttribute("for",r.id),i.className=n,typeof e.customClass=="object"&&Ne(i,e.customClass.inputLabel),i.innerText=e.inputLabel,t.insertAdjacentElement("beforebegin",i)}},bv=r=>{const t=Pe();if(t)return po(t,gt[r]||gt.input)},Nu=(r,t)=>{["string","number"].includes(typeof t)?r.value=`${t}`:ig(t)||yr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},gi={};gi.text=gi.email=gi.password=gi.number=gi.tel=gi.url=gi.search=gi.date=gi["datetime-local"]=gi.time=gi.week=gi.month=(r,t)=>(Nu(r,t.inputValue),zc(r,r,t),ug(r,t),r.type=t.input,r);gi.file=(r,t)=>(zc(r,r,t),ug(r,t),r);gi.range=(r,t)=>{const e=r.querySelector("input"),i=r.querySelector("output");return Nu(e,t.inputValue),e.type=t.input,Nu(i,t.inputValue),zc(e,r,t),r};gi.select=(r,t)=>{if(r.textContent="",t.inputPlaceholder){const e=document.createElement("option");$r(e,t.inputPlaceholder),e.value="",e.disabled=!0,e.selected=!0,r.appendChild(e)}return zc(r,r,t),r};gi.radio=r=>(r.textContent="",r);gi.checkbox=(r,t)=>{const e=dd(Pe(),"checkbox");e.value="1",e.checked=!!t.inputValue;const i=r.querySelector("span");return $r(i,t.inputPlaceholder||t.inputLabel),e};gi.textarea=(r,t)=>{Nu(r,t.inputValue),ug(r,t),zc(r,r,t);const e=i=>parseInt(window.getComputedStyle(i).marginLeft)+parseInt(window.getComputedStyle(i).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const i=parseInt(window.getComputedStyle(Pe()).width),n=()=>{if(!document.body.contains(r))return;const s=r.offsetWidth+e(r);s>i?Pe().style.width=`${s}px`:Jo(Pe(),"width",t.width)};new MutationObserver(n).observe(r,{attributes:!0,attributeFilter:["style"]})}}),r};const __=(r,t)=>{const e=rg();e&&(lg(e),Gr(e,t,"htmlContainer"),t.html?(hg(t.html,e),Bi(e,"block")):t.text?(e.textContent=t.text,Bi(e,"block")):sr(e),v_(r,t))},S_=(r,t)=>{const e=gv();e&&(lg(e),qc(e,!!t.footer,"block"),t.footer&&hg(t.footer,e),Gr(e,t,"footer"))},C_=(r,t)=>{const e=Ge.innerParams.get(r),i=dl();if(!i)return;if(e&&t.icon===e.icon){im(i,t),em(i,t);return}if(!t.icon&&!t.iconHtml){sr(i);return}if(t.icon&&Object.keys(Pu).indexOf(t.icon)===-1){ca(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),sr(i);return}Bi(i),im(i,t),em(i,t),Ne(i,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",yv)},em=(r,t)=>{for(const[e,i]of Object.entries(Pu))t.icon!==e&&cn(r,i);Ne(r,t.icon&&Pu[t.icon]),L_(r,t),yv(),Gr(r,t,"icon")},yv=()=>{const r=Pe();if(!r)return;const t=window.getComputedStyle(r).getPropertyValue("background-color"),e=r.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let i=0;i<e.length;i++)e[i].style.backgroundColor=t},k_=r=>`
  ${r.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${r.animation?'<div class="swal2-success-fix"></div>':""}
  ${r.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,A_=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,im=(r,t)=>{if(!t.icon&&!t.iconHtml)return;let e=r.innerHTML,i="";t.iconHtml?i=rm(t.iconHtml):t.icon==="success"?(i=k_(t),e=e.replace(/ style=".*?"/g,"")):t.icon==="error"?i=A_:t.icon&&(i=rm({question:"?",warning:"!",info:"i"}[t.icon])),e.trim()!==i.trim()&&$r(r,i)},L_=(r,t)=>{if(t.iconColor){r.style.color=t.iconColor,r.style.borderColor=t.iconColor;for(const e of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])tm(r,e,"background-color",t.iconColor);tm(r,".swal2-success-ring","border-color",t.iconColor)}},rm=r=>`<div class="${gt["icon-content"]}">${r}</div>`,T_=(r,t)=>{const e=pv();if(e){if(!t.imageUrl){sr(e);return}Bi(e,""),e.setAttribute("src",t.imageUrl),e.setAttribute("alt",t.imageAlt||""),Jo(e,"width",t.imageWidth),Jo(e,"height",t.imageHeight),e.className=gt.image,Gr(e,t,"image")}};let dg=!1,xv=0,_v=0,Sv=0,Cv=0;const E_=r=>{r.addEventListener("mousedown",Du),document.body.addEventListener("mousemove",Mu),r.addEventListener("mouseup",Iu),r.addEventListener("touchstart",Du),document.body.addEventListener("touchmove",Mu),r.addEventListener("touchend",Iu)},O_=r=>{r.removeEventListener("mousedown",Du),document.body.removeEventListener("mousemove",Mu),r.removeEventListener("mouseup",Iu),r.removeEventListener("touchstart",Du),document.body.removeEventListener("touchmove",Mu),r.removeEventListener("touchend",Iu)},Du=r=>{const t=Pe();if(r.target===t||dl().contains(r.target)){dg=!0;const e=kv(r);xv=e.clientX,_v=e.clientY,Sv=parseInt(t.style.insetInlineStart)||0,Cv=parseInt(t.style.insetBlockStart)||0,Ne(t,"swal2-dragging")}},Mu=r=>{const t=Pe();if(dg){let{clientX:e,clientY:i}=kv(r);const n=e-xv;t.style.insetInlineStart=`${Sv+(Gt.isRTL?-n:n)}px`,t.style.insetBlockStart=`${Cv+(i-_v)}px`}},Iu=()=>{const r=Pe();dg=!1,cn(r,"swal2-dragging")},kv=r=>{let t=0,e=0;return r.type.startsWith("mouse")?(t=r.clientX,e=r.clientY):r.type.startsWith("touch")&&(t=r.touches[0].clientX,e=r.touches[0].clientY),{clientX:t,clientY:e}},P_=(r,t)=>{const e=xr(),i=Pe();if(!(!e||!i)){if(t.toast){Jo(e,"width",t.width),i.style.width="100%";const n=pl();n&&i.insertBefore(n,dl())}else Jo(i,"width",t.width);Jo(i,"padding",t.padding),t.color&&(i.style.color=t.color),t.background&&(i.style.background=t.background),sr(cd()),N_(i,t),t.draggable&&!t.toast?(Ne(i,gt.draggable),E_(i)):(cn(i,gt.draggable),O_(i))}},N_=(r,t)=>{const e=t.showClass||{};r.className=`${gt.popup} ${Tr(r)?e.popup:""}`,t.toast?(Ne([document.documentElement,document.body],gt["toast-shown"]),Ne(r,gt.toast)):Ne(r,gt.modal),Gr(r,t,"popup"),typeof t.customClass=="string"&&Ne(r,t.customClass),t.icon&&Ne(r,gt[`icon-${t.icon}`])},D_=(r,t)=>{const e=ng();if(!e)return;const{progressSteps:i,currentProgressStep:n}=t;if(!i||i.length===0||n===void 0){sr(e);return}Bi(e),e.textContent="",n>=i.length&&yr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),i.forEach((s,o)=>{const a=M_(s);if(e.appendChild(a),o===n&&Ne(a,gt["active-progress-step"]),o!==i.length-1){const l=I_(t);e.appendChild(l)}})},M_=r=>{const t=document.createElement("li");return Ne(t,gt["progress-step"]),$r(t,r),t},I_=r=>{const t=document.createElement("li");return Ne(t,gt["progress-step-line"]),r.progressStepsDistance&&Jo(t,"width",r.progressStepsDistance),t},j_=(r,t)=>{const e=fv();e&&(lg(e),qc(e,!!(t.title||t.titleText),"block"),t.title&&hg(t.title,e),t.titleText&&(e.innerText=t.titleText),Gr(e,t,"title"))},Av=(r,t)=>{P_(r,t),d_(r,t),D_(r,t),C_(r,t),T_(r,t),j_(r,t),u_(r,t),__(r,t),l_(r,t),S_(r,t);const e=Pe();typeof t.didRender=="function"&&e&&t.didRender(e),Gt.eventEmitter.emit("didRender",e)},F_=()=>Tr(Pe()),Lv=()=>{var r;return(r=ss())===null||r===void 0?void 0:r.click()},B_=()=>{var r;return(r=ha())===null||r===void 0?void 0:r.click()},R_=()=>{var r;return(r=fl())===null||r===void 0?void 0:r.click()},gl=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Tv=r=>{r.keydownTarget&&r.keydownHandlerAdded&&(r.keydownTarget.removeEventListener("keydown",r.keydownHandler,{capture:r.keydownListenerCapture}),r.keydownHandlerAdded=!1)},q_=(r,t,e)=>{Tv(r),t.toast||(r.keydownHandler=i=>H_(t,i,e),r.keydownTarget=t.keydownListenerCapture?window:Pe(),r.keydownListenerCapture=t.keydownListenerCapture,r.keydownTarget.addEventListener("keydown",r.keydownHandler,{capture:r.keydownListenerCapture}),r.keydownHandlerAdded=!0)},lp=(r,t)=>{var e;const i=og();if(i.length){r=r+t,r===-2&&(r=i.length-1),r===i.length?r=0:r===-1&&(r=i.length-1),i[r].focus();return}(e=Pe())===null||e===void 0||e.focus()},Ev=["ArrowRight","ArrowDown"],z_=["ArrowLeft","ArrowUp"],H_=(r,t,e)=>{r&&(t.isComposing||t.keyCode===229||(r.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?U_(t,r):t.key==="Tab"?W_(t):[...Ev,...z_].includes(t.key)?V_(t.key):t.key==="Escape"&&Y_(t,r,e)))},U_=(r,t)=>{if(!ld(t.allowEnterKey))return;const e=dd(Pe(),t.input);if(r.target&&e&&r.target instanceof HTMLElement&&r.target.outerHTML===e.outerHTML){if(["textarea","file"].includes(t.input))return;Lv(),r.preventDefault()}},W_=r=>{const t=r.target,e=og();let i=-1;for(let n=0;n<e.length;n++)if(t===e[n]){i=n;break}r.shiftKey?lp(i,-1):lp(i,1),r.stopPropagation(),r.preventDefault()},V_=r=>{const t=Rc(),e=ss(),i=ha(),n=fl();if(!t||!e||!i||!n)return;const s=[e,i,n];if(document.activeElement instanceof HTMLElement&&!s.includes(document.activeElement))return;const o=Ev.includes(r)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<t.children.length;l++){if(a=a[o],!a)return;if(a instanceof HTMLButtonElement&&Tr(a))break}a instanceof HTMLButtonElement&&a.focus()}},Y_=(r,t,e)=>{r.preventDefault(),ld(t.allowEscapeKey)&&e(gl.esc)};var il={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const G_=()=>{const r=xr();Array.from(document.body.children).forEach(e=>{e.contains(r)||(e.hasAttribute("aria-hidden")&&e.setAttribute("data-previous-aria-hidden",e.getAttribute("aria-hidden")||""),e.setAttribute("aria-hidden","true"))})},Ov=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},Pv=typeof window<"u"&&!!window.GestureEvent,X_=()=>{if(Pv&&!Ms(document.body,gt.iosfix)){const r=document.body.scrollTop;document.body.style.top=`${r*-1}px`,Ne(document.body,gt.iosfix),$_()}},$_=()=>{const r=xr();if(!r)return;let t;r.ontouchstart=e=>{t=K_(e)},r.ontouchmove=e=>{t&&(e.preventDefault(),e.stopPropagation())}},K_=r=>{const t=r.target,e=xr(),i=rg();return!e||!i||Z_(r)||J_(r)?!1:t===e||!ap(e)&&t instanceof HTMLElement&&!Kx(t,i)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(ap(i)&&i.contains(t))},Z_=r=>r.touches&&r.touches.length&&r.touches[0].touchType==="stylus",J_=r=>r.touches&&r.touches.length>1,Q_=()=>{if(Ms(document.body,gt.iosfix)){const r=parseInt(document.body.style.top,10);cn(document.body,gt.iosfix),document.body.style.top="",document.body.scrollTop=r*-1}},tS=()=>{const r=document.createElement("div");r.className=gt["scrollbar-measure"],document.body.appendChild(r);const t=r.getBoundingClientRect().width-r.clientWidth;return document.body.removeChild(r),t};let Wa=null;const eS=r=>{Wa===null&&(document.body.scrollHeight>window.innerHeight||r==="scroll")&&(Wa=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Wa+tS()}px`)},iS=()=>{Wa!==null&&(document.body.style.paddingRight=`${Wa}px`,Wa=null)};function Nv(r,t,e,i){ud()?nm(r,i):(qx(e).then(()=>nm(r,i)),Tv(Gt)),Pv?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),ag()&&(iS(),Q_(),Ov()),rS()}function rS(){cn([document.documentElement,document.body],[gt.shown,gt["height-auto"],gt["no-backdrop"],gt["toast-shown"]])}function go(r){r=sS(r);const t=il.swalPromiseResolve.get(this),e=nS(this);this.isAwaitingPromise?r.isDismissed||(Hc(this),t(r)):e&&t(r)}const nS=r=>{const t=Pe();if(!t)return!1;const e=Ge.innerParams.get(r);if(!e||Ms(t,e.hideClass.popup))return!1;cn(t,e.showClass.popup),Ne(t,e.hideClass.popup);const i=xr();return cn(i,e.showClass.backdrop),Ne(i,e.hideClass.backdrop),oS(r,t,e),!0};function Dv(r){const t=il.swalPromiseReject.get(this);Hc(this),t&&t(r)}const Hc=r=>{r.isAwaitingPromise&&(delete r.isAwaitingPromise,Ge.innerParams.get(r)||r._destroy())},sS=r=>typeof r>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},r),oS=(r,t,e)=>{var i;const n=xr(),s=wv(t);typeof e.willClose=="function"&&e.willClose(t),(i=Gt.eventEmitter)===null||i===void 0||i.emit("willClose",t),s?aS(r,t,n,e.returnFocus,e.didClose):Nv(r,n,e.returnFocus,e.didClose)},aS=(r,t,e,i,n)=>{Gt.swalCloseEventFinishedCallback=Nv.bind(null,r,e,i,n);const s=function(o){if(o.target===t){var a;(a=Gt.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Gt),delete Gt.swalCloseEventFinishedCallback,t.removeEventListener("animationend",s),t.removeEventListener("transitionend",s)}};t.addEventListener("animationend",s),t.addEventListener("transitionend",s)},nm=(r,t)=>{setTimeout(()=>{var e;typeof t=="function"&&t.bind(r.params)(),(e=Gt.eventEmitter)===null||e===void 0||e.emit("didClose"),r._destroy&&r._destroy()})},rl=r=>{let t=Pe();if(t||new Ya,t=Pe(),!t)return;const e=pl();ud()?sr(dl()):lS(t,r),Bi(e),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},lS=(r,t)=>{const e=Rc(),i=pl();!e||!i||(!t&&Tr(ss())&&(t=ss()),Bi(e),t&&(sr(t),i.setAttribute("data-button-to-replace",t.className),e.insertBefore(i,t)),Ne([r,e],gt.loading))},cS=(r,t)=>{t.input==="select"||t.input==="radio"?pS(r,t):["text","email","number","tel","textarea"].some(e=>e===t.input)&&(eg(t.inputValue)||ig(t.inputValue))&&(rl(ss()),gS(r,t))},hS=(r,t)=>{const e=r.getInput();if(!e)return null;switch(t.input){case"checkbox":return uS(e);case"radio":return dS(e);case"file":return fS(e);default:return t.inputAutoTrim?e.value.trim():e.value}},uS=r=>r.checked?1:0,dS=r=>r.checked?r.value:null,fS=r=>r.files&&r.files.length?r.getAttribute("multiple")!==null?r.files:r.files[0]:null,pS=(r,t)=>{const e=Pe();if(!e)return;const i=n=>{t.input==="select"?mS(e,ju(n),t):t.input==="radio"&&vS(e,ju(n),t)};eg(t.inputOptions)||ig(t.inputOptions)?(rl(ss()),Fc(t.inputOptions).then(n=>{r.hideLoading(),i(n)})):typeof t.inputOptions=="object"?i(t.inputOptions):ca(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},gS=(r,t)=>{const e=r.getInput();e&&(sr(e),Fc(t.inputValue).then(i=>{e.value=t.input==="number"?`${parseFloat(i)||0}`:`${i}`,Bi(e),e.focus(),r.hideLoading()}).catch(i=>{ca(`Error in inputValue promise: ${i}`),e.value="",Bi(e),e.focus(),r.hideLoading()}))};function mS(r,t,e){const i=po(r,gt.select);if(!i)return;const n=(s,o,a)=>{const l=document.createElement("option");l.value=a,$r(l,o),l.selected=Mv(a,e.inputValue),s.appendChild(l)};t.forEach(s=>{const o=s[0],a=s[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=o,l.disabled=!1,i.appendChild(l),a.forEach(c=>n(l,c[1],c[0]))}else n(i,a,o)}),i.focus()}function vS(r,t,e){const i=po(r,gt.radio);if(!i)return;t.forEach(s=>{const o=s[0],a=s[1],l=document.createElement("input"),c=document.createElement("label");l.type="radio",l.name=gt.radio,l.value=o,Mv(o,e.inputValue)&&(l.checked=!0);const h=document.createElement("span");$r(h,a),h.className=gt.label,c.appendChild(l),c.appendChild(h),i.appendChild(c)});const n=i.querySelectorAll("input");n.length&&n[0].focus()}const ju=r=>{const t=[];return r instanceof Map?r.forEach((e,i)=>{let n=e;typeof n=="object"&&(n=ju(n)),t.push([i,n])}):Object.keys(r).forEach(e=>{let i=r[e];typeof i=="object"&&(i=ju(i)),t.push([e,i])}),t},Mv=(r,t)=>!!t&&t.toString()===r.toString(),wS=r=>{const t=Ge.innerParams.get(r);r.disableButtons(),t.input?Iv(r,"confirm"):pg(r,!0)},bS=r=>{const t=Ge.innerParams.get(r);r.disableButtons(),t.returnInputValueOnDeny?Iv(r,"deny"):fg(r,!1)},yS=(r,t)=>{r.disableButtons(),t(gl.cancel)},Iv=(r,t)=>{const e=Ge.innerParams.get(r);if(!e.input){ca(`The "input" parameter is needed to be set when using returnInputValueOn${tg(t)}`);return}const i=r.getInput(),n=hS(r,e);e.inputValidator?xS(r,n,t):i&&!i.checkValidity()?(r.enableButtons(),r.showValidationMessage(e.validationMessage||i.validationMessage)):t==="deny"?fg(r,n):pg(r,n)},xS=(r,t,e)=>{const i=Ge.innerParams.get(r);r.disableInput(),Promise.resolve().then(()=>Fc(i.inputValidator(t,i.validationMessage))).then(s=>{r.enableButtons(),r.enableInput(),s?r.showValidationMessage(s):e==="deny"?fg(r,t):pg(r,t)})},fg=(r,t)=>{const e=Ge.innerParams.get(r||void 0);e.showLoaderOnDeny&&rl(ha()),e.preDeny?(r.isAwaitingPromise=!0,Promise.resolve().then(()=>Fc(e.preDeny(t,e.validationMessage))).then(n=>{n===!1?(r.hideLoading(),Hc(r)):r.close({isDenied:!0,value:typeof n>"u"?t:n})}).catch(n=>jv(r||void 0,n))):r.close({isDenied:!0,value:t})},sm=(r,t)=>{r.close({isConfirmed:!0,value:t})},jv=(r,t)=>{r.rejectPromise(t)},pg=(r,t)=>{const e=Ge.innerParams.get(r||void 0);e.showLoaderOnConfirm&&rl(),e.preConfirm?(r.resetValidationMessage(),r.isAwaitingPromise=!0,Promise.resolve().then(()=>Fc(e.preConfirm(t,e.validationMessage))).then(n=>{Tr(cd())||n===!1?(r.hideLoading(),Hc(r)):sm(r,typeof n>"u"?t:n)}).catch(n=>jv(r||void 0,n))):sm(r,t)};function Fu(){const r=Ge.innerParams.get(this);if(!r)return;const t=Ge.domCache.get(this);sr(t.loader),ud()?r.icon&&Bi(dl()):_S(t),cn([t.popup,t.actions],gt.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const _S=r=>{const t=r.popup.getElementsByClassName(r.loader.getAttribute("data-button-to-replace"));t.length?Bi(t[0],"inline-block"):$x()&&sr(r.actions)};function Fv(){const r=Ge.innerParams.get(this),t=Ge.domCache.get(this);return t?dd(t.popup,r.input):null}function Bv(r,t,e){const i=Ge.domCache.get(r);t.forEach(n=>{i[n].disabled=e})}function Rv(r,t){const e=Pe();if(!(!e||!r))if(r.type==="radio"){const i=e.querySelectorAll(`[name="${gt.radio}"]`);for(let n=0;n<i.length;n++)i[n].disabled=t}else r.disabled=t}function qv(){Bv(this,["confirmButton","denyButton","cancelButton"],!1)}function zv(){Bv(this,["confirmButton","denyButton","cancelButton"],!0)}function Hv(){Rv(this.getInput(),!1)}function Uv(){Rv(this.getInput(),!0)}function Wv(r){const t=Ge.domCache.get(this),e=Ge.innerParams.get(this);$r(t.validationMessage,r),t.validationMessage.className=gt["validation-message"],e.customClass&&e.customClass.validationMessage&&Ne(t.validationMessage,e.customClass.validationMessage),Bi(t.validationMessage);const i=this.getInput();i&&(i.setAttribute("aria-invalid","true"),i.setAttribute("aria-describedby",gt["validation-message"]),mv(i),Ne(i,gt.inputerror))}function Vv(){const r=Ge.domCache.get(this);r.validationMessage&&sr(r.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),cn(t,gt.inputerror))}const Va={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},SS=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],CS={allowEnterKey:void 0},kS=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Yv=r=>Object.prototype.hasOwnProperty.call(Va,r),Gv=r=>SS.indexOf(r)!==-1,Xv=r=>CS[r],AS=r=>{Yv(r)||yr(`Unknown parameter "${r}"`)},LS=r=>{kS.includes(r)&&yr(`The parameter "${r}" is incompatible with toasts`)},TS=r=>{const t=Xv(r);t&&dv(r,t)},$v=r=>{r.backdrop===!1&&r.allowOutsideClick&&yr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),r.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(r.theme)&&yr(`Invalid theme "${r.theme}"`);for(const t in r)AS(t),r.toast&&LS(t),TS(t)};function Kv(r){const t=xr(),e=Pe(),i=Ge.innerParams.get(this);if(!e||Ms(e,i.hideClass.popup)){yr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const n=ES(r),s=Object.assign({},i,n);$v(s),t.dataset.swal2Theme=s.theme,Av(this,s),Ge.innerParams.set(this,s),Object.defineProperties(this,{params:{value:Object.assign({},this.params,r),writable:!1,enumerable:!0}})}const ES=r=>{const t={};return Object.keys(r).forEach(e=>{Gv(e)?t[e]=r[e]:yr(`Invalid parameter to update: ${e}`)}),t};function Zv(){const r=Ge.domCache.get(this),t=Ge.innerParams.get(this);if(!t){Jv(this);return}r.popup&&Gt.swalCloseEventFinishedCallback&&(Gt.swalCloseEventFinishedCallback(),delete Gt.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),Gt.eventEmitter.emit("didDestroy"),OS(this)}const OS=r=>{Jv(r),delete r.params,delete Gt.keydownHandler,delete Gt.keydownTarget,delete Gt.currentInstance},Jv=r=>{r.isAwaitingPromise?(uf(Ge,r),r.isAwaitingPromise=!0):(uf(il,r),uf(Ge,r),delete r.isAwaitingPromise,delete r.disableButtons,delete r.enableButtons,delete r.getInput,delete r.disableInput,delete r.enableInput,delete r.hideLoading,delete r.disableLoading,delete r.showValidationMessage,delete r.resetValidationMessage,delete r.close,delete r.closePopup,delete r.closeModal,delete r.closeToast,delete r.rejectPromise,delete r.update,delete r._destroy)},uf=(r,t)=>{for(const e in r)r[e].delete(t)};var PS=Object.freeze({__proto__:null,_destroy:Zv,close:go,closeModal:go,closePopup:go,closeToast:go,disableButtons:zv,disableInput:Uv,disableLoading:Fu,enableButtons:qv,enableInput:Hv,getInput:Fv,handleAwaitingPromise:Hc,hideLoading:Fu,rejectPromise:Dv,resetValidationMessage:Vv,showValidationMessage:Wv,update:Kv});const NS=(r,t,e)=>{r.toast?DS(r,t,e):(IS(t),jS(t),FS(r,t,e))},DS=(r,t,e)=>{t.popup.onclick=()=>{r&&(MS(r)||r.timer||r.input)||e(gl.close)}},MS=r=>!!(r.showConfirmButton||r.showDenyButton||r.showCancelButton||r.showCloseButton);let Bu=!1;const IS=r=>{r.popup.onmousedown=()=>{r.container.onmouseup=function(t){r.container.onmouseup=()=>{},t.target===r.container&&(Bu=!0)}}},jS=r=>{r.container.onmousedown=t=>{t.target===r.container&&t.preventDefault(),r.popup.onmouseup=function(e){r.popup.onmouseup=()=>{},(e.target===r.popup||e.target instanceof HTMLElement&&r.popup.contains(e.target))&&(Bu=!0)}}},FS=(r,t,e)=>{t.container.onclick=i=>{if(Bu){Bu=!1;return}i.target===t.container&&ld(r.allowOutsideClick)&&e(gl.backdrop)}},BS=r=>typeof r=="object"&&r.jquery,om=r=>r instanceof Element||BS(r),RS=r=>{const t={};return typeof r[0]=="object"&&!om(r[0])?Object.assign(t,r[0]):["title","html","icon"].forEach((e,i)=>{const n=r[i];typeof n=="string"||om(n)?t[e]=n:n!==void 0&&ca(`Unexpected type of ${e}! Expected "string" or "Element", got ${typeof n}`)}),t};function qS(...r){return new this(...r)}function zS(r){class t extends this{_main(i,n){return super._main(i,Object.assign({},r,n))}}return t}const HS=()=>Gt.timeout&&Gt.timeout.getTimerLeft(),Qv=()=>{if(Gt.timeout)return Zx(),Gt.timeout.stop()},t5=()=>{if(Gt.timeout){const r=Gt.timeout.start();return cg(r),r}},US=()=>{const r=Gt.timeout;return r&&(r.running?Qv():t5())},WS=r=>{if(Gt.timeout){const t=Gt.timeout.increase(r);return cg(t,!0),t}},VS=()=>!!(Gt.timeout&&Gt.timeout.isRunning());let am=!1;const cp={};function YS(r="data-swal-template"){cp[r]=this,am||(document.body.addEventListener("click",GS),am=!0)}const GS=r=>{for(let t=r.target;t&&t!==document;t=t.parentNode)for(const e in cp){const i=t.getAttribute(e);if(i){cp[e].fire({template:i});return}}};class XS{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,e){const i=this._getHandlersByEventName(t);i.includes(e)||i.push(e)}once(t,e){const i=(...n)=>{this.removeListener(t,i),e.apply(this,n)};this.on(t,i)}emit(t,...e){this._getHandlersByEventName(t).forEach(i=>{try{i.apply(this,e)}catch(n){console.error(n)}})}removeListener(t,e){const i=this._getHandlersByEventName(t),n=i.indexOf(e);n>-1&&i.splice(n,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}Gt.eventEmitter=new XS;const $S=(r,t)=>{Gt.eventEmitter.on(r,t)},KS=(r,t)=>{Gt.eventEmitter.once(r,t)},ZS=(r,t)=>{if(!r){Gt.eventEmitter.reset();return}t?Gt.eventEmitter.removeListener(r,t):Gt.eventEmitter.removeAllListeners(r)};var JS=Object.freeze({__proto__:null,argsToParams:RS,bindClickHandler:YS,clickCancel:R_,clickConfirm:Lv,clickDeny:B_,enableLoading:rl,fire:qS,getActions:Rc,getCancelButton:fl,getCloseButton:sg,getConfirmButton:ss,getContainer:xr,getDenyButton:ha,getFocusableElements:og,getFooter:gv,getHtmlContainer:rg,getIcon:dl,getIconContent:Wx,getImage:pv,getInputLabel:Vx,getLoader:pl,getPopup:Pe,getProgressSteps:ng,getTimerLeft:HS,getTimerProgressBar:hd,getTitle:fv,getValidationMessage:cd,increaseTimer:WS,isDeprecatedParameter:Xv,isLoading:Gx,isTimerRunning:VS,isUpdatableParameter:Gv,isValidParameter:Yv,isVisible:F_,mixin:zS,off:ZS,on:$S,once:KS,resumeTimer:t5,showLoading:rl,stopTimer:Qv,toggleTimer:US});class QS{constructor(t,e){this.callback=t,this.remaining=e,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const e=this.running;return e&&this.stop(),this.remaining+=t,e&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const e5=["swal-title","swal-html","swal-footer"],t3=r=>{const t=typeof r.template=="string"?document.querySelector(r.template):r.template;if(!t)return{};const e=t.content;return l3(e),Object.assign(e3(e),i3(e),r3(e),n3(e),s3(e),o3(e),a3(e,e5))},e3=r=>{const t={};return Array.from(r.querySelectorAll("swal-param")).forEach(i=>{ra(i,["name","value"]);const n=i.getAttribute("name"),s=i.getAttribute("value");!n||!s||(typeof Va[n]=="boolean"?t[n]=s!=="false":typeof Va[n]=="object"?t[n]=JSON.parse(s):t[n]=s)}),t},i3=r=>{const t={};return Array.from(r.querySelectorAll("swal-function-param")).forEach(i=>{const n=i.getAttribute("name"),s=i.getAttribute("value");!n||!s||(t[n]=new Function(`return ${s}`)())}),t},r3=r=>{const t={};return Array.from(r.querySelectorAll("swal-button")).forEach(i=>{ra(i,["type","color","aria-label"]);const n=i.getAttribute("type");!n||!["confirm","cancel","deny"].includes(n)||(t[`${n}ButtonText`]=i.innerHTML,t[`show${tg(n)}Button`]=!0,i.hasAttribute("color")&&(t[`${n}ButtonColor`]=i.getAttribute("color")),i.hasAttribute("aria-label")&&(t[`${n}ButtonAriaLabel`]=i.getAttribute("aria-label")))}),t},n3=r=>{const t={},e=r.querySelector("swal-image");return e&&(ra(e,["src","width","height","alt"]),e.hasAttribute("src")&&(t.imageUrl=e.getAttribute("src")||void 0),e.hasAttribute("width")&&(t.imageWidth=e.getAttribute("width")||void 0),e.hasAttribute("height")&&(t.imageHeight=e.getAttribute("height")||void 0),e.hasAttribute("alt")&&(t.imageAlt=e.getAttribute("alt")||void 0)),t},s3=r=>{const t={},e=r.querySelector("swal-icon");return e&&(ra(e,["type","color"]),e.hasAttribute("type")&&(t.icon=e.getAttribute("type")),e.hasAttribute("color")&&(t.iconColor=e.getAttribute("color")),t.iconHtml=e.innerHTML),t},o3=r=>{const t={},e=r.querySelector("swal-input");e&&(ra(e,["type","label","placeholder","value"]),t.input=e.getAttribute("type")||"text",e.hasAttribute("label")&&(t.inputLabel=e.getAttribute("label")),e.hasAttribute("placeholder")&&(t.inputPlaceholder=e.getAttribute("placeholder")),e.hasAttribute("value")&&(t.inputValue=e.getAttribute("value")));const i=Array.from(r.querySelectorAll("swal-input-option"));return i.length&&(t.inputOptions={},i.forEach(n=>{ra(n,["value"]);const s=n.getAttribute("value");if(!s)return;const o=n.innerHTML;t.inputOptions[s]=o})),t},a3=(r,t)=>{const e={};for(const i in t){const n=t[i],s=r.querySelector(n);s&&(ra(s,[]),e[n.replace(/^swal-/,"")]=s.innerHTML.trim())}return e},l3=r=>{const t=e5.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(r.children).forEach(e=>{const i=e.tagName.toLowerCase();t.includes(i)||yr(`Unrecognized element <${i}>`)})},ra=(r,t)=>{Array.from(r.attributes).forEach(e=>{t.indexOf(e.name)===-1&&yr([`Unrecognized attribute "${e.name}" on <${r.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},i5=10,c3=r=>{const t=xr(),e=Pe();typeof r.willOpen=="function"&&r.willOpen(e),Gt.eventEmitter.emit("willOpen",e);const n=window.getComputedStyle(document.body).overflowY;d3(t,e,r),setTimeout(()=>{h3(t,e)},i5),ag()&&(u3(t,r.scrollbarPadding,n),G_()),!ud()&&!Gt.previousActiveElement&&(Gt.previousActiveElement=document.activeElement),typeof r.didOpen=="function"&&setTimeout(()=>r.didOpen(e)),Gt.eventEmitter.emit("didOpen",e)},Ru=r=>{const t=Pe();if(r.target!==t)return;const e=xr();t.removeEventListener("animationend",Ru),t.removeEventListener("transitionend",Ru),e.style.overflowY="auto",cn(e,gt["no-transition"])},h3=(r,t)=>{wv(t)?(r.style.overflowY="hidden",t.addEventListener("animationend",Ru),t.addEventListener("transitionend",Ru)):r.style.overflowY="auto"},u3=(r,t,e)=>{X_(),t&&e!=="hidden"&&eS(e),setTimeout(()=>{r.scrollTop=0})},d3=(r,t,e)=>{Ne(r,e.showClass.backdrop),e.animation?(t.style.setProperty("opacity","0","important"),Bi(t,"grid"),setTimeout(()=>{Ne(t,e.showClass.popup),t.style.removeProperty("opacity")},i5)):Bi(t,"grid"),Ne([document.documentElement,document.body],gt.shown),e.heightAuto&&e.backdrop&&!e.toast&&Ne([document.documentElement,document.body],gt["height-auto"])};var lm={email:(r,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(r)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(r,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(r)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function f3(r){r.inputValidator||(r.input==="email"&&(r.inputValidator=lm.email),r.input==="url"&&(r.inputValidator=lm.url))}function p3(r){(!r.target||typeof r.target=="string"&&!document.querySelector(r.target)||typeof r.target!="string"&&!r.target.appendChild)&&(yr('Target parameter is not valid, defaulting to "body"'),r.target="body")}function g3(r){f3(r),r.showLoaderOnConfirm&&!r.preConfirm&&yr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),p3(r),typeof r.title=="string"&&(r.title=r.title.split(`
`).join("<br />")),s_(r)}let Wn;var jh=new WeakMap;class xi{constructor(...t){if(jx(this,jh,void 0),typeof window>"u")return;Wn=this;const e=Object.freeze(this.constructor.argsToParams(t));this.params=e,this.isAwaitingPromise=!1,Fx(jh,this,this._main(Wn.params))}_main(t,e={}){if($v(Object.assign({},e,t)),Gt.currentInstance){const s=il.swalPromiseResolve.get(Gt.currentInstance),{isAwaitingPromise:o}=Gt.currentInstance;Gt.currentInstance._destroy(),o||s({isDismissed:!0}),ag()&&Ov()}Gt.currentInstance=Wn;const i=v3(t,e);g3(i),Object.freeze(i),Gt.timeout&&(Gt.timeout.stop(),delete Gt.timeout),clearTimeout(Gt.restoreFocusTimeout);const n=w3(Wn);return Av(Wn,i),Ge.innerParams.set(Wn,i),m3(Wn,n,i)}then(t){return J0(jh,this).then(t)}finally(t){return J0(jh,this).finally(t)}}const m3=(r,t,e)=>new Promise((i,n)=>{const s=o=>{r.close({isDismissed:!0,dismiss:o,isConfirmed:!1,isDenied:!1})};il.swalPromiseResolve.set(r,i),il.swalPromiseReject.set(r,n),t.confirmButton.onclick=()=>{wS(r)},t.denyButton.onclick=()=>{bS(r)},t.cancelButton.onclick=()=>{yS(r,s)},t.closeButton.onclick=()=>{s(gl.close)},NS(e,t,s),q_(Gt,e,s),cS(r,e),c3(e),b3(Gt,e,s),y3(t,e),setTimeout(()=>{t.container.scrollTop=0})}),v3=(r,t)=>{const e=t3(r),i=Object.assign({},Va,t,e,r);return i.showClass=Object.assign({},Va.showClass,i.showClass),i.hideClass=Object.assign({},Va.hideClass,i.hideClass),i.animation===!1&&(i.showClass={backdrop:"swal2-noanimation"},i.hideClass={}),i},w3=r=>{const t={popup:Pe(),container:xr(),actions:Rc(),confirmButton:ss(),denyButton:ha(),cancelButton:fl(),loader:pl(),closeButton:sg(),validationMessage:cd(),progressSteps:ng()};return Ge.domCache.set(r,t),t},b3=(r,t,e)=>{const i=hd();sr(i),t.timer&&(r.timeout=new QS(()=>{e("timer"),delete r.timeout},t.timer),t.timerProgressBar&&(Bi(i),Gr(i,t,"timerProgressBar"),setTimeout(()=>{r.timeout&&r.timeout.running&&cg(t.timer)})))},y3=(r,t)=>{if(!t.toast){if(!ld(t.allowEnterKey)){dv("allowEnterKey"),S3();return}x3(r)||_3(r,t)||lp(-1,1)}},x3=r=>{const t=Array.from(r.popup.querySelectorAll("[autofocus]"));for(const e of t)if(e instanceof HTMLElement&&Tr(e))return e.focus(),!0;return!1},_3=(r,t)=>t.focusDeny&&Tr(r.denyButton)?(r.denyButton.focus(),!0):t.focusCancel&&Tr(r.cancelButton)?(r.cancelButton.focus(),!0):t.focusConfirm&&Tr(r.confirmButton)?(r.confirmButton.focus(),!0):!1,S3=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};xi.prototype.disableButtons=zv;xi.prototype.enableButtons=qv;xi.prototype.getInput=Fv;xi.prototype.disableInput=Uv;xi.prototype.enableInput=Hv;xi.prototype.hideLoading=Fu;xi.prototype.disableLoading=Fu;xi.prototype.showValidationMessage=Wv;xi.prototype.resetValidationMessage=Vv;xi.prototype.close=go;xi.prototype.closePopup=go;xi.prototype.closeModal=go;xi.prototype.closeToast=go;xi.prototype.rejectPromise=Dv;xi.prototype.update=Kv;xi.prototype._destroy=Zv;Object.assign(xi,JS);Object.keys(PS).forEach(r=>{xi[r]=function(...t){return Wn&&Wn[r]?Wn[r](...t):null}});xi.DismissReason=gl;xi.version="11.26.10";const Ya=xi;Ya.default=Ya;typeof document<"u"&&(function(r,t){var e=r.createElement("style");if(r.getElementsByTagName("head")[0].appendChild(e),e.styleSheet)e.styleSheet.disabled||(e.styleSheet.cssText=t);else try{e.innerHTML=t}catch{e.innerText=t}})(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const Yi={success:r=>{Ya.fire({icon:"success",title:"Success",text:r,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,background:"#fff",color:"#333"})},error:r=>{Ya.fire({icon:"error",title:"Error",text:r,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#fff",color:"#d33"})},info:r=>{Ya.fire({icon:"info",title:"Info",text:r,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}};class C3{constructor(t){this.cm=t,this.canvas=t.canvas,this.isDragging=!1,this.isSpacePanning=!1,this.isHandMode=!1,this.lastPosX=0,this.lastPosY=0,this.canvasWrapper=document.getElementById("canvas-wrapper"),this.zoomCallback=null,this.setupZoomPan(),window.addEventListener("resize",()=>{this.canvasWrapper&&this.resizeCanvasElement(this.canvasWrapper.clientWidth,this.canvasWrapper.clientHeight)}),this.canvasWrapper&&setTimeout(()=>{this.resizeCanvasElement(this.canvasWrapper.clientWidth,this.canvasWrapper.clientHeight)},0)}onZoomChange(t){this.zoomCallback=t}setupZoomPan(){this.canvas.on("mouse:wheel",t=>{if(!t.e.altKey)return;const e=t.e.deltaY;let i=this.canvas.getZoom();i*=.999**e,i>5&&(i=5),i<.05&&(i=.05);const n=new ut(t.e.offsetX,t.e.offsetY);this.canvas.zoomToPoint(n,i),this.zoomCallback&&this.zoomCallback(i),t.e.preventDefault(),t.e.stopPropagation()}),this.canvas.on("mouse:down",t=>{const e=t.e;(e.altKey||this.isSpacePanning||this.isHandMode)&&(this.isDragging=!0,this.canvas.selection=!1,this.lastPosX=e.clientX,this.lastPosY=e.clientY,this.canvas.setCursor("grabbing"))}),this.canvas.on("mouse:move",t=>{if(this.isDragging){const e=t.e,i=e.clientX-this.lastPosX,n=e.clientY-this.lastPosY;this.canvas.relativePan(new ut(i,n)),this.lastPosX=e.clientX,this.lastPosY=e.clientY,t.e.preventDefault()}}),this.canvas.on("mouse:up",()=>{this.isDragging=!1,!this.isHandMode&&!this.isSpacePanning?(this.canvas.selection=!0,this.canvas.setCursor("default")):this.canvas.setCursor("grab")})}setZoom(t){let e=t;e>5&&(e=5),e<.05&&(e=.05);const i=new ut(this.canvas.width/2,this.canvas.height/2);this.canvas.zoomToPoint(i,e),this.zoomCallback&&this.zoomCallback(e)}zoomIn(){this.setZoom(this.canvas.getZoom()*1.2)}zoomOut(){this.setZoom(this.canvas.getZoom()/1.2)}resetZoom(){if(!this.cm.originalWidth)this.canvas.setViewportTransform([1,0,0,1,0,0]);else{const e=this.canvas.width,i=this.canvas.height,n=this.cm.originalWidth,s=this.cm.originalHeight,o=(e-n*1)/2,a=(i-s*1)/2;this.canvas.setViewportTransform([1,0,0,1,o,a])}this.zoomCallback&&this.zoomCallback(1)}fitToScreen(){if(!this.cm.originalWidth)return;const t=this.canvas.width,e=this.canvas.height,i=(t-80)/this.cm.originalWidth,n=(e-80)/this.cm.originalHeight;let s=Math.min(i,n);this.canvas.setViewportTransform([1,0,0,1,0,0]);const o=(t-this.cm.originalWidth*s)/2,a=(e-this.cm.originalHeight*s)/2;this.canvas.setViewportTransform([s,0,0,s,o,a]),this.zoomCallback&&this.zoomCallback(s)}resizeCanvasElement(t,e){this.canvas.setDimensions({width:parseInt(t),height:parseInt(e)})}resizePage(t,e){const i=parseInt(t),n=parseInt(e);this.cm.originalWidth=i,this.cm.originalHeight=n,this.cm.workspace&&(this.cm.workspace.set({width:i,height:n}),this.cm.workspace.setCoords(),this.cm.canvas.requestRenderAll()),this.resetZoom()}toggleHandMode(){return this.isHandMode=!this.isHandMode,this.isHandMode?(this.canvas.selection=!1,this.canvas.defaultCursor="grab",this.canvas.hoverCursor="grab",this.canvas.moveCursor="grab",this.canvas.setCursor("grab")):(this.canvas.selection=!0,this.canvas.defaultCursor="default",this.canvas.hoverCursor="move",this.canvas.moveCursor="move",this.canvas.setCursor("default")),this.isHandMode}setSpacePanning(t){this.isSpacePanning!==t&&(this.isSpacePanning=t,t?(this.canvas.selection=!1,this.canvas.defaultCursor="grab",this.canvas.hoverCursor="grab",this.canvas.moveCursor="grab",this.canvas.setCursor("grab"),this.canvas.discardActiveObject(),this.canvas.requestRenderAll()):(this.isHandMode||(this.canvas.selection=!0,this.canvas.defaultCursor="default",this.canvas.hoverCursor="move",this.canvas.moveCursor="move",this.canvas.setCursor("default")),this.isDragging=!1,this.canvas.requestRenderAll()))}}class k3{constructor(t){this.cm=t,this.canvas=t.canvas,this.setupEvents(),this.setupDragDrop(),this.setupShortcuts()}setupEvents(){const t=()=>{this.cm.selectionCallback&&this.cm.selectionCallback(this.canvas.getActiveObject())},e=()=>{this.cm.history.saveState()};this.canvas.on("selection:created",t),this.canvas.on("selection:updated",t),this.canvas.on("selection:cleared",t),this.canvas.on("object:modified",()=>{t(),e()}),this.canvas.on("object:added",i=>{i.target&&!i.target.isSmartGuide&&!i.target.excludeFromExport&&e()}),this.canvas.on("object:removed",i=>{i.target&&!i.target.isSmartGuide&&!i.target.excludeFromExport&&e()}),this.canvas.on("object:moving",i=>{t(),this.cm.snapToGrid&&this.cm.snapToGrid(i.target),this.cm.handleObjectMoving&&this.cm.handleObjectMoving(i)}),this.canvas.on("object:scaling",t),this.canvas.on("object:rotating",t),this.canvas.on("mouse:up",()=>{this.cm.clearGuidelines&&this.cm.clearGuidelines()})}setupDragDrop(){const t=this.canvas.wrapperEl;t.addEventListener("dragover",e=>{e.preventDefault(),e.stopPropagation()}),t.addEventListener("drop",e=>{e.preventDefault(),e.stopPropagation();const i=e.dataTransfer.files[0];if(i&&i.type.startsWith("image/")){const n=new FileReader;n.onload=s=>this.cm.addImage(s.target.result),n.readAsDataURL(i),Yi.success("Image uploaded via drag & drop")}})}setupShortcuts(){document.addEventListener("keydown",async t=>{const e=this.cm.getActiveObject();if(!(!e&&t.code!=="KeyV"&&t.code!=="Space")){if(e){const i=t.shiftKey?10:1;let n=!1;t.key==="ArrowLeft"?(t.preventDefault(),e.set("left",e.left-i),n=!0):t.key==="ArrowRight"?(t.preventDefault(),e.set("left",e.left+i),n=!0):t.key==="ArrowUp"?(t.preventDefault(),e.set("top",e.top-i),n=!0):t.key==="ArrowDown"&&(t.preventDefault(),e.set("top",e.top+i),n=!0),n&&(e.setCoords(),this.canvas.requestRenderAll(),this.canvas.fire("object:modified",{target:e}))}if((t.ctrlKey||t.metaKey)&&t.code==="KeyC"&&(t.preventDefault(),await this.cm.copy()),(t.ctrlKey||t.metaKey)&&t.code==="KeyV"&&(t.preventDefault(),await this.cm.paste()),(t.ctrlKey||t.metaKey)&&t.code==="KeyG"&&(t.preventDefault(),t.shiftKey?this.cm.ungroup():this.cm.group()),t.code==="Space"||t.key===" "){if(e&&e.isEditing||this.cm.viewport.isSpacePanning)return;t.preventDefault(),this.cm.viewport.setSpacePanning(!0)}}}),document.addEventListener("keyup",t=>{(t.code==="Space"||t.key===" ")&&this.cm.viewport.setSpacePanning(!1)})}}class A3{constructor(t,e={}){this.canvas=new rp(t,{width:800,height:600,backgroundColor:"#18191b",...e}),this.originalWidth=800,this.originalHeight=600,this.history=new Mx(this.canvas),this.initWorkspace(),this.viewport=new C3(this),this.events=new k3(this),this.snapThreshold=10,this.guidelines=[],this.clipboard=null,setTimeout(()=>this.fitToScreen(),100)}enableDrawingMode(){this.canvas&&(this.canvas.isDrawingMode=!0,this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.canvas.freeDrawingBrush||(this.canvas.freeDrawingBrush=new Eu(this.canvas)),this.canvas.freeDrawingBrush.width=5,this.canvas.freeDrawingBrush.color="#000000")}disableDrawingMode(){this.canvas&&(this.canvas.isDrawingMode=!1)}setBrushColor(t){this.canvas&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.color=t)}setBrushWidth(t){this.canvas&&this.canvas.freeDrawingBrush&&(this.canvas.freeDrawingBrush.width=parseInt(t,10))}initWorkspace(){this.workspace=new gr({left:0,top:0,width:this.originalWidth,height:this.originalHeight,fill:"#ffffff",selectable:!1,evented:!0,hoverCursor:"default",moveCursor:"default",name:"Background",stroke:"#cccccc",strokeWidth:1,shadow:{color:"rgba(0, 0, 0, 0.15)",blur:10,offsetX:0,offsetY:5}}),this.canvas.add(this.workspace),this.canvas.sendObjectToBack(this.workspace),this.canvas.on("object:added",t=>{t.target!==this.workspace&&this.canvas.sendObjectToBack(this.workspace)})}onSelectionChange(t){this.selectionCallback=t}onZoomChange(t){this.viewport.onZoomChange(t)}setZoom(t){this.viewport.setZoom(t)}zoomIn(){this.viewport.zoomIn()}zoomOut(){this.viewport.zoomOut()}resetZoom(){this.viewport.resetZoom()}fitToScreen(){this.viewport.fitToScreen()}resize(t,e){this.viewport.resizePage(t,e)}toggleHandMode(){return this.viewport.toggleHandMode()}getActiveObject(){return this.canvas.getActiveObject()}toggleGrid(){if(this.gridObject)return this.canvas.remove(this.gridObject),this.gridObject=null,this.canvas.requestRenderAll(),!1;const t=50,e=document.createElement("canvas");e.width=t,e.height=t;const i=e.getContext("2d");i.strokeStyle="rgba(0, 0, 0, 0.1)",i.lineWidth=1,i.beginPath(),i.moveTo(.5,0),i.lineTo(.5,t),i.moveTo(0,.5),i.lineTo(t,.5),i.stroke();const n=new eu({source:e,repeat:"repeat"}),s=new gr({left:0,top:0,width:this.originalWidth,height:this.originalHeight,fill:n,selectable:!1,evented:!1,excludeFromExport:!0});if(this.gridObject=s,this.canvas.add(s),this.workspace){const o=this.canvas.getObjects().indexOf(this.workspace);this.canvas.moveObjectTo(s,o+1)}else this.canvas.sendObjectToBack(s);return this.canvas.requestRenderAll(),!0}snapToGrid(t){if(!this.gridObject)return;const e=50,i=10,n=Math.round(t.left/e)*e,s=Math.round(t.top/e)*e;Math.abs(t.left-n)<i&&t.set("left",n),Math.abs(t.top-s)<i&&t.set("top",s)}addGuide(t,e){let i;return t==="horizontal"?i=new Xn([0,0,this.originalWidth,0],{top:e,left:0,stroke:"cyan",strokeDashArray:[4,4],strokeWidth:1,selectable:!0,evented:!0,lockMovementX:!0,lockMovementY:!1,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,hasControls:!1,hasBorders:!1,id:"guide",excludeFromExport:!0,hoverCursor:"ns-resize",moveCursor:"ns-resize",width:this.originalWidth}):i=new Xn([0,0,0,this.originalHeight],{top:0,left:e,stroke:"cyan",strokeDashArray:[4,4],strokeWidth:1,selectable:!0,evented:!0,lockMovementX:!1,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,hasControls:!1,hasBorders:!1,id:"guide",excludeFromExport:!0,hoverCursor:"ew-resize",moveCursor:"ew-resize",height:this.originalHeight}),this.canvas.add(i),this.canvas.bringObjectToFront(i),this.canvas.setActiveObject(i),this.canvas.requestRenderAll(),i}removeActiveObject(){const t=this.getActiveObject();t&&!t.isEditing&&(this.canvas.remove(t),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.selectionCallback&&this.selectionCallback(null))}handleObjectMoving(t){const e=t.target,i=this.canvas,n=this.originalWidth,s=this.originalHeight,o=this.snapThreshold||10;this.clearGuidelines();const a=e.left,l=e.top,c=e.getScaledWidth(),h=e.getScaledHeight(),p=a+c/2,m=l+h/2,f=a+c,b=l+h;let y=null,_=null;Math.abs(p-n/2)<o&&(e.set({left:n/2-c/2}),y=n/2),y||i.getObjects().forEach(x=>{if(x===e||x===this.workspace||!x.visible)return;if(x.id==="guide"){if(x.lockMovementY){const Z=x.left;Math.abs(a-Z)<o?(e.set({left:Z}),y=Z):Math.abs(f-Z)<o?(e.set({left:Z-c}),y=Z):Math.abs(p-Z)<o&&(e.set({left:Z-c/2}),y=Z)}return}const E=x.left,I=x.getScaledWidth(),O=E+I/2,V=E+I;Math.abs(p-O)<o?(e.set({left:O-c/2}),y=O):Math.abs(a-E)<o?(e.set({left:E}),y=E):Math.abs(f-V)<o?(e.set({left:V-c}),y=V):Math.abs(a-V)<o?(e.set({left:V}),y=V):Math.abs(f-E)<o&&(e.set({left:E-c}),y=E)}),Math.abs(m-s/2)<o&&(e.set({top:s/2-h/2}),_=s/2),_||i.getObjects().forEach(x=>{if(x===e||x===this.workspace||!x.visible)return;if(x.id==="guide"){if(x.lockMovementX){const Z=x.top;Math.abs(l-Z)<o?(e.set({top:Z}),_=Z):Math.abs(b-Z)<o?(e.set({top:Z-h}),_=Z):Math.abs(m-Z)<o&&(e.set({top:Z-h/2}),_=Z)}return}const E=x.top,I=x.getScaledHeight(),O=E+I/2,V=E+I;Math.abs(m-O)<o?(e.set({top:O-h/2}),_=O):Math.abs(l-E)<o?(e.set({top:E}),_=E):Math.abs(b-V)<o?(e.set({top:V-h}),_=V):Math.abs(l-V)<o?(e.set({top:V}),_=V):Math.abs(b-E)<o&&(e.set({top:E-h}),_=E)}),y!==null&&this.drawVerticalLine(y),_!==null&&this.drawHorizontalLine(_)}clearGuidelines(){this.canvas.getObjects("line").forEach(t=>{t.isSmartGuide&&this.canvas.remove(t)}),this.canvas.requestRenderAll()}drawVerticalLine(t){this.drawGuideLine([t,0,t,this.originalHeight])}drawHorizontalLine(t){this.drawGuideLine([0,t,this.originalWidth,t])}drawGuideLine(t){const e=new Xn(t,{stroke:"red",strokeWidth:1,selectable:!1,evented:!1,strokeDashArray:[4,4],isSmartGuide:!0,excludeFromExport:!0});this.canvas.add(e)}async copy(){const t=this.getActiveObject();if(t){const e=await t.clone();this.clipboard=e,Yi.info("Copied to clipboard")}}async paste(){if(!this.clipboard)return;const t=await this.clipboard.clone();this.canvas.discardActiveObject(),t.set({left:t.left+10,top:t.top+10,evented:!0}),t.type==="activeSelection"?(t.canvas=this.canvas,t.forEachObject(e=>this.canvas.add(e)),t.setCoords()):this.canvas.add(t),this.clipboard.top+=10,this.clipboard.left+=10,this.canvas.setActiveObject(t),this.canvas.requestRenderAll(),this.history.saveState(),Yi.success("Pasted object")}group(){const t=this.getActiveObject();if(!t||t.type!=="activeSelection"&&t.type!=="activeselection")return;const e=t.getObjects();this.canvas.discardActiveObject(),e.forEach(n=>{this.canvas.remove(n)});const i=new Wr(e);this.canvas.add(i),this.canvas.setActiveObject(i),this.canvas.requestRenderAll(),this.history.saveState(),Yi.success("Grouped objects")}ungroup(){const t=this.getActiveObject();if(!t||t.type!=="group")return;const e=t.getObjects();if(this.canvas.remove(t),typeof t.toActiveSelection=="function")t.toActiveSelection();else if(t.getObjects().forEach(i=>{t.removeWithUpdate(i),this.canvas.add(i)}),this.canvas.remove(t),e.length>0){const i=new fo(e,{canvas:this.canvas});this.canvas.setActiveObject(i)}this.canvas.requestRenderAll(),this.history.saveState(),Yi.success("Ungrouped objects")}setBackgroundColor(t){this.workspace&&(this.workspace.set("fill",t),this.canvas.requestRenderAll())}setBackgroundGradient(t,e,i,n,s){const o=this.originalWidth,a=this.originalHeight;let l={x1:0,y1:0,x2:o,y2:0};i==="vertical"&&(l={x1:0,y1:0,x2:0,y2:a}),i==="diagonal"&&(l={x1:0,y1:0,x2:o,y2:a});const c=new Ra({type:"linear",coords:l,colorStops:[{offset:0,color:t},{offset:1,color:e}]});this.workspace&&(this.workspace.set("fill",c),this.canvas.requestRenderAll())}addText(t="Double click to edit",e={}){const i=new Kn(t,{left:100,top:100,fontFamily:"'Phetsarath OT', 'Noto Sans Lao', sans-serif",fill:"#333",fontSize:40,...e});this.canvas.add(i),this.canvas.setActiveObject(i)}async addImage(t,e={}){try{const i=await rr.fromURL(t);i.width>this.originalWidth&&i.scaleToWidth(this.originalWidth/2),e.fill&&i.set({tint:e.fill}),this.canvas.add(i),i.set({left:this.originalWidth/2,top:this.originalHeight/2,originX:"center",originY:"center"}),this.canvas.setActiveObject(i),this.canvas.requestRenderAll()}catch(i){console.error("Error loading image:",i)}}addShape(t,e={}){const i={left:100,top:100,...e},n=Dx(t,i);n&&(this.canvas.add(n),this.canvas.setActiveObject(n),this.canvas.requestRenderAll())}async addSVG(t,e={}){try{console.log("Attempting to load SVG from:",t);const i=await px(t);console.log("SVG Loaded result:",i);const{objects:n,opts:s}=i;if(n&&n.length>0){const o=new Wr(n,{...s,...e,left:100,top:100});if(e.fill){const a=l=>{l.forEach(c=>{c.type==="group"?a(c._objects):c.set&&c.set("fill",e.fill)})};o._objects&&a(o._objects),o.set("fill",e.fill)}this.canvas.add(o),this.canvas.setActiveObject(o),this.canvas.requestRenderAll()}else console.warn("No objects found in SVG"),Yi.info("Loaded SVG but found no objects.")}catch(i){console.error("SVG Load Error",i),Yi.error("Failed to load SVG: "+i.message)}}async addSVGString(t,e={}){try{const i=await fx(t),{objects:n,opts:s}=i;if(n&&n.length>0){const o=new Wr(n,{...s,...e,left:100,top:100});if(e.fill){const a=l=>{l.forEach(c=>{c.type==="group"?a(c._objects):c.set&&(c.set("fill",e.fill),c.type==="path"&&c.set("stroke",e.fill))})};o._objects&&a(o._objects),o.set("fill",e.fill)}this.canvas.add(o),this.canvas.setActiveObject(o),this.canvas.requestRenderAll()}}catch(i){console.error("SVG String Load Error",i)}}updateActiveObject(t,e){const i=this.getActiveObject();if(i){if(t.startsWith("shadow.")){const n=t.split(".")[1];let s=i.shadow;s||(i.set("shadow",{color:"#000000",blur:10,offsetX:5,offsetY:5}),s=i.shadow),i.shadow instanceof Object?n==="color"&&!e?i.set("shadow",null):i.shadow[n]=e:(i.set("shadow",{color:"#000000",blur:10,offsetX:5,offsetY:5}),i.shadow[n]=e),i.set("shadow",i.shadow)}else if(t.startsWith("filter.")){if(i.type==="image"||i instanceof rr){const n=t.split(".")[1];let s=parseFloat(e);this.applyImageFilter(i,n,s)}}else if(t==="fill")if(i.type==="image"||i instanceof rr)i.set({tint:e});else if(i.type==="group"||i.type==="path-group"){const n=s=>{s.forEach(o=>{o.type==="group"?n(o._objects):o.set&&o.set("fill",e)})};i._objects&&n(i._objects),i.set("fill",e)}else i.set("fill",e);else t==="width"?i.scaleToWidth(parseInt(e)):t==="height"?i.scaleToHeight(parseInt(e)):i.set(t,e);i.setCoords(),this.canvas.requestRenderAll()}}alignActiveObject(t){const e=this.getActiveObject();if(e){if(e.type==="activeSelection"){const i=e.width,n=e.height;e.forEachObject(s=>{const o=s.getScaledWidth(),a=s.getScaledHeight();switch(t){case"left":s.set({left:-i/2});break;case"center":s.set({left:-o/2});break;case"right":s.set({left:i/2-o});break;case"top":s.set({top:-n/2});break;case"middle":s.set({top:-a/2});break;case"bottom":s.set({top:n/2-a});break}s.setCoords()})}else{const i=this.originalWidth,n=this.originalHeight,s=e.getScaledWidth(),o=e.getScaledHeight();switch(t){case"left":e.originX==="center"?e.set({left:s/2}):e.set({left:0});break;case"center":e.set({left:i/2}),e.originX!=="center"&&e.set({left:i/2-s/2});break;case"right":e.originX==="center"?e.set({left:i-s/2}):e.set({left:i-s});break;case"top":e.originY==="center"?e.set({top:o/2}):e.set({top:0});break;case"middle":e.set({top:n/2}),e.originY!=="center"&&e.set({top:n/2-o/2});break;case"bottom":e.originY==="center"?e.set({top:n-o/2}):e.set({top:n-o});break}}e.setCoords(),this.canvas.requestRenderAll()}}flipActiveObject(t){const e=this.getActiveObject();if(e){const i=t==="horizontal"?"flipX":"flipY";e.set(i,!e[i]),this.canvas.requestRenderAll()}}layerActiveObject(t){const e=this.getActiveObject();e&&(t==="up"&&this.canvas.bringObjectForward(e),t==="down"&&this.canvas.sendObjectBackwards(e),this.canvas.requestRenderAll())}async duplicateActiveObject(){const t=this.getActiveObject();if(!t)return;const e=await t.clone();this.canvas.discardActiveObject(),e.set({left:t.left+20,top:t.top+20,evented:!0}),e.type==="activeSelection"?(e.canvas=this.canvas,e.forEachObject(i=>this.canvas.add(i)),e.setCoords()):this.canvas.add(e),this.canvas.setActiveObject(e),this.canvas.requestRenderAll()}toggleLockActiveObject(){const t=this.getActiveObject();if(!t)return;const e=!t.lockMovementX;return t.set({lockMovementX:e,lockMovementY:e,lockRotation:e,lockScalingX:e,lockScalingY:e}),this.canvas.requestRenderAll(),e}loadGoogleFont(t){if(!t||["Arial","Times New Roman","Courier New","Verdana","Georgia","Trebuchet MS","Impact","Noto Sans Lao Looped","Noto Serif Lao","Phetsarath OT","Noto Sans Lao"].some(s=>t.includes(s)))return;const i=t.replace(/['"]/g,"").split(",")[0].trim(),n="font-css-"+i.replace(/\s+/g,"-").toLowerCase();if(!document.getElementById(n)){const s=document.createElement("link");s.id=n,s.rel="stylesheet",s.href=`https://fonts.googleapis.com/css2?family=${i.replace(/\s+/g,"+")}:wght@400;700&display=swap`,document.head.appendChild(s),s.onload=()=>{this.canvas.requestRenderAll()}}}setTextStyle(t,e){const i=this.getActiveObject();i&&i.type==="i-text"&&(t==="fontFamily"&&this.loadGoogleFont(e),i.set(t,e),this.canvas.requestRenderAll())}applyImageFilter(t,e,i){if(!t||!t.filters)return;const s={brightness:"Brightness",contrast:"Contrast",blur:"Blur",saturation:"Saturation",grayscale:"Grayscale",sepia:"Sepia",hue:"HueRotation",noise:"Noise",pixelate:"Pixelate"}[e];if(!s)return;let o=t.filters.find(a=>a.type===s);if(!o){const a=Nx[s];if(a){let l={};e==="blur"?l={blur:i}:e==="pixelate"?l={blocksize:i}:e==="hue"?l={rotation:i}:e==="grayscale"||e==="sepia"||(l[e]=i),o=new a(l),t.filters.push(o)}}if(o)if(e==="blur")o.blur=i;else if(e==="pixelate")o.blocksize=i;else if(e==="hue")o.rotation=i;else if(e==="grayscale"||e==="sepia"){if(i===0){const a=t.filters.indexOf(o);a>-1&&t.filters.splice(a,1)}}else o[e]=i;t.applyFilters(),this.canvas.requestRenderAll()}toggleTextDecoration(t){const e=this.getActiveObject();if(e&&e.type==="i-text"){if(t==="fontWeight"){const i=e.fontWeight==="bold";e.set("fontWeight",i?"normal":"bold")}else if(t==="fontStyle"){const i=e.fontStyle==="italic";e.set("fontStyle",i?"normal":"italic")}else t==="underline"&&e.set("underline",!e.underline);return this.canvas.requestRenderAll(),e[t]}}startCropMode(t){if(t=t||this.getActiveObject(),!t||t.type!=="image")return;this.isCropping=!0,this.cropTarget=t,t.hasControls=!1,t.hasBorders=!1,this.canvas.selection=!1,this.canvas.discardActiveObject(),this.canvas.requestRenderAll();const e=t.getScaledWidth(),i=t.getScaledHeight(),n=t.left,s=t.top;this.cropRect=new gr({left:n,top:s,width:e,height:i,fill:"rgba(0,0,0,0)",stroke:"#ffffff",strokeWidth:2,strokeDashArray:[5,5],transparentCorners:!1,cornerColor:"#ffffff",cornerStrokeColor:"#000000",borderColor:"#ffffff",cornerSize:12,padding:0,cornerStyle:"circle",borderDashArray:[5,5],id:"crop-ui"}),this.canvas.add(this.cropRect),this.canvas.setActiveObject(this.cropRect),this.canvas.requestRenderAll()}applyCrop(){if(!this.isCropping||!this.cropTarget||!this.cropRect)return;const t=this.cropTarget,e=this.cropRect,i=Gl.invertTransform(t.calcTransformMatrix()),n=e.left,s=e.top,o=Gl.transformPoint({x:n,y:s},i),a=e.getScaledWidth()/t.scaleX,l=e.getScaledHeight()/t.scaleY,c=new gr({left:o.x,top:o.y,width:a,height:l,originX:"left",originY:"top"});t.clipPath=c,this.cancelCrop(),this.canvas.setActiveObject(t),this.canvas.requestRenderAll(),this.selectionCallback&&this.selectionCallback(t)}async maskObject(){const t=this.getActiveObject();if(!t||t.type!=="activeSelection"&&t.type!=="activeselection")return;const e=t.getObjects();if(e.length!==2)return;let i=e.find(p=>p.type==="image"),n=e.find(p=>["rect","circle","triangle","polygon","path"].includes(p.type));if(!i||!n)return;const s=await n.clone(),o=i.calcTransformMatrix(),a=Gl.invertTransform(o),l=n.calcTransformMatrix(),c=Gl.multiplyTransformMatrices(a,l),h=Gl.qrDecompose(c);s.set({flipX:!1,flipY:!1,scaleX:h.scaleX,scaleY:h.scaleY,angle:h.angle,skewX:h.skewX,skewY:h.skewY,left:h.translateX,top:h.translateY,originX:"center",originY:"center",absolutePositioned:!1}),i.clipPath=s,this.canvas.discardActiveObject(),this.canvas.remove(n),i.dirty=!0,this.canvas.requestRenderAll(),this.canvas.setActiveObject(i)}cancelCrop(){this.cropRect&&(this.canvas.remove(this.cropRect),this.cropRect=null),this.cropTarget&&(this.cropTarget.hasControls=!0,this.cropTarget.hasBorders=!0,this.cropTarget=null),this.isCropping=!1,this.canvas.selection=!0,this.canvas.requestRenderAll(),this.selectionCallback&&this.selectionCallback(null)}exportToImage(t,e=1){const i=this.canvas.viewportTransform.slice(),n=this.canvas.width,s=this.canvas.height,o=this.canvas.backgroundColor;try{this.canvas.setWidth(this.originalWidth),this.canvas.setHeight(this.originalHeight),this.canvas.setViewportTransform([1,0,0,1,0,0]);const a=this.canvas.toDataURL({format:"png",quality:1,multiplier:e,left:0,top:0,width:this.originalWidth,height:this.originalHeight,enableRetinaScaling:!0}),l=document.createElement("a");l.download=`${t}.png`,l.href=a,document.body.appendChild(l),l.click(),document.body.removeChild(l)}catch(a){console.error("Export failed:",a)}finally{this.canvas.setWidth(n),this.canvas.setHeight(s),this.canvas.setViewportTransform(i),this.canvas.backgroundColor=o,this.canvas.requestRenderAll()}}exportToSVG(t){const e=this.canvas.viewportTransform.slice(),i=this.canvas.width,n=this.canvas.height;try{this.canvas.setViewportTransform([1,0,0,1,0,0]),this.canvas.setWidth(this.originalWidth),this.canvas.setHeight(this.originalHeight);const s=this.canvas.toSVG({viewBox:{x:0,y:0,width:this.originalWidth,height:this.originalHeight},width:this.originalWidth,height:this.originalHeight}),o=new Blob([s],{type:"image/svg+xml"}),a=URL.createObjectURL(o),l=document.createElement("a");l.download=`${t}.svg`,l.href=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}catch(s){console.error("SVG Export failed:",s)}finally{this.canvas.setWidth(i),this.canvas.setHeight(n),this.canvas.setViewportTransform(e),this.canvas.requestRenderAll()}}getCanvasDataURL(t=1){const e=this.canvas.viewportTransform.slice(),i=this.canvas.width,n=this.canvas.height;try{return this.canvas.setWidth(this.originalWidth),this.canvas.setHeight(this.originalHeight),this.canvas.setViewportTransform([1,0,0,1,0,0]),this.canvas.toDataURL({format:"png",quality:1,multiplier:t,left:0,top:0,width:this.originalWidth,height:this.originalHeight,enableRetinaScaling:!0})}finally{this.canvas.setWidth(i),this.canvas.setHeight(n),this.canvas.setViewportTransform(e),this.canvas.requestRenderAll()}}async loadTemplate(t){if(!t){this.canvas.clear(),this.resize(800,600),this.initWorkspace(),this.history.clear();return}try{t.width&&t.height&&this.resize(t.width,t.height),await this.canvas.loadFromJSON(t),this.workspace=this.canvas.getObjects().find(e=>e.width===this.originalWidth&&e.height===this.originalHeight&&!e.selectable),this.workspace?this.canvas.sendObjectToBack(this.workspace):this.initWorkspace(),this.canvas.requestRenderAll(),this.history.clear(),Yi.success("Template loaded successfully")}catch(e){console.error("Error loading template:",e),Yi.error("Failed to load template")}}saveProject(){const t=this.canvas.toJSON();return t.width=this.originalWidth,t.height=this.originalHeight,t}}class L3{constructor(t,e){this.dom=t,this.cm=e,this.BATCH_SIZE=20,this.state={shapes:{allItems:[],filteredItems:[],page:0,hasMore:!0},icons:{allNames:[],filteredNames:[],page:0,hasMore:!0},photos:{page:1,isLoading:!1,hasMore:!0,query:""}}}init(){this.renderStructure(),this.bindEvents(),this.switchTab("shapes")}renderStructure(){const t=document.getElementById("elements-library-container");t&&(t.innerHTML=`
            <div class="elements-tabs">
                <button class="el-tab active" data-tab="shapes">Shapes</button>
                <button class="el-tab" data-tab="icons">Icons</button>
                <button class="el-tab" data-tab="photos">Photos</button>
            </div>
            
            <div class="elements-search-box">
                <i data-lucide="search" class="search-icon-sm"></i>
                <input type="text" placeholder="Search..." id="el-search-input">
            </div>

            <div id="el-content-shapes" class="el-content-area" style="height: calc(100vh - 220px); overflow-y: auto;">
                <div class="elements-grid-flat"></div>
                <div class="loading-trigger" style="height: 20px;"></div>
            </div>
            <div id="el-content-icons" class="el-content-area" style="display:none; height: calc(100vh - 220px); overflow-y: auto;">
                <div class="elements-grid-flat"></div>
                <div class="loading-trigger" style="height: 20px;"></div>
            </div>
            <div id="el-content-photos" class="el-content-area" style="display:none; height: calc(100vh - 220px); overflow-y: auto;">
                <div class="elements-grid-masonry"></div>
                <div class="loading-trigger" style="height: 20px;"></div>
            </div>
        `,this.tabBtns=t.querySelectorAll(".el-tab"),this.searchInput=t.querySelector("#el-search-input"),this.containers={shapes:t.querySelector("#el-content-shapes"),icons:t.querySelector("#el-content-icons"),photos:t.querySelector("#el-content-photos")},Object.keys(this.containers).forEach(e=>{const i=this.containers[e];i.addEventListener("scroll",()=>{i.scrollTop+i.clientHeight>=i.scrollHeight-50&&this.loadMore(e)})}),this.loadShapesData())}bindEvents(){this.tabBtns.forEach(i=>{i.addEventListener("click",()=>{this.switchTab(i.dataset.tab)})}),this.searchInput.addEventListener("input",i=>{const n=i.target.value.toLowerCase();this.handleSearch(n)});const t=document.getElementById("btn-add-text");t&&t.addEventListener("click",()=>this.cm.addText());const e=document.getElementById("btn-add-image");e&&e.addEventListener("click",()=>this.dom.fileInput.click()),this.dom.fileInput&&this.dom.fileInput.addEventListener("change",i=>{const n=i.target.files[0];if(n){const s=new FileReader;s.onload=o=>this.cm.addImage(o.target.result),s.readAsDataURL(n),this.dom.fileInput.value=""}})}switchTab(t){this.tabBtns.forEach(i=>{i.dataset.tab===t?i.classList.add("active"):i.classList.remove("active")}),Object.keys(this.containers).forEach(i=>{this.containers[i].style.display=i===t?"block":"none"}),this.currentTab=t,t==="icons"&&this.state.icons.allNames.length===0&&this.loadIconsData(),t==="photos"&&this.state.photos.page===1&&!this.state.photos.loaded&&(this.state.photos.loaded=!0,this.loadMorePhotos());const e=this.searchInput.value.toLowerCase();e&&this.handleSearch(e)}loadMore(t){t==="shapes"&&this.renderShapesBatch(),t==="icons"&&this.renderIconsBatch(),t==="photos"&&this.loadMorePhotos()}handleSearch(t){this.currentTab==="shapes"&&(this.state.shapes.filteredItems=this.state.shapes.allItems.filter(e=>e.label.toLowerCase().includes(t)),this.state.shapes.page=0,this.state.shapes.hasMore=!0,this.containers.shapes.querySelector(".elements-grid-flat").innerHTML="",this.renderShapesBatch()),this.currentTab==="icons"&&(this.state.icons.filteredNames=this.state.icons.allNames.filter(e=>e.toLowerCase().includes(t)),this.state.icons.page=0,this.state.icons.hasMore=!0,this.containers.icons.querySelector(".elements-grid-flat").innerHTML="",this.renderIconsBatch()),this.currentTab==="photos"&&(clearTimeout(this.photoDebounce),this.photoDebounce=setTimeout(()=>{this.state.photos.query=t,this.state.photos.page=1,this.state.photos.hasMore=!0,this.containers.photos.querySelector(".elements-grid-masonry").innerHTML="",this.loadMorePhotos()},500))}async loadShapesData(){try{const e=await(await fetch("/data/elements.json")).json(),i=[];e.forEach(n=>n.items.forEach(s=>i.push(s))),this.state.shapes.allItems=i,this.state.shapes.filteredItems=i,this.renderShapesBatch()}catch(t){console.error(t)}}renderShapesBatch(){const{filteredItems:t,page:e,hasMore:i}=this.state.shapes;if(!i)return;const n=e*this.BATCH_SIZE,s=n+this.BATCH_SIZE,o=t.slice(n,s);if(o.length===0){this.state.shapes.hasMore=!1;return}const a=this.containers.shapes.querySelector(".elements-grid-flat");o.forEach(l=>{if(!["shape","svg","image"].includes(l.type))return;const c=document.createElement("button");if(c.className="btn btn-element-flat",c.title=l.label,l.icon){const h=document.createElement("img");h.src=l.icon,c.appendChild(h)}else c.textContent=l.label;c.addEventListener("click",()=>{l.type==="shape"&&this.cm.addShape(l.shapeType,l.options),l.type==="svg"&&this.cm.addSVG(l.src,l.options),l.type==="image"&&this.cm.addImage(l.src,l.options)}),a.appendChild(c)}),this.state.shapes.page++,s>=t.length&&(this.state.shapes.hasMore=!1)}loadIconsData(){this.state.icons.allNames=Object.keys(Jn),this.state.icons.filteredNames=this.state.icons.allNames,this.renderIconsBatch()}renderIconsBatch(){const{filteredNames:t,page:e,hasMore:i}=this.state.icons;if(!i)return;const n=e*this.BATCH_SIZE,s=n+this.BATCH_SIZE,o=t.slice(n,s);if(o.length===0){this.state.icons.hasMore=!1;return}const a=this.containers.icons.querySelector(".elements-grid-flat"),l=c=>c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();o.forEach(c=>{const h=document.createElement("button");h.className="btn btn-element-flat icon-btn-large",h.title=c;const p=document.createElement("i");p.setAttribute("data-lucide",l(c)),h.appendChild(p),h.addEventListener("click",()=>this.addIconToCanvas(c)),a.appendChild(h)}),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{width:24,height:24}}),this.state.icons.page++,s>=t.length&&(this.state.icons.hasMore=!1)}addIconToCanvas(t){const e=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=document.createElement("div");i.innerHTML=`<i data-lucide="${e(t)}"></i>`,Ds({icons:Jn,nameAttr:"data-lucide",root:i});const n=i.querySelector("svg");n&&(n.setAttribute("width","100"),n.setAttribute("height","100"),this.cm.addSVGString(n.outerHTML,{fill:"#333333"}))}async loadMorePhotos(){const t=this.state.photos;if(t.isLoading||!t.hasMore)return;t.isLoading=!0;const e=this.containers.photos.querySelector(".elements-grid-masonry"),i=this.containers.photos.querySelector(".loading-trigger");i.textContent="Loading...";try{let n=[];if(t.query)t.page>5?t.hasMore=!1:n=Array.from({length:this.BATCH_SIZE}).map((s,o)=>{const a=t.page*100+o;return{thumb:`https://loremflickr.com/200/200/${t.query}?lock=${a}`,full:`https://loremflickr.com/800/600/${t.query}?lock=${a}`}});else{const o=await(await fetch(`https://picsum.photos/v2/list?page=${t.page}&limit=${this.BATCH_SIZE}`)).json();n=o.map(a=>({thumb:`https://picsum.photos/id/${a.id}/200/200`,full:`https://picsum.photos/id/${a.id}/800/600`})),o.length<this.BATCH_SIZE&&(t.hasMore=!1)}n.forEach(s=>{const o=document.createElement("img");o.src=s.thumb,o.className="photo-item",o.loading="lazy",o.addEventListener("click",()=>{this.cm.addImage(s.full)}),e.appendChild(o)}),t.page++}catch(n){console.error(n),t.hasMore=!1}finally{t.isLoading=!1,i.textContent=""}}}const T3=[{id:"transform",title:"Transform",shouldShow:r=>r!==null,items:[{type:"row",items:[{label:"X",type:"number",prop:"left",min:0},{label:"Y",type:"number",prop:"top",min:0}]},{type:"row",items:[{label:"W",type:"number",prop:"width",getter:r=>Math.round(r.getScaledWidth())},{label:"H",type:"number",prop:"height",getter:r=>Math.round(r.getScaledHeight())}]},{label:"Rotate",type:"number",prop:"angle"},{label:"Align",type:"actions",actions:[{icon:"align-left",title:"Left",method:"alignActiveObject",args:["left"]},{icon:"align-center-horizontal",title:"Center",method:"alignActiveObject",args:["center"]},{icon:"align-right",title:"Right",method:"alignActiveObject",args:["right"]},{icon:"align-vertical-justify-start",title:"Top",method:"alignActiveObject",args:["top"]},{icon:"align-vertical-justify-center",title:"Middle",method:"alignActiveObject",args:["middle"]},{icon:"align-vertical-justify-end",title:"Bottom",method:"alignActiveObject",args:["bottom"]}]}]},{id:"text",title:"Text Style",shouldShow:r=>r&&r.type==="i-text",items:[{label:"Font",type:"select",prop:"fontFamily",options:[{label:"Roboto",value:"Roboto"},{label:"Open Sans",value:"Open Sans"},{label:"Lato",value:"Lato"},{label:"Montserrat",value:"Montserrat"},{label:"Oswald",value:"Oswald"},{label:"Raleway",value:"Raleway"},{label:"Playfair Display",value:"Playfair Display"},{label:"Merriweather",value:"Merriweather"},{label:"Poppins",value:"Poppins"},{label:"Phetsarath OT (Lao)",value:"'Phetsarath OT', 'Noto Sans Lao', sans-serif"},{label:"Noto Sans Lao",value:"'Noto Sans Lao', sans-serif"},{label:"Noto Sans Lao Looped",value:"'Noto Sans Lao Looped', sans-serif"},{label:"Noto Serif Lao",value:"'Noto Serif Lao', sans-serif"},{label:"Inter",value:"Inter"},{label:"Arial",value:"Arial"},{label:"Times New Roman",value:"Times New Roman"},{label:"Courier New",value:"Courier New"}]},{type:"row",items:[{label:"Color",type:"color",prop:"fill"},{label:"Size",type:"number",prop:"fontSize"}]},{type:"actions",actions:[{icon:"align-left",title:"Align Left",method:"updateActiveObject",args:["textAlign","left"],isActive:r=>r.textAlign==="left"},{icon:"align-center",title:"Align Center",method:"updateActiveObject",args:["textAlign","center"],isActive:r=>r.textAlign==="center"},{icon:"align-right",title:"Align Right",method:"updateActiveObject",args:["textAlign","right"],isActive:r=>r.textAlign==="right"},{icon:"align-justify",title:"Justify",method:"updateActiveObject",args:["textAlign","justify"],isActive:r=>r.textAlign==="justify"}]},{type:"row",items:[{label:"Line Ht",type:"number",prop:"lineHeight",step:.1,min:.5},{label:"Letter Sp",type:"number",prop:"charSpacing",step:10}]},{type:"row",items:[{label:"Line",type:"range",prop:"lineHeight",min:.8,max:2.5,step:.1},{label:"Char",type:"range",prop:"charSpacing",min:-50,max:200,step:10}]},{type:"row",items:[{label:"Stroke",type:"color",prop:"stroke",hasTransparent:!0},{label:"Width",type:"number",prop:"strokeWidth",min:0,step:.5}]},{type:"actions",actions:[{icon:"bold",title:"Bold",method:"toggleTextDecoration",args:["fontWeight"],isActive:r=>r.fontWeight==="bold"},{icon:"italic",title:"Italic",method:"toggleTextDecoration",args:["fontStyle"],isActive:r=>r.fontStyle==="italic"},{icon:"underline",title:"Underline",method:"toggleTextDecoration",args:["underline"],isActive:r=>!!r.underline}]}]},{id:"appearance",title:"Appearance",shouldShow:r=>r&&["rect","circle","triangle","polygon","path","group","activeSelection","activeselection"].includes(r.type),items:[{label:"Fill",type:"color",prop:"fill",hasTransparent:!0},{label:"Stroke",type:"color",prop:"stroke",hasTransparent:!0},{type:"row",items:[{label:"Size",type:"number",prop:"strokeWidth",min:0},{label:"Style",type:"select",prop:"strokeDashArray",options:[{label:"Solid",value:null},{label:"Dashed",value:[10,5]},{label:"Dotted",value:[2,2]}],getter:r=>{const t=r.strokeDashArray;return!t||t.length===0?null:t[0]<5?[2,2]:[10,5]},valueMatcher:(r,t)=>!!(!r&&!t||r&&t&&r.toString()===t.toString())}]}]},{id:"shadow",title:"Shadow",shouldShow:r=>r&&r!==null&&r.type!=="image",items:[{label:"Color",type:"color",prop:"shadow.color",hasTransparent:!0},{type:"row",items:[{label:"Blur",type:"number",prop:"shadow.blur",min:0},{label:"X",type:"number",prop:"shadow.offsetX"},{label:"Y",type:"number",prop:"shadow.offsetY"}]}]},{id:"image-filters",title:"Image Correction",shouldShow:r=>r&&r.type==="image",items:[{label:"Actions",type:"actions",actions:[{title:"Crop Image",icon:"crop",method:"startCropMode"}]},{label:"Tint",type:"color",prop:"fill",hasTransparent:!0},{label:"Brightness",type:"range",prop:"filter.brightness",min:-1,max:1,step:.05},{label:"Contrast",type:"range",prop:"filter.contrast",min:-1,max:1,step:.05},{label:"Blur",type:"range",prop:"filter.blur",min:0,max:1,step:.05},{label:"Saturation",type:"range",prop:"filter.saturation",min:-1,max:1,step:.1},{label:"Hue",type:"range",prop:"filter.hue",min:-1,max:1,step:.1},{label:"Noise",type:"range",prop:"filter.noise",min:0,max:100,step:5},{label:"Pixelate",type:"range",prop:"filter.pixelate",min:0,max:20,step:1},{type:"row",items:[{label:"Grayscale",type:"number",prop:"filter.grayscale",min:0,max:1,step:1},{label:"Sepia",type:"number",prop:"filter.sepia",min:0,max:1,step:1}]}]},{id:"grouping",title:"Grouping",shouldShow:r=>r&&(r.type==="activeSelection"||r.type==="activeselection"||r.type==="group"),items:[{type:"actions",actions:[{title:"Group Objects",icon:"group",icon:"copy",icon:"folder-plus",label:"Group",method:"group",activeCheck:r=>r.type!=="activeSelection"&&r.type!=="activeselection"},{title:"Ungroup Objects",icon:"folder-minus",label:"Ungroup",method:"ungroup"}]}]},{id:"ordering",title:"Order",shouldShow:r=>r!==null,items:[{type:"actions",actions:[{title:"Flip Horizontal",icon:"arrow-left-right",method:"flipActiveObject",args:["horizontal"]},{title:"Flip Vertical",icon:"arrow-up-down",method:"flipActiveObject",args:["vertical"]},{title:"Bring Forward",icon:"arrow-up",method:"layerActiveObject",args:["up"]},{title:"Send Backward",icon:"arrow-down",method:"layerActiveObject",args:["down"]}]}]},{id:"drawing",title:"Drawing Tools",shouldShow:r=>!1,items:[{label:"Brush Color",type:"color",prop:"freeDrawingBrush.color",hasTransparent:!1},{label:"Brush Size",type:"range",prop:"freeDrawingBrush.width",min:1,max:50,step:1},{type:"row",items:[{label:"Size Input",type:"number",prop:"freeDrawingBrush.width",min:1,max:100}]}]}],Pc=(r,t=0,e=1)=>r>e?e:r<t?t:r,Gi=(r,t=0,e=Math.pow(10,t))=>Math.round(e*r)/e,E3=r=>M3(hp(r)),hp=r=>(r[0]==="#"&&(r=r.substring(1)),r.length<6?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Gi(parseInt(r[3]+r[3],16)/255,2):1}:{r:parseInt(r.substring(0,2),16),g:parseInt(r.substring(2,4),16),b:parseInt(r.substring(4,6),16),a:r.length===8?Gi(parseInt(r.substring(6,8),16)/255,2):1}),O3=r=>D3(N3(r)),P3=({h:r,s:t,v:e,a:i})=>{const n=(200-t)*e/100;return{h:Gi(r),s:Gi(n>0&&n<200?t*e/100/(n<=100?n:200-n)*100:0),l:Gi(n/2),a:Gi(i,2)}},up=r=>{const{h:t,s:e,l:i}=P3(r);return`hsl(${t}, ${e}%, ${i}%)`},N3=({h:r,s:t,v:e,a:i})=>{r=r/360*6,t=t/100,e=e/100;const n=Math.floor(r),s=e*(1-t),o=e*(1-(r-n)*t),a=e*(1-(1-r+n)*t),l=n%6;return{r:Gi([e,o,s,s,a,e][l]*255),g:Gi([a,e,e,o,s,s][l]*255),b:Gi([s,s,a,e,e,o][l]*255),a:Gi(i,2)}},Fh=r=>{const t=r.toString(16);return t.length<2?"0"+t:t},D3=({r,g:t,b:e,a:i})=>{const n=i<1?Fh(Gi(i*255)):"";return"#"+Fh(r)+Fh(t)+Fh(e)+n},M3=({r,g:t,b:e,a:i})=>{const n=Math.max(r,t,e),s=n-Math.min(r,t,e),o=s?n===r?(t-e)/s:n===t?2+(e-r)/s:4+(r-t)/s:0;return{h:Gi(60*(o<0?o+6:o)),s:Gi(n?s/n*100:0),v:Gi(n/255*100),a:i}},r5=(r,t)=>{if(r===t)return!0;for(const e in r)if(r[e]!==t[e])return!1;return!0},I3=(r,t)=>r.toLowerCase()===t.toLowerCase()?!0:r5(hp(r),hp(t)),cm={},n5=r=>{let t=cm[r];return t||(t=document.createElement("template"),t.innerHTML=r,cm[r]=t),t},gg=(r,t,e)=>{r.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e}))};let Ga=!1;const dp=r=>"touches"in r,j3=r=>Ga&&!dp(r)?!1:(Ga||(Ga=dp(r)),!0),hm=(r,t)=>{const e=dp(t)?t.touches[0]:t,i=r.el.getBoundingClientRect();gg(r.el,"move",r.getMove({x:Pc((e.pageX-(i.left+window.pageXOffset))/i.width),y:Pc((e.pageY-(i.top+window.pageYOffset))/i.height)}))},F3=(r,t)=>{const e=t.keyCode;e>40||r.xy&&e<37||e<33||(t.preventDefault(),gg(r.el,"move",r.getMove({x:e===39?.01:e===37?-.01:e===34?.05:e===33?-.05:e===35?1:e===36?-1:0,y:e===40?.01:e===38?-.01:0},!0)))};class s5{constructor(t,e,i,n){const s=n5(`<div role="slider" tabindex="0" part="${e}" ${i}><div part="${e}-pointer"></div></div>`);t.appendChild(s.content.cloneNode(!0));const o=t.querySelector(`[part=${e}]`);o.addEventListener("mousedown",this),o.addEventListener("touchstart",this),o.addEventListener("keydown",this),this.el=o,this.xy=n,this.nodes=[o.firstChild,o]}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e(Ga?"touchmove":"mousemove",this),e(Ga?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!j3(t)||!Ga&&t.button!=0)return;this.el.focus(),hm(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),hm(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":F3(this,t);break}}style(t){t.forEach((e,i)=>{for(const n in e)this.nodes[i].style.setProperty(n,e[n])})}}class B3 extends s5{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:`${t/360*100}%`,color:up({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${Gi(t)}`)}getMove(t,e){return{h:e?Pc(this.h+t.x*360,0,360):360*t.x}}}class R3 extends s5{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:`${100-t.v}%`,left:`${t.s}%`,color:up(t)},{"background-color":up({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${Gi(t.s)}%, Brightness ${Gi(t.v)}%`)}getMove(t,e){return{s:e?Pc(this.hsva.s+t.x*100,0,100):t.x*100,v:e?Pc(this.hsva.v-t.y*100,0,100):Math.round(100-t.y*100)}}}const q3=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',z3="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",H3="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",Bh=Symbol("same"),df=Symbol("color"),um=Symbol("hsva"),ff=Symbol("update"),dm=Symbol("parts"),fm=Symbol("css"),pm=Symbol("sliders");class U3 extends HTMLElement{static get observedAttributes(){return["color"]}get[fm](){return[q3,z3,H3]}get[pm](){return[R3,B3]}get color(){return this[df]}set color(t){if(!this[Bh](t)){const e=this.colorModel.toHsva(t);this[ff](e),this[df]=t}}constructor(){super();const t=n5(`<style>${this[fm].join("")}</style>`),e=this.attachShadow({mode:"open"});e.appendChild(t.content.cloneNode(!0)),e.addEventListener("move",this),this[dm]=this[pm].map(i=>new i(e))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,i){const n=this.colorModel.fromAttr(i);this[Bh](n)||(this.color=n)}handleEvent(t){const e=this[um],i={...e,...t.detail};this[ff](i);let n;!r5(i,e)&&!this[Bh](n=this.colorModel.fromHsva(i))&&(this[df]=n,gg(this,"color-changed",{value:n}))}[Bh](t){return this.color&&this.colorModel.equal(t,this.color)}[ff](t){this[um]=t,this[dm].forEach(e=>e.update(t))}}const W3={defaultColor:"#000",toHsva:E3,fromHsva:({h:r,s:t,v:e})=>O3({h:r,s:t,v:e,a:1}),equal:I3,fromAttr:r=>r};class V3 extends U3{get colorModel(){return W3}}class o5 extends V3{}customElements.define("hex-color-picker",o5);class a5{constructor(t={}){this.onChange=t.onChange||(()=>{}),this.color=t.color||"#000000",this.presets=["#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff","#ffffff","#000000","#808080","#c0c0c0","#ffa500","#800080","#008000","#000080","#800000","#008080"],this.gradientPresets=["linear-gradient(90deg, #ff0000 0%, #0000ff 100%)","linear-gradient(90deg, #ffff00 0%, #ff0000 100%)","linear-gradient(45deg, #FF9A9E 0%, #FECFEF 99%, #FECFEF 100%)","linear-gradient(120deg, #a18cd1 0%, #fbc2eb 100%)","linear-gradient(to right, #4facfe 0%, #00f2fe 100%)","linear-gradient(to top, #30cfd0 0%, #330867 100%)"],this.activeTab="solid",this.element=null,this.picker=null}mount(t){this.element=document.createElement("div"),this.element.className="advanced-color-picker",this.render(),t.appendChild(this.element)}render(){if(!this.element)return;this.element.innerHTML="";const t=document.createElement("div");t.className="acp-tabs",t.innerHTML=`
            <div class="acp-tab ${this.activeTab==="solid"?"active":""}" data-tab="solid">Solid Color</div>
            <div class="acp-tab ${this.activeTab==="gradient"?"active":""}" data-tab="gradient">Gradient</div>
            <div class="acp-indicator"></div>
        `,this.element.appendChild(t),t.querySelectorAll(".acp-tab").forEach(i=>{i.addEventListener("click",()=>{this.activeTab=i.dataset.tab,this.render()})});const e=document.createElement("div");if(e.className="acp-content",this.activeTab==="solid"?this.renderSolidTab(e):this.renderGradientTab(e),this.element.appendChild(e),this.activeTab==="solid"){const i=this.element.querySelector("#acp-picker-mount");i&&(this.picker=new o5,i.appendChild(this.picker),this.picker.color=this.color,this.picker.addEventListener("color-changed",n=>{this.handleColorChange(n.detail.value)}))}}renderSolidTab(t){const e=document.createElement("div");e.className="acp-swatches";const i=document.createElement("div");i.className="acp-swatch acp-no-color",i.title="Transparent",i.innerHTML='<div class="slash"></div>',i.addEventListener("click",()=>this.handleColorChange("transparent")),e.appendChild(i),this.presets.forEach(a=>{const l=document.createElement("div");l.className="acp-swatch",l.style.backgroundColor=a,l.addEventListener("click",()=>{this.handleColorChange(a),this.picker&&(this.picker.color=a)}),e.appendChild(l)}),t.appendChild(e);const n=document.createElement("div");n.id="acp-picker-mount",t.appendChild(n);const s=document.createElement("div");s.className="acp-input-row",s.innerHTML=`
             <div class="acp-preview" style="background-color: ${this.color}"></div>
             <input type="text" class="acp-hex-input" value="${this.color}" spellcheck="false">
        `,t.appendChild(s),s.querySelector("input").addEventListener("change",a=>{let l=a.target.value;l.startsWith("#")&&(l.length===7||l.length===4)&&(this.handleColorChange(l),this.picker&&(this.picker.color=l))})}renderGradientTab(t){const e=document.createElement("div");e.className="acp-gradient-grid",this.gradientPresets.forEach(i=>{const n=document.createElement("div");n.className="acp-gradient-btn",n.style.background=i,n.addEventListener("click",()=>{this.handleColorChange(i)}),e.appendChild(n)}),t.appendChild(e)}handleColorChange(t){this.color=t;const e=this.element.querySelector(".acp-hex-input"),i=this.element.querySelector(".acp-preview");e&&document.activeElement!==e&&(e.value=t),i&&(i.style.backgroundColor=t),this.onChange(t)}}class Y3{constructor(t,e){this.dom=t,this.cm=e,this.container=document.getElementById("object-properties"),this.currentObj=null}init(){this.initBackgroundControls(),this.cm.onSelectionChange(t=>{this.currentObj=t,this.render()}),this.cm.canvas.on("object:moving",()=>this.updateValues()),this.cm.canvas.on("object:scaling",()=>this.updateValues()),this.cm.canvas.on("object:rotating",()=>this.updateValues()),this.cm.canvas.on("object:resizing",()=>this.updateValues()),this.render()}initBackgroundControls(){const t=document.getElementById("bg-type");if(!t)return;const e=()=>{const i=t.value,n=document.getElementById("bg-solid-controls"),s=document.getElementById("bg-gradient-controls");if(i==="solid")n&&(n.style.display="flex"),s&&(s.style.display="none");else{n&&(n.style.display="none"),s&&(s.style.display="flex");const o=document.getElementById("bg-grad-start").value,a=document.getElementById("bg-grad-end").value,l=document.getElementById("bg-grad-dir").value;this.cm.setBackgroundGradient(o,a,l)}};t.addEventListener("change",e),document.getElementById("bg-grad-start")?.addEventListener("input",e),document.getElementById("bg-grad-end")?.addEventListener("input",e),document.getElementById("bg-grad-dir")?.addEventListener("change",e),this.setupColorPicker("bg-color-picker","bg-color-swatch","bg-color-picker-wrap",i=>{this.cm.setBackgroundColor(i)})}render(){if(!this.container)return;this.container.innerHTML="";const t=this.cm.canvas.isDrawingMode;!this.currentObj&&!t||(T3.forEach(e=>{let i=!1;if(t?e.id==="drawing"&&(i=!0):e.id!=="drawing"&&e.shouldShow(this.currentObj)&&(i=!0),i){const n=document.createElement("div");if(n.className="section",e.title){const s=document.createElement("div");s.className="section-title",s.textContent=e.title,n.appendChild(s)}e.items.forEach(s=>{n.appendChild(this.createField(s))}),this.container.appendChild(n)}}),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{width:16,height:16}}),this.updateValues())}createField(t){if(t.type==="row"){const i=document.createElement("div");return i.className="row",t.items.forEach(n=>{const s=document.createElement("div");s.style.flex=1,s.appendChild(this.createField(n)),i.appendChild(s)}),i}const e=document.createElement("div");if(e.className="input-group",t.label&&t.type!=="actions"){const i=document.createElement("label");i.textContent=t.label,e.appendChild(i)}if(t.type==="number"){const i=document.createElement("input");i.type="number",i.dataset.prop=t.prop,t.min!==void 0&&(i.min=t.min),t.max!==void 0&&(i.max=t.max),t.step!==void 0&&(i.step=t.step),i.addEventListener("input",()=>{const n=parseFloat(i.value);this.updateObjectProperty(t,n)}),e.appendChild(i)}else if(t.type==="text"){const i=document.createElement("input");i.type="text",i.dataset.prop=t.prop,i.addEventListener("input",()=>{this.updateObjectProperty(t,i.value)}),e.appendChild(i)}else if(t.type==="select"){const i=document.createElement("select");i.dataset.prop=t.prop,t.options.forEach(n=>{const s=document.createElement("option");s.value=n.value||"",n.value===null&&(s.value="__null__"),s.textContent=n.label,i.appendChild(s)}),i.addEventListener("change",()=>{let n=i.value;if(n==="__null__")n=null;else if(t.prop==="strokeDashArray"){const s=t.options.find(o=>(o.value===null?"__null__":o.value)==n);s&&(n=s.value)}this.updateObjectProperty(t,n)}),e.appendChild(i)}else if(t.type==="color"){const i=`swatch-${t.prop}-${Math.random().toString(36).substr(2,5)}`,n=`wrap-${t.prop}-${Math.random().toString(36).substr(2,5)}`,s=document.createElement("div");s.style.position="relative",s.innerHTML=`
                <div id="${i}" class="color-swatch" style="background: #000; display:flex; align-items:center; justify-content:center;"></div>
                <div id="${n}" class="color-picker-popup" style="width:auto; padding:12px;"></div>
            `,e.appendChild(s),setTimeout(()=>{const o=s.querySelector(`[id="${i}"]`),a=s.querySelector(`[id="${n}"]`),l=new a5({color:"#000000",onChange:c=>{this.updateObjectProperty(t,c),o.style.background=c}});if(l.mount(a),o.dataset.pickerInstance=!0,o._advancedPicker=l,o.addEventListener("click",c=>{c.stopPropagation();const h=a.style.display==="block";if(document.querySelectorAll(".color-picker-popup").forEach(p=>p.style.display="none"),h)a.style.display="none";else{a.style.display="block",a.style.position="fixed",a.style.zIndex="9999";const p=o.getBoundingClientRect(),m=window.innerWidth-p.left+8;a.style.left="auto",a.style.right=m+"px",p.top+310>window.innerHeight-20?(a.style.top="auto",a.style.bottom=window.innerHeight-p.bottom+"px"):(a.style.top=p.top+"px",a.style.bottom="auto")}}),!window._colorPickerGlobalEvents){window._colorPickerGlobalEvents=!0;const c=()=>{document.querySelectorAll(".color-picker-popup").forEach(h=>h.style.display="none")};window.addEventListener("scroll",c,!0),window.addEventListener("resize",c)}a.addEventListener("click",c=>c.stopPropagation())},0)}else if(t.type==="actions"){const i=document.createElement("div");i.className="toolbar-row",t.actions.forEach(n=>{const s=document.createElement("button");s.className="icon-btn",n.label&&(s.textContent=n.label,s.style.fontSize="0.8rem",s.style.width="auto",s.style.padding="0 8px"),n.icon&&(s.innerHTML=`<i data-lucide="${n.icon}"></i> ${n.label||""}`),s.title=n.title||"",s.addEventListener("click",()=>{if(n.method&&this.cm[n.method]){const o=n.args||[];this.cm[n.method](...o),this.updateValues()}}),i.appendChild(s)}),e.appendChild(i)}else if(t.type==="range"){const i=document.createElement("div");i.className="range-container",i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";const n=document.createElement("input");n.type="range",n.dataset.prop=t.prop,t.min!==void 0&&(n.min=t.min),t.max!==void 0&&(n.max=t.max),t.step!==void 0&&(n.step=t.step),n.style.flex="1";const s=document.createElement("span");s.className="range-val-display",s.style.minWidth="32px",s.style.textAlign="right",s.style.fontSize="0.8rem",s.textContent="0",n.addEventListener("input",()=>{s.textContent=n.value,this.updateObjectProperty(t,parseFloat(n.value))}),i.appendChild(n),i.appendChild(s),e.appendChild(i)}return e}updateObjectProperty(t,e){if(t.prop.startsWith("freeDrawingBrush.")){t.prop==="freeDrawingBrush.color"&&this.cm.setBrushColor(e),t.prop==="freeDrawingBrush.width"&&this.cm.setBrushWidth(e);return}this.currentObj&&(t.prop==="fontFamily"||t.prop==="fontSize"||t.prop==="fontWeight"?this.cm.setTextStyle(t.prop,e):this.cm.updateActiveObject(t.prop,e))}updateValues(){const t=this.cm.canvas.isDrawingMode;if(!this.currentObj&&!t)return;const e=this.currentObj,i=(a,l)=>{if(t&&l.startsWith("freeDrawingBrush.")){const c=this.cm.canvas.freeDrawingBrush;if(!c)return null;if(l==="freeDrawingBrush.color")return c.color;if(l==="freeDrawingBrush.width")return c.width}if(!a)return null;if(l.includes(".")){const c=l.split(".");let h=a;for(const p of c){if(h==null)return null;h=h[p]}return h}return a[l]};this.container.querySelectorAll("input, select").forEach(a=>{const l=a.dataset.prop;if(!l)return;let c=i(e,l);if(e&&(l==="width"?c=Math.round(e.getScaledWidth()):l==="height"?c=Math.round(e.getScaledHeight()):l==="left"?c=Math.round(e.left):l==="top"?c=Math.round(e.top):l==="angle"&&(c=Math.round(e.angle))),a.tagName==="SELECT")if(l==="strokeDashArray"&&e){const h=e.strokeDashArray;!h||h.length===0?a.value="__null__":h[0]<5?a.value=[2,2].toString():a.value=[10,5].toString()}else a.value=c;else if(a.type==="number")a.value=c===void 0?"":c;else if(a.type==="text")a.value=c===void 0?"":c;else if(a.type==="range"){const h=a.getAttribute("min")||0;a.value=c??h;const p=a.nextElementSibling;p&&p.classList.contains("range-val-display")&&(p.textContent=a.value)}}),this.container.querySelectorAll(".color-swatch").forEach(a=>{const l=a.id.split("-");if(l.length>=3){const c=l.slice(1,l.length-1).join("-");let h=i(e,c);h&&(a.style.background=h,a._advancedPicker&&(a._advancedPicker.color=h))}}),this.container.querySelectorAll(".toolbar-row button").forEach(a=>{const l=a.querySelector("i");if(l&&e){const c=l.getAttribute("data-lucide");let h=!1;c==="bold"&&(h=e.fontWeight==="bold"),c==="italic"&&(h=e.fontStyle==="italic"),c==="underline"&&(h=!!e.underline),h?a.classList.add("active"):a.classList.remove("active")}})}setupColorPicker(t,e,i,n){const s=document.getElementById(t),o=document.getElementById(e),a=document.getElementById(i);s&&o&&a&&(o.addEventListener("click",l=>{l.stopPropagation();const c=a.style.display==="block";if(document.querySelectorAll(".color-picker-popup").forEach(h=>h.style.display="none"),c)a.style.display="none";else{a.style.display="block";const h=a.parentElement.getBoundingClientRect(),p=200,m=window.innerWidth;h.left+p>m-20?(a.style.left="auto",a.style.right="0"):(a.style.left="0",a.style.right="auto")}}),s.addEventListener("color-changed",l=>{const c=l.detail.value;o.style.backgroundColor=c,n(c)}),document.addEventListener("click",l=>{!a.contains(l.target)&&!o.contains(l.target)&&(a.style.display="none")}))}}const G3="modulepreload",X3=function(r,t){return new URL(r,t).href},gm={},pf=function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){let c=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");n=c(e.map(h=>{if(h=X3(h,i),h in gm)return;gm[h]=!0;const p=h.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(i)for(let b=o.length-1;b>=0;b--){const y=o[b];if(y.href===h&&(!p||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${m}`))return;const f=document.createElement("link");if(f.rel=p?"stylesheet":G3,p||(f.as="script"),f.crossOrigin="",f.href=h,l&&f.setAttribute("nonce",l),document.head.appendChild(f),p)return new Promise((b,y)=>{f.addEventListener("load",b),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};function Re(r){"@babel/helpers - typeof";return Re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(r)}var On=Uint8Array,Ur=Uint16Array,mg=Int32Array,vg=new On([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),wg=new On([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mm=new On([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l5=function(r,t){for(var e=new Ur(31),i=0;i<31;++i)e[i]=t+=1<<r[i-1];for(var n=new mg(e[30]),i=1;i<30;++i)for(var s=e[i];s<e[i+1];++s)n[s]=s-e[i]<<5|i;return{b:e,r:n}},c5=l5(vg,2),$3=c5.b,fp=c5.r;$3[28]=258,fp[258]=28;var K3=l5(wg,0),vm=K3.r,pp=new Ur(32768);for(var $e=0;$e<32768;++$e){var oo=($e&43690)>>1|($e&21845)<<1;oo=(oo&52428)>>2|(oo&13107)<<2,oo=(oo&61680)>>4|(oo&3855)<<4,pp[$e]=((oo&65280)>>8|(oo&255)<<8)>>1}var yc=(function(r,t,e){for(var i=r.length,n=0,s=new Ur(t);n<i;++n)r[n]&&++s[r[n]-1];var o=new Ur(t);for(n=1;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;var a;if(e){a=new Ur(1<<t);var l=15-t;for(n=0;n<i;++n)if(r[n])for(var c=n<<4|r[n],h=t-r[n],p=o[r[n]-1]++<<h,m=p|(1<<h)-1;p<=m;++p)a[pp[p]>>l]=c}else for(a=new Ur(i),n=0;n<i;++n)r[n]&&(a[n]=pp[o[r[n]-1]++]>>15-r[n]);return a}),na=new On(288);for(var $e=0;$e<144;++$e)na[$e]=8;for(var $e=144;$e<256;++$e)na[$e]=9;for(var $e=256;$e<280;++$e)na[$e]=7;for(var $e=280;$e<288;++$e)na[$e]=8;var qu=new On(32);for(var $e=0;$e<32;++$e)qu[$e]=5;var Z3=yc(na,9,0),J3=yc(qu,5,0),h5=function(r){return(r+7)/8|0},Q3=function(r,t,e){return(e==null||e>r.length)&&(e=r.length),new On(r.subarray(t,e))},Ls=function(r,t,e){e<<=t&7;var i=t/8|0;r[i]|=e,r[i+1]|=e>>8},Xl=function(r,t,e){e<<=t&7;var i=t/8|0;r[i]|=e,r[i+1]|=e>>8,r[i+2]|=e>>16},gf=function(r,t){for(var e=[],i=0;i<r.length;++i)r[i]&&e.push({s:i,f:r[i]});var n=e.length,s=e.slice();if(!n)return{t:d5,l:0};if(n==1){var o=new On(e[0].s+1);return o[e[0].s]=1,{t:o,l:1}}e.sort(function(V,Z){return V.f-Z.f}),e.push({s:-1,f:25001});var a=e[0],l=e[1],c=0,h=1,p=2;for(e[0]={s:-1,f:a.f+l.f,l:a,r:l};h!=n-1;)a=e[e[c].f<e[p].f?c++:p++],l=e[c!=h&&e[c].f<e[p].f?c++:p++],e[h++]={s:-1,f:a.f+l.f,l:a,r:l};for(var m=s[0].s,i=1;i<n;++i)s[i].s>m&&(m=s[i].s);var f=new Ur(m+1),b=gp(e[h-1],f,0);if(b>t){var i=0,y=0,_=b-t,x=1<<_;for(s.sort(function(Z,nt){return f[nt.s]-f[Z.s]||Z.f-nt.f});i<n;++i){var E=s[i].s;if(f[E]>t)y+=x-(1<<b-f[E]),f[E]=t;else break}for(y>>=_;y>0;){var I=s[i].s;f[I]<t?y-=1<<t-f[I]++-1:++i}for(;i>=0&&y;--i){var O=s[i].s;f[O]==t&&(--f[O],++y)}b=t}return{t:new On(f),l:b}},gp=function(r,t,e){return r.s==-1?Math.max(gp(r.l,t,e+1),gp(r.r,t,e+1)):t[r.s]=e},wm=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new Ur(++t),i=0,n=r[0],s=1,o=function(l){e[i++]=l},a=1;a<=t;++a)if(r[a]==n&&a!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(n),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(n);s=1,n=r[a]}return{c:e.subarray(0,i),n:t}},$l=function(r,t){for(var e=0,i=0;i<t.length;++i)e+=r[i]*t[i];return e},u5=function(r,t,e){var i=e.length,n=h5(t+2);r[n]=i&255,r[n+1]=i>>8,r[n+2]=r[n]^255,r[n+3]=r[n+1]^255;for(var s=0;s<i;++s)r[n+s+4]=e[s];return(n+4+i)*8},bm=function(r,t,e,i,n,s,o,a,l,c,h){Ls(t,h++,e),++n[256];for(var p=gf(n,15),m=p.t,f=p.l,b=gf(s,15),y=b.t,_=b.l,x=wm(m),E=x.c,I=x.n,O=wm(y),V=O.c,Z=O.n,nt=new Ur(19),W=0;W<E.length;++W)++nt[E[W]&31];for(var W=0;W<V.length;++W)++nt[V[W]&31];for(var M=gf(nt,7),J=M.t,L=M.l,N=19;N>4&&!J[mm[N-1]];--N);var H=c+5<<3,z=$l(n,na)+$l(s,qu)+o,st=$l(n,m)+$l(s,y)+o+14+3*N+$l(nt,J)+2*nt[16]+3*nt[17]+7*nt[18];if(l>=0&&H<=z&&H<=st)return u5(t,h,r.subarray(l,l+c));var lt,ht,et,dt;if(Ls(t,h,1+(st<z)),h+=2,st<z){lt=yc(m,f,0),ht=m,et=yc(y,_,0),dt=y;var kt=yc(J,L,0);Ls(t,h,I-257),Ls(t,h+5,Z-1),Ls(t,h+10,N-4),h+=14;for(var W=0;W<N;++W)Ls(t,h+3*W,J[mm[W]]);h+=3*N;for(var xt=[E,V],T=0;T<2;++T)for(var q=xt[T],W=0;W<q.length;++W){var U=q[W]&31;Ls(t,h,kt[U]),h+=J[U],U>15&&(Ls(t,h,q[W]>>5&127),h+=q[W]>>12)}}else lt=Z3,ht=na,et=J3,dt=qu;for(var W=0;W<a;++W){var X=i[W];if(X>255){var U=X>>18&31;Xl(t,h,lt[U+257]),h+=ht[U+257],U>7&&(Ls(t,h,X>>23&31),h+=vg[U]);var Q=X&31;Xl(t,h,et[Q]),h+=dt[Q],Q>3&&(Xl(t,h,X>>5&8191),h+=wg[Q])}else Xl(t,h,lt[X]),h+=ht[X]}return Xl(t,h,lt[256]),h+ht[256]},t4=new mg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),d5=new On(0),e4=function(r,t,e,i,n,s){var o=s.z||r.length,a=new On(i+o+5*(1+Math.ceil(o/7e3))+n),l=a.subarray(i,a.length-n),c=s.l,h=(s.r||0)&7;if(t){h&&(l[0]=s.r>>3);for(var p=t4[t-1],m=p>>13,f=p&8191,b=(1<<e)-1,y=s.p||new Ur(32768),_=s.h||new Ur(b+1),x=Math.ceil(e/3),E=2*x,I=function(Vt){return(r[Vt]^r[Vt+1]<<x^r[Vt+2]<<E)&b},O=new mg(25e3),V=new Ur(288),Z=new Ur(32),nt=0,W=0,M=s.i||0,J=0,L=s.w||0,N=0;M+2<o;++M){var H=I(M),z=M&32767,st=_[H];if(y[z]=st,_[H]=z,L<=M){var lt=o-M;if((nt>7e3||J>24576)&&(lt>423||!c)){h=bm(r,l,0,O,V,Z,W,J,N,M-N,h),J=nt=W=0,N=M;for(var ht=0;ht<286;++ht)V[ht]=0;for(var ht=0;ht<30;++ht)Z[ht]=0}var et=2,dt=0,kt=f,xt=z-st&32767;if(lt>2&&H==I(M-xt))for(var T=Math.min(m,lt)-1,q=Math.min(32767,M),U=Math.min(258,lt);xt<=q&&--kt&&z!=st;){if(r[M+et]==r[M+et-xt]){for(var X=0;X<U&&r[M+X]==r[M+X-xt];++X);if(X>et){if(et=X,dt=xt,X>T)break;for(var Q=Math.min(xt,X-2),ot=0,ht=0;ht<Q;++ht){var ft=M-xt+ht&32767,pt=y[ft],vt=ft-pt&32767;vt>ot&&(ot=vt,st=ft)}}}z=st,st=y[z],xt+=z-st&32767}if(dt){O[J++]=268435456|fp[et]<<18|vm[dt];var Lt=fp[et]&31,Nt=vm[dt]&31;W+=vg[Lt]+wg[Nt],++V[257+Lt],++Z[Nt],L=M+et,++nt}else O[J++]=r[M],++V[r[M]]}}for(M=Math.max(M,L);M<o;++M)O[J++]=r[M],++V[r[M]];h=bm(r,l,c,O,V,Z,W,J,N,M-N,h),c||(s.r=h&7|l[h/8|0]<<3,h-=7,s.h=_,s.p=y,s.i=M,s.w=L)}else{for(var M=s.w||0;M<o+c;M+=65535){var Pt=M+65535;Pt>=o&&(l[h/8|0]=c,Pt=o),h=u5(l,h+1,r.subarray(M,Pt))}s.i=o}return Q3(a,0,i+h5(h)+n)},f5=function(){var r=1,t=0;return{p:function(e){for(var i=r,n=t,s=e.length|0,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)n+=i+=e[o];i=(i&65535)+15*(i>>16),n=(n&65535)+15*(n>>16)}r=i,t=n},d:function(){return r%=65521,t%=65521,(r&255)<<24|(r&65280)<<8|(t&255)<<8|t>>8}}},i4=function(r,t,e,i,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new On(s.length+r.length);o.set(s),o.set(r,s.length),r=o,n.w=s.length}return e4(r,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+t.mem,e,i,n)},p5=function(r,t,e){for(;e;++t)r[t]=e,e>>>=8},r4=function(r,t){var e=t.level,i=e==0?0:e<6?1:e==9?3:2;if(r[0]=120,r[1]=i<<6|(t.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,t.dictionary){var n=f5();n.p(t.dictionary),p5(r,2,n.d())}};function mp(r,t){t||(t={});var e=f5();e.p(r);var i=i4(r,t,t.dictionary?6:2,4);return r4(i,t),p5(i,i.length-4,e.d()),i}var n4=typeof TextDecoder<"u"&&new TextDecoder,s4=0;try{n4.decode(d5,{stream:!0}),s4=1}catch{}function o4(r){if(Array.isArray(r))return r}function a4(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var i,n,s,o,a=[],l=!0,c=!1;try{if(s=(e=e.call(r)).next,t!==0)for(;!(l=(i=s.call(e)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(h){c=!0,n=h}finally{try{if(!l&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function ym(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,i=Array(t);e<t;e++)i[e]=r[e];return i}function l4(r,t){if(r){if(typeof r=="string")return ym(r,t);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ym(r,t):void 0}}function c4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xm(r,t){return o4(r)||a4(r,t)||l4(r,t)||c4()}function _m(r,t="utf8"){return new TextDecoder(t).decode(r)}const h4=new TextEncoder;function u4(r){return h4.encode(r)}const d4=1024*8,f4=(()=>{const r=new Uint8Array(4),t=new Uint32Array(r.buffer);return!((t[0]=1)&r[0])})(),mf={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class bg{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=d4,e={}){let i=!1;typeof t=="number"?t=new ArrayBuffer(t):(i=!0,this.lastWrittenByte=t.byteLength);const n=e.offset?e.offset>>>0:0,s=t.byteLength-n;let o=n;(ArrayBuffer.isView(t)||t instanceof bg)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+n),t=t.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const i=(this.offset+t)*2,n=new Uint8Array(i);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const i=mf[e].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+i);if(this.littleEndian===f4&&e!=="uint8"&&e!=="int8"){const a=new Uint8Array(this.buffer.slice(n,n+i));a.reverse();const l=new mf[e](a.buffer);return this.offset+=i,l.reverse(),l}const o=new mf[e](s);return this.offset+=i,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let i=0;i<t;i++)e+=this.readChar();return e}readUtf8(t=1){return _m(this.readBytes(t))}decodeText(t=1,e="utf8"){return _m(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(u4(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function ml(r){let t=r.length;for(;--t>=0;)r[t]=0}const p4=3,g4=258,g5=29,m4=256,v4=m4+1+g5,m5=30,w4=512,b4=new Array((v4+2)*2);ml(b4);const y4=new Array(m5*2);ml(y4);const x4=new Array(w4);ml(x4);const _4=new Array(g4-p4+1);ml(_4);const S4=new Array(g5);ml(S4);const C4=new Array(m5);ml(C4);const k4=(r,t,e,i)=>{let n=r&65535|0,s=r>>>16&65535|0,o=0;for(;e!==0;){o=e>2e3?2e3:e,e-=o;do n=n+t[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0};var vp=k4;const A4=()=>{let r,t=[];for(var e=0;e<256;e++){r=e;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;t[e]=r}return t},L4=new Uint32Array(A4()),T4=(r,t,e,i)=>{const n=L4,s=i+e;r^=-1;for(let o=i;o<s;o++)r=r>>>8^n[(r^t[o])&255];return r^-1};var Hn=T4,wp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},v5={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const E4=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var O4=function(r){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const i in e)E4(e,i)&&(r[i]=e[i])}}return r},P4=r=>{let t=0;for(let i=0,n=r.length;i<n;i++)t+=r[i].length;const e=new Uint8Array(t);for(let i=0,n=0,s=r.length;i<s;i++){let o=r[i];e.set(o,n),n+=o.length}return e},w5={assign:O4,flattenChunks:P4};let b5=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{b5=!1}const Nc=new Uint8Array(256);for(let r=0;r<256;r++)Nc[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;Nc[254]=Nc[254]=1;var N4=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let t,e,i,n,s,o=r.length,a=0;for(n=0;n<o;n++)e=r.charCodeAt(n),(e&64512)===55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),n++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(a),s=0,n=0;s<a;n++)e=r.charCodeAt(n),(e&64512)===55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),n++)),e<128?t[s++]=e:e<2048?(t[s++]=192|e>>>6,t[s++]=128|e&63):e<65536?(t[s++]=224|e>>>12,t[s++]=128|e>>>6&63,t[s++]=128|e&63):(t[s++]=240|e>>>18,t[s++]=128|e>>>12&63,t[s++]=128|e>>>6&63,t[s++]=128|e&63);return t};const D4=(r,t)=>{if(t<65534&&r.subarray&&b5)return String.fromCharCode.apply(null,r.length===t?r:r.subarray(0,t));let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(r[i]);return e};var M4=(r,t)=>{const e=t||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,t));let i,n;const s=new Array(e*2);for(n=0,i=0;i<e;){let o=r[i++];if(o<128){s[n++]=o;continue}let a=Nc[o];if(a>4){s[n++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<e;)o=o<<6|r[i++]&63,a--;if(a>1){s[n++]=65533;continue}o<65536?s[n++]=o:(o-=65536,s[n++]=55296|o>>10&1023,s[n++]=56320|o&1023)}return D4(s,n)},I4=(r,t)=>{t=t||r.length,t>r.length&&(t=r.length);let e=t-1;for(;e>=0&&(r[e]&192)===128;)e--;return e<0||e===0?t:e+Nc[r[e]]>t?e:t},bp={string2buf:N4,buf2string:M4,utf8border:I4};function j4(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var F4=j4;const Rh=16209,B4=16191;var R4=function(t,e){let i,n,s,o,a,l,c,h,p,m,f,b,y,_,x,E,I,O,V,Z,nt,W,M,J;const L=t.state;i=t.next_in,M=t.input,n=i+(t.avail_in-5),s=t.next_out,J=t.output,o=s-(e-t.avail_out),a=s+(t.avail_out-257),l=L.dmax,c=L.wsize,h=L.whave,p=L.wnext,m=L.window,f=L.hold,b=L.bits,y=L.lencode,_=L.distcode,x=(1<<L.lenbits)-1,E=(1<<L.distbits)-1;t:do{b<15&&(f+=M[i++]<<b,b+=8,f+=M[i++]<<b,b+=8),I=y[f&x];e:for(;;){if(O=I>>>24,f>>>=O,b-=O,O=I>>>16&255,O===0)J[s++]=I&65535;else if(O&16){V=I&65535,O&=15,O&&(b<O&&(f+=M[i++]<<b,b+=8),V+=f&(1<<O)-1,f>>>=O,b-=O),b<15&&(f+=M[i++]<<b,b+=8,f+=M[i++]<<b,b+=8),I=_[f&E];i:for(;;){if(O=I>>>24,f>>>=O,b-=O,O=I>>>16&255,O&16){if(Z=I&65535,O&=15,b<O&&(f+=M[i++]<<b,b+=8,b<O&&(f+=M[i++]<<b,b+=8)),Z+=f&(1<<O)-1,Z>l){t.msg="invalid distance too far back",L.mode=Rh;break t}if(f>>>=O,b-=O,O=s-o,Z>O){if(O=Z-O,O>h&&L.sane){t.msg="invalid distance too far back",L.mode=Rh;break t}if(nt=0,W=m,p===0){if(nt+=c-O,O<V){V-=O;do J[s++]=m[nt++];while(--O);nt=s-Z,W=J}}else if(p<O){if(nt+=c+p-O,O-=p,O<V){V-=O;do J[s++]=m[nt++];while(--O);if(nt=0,p<V){O=p,V-=O;do J[s++]=m[nt++];while(--O);nt=s-Z,W=J}}}else if(nt+=p-O,O<V){V-=O;do J[s++]=m[nt++];while(--O);nt=s-Z,W=J}for(;V>2;)J[s++]=W[nt++],J[s++]=W[nt++],J[s++]=W[nt++],V-=3;V&&(J[s++]=W[nt++],V>1&&(J[s++]=W[nt++]))}else{nt=s-Z;do J[s++]=J[nt++],J[s++]=J[nt++],J[s++]=J[nt++],V-=3;while(V>2);V&&(J[s++]=J[nt++],V>1&&(J[s++]=J[nt++]))}}else if((O&64)===0){I=_[(I&65535)+(f&(1<<O)-1)];continue i}else{t.msg="invalid distance code",L.mode=Rh;break t}break}}else if((O&64)===0){I=y[(I&65535)+(f&(1<<O)-1)];continue e}else if(O&32){L.mode=B4;break t}else{t.msg="invalid literal/length code",L.mode=Rh;break t}break}}while(i<n&&s<a);V=b>>3,i-=V,b-=V<<3,f&=(1<<b)-1,t.next_in=i,t.next_out=s,t.avail_in=i<n?5+(n-i):5-(i-n),t.avail_out=s<a?257+(a-s):257-(s-a),L.hold=f,L.bits=b};const Ta=15,Sm=852,Cm=592,km=0,vf=1,Am=2,q4=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),z4=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),H4=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),U4=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),W4=(r,t,e,i,n,s,o,a)=>{const l=a.bits;let c=0,h=0,p=0,m=0,f=0,b=0,y=0,_=0,x=0,E=0,I,O,V,Z,nt,W=null,M;const J=new Uint16Array(Ta+1),L=new Uint16Array(Ta+1);let N=null,H,z,st;for(c=0;c<=Ta;c++)J[c]=0;for(h=0;h<i;h++)J[t[e+h]]++;for(f=l,m=Ta;m>=1&&J[m]===0;m--);if(f>m&&(f=m),m===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,a.bits=1,0;for(p=1;p<m&&J[p]===0;p++);for(f<p&&(f=p),_=1,c=1;c<=Ta;c++)if(_<<=1,_-=J[c],_<0)return-1;if(_>0&&(r===km||m!==1))return-1;for(L[1]=0,c=1;c<Ta;c++)L[c+1]=L[c]+J[c];for(h=0;h<i;h++)t[e+h]!==0&&(o[L[t[e+h]]++]=h);if(r===km?(W=N=o,M=20):r===vf?(W=q4,N=z4,M=257):(W=H4,N=U4,M=0),E=0,h=0,c=p,nt=s,b=f,y=0,V=-1,x=1<<f,Z=x-1,r===vf&&x>Sm||r===Am&&x>Cm)return 1;for(;;){H=c-y,o[h]+1<M?(z=0,st=o[h]):o[h]>=M?(z=N[o[h]-M],st=W[o[h]-M]):(z=96,st=0),I=1<<c-y,O=1<<b,p=O;do O-=I,n[nt+(E>>y)+O]=H<<24|z<<16|st|0;while(O!==0);for(I=1<<c-1;E&I;)I>>=1;if(I!==0?(E&=I-1,E+=I):E=0,h++,--J[c]===0){if(c===m)break;c=t[e+o[h]]}if(c>f&&(E&Z)!==V){for(y===0&&(y=f),nt+=p,b=c-y,_=1<<b;b+y<m&&(_-=J[b+y],!(_<=0));)b++,_<<=1;if(x+=1<<b,r===vf&&x>Sm||r===Am&&x>Cm)return 1;V=E&Z,n[V]=f<<24|b<<16|nt-s|0}}return E!==0&&(n[nt+E]=c-y<<24|64<<16|0),a.bits=f,0};var xc=W4;const V4=0,y5=1,x5=2,{Z_FINISH:Lm,Z_BLOCK:Y4,Z_TREES:qh,Z_OK:sa,Z_STREAM_END:G4,Z_NEED_DICT:X4,Z_STREAM_ERROR:hn,Z_DATA_ERROR:_5,Z_MEM_ERROR:S5,Z_BUF_ERROR:$4,Z_DEFLATED:Tm}=v5,fd=16180,Em=16181,Om=16182,Pm=16183,Nm=16184,Dm=16185,Mm=16186,Im=16187,jm=16188,Fm=16189,zu=16190,Ts=16191,wf=16192,Bm=16193,bf=16194,Rm=16195,qm=16196,zm=16197,Hm=16198,zh=16199,Hh=16200,Um=16201,Wm=16202,Vm=16203,Ym=16204,Gm=16205,yf=16206,Xm=16207,$m=16208,Qe=16209,C5=16210,k5=16211,K4=852,Z4=592,J4=15,Q4=J4,Km=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function tC(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ua=r=>{if(!r)return 1;const t=r.state;return!t||t.strm!==r||t.mode<fd||t.mode>k5?1:0},A5=r=>{if(ua(r))return hn;const t=r.state;return r.total_in=r.total_out=t.total=0,r.msg="",t.wrap&&(r.adler=t.wrap&1),t.mode=fd,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(K4),t.distcode=t.distdyn=new Int32Array(Z4),t.sane=1,t.back=-1,sa},L5=r=>{if(ua(r))return hn;const t=r.state;return t.wsize=0,t.whave=0,t.wnext=0,A5(r)},T5=(r,t)=>{let e;if(ua(r))return hn;const i=r.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?hn:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=e,i.wbits=t,L5(r))},E5=(r,t)=>{if(!r)return hn;const e=new tC;r.state=e,e.strm=r,e.window=null,e.mode=fd;const i=T5(r,t);return i!==sa&&(r.state=null),i},eC=r=>E5(r,Q4);let Zm=!0,xf,_f;const iC=r=>{if(Zm){xf=new Int32Array(512),_f=new Int32Array(32);let t=0;for(;t<144;)r.lens[t++]=8;for(;t<256;)r.lens[t++]=9;for(;t<280;)r.lens[t++]=7;for(;t<288;)r.lens[t++]=8;for(xc(y5,r.lens,0,288,xf,0,r.work,{bits:9}),t=0;t<32;)r.lens[t++]=5;xc(x5,r.lens,0,32,_f,0,r.work,{bits:5}),Zm=!1}r.lencode=xf,r.lenbits=9,r.distcode=_f,r.distbits=5},O5=(r,t,e,i)=>{let n;const s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(t.subarray(e-i,e-i+n),s.wnext),i-=n,i?(s.window.set(t.subarray(e-i,e),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},rC=(r,t)=>{let e,i,n,s,o,a,l,c,h,p,m,f,b,y,_=0,x,E,I,O,V,Z,nt,W;const M=new Uint8Array(4);let J,L;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ua(r)||!r.output||!r.input&&r.avail_in!==0)return hn;e=r.state,e.mode===Ts&&(e.mode=wf),o=r.next_out,n=r.output,l=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,c=e.hold,h=e.bits,p=a,m=l,W=sa;t:for(;;)switch(e.mode){case fd:if(e.wrap===0){e.mode=wf;break}for(;h<16;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(e.wrap&2&&c===35615){e.wbits===0&&(e.wbits=15),e.check=0,M[0]=c&255,M[1]=c>>>8&255,e.check=Hn(e.check,M,2,0),c=0,h=0,e.mode=Em;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((c&255)<<8)+(c>>8))%31){r.msg="incorrect header check",e.mode=Qe;break}if((c&15)!==Tm){r.msg="unknown compression method",e.mode=Qe;break}if(c>>>=4,h-=4,nt=(c&15)+8,e.wbits===0&&(e.wbits=nt),nt>15||nt>e.wbits){r.msg="invalid window size",e.mode=Qe;break}e.dmax=1<<e.wbits,e.flags=0,r.adler=e.check=1,e.mode=c&512?Fm:Ts,c=0,h=0;break;case Em:for(;h<16;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(e.flags=c,(e.flags&255)!==Tm){r.msg="unknown compression method",e.mode=Qe;break}if(e.flags&57344){r.msg="unknown header flags set",e.mode=Qe;break}e.head&&(e.head.text=c>>8&1),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,e.check=Hn(e.check,M,2,0)),c=0,h=0,e.mode=Om;case Om:for(;h<32;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}e.head&&(e.head.time=c),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,M[2]=c>>>16&255,M[3]=c>>>24&255,e.check=Hn(e.check,M,4,0)),c=0,h=0,e.mode=Pm;case Pm:for(;h<16;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}e.head&&(e.head.xflags=c&255,e.head.os=c>>8),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,e.check=Hn(e.check,M,2,0)),c=0,h=0,e.mode=Nm;case Nm:if(e.flags&1024){for(;h<16;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}e.length=c,e.head&&(e.head.extra_len=c),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,e.check=Hn(e.check,M,2,0)),c=0,h=0}else e.head&&(e.head.extra=null);e.mode=Dm;case Dm:if(e.flags&1024&&(f=e.length,f>a&&(f=a),f&&(e.head&&(nt=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(s,s+f),nt)),e.flags&512&&e.wrap&4&&(e.check=Hn(e.check,i,f,s)),a-=f,s+=f,e.length-=f),e.length))break t;e.length=0,e.mode=Mm;case Mm:if(e.flags&2048){if(a===0)break t;f=0;do nt=i[s+f++],e.head&&nt&&e.length<65536&&(e.head.name+=String.fromCharCode(nt));while(nt&&f<a);if(e.flags&512&&e.wrap&4&&(e.check=Hn(e.check,i,f,s)),a-=f,s+=f,nt)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=Im;case Im:if(e.flags&4096){if(a===0)break t;f=0;do nt=i[s+f++],e.head&&nt&&e.length<65536&&(e.head.comment+=String.fromCharCode(nt));while(nt&&f<a);if(e.flags&512&&e.wrap&4&&(e.check=Hn(e.check,i,f,s)),a-=f,s+=f,nt)break t}else e.head&&(e.head.comment=null);e.mode=jm;case jm:if(e.flags&512){for(;h<16;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(e.wrap&4&&c!==(e.check&65535)){r.msg="header crc mismatch",e.mode=Qe;break}c=0,h=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),r.adler=e.check=0,e.mode=Ts;break;case Fm:for(;h<32;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}r.adler=e.check=Km(c),c=0,h=0,e.mode=zu;case zu:if(e.havedict===0)return r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,e.hold=c,e.bits=h,X4;r.adler=e.check=1,e.mode=Ts;case Ts:if(t===Y4||t===qh)break t;case wf:if(e.last){c>>>=h&7,h-=h&7,e.mode=yf;break}for(;h<3;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}switch(e.last=c&1,c>>>=1,h-=1,c&3){case 0:e.mode=Bm;break;case 1:if(iC(e),e.mode=zh,t===qh){c>>>=2,h-=2;break t}break;case 2:e.mode=qm;break;case 3:r.msg="invalid block type",e.mode=Qe}c>>>=2,h-=2;break;case Bm:for(c>>>=h&7,h-=h&7;h<32;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){r.msg="invalid stored block lengths",e.mode=Qe;break}if(e.length=c&65535,c=0,h=0,e.mode=bf,t===qh)break t;case bf:e.mode=Rm;case Rm:if(f=e.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break t;n.set(i.subarray(s,s+f),o),a-=f,s+=f,l-=f,o+=f,e.length-=f;break}e.mode=Ts;break;case qm:for(;h<14;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(e.nlen=(c&31)+257,c>>>=5,h-=5,e.ndist=(c&31)+1,c>>>=5,h-=5,e.ncode=(c&15)+4,c>>>=4,h-=4,e.nlen>286||e.ndist>30){r.msg="too many length or distance symbols",e.mode=Qe;break}e.have=0,e.mode=zm;case zm:for(;e.have<e.ncode;){for(;h<3;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}e.lens[N[e.have++]]=c&7,c>>>=3,h-=3}for(;e.have<19;)e.lens[N[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,J={bits:e.lenbits},W=xc(V4,e.lens,0,19,e.lencode,0,e.work,J),e.lenbits=J.bits,W){r.msg="invalid code lengths set",e.mode=Qe;break}e.have=0,e.mode=Hm;case Hm:for(;e.have<e.nlen+e.ndist;){for(;_=e.lencode[c&(1<<e.lenbits)-1],x=_>>>24,E=_>>>16&255,I=_&65535,!(x<=h);){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(I<16)c>>>=x,h-=x,e.lens[e.have++]=I;else{if(I===16){for(L=x+2;h<L;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(c>>>=x,h-=x,e.have===0){r.msg="invalid bit length repeat",e.mode=Qe;break}nt=e.lens[e.have-1],f=3+(c&3),c>>>=2,h-=2}else if(I===17){for(L=x+3;h<L;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}c>>>=x,h-=x,nt=0,f=3+(c&7),c>>>=3,h-=3}else{for(L=x+7;h<L;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}c>>>=x,h-=x,nt=0,f=11+(c&127),c>>>=7,h-=7}if(e.have+f>e.nlen+e.ndist){r.msg="invalid bit length repeat",e.mode=Qe;break}for(;f--;)e.lens[e.have++]=nt}}if(e.mode===Qe)break;if(e.lens[256]===0){r.msg="invalid code -- missing end-of-block",e.mode=Qe;break}if(e.lenbits=9,J={bits:e.lenbits},W=xc(y5,e.lens,0,e.nlen,e.lencode,0,e.work,J),e.lenbits=J.bits,W){r.msg="invalid literal/lengths set",e.mode=Qe;break}if(e.distbits=6,e.distcode=e.distdyn,J={bits:e.distbits},W=xc(x5,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,J),e.distbits=J.bits,W){r.msg="invalid distances set",e.mode=Qe;break}if(e.mode=zh,t===qh)break t;case zh:e.mode=Hh;case Hh:if(a>=6&&l>=258){r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,e.hold=c,e.bits=h,R4(r,m),o=r.next_out,n=r.output,l=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,c=e.hold,h=e.bits,e.mode===Ts&&(e.back=-1);break}for(e.back=0;_=e.lencode[c&(1<<e.lenbits)-1],x=_>>>24,E=_>>>16&255,I=_&65535,!(x<=h);){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(E&&(E&240)===0){for(O=x,V=E,Z=I;_=e.lencode[Z+((c&(1<<O+V)-1)>>O)],x=_>>>24,E=_>>>16&255,I=_&65535,!(O+x<=h);){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}c>>>=O,h-=O,e.back+=O}if(c>>>=x,h-=x,e.back+=x,e.length=I,E===0){e.mode=Gm;break}if(E&32){e.back=-1,e.mode=Ts;break}if(E&64){r.msg="invalid literal/length code",e.mode=Qe;break}e.extra=E&15,e.mode=Um;case Um:if(e.extra){for(L=e.extra;h<L;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,h-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Wm;case Wm:for(;_=e.distcode[c&(1<<e.distbits)-1],x=_>>>24,E=_>>>16&255,I=_&65535,!(x<=h);){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if((E&240)===0){for(O=x,V=E,Z=I;_=e.distcode[Z+((c&(1<<O+V)-1)>>O)],x=_>>>24,E=_>>>16&255,I=_&65535,!(O+x<=h);){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}c>>>=O,h-=O,e.back+=O}if(c>>>=x,h-=x,e.back+=x,E&64){r.msg="invalid distance code",e.mode=Qe;break}e.offset=I,e.extra=E&15,e.mode=Vm;case Vm:if(e.extra){for(L=e.extra;h<L;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,h-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){r.msg="invalid distance too far back",e.mode=Qe;break}e.mode=Ym;case Ym:if(l===0)break t;if(f=m-l,e.offset>f){if(f=e.offset-f,f>e.whave&&e.sane){r.msg="invalid distance too far back",e.mode=Qe;break}f>e.wnext?(f-=e.wnext,b=e.wsize-f):b=e.wnext-f,f>e.length&&(f=e.length),y=e.window}else y=n,b=o-e.offset,f=e.length;f>l&&(f=l),l-=f,e.length-=f;do n[o++]=y[b++];while(--f);e.length===0&&(e.mode=Hh);break;case Gm:if(l===0)break t;n[o++]=e.length,l--,e.mode=Hh;break;case yf:if(e.wrap){for(;h<32;){if(a===0)break t;a--,c|=i[s++]<<h,h+=8}if(m-=l,r.total_out+=m,e.total+=m,e.wrap&4&&m&&(r.adler=e.check=e.flags?Hn(e.check,n,m,o-m):vp(e.check,n,m,o-m)),m=l,e.wrap&4&&(e.flags?c:Km(c))!==e.check){r.msg="incorrect data check",e.mode=Qe;break}c=0,h=0}e.mode=Xm;case Xm:if(e.wrap&&e.flags){for(;h<32;){if(a===0)break t;a--,c+=i[s++]<<h,h+=8}if(e.wrap&4&&c!==(e.total&4294967295)){r.msg="incorrect length check",e.mode=Qe;break}c=0,h=0}e.mode=$m;case $m:W=G4;break t;case Qe:W=_5;break t;case C5:return S5;case k5:default:return hn}return r.next_out=o,r.avail_out=l,r.next_in=s,r.avail_in=a,e.hold=c,e.bits=h,(e.wsize||m!==r.avail_out&&e.mode<Qe&&(e.mode<yf||t!==Lm))&&O5(r,r.output,r.next_out,m-r.avail_out),p-=r.avail_in,m-=r.avail_out,r.total_in+=p,r.total_out+=m,e.total+=m,e.wrap&4&&m&&(r.adler=e.check=e.flags?Hn(e.check,n,m,r.next_out-m):vp(e.check,n,m,r.next_out-m)),r.data_type=e.bits+(e.last?64:0)+(e.mode===Ts?128:0)+(e.mode===zh||e.mode===bf?256:0),(p===0&&m===0||t===Lm)&&W===sa&&(W=$4),W},nC=r=>{if(ua(r))return hn;let t=r.state;return t.window&&(t.window=null),r.state=null,sa},sC=(r,t)=>{if(ua(r))return hn;const e=r.state;return(e.wrap&2)===0?hn:(e.head=t,t.done=!1,sa)},oC=(r,t)=>{const e=t.length;let i,n,s;return ua(r)||(i=r.state,i.wrap!==0&&i.mode!==zu)?hn:i.mode===zu&&(n=1,n=vp(n,t,e,0),n!==i.check)?_5:(s=O5(r,t,e,e),s?(i.mode=C5,S5):(i.havedict=1,sa))};var aC=L5,lC=T5,cC=A5,hC=eC,uC=E5,dC=rC,fC=nC,pC=sC,gC=oC,mC="pako inflate (from Nodeca project)",Ps={inflateReset:aC,inflateReset2:lC,inflateResetKeep:cC,inflateInit:hC,inflateInit2:uC,inflate:dC,inflateEnd:fC,inflateGetHeader:pC,inflateSetDictionary:gC,inflateInfo:mC};function vC(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var wC=vC;const P5=Object.prototype.toString,{Z_NO_FLUSH:bC,Z_FINISH:yC,Z_OK:Dc,Z_STREAM_END:Sf,Z_NEED_DICT:Cf,Z_STREAM_ERROR:xC,Z_DATA_ERROR:Jm,Z_MEM_ERROR:_C}=v5;function Uc(r){this.options=w5.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(r&&r.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new F4,this.strm.avail_out=0;let e=Ps.inflateInit2(this.strm,t.windowBits);if(e!==Dc)throw new Error(wp[e]);if(this.header=new wC,Ps.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=bp.string2buf(t.dictionary):P5.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Ps.inflateSetDictionary(this.strm,t.dictionary),e!==Dc)))throw new Error(wp[e])}Uc.prototype.push=function(r,t){const e=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?yC:bC,P5.call(r)==="[object ArrayBuffer]"?e.input=new Uint8Array(r):e.input=r,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),s=Ps.inflate(e,o),s===Cf&&n&&(s=Ps.inflateSetDictionary(e,n),s===Dc?s=Ps.inflate(e,o):s===Jm&&(s=Cf));e.avail_in>0&&s===Sf&&e.state.wrap>0&&r[e.next_in]!==0;)Ps.inflateReset(e),s=Ps.inflate(e,o);switch(s){case xC:case Jm:case Cf:case _C:return this.onEnd(s),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(e.avail_out===0||s===Sf))if(this.options.to==="string"){let l=bp.utf8border(e.output,e.next_out),c=e.next_out-l,h=bp.buf2string(e.output,l);e.next_out=c,e.avail_out=i-c,c&&e.output.set(e.output.subarray(l,l+c),0),this.onData(h)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(s===Dc&&a===0)){if(s===Sf)return s=Ps.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};Uc.prototype.onData=function(r){this.chunks.push(r)};Uc.prototype.onEnd=function(r){r===Dc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=w5.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function SC(r,t){const e=new Uc(t);if(e.push(r),e.err)throw e.msg||wp[e.err];return e.result}var CC=Uc,kC=SC,AC={Inflate:CC,inflate:kC};const{Inflate:LC,inflate:TC}=AC;var Qm=LC,EC=TC;const N5=[];for(let r=0;r<256;r++){let t=r;for(let e=0;e<8;e++)t&1?t=3988292384^t>>>1:t=t>>>1;N5[r]=t}const t1=4294967295;function OC(r,t,e){let i=r;for(let n=0;n<e;n++)i=N5[(i^t[n])&255]^i>>>8;return i}function PC(r,t){return(OC(t1,r,t)^t1)>>>0}function e1(r,t,e){const i=r.readUint32(),n=PC(new Uint8Array(r.buffer,r.byteOffset+r.offset-t-4,t),t);if(n!==i)throw new Error(`CRC mismatch for chunk ${e}. Expected ${i}, found ${n}`)}function D5(r,t,e){for(let i=0;i<e;i++)t[i]=r[i]}function M5(r,t,e,i){let n=0;for(;n<i;n++)t[n]=r[n];for(;n<e;n++)t[n]=r[n]+t[n-i]&255}function I5(r,t,e,i){let n=0;if(e.length===0)for(;n<i;n++)t[n]=r[n];else for(;n<i;n++)t[n]=r[n]+e[n]&255}function j5(r,t,e,i,n){let s=0;if(e.length===0){for(;s<n;s++)t[s]=r[s];for(;s<i;s++)t[s]=r[s]+(t[s-n]>>1)&255}else{for(;s<n;s++)t[s]=r[s]+(e[s]>>1)&255;for(;s<i;s++)t[s]=r[s]+(t[s-n]+e[s]>>1)&255}}function F5(r,t,e,i,n){let s=0;if(e.length===0){for(;s<n;s++)t[s]=r[s];for(;s<i;s++)t[s]=r[s]+t[s-n]&255}else{for(;s<n;s++)t[s]=r[s]+e[s]&255;for(;s<i;s++)t[s]=r[s]+NC(t[s-n],e[s],e[s-n])&255}}function NC(r,t,e){const i=r+t-e,n=Math.abs(i-r),s=Math.abs(i-t),o=Math.abs(i-e);return n<=s&&n<=o?r:s<=o?t:e}function DC(r,t,e,i,n,s){switch(r){case 0:D5(t,e,n);break;case 1:M5(t,e,n,s);break;case 2:I5(t,e,i,n);break;case 3:j5(t,e,i,n,s);break;case 4:F5(t,e,i,n,s);break;default:throw new Error(`Unsupported filter: ${r}`)}}const MC=new Uint16Array([255]),IC=new Uint8Array(MC.buffer),jC=IC[0]===255;function FC(r){const{data:t,width:e,height:i,channels:n,depth:s}=r,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(s/8)*n,l=new Uint8Array(i*e*a);let c=0;for(let h=0;h<7;h++){const p=o[h],m=Math.ceil((e-p.x)/p.xStep),f=Math.ceil((i-p.y)/p.yStep);if(m<=0||f<=0)continue;const b=m*a,y=new Uint8Array(b);for(let _=0;_<f;_++){const x=t[c++],E=t.subarray(c,c+b);c+=b;const I=new Uint8Array(b);DC(x,E,I,y,b,a),y.set(I);for(let O=0;O<m;O++){const V=p.x+O*p.xStep,Z=p.y+_*p.yStep;if(!(V>=e||Z>=i))for(let nt=0;nt<a;nt++)l[(Z*e+V)*a+nt]=I[O*a+nt]}}}if(s===16){const h=new Uint16Array(l.buffer);if(jC)for(let p=0;p<h.length;p++)h[p]=BC(h[p]);return h}else return l}function BC(r){return(r&255)<<8|r>>8&255}const RC=new Uint16Array([255]),qC=new Uint8Array(RC.buffer),zC=qC[0]===255,HC=new Uint8Array(0);function i1(r){const{data:t,width:e,height:i,channels:n,depth:s}=r,o=Math.ceil(s/8)*n,a=Math.ceil(s/8*n*e),l=new Uint8Array(i*a);let c=HC,h=0,p,m;for(let f=0;f<i;f++){switch(p=t.subarray(h+1,h+1+a),m=l.subarray(f*a,(f+1)*a),t[h]){case 0:D5(p,m,a);break;case 1:M5(p,m,a,o);break;case 2:I5(p,m,c,a);break;case 3:j5(p,m,c,a,o);break;case 4:F5(p,m,c,a,o);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}c=m,h+=a+1}if(s===16){const f=new Uint16Array(l.buffer);if(zC)for(let b=0;b<f.length;b++)f[b]=UC(f[b]);return f}else return l}function UC(r){return(r&255)<<8|r>>8&255}const ru=Uint8Array.of(137,80,78,71,13,10,26,10);function r1(r){if(!WC(r.readBytes(ru.length)))throw new Error("wrong PNG signature")}function WC(r){if(r.length<ru.length)return!1;for(let t=0;t<ru.length;t++)if(r[t]!==ru[t])return!1;return!0}const VC="tEXt",YC=0,B5=new TextDecoder("latin1");function GC(r){if($C(r),r.length===0||r.length>79)throw new Error("keyword length must be between 1 and 79")}const XC=/^[\u0000-\u00FF]*$/;function $C(r){if(!XC.test(r))throw new Error("invalid latin1 text")}function KC(r,t,e){const i=R5(t);r[i]=ZC(t,e-i.length-1)}function R5(r){for(r.mark();r.readByte()!==YC;);const t=r.offset;r.reset();const e=B5.decode(r.readBytes(t-r.offset-1));return r.skip(1),GC(e),e}function ZC(r,t){return B5.decode(r.readBytes(t))}const qr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},kf={UNKNOWN:-1,DEFLATE:0},n1={UNKNOWN:-1,ADAPTIVE:0},Af={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Uh={NONE:0,BACKGROUND:1,PREVIOUS:2},Lf={SOURCE:0,OVER:1};class JC extends bg{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,e={}){super(t);const{checkCrc:i=!1}=e;this._checkCrc=i,this._inflator=new Qm,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=kf.UNKNOWN,this._filterMethod=n1.UNKNOWN,this._interlaceMethod=Af.UNKNOWN,this._colorType=qr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(r1(this);!this._end;){const t=this.readUint32(),e=this.readChars(4);this.decodeChunk(t,e)}return this.decodeImage(),this._png}decodeApng(){for(r1(this);!this._end;){const t=this.readUint32(),e=this.readChars(4);this.decodeApngChunk(t,e)}return this.decodeApngImage(),this._apng}decodeChunk(t,e){const i=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case VC:KC(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?e1(this,t+4,e):this.skip(4)}decodeApngChunk(t,e){const i=this.offset;switch(e!=="fdAT"&&e!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),e){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,e),this.offset=i+t;break}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?e1(this,t+4,e):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=QC(this.readUint8());const e=this.readUint8();this._colorType=e;let i;switch(e){case qr.GREYSCALE:i=1;break;case qr.TRUECOLOUR:i=3;break;case qr.INDEXED_COLOUR:i=1;break;case qr.GREYSCALE_ALPHA:i=2;break;case qr.TRUECOLOUR_ALPHA:i=4;break;case qr.UNKNOWN:default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==kf.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const i=[];this._palette=i;for(let n=0;n<e;n++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const e=t,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let e=t,i=this.offset+this.byteOffset;if(i+=4,e-=4,this._inflator.push(new Uint8Array(this.buffer,i,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case qr.GREYSCALE:case qr.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break}case qr.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const i=this.readByte();this._palette[e].push(i)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}case qr.UNKNOWN:case qr.GREYSCALE_ALPHA:case qr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const e=R5(this),i=this.readUint8();if(i!==kf.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const n=this.readBytes(t-e.length-2);this._png.iccEmbeddedProfile={name:e,profile:EC(n)}}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),i=this.readByte();this._png.resolution={x:t,y:e,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const e={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(t);if(i){if(i.data=i1({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)e.data=i.data;else{const n=this._apng.frames.at(t-1);this.disposeFrame(i,n,e),this.addFrameDataToCanvas(e,i)}this._apng.frames.push(e)}}return this._apng}disposeFrame(t,e,i){switch(t.disposeOp){case Uh.NONE:break;case Uh.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let s=0;s<this._png.width;s++){const o=(n*t.width+s)*this._png.channels;for(let a=0;a<this._png.channels;a++)i.data[o+a]=0}break;case Uh.PREVIOUS:i.data.set(e.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,e){const i=1<<this._png.depth,n=(s,o)=>{const a=((s+e.yOffset)*this._png.width+e.xOffset+o)*this._png.channels,l=(s*e.width+o)*this._png.channels;return{index:a,frameIndex:l}};switch(e.blendOp){case Lf.SOURCE:for(let s=0;s<e.height;s++)for(let o=0;o<e.width;o++){const{index:a,frameIndex:l}=n(s,o);for(let c=0;c<this._png.channels;c++)t.data[a+c]=e.data[l+c]}break;case Lf.OVER:for(let s=0;s<e.height;s++)for(let o=0;o<e.width;o++){const{index:a,frameIndex:l}=n(s,o);for(let c=0;c<this._png.channels;c++){const h=e.data[l+this._png.channels-1]/i,p=c%(this._png.channels-1)===0?1:e.data[l+c],m=Math.floor(h*p+(1-h)*t.data[a+c]);t.data[a+c]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==n1.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Af.NO_INTERLACE)this._png.data=i1({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Af.ADAM7)this._png.data=FC({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,e=this._frames.at(-1);e?e.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Uh.NONE,blendOp:Lf.SOURCE,data:t}),this._inflator=new Qm,this._writingDataChunks=!1}}function QC(r){if(r!==1&&r!==2&&r!==4&&r!==8&&r!==16)throw new Error(`invalid bit depth: ${r}`);return r}var s1;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.METRE=1]="METRE"})(s1||(s1={}));function tk(r,t){return new JC(r,t).decode()}var re=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Tf(){re.console&&typeof re.console.log=="function"&&re.console.log.apply(re.console,arguments)}var He={log:Tf,warn:function(r){re.console&&(typeof re.console.warn=="function"?re.console.warn.apply(re.console,arguments):Tf.call(null,arguments))},error:function(r){re.console&&(typeof re.console.error=="function"?re.console.error.apply(re.console,arguments):Tf(r))}};function Ef(r,t,e){var i=new XMLHttpRequest;i.open("GET",r),i.responseType="blob",i.onload=function(){Uo(i.response,t,e)},i.onerror=function(){He.error("could not download file")},i.send()}function o1(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Wh(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}var Uo=re.saveAs||((typeof window>"u"?"undefined":Re(window))!=="object"||window!==re?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,e){var i=re.URL||re.webkitURL,n=document.createElement("a");t=t||r.name||"download",n.download=t,n.rel="noopener",typeof r=="string"?(n.href=r,n.origin!==location.origin?o1(n.href)?Ef(r,t,e):Wh(n,n.target="_blank"):Wh(n)):(n.href=i.createObjectURL(r),setTimeout(function(){i.revokeObjectURL(n.href)},4e4),setTimeout(function(){Wh(n)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,e){if(t=t||r.name||"download",typeof r=="string")if(o1(r))Ef(r,t,e);else{var i=document.createElement("a");i.href=r,i.target="_blank",setTimeout(function(){Wh(i)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:Re(s)!=="object"&&(He.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(r,e),t)}:function(r,t,e,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof r=="string")return Ef(r,t,e);var n=r.type==="application/octet-stream",s=/constructor/i.test(re.HTMLElement)||re.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&s)&&(typeof FileReader>"u"?"undefined":Re(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var h=a.result;h=o?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=h:location=h,i=null},a.readAsDataURL(r)}else{var l=re.URL||re.webkitURL,c=l.createObjectURL(r);i?i.location=c:location.href=c,i=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function q5(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],i=0;i<e.length;i++){var n=e[i].re,s=e[i].process,o=n.exec(r);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return a.length==1&&(a="0"+a),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+a+l+c}}var nu=re.atob.bind(re),a1=re.btoa.bind(re);function Of(r,t){var e=r[0],i=r[1],n=r[2],s=r[3];e=Ki(e,i,n,s,t[0],7,-680876936),s=Ki(s,e,i,n,t[1],12,-389564586),n=Ki(n,s,e,i,t[2],17,606105819),i=Ki(i,n,s,e,t[3],22,-1044525330),e=Ki(e,i,n,s,t[4],7,-176418897),s=Ki(s,e,i,n,t[5],12,1200080426),n=Ki(n,s,e,i,t[6],17,-1473231341),i=Ki(i,n,s,e,t[7],22,-45705983),e=Ki(e,i,n,s,t[8],7,1770035416),s=Ki(s,e,i,n,t[9],12,-1958414417),n=Ki(n,s,e,i,t[10],17,-42063),i=Ki(i,n,s,e,t[11],22,-1990404162),e=Ki(e,i,n,s,t[12],7,1804603682),s=Ki(s,e,i,n,t[13],12,-40341101),n=Ki(n,s,e,i,t[14],17,-1502002290),e=Zi(e,i=Ki(i,n,s,e,t[15],22,1236535329),n,s,t[1],5,-165796510),s=Zi(s,e,i,n,t[6],9,-1069501632),n=Zi(n,s,e,i,t[11],14,643717713),i=Zi(i,n,s,e,t[0],20,-373897302),e=Zi(e,i,n,s,t[5],5,-701558691),s=Zi(s,e,i,n,t[10],9,38016083),n=Zi(n,s,e,i,t[15],14,-660478335),i=Zi(i,n,s,e,t[4],20,-405537848),e=Zi(e,i,n,s,t[9],5,568446438),s=Zi(s,e,i,n,t[14],9,-1019803690),n=Zi(n,s,e,i,t[3],14,-187363961),i=Zi(i,n,s,e,t[8],20,1163531501),e=Zi(e,i,n,s,t[13],5,-1444681467),s=Zi(s,e,i,n,t[2],9,-51403784),n=Zi(n,s,e,i,t[7],14,1735328473),e=Ji(e,i=Zi(i,n,s,e,t[12],20,-1926607734),n,s,t[5],4,-378558),s=Ji(s,e,i,n,t[8],11,-2022574463),n=Ji(n,s,e,i,t[11],16,1839030562),i=Ji(i,n,s,e,t[14],23,-35309556),e=Ji(e,i,n,s,t[1],4,-1530992060),s=Ji(s,e,i,n,t[4],11,1272893353),n=Ji(n,s,e,i,t[7],16,-155497632),i=Ji(i,n,s,e,t[10],23,-1094730640),e=Ji(e,i,n,s,t[13],4,681279174),s=Ji(s,e,i,n,t[0],11,-358537222),n=Ji(n,s,e,i,t[3],16,-722521979),i=Ji(i,n,s,e,t[6],23,76029189),e=Ji(e,i,n,s,t[9],4,-640364487),s=Ji(s,e,i,n,t[12],11,-421815835),n=Ji(n,s,e,i,t[15],16,530742520),e=Qi(e,i=Ji(i,n,s,e,t[2],23,-995338651),n,s,t[0],6,-198630844),s=Qi(s,e,i,n,t[7],10,1126891415),n=Qi(n,s,e,i,t[14],15,-1416354905),i=Qi(i,n,s,e,t[5],21,-57434055),e=Qi(e,i,n,s,t[12],6,1700485571),s=Qi(s,e,i,n,t[3],10,-1894986606),n=Qi(n,s,e,i,t[10],15,-1051523),i=Qi(i,n,s,e,t[1],21,-2054922799),e=Qi(e,i,n,s,t[8],6,1873313359),s=Qi(s,e,i,n,t[15],10,-30611744),n=Qi(n,s,e,i,t[6],15,-1560198380),i=Qi(i,n,s,e,t[13],21,1309151649),e=Qi(e,i,n,s,t[4],6,-145523070),s=Qi(s,e,i,n,t[11],10,-1120210379),n=Qi(n,s,e,i,t[2],15,718787259),i=Qi(i,n,s,e,t[9],21,-343485551),r[0]=mo(e,r[0]),r[1]=mo(i,r[1]),r[2]=mo(n,r[2]),r[3]=mo(s,r[3])}function pd(r,t,e,i,n,s){return t=mo(mo(t,r),mo(i,s)),mo(t<<n|t>>>32-n,e)}function Ki(r,t,e,i,n,s,o){return pd(t&e|~t&i,r,t,n,s,o)}function Zi(r,t,e,i,n,s,o){return pd(t&i|e&~i,r,t,n,s,o)}function Ji(r,t,e,i,n,s,o){return pd(t^e^i,r,t,n,s,o)}function Qi(r,t,e,i,n,s,o){return pd(e^(t|~i),r,t,n,s,o)}function z5(r){var t,e=r.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)Of(i,ek(r.substring(t-64,t)));r=r.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)n[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Of(i,n),t=0;t<16;t++)n[t]=0;return n[14]=8*e,Of(i,n),i}function ek(r){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}var l1="0123456789abcdef".split("");function ik(r){for(var t="",e=0;e<4;e++)t+=l1[r>>8*e+4&15]+l1[r>>8*e&15];return t}function rk(r){return String.fromCharCode(255&r,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function yp(r){return z5(r).map(rk).join("")}var nk=(function(r){for(var t=0;t<r.length;t++)r[t]=ik(r[t]);return r.join("")})(z5("hello"))!="5d41402abc4b2a76b9719d911017c592";function mo(r,t){if(nk){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}return r+t&4294967295}function xp(r,t){var e,i,n,s;if(r!==e){for(var o=(n=r,s=1+(256/r.length|0),new Array(s+1).join(n)),a=[],l=0;l<256;l++)a[l]=l;var c=0;for(l=0;l<256;l++){var h=a[l];c=(c+h+o.charCodeAt(l))%256,a[l]=a[c],a[c]=h}e=r,i=a}else a=i;var p=t.length,m=0,f=0,b="";for(l=0;l<p;l++)f=(f+(h=a[m=(m+1)%256]))%256,a[m]=a[f],a[f]=h,o=a[(a[m]+a[f])%256],b+=String.fromCharCode(t.charCodeAt(l)^o);return b}var c1={print:4,modify:8,copy:16,"annot-forms":32};function Ma(r,t,e,i){this.v=1,this.r=2;var n=192;r.forEach(function(a){if(c1.perm!==void 0)throw new Error("Invalid permission: "+a);n+=c1[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^n)),this.encryptionKey=yp(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=xp(this.encryptionKey,this.padding)}function Ia(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",e=r.length,i=0;i<e;i++){var n=r.charCodeAt(i);t+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):r[i]}return t}function h1(r){if(Re(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,i,n){if(n=n||!1,typeof e!="string"||typeof i!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[i,!!n],s},this.unsubscribe=function(e){for(var i in t)if(t[i][e])return delete t[i][e],Object.keys(t[i]).length===0&&delete t[i],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var i=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[e]){var o=t[e][s];try{o[0].apply(r,i)}catch(a){re.console&&He.error("jsPDF PubSub Error",a.message,a)}o[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Hu(r){if(!(this instanceof Hu))return new Hu(r);var t="opacity,stroke-opacity".split(",");for(var e in r)r.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=r[e]);this.id="",this.objectNumber=-1}function H5(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function Go(r,t,e,i,n){if(!(this instanceof Go))return new Go(r,t,e,i,n);this.type=r==="axial"?2:3,this.coords=t,this.colors=e,H5.call(this,i,n)}function qa(r,t,e,i,n){if(!(this instanceof qa))return new qa(r,t,e,i,n);this.boundingBox=r,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,H5.call(this,i,n)}function Ut(r){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],n=arguments[2],s=arguments[3],o=[],a=1,l=16,c="S",h=null;Re(r=r||{})==="object"&&(e=r.orientation,i=r.unit||i,n=r.format||n,s=r.compress||r.compressPdf||s,(h=r.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),a=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(l=r.floatPrecision),c=r.defaultPathOperation||"S"),o=r.filters||(s===!0?["FlateEncode"]:o),i=i||"mm",e=(""+(e||"P")).toLowerCase();var p=r.putOnlyUsedFonts||!1,m={},f={internal:{},__private__:{}};f.__private__.PubSub=h1;var b="1.3",y=f.__private__.getPdfVersion=function(){return b};f.__private__.setPdfVersion=function(g){b=g};var _={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return _};var x=f.__private__.getPageFormat=function(g){return _[g]};n=n||"a4";var E="compat",I="advanced",O=E;function V(){this.saveGraphicsState(),j(new Qt(de,0,0,-de,0,Oo()*de).toString()+" cm"),this.setFontSize(this.getFontSize()/de),c="n",O=I}function Z(){this.restoreGraphicsState(),c="S",O=E}var nt=f.__private__.combineFontStyleAndFontWeight=function(g,S){if(g=="bold"&&S=="normal"||g=="bold"&&S==400||g=="normal"&&S=="italic"||g=="bold"&&S=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return S&&(g=S==400||S==="normal"?g==="italic"?"italic":"normal":S!=700&&S!=="bold"||g!=="normal"?(S==700?"bold":S)+""+g:"bold"),g};f.advancedAPI=function(g){var S=O===E;return S&&V.call(this),typeof g!="function"||(g(this),S&&Z.call(this)),this},f.compatAPI=function(g){var S=O===I;return S&&Z.call(this),typeof g!="function"||(g(this),S&&V.call(this)),this},f.isAdvancedAPI=function(){return O===I};var W,M=function(g){if(O!==I)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},J=f.roundToPrecision=f.__private__.roundToPrecision=function(g,S){var R=t||S;if(isNaN(g)||isNaN(R))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed(R).replace(/0+$/,"")};W=f.hpf=f.__private__.hpf=typeof l=="number"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return J(g,l)}:l==="smart"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return J(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return J(g,16)};var L=f.f2=f.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return J(g,2)},N=f.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return J(g,3)},H=f.scale=f.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return O===E?g*de:O===I?g:void 0},z=function(g){return H((function(S){return O===E?Oo()-S:O===I?S:void 0})(g))};f.__private__.setPrecision=f.setPrecision=function(g){typeof parseInt(g,10)=="number"&&(t=parseInt(g,10))};var st,lt="00000000000000000000000000000000",ht=f.__private__.getFileId=function(){return lt},et=f.__private__.setFileId=function(g){return lt=g!==void 0&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():lt.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Oi=new Ma(h.userPermissions,h.userPassword,h.ownerPassword,lt)),lt};f.setFileId=function(g){return et(g),this},f.getFileId=function(){return ht()};var dt=f.__private__.convertDateToPDFDate=function(g){var S=g.getTimezoneOffset(),R=S<0?"+":"-",Y=Math.floor(Math.abs(S/60)),it=Math.abs(S%60),bt=[R,U(Y),"'",U(it),"'"].join("");return["D:",g.getFullYear(),U(g.getMonth()+1),U(g.getDate()),U(g.getHours()),U(g.getMinutes()),U(g.getSeconds()),bt].join("")},kt=f.__private__.convertPDFDateToDate=function(g){var S=parseInt(g.substr(2,4),10),R=parseInt(g.substr(6,2),10)-1,Y=parseInt(g.substr(8,2),10),it=parseInt(g.substr(10,2),10),bt=parseInt(g.substr(12,2),10),_t=parseInt(g.substr(14,2),10);return new Date(S,R,Y,it,bt,_t,0)},xt=f.__private__.setCreationDate=function(g){var S;if(g===void 0&&(g=new Date),g instanceof Date)S=dt(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");S=g}return st=S},T=f.__private__.getCreationDate=function(g){var S=st;return g==="jsDate"&&(S=kt(st)),S};f.setCreationDate=function(g){return xt(g),this},f.getCreationDate=function(g){return T(g)};var q,U=f.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},X=f.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},Q=0,ot=[],ft=[],pt=0,vt=[],Lt=[],Nt=!1,Pt=ft;f.__private__.setCustomOutputDestination=function(g){Nt=!0,Pt=g};var Vt=function(g){Nt||(Pt=g)};f.__private__.resetCustomOutputDestination=function(){Nt=!1,Pt=ft};var j=f.__private__.out=function(g){return g=g.toString(),pt+=g.length+1,Pt.push(g),Pt},Ot=f.__private__.write=function(g){return j(arguments.length===1?g.toString():Array.prototype.join.call(arguments," "))},me=f.__private__.getArrayBuffer=function(g){for(var S=g.length,R=new ArrayBuffer(S),Y=new Uint8Array(R);S--;)Y[S]=g.charCodeAt(S);return R},Kt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Kt};var Ct=r.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(g){return Ct=O===I?g/de:g,this};var Zt,It=f.__private__.getFontSize=f.getFontSize=function(){return O===E?Ct:Ct*de},$t=r.R2L||!1;f.__private__.setR2L=f.setR2L=function(g){return $t=g,this},f.__private__.getR2L=f.getR2L=function(){return $t};var Yt,De=f.__private__.setZoomMode=function(g){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))Zt=g;else if(isNaN(g)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(g)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');Zt=g}else Zt=parseInt(g,10)};f.__private__.getZoomMode=function(){return Zt};var ye,le=f.__private__.setPageMode=function(g){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');Yt=g};f.__private__.getPageMode=function(){return Yt};var Se=f.__private__.setLayoutMode=function(g){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');ye=g};f.__private__.getLayoutMode=function(){return ye},f.__private__.setDisplayMode=f.setDisplayMode=function(g,S,R){return De(g),Se(S),le(R),this};var xe={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(g){if(Object.keys(xe).indexOf(g)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xe[g]},f.__private__.getDocumentProperties=function(){return xe},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(g){for(var S in xe)xe.hasOwnProperty(S)&&g[S]&&(xe[S]=g[S]);return this},f.__private__.setDocumentProperty=function(g,S){if(Object.keys(xe).indexOf(g)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xe[g]=S};var qt,de,Wt,hi,Le,ve={},we={},Ze=[],Xt={},We={},te={},ce={},Je=null,be=0,Jt=[],Me=new h1(f),_o=r.hotfixes||[],Xi={},cs={},Dn=[],Qt=function g(S,R,Y,it,bt,_t){if(!(this instanceof g))return new g(S,R,Y,it,bt,_t);isNaN(S)&&(S=1),isNaN(R)&&(R=0),isNaN(Y)&&(Y=0),isNaN(it)&&(it=1),isNaN(bt)&&(bt=0),isNaN(_t)&&(_t=0),this._matrix=[S,R,Y,it,bt,_t]};Object.defineProperty(Qt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Qt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Qt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Qt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Qt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Qt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Qt.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Qt.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Qt.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Qt.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Qt.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Qt.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Qt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Qt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Qt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Qt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Qt.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(W).join(g)},Qt.prototype.multiply=function(g){var S=g.sx*this.sx+g.shy*this.shx,R=g.sx*this.shy+g.shy*this.sy,Y=g.shx*this.sx+g.sy*this.shx,it=g.shx*this.shy+g.sy*this.sy,bt=g.tx*this.sx+g.ty*this.shx+this.tx,_t=g.tx*this.shy+g.ty*this.sy+this.ty;return new Qt(S,R,Y,it,bt,_t)},Qt.prototype.decompose=function(){var g=this.sx,S=this.shy,R=this.shx,Y=this.sy,it=this.tx,bt=this.ty,_t=Math.sqrt(g*g+S*S),Ft=(g/=_t)*R+(S/=_t)*Y;R-=g*Ft,Y-=S*Ft;var zt=Math.sqrt(R*R+Y*Y);return Ft/=zt,g*(Y/=zt)<S*(R/=zt)&&(g=-g,S=-S,Ft=-Ft,_t=-_t),{scale:new Qt(_t,0,0,zt,0,0),translate:new Qt(1,0,0,1,it,bt),rotate:new Qt(g,S,-S,g,0,0),skew:new Qt(1,0,Ft,1,0,0)}},Qt.prototype.toString=function(g){return this.join(" ")},Qt.prototype.inversed=function(){var g=this.sx,S=this.shy,R=this.shx,Y=this.sy,it=this.tx,bt=this.ty,_t=1/(g*Y-S*R),Ft=Y*_t,zt=-S*_t,ne=-R*_t,fe=g*_t;return new Qt(Ft,zt,ne,fe,-Ft*it-ne*bt,-zt*it-fe*bt)},Qt.prototype.applyToPoint=function(g){var S=g.x*this.sx+g.y*this.shx+this.tx,R=g.x*this.shy+g.y*this.sy+this.ty;return new ms(S,R)},Qt.prototype.applyToRectangle=function(g){var S=this.applyToPoint(g),R=this.applyToPoint(new ms(g.x+g.w,g.y+g.h));return new kl(S.x,S.y,R.x-S.x,R.y-S.y)},Qt.prototype.clone=function(){var g=this.sx,S=this.shy,R=this.shx,Y=this.sy,it=this.tx,bt=this.ty;return new Qt(g,S,R,Y,it,bt)},f.Matrix=Qt;var hs=f.matrixMult=function(g,S){return S.multiply(g)},us=new Qt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=us;var Kr=function(g,S){if(!We[g]){var R=(S instanceof Go?"Sh":"P")+(Object.keys(Xt).length+1).toString(10);S.id=R,We[g]=R,Xt[R]=S,Me.publish("addPattern",S)}};f.ShadingPattern=Go,f.TilingPattern=qa,f.addShadingPattern=function(g,S){return M("addShadingPattern()"),Kr(g,S),this},f.beginTilingPattern=function(g){M("beginTilingPattern()"),Al(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},f.endTilingPattern=function(g,S){M("endTilingPattern()"),S.stream=Lt[q].join(`
`),Kr(g,S),Me.publish("endTilingPattern",S),Dn.pop().restore()};var Zr,ni=f.__private__.newObject=function(){var g=ji();return Ri(g,!0),g},ji=f.__private__.newObjectDeferred=function(){return Q++,ot[Q]=function(){return pt},Q},Ri=function(g,S){return S=typeof S=="boolean"&&S,ot[g]=pt,S&&j(g+" 0 obj"),g},So=f.__private__.newAdditionalObject=function(){var g={objId:ji(),content:""};return vt.push(g),g},Hs=ji(),un=ji(),Mn=f.__private__.decodeColorString=function(g){var S=g.split(" ");if(S.length!==2||S[1]!=="g"&&S[1]!=="G")S.length!==5||S[4]!=="k"&&S[4]!=="K"||(S=[(1-S[0])*(1-S[3]),(1-S[1])*(1-S[3]),(1-S[2])*(1-S[3]),"r"]);else{var R=parseFloat(S[0]);S=[R,R,R,"r"]}for(var Y="#",it=0;it<3;it++)Y+=("0"+Math.floor(255*parseFloat(S[it])).toString(16)).slice(-2);return Y},dn=f.__private__.encodeColorString=function(g){var S;typeof g=="string"&&(g={ch1:g});var R=g.ch1,Y=g.ch2,it=g.ch3,bt=g.ch4,_t=g.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof R=="string"&&R.charAt(0)!=="#"){var Ft=new q5(R);if(Ft.ok)R=Ft.toHex();else if(!/^\d*\.?\d*$/.test(R))throw new Error('Invalid color "'+R+'" passed to jsPDF.encodeColorString.')}if(typeof R=="string"&&/^#[0-9A-Fa-f]{3}$/.test(R)&&(R="#"+R[1]+R[1]+R[2]+R[2]+R[3]+R[3]),typeof R=="string"&&/^#[0-9A-Fa-f]{6}$/.test(R)){var zt=parseInt(R.substr(1),16);R=zt>>16&255,Y=zt>>8&255,it=255&zt}if(Y===void 0||bt===void 0&&R===Y&&Y===it)S=typeof R=="string"?R+" "+_t[0]:g.precision===2?L(R/255)+" "+_t[0]:N(R/255)+" "+_t[0];else if(bt===void 0||Re(bt)==="object"){if(bt&&!isNaN(bt.a)&&bt.a===0)return["1.","1.","1.",_t[1]].join(" ");S=typeof R=="string"?[R,Y,it,_t[1]].join(" "):g.precision===2?[L(R/255),L(Y/255),L(it/255),_t[1]].join(" "):[N(R/255),N(Y/255),N(it/255),_t[1]].join(" ")}else S=typeof R=="string"?[R,Y,it,bt,_t[2]].join(" "):g.precision===2?[L(R),L(Y),L(it),L(bt),_t[2]].join(" "):[N(R),N(Y),N(it),N(bt),_t[2]].join(" ");return S},fn=f.__private__.getFilters=function(){return o},Jr=f.__private__.putStream=function(g){var S=(g=g||{}).data||"",R=g.filters||fn(),Y=g.alreadyAppliedFilters||[],it=g.addLength1||!1,bt=S.length,_t=g.objectId,Ft=function(Pi){return Pi};if(h!==null&&_t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Ft=Oi.encryptor(_t,0));var zt={};R===!0&&(R=["FlateEncode"]);var ne=g.additionalKeyValues||[],fe=(zt=Ut.API.processDataByFilters!==void 0?Ut.API.processDataByFilters(S,R):{data:S,reverseChain:[]}).reverseChain+(Array.isArray(Y)?Y.join(" "):Y.toString());if(zt.data.length!==0&&(ne.push({key:"Length",value:zt.data.length}),it===!0&&ne.push({key:"Length1",value:bt})),fe.length!=0)if(fe.split("/").length-1==1)ne.push({key:"Filter",value:fe});else{ne.push({key:"Filter",value:"["+fe+"]"});for(var Te=0;Te<ne.length;Te+=1)if(ne[Te].key==="DecodeParms"){for(var ei=[],Si=0;Si<zt.reverseChain.split("/").length-1;Si+=1)ei.push("null");ei.push(ne[Te].value),ne[Te].value="["+ei.join(" ")+"]"}}j("<<");for(var Ve=0;Ve<ne.length;Ve++)j("/"+ne[Ve].key+" "+ne[Ve].value);j(">>"),zt.data.length!==0&&(j("stream"),j(Ft(zt.data)),j("endstream"))},Co=f.__private__.putPage=function(g){var S=g.number,R=g.data,Y=g.objId,it=g.contentsObjId;Ri(Y,!0),j("<</Type /Page"),j("/Parent "+g.rootDictionaryObjId+" 0 R"),j("/Resources "+g.resourceDictionaryObjId+" 0 R"),j("/MediaBox ["+parseFloat(W(g.mediaBox.bottomLeftX))+" "+parseFloat(W(g.mediaBox.bottomLeftY))+" "+W(g.mediaBox.topRightX)+" "+W(g.mediaBox.topRightY)+"]"),g.cropBox!==null&&j("/CropBox ["+W(g.cropBox.bottomLeftX)+" "+W(g.cropBox.bottomLeftY)+" "+W(g.cropBox.topRightX)+" "+W(g.cropBox.topRightY)+"]"),g.bleedBox!==null&&j("/BleedBox ["+W(g.bleedBox.bottomLeftX)+" "+W(g.bleedBox.bottomLeftY)+" "+W(g.bleedBox.topRightX)+" "+W(g.bleedBox.topRightY)+"]"),g.trimBox!==null&&j("/TrimBox ["+W(g.trimBox.bottomLeftX)+" "+W(g.trimBox.bottomLeftY)+" "+W(g.trimBox.topRightX)+" "+W(g.trimBox.topRightY)+"]"),g.artBox!==null&&j("/ArtBox ["+W(g.artBox.bottomLeftX)+" "+W(g.artBox.bottomLeftY)+" "+W(g.artBox.topRightX)+" "+W(g.artBox.topRightY)+"]"),typeof g.userUnit=="number"&&g.userUnit!==1&&j("/UserUnit "+g.userUnit),Me.publish("putPage",{objId:Y,pageContext:Jt[S],pageNumber:S,page:R}),j("/Contents "+it+" 0 R"),j(">>"),j("endobj");var bt=R.join(`
`);return O===I&&(bt+=`
Q`),Ri(it,!0),Jr({data:bt,filters:fn(),objectId:it}),j("endobj"),Y},In=f.__private__.putPages=function(){var g,S,R=[];for(g=1;g<=be;g++)Jt[g].objId=ji(),Jt[g].contentsObjId=ji();for(g=1;g<=be;g++)R.push(Co({number:g,data:Lt[g],objId:Jt[g].objId,contentsObjId:Jt[g].contentsObjId,mediaBox:Jt[g].mediaBox,cropBox:Jt[g].cropBox,bleedBox:Jt[g].bleedBox,trimBox:Jt[g].trimBox,artBox:Jt[g].artBox,userUnit:Jt[g].userUnit,rootDictionaryObjId:Hs,resourceDictionaryObjId:un}));Ri(Hs,!0),j("<</Type /Pages");var Y="/Kids [";for(S=0;S<be;S++)Y+=R[S]+" 0 R ";j(Y+"]"),j("/Count "+be),j(">>"),j("endobj"),Me.publish("postPutPages")},ko=function(g){Me.publish("putFont",{font:g,out:j,newObject:ni,putStream:Jr}),g.isAlreadyPutted!==!0&&(g.objectNumber=ni(),j("<<"),j("/Type /Font"),j("/BaseFont /"+Ia(g.postScriptName)),j("/Subtype /Type1"),typeof g.encoding=="string"&&j("/Encoding /"+g.encoding),j("/FirstChar 32"),j("/LastChar 255"),j(">>"),j("endobj"))},fa=function(g){g.objectNumber=ni();var S=[];S.push({key:"Type",value:"/XObject"}),S.push({key:"Subtype",value:"/Form"}),S.push({key:"BBox",value:"["+[W(g.x),W(g.y),W(g.x+g.width),W(g.y+g.height)].join(" ")+"]"}),S.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var R=g.pages[1].join(`
`);Jr({data:R,additionalKeyValues:S,objectId:g.objectNumber}),j("endobj")},pa=function(g,S){S||(S=21);var R=ni(),Y=(function(_t,Ft){var zt,ne=[],fe=1/(Ft-1);for(zt=0;zt<1;zt+=fe)ne.push(zt);if(ne.push(1),_t[0].offset!=0){var Te={offset:0,color:_t[0].color};_t.unshift(Te)}if(_t[_t.length-1].offset!=1){var ei={offset:1,color:_t[_t.length-1].color};_t.push(ei)}for(var Si="",Ve=0,Pi=0;Pi<ne.length;Pi++){for(zt=ne[Pi];zt>_t[Ve+1].offset;)Ve++;var Ci=_t[Ve].offset,qi=(zt-Ci)/(_t[Ve+1].offset-Ci),bs=_t[Ve].color,gn=_t[Ve+1].color;Si+=X(Math.round((1-qi)*bs[0]+qi*gn[0]).toString(16))+X(Math.round((1-qi)*bs[1]+qi*gn[1]).toString(16))+X(Math.round((1-qi)*bs[2]+qi*gn[2]).toString(16))}return Si.trim()})(g.colors,S),it=[];it.push({key:"FunctionType",value:"0"}),it.push({key:"Domain",value:"[0.0 1.0]"}),it.push({key:"Size",value:"["+S+"]"}),it.push({key:"BitsPerSample",value:"8"}),it.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),it.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Jr({data:Y,additionalKeyValues:it,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:R}),j("endobj"),g.objectNumber=ni(),j("<< /ShadingType "+g.type),j("/ColorSpace /DeviceRGB");var bt="/Coords ["+W(parseFloat(g.coords[0]))+" "+W(parseFloat(g.coords[1]))+" ";g.type===2?bt+=W(parseFloat(g.coords[2]))+" "+W(parseFloat(g.coords[3])):bt+=W(parseFloat(g.coords[2]))+" "+W(parseFloat(g.coords[3]))+" "+W(parseFloat(g.coords[4]))+" "+W(parseFloat(g.coords[5])),j(bt+="]"),g.matrix&&j("/Matrix ["+g.matrix.toString()+"]"),j("/Function "+R+" 0 R"),j("/Extend [true true]"),j(">>"),j("endobj")},ga=function(g,S){var R=ji(),Y=ni();S.push({resourcesOid:R,objectOid:Y}),g.objectNumber=Y;var it=[];it.push({key:"Type",value:"/Pattern"}),it.push({key:"PatternType",value:"1"}),it.push({key:"PaintType",value:"1"}),it.push({key:"TilingType",value:"1"}),it.push({key:"BBox",value:"["+g.boundingBox.map(W).join(" ")+"]"}),it.push({key:"XStep",value:W(g.xStep)}),it.push({key:"YStep",value:W(g.yStep)}),it.push({key:"Resources",value:R+" 0 R"}),g.matrix&&it.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),Jr({data:g.stream,additionalKeyValues:it,objectId:g.objectNumber}),j("endobj")},md=function(g){for(var S in g.objectNumber=ni(),j("<<"),g)switch(S){case"opacity":j("/ca "+L(g[S]));break;case"stroke-opacity":j("/CA "+L(g[S]))}j(">>"),j("endobj")},vl=function(g){Ri(g.resourcesOid,!0),j("<<"),j("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var S in j("/Font <<"),ve)ve.hasOwnProperty(S)&&(p===!1||p===!0&&m.hasOwnProperty(S))&&j("/"+S+" "+ve[S].objectNumber+" 0 R");j(">>")})(),(function(){if(Object.keys(Xt).length>0){for(var S in j("/Shading <<"),Xt)Xt.hasOwnProperty(S)&&Xt[S]instanceof Go&&Xt[S].objectNumber>=0&&j("/"+S+" "+Xt[S].objectNumber+" 0 R");Me.publish("putShadingPatternDict"),j(">>")}})(),(function(S){if(Object.keys(Xt).length>0){for(var R in j("/Pattern <<"),Xt)Xt.hasOwnProperty(R)&&Xt[R]instanceof f.TilingPattern&&Xt[R].objectNumber>=0&&Xt[R].objectNumber<S&&j("/"+R+" "+Xt[R].objectNumber+" 0 R");Me.publish("putTilingPatternDict"),j(">>")}})(g.objectOid),(function(){if(Object.keys(te).length>0){var S;for(S in j("/ExtGState <<"),te)te.hasOwnProperty(S)&&te[S].objectNumber>=0&&j("/"+S+" "+te[S].objectNumber+" 0 R");Me.publish("putGStateDict"),j(">>")}})(),(function(){for(var S in j("/XObject <<"),Xi)Xi.hasOwnProperty(S)&&Xi[S].objectNumber>=0&&j("/"+S+" "+Xi[S].objectNumber+" 0 R");Me.publish("putXobjectDict"),j(">>")})(),j(">>"),j("endobj")},Yc=function(g){we[g.fontName]=we[g.fontName]||{},we[g.fontName][g.fontStyle]=g.id},Gc=function(g,S,R,Y,it){var bt={id:"F"+(Object.keys(ve).length+1).toString(10),postScriptName:g,fontName:S,fontStyle:R,encoding:Y,isStandardFont:it||!1,metadata:{}};return Me.publish("addFont",{font:bt,instance:this}),ve[bt.id]=bt,Yc(bt),bt.id},Qr=f.__private__.pdfEscape=f.pdfEscape=function(g,S){return(function(R,Y){var it,bt,_t,Ft,zt,ne,fe,Te,ei;if(_t=(Y=Y||{}).sourceEncoding||"Unicode",zt=Y.outputEncoding,(Y.autoencode||zt)&&ve[qt].metadata&&ve[qt].metadata[_t]&&ve[qt].metadata[_t].encoding&&(Ft=ve[qt].metadata[_t].encoding,!zt&&ve[qt].encoding&&(zt=ve[qt].encoding),!zt&&Ft.codePages&&(zt=Ft.codePages[0]),typeof zt=="string"&&(zt=Ft[zt]),zt)){for(fe=!1,ne=[],it=0,bt=R.length;it<bt;it++)(Te=zt[R.charCodeAt(it)])?ne.push(String.fromCharCode(Te)):ne.push(R[it]),ne[it].charCodeAt(0)>>8&&(fe=!0);R=ne.join("")}for(it=R.length;fe===void 0&&it!==0;)R.charCodeAt(it-1)>>8&&(fe=!0),it--;if(!fe)return R;for(ne=Y.noBOM?[]:[254,255],it=0,bt=R.length;it<bt;it++){if((ei=(Te=R.charCodeAt(it))>>8)>>8)throw new Error("Character at position "+it+" of string '"+R+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ne.push(ei),ne.push(Te-(ei<<8))}return String.fromCharCode.apply(void 0,ne)})(g,S).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wl=f.__private__.beginPage=function(g){Lt[++be]=[],Jt[be]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},$c(be),Vt(Lt[q])},Xc=function(g,S){var R,Y,it;switch(e=S||e,typeof g=="string"&&(R=x(g.toLowerCase()),Array.isArray(R)&&(Y=R[0],it=R[1])),Array.isArray(g)&&(Y=g[0]*de,it=g[1]*de),isNaN(Y)&&(Y=n[0],it=n[1]),(Y>14400||it>14400)&&(He.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Y=Math.min(14400,Y),it=Math.min(14400,it)),n=[Y,it],e.substr(0,1)){case"l":it>Y&&(n=[it,Y]);break;case"p":Y>it&&(n=[it,Y])}wl(n),se(xl),j(ba),Sl!==0&&j(Sl+" J"),Cl!==0&&j(Cl+" j"),Me.publish("addPage",{pageNumber:be})},bl=function(g){g>0&&g<=be&&(Lt.splice(g,1),Jt.splice(g,1),be--,q>be&&(q=be),this.setPage(q))},$c=function(g){g>0&&g<=be&&(q=g)},Kc=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Lt.length-1},Zc=function(g,S,R){var Y,it=void 0;return R=R||{},g=g!==void 0?g:ve[qt].fontName,S=S!==void 0?S:ve[qt].fontStyle,Y=g.toLowerCase(),we[Y]!==void 0&&we[Y][S]!==void 0?it=we[Y][S]:we[g]!==void 0&&we[g][S]!==void 0?it=we[g][S]:R.disableWarning===!1&&He.warn("Unable to look up font label for font '"+g+"', '"+S+"'. Refer to getFontList() for available fonts."),it||R.noFallback||(it=we.times[S])==null&&(it=we.times.normal),it},jn=f.__private__.putInfo=function(){var g=ni(),S=function(Y){return Y};for(var R in h!==null&&(S=Oi.encryptor(g,0)),j("<<"),j("/Producer ("+Qr(S("jsPDF "+Ut.version))+")"),xe)xe.hasOwnProperty(R)&&xe[R]&&j("/"+R.substr(0,1).toUpperCase()+R.substr(1)+" ("+Qr(S(xe[R]))+")");j("/CreationDate ("+Qr(S(st))+")"),j(">>"),j("endobj")},ma=f.__private__.putCatalog=function(g){var S=(g=g||{}).rootDictionaryObjId||Hs;switch(ni(),j("<<"),j("/Type /Catalog"),j("/Pages "+S+" 0 R"),Zt||(Zt="fullwidth"),Zt){case"fullwidth":j("/OpenAction [3 0 R /FitH null]");break;case"fullheight":j("/OpenAction [3 0 R /FitV null]");break;case"fullpage":j("/OpenAction [3 0 R /Fit]");break;case"original":j("/OpenAction [3 0 R /XYZ null null 1]");break;default:var R=""+Zt;R.substr(R.length-1)==="%"&&(Zt=parseInt(Zt)/100),typeof Zt=="number"&&j("/OpenAction [3 0 R /XYZ null null "+L(Zt)+"]")}switch(ye||(ye="continuous"),ye){case"continuous":j("/PageLayout /OneColumn");break;case"single":j("/PageLayout /SinglePage");break;case"two":case"twoleft":j("/PageLayout /TwoColumnLeft");break;case"tworight":j("/PageLayout /TwoColumnRight")}Yt&&j("/PageMode /"+Yt),Me.publish("putCatalog"),j(">>"),j("endobj")},vd=f.__private__.putTrailer=function(){j("trailer"),j("<<"),j("/Size "+(Q+1)),j("/Root "+Q+" 0 R"),j("/Info "+(Q-1)+" 0 R"),h!==null&&j("/Encrypt "+Oi.oid+" 0 R"),j("/ID [ <"+lt+"> <"+lt+"> ]"),j(">>")},_i=f.__private__.putHeader=function(){j("%PDF-"+b),j("%")},Jc=f.__private__.putXRef=function(){var g="0000000000";j("xref"),j("0 "+(Q+1)),j("0000000000 65535 f ");for(var S=1;S<=Q;S++)typeof ot[S]=="function"?j((g+ot[S]()).slice(-10)+" 00000 n "):ot[S]!==void 0?j((g+ot[S]).slice(-10)+" 00000 n "):j("0000000000 00000 n ")},Fn=f.__private__.buildDocument=function(){var g;Q=0,pt=0,ft=[],ot=[],vt=[],Hs=ji(),un=ji(),Vt(ft),Me.publish("buildDocument"),_i(),In(),(function(){Me.publish("putAdditionalObjects");for(var R=0;R<vt.length;R++){var Y=vt[R];Ri(Y.objId,!0),j(Y.content),j("endobj")}Me.publish("postPutAdditionalObjects")})(),g=[],(function(){for(var R in ve)ve.hasOwnProperty(R)&&(p===!1||p===!0&&m.hasOwnProperty(R))&&ko(ve[R])})(),(function(){var R;for(R in te)te.hasOwnProperty(R)&&md(te[R])})(),(function(){for(var R in Xi)Xi.hasOwnProperty(R)&&fa(Xi[R])})(),(function(R){var Y;for(Y in Xt)Xt.hasOwnProperty(Y)&&(Xt[Y]instanceof Go?pa(Xt[Y]):Xt[Y]instanceof qa&&ga(Xt[Y],R))})(g),Me.publish("putResources"),g.forEach(vl),vl({resourcesOid:un,objectOid:Number.MAX_SAFE_INTEGER}),Me.publish("postPutResources"),h!==null&&(Oi.oid=ni(),j("<<"),j("/Filter /Standard"),j("/V "+Oi.v),j("/R "+Oi.r),j("/U <"+Oi.toHexString(Oi.U)+">"),j("/O <"+Oi.toHexString(Oi.O)+">"),j("/P "+Oi.P),j(">>"),j("endobj")),jn(),ma();var S=pt;return Jc(),vd(),j("startxref"),j(""+S),j("%%EOF"),Vt(Lt[q]),ft.join(`
`)},va=f.__private__.getBlob=function(g){return new Blob([me(g)],{type:"application/pdf"})},Qc=f.output=f.__private__.output=(Zr=function(g,S){switch(typeof(S=S||{})=="string"?S={filename:S}:S.filename=S.filename||"generated.pdf",g){case void 0:return Fn();case"save":f.save(S.filename);break;case"arraybuffer":return me(Fn());case"blob":return va(Fn());case"bloburi":case"bloburl":if(re.URL!==void 0&&typeof re.URL.createObjectURL=="function")return re.URL&&re.URL.createObjectURL(va(Fn()))||void 0;He.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var R="",Y=Fn();try{R=a1(Y)}catch{R=a1(unescape(encodeURIComponent(Y)))}return"data:application/pdf;filename="+S.filename+";base64,"+R;case"pdfobjectnewwindow":if(Object.prototype.toString.call(re)==="[object Window]"){var it="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';S.pdfObjectUrl&&(it=S.pdfObjectUrl,bt="");var _t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+it+'"'+bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(S)+");<\/script></body></html>",Ft=re.open();return Ft!==null&&Ft.document.write(_t),Ft}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(re)==="[object Window]"){var zt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(S.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+S.filename+'" width="500px" height="400px" /></body></html>',ne=re.open();if(ne!==null){ne.document.write(zt);var fe=this;ne.document.documentElement.querySelector("#pdfViewer").onload=function(){ne.document.title=S.filename,ne.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(fe.output("bloburl"))}}return ne}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(re)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Te='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",S)+'"></iframe></body></html>',ei=re.open();if(ei!==null&&(ei.document.write(Te),ei.document.title=S.filename),ei||typeof safari>"u")return ei;break;case"datauri":case"dataurl":return re.document.location.href=this.output("datauristring",S);default:return null}},Zr.foo=function(){try{return Zr.apply(this,arguments)}catch(R){var g=R.stack||"";~g.indexOf(" at ")&&(g=g.split(" at ")[1]);var S="Error in function "+g.split(`
`)[0].split("<")[0]+": "+R.message;if(!re.console)throw new Error(S);re.console.error(S,R),re.alert&&alert(S)}},Zr.foo.bar=Zr,Zr.foo),tn=function(g){return Array.isArray(_o)===!0&&_o.indexOf(g)>-1};switch(i){case"pt":de=1;break;case"mm":de=72/25.4;break;case"cm":de=72/2.54;break;case"in":de=72;break;case"px":de=tn("px_scaling")==1?.75:96/72;break;case"pc":case"em":de=12;break;case"ex":de=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);de=i}var Oi=null;xt(),et();var ds=f.__private__.getPageInfo=f.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Jt[g].objId,pageNumber:g,pageContext:Jt[g]}},th=f.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var S in Jt)if(Jt[S].objId===g)break;return ds(S)},wd=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Jt[q].objId,pageNumber:q,pageContext:Jt[q]}};f.addPage=function(){return Xc.apply(this,arguments),this},f.setPage=function(){return $c.apply(this,arguments),Vt.call(this,Lt[q]),this},f.insertPage=function(g){return this.addPage(),this.movePage(q,g),this},f.movePage=function(g,S){var R,Y;if(g>S){R=Lt[g],Y=Jt[g];for(var it=g;it>S;it--)Lt[it]=Lt[it-1],Jt[it]=Jt[it-1];Lt[S]=R,Jt[S]=Y,this.setPage(S)}else if(g<S){R=Lt[g],Y=Jt[g];for(var bt=g;bt<S;bt++)Lt[bt]=Lt[bt+1],Jt[bt]=Jt[bt+1];Lt[S]=R,Jt[S]=Y,this.setPage(S)}return this},f.deletePage=function(){return bl.apply(this,arguments),this},f.__private__.text=f.text=function(g,S,R,Y,it){var bt,_t,Ft,zt,ne,fe,Te,ei,Si,Ve=(Y=Y||{}).scope||this;if(typeof g=="number"&&typeof S=="number"&&(typeof R=="string"||Array.isArray(R))){var Pi=R;R=S,S=g,g=Pi}if(arguments[3]instanceof Qt==0?(Ft=arguments[4],zt=arguments[5],Re(Te=arguments[3])==="object"&&Te!==null||(typeof Ft=="string"&&(zt=Ft,Ft=null),typeof Te=="string"&&(zt=Te,Te=null),typeof Te=="number"&&(Ft=Te,Te=null),Y={flags:Te,angle:Ft,align:zt})):(M("The transform parameter of text() with a Matrix value"),Si=it),isNaN(S)||isNaN(R)||g==null)throw new Error("Invalid arguments passed to jsPDF.text");if(g.length===0)return Ve;var Ci,qi="",bs=typeof Y.lineHeightFactor=="number"?Y.lineHeightFactor:Lo,gn=Ve.internal.scaleFactor;function ys(Ie){return Ie=Ie.split("	").join(Array(Y.TabLen||9).join(" ")),Qr(Ie,Te)}function Tl(Ie){for(var qe,di=Ie.concat(),Ni=[],Ss=di.length;Ss--;)typeof(qe=di.shift())=="string"?Ni.push(qe):Array.isArray(Ie)&&(qe.length===1||qe[1]===void 0&&qe[2]===void 0)?Ni.push(qe[0]):Ni.push([qe[0],qe[1],qe[2]]);return Ni}function xa(Ie,qe){var di;if(typeof Ie=="string")di=qe(Ie)[0];else if(Array.isArray(Ie)){for(var Ni,Ss,Bl=Ie.concat(),Ca=[],uh=Bl.length;uh--;)typeof(Ni=Bl.shift())=="string"?Ca.push(qe(Ni)[0]):Array.isArray(Ni)&&typeof Ni[0]=="string"&&(Ss=qe(Ni[0],Ni[1],Ni[2]),Ca.push([Ss[0],Ss[1],Ss[2]]));di=Ca}return di}var Us=!1,Po=!0;if(typeof g=="string")Us=!0;else if(Array.isArray(g)){var No=g.concat();_t=[];for(var Ws,zi=No.length;zi--;)(typeof(Ws=No.shift())!="string"||Array.isArray(Ws)&&typeof Ws[0]!="string")&&(Po=!1);Us=Po}if(Us===!1)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');typeof g=="string"&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var Do=Ct/Ve.internal.scaleFactor,Mo=Do*(bs-1);switch(Y.baseline){case"bottom":R-=Mo;break;case"top":R+=Do-Mo;break;case"hanging":R+=Do-2*Mo;break;case"middle":R+=Do/2-Mo}if((fe=Y.maxWidth||0)>0&&(typeof g=="string"?g=Ve.splitTextToSize(g,fe):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(Ie,qe){return Ie.concat(Ve.splitTextToSize(qe,fe))},[]))),bt={text:g,x:S,y:R,options:Y,mutex:{pdfEscape:Qr,activeFontKey:qt,fonts:ve,activeFontSize:Ct}},Me.publish("preProcessText",bt),g=bt.text,Ft=(Y=bt.options).angle,Si instanceof Qt==0&&Ft&&typeof Ft=="number"){Ft*=Math.PI/180,Y.rotationDirection===0&&(Ft=-Ft),O===I&&(Ft=-Ft);var El=Math.cos(Ft),Ol=Math.sin(Ft);Si=new Qt(El,Ol,-Ol,El,0,0)}else Ft&&Ft instanceof Qt&&(Si=Ft);O!==I||Si||(Si=us),(ne=Y.charSpace||gs)!==void 0&&(qi+=W(H(ne))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ei=Y.horizontalScale)!==void 0&&(qi+=W(100*ei)+` Tz
`),Y.lang;var or=-1,xs=Y.renderingMode!==void 0?Y.renderingMode:Y.stroke,_a=Ve.internal.getCurrentPageInfo().pageContext;switch(xs){case 0:case!1:case"fill":or=0;break;case 1:case!0:case"stroke":or=1;break;case 2:case"fillThenStroke":or=2;break;case 3:case"invisible":or=3;break;case 4:case"fillAndAddForClipping":or=4;break;case 5:case"strokeAndAddPathForClipping":or=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":or=6;break;case 7:case"addToPathForClipping":or=7}var ch=_a.usedRenderingMode!==void 0?_a.usedRenderingMode:-1;or!==-1?qi+=or+` Tr
`:ch!==-1&&(qi+=`0 Tr
`),or!==-1&&(_a.usedRenderingMode=or),zt=Y.align||"left";var en,Io=Ct*bs,Pl=Ve.internal.pageSize.getWidth(),Nl=ve[qt];ne=Y.charSpace||gs,fe=Y.maxWidth||0,Te=Object.assign({autoencode:!0,noBOM:!0},Y.flags);var Vs=[],jo=function(Ie){return Ve.getStringUnitWidth(Ie,{font:Nl,charSpace:ne,fontSize:Ct,doKerning:!1})*Ct/gn};if(Object.prototype.toString.call(g)==="[object Array]"){var Pr;_t=Tl(g),zt!=="left"&&(en=_t.map(jo));var Nr,Ys=0;if(zt==="right"){S-=en[0],g=[],zi=_t.length;for(var _s=0;_s<zi;_s++)_s===0?(Nr=fs(S),Pr=ps(R)):(Nr=H(Ys-en[_s]),Pr=-Io),g.push([_t[_s],Nr,Pr]),Ys=en[_s]}else if(zt==="center"){S-=en[0]/2,g=[],zi=_t.length;for(var Gs=0;Gs<zi;Gs++)Gs===0?(Nr=fs(S),Pr=ps(R)):(Nr=H((Ys-en[Gs])/2),Pr=-Io),g.push([_t[Gs],Nr,Pr]),Ys=en[Gs]}else if(zt==="left"){g=[],zi=_t.length;for(var Dl=0;Dl<zi;Dl++)g.push(_t[Dl])}else if(zt==="justify"&&Nl.encoding==="Identity-H"){g=[],zi=_t.length,fe=fe!==0?fe:Pl;for(var Sa=0,ui=0;ui<zi;ui++)if(Pr=ui===0?ps(R):-Io,Nr=ui===0?fs(S):Sa,ui<zi-1){var hh=H((fe-en[ui])/(_t[ui].split(" ").length-1)),Rn=_t[ui].split(" ");g.push([Rn[0]+" ",Nr,Pr]),Sa=0;for(var qn=1;qn<Rn.length;qn++){var Ml=(jo(Rn[qn-1]+" "+Rn[qn])-jo(Rn[qn]))*gn+hh;qn==Rn.length-1?g.push([Rn[qn],Ml,0]):g.push([Rn[qn]+" ",Ml,0]),Sa-=Ml}}else g.push([_t[ui],Nr,Pr]);g.push(["",Sa,0])}else{if(zt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],zi=_t.length,fe=fe!==0?fe:Pl,ui=0;ui<zi;ui++){Pr=ui===0?ps(R):-Io,Nr=ui===0?fs(S):0;var Il=_t[ui].split(" ").length-1,jl=Il>0?(fe-en[ui])/Il:0;ui<zi-1?Vs.push(W(H(jl))):Vs.push(0),g.push([_t[ui],Nr,Pr])}}}(typeof Y.R2L=="boolean"?Y.R2L:$t)===!0&&(g=xa(g,function(Ie,qe,di){return[Ie.split("").reverse().join(""),qe,di]})),bt={text:g,x:S,y:R,options:Y,mutex:{pdfEscape:Qr,activeFontKey:qt,fonts:ve,activeFontSize:Ct}},Me.publish("postProcessText",bt),g=bt.text,Ci=bt.mutex.isHex||!1;var Fl=ve[qt].encoding;Fl!=="WinAnsiEncoding"&&Fl!=="StandardEncoding"||(g=xa(g,function(Ie,qe,di){return[ys(Ie),qe,di]})),_t=Tl(g),g=[];for(var Xs,$s,Ks,Fo=Array.isArray(_t[0])?1:0,Zs="",Bo=function(Ie,qe,di){var Ni="";return di instanceof Qt?(di=typeof Y.angle=="number"?hs(di,new Qt(1,0,0,1,Ie,qe)):hs(new Qt(1,0,0,1,Ie,qe),di),O===I&&(di=hs(new Qt(1,0,0,-1,0,0),di)),Ni=di.join(" ")+` Tm
`):Ni=W(Ie)+" "+W(qe)+` Td
`,Ni},rn=0;rn<_t.length;rn++){switch(Zs="",Fo){case 1:Ks=(Ci?"<":"(")+_t[rn][0]+(Ci?">":")"),Xs=parseFloat(_t[rn][1]),$s=parseFloat(_t[rn][2]);break;case 0:Ks=(Ci?"<":"(")+_t[rn]+(Ci?">":")"),Xs=fs(S),$s=ps(R)}Vs!==void 0&&Vs[rn]!==void 0&&(Zs=Vs[rn]+` Tw
`),rn===0?g.push(Zs+Bo(Xs,$s,Si)+Ks):Fo===0?g.push(Zs+Ks):Fo===1&&g.push(Zs+Bo(Xs,$s,Si)+Ks)}g=Fo===0?g.join(` Tj
T* `):g.join(` Tj
`),g+=` Tj
`;var zn=`BT
/`;return zn+=qt+" "+Ct+` Tf
`,zn+=W(Ct*bs)+` TL
`,zn+=To+`
`,zn+=qi,zn+=g,j(zn+="ET"),m[qt]=!0,Ve};var bd=f.__private__.clip=f.clip=function(g){return j(g==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return bd("evenodd")},f.__private__.discardPath=f.discardPath=function(){return j("n"),this};var Bn=f.__private__.isValidStyle=function(g){var S=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)!==-1&&(S=!0),S};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(g){return Bn(g)&&(c=g),this};var eh=f.__private__.getStyle=f.getStyle=function(g){var S=c;switch(g){case"D":case"S":S="S";break;case"F":S="f";break;case"FD":case"DF":S="B";break;case"f":case"f*":case"B":case"B*":S=g}return S},ih=f.close=function(){return j("h"),this};f.stroke=function(){return j("S"),this},f.fill=function(g){return wa("f",g),this},f.fillEvenOdd=function(g){return wa("f*",g),this},f.fillStroke=function(g){return wa("B",g),this},f.fillStrokeEvenOdd=function(g){return wa("B*",g),this};var wa=function(g,S){Re(S)==="object"?xd(S,g):j(g)},Ao=function(g){g===null||O===I&&g===void 0||(g=eh(g),j(g))};function yd(g,S,R,Y,it){var bt=new qa(S||this.boundingBox,R||this.xStep,Y||this.yStep,this.gState,it||this.matrix);bt.stream=this.stream;var _t=g+"$$"+this.cloneIndex+++"$$";return Kr(_t,bt),bt}var xd=function(g,S){var R=We[g.key],Y=Xt[R];if(Y instanceof Go)j("q"),j(_d(S)),Y.gState&&f.setGState(Y.gState),j(g.matrix.toString()+" cm"),j("/"+R+" sh"),j("Q");else if(Y instanceof qa){var it=new Qt(1,0,0,-1,0,Oo());g.matrix&&(it=it.multiply(g.matrix||us),R=yd.call(Y,g.key,g.boundingBox,g.xStep,g.yStep,it).id),j("q"),j("/Pattern cs"),j("/"+R+" scn"),Y.gState&&f.setGState(Y.gState),j(S),j("Q")}},_d=function(g){switch(g){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},yl=f.moveTo=function(g,S){return j(W(H(g))+" "+W(z(S))+" m"),this},rh=f.lineTo=function(g,S){return j(W(H(g))+" "+W(z(S))+" l"),this},pn=f.curveTo=function(g,S,R,Y,it,bt){return j([W(H(g)),W(z(S)),W(H(R)),W(z(Y)),W(H(it)),W(z(bt)),"c"].join(" ")),this};f.__private__.line=f.line=function(g,S,R,Y,it){if(isNaN(g)||isNaN(S)||isNaN(R)||isNaN(Y)||!Bn(it))throw new Error("Invalid arguments passed to jsPDF.line");return O===E?this.lines([[R-g,Y-S]],g,S,[1,1],it||"S"):this.lines([[R-g,Y-S]],g,S,[1,1]).stroke()},f.__private__.lines=f.lines=function(g,S,R,Y,it,bt){var _t,Ft,zt,ne,fe,Te,ei,Si,Ve,Pi,Ci,qi;if(typeof g=="number"&&(qi=R,R=S,S=g,g=qi),Y=Y||[1,1],bt=bt||!1,isNaN(S)||isNaN(R)||!Array.isArray(g)||!Array.isArray(Y)||!Bn(it)||typeof bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(yl(S,R),_t=Y[0],Ft=Y[1],ne=g.length,Pi=S,Ci=R,zt=0;zt<ne;zt++)(fe=g[zt]).length===2?(Pi=fe[0]*_t+Pi,Ci=fe[1]*Ft+Ci,rh(Pi,Ci)):(Te=fe[0]*_t+Pi,ei=fe[1]*Ft+Ci,Si=fe[2]*_t+Pi,Ve=fe[3]*Ft+Ci,Pi=fe[4]*_t+Pi,Ci=fe[5]*Ft+Ci,pn(Te,ei,Si,Ve,Pi,Ci));return bt&&ih(),Ao(it),this},f.path=function(g){for(var S=0;S<g.length;S++){var R=g[S],Y=R.c;switch(R.op){case"m":yl(Y[0],Y[1]);break;case"l":rh(Y[0],Y[1]);break;case"c":pn.apply(this,Y);break;case"h":ih()}}return this},f.__private__.rect=f.rect=function(g,S,R,Y,it){if(isNaN(g)||isNaN(S)||isNaN(R)||isNaN(Y)||!Bn(it))throw new Error("Invalid arguments passed to jsPDF.rect");return O===E&&(Y=-Y),j([W(H(g)),W(z(S)),W(H(R)),W(H(Y)),"re"].join(" ")),Ao(it),this},f.__private__.triangle=f.triangle=function(g,S,R,Y,it,bt,_t){if(isNaN(g)||isNaN(S)||isNaN(R)||isNaN(Y)||isNaN(it)||isNaN(bt)||!Bn(_t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[R-g,Y-S],[it-R,bt-Y],[g-it,S-bt]],g,S,[1,1],_t,!0),this},f.__private__.roundedRect=f.roundedRect=function(g,S,R,Y,it,bt,_t){if(isNaN(g)||isNaN(S)||isNaN(R)||isNaN(Y)||isNaN(it)||isNaN(bt)||!Bn(_t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ft=4/3*(Math.SQRT2-1);return it=Math.min(it,.5*R),bt=Math.min(bt,.5*Y),this.lines([[R-2*it,0],[it*Ft,0,it,bt-bt*Ft,it,bt],[0,Y-2*bt],[0,bt*Ft,-it*Ft,bt,-it,bt],[2*it-R,0],[-it*Ft,0,-it,-bt*Ft,-it,-bt],[0,2*bt-Y],[0,-bt*Ft,it*Ft,-bt,it,-bt]],g+it,S,[1,1],_t,!0),this},f.__private__.ellipse=f.ellipse=function(g,S,R,Y,it){if(isNaN(g)||isNaN(S)||isNaN(R)||isNaN(Y)||!Bn(it))throw new Error("Invalid arguments passed to jsPDF.ellipse");var bt=4/3*(Math.SQRT2-1)*R,_t=4/3*(Math.SQRT2-1)*Y;return yl(g+R,S),pn(g+R,S-_t,g+bt,S-Y,g,S-Y),pn(g-bt,S-Y,g-R,S-_t,g-R,S),pn(g-R,S+_t,g-bt,S+Y,g,S+Y),pn(g+bt,S+Y,g+R,S+_t,g+R,S),Ao(it),this},f.__private__.circle=f.circle=function(g,S,R,Y){if(isNaN(g)||isNaN(S)||isNaN(R)||!Bn(Y))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,S,R,R,Y)},f.setFont=function(g,S,R){return R&&(S=nt(S,R)),qt=Zc(g,S,{disableWarning:!1}),this};var Sd=f.__private__.getFont=f.getFont=function(){return ve[Zc.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var g,S,R={};for(g in we)if(we.hasOwnProperty(g))for(S in R[g]=[],we[g])we[g].hasOwnProperty(S)&&R[g].push(S);return R},f.addFont=function(g,S,R,Y,it){var bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&bt.indexOf(arguments[3])!==-1?it=arguments[3]:arguments[3]&&bt.indexOf(arguments[3])==-1&&(R=nt(R,Y)),Gc.call(this,g,S,R,it=it||"Identity-H")};var Lo,xl=r.lineWidth||.200025,Cd=f.__private__.getLineWidth=f.getLineWidth=function(){return xl},se=f.__private__.setLineWidth=f.setLineWidth=function(g){return xl=g,j(W(H(g))+" w"),this};f.__private__.setLineDash=Ut.API.setLineDash=Ut.API.setLineDashPattern=function(g,S){if(g=g||[],S=S||0,isNaN(S)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map(function(R){return W(H(R))}).join(" "),S=W(H(S)),j("["+g+"] "+S+" d"),this};var kd=f.__private__.getLineHeight=f.getLineHeight=function(){return Ct*Lo};f.__private__.getLineHeight=f.getLineHeight=function(){return Ct*Lo};var Ad=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(g){return typeof(g=g||1.15)=="number"&&(Lo=g),this},Ld=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Lo};Ad(r.lineHeight);var fs=f.__private__.getHorizontalCoordinate=function(g){return H(g)},ps=f.__private__.getVerticalCoordinate=function(g){return O===I?g:Jt[q].mediaBox.topRightY-Jt[q].mediaBox.bottomLeftY-H(g)},Td=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(g){return W(fs(g))},Ed=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(g){return W(ps(g))},ba=r.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Mn(ba)},f.__private__.setStrokeColor=f.setDrawColor=function(g,S,R,Y){return ba=dn({ch1:g,ch2:S,ch3:R,ch4:Y,pdfColorType:"draw",precision:2}),j(ba),this};var _l=r.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Mn(_l)},f.__private__.setFillColor=f.setFillColor=function(g,S,R,Y){return _l=dn({ch1:g,ch2:S,ch3:R,ch4:Y,pdfColorType:"fill",precision:2}),j(_l),this};var To=r.textColor||"0 g",Od=f.__private__.getTextColor=f.getTextColor=function(){return Mn(To)};f.__private__.setTextColor=f.setTextColor=function(g,S,R,Y){return To=dn({ch1:g,ch2:S,ch3:R,ch4:Y,pdfColorType:"text",precision:3}),this};var gs=r.charSpace,Pd=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(gs||0)};f.__private__.setCharSpace=f.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return gs=g,this};var Sl=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(g){var S=f.CapJoinStyles[g];if(S===void 0)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sl=S,j(S+" J"),this};var Cl=0;f.__private__.setLineJoin=f.setLineJoin=function(g){var S=f.CapJoinStyles[g];if(S===void 0)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cl=S,j(S+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return j(W(H(g))+" M"),this},f.GState=Hu,f.setGState=function(g){(g=typeof g=="string"?te[ce[g]]:nh(null,g)).equals(Je)||(j("/"+g.id+" gs"),Je=g)};var nh=function(g,S){if(!g||!ce[g]){var R=!1;for(var Y in te)if(te.hasOwnProperty(Y)&&te[Y].equals(S)){R=!0;break}if(R)S=te[Y];else{var it="GS"+(Object.keys(te).length+1).toString(10);te[it]=S,S.id=it}return g&&(ce[g]=S.id),Me.publish("addGState",S),S}};f.addGState=function(g,S){return nh(g,S),this},f.saveGraphicsState=function(){return j("q"),Ze.push({key:qt,size:Ct,color:To}),this},f.restoreGraphicsState=function(){j("Q");var g=Ze.pop();return qt=g.key,Ct=g.size,To=g.color,Je=null,this},f.setCurrentTransformationMatrix=function(g){return j(g.toString()+" cm"),this},f.comment=function(g){return j("#"+g),this};var ms=function(g,S){var R=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return R},set:function(bt){isNaN(bt)||(R=parseFloat(bt))}});var Y=S||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Y},set:function(bt){isNaN(bt)||(Y=parseFloat(bt))}});var it="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return it},set:function(bt){it=bt.toString()}}),this},kl=function(g,S,R,Y){ms.call(this,g,S),this.type="rect";var it=R||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return it},set:function(_t){isNaN(_t)||(it=parseFloat(_t))}});var bt=Y||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return bt},set:function(_t){isNaN(_t)||(bt=parseFloat(_t))}}),this},ya=function(){this.page=be,this.currentPage=q,this.pages=Lt.slice(0),this.pagesContext=Jt.slice(0),this.x=Wt,this.y=hi,this.matrix=Le,this.width=Ll(q),this.height=oh(q),this.outputDestination=Pt,this.id="",this.objectNumber=-1};ya.prototype.restore=function(){be=this.page,q=this.currentPage,Jt=this.pagesContext,Lt=this.pages,Wt=this.x,hi=this.y,Le=this.matrix,sh(q,this.width),vs(q,this.height),Pt=this.outputDestination};var Al=function(g,S,R,Y,it){Dn.push(new ya),be=q=0,Lt=[],Wt=g,hi=S,Le=it,wl([R,Y])};for(var Eo in f.beginFormObject=function(g,S,R,Y,it){return Al(g,S,R,Y,it),this},f.endFormObject=function(g){return(function(S){if(cs[S])Dn.pop().restore();else{var R=new ya,Y="Xo"+(Object.keys(Xi).length+1).toString(10);R.id=Y,cs[S]=Y,Xi[Y]=R,Me.publish("addFormObject",R),Dn.pop().restore()}})(g),this},f.doFormObject=function(g,S){var R=Xi[cs[g]];return j("q"),j(S.toString()+" cm"),j("/"+R.id+" Do"),j("Q"),this},f.getFormObject=function(g){var S=Xi[cs[g]];return{x:S.x,y:S.y,width:S.width,height:S.height,matrix:S.matrix}},f.save=function(g,S){return g=g||"generated.pdf",(S=S||{}).returnPromise=S.returnPromise||!1,S.returnPromise===!1?(Uo(va(Fn()),g),typeof Uo.unload=="function"&&re.setTimeout&&setTimeout(Uo.unload,911),this):new Promise(function(R,Y){try{var it=Uo(va(Fn()),g);typeof Uo.unload=="function"&&re.setTimeout&&setTimeout(Uo.unload,911),R(it)}catch(bt){Y(bt.message)}})},Ut.API)Ut.API.hasOwnProperty(Eo)&&(Eo==="events"&&Ut.API.events.length?(function(g,S){var R,Y,it;for(it=S.length-1;it!==-1;it--)R=S[it][0],Y=S[it][1],g.subscribe.apply(g,[R].concat(typeof Y=="function"?[Y]:Y))})(Me,Ut.API.events):f[Eo]=Ut.API[Eo]);function Ll(g){return Jt[g].mediaBox.topRightX-Jt[g].mediaBox.bottomLeftX}function sh(g,S){Jt[g].mediaBox.topRightX=S+Jt[g].mediaBox.bottomLeftX}function oh(g){return Jt[g].mediaBox.topRightY-Jt[g].mediaBox.bottomLeftY}function vs(g,S){Jt[g].mediaBox.topRightY=S+Jt[g].mediaBox.bottomLeftY}var ws=f.getPageWidth=function(g){return Ll(g=g||q)/de},ah=f.setPageWidth=function(g,S){sh(g,S*de)},Oo=f.getPageHeight=function(g){return oh(g=g||q)/de},lh=f.setPageHeight=function(g,S){vs(g,S*de)};return f.internal={pdfEscape:Qr,getStyle:eh,getFont:Sd,getFontSize:It,getCharSpace:Pd,getTextColor:Od,getLineHeight:kd,getLineHeightFactor:Ld,getLineWidth:Cd,write:Ot,getHorizontalCoordinate:fs,getVerticalCoordinate:ps,getCoordinateString:Td,getVerticalCoordinateString:Ed,collections:{},newObject:ni,newAdditionalObject:So,newObjectDeferred:ji,newObjectDeferredBegin:Ri,getFilters:fn,putStream:Jr,events:Me,scaleFactor:de,pageSize:{getWidth:function(){return ws(q)},setWidth:function(g){ah(q,g)},getHeight:function(){return Oo(q)},setHeight:function(g){lh(q,g)}},encryptionOptions:h,encryption:Oi,getEncryptor:function(g){return h!==null?Oi.encryptor(g,0):function(S){return S}},output:Qc,getNumberOfPages:Kc,get pages(){return Lt},out:j,f2:L,f3:N,getPageInfo:ds,getPageInfoByObjId:th,getCurrentPageInfo:wd,getPDFVersion:y,Point:ms,Rectangle:kl,Matrix:Qt,hasHotfix:tn},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ws(q)},set:function(g){ah(q,g)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Oo(q)},set:function(g){lh(q,g)},enumerable:!0,configurable:!0}),(function(g){for(var S=0,R=Kt.length;S<R;S++){var Y=Gc.call(this,g[S][0],g[S][1],g[S][2],Kt[S][3],!0);p===!1&&(m[Y]=!0);var it=g[S][0].split("-");Yc({id:Y,fontName:it[0],fontStyle:it[1]||""})}Me.publish("addFonts",{fonts:ve,dictionary:we})}).call(f,Kt),qt="F1",Xc(n,e),Me.publish("initialized"),f}Ma.prototype.lsbFirstWord=function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)},Ma.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ma.prototype.hexToBytes=function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(String.fromCharCode(parseInt(r.substr(e,2),16)));return t.join("")},Ma.prototype.processOwnerPassword=function(r,t){return xp(yp(t).substr(0,5),r)},Ma.prototype.encryptor=function(r,t){var e=yp(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(i){return xp(e,i)}},Hu.prototype.equals=function(r){var t,e="id,objectNumber,equals";if(!r||Re(r)!==Re(this))return!1;var i=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;i++}for(t in r)r.hasOwnProperty(t)&&e.indexOf(t)<0&&i--;return i===0},Ut.API={events:[]},Ut.version="3.0.4";var li=Ut.API,yg=1,da=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ea=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ae=function(r){return r.toFixed(2)},ao=function(r){return r.toFixed(5)};li.__acroform__={};var Or=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},u1=function(r){return r*yg},Un=function(r){var t=new W5,e=jt.internal.getHeight(r)||0,i=jt.internal.getWidth(r)||0;return t.BBox=[0,0,Number(ae(i)),Number(ae(e))],t},sk=li.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|1<<t},ok=li.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&~(1<<t)},ak=li.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<t?1:0},vi=li.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return ak(r,t-1)},wi=li.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return sk(r,t-1)},bi=li.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return ok(r,t-1)},lk=li.__acroform__.calculateCoordinates=function(r,t){var e=t.internal.getHorizontalCoordinate,i=t.internal.getVerticalCoordinate,n=r[0],s=r[1],o=r[2],a=r[3],l={};return l.lowerLeft_X=e(n)||0,l.lowerLeft_Y=i(s+a)||0,l.upperRight_X=e(n+o)||0,l.upperRight_Y=i(s)||0,[Number(ae(l.lowerLeft_X)),Number(ae(l.lowerLeft_Y)),Number(ae(l.upperRight_X)),Number(ae(l.upperRight_Y))]},ck=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],e=r._V||r.DV,i=_p(r,e),n=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+n+" "+ae(i.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Un(r);return s.scope=r.scope,s.stream=t.join(`
`),s}},_p=function(r,t){var e=r.fontSize===0?r.maxFontSize:r.fontSize,i={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=r.multiline?n.map(function(L){return L.split(`
`)}):n.map(function(L){return[L]});var s=e,o=jt.internal.getHeight(r)||0;o=o<0?-o:o;var a=jt.internal.getWidth(r)||0;a=a<0?-a:a;var l=function(L,N,H){if(L+1<n.length){var z=N+" "+n[L+1][0];return Vh(z,r,H).width<=a-4}return!1};s++;t:for(;s>0;){t="",s--;var c,h,p=Vh("3",r,s).height,m=r.multiline?o-s:(o-p)/2,f=m+=2,b=0,y=0,_=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Vh(t,r,s=12).width+", FieldWidth:"+a+`
`;break}for(var x="",E=0,I=0;I<n.length;I++)if(n.hasOwnProperty(I)){var O=!1;if(n[I].length!==1&&_!==n[I].length-1){if((p+2)*(E+2)+2>o)continue t;x+=n[I][_],O=!0,y=I,I--}else{x=(x+=n[I][_]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var V=parseInt(I),Z=l(V,x,s),nt=I>=n.length-1;if(Z&&!nt){x+=" ",_=0;continue}if(Z||nt){if(nt)y=V;else if(r.multiline&&(p+2)*(E+2)+2>o)continue t}else{if(!r.multiline||(p+2)*(E+2)+2>o)continue t;y=V}}for(var W="",M=b;M<=y;M++){var J=n[M];if(r.multiline){if(M===y){W+=J[_]+" ",_=(_+1)%J.length;continue}if(M===b){W+=J[J.length-1]+" ";continue}}W+=J[0]+" "}switch(W=W.substr(W.length-1)==" "?W.substr(0,W.length-1):W,h=Vh(W,r,s).width,r.textAlign){case"right":c=a-h-2;break;case"center":c=(a-h)/2;break;default:c=2}t+=ae(c)+" "+ae(f)+` Td
`,t+="("+da(W)+`) Tj
`,t+=-ae(c)+` 0 Td
`,f=-(s+2),h=0,b=O?y:y+1,E++,x=""}break}return i.text=t,i.fontSize=s,i},Vh=function(r,t,e){var i=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(r,{font:i,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:n}},hk={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},uk=function(r,t){var e={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(i){return i.type===e.type&&i.object===e.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(e)},dk=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Pn.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(hk)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");yg=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new V5,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.objId=void 0,s.hasAnnotation&&uk(s,e)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(e){(function(i,n){var s=!i;for(var o in i||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(o)){var a=i[o],l=[],c=a.Rect;if(a.Rect&&(a.Rect=lk(a.Rect,n)),n.internal.newObjectDeferredBegin(a.objId,!0),a.DA=jt.createDefaultAppearanceStream(a),Re(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(l=a.getKeyValueListForStream()),a.Rect=c,a.hasAppearanceStream&&!a.appearanceStreamContent){var h=ck(a);l.push({key:"AP",value:"<</N "+h+">>"}),n.internal.acroformPlugin.xForms.push(h)}if(a.appearanceStreamContent){var p="";for(var m in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(m)){var f=a.appearanceStreamContent[m];if(p+="/"+m+" ",p+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var o in f)if(f.hasOwnProperty(o)){var b=f[o];typeof b=="function"&&(b=b.call(n,a)),p+="/"+o+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=f)=="function"&&(b=b.call(n,a)),p+="/"+o+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);p+=">>"}l.push({key:"AP",value:`<<
`+p+">>"})}n.internal.putStream({additionalKeyValues:l,objectId:a.objId}),n.internal.out("endobj")}s&&(function(y,_){for(var x in y)if(y.hasOwnProperty(x)){var E=x,I=y[x];_.internal.newObjectDeferredBegin(I.objId,!0),Re(I)==="object"&&typeof I.putStream=="function"&&I.putStream(),delete y[E]}})(n.internal.acroformPlugin.xForms,n)})(e,r)}),r.internal.acroformPlugin.isInitialized=!0}},U5=li.__acroform__.arrayToPdfArray=function(r,t,e){var i=function(o){return o};if(Array.isArray(r)){for(var n="[",s=0;s<r.length;s++)switch(s!==0&&(n+=" "),Re(r[s])){case"boolean":case"number":case"object":n+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(t!==void 0&&e&&(i=e.internal.getEncryptor(t)),n+="("+da(i(r[s].toString()))+")"):n+=r[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Pf=function(r,t,e){var i=function(n){return n};return t!==void 0&&e&&(i=e.internal.getEncryptor(t)),(r=r||"").toString(),"("+da(i(r))+")"},Zn=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Zn.prototype.toString=function(){return this.objId+" 0 R"},Zn.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Zn.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var i=t[e],n=this[i];n&&(Array.isArray(n)?r.push({key:i,value:U5(n,this.objId,this.scope)}):n instanceof Zn?(n.scope=this.scope,r.push({key:i,value:n.objId+" 0 R"})):typeof n!="function"&&r.push({key:i,value:n}))}return r};var W5=function(){Zn.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){r=e.trim()},get:function(){return r||null}})};Or(W5,Zn);var V5=function(){Zn.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var e=function(i){return i};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+da(e(r))+")"}},set:function(e){r=e}})};Or(V5,Zn);var Pn=function r(){Zn.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!vi(t,3)},set:function(x){x?this.F=wi(t,3):this.F=bi(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');e=x}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(x){i=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(x){i[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(x){i[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(x){i[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(x){i[3]=x}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Uu)return;s="FieldObject"+r.FieldNum++}var x=function(E){return E};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+da(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/yg:c},set:function(x){c=x}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(x){h=x}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Uu||this instanceof Qo))return Pf(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=x}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Fi==0?Pf(m,this.objId,this.scope):m},set:function(x){x=x.toString(),m=this instanceof Fi==0?x.substr(0,1)==="("?Ea(x.substr(1,x.length-2)):Ea(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fi==1?Ea(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof Fi==1?"/"+x:x}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Fi==0?Pf(f,this.objId,this.scope):f},set:function(x){x=x.toString(),f=this instanceof Fi==0?x.substr(0,1)==="("?Ea(x.substr(1,x.length-2)):Ea(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fi==1?Ea(f.substr(1,f.length-1)):f},set:function(x){x=x.toString(),f=this instanceof Fi==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(x){x=!!x,y=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(x){b=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,1)},set:function(x){x?this.Ff=wi(this.Ff,1):this.Ff=bi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,2)},set:function(x){x?this.Ff=wi(this.Ff,2):this.Ff=bi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,3)},set:function(x){x?this.Ff=wi(this.Ff,3):this.Ff=bi(this.Ff,3)}});var _=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(_!==null)return _},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');_=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(_){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:_=2;break;case"center":case 1:_=1;break;default:_=0}}})};Or(Pn,Zn);var Xa=function(){Pn.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){r=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return U5(t,this.objId,this.scope)},set:function(e){var i,n;n=[],typeof(i=e)=="string"&&(n=(function(s,o,a){a||(a=1);for(var l,c=[];l=o.exec(s);)c.push(l[a]);return c})(i,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,i){for(i=i||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,18)},set:function(e){e?this.Ff=wi(this.Ff,18):this.Ff=bi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=wi(this.Ff,19):this.Ff=bi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,20)},set:function(e){e?(this.Ff=wi(this.Ff,20),t.sort()):this.Ff=bi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,22)},set:function(e){e?this.Ff=wi(this.Ff,22):this.Ff=bi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,23)},set:function(e){e?this.Ff=wi(this.Ff,23):this.Ff=bi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,27)},set:function(e){e?this.Ff=wi(this.Ff,27):this.Ff=bi(this.Ff,27)}}),this.hasAppearanceStream=!1};Or(Xa,Pn);var $a=function(){Xa.call(this),this.fontName="helvetica",this.combo=!1};Or($a,Xa);var Ka=function(){$a.call(this),this.combo=!0};Or(Ka,$a);var su=function(){Ka.call(this),this.edit=!0};Or(su,Ka);var Fi=function(){Pn.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,15)},set:function(e){e?this.Ff=wi(this.Ff,15):this.Ff=bi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,16)},set:function(e){e?this.Ff=wi(this.Ff,16):this.Ff=bi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,17)},set:function(e){e?this.Ff=wi(this.Ff,17):this.Ff=bi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,26)},set:function(e){e?this.Ff=wi(this.Ff,26):this.Ff=bi(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(s){return s};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var i,n=[];for(i in n.push("<<"),t)n.push("/"+i+" ("+da(e(t[i]))+")");return n.push(">>"),n.join(`
`)}},set:function(e){Re(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}})};Or(Fi,Pn);var ou=function(){Fi.call(this),this.pushButton=!0};Or(ou,Fi);var Za=function(){Fi.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};Or(Za,Fi);var Uu=function(){var r,t;Pn.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var e,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),i)o.push("/"+s+" ("+da(n(i[s]))+")");return o.push(">>"),o.join(`
`)},set:function(n){Re(n)==="object"&&(i=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(n){typeof n=="string"&&(i.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=jt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Or(Uu,Pn),Za.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=r.createAppearanceStream(e.optionName),e.caption=r.getCA()}},Za.prototype.createOption=function(r){var t=new Uu;return t.Parent=this,t.optionName=r,this.Kids.push(t),fk.call(this.scope,t),t};var au=function(){Fi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=jt.CheckBox.createAppearanceStream()};Or(au,Fi);var Qo=function(){Pn.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,13)},set:function(t){t?this.Ff=wi(this.Ff,13):this.Ff=bi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,21)},set:function(t){t?this.Ff=wi(this.Ff,21):this.Ff=bi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,23)},set:function(t){t?this.Ff=wi(this.Ff,23):this.Ff=bi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,24)},set:function(t){t?this.Ff=wi(this.Ff,24):this.Ff=bi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,25)},set:function(t){t?this.Ff=wi(this.Ff,25):this.Ff=bi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,26)},set:function(t){t?this.Ff=wi(this.Ff,26):this.Ff=bi(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Or(Qo,Pn);var lu=function(){Qo.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!vi(this.Ff,14)},set:function(r){r?this.Ff=wi(this.Ff,14):this.Ff=bi(this.Ff,14)}}),this.password=!0};Or(lu,Qo);var jt={CheckBox:{createAppearanceStream:function(){return{N:{On:jt.CheckBox.YesNormal},D:{On:jt.CheckBox.YesPushDown,Off:jt.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=Un(r);t.scope=r.scope;var e=[],i=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),s=_p(r,r.caption);return e.push("0.749023 g"),e.push("0 0 "+ae(jt.internal.getWidth(r))+" "+ae(jt.internal.getHeight(r))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+i+" "+ae(s.fontSize)+" Tf "+n),e.push("BT"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(r){var t=Un(r);t.scope=r.scope;var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),n=[],s=jt.internal.getHeight(r),o=jt.internal.getWidth(r),a=_p(r,r.caption);return n.push("1 g"),n.push("0 0 "+ae(o)+" "+ae(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+ae(o-1)+" "+ae(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+e+" "+ae(a.fontSize)+" Tf "+i),n.push(a.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(r){var t=Un(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+ae(jt.internal.getWidth(r))+" "+ae(jt.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:jt.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=jt.RadioButton.Circle.YesNormal,t.D[r]=jt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=Un(r);t.scope=r.scope;var e=[],i=jt.internal.getWidth(r)<=jt.internal.getHeight(r)?jt.internal.getWidth(r)/4:jt.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=jt.internal.Bezier_C,s=Number((i*n).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+ao(jt.internal.getWidth(r)/2)+" "+ao(jt.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),e.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),e.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),e.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=Un(r);t.scope=r.scope;var e=[],i=jt.internal.getWidth(r)<=jt.internal.getHeight(r)?jt.internal.getWidth(r)/4:jt.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*jt.internal.Bezier_C).toFixed(5)),o=Number((i*jt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+ao(jt.internal.getWidth(r)/2)+" "+ao(jt.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+ao(jt.internal.getWidth(r)/2)+" "+ao(jt.internal.getHeight(r)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),e.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),e.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),e.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(r){var t=Un(r);t.scope=r.scope;var e=[],i=jt.internal.getWidth(r)<=jt.internal.getHeight(r)?jt.internal.getWidth(r)/4:jt.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*jt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+ao(jt.internal.getWidth(r)/2)+" "+ao(jt.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:jt.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=jt.RadioButton.Cross.YesNormal,t.D[r]=jt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=Un(r);t.scope=r.scope;var e=[],i=jt.internal.calculateCross(r);return e.push("q"),e.push("1 1 "+ae(jt.internal.getWidth(r)-2)+" "+ae(jt.internal.getHeight(r)-2)+" re"),e.push("W"),e.push("n"),e.push(ae(i.x1.x)+" "+ae(i.x1.y)+" m"),e.push(ae(i.x2.x)+" "+ae(i.x2.y)+" l"),e.push(ae(i.x4.x)+" "+ae(i.x4.y)+" m"),e.push(ae(i.x3.x)+" "+ae(i.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=Un(r);t.scope=r.scope;var e=jt.internal.calculateCross(r),i=[];return i.push("0.749023 g"),i.push("0 0 "+ae(jt.internal.getWidth(r))+" "+ae(jt.internal.getHeight(r))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+ae(jt.internal.getWidth(r)-2)+" "+ae(jt.internal.getHeight(r)-2)+" re"),i.push("W"),i.push("n"),i.push(ae(e.x1.x)+" "+ae(e.x1.y)+" m"),i.push(ae(e.x2.x)+" "+ae(e.x2.y)+" l"),i.push(ae(e.x4.x)+" "+ae(e.x4.y)+" m"),i.push(ae(e.x3.x)+" "+ae(e.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(r){var t=Un(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+ae(jt.internal.getWidth(r))+" "+ae(jt.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,e=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+e}};jt.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=jt.internal.getWidth(r),e=jt.internal.getHeight(r),i=Math.min(t,e);return{x1:{x:(t-i)/2,y:(e-i)/2+i},x2:{x:(t-i)/2+i,y:(e-i)/2},x3:{x:(t-i)/2,y:(e-i)/2},x4:{x:(t-i)/2+i,y:(e-i)/2+i}}}},jt.internal.getWidth=function(r){var t=0;return Re(r)==="object"&&(t=u1(r.Rect[2])),t},jt.internal.getHeight=function(r){var t=0;return Re(r)==="object"&&(t=u1(r.Rect[3])),t};var fk=li.addField=function(r){if(dk(this,r),!(r instanceof Pn))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};li.AcroFormChoiceField=Xa,li.AcroFormListBox=$a,li.AcroFormComboBox=Ka,li.AcroFormEditBox=su,li.AcroFormButton=Fi,li.AcroFormPushButton=ou,li.AcroFormRadioButton=Za,li.AcroFormCheckBox=au,li.AcroFormTextField=Qo,li.AcroFormPasswordField=lu,li.AcroFormAppearance=jt,li.AcroForm={ChoiceField:Xa,ListBox:$a,ComboBox:Ka,EditBox:su,Button:Fi,PushButton:ou,RadioButton:Za,CheckBox:au,TextField:Qo,PasswordField:lu,Appearance:jt},Ut.AcroForm={ChoiceField:Xa,ListBox:$a,ComboBox:Ka,EditBox:su,Button:Fi,PushButton:ou,RadioButton:Za,CheckBox:au,TextField:Qo,PasswordField:lu,Appearance:jt};Ut.AcroForm;function Y5(r){return r.reduce(function(t,e,i){return t[e]=i,t},{})}(function(r){var t="addImage_";r.__addimage__={};var e="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(L,N){var H,z,st,lt,ht,et=e;if((N=N||e)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(Z(L))for(ht in i)for(st=i[ht],H=0;H<st.length;H+=1){for(lt=!0,z=0;z<st[H].length;z+=1)if(st[H][z]!==void 0&&st[H][z]!==L[z]){lt=!1;break}if(lt===!0){et=ht;break}}else for(ht in i)for(st=i[ht],H=0;H<st.length;H+=1){for(lt=!0,z=0;z<st[H].length;z+=1)if(st[H][z]!==void 0&&st[H][z]!==L.charCodeAt(z)){lt=!1;break}if(lt===!0){et=ht;break}}return et===e&&N!==e&&(et=N),et},s=function L(N){for(var H=this.internal.write,z=this.internal.putStream,st=(0,this.internal.getFilters)();st.indexOf("FlateEncode")!==-1;)st.splice(st.indexOf("FlateEncode"),1);N.objectId=this.internal.newObject();var lt=[];if(lt.push({key:"Type",value:"/XObject"}),lt.push({key:"Subtype",value:"/Image"}),lt.push({key:"Width",value:N.width}),lt.push({key:"Height",value:N.height}),N.colorSpace===x.INDEXED?lt.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(N.palette.length/3-1)+" "+("sMask"in N&&N.sMask!==void 0?N.objectId+2:N.objectId+1)+" 0 R]"}):(lt.push({key:"ColorSpace",value:"/"+N.colorSpace}),N.colorSpace===x.DEVICE_CMYK&&lt.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),lt.push({key:"BitsPerComponent",value:N.bitsPerComponent}),"decodeParameters"in N&&N.decodeParameters!==void 0&&lt.push({key:"DecodeParms",value:"<<"+N.decodeParameters+">>"}),"transparency"in N&&Array.isArray(N.transparency)&&N.transparency.length>0){for(var ht="",et=0,dt=N.transparency.length;et<dt;et++)ht+=N.transparency[et]+" "+N.transparency[et]+" ";lt.push({key:"Mask",value:"["+ht+"]"})}N.sMask!==void 0&&lt.push({key:"SMask",value:N.objectId+1+" 0 R"});var kt=N.filter!==void 0?["/"+N.filter]:void 0;if(z({data:N.data,additionalKeyValues:lt,alreadyAppliedFilters:kt,objectId:N.objectId}),H("endobj"),"sMask"in N&&N.sMask!==void 0){var xt,T=(xt=N.sMaskBitsPerComponent)!==null&&xt!==void 0?xt:N.bitsPerComponent,q={width:N.width,height:N.height,colorSpace:"DeviceGray",bitsPerComponent:T,data:N.sMask};"filter"in N&&(q.decodeParameters="/Predictor ".concat(N.predictor," /Colors 1 /BitsPerComponent ").concat(T," /Columns ").concat(N.width),q.filter=N.filter),L.call(this,q)}if(N.colorSpace===x.INDEXED){var U=this.internal.newObject();z({data:W(new Uint8Array(N.palette)),objectId:U}),H("endobj")}},o=function(){var L=this.internal.collections[t+"images"];for(var N in L)s.call(this,L[N])},a=function(){var L,N=this.internal.collections[t+"images"],H=this.internal.write;for(var z in N)H("/I"+(L=N[z]).index,L.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",a))},c=function(){var L=this.internal.collections[t+"images"];return l.call(this),L},h=function(){return Object.keys(this.internal.collections[t+"images"]).length},p=function(L){return typeof r["process"+L.toUpperCase()]=="function"},m=function(L){return Re(L)==="object"&&L.nodeType===1},f=function(L,N){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var H=""+L.getAttribute("src");if(H.indexOf("data:image/")===0)return nu(unescape(H).split("base64,").pop());var z=r.loadFile(H,!0);if(z!==void 0)return z}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var st;switch(N){case"PNG":st="image/png";break;case"WEBP":st="image/webp";break;default:st="image/jpeg"}return nu(L.toDataURL(st,1).split("base64,").pop())}},b=function(L){var N=this.internal.collections[t+"images"];if(N){for(var H in N)if(L===N[H].alias)return N[H]}},y=function(L,N,H){return L||N||(L=-96,N=-96),L<0&&(L=-1*H.width*72/L/this.internal.scaleFactor),N<0&&(N=-1*H.height*72/N/this.internal.scaleFactor),L===0&&(L=N*H.width/H.height),N===0&&(N=L*H.height/H.width),[L,N]},_=function(L,N,H,z,st,lt){var ht=y.call(this,H,z,st),et=this.internal.getCoordinateString,dt=this.internal.getVerticalCoordinateString,kt=c.call(this);if(H=ht[0],z=ht[1],kt[st.index]=st,lt){lt*=Math.PI/180;var xt=Math.cos(lt),T=Math.sin(lt),q=function(X){return X.toFixed(4)},U=[q(xt),q(T),q(-1*T),q(xt),0,0,"cm"]}this.internal.write("q"),lt?(this.internal.write([1,"0","0",1,et(L),dt(N+z),"cm"].join(" ")),this.internal.write(U.join(" ")),this.internal.write([et(H),"0","0",et(z),"0","0","cm"].join(" "))):this.internal.write([et(H),"0","0",et(z),et(L),dt(N+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+st.index+" Do"),this.internal.write("Q")},x=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},I=r.__addimage__.sHashCode=function(L){var N,H,z=0;if(typeof L=="string")for(H=L.length,N=0;N<H;N++)z=(z<<5)-z+L.charCodeAt(N),z|=0;else if(Z(L))for(H=L.byteLength/2,N=0;N<H;N++)z=(z<<5)-z+L[N],z|=0;return z},O=r.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var N=!0;return L.length===0&&(N=!1),L.length%4!=0&&(N=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(N=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(N=!1),N},V=r.__addimage__.extractImageFromDataUrl=function(L){if(L==null||!(L=L.trim()).startsWith("data:"))return null;var N=L.indexOf(",");return N<0?null:L.substring(0,N).trim().endsWith("base64")?L.substring(N+1):null};r.__addimage__.isArrayBuffer=function(L){return L instanceof ArrayBuffer};var Z=r.__addimage__.isArrayBufferView=function(L){return L instanceof Int8Array||L instanceof Uint8Array||L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array},nt=r.__addimage__.binaryStringToUint8Array=function(L){for(var N=L.length,H=new Uint8Array(N),z=0;z<N;z++)H[z]=L.charCodeAt(z);return H},W=r.__addimage__.arrayBufferToBinaryString=function(L){for(var N="",H=Z(L)?L:new Uint8Array(L),z=0;z<H.length;z+=8192)N+=String.fromCharCode.apply(null,H.subarray(z,z+8192));return N};r.addImage=function(){var L,N,H,z,st,lt,ht,et,dt;if(typeof arguments[1]=="number"?(N=e,H=arguments[1],z=arguments[2],st=arguments[3],lt=arguments[4],ht=arguments[5],et=arguments[6],dt=arguments[7]):(N=arguments[1],H=arguments[2],z=arguments[3],st=arguments[4],lt=arguments[5],ht=arguments[6],et=arguments[7],dt=arguments[8]),Re(L=arguments[0])==="object"&&!m(L)&&"imageData"in L){var kt=L;L=kt.imageData,N=kt.format||N||e,H=kt.x||H||0,z=kt.y||z||0,st=kt.w||kt.width||st,lt=kt.h||kt.height||lt,ht=kt.alias||ht,et=kt.compression||et,dt=kt.rotation||kt.angle||dt}var xt=this.internal.getFilters();if(et===void 0&&xt.indexOf("FlateEncode")!==-1&&(et="SLOW"),isNaN(H)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var T=M.call(this,L,N,ht,et);return _.call(this,H,z,st,lt,T,dt),this};var M=function(L,N,H,z){var st,lt,ht;if(typeof L=="string"&&n(L)===e){L=unescape(L);var et=J(L,!1);(et!==""||(et=r.loadFile(L,!0))!==void 0)&&(L=et)}if(m(L)&&(L=f(L,N)),N=n(L,N),!p(N))throw new Error("addImage does not support files of type '"+N+"', please ensure that a plugin for '"+N+"' support is added.");if(((ht=H)==null||ht.length===0)&&(H=(function(dt){return typeof dt=="string"||Z(dt)?I(dt):Z(dt.data)?I(dt.data):null})(L)),(st=b.call(this,H))||(L instanceof Uint8Array||N==="RGBA"||(lt=L,L=nt(L)),st=this["process"+N.toUpperCase()](L,h.call(this),H,(function(dt){return dt&&typeof dt=="string"&&(dt=dt.toUpperCase()),dt in r.image_compression?dt:E.NONE})(z),lt)),!st)throw new Error("An unknown error occurred whilst processing the image.");return st},J=r.__addimage__.convertBase64ToBinaryString=function(L,N){N=typeof N!="boolean"||N;var H,z="";if(typeof L=="string"){var st;H=(st=V(L))!==null&&st!==void 0?st:L;try{z=nu(H)}catch(lt){if(N)throw O(H)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+lt.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return z};r.getImageProperties=function(L){var N,H,z="";if(m(L)&&(L=f(L)),typeof L=="string"&&n(L)===e&&((z=J(L,!1))===""&&(z=r.loadFile(L)||""),L=z),H=n(L),!p(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(L instanceof Uint8Array||(L=nt(L)),!(N=this["process"+H.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return N.fileType=H,N}})(Ut.API),(function(r){var t=function(e){if(e!==void 0&&e!="")return!0};Ut.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(e){for(var i,n,s,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),c=e.pageContext.annotations,h=!1,p=0;p<c.length&&!h;p++)switch((i=c[p]).type){case"link":(t(i.options.url)||t(i.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<c.length;m++){i=c[m];var f=this.internal.pdfEscape,b=this.internal.getEncryptor(e.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),_=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(y.objId),E=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(i.bounds.x)+" "+a(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y)+"] ")+"/Contents ("+f(x(i.contents))+")",s+=" /Popup "+_.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+f(x(E))+") >>",y.content=s;var I=y.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(i.bounds.x+30)+" "+a(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w+30)+" "+a(i.bounds.y)+"] ")+" /Parent "+I,i.open&&(s+=" /Open true"),s+=" >>",_.content=s,this.internal.write(y.objId,"0 R",_.objId,"0 R");break;case"freetext":n="/Rect ["+o(i.bounds.x)+" "+a(i.bounds.y)+" "+o(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y+i.bounds.h)+"] ";var O=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(b(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var V=this.annotations._nameMap[i.options.name];i.options.pageNumber=V.page,i.options.top=V.y}else i.options.top||(i.options.top=0);if(n="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(b(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var Z=a(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+Z+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(e){var i=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":i.pageContext.annotations.push(e)}},r.link=function(e,i,n,s,o){var a=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:l(e),y:c(i),w:l(e+n),h:c(i+s)},options:o,type:"link"})},r.textWithLink=function(e,i,n,s){var o,a,l=this.getTextWidth(e),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var h=this.splitTextToSize(e,a).length;o=Math.ceil(c*h)}else a=l,o=c;return this.text(e,i,n,s),n+=.2*c,s.align==="center"&&(i-=l/2),s.align==="right"&&(i-=l),this.link(i,n-c,a,o,s),l},r.getTextWidth=function(e){var i=this.internal.getFontSize();return this.getStringUnitWidth(e)*i/this.internal.scaleFactor}})(Ut.API),(function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(y){return t[y.charCodeAt(0)]!==void 0},o=r.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},a=r.__arabicParser__.isArabicEndLetter=function(y){return o(y)&&s(y)&&t[y.charCodeAt(0)].length<=2},l=r.__arabicParser__.isArabicAlfLetter=function(y){return o(y)&&n.indexOf(y.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return o(y)&&s(y)&&t[y.charCodeAt(0)].length>=1};var c=r.__arabicParser__.arabicLetterHasFinalForm=function(y){return o(y)&&s(y)&&t[y.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(y){return o(y)&&s(y)&&t[y.charCodeAt(0)].length>=3};var h=r.__arabicParser__.arabicLetterHasMedialForm=function(y){return o(y)&&s(y)&&t[y.charCodeAt(0)].length==4},p=r.__arabicParser__.resolveLigatures=function(y){var _=0,x=e,E="",I=0;for(_=0;_<y.length;_+=1)x[y.charCodeAt(_)]!==void 0?(I++,typeof(x=x[y.charCodeAt(_)])=="number"&&(E+=String.fromCharCode(x),x=e,I=0),_===y.length-1&&(x=e,E+=y.charAt(_-(I-1)),_-=I-1,I=0)):(x=e,E+=y.charAt(_-I),_-=I,I=0);return E};r.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&i[y.charCodeAt(0)]!==void 0};var m=r.__arabicParser__.getCorrectForm=function(y,_,x){return o(y)?s(y)===!1?-1:!c(y)||!o(_)&&!o(x)||!o(x)&&a(_)||a(y)&&!o(_)||a(y)&&l(_)||a(y)&&a(_)?0:h(y)&&o(_)&&!a(_)&&o(x)&&c(x)?3:a(y)||!o(x)?1:2:-1},f=function(y){var _=0,x=0,E=0,I="",O="",V="",Z=(y=y||"").split("\\s+"),nt=[];for(_=0;_<Z.length;_+=1){for(nt.push(""),x=0;x<Z[_].length;x+=1)I=Z[_][x],O=Z[_][x-1],V=Z[_][x+1],o(I)?(E=m(I,O,V),nt[_]+=E!==-1?String.fromCharCode(t[I.charCodeAt(0)][E]):I):nt[_]+=I;nt[_]=p(nt[_])}return nt.join(" ")},b=r.__arabicParser__.processArabic=r.processArabic=function(){var y,_=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(_)){var E=0;for(x=[],E=0;E<_.length;E+=1)Array.isArray(_[E])?x.push([f(_[E][0]),_[E][1],_[E][2]]):x.push([f(_[E])]);y=x}else y=f(_);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};r.events.push(["preProcessText",b])})(Ut.API),Ut.API.autoPrint=function(r){var t;return(r=r||{}).variant=r.variant||"non-conform",r.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(r){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(a){e=a}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,i){var n;if((e=e||"2d")!=="2d")return null;for(n in i)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=i[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(Ut.API),(function(r){var t={left:0,top:0,bottom:0,right:0},e=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(y){l=y}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(y){b=y}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(l){return i.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},r.getTextDimensions=function(l,c){i.call(this);var h=(c=c||{}).fontSize||this.getFontSize(),p=c.font||this.getFont(),m=c.scaleFactor||this.internal.scaleFactor,f=0,b=0,y=0,_=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=c.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(I,O){return I.concat(_.splitTextToSize(O,x))},[])):l=Array.isArray(l)?l:[l];for(var E=0;E<l.length;E++)f<(y=this.getStringUnitWidth(l[E],{font:p})*h)&&(f=y);return f!==0&&(b=l.length),{w:f/=m,h:Math.max((b*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},r.cellAddPage=function(){i.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=r.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i.call(this);var c=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=p.top,f&&m&&(this.printHeaderRow(l.lineNumber,!0),l.y+=m[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,e===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-h,l.y+h,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+h,{align:"center",baseline:"top",maxWidth:l.width-h-h}):this.text(l.text,l.x+h,l.y+h,{align:"left",baseline:"top",maxWidth:l.width-h-h})),this.internal.__cell__.lastCell=l,this};r.table=function(l,c,h,p,m){if(i.call(this),!h)throw new Error("No data for PDF table.");var f,b,y,_,x=[],E=[],I=[],O={},V={},Z=[],nt=[],W=(m=m||{}).autoSize||!1,M=m.printHeaders!==!1,J=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,L=m.margins||Object.assign({width:this.getPageWidth()},t),N=typeof m.padding=="number"?m.padding:3,H=m.headerBackgroundColor||"#c8c8c8",z=m.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=N,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=z,this.setFontSize(J),p==null)E=x=Object.keys(h[0]),I=x.map(function(){return"left"});else if(Array.isArray(p)&&Re(p[0])==="object")for(x=p.map(function(kt){return kt.name}),E=p.map(function(kt){return kt.prompt||kt.name||""}),I=p.map(function(kt){return kt.align||"left"}),f=0;f<p.length;f+=1)V[p[f].name]=.7499990551181103*p[f].width;else Array.isArray(p)&&typeof p[0]=="string"&&(E=x=p,I=x.map(function(){return"left"}));if(W||Array.isArray(p)&&typeof p[0]=="string")for(f=0;f<x.length;f+=1){for(O[_=x[f]]=h.map(function(kt){return kt[_]}),this.setFont(void 0,"bold"),Z.push(this.getTextDimensions(E[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=O[_],this.setFont(void 0,"normal"),y=0;y<b.length;y+=1)Z.push(this.getTextDimensions(b[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);V[_]=Math.max.apply(null,Z)+N+N,Z=[]}if(M){var st={};for(f=0;f<x.length;f+=1)st[x[f]]={},st[x[f]].text=E[f],st[x[f]].align=I[f];var lt=a.call(this,st,V);nt=x.map(function(kt){return new s(l,c,V[kt],lt,st[kt].text,void 0,st[kt].align)}),this.setTableHeaderRow(nt),this.printHeaderRow(1,!1)}var ht=p.reduce(function(kt,xt){return kt[xt.name]=xt.align,kt},{});for(f=0;f<h.length;f+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:f,data:h[f]},this);var et=a.call(this,h[f],V);for(y=0;y<x.length;y+=1){var dt=h[f][x[y]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:f,col:y,data:dt},this),o.call(this,new s(l,c,V[x[y]],et,dt,f+2,ht[x[y]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var a=function(l,c){var h=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(l).map(function(f){var b=l[f];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,c[f]-h-h)},this).map(function(f){return this.getLineHeightFactor()*f.length*p/m+h+h},this).reduce(function(f,b){return Math.max(f,b)},0)};r.setTableHeaderRow=function(l){i.call(this),this.internal.__cell__.tableHeaderRow=l},r.printHeaderRow=function(l,c){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){h=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=l;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,h),this.setTextColor(b)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),e=!1}})(Ut.API);var G5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},X5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Sp=Y5(X5),$5=[100,200,300,400,500,600,700,800,900],pk=Y5($5);function Nf(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),e=(function(s){return G5[s=s||"normal"]?s:"normal"})(r.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(r.weight),n=(function(s){return typeof Sp[s=s||"normal"]=="number"?s:"normal"})(r.stretch);return{family:t,style:e,weight:i,stretch:n,src:r.src||[],ref:r.ref||{name:t,style:[n,e,i].join(" ")}}}function d1(r,t,e,i){var n;for(n=e;n>=0&&n<t.length;n+=i)if(r[t[n]])return r[t[n]];for(n=e;n>=0&&n<t.length;n-=i)if(r[t[n]])return r[t[n]]}var gk={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},f1={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function p1(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function g1(r){return r.trimLeft()}function mk(r,t){for(var e=0;e<r.length;){if(r.charAt(e)===t)return[r.substring(0,e),r.substring(e+1)];e+=1}return null}function vk(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}var Yh,m1,v1,Oa,Gh,w1,b1,y1,Df=["times"];function x1(r,t,e,i,n){var s=4,o=S1;switch(n){case Ut.API.image_compression.FAST:s=1,o=_1;break;case Ut.API.image_compression.MEDIUM:s=6,o=C1;break;case Ut.API.image_compression.SLOW:s=9,o=k1}r=(function(l,c,h,p){for(var m,f=l.length/c,b=new Uint8Array(l.length+f),y=[wk,_1,S1,C1,k1],_=0;_<f;_+=1){var x=_*c,E=l.subarray(x,x+c);if(p)b.set(p(E,h,m),x+_);else{for(var I=y.length,O=[],V=0;V<I;V+=1)O[V]=y[V](E,h,m);var Z=yk(O.concat());b.set(O[Z],x+_)}m=E}return b})(r,t,Math.ceil(e*i/8),o);var a=mp(r,{level:s});return Ut.API.__addimage__.arrayBufferToBinaryString(a)}function wk(r){var t=Array.apply([],r);return t.unshift(0),t}function _1(r,t){var e=r.length,i=[];i[0]=1;for(var n=0;n<e;n+=1){var s=r[n-t]||0;i[n+1]=r[n]-s+256&255}return i}function S1(r,t,e){var i=r.length,n=[];n[0]=2;for(var s=0;s<i;s+=1){var o=e&&e[s]||0;n[s+1]=r[s]-o+256&255}return n}function C1(r,t,e){var i=r.length,n=[];n[0]=3;for(var s=0;s<i;s+=1){var o=r[s-t]||0,a=e&&e[s]||0;n[s+1]=r[s]+256-(o+a>>>1)&255}return n}function k1(r,t,e){var i=r.length,n=[];n[0]=4;for(var s=0;s<i;s+=1){var o=bk(r[s-t]||0,e&&e[s]||0,e&&e[s-t]||0);n[s+1]=r[s]-o+256&255}return n}function bk(r,t,e){if(r===t&&t===e)return r;var i=Math.abs(t-e),n=Math.abs(r-e),s=Math.abs(r+t-e-e);return i<=n&&i<=s?r:n<=s?t:e}function yk(r){var t=r.map(function(e){return e.reduce(function(i,n){return i+Math.abs(n)},0)});return t.indexOf(Math.min.apply(null,t))}function Mf(r,t,e){var i=t*e,n=Math.floor(i/8),s=16-(i-8*n+e),o=(1<<e)-1;return K5(r,n)>>s&o}function A1(r,t,e,i){var n=e*i,s=Math.floor(n/8),o=16-(n-8*s+i),a=(1<<i)-1,l=(t&a)<<o;(function(c,h,p){if(h+1<c.byteLength)c.setUint16(h,p,!1);else{var m=p>>8&255;c.setUint8(h,m)}})(r,s,K5(r,s)&~(a<<o)&65535|l)}function K5(r,t){return t+1<r.byteLength?r.getUint16(t,!1):r.getUint8(t)<<8}function xk(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=r[t++]|r[t++]<<8,i=r[t++]|r[t++]<<8,n=r[t++],s=n>>7,o=1<<1+(7&n);r[t++],r[t++];var a=null,l=null;s&&(a=t,l=o,t+=3*o);var c=!0,h=[],p=0,m=null,f=0,b=null;for(this.width=e,this.height=i;c&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,b=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((L=r[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var y=r[t++];p=r[t++]|r[t++]<<8,m=r[t++],1&y||(m=null),f=y>>2&7,t++;break;case 254:for(;;){if(!((L=r[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var _=r[t++]|r[t++]<<8,x=r[t++]|r[t++]<<8,E=r[t++]|r[t++]<<8,I=r[t++]|r[t++]<<8,O=r[t++],V=O>>6&1,Z=1<<1+(7&O),nt=a,W=l,M=!1;O>>7&&(M=!0,nt=t,W=Z,t+=3*Z);var J=t;for(t++;;){var L;if(!((L=r[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}h.push({x:_,y:x,width:E,height:I,has_local_palette:M,palette_offset:nt,palette_size:W,data_offset:J,data_length:t-J,transparent_index:m,interlaced:!!V,delay:p,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return b},this.frameInfo=function(N){if(N<0||N>=h.length)throw new Error("Frame index out of range.");return h[N]},this.decodeAndBlitFrameBGRA=function(N,H){var z=this.frameInfo(N),st=z.width*z.height,lt=new Uint8Array(st);L1(r,z.data_offset,lt,st);var ht=z.palette_offset,et=z.transparent_index;et===null&&(et=256);var dt=z.width,kt=e-dt,xt=dt,T=4*(z.y*e+z.x),q=4*((z.y+z.height)*e+z.x),U=T,X=4*kt;z.interlaced===!0&&(X+=4*e*7);for(var Q=8,ot=0,ft=lt.length;ot<ft;++ot){var pt=lt[ot];if(xt===0&&(xt=dt,(U+=X)>=q&&(X=4*kt+4*e*(Q-1),U=T+(dt+kt)*(Q<<1),Q>>=1)),pt===et)U+=4;else{var vt=r[ht+3*pt],Lt=r[ht+3*pt+1],Nt=r[ht+3*pt+2];H[U++]=Nt,H[U++]=Lt,H[U++]=vt,H[U++]=255}--xt}},this.decodeAndBlitFrameRGBA=function(N,H){var z=this.frameInfo(N),st=z.width*z.height,lt=new Uint8Array(st);L1(r,z.data_offset,lt,st);var ht=z.palette_offset,et=z.transparent_index;et===null&&(et=256);var dt=z.width,kt=e-dt,xt=dt,T=4*(z.y*e+z.x),q=4*((z.y+z.height)*e+z.x),U=T,X=4*kt;z.interlaced===!0&&(X+=4*e*7);for(var Q=8,ot=0,ft=lt.length;ot<ft;++ot){var pt=lt[ot];if(xt===0&&(xt=dt,(U+=X)>=q&&(X=4*kt+4*e*(Q-1),U=T+(dt+kt)*(Q<<1),Q>>=1)),pt===et)U+=4;else{var vt=r[ht+3*pt],Lt=r[ht+3*pt+1],Nt=r[ht+3*pt+2];H[U++]=vt,H[U++]=Lt,H[U++]=Nt,H[U++]=255}--xt}}}function L1(r,t,e,i){for(var n=r[t++],s=1<<n,o=s+1,a=o+1,l=n+1,c=(1<<l)-1,h=0,p=0,m=0,f=r[t++],b=new Int32Array(4096),y=null;;){for(;h<16&&f!==0;)p|=r[t++]<<h,h+=8,f===1?f=r[t++]:--f;if(h<l)break;var _=p&c;if(p>>=l,h-=l,_!==s){if(_===o)break;for(var x=_<a?_:y,E=0,I=x;I>s;)I=b[I]>>8,++E;var O=I;if(m+E+(x!==_?1:0)>i)return void He.log("Warning, gif stream longer than expected.");e[m++]=O;var V=m+=E;for(x!==_&&(e[m++]=O),I=x;E--;)I=b[I],e[--V]=255&I,I>>=8;y!==null&&a<4096&&(b[a++]=y<<8|O,a>=c+1&&l<12&&(++l,c=c<<1|1)),y=_}else a=o+1,c=(1<<(l=n+1))-1,y=null}return m!==i&&He.log("Warning, gif stream shorter than expected."),e}function If(r){var t,e,i,n,s,o=Math.floor,a=new Array(64),l=new Array(64),c=new Array(64),h=new Array(64),p=new Array(65535),m=new Array(65535),f=new Array(64),b=new Array(64),y=[],_=0,x=7,E=new Array(64),I=new Array(64),O=new Array(64),V=new Array(256),Z=new Array(2048),nt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],W=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],st=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function lt(T,q){for(var U=0,X=0,Q=new Array,ot=1;ot<=16;ot++){for(var ft=1;ft<=T[ot];ft++)Q[q[X]]=[],Q[q[X]][0]=U,Q[q[X]][1]=ot,X++,U++;U*=2}return Q}function ht(T){for(var q=T[0],U=T[1]-1;U>=0;)q&1<<U&&(_|=1<<x),U--,--x<0&&(_==255?(et(255),et(0)):et(_),x=7,_=0)}function et(T){y.push(T)}function dt(T){et(T>>8&255),et(255&T)}function kt(T,q,U,X,Q){for(var ot,ft=Q[0],pt=Q[240],vt=(function(Ct,Zt){var It,$t,Yt,De,ye,le,Se,xe,qt,de,Wt=0;for(qt=0;qt<8;++qt){It=Ct[Wt],$t=Ct[Wt+1],Yt=Ct[Wt+2],De=Ct[Wt+3],ye=Ct[Wt+4],le=Ct[Wt+5],Se=Ct[Wt+6];var hi=It+(xe=Ct[Wt+7]),Le=It-xe,ve=$t+Se,we=$t-Se,Ze=Yt+le,Xt=Yt-le,We=De+ye,te=De-ye,ce=hi+We,Je=hi-We,be=ve+Ze,Jt=ve-Ze;Ct[Wt]=ce+be,Ct[Wt+4]=ce-be;var Me=.707106781*(Jt+Je);Ct[Wt+2]=Je+Me,Ct[Wt+6]=Je-Me;var _o=.382683433*((ce=te+Xt)-(Jt=we+Le)),Xi=.5411961*ce+_o,cs=1.306562965*Jt+_o,Dn=.707106781*(be=Xt+we),Qt=Le+Dn,hs=Le-Dn;Ct[Wt+5]=hs+Xi,Ct[Wt+3]=hs-Xi,Ct[Wt+1]=Qt+cs,Ct[Wt+7]=Qt-cs,Wt+=8}for(Wt=0,qt=0;qt<8;++qt){It=Ct[Wt],$t=Ct[Wt+8],Yt=Ct[Wt+16],De=Ct[Wt+24],ye=Ct[Wt+32],le=Ct[Wt+40],Se=Ct[Wt+48];var us=It+(xe=Ct[Wt+56]),Kr=It-xe,Zr=$t+Se,ni=$t-Se,ji=Yt+le,Ri=Yt-le,So=De+ye,Hs=De-ye,un=us+So,Mn=us-So,dn=Zr+ji,fn=Zr-ji;Ct[Wt]=un+dn,Ct[Wt+32]=un-dn;var Jr=.707106781*(fn+Mn);Ct[Wt+16]=Mn+Jr,Ct[Wt+48]=Mn-Jr;var Co=.382683433*((un=Hs+Ri)-(fn=ni+Kr)),In=.5411961*un+Co,ko=1.306562965*fn+Co,fa=.707106781*(dn=Ri+ni),pa=Kr+fa,ga=Kr-fa;Ct[Wt+40]=ga+In,Ct[Wt+24]=ga-In,Ct[Wt+8]=pa+ko,Ct[Wt+56]=pa-ko,Wt++}for(qt=0;qt<64;++qt)de=Ct[qt]*Zt[qt],f[qt]=de>0?de+.5|0:de-.5|0;return f})(T,q),Lt=0;Lt<64;++Lt)b[nt[Lt]]=vt[Lt];var Nt=b[0]-U;U=b[0],Nt==0?ht(X[0]):(ht(X[m[ot=32767+Nt]]),ht(p[ot]));for(var Pt=63;Pt>0&&b[Pt]==0;)Pt--;if(Pt==0)return ht(ft),U;for(var Vt,j=1;j<=Pt;){for(var Ot=j;b[j]==0&&j<=Pt;)++j;var me=j-Ot;if(me>=16){Vt=me>>4;for(var Kt=1;Kt<=Vt;++Kt)ht(pt);me&=15}ot=32767+b[j],ht(Q[(me<<4)+m[ot]]),ht(p[ot]),j++}return Pt!=63&&ht(ft),U}function xt(T){T=Math.min(Math.max(T,1),100),s!=T&&((function(q){for(var U=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var Q=o((U[X]*q+50)/100);Q=Math.min(Math.max(Q,1),255),a[nt[X]]=Q}for(var ot=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ft=0;ft<64;ft++){var pt=o((ot[ft]*q+50)/100);pt=Math.min(Math.max(pt,1),255),l[nt[ft]]=pt}for(var vt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Lt=0,Nt=0;Nt<8;Nt++)for(var Pt=0;Pt<8;Pt++)c[Lt]=1/(a[nt[Lt]]*vt[Nt]*vt[Pt]*8),h[Lt]=1/(l[nt[Lt]]*vt[Nt]*vt[Pt]*8),Lt++})(T<50?Math.floor(5e3/T):Math.floor(200-2*T)),s=T)}this.encode=function(T,q){q&&xt(q),y=new Array,_=0,x=7,dt(65496),dt(65504),dt(16),et(74),et(70),et(73),et(70),et(0),et(1),et(1),et(0),dt(1),dt(1),et(0),et(0),(function(){dt(65499),dt(132),et(0);for(var $t=0;$t<64;$t++)et(a[$t]);et(1);for(var Yt=0;Yt<64;Yt++)et(l[Yt])})(),(function($t,Yt){dt(65472),dt(17),et(8),dt(Yt),dt($t),et(3),et(1),et(17),et(0),et(2),et(17),et(1),et(3),et(17),et(1)})(T.width,T.height),(function(){dt(65476),dt(418),et(0);for(var $t=0;$t<16;$t++)et(W[$t+1]);for(var Yt=0;Yt<=11;Yt++)et(M[Yt]);et(16);for(var De=0;De<16;De++)et(J[De+1]);for(var ye=0;ye<=161;ye++)et(L[ye]);et(1);for(var le=0;le<16;le++)et(N[le+1]);for(var Se=0;Se<=11;Se++)et(H[Se]);et(17);for(var xe=0;xe<16;xe++)et(z[xe+1]);for(var qt=0;qt<=161;qt++)et(st[qt])})(),dt(65498),dt(12),et(3),et(1),et(0),et(2),et(17),et(3),et(17),et(0),et(63),et(0);var U=0,X=0,Q=0;_=0,x=7,this.encode.displayName="_encode_";for(var ot,ft,pt,vt,Lt,Nt,Pt,Vt,j,Ot=T.data,me=T.width,Kt=T.height,Ct=4*me,Zt=0;Zt<Kt;){for(ot=0;ot<Ct;){for(Lt=Ct*Zt+ot,Pt=-1,Vt=0,j=0;j<64;j++)Nt=Lt+(Vt=j>>3)*Ct+(Pt=4*(7&j)),Zt+Vt>=Kt&&(Nt-=Ct*(Zt+1+Vt-Kt)),ot+Pt>=Ct&&(Nt-=ot+Pt-Ct+4),ft=Ot[Nt++],pt=Ot[Nt++],vt=Ot[Nt++],E[j]=(Z[ft]+Z[pt+256|0]+Z[vt+512|0]>>16)-128,I[j]=(Z[ft+768|0]+Z[pt+1024|0]+Z[vt+1280|0]>>16)-128,O[j]=(Z[ft+1280|0]+Z[pt+1536|0]+Z[vt+1792|0]>>16)-128;U=kt(E,c,U,t,i),X=kt(I,h,X,e,n),Q=kt(O,h,Q,e,n),ot+=32}Zt+=8}if(x>=0){var It=[];It[1]=x+1,It[0]=(1<<x+1)-1,ht(It)}return dt(65497),new Uint8Array(y)},r=r||50,(function(){for(var T=String.fromCharCode,q=0;q<256;q++)V[q]=T(q)})(),t=lt(W,M),e=lt(N,H),i=lt(J,L),n=lt(z,st),(function(){for(var T=1,q=2,U=1;U<=15;U++){for(var X=T;X<q;X++)m[32767+X]=U,p[32767+X]=[],p[32767+X][1]=U,p[32767+X][0]=X;for(var Q=-(q-1);Q<=-T;Q++)m[32767+Q]=U,p[32767+Q]=[],p[32767+Q][1]=U,p[32767+Q][0]=q-1+Q;T<<=1,q<<=1}})(),(function(){for(var T=0;T<256;T++)Z[T]=19595*T,Z[T+256|0]=38470*T,Z[T+512|0]=7471*T+32768,Z[T+768|0]=-11059*T,Z[T+1024|0]=-21709*T,Z[T+1280|0]=32768*T+8421375,Z[T+1536|0]=-27439*T,Z[T+1792|0]=-5329*T})(),xt(r)}function yn(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function T1(r){function t(M){if(!M)throw Error("assert :P")}function e(M,J,L){for(var N=0;4>N;N++)if(M[J+N]!=L.charCodeAt(N))return!0;return!1}function i(M,J,L,N,H){for(var z=0;z<H;z++)M[J+z]=L[N+z]}function n(M,J,L,N){for(var H=0;H<N;H++)M[J+H]=L}function s(M){return new Int32Array(M)}function o(M,J){for(var L=[],N=0;N<M;N++)L.push(new J);return L}function a(M,J){var L=[];return(function N(H,z,st){for(var lt=st[z],ht=0;ht<lt&&(H.push(st.length>z+1?[]:new J),!(st.length<z+1));ht++)N(H[ht],z+1,st)})(L,0,M),L}var l=function(){var M=this;function J(u,d){for(var v=1<<d-1>>>0;u&v;)v>>>=1;return v?(u&v-1)+v:u}function L(u,d,v,w,C){t(!(w%v));do u[d+(w-=v)]=C;while(0<w)}function N(u,d,v,w,C){if(t(2328>=C),512>=C)var k=s(512);else if((k=s(C))==null)return 0;return(function(A,P,D,F,K,ct){var B,tt,rt=P,mt=1<<D,at=s(16),wt=s(16);for(t(K!=0),t(F!=null),t(A!=null),t(0<D),tt=0;tt<K;++tt){if(15<F[tt])return 0;++at[F[tt]]}if(at[0]==K)return 0;for(wt[1]=0,B=1;15>B;++B){if(at[B]>1<<B)return 0;wt[B+1]=wt[B]+at[B]}for(tt=0;tt<K;++tt)B=F[tt],0<F[tt]&&(ct[wt[B]++]=tt);if(wt[15]==1)return(F=new H).g=0,F.value=ct[0],L(A,rt,1,mt,F),mt;var yt,At=-1,St=mt-1,Ht=0,Mt=1,pe=1,Bt=1<<D;for(tt=0,B=1,K=2;B<=D;++B,K<<=1){if(Mt+=pe<<=1,0>(pe-=at[B]))return 0;for(;0<at[B];--at[B])(F=new H).g=B,F.value=ct[tt++],L(A,rt+Ht,K,Bt,F),Ht=J(Ht,B)}for(B=D+1,K=2;15>=B;++B,K<<=1){if(Mt+=pe<<=1,0>(pe-=at[B]))return 0;for(;0<at[B];--at[B]){if(F=new H,(Ht&St)!=At){for(rt+=Bt,yt=1<<(At=B)-D;15>At&&!(0>=(yt-=at[At]));)++At,yt<<=1;mt+=Bt=1<<(yt=At-D),A[P+(At=Ht&St)].g=yt+D,A[P+At].value=rt-P-At}F.g=B-D,F.value=ct[tt++],L(A,rt+(Ht>>D),K,Bt,F),Ht=J(Ht,B)}}return Mt!=2*wt[15]-1?0:mt})(u,d,v,w,C,k)}function H(){this.value=this.g=0}function z(){this.value=this.g=0}function st(){this.G=o(5,H),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(jo,z)}function lt(u,d,v,w){t(u!=null),t(d!=null),t(2147483648>w),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=d,u.pa=v,u.Jd=d,u.Yc=v+w,u.Zc=4<=w?v+w-4+1:v,ft(u)}function ht(u,d){for(var v=0;0<d--;)v|=vt(u,128)<<d;return v}function et(u,d){var v=ht(u,d);return pt(u)?-v:v}function dt(u,d,v,w){var C,k=0;for(t(u!=null),t(d!=null),t(4294967288>w),u.Sb=w,u.Ra=0,u.u=0,u.h=0,4<w&&(w=4),C=0;C<w;++C)k+=d[v+C]<<8*C;u.Ra=k,u.bb=w,u.oa=d,u.pa=v}function kt(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<Ys-8>>>0,++u.bb,u.u-=8;X(u)&&(u.h=1,u.u=0)}function xt(u,d){if(t(0<=d),!u.h&&d<=Nr){var v=U(u)&Pr[d];return u.u+=d,kt(u),v}return u.h=1,u.u=0}function T(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function U(u){return u.Ra>>>(u.u&Ys-1)>>>0}function X(u){return t(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>Ys}function Q(u,d){u.u=d,u.h=X(u)}function ot(u){u.u>=_s&&(t(u.u>=_s),kt(u))}function ft(u){t(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(t(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function pt(u){return ht(u,1)}function vt(u,d){var v=u.Ca;0>u.b&&ft(u);var w=u.b,C=v*d>>>8,k=(u.I>>>w>C)+0;for(k?(v-=C,u.I-=C+1<<w>>>0):v=C+1,w=v,C=0;256<=w;)C+=8,w>>=8;return w=7^C+Gs[w],u.b-=w,u.Ca=(v<<w)-1,k}function Lt(u,d,v){u[d+0]=v>>24&255,u[d+1]=v>>16&255,u[d+2]=v>>8&255,u[d+3]=255&v}function Nt(u,d){return u[d+0]|u[d+1]<<8}function Pt(u,d){return Nt(u,d)|u[d+2]<<16}function Vt(u,d){return Nt(u,d)|Nt(u,d+2)<<16}function j(u,d){var v=1<<d;return t(u!=null),t(0<d),u.X=s(v),u.X==null?0:(u.Mb=32-d,u.Xa=d,1)}function Ot(u,d){t(u!=null),t(d!=null),t(u.Xa==d.Xa),i(d.X,0,u.X,0,1<<d.Xa)}function me(){this.X=[],this.Xa=this.Mb=0}function Kt(u,d,v,w){t(v!=null),t(w!=null);var C=v[0],k=w[0];return C==0&&(C=(u*k+d/2)/d),k==0&&(k=(d*C+u/2)/u),0>=C||0>=k?0:(v[0]=C,w[0]=k,1)}function Ct(u,d){return u+(1<<d)-1>>>d}function Zt(u,d){return((4278255360&u)+(4278255360&d)>>>0&4278255360)+((16711935&u)+(16711935&d)>>>0&16711935)>>>0}function It(u,d){M[d]=function(v,w,C,k,A,P,D){var F;for(F=0;F<A;++F){var K=M[u](P[D+F-1],C,k+F);P[D+F]=Zt(v[w+F],K)}}}function $t(){this.ud=this.hd=this.jd=0}function Yt(u,d){return((4278124286&(u^d))>>>1)+(u&d)>>>0}function De(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function ye(u,d){return De(u+(u-d+.5>>1))}function le(u,d,v){return Math.abs(d-v)-Math.abs(u-v)}function Se(u,d,v,w,C,k,A){for(w=k[A-1],v=0;v<C;++v)k[A+v]=w=Zt(u[d+v],w)}function xe(u,d,v,w,C){var k;for(k=0;k<v;++k){var A=u[d+k],P=A>>8&255,D=16711935&(D=(D=16711935&A)+((P<<16)+P));w[C+k]=(4278255360&A)+D>>>0}}function qt(u,d){d.jd=255&u,d.hd=u>>8&255,d.ud=u>>16&255}function de(u,d,v,w,C,k){var A;for(A=0;A<w;++A){var P=d[v+A],D=P>>>8,F=P,K=255&(K=(K=P>>>16)+((u.jd<<24>>24)*(D<<24>>24)>>>5));F=255&(F=(F+=(u.hd<<24>>24)*(D<<24>>24)>>>5)+((u.ud<<24>>24)*(K<<24>>24)>>>5)),C[k+A]=(4278255360&P)+(K<<16)+F}}function Wt(u,d,v,w,C){M[d]=function(k,A,P,D,F,K,ct,B,tt){for(D=ct;D<B;++D)for(ct=0;ct<tt;++ct)F[K++]=C(P[w(k[A++])])},M[u]=function(k,A,P,D,F,K,ct){var B=8>>k.b,tt=k.Ea,rt=k.K[0],mt=k.w;if(8>B)for(k=(1<<k.b)-1,mt=(1<<B)-1;A<P;++A){var at,wt=0;for(at=0;at<tt;++at)at&k||(wt=w(D[F++])),K[ct++]=C(rt[wt&mt]),wt>>=B}else M["VP8LMapColor"+v](D,F,rt,mt,K,ct,A,P,tt)}}function hi(u,d,v,w,C){for(v=d+v;d<v;){var k=u[d++];w[C++]=k>>16&255,w[C++]=k>>8&255,w[C++]=255&k}}function Le(u,d,v,w,C){for(v=d+v;d<v;){var k=u[d++];w[C++]=k>>16&255,w[C++]=k>>8&255,w[C++]=255&k,w[C++]=k>>24&255}}function ve(u,d,v,w,C){for(v=d+v;d<v;){var k=(A=u[d++])>>16&240|A>>12&15,A=240&A|A>>28&15;w[C++]=k,w[C++]=A}}function we(u,d,v,w,C){for(v=d+v;d<v;){var k=(A=u[d++])>>16&248|A>>13&7,A=A>>5&224|A>>3&31;w[C++]=k,w[C++]=A}}function Ze(u,d,v,w,C){for(v=d+v;d<v;){var k=u[d++];w[C++]=255&k,w[C++]=k>>8&255,w[C++]=k>>16&255}}function Xt(u,d,v,w,C,k){if(k==0)for(v=d+v;d<v;)Lt(w,((k=u[d++])[0]>>24|k[1]>>8&65280|k[2]<<8&16711680|k[3]<<24)>>>0),C+=32;else i(w,C,u,d,v)}function We(u,d){M[d][0]=M[u+"0"],M[d][1]=M[u+"1"],M[d][2]=M[u+"2"],M[d][3]=M[u+"3"],M[d][4]=M[u+"4"],M[d][5]=M[u+"5"],M[d][6]=M[u+"6"],M[d][7]=M[u+"7"],M[d][8]=M[u+"8"],M[d][9]=M[u+"9"],M[d][10]=M[u+"10"],M[d][11]=M[u+"11"],M[d][12]=M[u+"12"],M[d][13]=M[u+"13"],M[d][14]=M[u+"0"],M[d][15]=M[u+"0"]}function te(u){return u==Md||u==Id||u==vh||u==jd}function ce(){this.eb=[],this.size=this.A=this.fb=0}function Je(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function be(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ce,this.f.kb=new Je,this.sd=null}function Jt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Me(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _o(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function Xi(u,d){var v=u.T,w=d.ba.f.RGBA,C=w.eb,k=w.fb+u.ka*w.A,A=sn[d.ba.S],P=u.y,D=u.O,F=u.f,K=u.N,ct=u.ea,B=u.W,tt=d.cc,rt=d.dc,mt=d.Mc,at=d.Nc,wt=u.ka,yt=u.ka+u.T,At=u.U,St=At+1>>1;for(wt==0?A(P,D,null,null,F,K,ct,B,F,K,ct,B,C,k,null,null,At):(A(d.ec,d.fc,P,D,tt,rt,mt,at,F,K,ct,B,C,k-w.A,C,k,At),++v);wt+2<yt;wt+=2)tt=F,rt=K,mt=ct,at=B,K+=u.Rc,B+=u.Rc,k+=2*w.A,A(P,(D+=2*u.fa)-u.fa,P,D,tt,rt,mt,at,F,K,ct,B,C,k-w.A,C,k,At);return D+=u.fa,u.j+yt<u.o?(i(d.ec,d.fc,P,D,At),i(d.cc,d.dc,F,K,St),i(d.Mc,d.Nc,ct,B,St),v--):1&yt||A(P,D,null,null,F,K,ct,B,F,K,ct,B,C,k+w.A,null,null,At),v}function cs(u,d,v){var w=u.F,C=[u.J];if(w!=null){var k=u.U,A=d.ba.S,P=A==mh||A==vh;d=d.ba.f.RGBA;var D=[0],F=u.ka;D[0]=u.T,u.Kb&&(F==0?--D[0]:(--F,C[0]-=u.width),u.j+u.ka+u.T==u.o&&(D[0]=u.o-u.j-F));var K=d.eb;F=d.fb+F*d.A,u=Ng(w,C[0],u.width,k,D,K,F+(P?0:3),d.A),t(v==D),u&&te(A)&&Rl(K,F,P,k,D,d.A)}return 0}function Dn(u){var d=u.ma,v=d.ba.S,w=11>v,C=v==ph||v==gh||v==mh||v==Dd||v==12||te(v);if(d.memory=null,d.Ib=null,d.Jb=null,d.Nd=null,!Pl(d.Oa,u,C?11:12))return 0;if(C&&te(v)&&Tl(),u.da)alert("todo:use_scaling");else{if(w){if(d.Ib=_o,u.Kb){if(v=u.U+1>>1,d.memory=s(u.U+2*v),d.memory==null)return 0;d.ec=d.memory,d.fc=0,d.cc=d.ec,d.dc=d.fc+u.U,d.Mc=d.cc,d.Nc=d.dc+v,d.Ib=Xi,Tl()}}else alert("todo:EmitYUV");C&&(d.Jb=cs,w&&gn())}if(w&&!Xg){for(u=0;256>u;++u)Nw[u]=89858*(u-128)+bh>>wh,Iw[u]=-22014*(u-128)+bh,Mw[u]=-45773*(u-128),Dw[u]=113618*(u-128)+bh>>wh;for(u=zl;u<Rd;++u)d=76283*(u-16)+bh>>wh,jw[u-zl]=jn(d,255),Fw[u-zl]=jn(d+8>>4,15);Xg=1}return 1}function Qt(u){var d=u.ma,v=u.U,w=u.T;return t(!(1&u.ka)),0>=v||0>=w?0:(v=d.Ib(u,d),d.Jb!=null&&d.Jb(u,d,v),d.Dc+=v,1)}function hs(u){u.ma.memory=null}function us(u,d,v,w){return xt(u,8)!=47?0:(d[0]=xt(u,14)+1,v[0]=xt(u,14)+1,w[0]=xt(u,1),xt(u,3)!=0?0:!u.h)}function Kr(u,d){if(4>u)return u+1;var v=u-2>>1;return(2+(1&u)<<v)+xt(d,v)+1}function Zr(u,d){return 120<d?d-120:1<=(v=((v=ww[d-1])>>4)*u+(8-(15&v)))?v:1;var v}function ni(u,d,v){var w=U(v),C=u[d+=255&w].g-8;return 0<C&&(Q(v,v.u+8),w=U(v),d+=u[d].value,d+=w&(1<<C)-1),Q(v,v.u+u[d].g),u[d].value}function ji(u,d,v){return v.g+=u.g,v.value+=u.value<<d>>>0,t(8>=v.g),u.g}function Ri(u,d,v){var w=u.xc;return t((d=w==0?0:u.vc[u.md*(v>>w)+(d>>w)])<u.Wb),u.Ya[d]}function So(u,d,v,w){var C=u.ab,k=u.c*d,A=u.C;d=A+d;var P=v,D=w;for(w=u.Ta,v=u.Ua;0<C--;){var F=u.gc[C],K=A,ct=d,B=P,tt=D,rt=(D=w,P=v,F.Ea);switch(t(K<ct),t(ct<=F.nc),F.hc){case 2:ui(B,tt,(ct-K)*rt,D,P);break;case 0:var mt=K,at=ct,wt=D,yt=P,At=(Bt=F).Ea;mt==0&&(Dl(B,tt,null,null,1,wt,yt),Se(B,tt+1,0,0,At-1,wt,yt+1),tt+=At,yt+=At,++mt);for(var St=1<<Bt.b,Ht=St-1,Mt=Ct(At,Bt.b),pe=Bt.K,Bt=Bt.w+(mt>>Bt.b)*Mt;mt<at;){var Ce=pe,Di=Bt,ge=1;for(Sa(B,tt,wt,yt-At,1,wt,yt);ge<At;){var Rt=(ge&~Ht)+St;Rt>At&&(Rt=At),(0,Il[Ce[Di++]>>8&15])(B,tt+ +ge,wt,yt+ge-At,Rt-ge,wt,yt+ge),ge=Rt}tt+=At,yt+=At,++mt&Ht||(Bt+=Mt)}ct!=F.nc&&i(D,P-rt,D,P+(ct-K-1)*rt,rt);break;case 1:for(rt=B,at=tt,At=(B=F.Ea)-(yt=B&~(wt=(tt=1<<F.b)-1)),mt=Ct(B,F.b),St=F.K,F=F.w+(K>>F.b)*mt;K<ct;){for(Ht=St,Mt=F,pe=new $t,Bt=at+yt,Ce=at+B;at<Bt;)qt(Ht[Mt++],pe),jl(pe,rt,at,tt,D,P),at+=tt,P+=tt;at<Ce&&(qt(Ht[Mt++],pe),jl(pe,rt,at,At,D,P),at+=At,P+=At),++K&wt||(F+=mt)}break;case 3:if(B==D&&tt==P&&0<F.b){for(at=D,B=rt=P+(ct-K)*rt-(yt=(ct-K)*Ct(F.Ea,F.b)),tt=D,wt=P,mt=[],yt=(At=yt)-1;0<=yt;--yt)mt[yt]=tt[wt+yt];for(yt=At-1;0<=yt;--yt)at[B+yt]=mt[yt];hh(F,K,ct,D,rt,D,P)}else hh(F,K,ct,B,tt,D,P)}P=w,D=v}D!=v&&i(w,v,P,D,k)}function Hs(u,d){var v=u.V,w=u.Ba+u.c*u.C,C=d-u.C;if(t(d<=u.l.o),t(16>=C),0<C){var k=u.l,A=u.Ta,P=u.Ua,D=k.width;if(So(u,C,v,w),C=P=[P],t((v=u.C)<(w=d)),t(k.v<k.va),w>k.o&&(w=k.o),v<k.j){var F=k.j-v;v=k.j,C[0]+=F*D}if(v>=w?v=0:(C[0]+=4*k.v,k.ka=v-k.j,k.U=k.va-k.v,k.T=w-v,v=1),v){if(P=P[0],11>(v=u.ca).S){var K=v.f.RGBA,ct=(w=v.S,C=k.U,k=k.T,F=K.eb,K.A),B=k;for(K=K.fb+u.Ma*K.A;0<B--;){var tt=A,rt=P,mt=C,at=F,wt=K;switch(w){case fh:Fl(tt,rt,mt,at,wt);break;case ph:Xs(tt,rt,mt,at,wt);break;case Md:Xs(tt,rt,mt,at,wt),Rl(at,wt,0,mt,1,0);break;case Rg:Fo(tt,rt,mt,at,wt);break;case gh:Xt(tt,rt,mt,at,wt,1);break;case Id:Xt(tt,rt,mt,at,wt,1),Rl(at,wt,0,mt,1,0);break;case mh:Xt(tt,rt,mt,at,wt,0);break;case vh:Xt(tt,rt,mt,at,wt,0),Rl(at,wt,1,mt,1,0);break;case Dd:$s(tt,rt,mt,at,wt);break;case jd:$s(tt,rt,mt,at,wt),Pg(at,wt,mt,1,0);break;case qg:Ks(tt,rt,mt,at,wt);break;default:t(0)}P+=D,K+=ct}u.Ma+=k}else alert("todo:EmitRescaledRowsYUVA");t(u.Ma<=v.height)}}u.C=d,t(u.C<=u.i)}function un(u){var d;if(0<u.ua)return 0;for(d=0;d<u.Wb;++d){var v=u.Ya[d].G,w=u.Ya[d].H;if(0<v[1][w[1]+0].g||0<v[2][w[2]+0].g||0<v[3][w[3]+0].g)return 0}return 1}function Mn(u,d,v,w,C,k){if(u.Z!=0){var A=u.qd,P=u.rd;for(t(Qs[u.Z]!=null);d<v;++d)Qs[u.Z](A,P,w,C,w,C,k),A=w,P=C,C+=k;u.qd=A,u.rd=P}}function dn(u,d){var v=u.l.ma,w=v.Z==0||v.Z==1?u.l.j:u.C;if(w=u.C<w?w:u.C,t(d<=u.l.o),d>w){var C=u.l.width,k=v.ca,A=v.tb+C*w,P=u.V,D=u.Ba+u.c*w,F=u.gc;t(u.ab==1),t(F[0].hc==3),qn(F[0],w,d,P,D,k,A),Mn(v,w,d,k,A,C)}u.C=u.Ma=d}function fn(u,d,v,w,C,k,A){var P=u.$/w,D=u.$%w,F=u.m,K=u.s,ct=v+u.$,B=ct;C=v+w*C;var tt=v+w*k,rt=280+K.ua,mt=u.Pb?P:16777216,at=0<K.ua?K.Wa:null,wt=K.wc,yt=ct<tt?Ri(K,D,P):null;t(u.C<k),t(tt<=C);var At=!1;t:for(;;){for(;At||ct<tt;){var St=0;if(P>=mt){var Ht=ct-v;t((mt=u).Pb),mt.wd=mt.m,mt.xd=Ht,0<mt.s.ua&&Ot(mt.s.Wa,mt.s.vb),mt=P+yw}if(D&wt||(yt=Ri(K,D,P)),t(yt!=null),yt.Qb&&(d[ct]=yt.qb,At=!0),!At)if(ot(F),yt.jc){St=F,Ht=d;var Mt=ct,pe=yt.pd[U(St)&jo-1];t(yt.jc),256>pe.g?(Q(St,St.u+pe.g),Ht[Mt]=pe.value,St=0):(Q(St,St.u+pe.g-256),t(256<=pe.value),St=pe.value),St==0&&(At=!0)}else St=ni(yt.G[0],yt.H[0],F);if(F.h)break;if(At||256>St){if(!At)if(yt.nd)d[ct]=(yt.qb|St<<8)>>>0;else{if(ot(F),At=ni(yt.G[1],yt.H[1],F),ot(F),Ht=ni(yt.G[2],yt.H[2],F),Mt=ni(yt.G[3],yt.H[3],F),F.h)break;d[ct]=(Mt<<24|At<<16|St<<8|Ht)>>>0}if(At=!1,++ct,++D>=w&&(D=0,++P,A!=null&&P<=k&&!(P%16)&&A(u,P),at!=null))for(;B<ct;)St=d[B++],at.X[(506832829*St&4294967295)>>>at.Mb]=St}else if(280>St){if(St=Kr(St-256,F),Ht=ni(yt.G[4],yt.H[4],F),ot(F),Ht=Zr(w,Ht=Kr(Ht,F)),F.h)break;if(ct-v<Ht||C-ct<St)break t;for(Mt=0;Mt<St;++Mt)d[ct+Mt]=d[ct+Mt-Ht];for(ct+=St,D+=St;D>=w;)D-=w,++P,A!=null&&P<=k&&!(P%16)&&A(u,P);if(t(ct<=C),D&wt&&(yt=Ri(K,D,P)),at!=null)for(;B<ct;)St=d[B++],at.X[(506832829*St&4294967295)>>>at.Mb]=St}else{if(!(St<rt))break t;for(At=St-280,t(at!=null);B<ct;)St=d[B++],at.X[(506832829*St&4294967295)>>>at.Mb]=St;St=ct,t(!(At>>>(Ht=at).Xa)),d[St]=Ht.X[At],At=!0}At||t(F.h==X(F))}if(u.Pb&&F.h&&ct<C)t(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&Ot(u.s.vb,u.s.Wa);else{if(F.h)break t;A?.(u,P>k?k:P),u.a=0,u.$=ct-v}return 1}return u.a=3,0}function Jr(u){t(u!=null),u.vc=null,u.yc=null,u.Ya=null;var d=u.Wa;d!=null&&(d.X=null),u.vb=null,t(u!=null)}function Co(){var u=new ne;return u==null?null:(u.a=0,u.xb=Ug,We("Predictor","VP8LPredictors"),We("Predictor","VP8LPredictors_C"),We("PredictorAdd","VP8LPredictorsAdd"),We("PredictorAdd","VP8LPredictorsAdd_C"),ui=xe,jl=de,Fl=hi,Xs=Le,$s=ve,Ks=we,Fo=Ze,M.VP8LMapColor32b=Rn,M.VP8LMapColor8b=Ml,u)}function In(u,d,v,w,C){var k=1,A=[u],P=[d],D=w.m,F=w.s,K=null,ct=0;t:for(;;){if(v)for(;k&&xt(D,1);){var B=A,tt=P,rt=w,mt=1,at=rt.m,wt=rt.gc[rt.ab],yt=xt(at,2);if(rt.Oc&1<<yt)k=0;else{switch(rt.Oc|=1<<yt,wt.hc=yt,wt.Ea=B[0],wt.nc=tt[0],wt.K=[null],++rt.ab,t(4>=rt.ab),yt){case 0:case 1:wt.b=xt(at,3)+2,mt=In(Ct(wt.Ea,wt.b),Ct(wt.nc,wt.b),0,rt,wt.K),wt.K=wt.K[0];break;case 3:var At,St=xt(at,8)+1,Ht=16<St?0:4<St?1:2<St?2:3;if(B[0]=Ct(wt.Ea,Ht),wt.b=Ht,At=mt=In(St,1,0,rt,wt.K)){var Mt,pe=St,Bt=wt,Ce=1<<(8>>Bt.b),Di=s(Ce);if(Di==null)At=0;else{var ge=Bt.K[0],Rt=Bt.w;for(Di[0]=Bt.K[0][0],Mt=1;Mt<1*pe;++Mt)Di[Mt]=Zt(ge[Rt+Mt],Di[Mt-1]);for(;Mt<4*Ce;++Mt)Di[Mt]=0;Bt.K[0]=null,Bt.K[0]=Di,At=1}}mt=At;break;case 2:break;default:t(0)}k=mt}}if(A=A[0],P=P[0],k&&xt(D,1)&&!(k=1<=(ct=xt(D,4))&&11>=ct)){w.a=3;break t}var Et;if(Et=k)e:{var fi,he,Ae,Xe=w,Hi=A,ar=P,si=ct,$i=v,lr=Xe.m,Mi=Xe.s,Ee=[null],Fe=1,oi=0,Be=bw[si];i:for(;;){if($i&&xt(lr,1)){var Ui=xt(lr,3)+2,vn=Ct(Hi,Ui),pi=Ct(ar,Ui),_r=vn*pi;if(!In(vn,pi,0,Xe,Ee))break i;for(Ee=Ee[0],Mi.xc=Ui,fi=0;fi<_r;++fi){var ze=Ee[fi]>>8&65535;Ee[fi]=ze,ze>=Fe&&(Fe=ze+1)}}if(lr.h)break i;for(he=0;5>he;++he){var Ii=zg[he];!he&&0<si&&(Ii+=1<<si),oi<Ii&&(oi=Ii)}var Mr=o(Fe*Be,H),cr=Fe,Ir=o(cr,st);if(Ir==null)var jr=null;else t(65536>=cr),jr=Ir;var Sr=s(oi);if(jr==null||Sr==null||Mr==null){Xe.a=1;break i}var Fr=Mr;for(fi=Ae=0;fi<Fe;++fi){var Ye=jr[fi],Br=Ye.G,wn=Ye.H,Ro=0,ks=1,Wi=0;for(he=0;5>he;++he){Ii=zg[he],Br[he]=Fr,wn[he]=Ae,!he&&0<si&&(Ii+=1<<si);n:{var xh,qd=Ii,_h=Xe,Hl=Sr,qw=Fr,zw=Ae,zd=0,to=_h.m,Hw=xt(to,1);if(n(Hl,0,0,qd),Hw){var Uw=xt(to,1)+1,Ww=xt(to,1),Zg=xt(to,Ww==0?1:8);Hl[Zg]=1,Uw==2&&(Hl[Zg=xt(to,8)]=1);var Sh=1}else{var Jg=s(19),Qg=xt(to,4)+4;if(19<Qg){_h.a=3;var Ch=0;break n}for(xh=0;xh<Qg;++xh)Jg[vw[xh]]=xt(to,3);var Hd=void 0,Ul=void 0,t0=_h,Vw=Jg,kh=qd,e0=Hl,Ud=0,eo=t0.m,i0=8,r0=o(128,H);r:for(;N(r0,0,7,Vw,19);){if(xt(eo,1)){var Yw=2+2*xt(eo,3);if((Hd=2+xt(eo,Yw))>kh)break r}else Hd=kh;for(Ul=0;Ul<kh&&Hd--;){ot(eo);var n0=r0[0+(127&U(eo))];Q(eo,eo.u+n0.g);var ka=n0.value;if(16>ka)e0[Ul++]=ka,ka!=0&&(i0=ka);else{var Gw=ka==16,s0=ka-16,Xw=gw[s0],o0=xt(eo,pw[s0])+Xw;if(Ul+o0>kh)break r;for(var $w=Gw?i0:0;0<o0--;)e0[Ul++]=$w}}Ud=1;break r}Ud||(t0.a=3),Sh=Ud}(Sh=Sh&&!to.h)&&(zd=N(qw,zw,8,Hl,qd)),Sh&&zd!=0?Ch=zd:(_h.a=3,Ch=0)}if(Ch==0)break i;if(ks&&mw[he]==1&&(ks=Fr[Ae].g==0),Ro+=Fr[Ae].g,Ae+=Ch,3>=he){var Wl,Wd=Sr[0];for(Wl=1;Wl<Ii;++Wl)Sr[Wl]>Wd&&(Wd=Sr[Wl]);Wi+=Wd}}if(Ye.nd=ks,Ye.Qb=0,ks&&(Ye.qb=(Br[3][wn[3]+0].value<<24|Br[1][wn[1]+0].value<<16|Br[2][wn[2]+0].value)>>>0,Ro==0&&256>Br[0][wn[0]+0].value&&(Ye.Qb=1,Ye.qb+=Br[0][wn[0]+0].value<<8)),Ye.jc=!Ye.Qb&&6>Wi,Ye.jc){var Ah,As=Ye;for(Ah=0;Ah<jo;++Ah){var io=Ah,ro=As.pd[io],Lh=As.G[0][As.H[0]+io];256<=Lh.value?(ro.g=Lh.g+256,ro.value=Lh.value):(ro.g=0,ro.value=0,io>>=ji(Lh,8,ro),io>>=ji(As.G[1][As.H[1]+io],16,ro),io>>=ji(As.G[2][As.H[2]+io],0,ro),ji(As.G[3][As.H[3]+io],24,ro))}}}Mi.vc=Ee,Mi.Wb=Fe,Mi.Ya=jr,Mi.yc=Mr,Et=1;break e}Et=0}if(!(k=Et)){w.a=3;break t}if(0<ct){if(F.ua=1<<ct,!j(F.Wa,ct)){w.a=1,k=0;break t}}else F.ua=0;var Vd=w,a0=A,Kw=P,Yd=Vd.s,Gd=Yd.xc;if(Vd.c=a0,Vd.i=Kw,Yd.md=Ct(a0,Gd),Yd.wc=Gd==0?-1:(1<<Gd)-1,v){w.xb=Lw;break t}if((K=s(A*P))==null){w.a=1,k=0;break t}k=(k=fn(w,K,0,A,P,P,null))&&!D.h;break t}return k?(C!=null?C[0]=K:(t(K==null),t(v)),w.$=0,v||Jr(F)):Jr(F),k}function ko(u,d){var v=u.c*u.i,w=v+d+16*d;return t(u.c<=d),u.V=s(w),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+v+d,1)}function fa(u,d){var v=u.C,w=d-v,C=u.V,k=u.Ba+u.c*v;for(t(d<=u.l.o);0<w;){var A=16<w?16:w,P=u.l.ma,D=u.l.width,F=D*A,K=P.ca,ct=P.tb+D*v,B=u.Ta,tt=u.Ua;So(u,A,C,k),Dg(B,tt,K,ct,F),Mn(P,v,v+A,K,ct,D),w-=A,C+=A*u.c,v+=A}t(v==d),u.C=u.Ma=d}function pa(){this.ub=this.yd=this.td=this.Rb=0}function ga(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function md(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function vl(){this.Yb=(function(){var u=[];return(function d(v,w,C){for(var k=C[w],A=0;A<k&&(v.push(C.length>w+1?[]:0),!(C.length<w+1));A++)d(v[A],w+1,C)})(u,0,[3,11]),u})()}function Yc(){this.jb=s(3),this.Wc=a([4,8],vl),this.Xc=a([4,17],vl)}function Gc(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Qr(){this.ld=this.La=this.dd=this.tc=0}function wl(){this.Na=this.la=0}function Xc(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function bl(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function $c(){this.uc=this.M=this.Nb=0,this.wa=Array(new Qr),this.Y=0,this.ya=Array(new bl),this.aa=0,this.l=new ma}function Kc(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Zc(){this.cb=this.a=0,this.sc="",this.m=new T,this.Od=new pa,this.Kc=new ga,this.ed=new Gc,this.Qa=new md,this.Ic=this.$c=this.Aa=0,this.D=new $c,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,T),this.ia=0,this.pb=o(4,Xc),this.Pa=new Yc,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Kc),this.Hd=0,this.rb=Array(new wl),this.sb=0,this.wa=Array(new Qr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new bl),this.L=this.aa=0,this.gd=a([4,2],Qr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function jn(u,d){return 0>u?0:u>d?d:u}function ma(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function vd(){var u=new Zc;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,ql||(ql=va)),u}function _i(u,d,v){return u.a==0&&(u.a=d,u.sc=v,u.cb=0),0}function Jc(u,d,v){return 3<=v&&u[d+0]==157&&u[d+1]==1&&u[d+2]==42}function Fn(u,d){if(u==null)return 0;if(u.a=0,u.sc="OK",d==null)return _i(u,2,"null VP8Io passed to VP8GetHeaders()");var v=d.data,w=d.w,C=d.ha;if(4>C)return _i(u,7,"Truncated header.");var k=v[w+0]|v[w+1]<<8|v[w+2]<<16,A=u.Od;if(A.Rb=!(1&k),A.td=k>>1&7,A.yd=k>>4&1,A.ub=k>>5,3<A.td)return _i(u,3,"Incorrect keyframe parameters.");if(!A.yd)return _i(u,4,"Frame not displayable.");w+=3,C-=3;var P=u.Kc;if(A.Rb){if(7>C)return _i(u,7,"cannot parse picture header");if(!Jc(v,w,C))return _i(u,3,"Bad code word");P.c=16383&(v[w+4]<<8|v[w+3]),P.Td=v[w+4]>>6,P.i=16383&(v[w+6]<<8|v[w+5]),P.Ud=v[w+6]>>6,w+=7,C-=7,u.za=P.c+15>>4,u.Ub=P.i+15>>4,d.width=P.c,d.height=P.i,d.Da=0,d.j=0,d.v=0,d.va=d.width,d.o=d.height,d.da=0,d.ib=d.width,d.hb=d.height,d.U=d.width,d.T=d.height,n((k=u.Pa).jb,0,255,k.jb.length),t((k=u.Qa)!=null),k.Cb=0,k.Bb=0,k.Fb=1,n(k.Zb,0,0,k.Zb.length),n(k.Lb,0,0,k.Lb)}if(A.ub>C)return _i(u,7,"bad partition length");lt(k=u.m,v,w,A.ub),w+=A.ub,C-=A.ub,A.Rb&&(P.Ld=pt(k),P.Kd=pt(k)),P=u.Qa;var D,F=u.Pa;if(t(k!=null),t(P!=null),P.Cb=pt(k),P.Cb){if(P.Bb=pt(k),pt(k)){for(P.Fb=pt(k),D=0;4>D;++D)P.Zb[D]=pt(k)?et(k,7):0;for(D=0;4>D;++D)P.Lb[D]=pt(k)?et(k,6):0}if(P.Bb)for(D=0;3>D;++D)F.jb[D]=pt(k)?ht(k,8):255}else P.Bb=0;if(k.Ka)return _i(u,3,"cannot parse segment header");if((P=u.ed).zd=pt(k),P.Tb=ht(k,6),P.wb=ht(k,3),P.Pc=pt(k),P.Pc&&pt(k)){for(F=0;4>F;++F)pt(k)&&(P.vd[F]=et(k,6));for(F=0;4>F;++F)pt(k)&&(P.od[F]=et(k,6))}if(u.L=P.Tb==0?0:P.zd?1:2,k.Ka)return _i(u,3,"cannot parse filter header");var K=C;if(C=D=w,w=D+K,P=K,u.Xb=(1<<ht(u.m,2))-1,K<3*(F=u.Xb))v=7;else{for(D+=3*F,P-=3*F,K=0;K<F;++K){var ct=v[C+0]|v[C+1]<<8|v[C+2]<<16;ct>P&&(ct=P),lt(u.Jc[+K],v,D,ct),D+=ct,P-=ct,C+=3}lt(u.Jc[+F],v,D,P),v=D<w?0:5}if(v!=0)return _i(u,v,"cannot parse partitions");for(v=ht(D=u.m,7),C=pt(D)?et(D,4):0,w=pt(D)?et(D,4):0,P=pt(D)?et(D,4):0,F=pt(D)?et(D,4):0,D=pt(D)?et(D,4):0,K=u.Qa,ct=0;4>ct;++ct){if(K.Cb){var B=K.Zb[ct];K.Fb||(B+=v)}else{if(0<ct){u.pb[ct]=u.pb[0];continue}B=v}var tt=u.pb[ct];tt.Sc[0]=Fd[jn(B+C,127)],tt.Sc[1]=Bd[jn(B+0,127)],tt.Eb[0]=2*Fd[jn(B+w,127)],tt.Eb[1]=101581*Bd[jn(B+P,127)]>>16,8>tt.Eb[1]&&(tt.Eb[1]=8),tt.Qc[0]=Fd[jn(B+F,117)],tt.Qc[1]=Bd[jn(B+D,127)],tt.lc=B+D}if(!A.Rb)return _i(u,4,"Not a key frame.");for(pt(k),A=u.Pa,v=0;4>v;++v){for(C=0;8>C;++C)for(w=0;3>w;++w)for(P=0;11>P;++P)F=vt(k,kw[v][C][w][P])?ht(k,8):Sw[v][C][w][P],A.Wc[v][C].Yb[w][P]=F;for(C=0;17>C;++C)A.Xc[v][C]=A.Wc[v][Aw[C]]}return u.kc=pt(k),u.kc&&(u.Bd=ht(k,8)),u.cb=1}function va(u,d,v,w,C,k,A){var P=d[C].Yb[v];for(v=0;16>C;++C){if(!vt(u,P[v+0]))return C;for(;!vt(u,P[v+1]);)if(P=d[++C].Yb[0],v=0,C==16)return 16;var D=d[C+1].Yb;if(vt(u,P[v+2])){var F=u,K=0;if(vt(F,(B=P)[(ct=v)+3]))if(vt(F,B[ct+6])){for(P=0,ct=2*(K=vt(F,B[ct+8]))+(B=vt(F,B[ct+9+K])),K=0,B=xw[ct];B[P];++P)K+=K+vt(F,B[P]);K+=3+(8<<ct)}else vt(F,B[ct+7])?(K=7+2*vt(F,165),K+=vt(F,145)):K=5+vt(F,159);else K=vt(F,B[ct+4])?3+vt(F,B[ct+5]):2;P=D[2]}else K=1,P=D[1];D=A+_w[C],0>(F=u).b&&ft(F);var ct,B=F.b,tt=(ct=F.Ca>>1)-(F.I>>B)>>31;--F.b,F.Ca+=tt,F.Ca|=1,F.I-=(ct+1&tt)<<B,k[D]=((K^tt)-tt)*w[(0<C)+0]}return 16}function Qc(u){var d=u.rb[u.sb-1];d.la=0,d.Na=0,n(u.zc,0,0,u.zc.length),u.ja=0}function tn(u,d,v,w,C){C=u[d+v+32*w]+(C>>3),u[d+v+32*w]=-256&C?0>C?0:255:C}function Oi(u,d,v,w,C,k){tn(u,d,0,v,w+C),tn(u,d,1,v,w+k),tn(u,d,2,v,w-k),tn(u,d,3,v,w-C)}function ds(u){return(20091*u>>16)+u}function th(u,d,v,w){var C,k=0,A=s(16);for(C=0;4>C;++C){var P=u[d+0]+u[d+8],D=u[d+0]-u[d+8],F=(35468*u[d+4]>>16)-ds(u[d+12]),K=ds(u[d+4])+(35468*u[d+12]>>16);A[k+0]=P+K,A[k+1]=D+F,A[k+2]=D-F,A[k+3]=P-K,k+=4,d++}for(C=k=0;4>C;++C)P=(u=A[k+0]+4)+A[k+8],D=u-A[k+8],F=(35468*A[k+4]>>16)-ds(A[k+12]),tn(v,w,0,0,P+(K=ds(A[k+4])+(35468*A[k+12]>>16))),tn(v,w,1,0,D+F),tn(v,w,2,0,D-F),tn(v,w,3,0,P-K),k++,w+=32}function wd(u,d,v,w){var C=u[d+0]+4,k=35468*u[d+4]>>16,A=ds(u[d+4]),P=35468*u[d+1]>>16;Oi(v,w,0,C+A,u=ds(u[d+1]),P),Oi(v,w,1,C+k,u,P),Oi(v,w,2,C-k,u,P),Oi(v,w,3,C-A,u,P)}function bd(u,d,v,w,C){th(u,d,v,w),C&&th(u,d+16,v,w+4)}function Bn(u,d,v,w){Bo(u,d+0,v,w,1),Bo(u,d+32,v,w+128,1)}function eh(u,d,v,w){var C;for(u=u[d+0]+4,C=0;4>C;++C)for(d=0;4>d;++d)tn(v,w,d,C,u)}function ih(u,d,v,w){u[d+0]&&Ie(u,d+0,v,w),u[d+16]&&Ie(u,d+16,v,w+4),u[d+32]&&Ie(u,d+32,v,w+128),u[d+48]&&Ie(u,d+48,v,w+128+4)}function wa(u,d,v,w){var C,k=s(16);for(C=0;4>C;++C){var A=u[d+0+C]+u[d+12+C],P=u[d+4+C]+u[d+8+C],D=u[d+4+C]-u[d+8+C],F=u[d+0+C]-u[d+12+C];k[0+C]=A+P,k[8+C]=A-P,k[4+C]=F+D,k[12+C]=F-D}for(C=0;4>C;++C)A=(u=k[0+4*C]+3)+k[3+4*C],P=k[1+4*C]+k[2+4*C],D=k[1+4*C]-k[2+4*C],F=u-k[3+4*C],v[w+0]=A+P>>3,v[w+16]=F+D>>3,v[w+32]=A-P>>3,v[w+48]=F-D>>3,w+=64}function Ao(u,d,v){var w,C=d-32,k=Dr,A=255-u[C-1];for(w=0;w<v;++w){var P,D=k,F=A+u[d-1];for(P=0;P<v;++P)u[d+P]=D[F+u[C+P]];d+=32}}function yd(u,d){Ao(u,d,4)}function xd(u,d){Ao(u,d,8)}function _d(u,d){Ao(u,d,16)}function yl(u,d){var v;for(v=0;16>v;++v)i(u,d+32*v,u,d-32,16)}function rh(u,d){var v;for(v=16;0<v;--v)n(u,d,u[d-1],16),d+=32}function pn(u,d,v){var w;for(w=0;16>w;++w)n(d,v+32*w,u,16)}function Sd(u,d){var v,w=16;for(v=0;16>v;++v)w+=u[d-1+32*v]+u[d+v-32];pn(w>>5,u,d)}function Lo(u,d){var v,w=8;for(v=0;16>v;++v)w+=u[d-1+32*v];pn(w>>4,u,d)}function xl(u,d){var v,w=8;for(v=0;16>v;++v)w+=u[d+v-32];pn(w>>4,u,d)}function Cd(u,d){pn(128,u,d)}function se(u,d,v){return u+2*d+v+2>>2}function kd(u,d){var v,w=d-32;for(w=new Uint8Array([se(u[w-1],u[w+0],u[w+1]),se(u[w+0],u[w+1],u[w+2]),se(u[w+1],u[w+2],u[w+3]),se(u[w+2],u[w+3],u[w+4])]),v=0;4>v;++v)i(u,d+32*v,w,0,w.length)}function Ad(u,d){var v=u[d-1],w=u[d-1+32],C=u[d-1+64],k=u[d-1+96];Lt(u,d+0,16843009*se(u[d-1-32],v,w)),Lt(u,d+32,16843009*se(v,w,C)),Lt(u,d+64,16843009*se(w,C,k)),Lt(u,d+96,16843009*se(C,k,k))}function Ld(u,d){var v,w=4;for(v=0;4>v;++v)w+=u[d+v-32]+u[d-1+32*v];for(w>>=3,v=0;4>v;++v)n(u,d+32*v,w,4)}function fs(u,d){var v=u[d-1+0],w=u[d-1+32],C=u[d-1+64],k=u[d-1-32],A=u[d+0-32],P=u[d+1-32],D=u[d+2-32],F=u[d+3-32];u[d+0+96]=se(w,C,u[d-1+96]),u[d+1+96]=u[d+0+64]=se(v,w,C),u[d+2+96]=u[d+1+64]=u[d+0+32]=se(k,v,w),u[d+3+96]=u[d+2+64]=u[d+1+32]=u[d+0+0]=se(A,k,v),u[d+3+64]=u[d+2+32]=u[d+1+0]=se(P,A,k),u[d+3+32]=u[d+2+0]=se(D,P,A),u[d+3+0]=se(F,D,P)}function ps(u,d){var v=u[d+1-32],w=u[d+2-32],C=u[d+3-32],k=u[d+4-32],A=u[d+5-32],P=u[d+6-32],D=u[d+7-32];u[d+0+0]=se(u[d+0-32],v,w),u[d+1+0]=u[d+0+32]=se(v,w,C),u[d+2+0]=u[d+1+32]=u[d+0+64]=se(w,C,k),u[d+3+0]=u[d+2+32]=u[d+1+64]=u[d+0+96]=se(C,k,A),u[d+3+32]=u[d+2+64]=u[d+1+96]=se(k,A,P),u[d+3+64]=u[d+2+96]=se(A,P,D),u[d+3+96]=se(P,D,D)}function Td(u,d){var v=u[d-1+0],w=u[d-1+32],C=u[d-1+64],k=u[d-1-32],A=u[d+0-32],P=u[d+1-32],D=u[d+2-32],F=u[d+3-32];u[d+0+0]=u[d+1+64]=k+A+1>>1,u[d+1+0]=u[d+2+64]=A+P+1>>1,u[d+2+0]=u[d+3+64]=P+D+1>>1,u[d+3+0]=D+F+1>>1,u[d+0+96]=se(C,w,v),u[d+0+64]=se(w,v,k),u[d+0+32]=u[d+1+96]=se(v,k,A),u[d+1+32]=u[d+2+96]=se(k,A,P),u[d+2+32]=u[d+3+96]=se(A,P,D),u[d+3+32]=se(P,D,F)}function Ed(u,d){var v=u[d+0-32],w=u[d+1-32],C=u[d+2-32],k=u[d+3-32],A=u[d+4-32],P=u[d+5-32],D=u[d+6-32],F=u[d+7-32];u[d+0+0]=v+w+1>>1,u[d+1+0]=u[d+0+64]=w+C+1>>1,u[d+2+0]=u[d+1+64]=C+k+1>>1,u[d+3+0]=u[d+2+64]=k+A+1>>1,u[d+0+32]=se(v,w,C),u[d+1+32]=u[d+0+96]=se(w,C,k),u[d+2+32]=u[d+1+96]=se(C,k,A),u[d+3+32]=u[d+2+96]=se(k,A,P),u[d+3+64]=se(A,P,D),u[d+3+96]=se(P,D,F)}function ba(u,d){var v=u[d-1+0],w=u[d-1+32],C=u[d-1+64],k=u[d-1+96];u[d+0+0]=v+w+1>>1,u[d+2+0]=u[d+0+32]=w+C+1>>1,u[d+2+32]=u[d+0+64]=C+k+1>>1,u[d+1+0]=se(v,w,C),u[d+3+0]=u[d+1+32]=se(w,C,k),u[d+3+32]=u[d+1+64]=se(C,k,k),u[d+3+64]=u[d+2+64]=u[d+0+96]=u[d+1+96]=u[d+2+96]=u[d+3+96]=k}function _l(u,d){var v=u[d-1+0],w=u[d-1+32],C=u[d-1+64],k=u[d-1+96],A=u[d-1-32],P=u[d+0-32],D=u[d+1-32],F=u[d+2-32];u[d+0+0]=u[d+2+32]=v+A+1>>1,u[d+0+32]=u[d+2+64]=w+v+1>>1,u[d+0+64]=u[d+2+96]=C+w+1>>1,u[d+0+96]=k+C+1>>1,u[d+3+0]=se(P,D,F),u[d+2+0]=se(A,P,D),u[d+1+0]=u[d+3+32]=se(v,A,P),u[d+1+32]=u[d+3+64]=se(w,v,A),u[d+1+64]=u[d+3+96]=se(C,w,v),u[d+1+96]=se(k,C,w)}function To(u,d){var v;for(v=0;8>v;++v)i(u,d+32*v,u,d-32,8)}function Od(u,d){var v;for(v=0;8>v;++v)n(u,d,u[d-1],8),d+=32}function gs(u,d,v){var w;for(w=0;8>w;++w)n(d,v+32*w,u,8)}function Pd(u,d){var v,w=8;for(v=0;8>v;++v)w+=u[d+v-32]+u[d-1+32*v];gs(w>>4,u,d)}function Sl(u,d){var v,w=4;for(v=0;8>v;++v)w+=u[d+v-32];gs(w>>3,u,d)}function Cl(u,d){var v,w=4;for(v=0;8>v;++v)w+=u[d-1+32*v];gs(w>>3,u,d)}function nh(u,d){gs(128,u,d)}function ms(u,d,v){var w=u[d-v],C=u[d+0],k=3*(C-w)+Nd[1020+u[d-2*v]-u[d+v]],A=dh[112+(k+4>>3)];u[d-v]=Dr[255+w+dh[112+(k+3>>3)]],u[d+0]=Dr[255+C-A]}function kl(u,d,v,w){var C=u[d+0],k=u[d+v];return nn[255+u[d-2*v]-u[d-v]]>w||nn[255+k-C]>w}function ya(u,d,v,w){return 4*nn[255+u[d-v]-u[d+0]]+nn[255+u[d-2*v]-u[d+v]]<=w}function Al(u,d,v,w,C){var k=u[d-3*v],A=u[d-2*v],P=u[d-v],D=u[d+0],F=u[d+v],K=u[d+2*v],ct=u[d+3*v];return 4*nn[255+P-D]+nn[255+A-F]>w?0:nn[255+u[d-4*v]-k]<=C&&nn[255+k-A]<=C&&nn[255+A-P]<=C&&nn[255+ct-K]<=C&&nn[255+K-F]<=C&&nn[255+F-D]<=C}function Eo(u,d,v,w){var C=2*w+1;for(w=0;16>w;++w)ya(u,d+w,v,C)&&ms(u,d+w,v)}function Ll(u,d,v,w){var C=2*w+1;for(w=0;16>w;++w)ya(u,d+w*v,1,C)&&ms(u,d+w*v,1)}function sh(u,d,v,w){var C;for(C=3;0<C;--C)Eo(u,d+=4*v,v,w)}function oh(u,d,v,w){var C;for(C=3;0<C;--C)Ll(u,d+=4,v,w)}function vs(u,d,v,w,C,k,A,P){for(k=2*k+1;0<C--;){if(Al(u,d,v,k,A))if(kl(u,d,v,P))ms(u,d,v);else{var D=u,F=d,K=v,ct=D[F-2*K],B=D[F-K],tt=D[F+0],rt=D[F+K],mt=D[F+2*K],at=27*(yt=Nd[1020+3*(tt-B)+Nd[1020+ct-rt]])+63>>7,wt=18*yt+63>>7,yt=9*yt+63>>7;D[F-3*K]=Dr[255+D[F-3*K]+yt],D[F-2*K]=Dr[255+ct+wt],D[F-K]=Dr[255+B+at],D[F+0]=Dr[255+tt-at],D[F+K]=Dr[255+rt-wt],D[F+2*K]=Dr[255+mt-yt]}d+=w}}function ws(u,d,v,w,C,k,A,P){for(k=2*k+1;0<C--;){if(Al(u,d,v,k,A))if(kl(u,d,v,P))ms(u,d,v);else{var D=u,F=d,K=v,ct=D[F-K],B=D[F+0],tt=D[F+K],rt=dh[112+(4+(mt=3*(B-ct))>>3)],mt=dh[112+(mt+3>>3)],at=rt+1>>1;D[F-2*K]=Dr[255+D[F-2*K]+at],D[F-K]=Dr[255+ct+mt],D[F+0]=Dr[255+B-rt],D[F+K]=Dr[255+tt-at]}d+=w}}function ah(u,d,v,w,C,k){vs(u,d,v,1,16,w,C,k)}function Oo(u,d,v,w,C,k){vs(u,d,1,v,16,w,C,k)}function lh(u,d,v,w,C,k){var A;for(A=3;0<A;--A)ws(u,d+=4*v,v,1,16,w,C,k)}function g(u,d,v,w,C,k){var A;for(A=3;0<A;--A)ws(u,d+=4,1,v,16,w,C,k)}function S(u,d,v,w,C,k,A,P){vs(u,d,C,1,8,k,A,P),vs(v,w,C,1,8,k,A,P)}function R(u,d,v,w,C,k,A,P){vs(u,d,1,C,8,k,A,P),vs(v,w,1,C,8,k,A,P)}function Y(u,d,v,w,C,k,A,P){ws(u,d+4*C,C,1,8,k,A,P),ws(v,w+4*C,C,1,8,k,A,P)}function it(u,d,v,w,C,k,A,P){ws(u,d+4,1,C,8,k,A,P),ws(v,w+4,1,C,8,k,A,P)}function bt(){this.ba=new be,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Me,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function _t(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ft(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function zt(){this.ua=0,this.Wa=new me,this.vb=new me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new st,this.yc=new H}function ne(){this.xb=this.a=0,this.l=new ma,this.ca=new be,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new q,this.Pb=0,this.wd=new q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new zt,this.ab=0,this.gc=o(4,Ft),this.Oc=0}function fe(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ma,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Te(u,d,v,w,C,k,A){for(u=u==null?0:u[d+0],d=0;d<A;++d)C[k+d]=u+v[w+d]&255,u=C[k+d]}function ei(u,d,v,w,C,k,A){var P;if(u==null)Te(null,null,v,w,C,k,A);else for(P=0;P<A;++P)C[k+P]=u[d+P]+v[w+P]&255}function Si(u,d,v,w,C,k,A){if(u==null)Te(null,null,v,w,C,k,A);else{var P,D=u[d+0],F=D,K=D;for(P=0;P<A;++P)F=K+(D=u[d+P])-F,K=v[w+P]+(-256&F?0>F?0:255:F)&255,F=D,C[k+P]=K}}function Ve(u,d,v,w){var C=d.width,k=d.o;if(t(u!=null&&d!=null),0>v||0>=w||v+w>k)return null;if(!u.Cc){if(u.ga==null){var A;if(u.ga=new fe,(A=u.ga==null)||(A=d.width*d.o,t(u.Gb.length==0),u.Gb=s(A),u.Uc=0,u.Gb==null?A=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,A=1),A=!A),!A){A=u.ga;var P=u.Fa,D=u.P,F=u.qc,K=u.mb,ct=u.nb,B=D+1,tt=F-1,rt=A.l;if(t(P!=null&&K!=null&&d!=null),Qs[0]=null,Qs[1]=Te,Qs[2]=ei,Qs[3]=Si,A.ca=K,A.tb=ct,A.c=d.width,A.i=d.height,t(0<A.c&&0<A.i),1>=F)d=0;else if(A.$a=3&P[D+0],A.Z=P[D+0]>>2&3,A.Lc=P[D+0]>>4&3,D=P[D+0]>>6&3,0>A.$a||1<A.$a||4<=A.Z||1<A.Lc||D)d=0;else if(rt.put=Qt,rt.ac=Dn,rt.bc=hs,rt.ma=A,rt.width=d.width,rt.height=d.height,rt.Da=d.Da,rt.v=d.v,rt.va=d.va,rt.j=d.j,rt.o=d.o,A.$a)t:{t(A.$a==1),d=Co();e:for(;;){if(d==null){d=0;break t}if(t(A!=null),A.mc=d,d.c=A.c,d.i=A.i,d.l=A.l,d.l.ma=A,d.l.width=A.c,d.l.height=A.i,d.a=0,dt(d.m,P,B,tt),!In(A.c,A.i,1,d,null)||(d.ab==1&&d.gc[0].hc==3&&un(d.s)?(A.ic=1,P=d.c*d.i,d.Ta=null,d.Ua=0,d.V=s(P),d.Ba=0,d.V==null?(d.a=1,d=0):d=1):(A.ic=0,d=ko(d,A.c)),!d))break e;d=1;break t}A.mc=null,d=0}else d=tt>=A.c*A.i;A=!d}if(A)return null;u.ga.Lc!=1?u.Ga=0:w=k-v}t(u.ga!=null),t(v+w<=k);t:{if(d=(P=u.ga).c,k=P.l.o,P.$a==0){if(B=u.rc,tt=u.Vc,rt=u.Fa,D=u.P+1+v*d,F=u.mb,K=u.nb+v*d,t(D<=u.P+u.qc),P.Z!=0)for(t(Qs[P.Z]!=null),A=0;A<w;++A)Qs[P.Z](B,tt,rt,D,F,K,d),B=F,tt=K,K+=d,D+=d;else for(A=0;A<w;++A)i(F,K,rt,D,d),B=F,tt=K,K+=d,D+=d;u.rc=B,u.Vc=tt}else{if(t(P.mc!=null),d=v+w,t((A=P.mc)!=null),t(d<=A.i),A.C>=d)d=1;else if(P.ic||gn(),P.ic){P=A.V,B=A.Ba,tt=A.c;var mt=A.i,at=(rt=1,D=A.$/tt,F=A.$%tt,K=A.m,ct=A.s,A.$),wt=tt*mt,yt=tt*d,At=ct.wc,St=at<yt?Ri(ct,F,D):null;t(at<=wt),t(d<=mt),t(un(ct));e:for(;;){for(;!K.h&&at<yt;){if(F&At||(St=Ri(ct,F,D)),t(St!=null),ot(K),256>(mt=ni(St.G[0],St.H[0],K)))P[B+at]=mt,++at,++F>=tt&&(F=0,++D<=d&&!(D%16)&&dn(A,D));else{if(!(280>mt)){rt=0;break e}mt=Kr(mt-256,K);var Ht,Mt=ni(St.G[4],St.H[4],K);if(ot(K),!(at>=(Mt=Zr(tt,Mt=Kr(Mt,K)))&&wt-at>=mt)){rt=0;break e}for(Ht=0;Ht<mt;++Ht)P[B+at+Ht]=P[B+at+Ht-Mt];for(at+=mt,F+=mt;F>=tt;)F-=tt,++D<=d&&!(D%16)&&dn(A,D);at<yt&&F&At&&(St=Ri(ct,F,D))}t(K.h==X(K))}dn(A,D>d?d:D);break e}!rt||K.h&&at<wt?(rt=0,A.a=K.h?5:3):A.$=at,d=rt}else d=fn(A,A.V,A.Ba,A.c,A.i,d,fa);if(!d){w=0;break t}}v+w>=k&&(u.Cc=1),w=1}if(!w)return null;if(u.Cc&&((w=u.ga)!=null&&(w.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+v*C}function Pi(u,d,v,w,C,k){for(;0<C--;){var A,P=u,D=d+(v?1:0),F=u,K=d+(v?0:3);for(A=0;A<w;++A){var ct=F[K+4*A];ct!=255&&(ct*=32897,P[D+4*A+0]=P[D+4*A+0]*ct>>23,P[D+4*A+1]=P[D+4*A+1]*ct>>23,P[D+4*A+2]=P[D+4*A+2]*ct>>23)}d+=k}}function Ci(u,d,v,w,C){for(;0<w--;){var k;for(k=0;k<v;++k){var A=u[d+2*k+0],P=15&(F=u[d+2*k+1]),D=4369*P,F=(240&F|F>>4)*D>>16;u[d+2*k+0]=(240&A|A>>4)*D>>16&240|(15&A|A<<4)*D>>16>>4&15,u[d+2*k+1]=240&F|P}d+=C}}function qi(u,d,v,w,C,k,A,P){var D,F,K=255;for(F=0;F<C;++F){for(D=0;D<w;++D){var ct=u[d+D];k[A+4*D]=ct,K&=ct}d+=v,A+=P}return K!=255}function bs(u,d,v,w,C){var k;for(k=0;k<C;++k)v[w+k]=u[d+k]>>8}function gn(){Rl=Pi,Pg=Ci,Ng=qi,Dg=bs}function ys(u,d,v){M[u]=function(w,C,k,A,P,D,F,K,ct,B,tt,rt,mt,at,wt,yt,At){var St,Ht=At-1>>1,Mt=P[D+0]|F[K+0]<<16,pe=ct[B+0]|tt[rt+0]<<16;t(w!=null);var Bt=3*Mt+pe+131074>>2;for(d(w[C+0],255&Bt,Bt>>16,mt,at),k!=null&&(Bt=3*pe+Mt+131074>>2,d(k[A+0],255&Bt,Bt>>16,wt,yt)),St=1;St<=Ht;++St){var Ce=P[D+St]|F[K+St]<<16,Di=ct[B+St]|tt[rt+St]<<16,ge=Mt+Ce+pe+Di+524296,Rt=ge+2*(Ce+pe)>>3;Bt=Rt+Mt>>1,Mt=(ge=ge+2*(Mt+Di)>>3)+Ce>>1,d(w[C+2*St-1],255&Bt,Bt>>16,mt,at+(2*St-1)*v),d(w[C+2*St-0],255&Mt,Mt>>16,mt,at+(2*St-0)*v),k!=null&&(Bt=ge+pe>>1,Mt=Rt+Di>>1,d(k[A+2*St-1],255&Bt,Bt>>16,wt,yt+(2*St-1)*v),d(k[A+2*St+0],255&Mt,Mt>>16,wt,yt+(2*St+0)*v)),Mt=Ce,pe=Di}1&At||(Bt=3*Mt+pe+131074>>2,d(w[C+At-1],255&Bt,Bt>>16,mt,at+(At-1)*v),k!=null&&(Bt=3*pe+Mt+131074>>2,d(k[A+At-1],255&Bt,Bt>>16,wt,yt+(At-1)*v)))}}function Tl(){sn[fh]=Tw,sn[ph]=Wg,sn[Rg]=Ew,sn[gh]=Vg,sn[mh]=Yg,sn[Dd]=Gg,sn[qg]=Ow,sn[Md]=Wg,sn[Id]=Vg,sn[vh]=Yg,sn[jd]=Gg}function xa(u){return u&-16384?0>u?0:255:u>>Pw}function Us(u,d){return xa((19077*u>>8)+(26149*d>>8)-14234)}function Po(u,d,v){return xa((19077*u>>8)-(6419*d>>8)-(13320*v>>8)+8708)}function No(u,d){return xa((19077*u>>8)+(33050*d>>8)-17685)}function Ws(u,d,v,w,C){w[C+0]=Us(u,v),w[C+1]=Po(u,d,v),w[C+2]=No(u,d)}function zi(u,d,v,w,C){w[C+0]=No(u,d),w[C+1]=Po(u,d,v),w[C+2]=Us(u,v)}function Do(u,d,v,w,C){var k=Po(u,d,v);d=k<<3&224|No(u,d)>>3,w[C+0]=248&Us(u,v)|k>>5,w[C+1]=d}function Mo(u,d,v,w,C){var k=240&No(u,d)|15;w[C+0]=240&Us(u,v)|Po(u,d,v)>>4,w[C+1]=k}function El(u,d,v,w,C){w[C+0]=255,Ws(u,d,v,w,C+1)}function Ol(u,d,v,w,C){zi(u,d,v,w,C),w[C+3]=255}function or(u,d,v,w,C){Ws(u,d,v,w,C),w[C+3]=255}function xs(u,d,v){M[u]=function(w,C,k,A,P,D,F,K,ct){for(var B=K+(-2&ct)*v;K!=B;)d(w[C+0],k[A+0],P[D+0],F,K),d(w[C+1],k[A+0],P[D+0],F,K+v),C+=2,++A,++D,K+=2*v;1&ct&&d(w[C+0],k[A+0],P[D+0],F,K)}}function _a(u,d,v){return v==0?u==0?d==0?6:5:d==0?4:0:v}function ch(u,d,v,w,C){switch(u>>>30){case 3:Bo(d,v,w,C,0);break;case 2:rn(d,v,w,C);break;case 1:Ie(d,v,w,C)}}function en(u,d){var v,w,C=d.M,k=d.Nb,A=u.oc,P=u.pc+40,D=u.oc,F=u.pc+584,K=u.oc,ct=u.pc+600;for(v=0;16>v;++v)A[P+32*v-1]=129;for(v=0;8>v;++v)D[F+32*v-1]=129,K[ct+32*v-1]=129;for(0<C?A[P-1-32]=D[F-1-32]=K[ct-1-32]=129:(n(A,P-32-1,127,21),n(D,F-32-1,127,9),n(K,ct-32-1,127,9)),w=0;w<u.za;++w){var B=d.ya[d.aa+w];if(0<w){for(v=-1;16>v;++v)i(A,P+32*v-4,A,P+32*v+12,4);for(v=-1;8>v;++v)i(D,F+32*v-4,D,F+32*v+4,4),i(K,ct+32*v-4,K,ct+32*v+4,4)}var tt=u.Gd,rt=u.Hd+w,mt=B.ad,at=B.Hc;if(0<C&&(i(A,P-32,tt[rt].y,0,16),i(D,F-32,tt[rt].f,0,8),i(K,ct-32,tt[rt].ea,0,8)),B.Za){var wt=A,yt=P-32+16;for(0<C&&(w>=u.za-1?n(wt,yt,tt[rt].y[15],4):i(wt,yt,tt[rt+1].y,0,4)),v=0;4>v;v++)wt[yt+128+v]=wt[yt+256+v]=wt[yt+384+v]=wt[yt+0+v];for(v=0;16>v;++v,at<<=2)wt=A,yt=P+$g[v],mn[B.Ob[v]](wt,yt),ch(at,mt,16*+v,wt,yt)}else if(wt=_a(w,C,B.Ob[0]),Js[wt](A,P),at!=0)for(v=0;16>v;++v,at<<=2)ch(at,mt,16*+v,A,P+$g[v]);for(v=B.Gc,wt=_a(w,C,B.Dd),Cs[wt](D,F),Cs[wt](K,ct),at=mt,wt=D,yt=F,255&(B=0|v)&&(170&B?zn(at,256,wt,yt):qe(at,256,wt,yt)),B=K,at=ct,255&(v>>=8)&&(170&v?zn(mt,320,B,at):qe(mt,320,B,at)),C<u.Ub-1&&(i(tt[rt].y,0,A,P+480,16),i(tt[rt].f,0,D,F+224,8),i(tt[rt].ea,0,K,ct+224,8)),v=8*k*u.B,tt=u.sa,rt=u.ta+16*w+16*k*u.R,mt=u.qa,B=u.ra+8*w+v,at=u.Ha,wt=u.Ia+8*w+v,v=0;16>v;++v)i(tt,rt+v*u.R,A,P+32*v,16);for(v=0;8>v;++v)i(mt,B+v*u.B,D,F+32*v,8),i(at,wt+v*u.B,K,ct+32*v,8)}}function Io(u,d,v,w,C,k,A,P,D){var F=[0],K=[0],ct=0,B=D!=null?D.kd:0,tt=D??new _t;if(u==null||12>v)return 7;tt.data=u,tt.w=d,tt.ha=v,d=[d],v=[v],tt.gb=[tt.gb];t:{var rt=d,mt=v,at=tt.gb;if(t(u!=null),t(mt!=null),t(at!=null),at[0]=0,12<=mt[0]&&!e(u,rt[0],"RIFF")){if(e(u,rt[0]+8,"WEBP")){at=3;break t}var wt=Vt(u,rt[0]+4);if(12>wt||4294967286<wt){at=3;break t}if(B&&wt>mt[0]-8){at=7;break t}at[0]=wt,rt[0]+=12,mt[0]-=12}at=0}if(at!=0)return at;for(wt=0<tt.gb[0],v=v[0];;){t:{var yt=u;mt=d,at=v;var At=F,St=K,Ht=rt=[0];if((Bt=ct=[ct])[0]=0,8>at[0])at=7;else{if(!e(yt,mt[0],"VP8X")){if(Vt(yt,mt[0]+4)!=10){at=3;break t}if(18>at[0]){at=7;break t}var Mt=Vt(yt,mt[0]+8),pe=1+Pt(yt,mt[0]+12);if(2147483648<=pe*(yt=1+Pt(yt,mt[0]+15))){at=3;break t}Ht!=null&&(Ht[0]=Mt),At!=null&&(At[0]=pe),St!=null&&(St[0]=yt),mt[0]+=18,at[0]-=18,Bt[0]=1}at=0}}if(ct=ct[0],rt=rt[0],at!=0)return at;if(mt=!!(2&rt),!wt&&ct)return 3;if(k!=null&&(k[0]=!!(16&rt)),A!=null&&(A[0]=mt),P!=null&&(P[0]=0),A=F[0],rt=K[0],ct&&mt&&D==null){at=0;break}if(4>v){at=7;break}if(wt&&ct||!wt&&!ct&&!e(u,d[0],"ALPH")){v=[v],tt.na=[tt.na],tt.P=[tt.P],tt.Sa=[tt.Sa];t:{Mt=u,at=d,wt=v;var Bt=tt.gb;At=tt.na,St=tt.P,Ht=tt.Sa,pe=22,t(Mt!=null),t(wt!=null),yt=at[0];var Ce=wt[0];for(t(At!=null),t(Ht!=null),At[0]=null,St[0]=null,Ht[0]=0;;){if(at[0]=yt,wt[0]=Ce,8>Ce){at=7;break t}var Di=Vt(Mt,yt+4);if(4294967286<Di){at=3;break t}var ge=8+Di+1&-2;if(pe+=ge,0<Bt&&pe>Bt){at=3;break t}if(!e(Mt,yt,"VP8 ")||!e(Mt,yt,"VP8L")){at=0;break t}if(Ce[0]<ge){at=7;break t}e(Mt,yt,"ALPH")||(At[0]=Mt,St[0]=yt+8,Ht[0]=Di),yt+=ge,Ce-=ge}}if(v=v[0],tt.na=tt.na[0],tt.P=tt.P[0],tt.Sa=tt.Sa[0],at!=0)break}v=[v],tt.Ja=[tt.Ja],tt.xa=[tt.xa];t:if(Bt=u,at=d,wt=v,At=tt.gb[0],St=tt.Ja,Ht=tt.xa,Mt=at[0],yt=!e(Bt,Mt,"VP8 "),pe=!e(Bt,Mt,"VP8L"),t(Bt!=null),t(wt!=null),t(St!=null),t(Ht!=null),8>wt[0])at=7;else{if(yt||pe){if(Bt=Vt(Bt,Mt+4),12<=At&&Bt>At-12){at=3;break t}if(B&&Bt>wt[0]-8){at=7;break t}St[0]=Bt,at[0]+=8,wt[0]-=8,Ht[0]=pe}else Ht[0]=5<=wt[0]&&Bt[Mt+0]==47&&!(Bt[Mt+4]>>5),St[0]=wt[0];at=0}if(v=v[0],tt.Ja=tt.Ja[0],tt.xa=tt.xa[0],d=d[0],at!=0)break;if(4294967286<tt.Ja)return 3;if(P==null||mt||(P[0]=tt.xa?2:1),A=[A],rt=[rt],tt.xa){if(5>v){at=7;break}P=A,B=rt,mt=k,u==null||5>v?u=0:5<=v&&u[d+0]==47&&!(u[d+4]>>5)?(wt=[0],Bt=[0],At=[0],dt(St=new q,u,d,v),us(St,wt,Bt,At)?(P!=null&&(P[0]=wt[0]),B!=null&&(B[0]=Bt[0]),mt!=null&&(mt[0]=At[0]),u=1):u=0):u=0}else{if(10>v){at=7;break}P=rt,u==null||10>v||!Jc(u,d+3,v-3)?u=0:(B=u[d+0]|u[d+1]<<8|u[d+2]<<16,mt=16383&(u[d+7]<<8|u[d+6]),u=16383&(u[d+9]<<8|u[d+8]),1&B||3<(B>>1&7)||!(B>>4&1)||B>>5>=tt.Ja||!mt||!u?u=0:(A&&(A[0]=mt),P&&(P[0]=u),u=1))}if(!u||(A=A[0],rt=rt[0],ct&&(F[0]!=A||K[0]!=rt)))return 3;D!=null&&(D[0]=tt,D.offset=d-D.w,t(4294967286>d-D.w),t(D.offset==D.ha-v));break}return at==0||at==7&&ct&&D==null?(k!=null&&(k[0]|=tt.na!=null&&0<tt.na.length),w!=null&&(w[0]=A),C!=null&&(C[0]=rt),0):at}function Pl(u,d,v){var w=d.width,C=d.height,k=0,A=0,P=w,D=C;if(d.Da=u!=null&&0<u.Da,d.Da&&(P=u.cd,D=u.bd,k=u.v,A=u.j,11>v||(k&=-2,A&=-2),0>k||0>A||0>=P||0>=D||k+P>w||A+D>C))return 0;if(d.v=k,d.j=A,d.va=k+P,d.o=A+D,d.U=P,d.T=D,d.da=u!=null&&0<u.da,d.da){if(!Kt(P,D,v=[u.ib],k=[u.hb]))return 0;d.ib=v[0],d.hb=k[0]}return d.ob=u!=null&&u.ob,d.Kb=u==null||!u.Sd,d.da&&(d.ob=d.ib<3*w/4&&d.hb<3*C/4,d.Kb=0),1}function Nl(u){if(u==null)return 2;if(11>u.S){var d=u.f.RGBA;d.fb+=(u.height-1)*d.A,d.A=-d.A}else d=u.f.kb,u=u.height,d.O+=(u-1)*d.fa,d.fa=-d.fa,d.N+=(u-1>>1)*d.Ab,d.Ab=-d.Ab,d.W+=(u-1>>1)*d.Db,d.Db=-d.Db,d.F!=null&&(d.J+=(u-1)*d.lb,d.lb=-d.lb);return 0}function Vs(u,d,v,w){if(w==null||0>=u||0>=d)return 2;if(v!=null){if(v.Da){var C=v.cd,k=v.bd,A=-2&v.v,P=-2&v.j;if(0>A||0>P||0>=C||0>=k||A+C>u||P+k>d)return 2;u=C,d=k}if(v.da){if(!Kt(u,d,C=[v.ib],k=[v.hb]))return 2;u=C[0],d=k[0]}}w.width=u,w.height=d;t:{var D=w.width,F=w.height;if(u=w.S,0>=D||0>=F||!(u>=fh&&13>u))u=2;else{if(0>=w.Rd&&w.sd==null){A=k=C=d=0;var K=(P=D*Kg[u])*F;if(11>u||(k=(F+1)/2*(d=(D+1)/2),u==12&&(A=(C=D)*F)),(F=s(K+2*k+A))==null){u=1;break t}w.sd=F,11>u?((D=w.f.RGBA).eb=F,D.fb=0,D.A=P,D.size=K):((D=w.f.kb).y=F,D.O=0,D.fa=P,D.Fd=K,D.f=F,D.N=0+K,D.Ab=d,D.Cd=k,D.ea=F,D.W=0+K+k,D.Db=d,D.Ed=k,u==12&&(D.F=F,D.J=0+K+2*k),D.Tc=A,D.lb=C)}if(d=1,C=w.S,k=w.width,A=w.height,C>=fh&&13>C)if(11>C)u=w.f.RGBA,d&=(P=Math.abs(u.A))*(A-1)+k<=u.size,d&=P>=k*Kg[C],d&=u.eb!=null;else{u=w.f.kb,P=(k+1)/2,K=(A+1)/2,D=Math.abs(u.fa),F=Math.abs(u.Ab);var ct=Math.abs(u.Db),B=Math.abs(u.lb),tt=B*(A-1)+k;d&=D*(A-1)+k<=u.Fd,d&=F*(K-1)+P<=u.Cd,d=(d&=ct*(K-1)+P<=u.Ed)&D>=k&F>=P&ct>=P,d&=u.y!=null,d&=u.f!=null,d&=u.ea!=null,C==12&&(d&=B>=k,d&=tt<=u.Tc,d&=u.F!=null)}else d=0;u=d?0:2}}return u!=0||v!=null&&v.fd&&(u=Nl(w)),u}var jo=64,Pr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Nr=24,Ys=32,_s=8,Gs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];It("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(u){return u},M.Predictor2=function(u,d,v){return d[v+0]},M.Predictor3=function(u,d,v){return d[v+1]},M.Predictor4=function(u,d,v){return d[v-1]},M.Predictor5=function(u,d,v){return Yt(Yt(u,d[v+1]),d[v+0])},M.Predictor6=function(u,d,v){return Yt(u,d[v-1])},M.Predictor7=function(u,d,v){return Yt(u,d[v+0])},M.Predictor8=function(u,d,v){return Yt(d[v-1],d[v+0])},M.Predictor9=function(u,d,v){return Yt(d[v+0],d[v+1])},M.Predictor10=function(u,d,v){return Yt(Yt(u,d[v-1]),Yt(d[v+0],d[v+1]))},M.Predictor11=function(u,d,v){var w=d[v+0];return 0>=le(w>>24&255,u>>24&255,(d=d[v-1])>>24&255)+le(w>>16&255,u>>16&255,d>>16&255)+le(w>>8&255,u>>8&255,d>>8&255)+le(255&w,255&u,255&d)?w:u},M.Predictor12=function(u,d,v){var w=d[v+0];return(De((u>>24&255)+(w>>24&255)-((d=d[v-1])>>24&255))<<24|De((u>>16&255)+(w>>16&255)-(d>>16&255))<<16|De((u>>8&255)+(w>>8&255)-(d>>8&255))<<8|De((255&u)+(255&w)-(255&d)))>>>0},M.Predictor13=function(u,d,v){var w=d[v-1];return(ye((u=Yt(u,d[v+0]))>>24&255,w>>24&255)<<24|ye(u>>16&255,w>>16&255)<<16|ye(u>>8&255,w>>8&255)<<8|ye(255&u,255&w))>>>0};var Dl=M.PredictorAdd0;M.PredictorAdd1=Se,It("Predictor2","PredictorAdd2"),It("Predictor3","PredictorAdd3"),It("Predictor4","PredictorAdd4"),It("Predictor5","PredictorAdd5"),It("Predictor6","PredictorAdd6"),It("Predictor7","PredictorAdd7"),It("Predictor8","PredictorAdd8"),It("Predictor9","PredictorAdd9"),It("Predictor10","PredictorAdd10"),It("Predictor11","PredictorAdd11"),It("Predictor12","PredictorAdd12"),It("Predictor13","PredictorAdd13");var Sa=M.PredictorAdd2;Wt("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),Wt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var ui,hh=M.ColorIndexInverseTransform,Rn=M.MapARGB,qn=M.VP8LColorIndexInverseTransformAlpha,Ml=M.MapAlpha,Il=M.VP8LPredictorsAdd=[];Il.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var jl,Fl,Xs,$s,Ks,Fo,Zs,Bo,rn,zn,Ie,qe,di,Ni,Ss,Bl,Ca,uh,kg,Ag,Lg,Tg,Eg,Og,Rl,Pg,Ng,Dg,Mg=s(511),Ig=s(2041),jg=s(225),Fg=s(767),Bg=0,Nd=Ig,dh=jg,Dr=Fg,nn=Mg,fh=0,ph=1,Rg=2,gh=3,mh=4,Dd=5,qg=6,Md=7,Id=8,vh=9,jd=10,pw=[2,3,7],gw=[3,3,11],zg=[280,256,256,256,40],mw=[0,1,1,1,0],vw=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ww=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],bw=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],yw=8,Fd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Bd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ql=null,xw=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],_w=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Hg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Sw=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Cw=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],kw=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Aw=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Js=[],mn=[],Cs=[],Lw=1,Ug=2,Qs=[],sn=[];ys("UpsampleRgbLinePair",Ws,3),ys("UpsampleBgrLinePair",zi,3),ys("UpsampleRgbaLinePair",or,4),ys("UpsampleBgraLinePair",Ol,4),ys("UpsampleArgbLinePair",El,4),ys("UpsampleRgba4444LinePair",Mo,2),ys("UpsampleRgb565LinePair",Do,2);var Tw=M.UpsampleRgbLinePair,Ew=M.UpsampleBgrLinePair,Wg=M.UpsampleRgbaLinePair,Vg=M.UpsampleBgraLinePair,Yg=M.UpsampleArgbLinePair,Gg=M.UpsampleRgba4444LinePair,Ow=M.UpsampleRgb565LinePair,wh=16,bh=1<<wh-1,zl=-227,Rd=482,Pw=6,Xg=0,Nw=s(256),Dw=s(256),Mw=s(256),Iw=s(256),jw=s(Rd-zl),Fw=s(Rd-zl);xs("YuvToRgbRow",Ws,3),xs("YuvToBgrRow",zi,3),xs("YuvToRgbaRow",or,4),xs("YuvToBgraRow",Ol,4),xs("YuvToArgbRow",El,4),xs("YuvToRgba4444Row",Mo,2),xs("YuvToRgb565Row",Do,2);var $g=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],yh=[0,2,8],Bw=[8,7,6,4,4,2,2,2,1,1,1,1],Rw=1;this.WebPDecodeRGBA=function(u,d,v,w,C){var k=ph,A=new bt,P=new be;A.ba=P,P.S=k,P.width=[P.width],P.height=[P.height];var D=P.width,F=P.height,K=new Jt;if(K==null||u==null)var ct=2;else t(K!=null),ct=Io(u,d,v,K.width,K.height,K.Pd,K.Qd,K.format,null);if(ct!=0?D=0:(D!=null&&(D[0]=K.width[0]),F!=null&&(F[0]=K.height[0]),D=1),D){P.width=P.width[0],P.height=P.height[0],w!=null&&(w[0]=P.width),C!=null&&(C[0]=P.height);t:{if(w=new ma,(C=new _t).data=u,C.w=d,C.ha=v,C.kd=1,d=[0],t(C!=null),((u=Io(C.data,C.w,C.ha,null,null,null,d,null,C))==0||u==7)&&d[0]&&(u=4),(d=u)==0){if(t(A!=null),w.data=C.data,w.w=C.w+C.offset,w.ha=C.ha-C.offset,w.put=Qt,w.ac=Dn,w.bc=hs,w.ma=A,C.xa){if((u=Co())==null){A=1;break t}if((function(B,tt){var rt=[0],mt=[0],at=[0];e:for(;;){if(B==null)return 0;if(tt==null)return B.a=2,0;if(B.l=tt,B.a=0,dt(B.m,tt.data,tt.w,tt.ha),!us(B.m,rt,mt,at)){B.a=3;break e}if(B.xb=Ug,tt.width=rt[0],tt.height=mt[0],!In(rt[0],mt[0],1,B,null))break e;return 1}return t(B.a!=0),0})(u,w)){if(w=(d=Vs(w.width,w.height,A.Oa,A.ba))==0){e:{w=u;i:for(;;){if(w==null){w=0;break e}if(t(w.s.yc!=null),t(w.s.Ya!=null),t(0<w.s.Wb),t((v=w.l)!=null),t((C=v.ma)!=null),w.xb!=0){if(w.ca=C.ba,w.tb=C.tb,t(w.ca!=null),!Pl(C.Oa,v,gh)){w.a=2;break i}if(!ko(w,v.width)||v.da)break i;if((v.da||te(w.ca.S))&&gn(),11>w.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),w.ca.f.kb.F!=null&&gn()),w.Pb&&0<w.s.ua&&w.s.vb.X==null&&!j(w.s.vb,w.s.Wa.Xa)){w.a=1;break i}w.xb=0}if(!fn(w,w.V,w.Ba,w.c,w.i,v.o,Hs))break i;C.Dc=w.Ma,w=1;break e}t(w.a!=0),w=0}w=!w}w&&(d=u.a)}else d=u.a}else{if((u=new vd)==null){A=1;break t}if(u.Fa=C.na,u.P=C.P,u.qc=C.Sa,Fn(u,w)){if((d=Vs(w.width,w.height,A.Oa,A.ba))==0){if(u.Aa=0,v=A.Oa,t((C=u)!=null),v!=null){if(0<(D=0>(D=v.Md)?0:100<D?255:255*D/100)){for(F=K=0;4>F;++F)12>(ct=C.pb[F]).lc&&(ct.ia=D*Bw[0>ct.lc?0:ct.lc]>>3),K|=ct.ia;K&&(alert("todo:VP8InitRandom"),C.ia=1)}C.Ga=v.Id,100<C.Ga?C.Ga=100:0>C.Ga&&(C.Ga=0)}(function(B,tt){if(B==null)return 0;if(tt==null)return _i(B,2,"NULL VP8Io parameter in VP8Decode().");if(!B.cb&&!Fn(B,tt))return 0;if(t(B.cb),tt.ac==null||tt.ac(tt)){tt.ob&&(B.L=0);var rt=yh[B.L];if(B.L==2?(B.yb=0,B.zb=0):(B.yb=tt.v-rt>>4,B.zb=tt.j-rt>>4,0>B.yb&&(B.yb=0),0>B.zb&&(B.zb=0)),B.Va=tt.o+15+rt>>4,B.Hb=tt.va+15+rt>>4,B.Hb>B.za&&(B.Hb=B.za),B.Va>B.Ub&&(B.Va=B.Ub),0<B.L){var mt=B.ed;for(rt=0;4>rt;++rt){var at;if(B.Qa.Cb){var wt=B.Qa.Lb[rt];B.Qa.Fb||(wt+=mt.Tb)}else wt=mt.Tb;for(at=0;1>=at;++at){var yt=B.gd[rt][at],At=wt;if(mt.Pc&&(At+=mt.vd[0],at&&(At+=mt.od[0])),0<(At=0>At?0:63<At?63:At)){var St=At;0<mt.wb&&(St=4<mt.wb?St>>2:St>>1)>9-mt.wb&&(St=9-mt.wb),1>St&&(St=1),yt.dd=St,yt.tc=2*At+St,yt.ld=40<=At?2:15<=At?1:0}else yt.tc=0;yt.La=at}}}rt=0}else _i(B,6,"Frame setup failed"),rt=B.a;if(rt=rt==0){if(rt){B.$c=0,0<B.Aa||(B.Ic=Rw);e:{rt=B.Ic,mt=4*(St=B.za);var Ht=32*St,Mt=St+1,pe=0<B.L?St*(0<B.Aa?2:1):0,Bt=(B.Aa==2?2:1)*St;if((yt=mt+832+(at=3*(16*rt+yh[B.L])/2*Ht)+(wt=B.Fa!=null&&0<B.Fa.length?B.Kc.c*B.Kc.i:0))!=yt)rt=0;else{if(yt>B.Vb){if(B.Vb=0,B.Ec=s(yt),B.Fc=0,B.Ec==null){rt=_i(B,1,"no memory during frame initialization.");break e}B.Vb=yt}yt=B.Ec,At=B.Fc,B.Ac=yt,B.Bc=At,At+=mt,B.Gd=o(Ht,Kc),B.Hd=0,B.rb=o(Mt+1,wl),B.sb=1,B.wa=pe?o(pe,Qr):null,B.Y=0,B.D.Nb=0,B.D.wa=B.wa,B.D.Y=B.Y,0<B.Aa&&(B.D.Y+=St),t(!0),B.oc=yt,B.pc=At,At+=832,B.ya=o(Bt,bl),B.aa=0,B.D.ya=B.ya,B.D.aa=B.aa,B.Aa==2&&(B.D.aa+=St),B.R=16*St,B.B=8*St,St=(Ht=yh[B.L])*B.R,Ht=Ht/2*B.B,B.sa=yt,B.ta=At+St,B.qa=B.sa,B.ra=B.ta+16*rt*B.R+Ht,B.Ha=B.qa,B.Ia=B.ra+8*rt*B.B+Ht,B.$c=0,At+=at,B.mb=wt?yt:null,B.nb=wt?At:null,t(At+wt<=B.Fc+B.Vb),Qc(B),n(B.Ac,B.Bc,0,mt),rt=1}}if(rt){if(tt.ka=0,tt.y=B.sa,tt.O=B.ta,tt.f=B.qa,tt.N=B.ra,tt.ea=B.Ha,tt.Vd=B.Ia,tt.fa=B.R,tt.Rc=B.B,tt.F=null,tt.J=0,!Bg){for(rt=-255;255>=rt;++rt)Mg[255+rt]=0>rt?-rt:rt;for(rt=-1020;1020>=rt;++rt)Ig[1020+rt]=-128>rt?-128:127<rt?127:rt;for(rt=-112;112>=rt;++rt)jg[112+rt]=-16>rt?-16:15<rt?15:rt;for(rt=-255;510>=rt;++rt)Fg[255+rt]=0>rt?0:255<rt?255:rt;Bg=1}Zs=wa,Bo=bd,zn=Bn,Ie=eh,qe=ih,rn=wd,di=ah,Ni=Oo,Ss=S,Bl=R,Ca=lh,uh=g,kg=Y,Ag=it,Lg=Eo,Tg=Ll,Eg=sh,Og=oh,mn[0]=Ld,mn[1]=yd,mn[2]=kd,mn[3]=Ad,mn[4]=fs,mn[5]=Td,mn[6]=ps,mn[7]=Ed,mn[8]=_l,mn[9]=ba,Js[0]=Sd,Js[1]=_d,Js[2]=yl,Js[3]=rh,Js[4]=Lo,Js[5]=xl,Js[6]=Cd,Cs[0]=Pd,Cs[1]=xd,Cs[2]=To,Cs[3]=Od,Cs[4]=Cl,Cs[5]=Sl,Cs[6]=nh,rt=1}else rt=0}rt&&(rt=(function(Ce,Di){for(Ce.M=0;Ce.M<Ce.Va;++Ce.M){var ge,Rt=Ce.Jc[Ce.M&Ce.Xb],Et=Ce.m,fi=Ce;for(ge=0;ge<fi.za;++ge){var he=Et,Ae=fi,Xe=Ae.Ac,Hi=Ae.Bc+4*ge,ar=Ae.zc,si=Ae.ya[Ae.aa+ge];if(Ae.Qa.Bb?si.$b=vt(he,Ae.Pa.jb[0])?2+vt(he,Ae.Pa.jb[2]):vt(he,Ae.Pa.jb[1]):si.$b=0,Ae.kc&&(si.Ad=vt(he,Ae.Bd)),si.Za=!vt(he,145)+0,si.Za){var $i=si.Ob,lr=0;for(Ae=0;4>Ae;++Ae){var Mi,Ee=ar[0+Ae];for(Mi=0;4>Mi;++Mi){Ee=Cw[Xe[Hi+Mi]][Ee];for(var Fe=Hg[vt(he,Ee[0])];0<Fe;)Fe=Hg[2*Fe+vt(he,Ee[Fe])];Ee=-Fe,Xe[Hi+Mi]=Ee}i($i,lr,Xe,Hi,4),lr+=4,ar[0+Ae]=Ee}}else Ee=vt(he,156)?vt(he,128)?1:3:vt(he,163)?2:0,si.Ob[0]=Ee,n(Xe,Hi,Ee,4),n(ar,0,Ee,4);si.Dd=vt(he,142)?vt(he,114)?vt(he,183)?1:3:2:0}if(fi.m.Ka)return _i(Ce,7,"Premature end-of-partition0 encountered.");for(;Ce.ja<Ce.za;++Ce.ja){if(fi=Rt,he=(Et=Ce).rb[Et.sb-1],Xe=Et.rb[Et.sb+Et.ja],ge=Et.ya[Et.aa+Et.ja],Hi=Et.kc?ge.Ad:0)he.la=Xe.la=0,ge.Za||(he.Na=Xe.Na=0),ge.Hc=0,ge.Gc=0,ge.ia=0;else{var oi,Be;if(he=Xe,Xe=fi,Hi=Et.Pa.Xc,ar=Et.ya[Et.aa+Et.ja],si=Et.pb[ar.$b],Ae=ar.ad,$i=0,lr=Et.rb[Et.sb-1],Ee=Mi=0,n(Ae,$i,0,384),ar.Za)var Ui=0,vn=Hi[3];else{Fe=s(16);var pi=he.Na+lr.Na;if(pi=ql(Xe,Hi[1],pi,si.Eb,0,Fe,0),he.Na=lr.Na=(0<pi)+0,1<pi)Zs(Fe,0,Ae,$i);else{var _r=Fe[0]+3>>3;for(Fe=0;256>Fe;Fe+=16)Ae[$i+Fe]=_r}Ui=1,vn=Hi[0]}var ze=15&he.la,Ii=15&lr.la;for(Fe=0;4>Fe;++Fe){var Mr=1&Ii;for(_r=Be=0;4>_r;++_r)ze=ze>>1|(Mr=(pi=ql(Xe,vn,pi=Mr+(1&ze),si.Sc,Ui,Ae,$i))>Ui)<<7,Be=Be<<2|(3<pi?3:1<pi?2:Ae[$i+0]!=0),$i+=16;ze>>=4,Ii=Ii>>1|Mr<<7,Mi=(Mi<<8|Be)>>>0}for(vn=ze,Ui=Ii>>4,oi=0;4>oi;oi+=2){for(Be=0,ze=he.la>>4+oi,Ii=lr.la>>4+oi,Fe=0;2>Fe;++Fe){for(Mr=1&Ii,_r=0;2>_r;++_r)pi=Mr+(1&ze),ze=ze>>1|(Mr=0<(pi=ql(Xe,Hi[2],pi,si.Qc,0,Ae,$i)))<<3,Be=Be<<2|(3<pi?3:1<pi?2:Ae[$i+0]!=0),$i+=16;ze>>=2,Ii=Ii>>1|Mr<<5}Ee|=Be<<4*oi,vn|=ze<<4<<oi,Ui|=(240&Ii)<<oi}he.la=vn,lr.la=Ui,ar.Hc=Mi,ar.Gc=Ee,ar.ia=43690&Ee?0:si.ia,Hi=!(Mi|Ee)}if(0<Et.L&&(Et.wa[Et.Y+Et.ja]=Et.gd[ge.$b][ge.Za],Et.wa[Et.Y+Et.ja].La|=!Hi),fi.Ka)return _i(Ce,7,"Premature end-of-file encountered.")}if(Qc(Ce),Et=Di,fi=1,ge=(Rt=Ce).D,he=0<Rt.L&&Rt.M>=Rt.zb&&Rt.M<=Rt.Va,Rt.Aa==0)e:{if(ge.M=Rt.M,ge.uc=he,en(Rt,ge),fi=1,ge=(Be=Rt.D).Nb,he=(Ee=yh[Rt.L])*Rt.R,Xe=Ee/2*Rt.B,Fe=16*ge*Rt.R,_r=8*ge*Rt.B,Hi=Rt.sa,ar=Rt.ta-he+Fe,si=Rt.qa,Ae=Rt.ra-Xe+_r,$i=Rt.Ha,lr=Rt.Ia-Xe+_r,Ii=(ze=Be.M)==0,Mi=ze>=Rt.Va-1,Rt.Aa==2&&en(Rt,Be),Be.uc)for(Mr=(pi=Rt).D.M,t(pi.D.uc),Be=pi.yb;Be<pi.Hb;++Be){Ui=Be,vn=Mr;var cr=(Ir=(Wi=pi).D).Nb;oi=Wi.R;var Ir=Ir.wa[Ir.Y+Ui],jr=Wi.sa,Sr=Wi.ta+16*cr*oi+16*Ui,Fr=Ir.dd,Ye=Ir.tc;if(Ye!=0)if(t(3<=Ye),Wi.L==1)0<Ui&&Tg(jr,Sr,oi,Ye+4),Ir.La&&Og(jr,Sr,oi,Ye),0<vn&&Lg(jr,Sr,oi,Ye+4),Ir.La&&Eg(jr,Sr,oi,Ye);else{var Br=Wi.B,wn=Wi.qa,Ro=Wi.ra+8*cr*Br+8*Ui,ks=Wi.Ha,Wi=Wi.Ia+8*cr*Br+8*Ui;cr=Ir.ld,0<Ui&&(Ni(jr,Sr,oi,Ye+4,Fr,cr),Bl(wn,Ro,ks,Wi,Br,Ye+4,Fr,cr)),Ir.La&&(uh(jr,Sr,oi,Ye,Fr,cr),Ag(wn,Ro,ks,Wi,Br,Ye,Fr,cr)),0<vn&&(di(jr,Sr,oi,Ye+4,Fr,cr),Ss(wn,Ro,ks,Wi,Br,Ye+4,Fr,cr)),Ir.La&&(Ca(jr,Sr,oi,Ye,Fr,cr),kg(wn,Ro,ks,Wi,Br,Ye,Fr,cr))}}if(Rt.ia&&alert("todo:DitherRow"),Et.put!=null){if(Be=16*ze,ze=16*(ze+1),Ii?(Et.y=Rt.sa,Et.O=Rt.ta+Fe,Et.f=Rt.qa,Et.N=Rt.ra+_r,Et.ea=Rt.Ha,Et.W=Rt.Ia+_r):(Be-=Ee,Et.y=Hi,Et.O=ar,Et.f=si,Et.N=Ae,Et.ea=$i,Et.W=lr),Mi||(ze-=Ee),ze>Et.o&&(ze=Et.o),Et.F=null,Et.J=null,Rt.Fa!=null&&0<Rt.Fa.length&&Be<ze&&(Et.J=Ve(Rt,Et,Be,ze-Be),Et.F=Rt.mb,Et.F==null&&Et.F.length==0)){fi=_i(Rt,3,"Could not decode alpha data.");break e}Be<Et.j&&(Ee=Et.j-Be,Be=Et.j,t(!(1&Ee)),Et.O+=Rt.R*Ee,Et.N+=Rt.B*(Ee>>1),Et.W+=Rt.B*(Ee>>1),Et.F!=null&&(Et.J+=Et.width*Ee)),Be<ze&&(Et.O+=Et.v,Et.N+=Et.v>>1,Et.W+=Et.v>>1,Et.F!=null&&(Et.J+=Et.v),Et.ka=Be-Et.j,Et.U=Et.va-Et.v,Et.T=ze-Be,fi=Et.put(Et))}ge+1!=Rt.Ic||Mi||(i(Rt.sa,Rt.ta-he,Hi,ar+16*Rt.R,he),i(Rt.qa,Rt.ra-Xe,si,Ae+8*Rt.B,Xe),i(Rt.Ha,Rt.Ia-Xe,$i,lr+8*Rt.B,Xe))}if(!fi)return _i(Ce,6,"Output aborted.")}return 1})(B,tt)),tt.bc!=null&&tt.bc(tt),rt&=1}return rt?(B.cb=0,rt):0})(u,w)||(d=u.a)}}else d=u.a}d==0&&A.Oa!=null&&A.Oa.fd&&(d=Nl(A.ba))}A=d}k=A!=0?null:11>k?P.f.RGBA.eb:P.f.kb.y}else k=null;return k};var Kg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(M,J){for(var L="",N=0;N<4;N++)L+=String.fromCharCode(M[J++]);return L}function h(M,J){return M[J+0]|M[J+1]<<8}function p(M,J){return(M[J+0]|M[J+1]<<8|M[J+2]<<16)>>>0}function m(M,J){return(M[J+0]|M[J+1]<<8|M[J+2]<<16|M[J+3]<<24)>>>0}new l;var f=[0],b=[0],y=[],_=new l,x=r,E=(function(M,J){var L={},N=0,H=!1,z=0,st=0;if(L.frames=[],!(function(T,q){for(var U=0;U<4;U++)if(T[q+U]!="RIFF".charCodeAt(U))return!0;return!1})(M,J)){for(m(M,J+=4),J+=8;J<M.length;){var lt=c(M,J),ht=m(M,J+=4);J+=4;var et=ht+(1&ht);switch(lt){case"VP8 ":case"VP8L":L.frames[N]===void 0&&(L.frames[N]={}),(xt=L.frames[N]).src_off=H?st:J-8,xt.src_size=z+ht+8,N++,H&&(H=!1,z=0,st=0);break;case"VP8X":(xt=L.header={}).feature_flags=M[J];var dt=J+4;xt.canvas_width=1+p(M,dt),dt+=3,xt.canvas_height=1+p(M,dt),dt+=3;break;case"ALPH":H=!0,z=et+8,st=J-8;break;case"ANIM":(xt=L.header).bgcolor=m(M,J),dt=J+4,xt.loop_count=h(M,dt),dt+=2;break;case"ANMF":var kt,xt;(xt=L.frames[N]={}).offset_x=2*p(M,J),J+=3,xt.offset_y=2*p(M,J),J+=3,xt.width=1+p(M,J),J+=3,xt.height=1+p(M,J),J+=3,xt.duration=p(M,J),J+=3,kt=M[J++],xt.dispose=1&kt,xt.blend=kt>>1&1}lt!="ANMF"&&(J+=et)}return L}})(x,0);E.response=x,E.rgbaoutput=!0,E.dataurl=!1;var I=E.header?E.header:null,O=E.frames?E.frames:null;if(I){I.loop_counter=I.loop_count,f=[I.canvas_height],b=[I.canvas_width];for(var V=0;V<O.length&&O[V].blend!=0;V++);}var Z=O[0],nt=_.WebPDecodeRGBA(x,Z.src_off,Z.src_size,b,f);Z.rgba=nt,Z.imgwidth=b[0],Z.imgheight=f[0];for(var W=0;W<b[0]*f[0]*4;W++)y[W]=nt[W];return this.width=b,this.height=f,this.data=y,this}(function(r){var t,e,i,n,s,o,a,l,c,h=function(T){return T=T||{},this.isStrokeTransparent=T.isStrokeTransparent||!1,this.strokeOpacity=T.strokeOpacity||1,this.strokeStyle=T.strokeStyle||"#000000",this.fillStyle=T.fillStyle||"#000000",this.isFillTransparent=T.isFillTransparent||!1,this.fillOpacity=T.fillOpacity||1,this.font=T.font||"10px sans-serif",this.textBaseline=T.textBaseline||"alphabetic",this.textAlign=T.textAlign||"left",this.lineWidth=T.lineWidth||1,this.lineJoin=T.lineJoin||"miter",this.lineCap=T.lineCap||"butt",this.path=T.path||[],this.transform=T.transform!==void 0?T.transform.clone():new l,this.globalCompositeOperation=T.globalCompositeOperation||"normal",this.globalAlpha=T.globalAlpha||1,this.clip_path=T.clip_path||[],this.currentPoint=T.currentPoint||new o,this.miterLimit=T.miterLimit||10,this.lastPoint=T.lastPoint||new o,this.lineDashOffset=T.lineDashOffset||0,this.lineDash=T.lineDash||[],this.margin=T.margin||[0,0,0,0],this.prevPageLastElemOffset=T.prevPageLastElemOffset||0,this.ignoreClearRect=typeof T.ignoreClearRect!="boolean"||T.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,e=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,l=this.internal.Matrix,c=new h}]);var p=function(T){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var q=T;Object.defineProperty(this,"pdf",{get:function(){return q}});var U=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return U},set:function(j){U=!!j}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(j){X=!!j}});var Q=0;Object.defineProperty(this,"posX",{get:function(){return Q},set:function(j){isNaN(j)||(Q=j)}});var ot=0;Object.defineProperty(this,"posY",{get:function(){return ot},set:function(j){isNaN(j)||(ot=j)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(j){var Ot;typeof j=="number"?Ot=[j,j,j,j]:((Ot=new Array(4))[0]=j[0],Ot[1]=j.length>=2?j[1]:Ot[0],Ot[2]=j.length>=3?j[2]:Ot[0],Ot[3]=j.length>=4?j[3]:Ot[1]),c.margin=Ot}});var ft=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ft},set:function(j){ft=j}});var pt=0;Object.defineProperty(this,"lastBreak",{get:function(){return pt},set:function(j){pt=j}});var vt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return vt},set:function(j){vt=j}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(j){j instanceof h&&(c=j)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(j){c.path=j}});var Lt=[];Object.defineProperty(this,"ctxStack",{get:function(){return Lt},set:function(j){Lt=j}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(j){var Ot;Ot=m(j),this.ctx.fillStyle=Ot.style,this.ctx.isFillTransparent=Ot.a===0,this.ctx.fillOpacity=Ot.a,this.pdf.setFillColor(Ot.r,Ot.g,Ot.b,{a:Ot.a}),this.pdf.setTextColor(Ot.r,Ot.g,Ot.b,{a:Ot.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(j){var Ot=m(j);this.ctx.strokeStyle=Ot.style,this.ctx.isStrokeTransparent=Ot.a===0,this.ctx.strokeOpacity=Ot.a,Ot.a===0?this.pdf.setDrawColor(255,255,255):(Ot.a,this.pdf.setDrawColor(Ot.r,Ot.g,Ot.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(j){["butt","round","square"].indexOf(j)!==-1&&(this.ctx.lineCap=j,this.pdf.setLineCap(j))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(j){isNaN(j)||(this.ctx.lineWidth=j,this.pdf.setLineWidth(j))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(j){["bevel","round","miter"].indexOf(j)!==-1&&(this.ctx.lineJoin=j,this.pdf.setLineJoin(j))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(j){isNaN(j)||(this.ctx.miterLimit=j,this.pdf.setMiterLimit(j))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(j){this.ctx.textBaseline=j}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(j){["right","end","center","left","start"].indexOf(j)!==-1&&(this.ctx.textAlign=j)}});var Nt=null,Pt=null,Vt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Vt},set:function(j){Nt=null,Pt=null,Vt=j}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(j){var Ot;if(this.ctx.font=j,(Ot=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(j))!==null){var me=Ot[1];Ot[2];var Kt=Ot[3],Ct=Ot[4];Ot[5];var Zt=Ot[6],It=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ct)[2];Ct=Math.floor(It==="px"?parseFloat(Ct)*this.pdf.internal.scaleFactor:It==="em"?parseFloat(Ct)*this.pdf.getFontSize():parseFloat(Ct)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ct);var $t=(function(Wt){var hi,Le,ve=[],we=Wt.trim();if(we==="")return Df;if(we in f1)return[f1[we]];for(;we!=="";){switch(Le=null,hi=(we=g1(we)).charAt(0)){case'"':case"'":Le=mk(we.substring(1),hi);break;default:Le=vk(we)}if(Le===null||(ve.push(Le[0]),(we=g1(Le[1]))!==""&&we.charAt(0)!==","))return Df;we=we.replace(/^,/,"")}return ve})(Zt);if(this.fontFaces){var Yt=(function(Wt,hi){var Le=Wt.getFontList(),ve=JSON.stringify(Le);if(Nt===null||Pt!==ve){var we=(function(Ze){var Xt=[];return Object.keys(Ze).forEach(function(We){Ze[We].forEach(function(te){var ce=null;switch(te){case"bold":ce={family:We,weight:"bold"};break;case"italic":ce={family:We,style:"italic"};break;case"bolditalic":ce={family:We,weight:"bold",style:"italic"};break;case"":case"normal":ce={family:We}}ce!==null&&(ce.ref={name:We,style:te},Xt.push(ce))})}),Xt})(Le);Nt=(function(Ze){for(var Xt={},We=0;We<Ze.length;++We){var te=Nf(Ze[We]),ce=te.family,Je=te.stretch,be=te.style,Jt=te.weight;Xt[ce]=Xt[ce]||{},Xt[ce][Je]=Xt[ce][Je]||{},Xt[ce][Je][be]=Xt[ce][Je][be]||{},Xt[ce][Je][be][Jt]=te}return Xt})(we.concat(hi)),Pt=ve}return Nt})(this.pdf,this.fontFaces),De=$t.map(function(Wt){return{family:Wt,stretch:"normal",weight:Kt,style:me}}),ye=(function(Wt,hi,Le){for(var ve=(Le=Le||{}).defaultFontFamily||"times",we=Object.assign({},gk,Le.genericFontFamilies||{}),Ze=null,Xt=null,We=0;We<hi.length;++We)if(we[(Ze=Nf(hi[We])).family]&&(Ze.family=we[Ze.family]),Wt.hasOwnProperty(Ze.family)){Xt=Wt[Ze.family];break}if(!(Xt=Xt||Wt[ve]))throw new Error("Could not find a font-family for the rule '"+p1(Ze)+"' and default family '"+ve+"'.");if(Xt=(function(te,ce){if(ce[te])return ce[te];var Je=Sp[te],be=Je<=Sp.normal?-1:1,Jt=d1(ce,X5,Je,be);if(!Jt)throw new Error("Could not find a matching font-stretch value for "+te);return Jt})(Ze.stretch,Xt),Xt=(function(te,ce){if(ce[te])return ce[te];for(var Je=G5[te],be=0;be<Je.length;++be)if(ce[Je[be]])return ce[Je[be]];throw new Error("Could not find a matching font-style for "+te)})(Ze.style,Xt),!(Xt=(function(te,ce){if(ce[te])return ce[te];if(te===400&&ce[500])return ce[500];if(te===500&&ce[400])return ce[400];var Je=pk[te],be=d1(ce,$5,Je,te<400?-1:1);if(!be)throw new Error("Could not find a matching font-weight for value "+te);return be})(Ze.weight,Xt)))throw new Error("Failed to resolve a font for the rule '"+p1(Ze)+"'.");return Xt})(Yt,De);this.pdf.setFont(ye.ref.name,ye.ref.style)}else{var le="";(Kt==="bold"||parseInt(Kt,10)>=700||me==="bold")&&(le="bold"),me==="italic"&&(le+="italic"),le.length===0&&(le="normal");for(var Se="",xe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},qt=0;qt<$t.length;qt++){if(this.pdf.internal.getFont($t[qt],le,{noFallback:!0,disableWarning:!0})!==void 0){Se=$t[qt];break}if(le==="bolditalic"&&this.pdf.internal.getFont($t[qt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Se=$t[qt],le="bold";else if(this.pdf.internal.getFont($t[qt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Se=$t[qt],le="normal";break}}if(Se===""){for(var de=0;de<$t.length;de++)if(xe[$t[de]]){Se=xe[$t[de]];break}}Se=Se===""?"Times":Se,this.pdf.setFont(Se,le)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(j){this.ctx.globalCompositeOperation=j}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(j){this.ctx.globalAlpha=j}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(j){this.ctx.lineDashOffset=j,xt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(j){this.ctx.lineDash=j,xt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(j){this.ctx.ignoreClearRect=!!j}})};p.prototype.setLineDash=function(T){this.lineDash=T},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){O.call(this,"fill",!1)},p.prototype.stroke=function(){O.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(T,q){if(isNaN(T)||isNaN(q))throw He.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var U=this.ctx.transform.applyToPoint(new o(T,q));this.path.push({type:"mt",x:U.x,y:U.y}),this.ctx.lastPoint=new o(T,q)},p.prototype.closePath=function(){var T=new o(0,0),q=0;for(q=this.path.length-1;q!==-1;q--)if(this.path[q].type==="begin"&&Re(this.path[q+1])==="object"&&typeof this.path[q+1].x=="number"){T=new o(this.path[q+1].x,this.path[q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(T.x,T.y)},p.prototype.lineTo=function(T,q){if(isNaN(T)||isNaN(q))throw He.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var U=this.ctx.transform.applyToPoint(new o(T,q));this.path.push({type:"lt",x:U.x,y:U.y}),this.ctx.lastPoint=new o(U.x,U.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},p.prototype.quadraticCurveTo=function(T,q,U,X){if(isNaN(U)||isNaN(X)||isNaN(T)||isNaN(q))throw He.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Q=this.ctx.transform.applyToPoint(new o(U,X)),ot=this.ctx.transform.applyToPoint(new o(T,q));this.path.push({type:"qct",x1:ot.x,y1:ot.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},p.prototype.bezierCurveTo=function(T,q,U,X,Q,ot){if(isNaN(Q)||isNaN(ot)||isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X))throw He.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ft=this.ctx.transform.applyToPoint(new o(Q,ot)),pt=this.ctx.transform.applyToPoint(new o(T,q)),vt=this.ctx.transform.applyToPoint(new o(U,X));this.path.push({type:"bct",x1:pt.x,y1:pt.y,x2:vt.x,y2:vt.y,x:ft.x,y:ft.y}),this.ctx.lastPoint=new o(ft.x,ft.y)},p.prototype.arc=function(T,q,U,X,Q,ot){if(isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X)||isNaN(Q))throw He.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ot=!!ot,!this.ctx.transform.isIdentity){var ft=this.ctx.transform.applyToPoint(new o(T,q));T=ft.x,q=ft.y;var pt=this.ctx.transform.applyToPoint(new o(0,U)),vt=this.ctx.transform.applyToPoint(new o(0,0));U=Math.sqrt(Math.pow(pt.x-vt.x,2)+Math.pow(pt.y-vt.y,2))}Math.abs(Q-X)>=2*Math.PI&&(X=0,Q=2*Math.PI),this.path.push({type:"arc",x:T,y:q,radius:U,startAngle:X,endAngle:Q,counterclockwise:ot})},p.prototype.arcTo=function(T,q,U,X,Q){throw new Error("arcTo not implemented.")},p.prototype.rect=function(T,q,U,X){if(isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X))throw He.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(T,q),this.lineTo(T+U,q),this.lineTo(T+U,q+X),this.lineTo(T,q+X),this.lineTo(T,q),this.lineTo(T+U,q),this.lineTo(T,q)},p.prototype.fillRect=function(T,q,U,X){if(isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X))throw He.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var Q={};this.lineCap!=="butt"&&(Q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(T,q,U,X),this.fill(),Q.hasOwnProperty("lineCap")&&(this.lineCap=Q.lineCap),Q.hasOwnProperty("lineJoin")&&(this.lineJoin=Q.lineJoin)}},p.prototype.strokeRect=function(T,q,U,X){if(isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X))throw He.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(T,q,U,X),this.stroke())},p.prototype.clearRect=function(T,q,U,X){if(isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X))throw He.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(T,q,U,X))},p.prototype.save=function(T){T=typeof T!="boolean"||T;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("q");if(this.pdf.setPage(q),T){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},p.prototype.restore=function(T){T=typeof T!="boolean"||T;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("Q");this.pdf.setPage(q),T&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(T){var q,U,X,Q;if(T.isCanvasGradient===!0&&(T=T.getColor()),!T)return{r:0,g:0,b:0,a:0,style:T};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(T))q=0,U=0,X=0,Q=0;else{var ot=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(T);if(ot!==null)q=parseInt(ot[1]),U=parseInt(ot[2]),X=parseInt(ot[3]),Q=1;else if((ot=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(T))!==null)q=parseInt(ot[1]),U=parseInt(ot[2]),X=parseInt(ot[3]),Q=parseFloat(ot[4]);else{if(Q=1,typeof T=="string"&&T.charAt(0)!=="#"){var ft=new q5(T);T=ft.ok?ft.toHex():"#000000"}T.length===4?(q=T.substring(1,2),q+=q,U=T.substring(2,3),U+=U,X=T.substring(3,4),X+=X):(q=T.substring(1,3),U=T.substring(3,5),X=T.substring(5,7)),q=parseInt(q,16),U=parseInt(U,16),X=parseInt(X,16)}}return{r:q,g:U,b:X,a:Q,style:T}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(T,q,U,X){if(isNaN(q)||isNaN(U)||typeof T!="string")throw He.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!f.call(this)){var Q=et(this.ctx.transform.rotation),ot=this.ctx.transform.scaleX;N.call(this,{text:T,x:q,y:U,scale:ot,angle:Q,align:this.textAlign,maxWidth:X})}},p.prototype.strokeText=function(T,q,U,X){if(isNaN(q)||isNaN(U)||typeof T!="string")throw He.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){X=isNaN(X)?void 0:X;var Q=et(this.ctx.transform.rotation),ot=this.ctx.transform.scaleX;N.call(this,{text:T,x:q,y:U,scale:ot,renderingMode:"stroke",angle:Q,align:this.textAlign,maxWidth:X})}},p.prototype.measureText=function(T){if(typeof T!="string")throw He.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var q=this.pdf,U=this.pdf.internal.scaleFactor,X=q.internal.getFontSize(),Q=q.getStringUnitWidth(T)*X/q.internal.scaleFactor;return new function(ot){var ft=(ot=ot||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ft}}),this}({width:Q*=Math.round(96*U/72*1e4)/1e4})},p.prototype.scale=function(T,q){if(isNaN(T)||isNaN(q))throw He.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var U=new l(T,0,0,q,0,0);this.ctx.transform=this.ctx.transform.multiply(U)},p.prototype.rotate=function(T){if(isNaN(T))throw He.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var q=new l(Math.cos(T),Math.sin(T),-Math.sin(T),Math.cos(T),0,0);this.ctx.transform=this.ctx.transform.multiply(q)},p.prototype.translate=function(T,q){if(isNaN(T)||isNaN(q))throw He.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var U=new l(1,0,0,1,T,q);this.ctx.transform=this.ctx.transform.multiply(U)},p.prototype.transform=function(T,q,U,X,Q,ot){if(isNaN(T)||isNaN(q)||isNaN(U)||isNaN(X)||isNaN(Q)||isNaN(ot))throw He.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ft=new l(T,q,U,X,Q,ot);this.ctx.transform=this.ctx.transform.multiply(ft)},p.prototype.setTransform=function(T,q,U,X,Q,ot){T=isNaN(T)?1:T,q=isNaN(q)?0:q,U=isNaN(U)?0:U,X=isNaN(X)?1:X,Q=isNaN(Q)?0:Q,ot=isNaN(ot)?0:ot,this.ctx.transform=new l(T,q,U,X,Q,ot)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(T,q,U,X,Q,ot,ft,pt,vt){var Lt=this.pdf.getImageProperties(T),Nt=1,Pt=1,Vt=1,j=1;X!==void 0&&pt!==void 0&&(Vt=pt/X,j=vt/Q,Nt=Lt.width/X*pt/X,Pt=Lt.height/Q*vt/Q),ot===void 0&&(ot=q,ft=U,q=0,U=0),X!==void 0&&pt===void 0&&(pt=X,vt=Q),X===void 0&&pt===void 0&&(pt=Lt.width,vt=Lt.height);var Ot=this.ctx.transform.decompose(),me=et(Ot.rotate.shx),Kt=new l,Ct=(Kt=(Kt=(Kt=Kt.multiply(Ot.translate)).multiply(Ot.skew)).multiply(Ot.scale)).applyToRectangle(new a(ot-q*Vt,ft-U*j,X*Nt,Q*Pt));if(this.autoPaging){for(var Zt,It=_.call(this,Ct),$t=[],Yt=0;Yt<It.length;Yt+=1)$t.indexOf(It[Yt])===-1&&$t.push(It[Yt]);I($t);for(var De=$t[0],ye=$t[$t.length-1],le=De;le<ye+1;le++){this.pdf.setPage(le);var Se=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xe=le===1?this.posY+this.margin[0]:this.margin[0],qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],de=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Wt=le===1?0:qt+(le-2)*de;if(this.ctx.clip_path.length!==0){var hi=this.path;Zt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(Zt,this.posX+this.margin[3],-Wt+xe+this.ctx.prevPageLastElemOffset),V.call(this,"fill",!0),this.path=hi}var Le=JSON.parse(JSON.stringify(Ct));Le=E([Le],this.posX+this.margin[3],-Wt+xe+this.ctx.prevPageLastElemOffset)[0];var ve=(le>De||le<ye)&&y.call(this);ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Se,de,null).clip().discardPath()),this.pdf.addImage(T,"JPEG",Le.x,Le.y,Le.w,Le.h,null,null,me),ve&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(T,"JPEG",Ct.x,Ct.y,Ct.w,Ct.h,null,null,me)};var _=function(T,q,U){var X=[];q=q||this.pdf.internal.pageSize.width,U=U||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Q=this.posY+this.ctx.prevPageLastElemOffset;switch(T.type){default:case"mt":case"lt":X.push(Math.floor((T.y+Q)/U)+1);break;case"arc":X.push(Math.floor((T.y+Q-T.radius)/U)+1),X.push(Math.floor((T.y+Q+T.radius)/U)+1);break;case"qct":var ot=dt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x,T.y);X.push(Math.floor((ot.y+Q)/U)+1),X.push(Math.floor((ot.y+ot.h+Q)/U)+1);break;case"bct":var ft=kt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x2,T.y2,T.x,T.y);X.push(Math.floor((ft.y+Q)/U)+1),X.push(Math.floor((ft.y+ft.h+Q)/U)+1);break;case"rect":X.push(Math.floor((T.y+Q)/U)+1),X.push(Math.floor((T.y+T.h+Q)/U)+1)}for(var pt=0;pt<X.length;pt+=1)for(;this.pdf.internal.getNumberOfPages()<X[pt];)x.call(this);return X},x=function(){var T=this.fillStyle,q=this.strokeStyle,U=this.font,X=this.lineCap,Q=this.lineWidth,ot=this.lineJoin;this.pdf.addPage(),this.fillStyle=T,this.strokeStyle=q,this.font=U,this.lineCap=X,this.lineWidth=Q,this.lineJoin=ot},E=function(T,q,U){for(var X=0;X<T.length;X++)switch(T[X].type){case"bct":T[X].x2+=q,T[X].y2+=U;case"qct":T[X].x1+=q,T[X].y1+=U;default:T[X].x+=q,T[X].y+=U}return T},I=function(T){return T.sort(function(q,U){return q-U})},O=function(T,q){var U=this.fillStyle,X=this.strokeStyle,Q=this.lineCap,ot=this.lineWidth,ft=Math.abs(ot*this.ctx.transform.scaleX),pt=this.lineJoin;if(this.autoPaging){for(var vt,Lt,Nt=JSON.parse(JSON.stringify(this.path)),Pt=JSON.parse(JSON.stringify(this.path)),Vt=[],j=0;j<Pt.length;j++)if(Pt[j].x!==void 0)for(var Ot=_.call(this,Pt[j]),me=0;me<Ot.length;me+=1)Vt.indexOf(Ot[me])===-1&&Vt.push(Ot[me]);for(var Kt=0;Kt<Vt.length;Kt++)for(;this.pdf.internal.getNumberOfPages()<Vt[Kt];)x.call(this);I(Vt);for(var Ct=Vt[0],Zt=Vt[Vt.length-1],It=Ct;It<Zt+1;It++){this.pdf.setPage(It),this.fillStyle=U,this.strokeStyle=X,this.lineCap=Q,this.lineWidth=ft,this.lineJoin=pt;var $t=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Yt=It===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ye=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],le=It===1?0:De+(It-2)*ye;if(this.ctx.clip_path.length!==0){var Se=this.path;vt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(vt,this.posX+this.margin[3],-le+Yt+this.ctx.prevPageLastElemOffset),V.call(this,T,!0),this.path=Se}if(Lt=JSON.parse(JSON.stringify(Nt)),this.path=E(Lt,this.posX+this.margin[3],-le+Yt+this.ctx.prevPageLastElemOffset),q===!1||It===0){var xe=(It>Ct||It<Zt)&&y.call(this);xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$t,ye,null).clip().discardPath()),V.call(this,T,q),xe&&this.pdf.restoreGraphicsState()}this.lineWidth=ot}this.path=Nt}else this.lineWidth=ft,V.call(this,T,q),this.lineWidth=ot},V=function(T,q){if((T!=="stroke"||q||!b.call(this))&&(T==="stroke"||q||!f.call(this))){for(var U,X,Q=[],ot=this.path,ft=0;ft<ot.length;ft++){var pt=ot[ft];switch(pt.type){case"begin":Q.push({begin:!0});break;case"close":Q.push({close:!0});break;case"mt":Q.push({start:pt,deltas:[],abs:[]});break;case"lt":var vt=Q.length;if(ot[ft-1]&&!isNaN(ot[ft-1].x)&&(U=[pt.x-ot[ft-1].x,pt.y-ot[ft-1].y],vt>0)){for(;vt>=0;vt--)if(Q[vt-1].close!==!0&&Q[vt-1].begin!==!0){Q[vt-1].deltas.push(U),Q[vt-1].abs.push(pt);break}}break;case"bct":U=[pt.x1-ot[ft-1].x,pt.y1-ot[ft-1].y,pt.x2-ot[ft-1].x,pt.y2-ot[ft-1].y,pt.x-ot[ft-1].x,pt.y-ot[ft-1].y],Q[Q.length-1].deltas.push(U);break;case"qct":var Lt=ot[ft-1].x+2/3*(pt.x1-ot[ft-1].x),Nt=ot[ft-1].y+2/3*(pt.y1-ot[ft-1].y),Pt=pt.x+2/3*(pt.x1-pt.x),Vt=pt.y+2/3*(pt.y1-pt.y),j=pt.x,Ot=pt.y;U=[Lt-ot[ft-1].x,Nt-ot[ft-1].y,Pt-ot[ft-1].x,Vt-ot[ft-1].y,j-ot[ft-1].x,Ot-ot[ft-1].y],Q[Q.length-1].deltas.push(U);break;case"arc":Q.push({deltas:[],abs:[],arc:!0}),Array.isArray(Q[Q.length-1].abs)&&Q[Q.length-1].abs.push(pt)}}X=q?null:T==="stroke"?"stroke":"fill";for(var me=!1,Kt=0;Kt<Q.length;Kt++)if(Q[Kt].arc)for(var Ct=Q[Kt].abs,Zt=0;Zt<Ct.length;Zt++){var It=Ct[Zt];It.type==="arc"?W.call(this,It.x,It.y,It.radius,It.startAngle,It.endAngle,It.counterclockwise,void 0,q,!me):H.call(this,It.x,It.y),me=!0}else if(Q[Kt].close===!0)this.pdf.internal.out("h"),me=!1;else if(Q[Kt].begin!==!0){var $t=Q[Kt].start.x,Yt=Q[Kt].start.y;z.call(this,Q[Kt].deltas,$t,Yt),me=!0}X&&M.call(this,X),q&&J.call(this)}},Z=function(T){var q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,U=q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return T-U;case"top":return T+q-U;case"hanging":return T+q-2*U;case"middle":return T+q/2-U;default:return T}},nt=function(T){return T+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var T=function(){};return T.colorStops=[],T.addColorStop=function(q,U){this.colorStops.push([q,U])},T.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},T.isCanvasGradient=!0,T},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var W=function(T,q,U,X,Q,ot,ft,pt,vt){for(var Lt=lt.call(this,U,X,Q,ot),Nt=0;Nt<Lt.length;Nt++){var Pt=Lt[Nt];Nt===0&&(vt?L.call(this,Pt.x1+T,Pt.y1+q):H.call(this,Pt.x1+T,Pt.y1+q)),st.call(this,T,q,Pt.x2,Pt.y2,Pt.x3,Pt.y3,Pt.x4,Pt.y4)}pt?J.call(this):M.call(this,ft)},M=function(T){switch(T){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(T,q){this.pdf.internal.out(e(T)+" "+i(q)+" m")},N=function(T){var q;switch(T.align){case"right":case"end":q="right";break;case"center":q="center";break;default:q="left"}var U,X,Q,ot=this.pdf.getTextDimensions(T.text),ft=Z.call(this,T.y),pt=nt.call(this,ft)-ot.h,vt=this.ctx.transform.applyToPoint(new o(T.x,ft));if(this.autoPaging){var Lt=this.ctx.transform.decompose(),Nt=new l;Nt=(Nt=(Nt=Nt.multiply(Lt.translate)).multiply(Lt.skew)).multiply(Lt.scale);for(var Pt=this.ctx.transform.applyToRectangle(new a(T.x,ft,ot.w,ot.h)),Vt=Nt.applyToRectangle(new a(T.x,pt,ot.w,ot.h)),j=_.call(this,Vt),Ot=[],me=0;me<j.length;me+=1)Ot.indexOf(j[me])===-1&&Ot.push(j[me]);I(Ot);for(var Kt=Ot[0],Ct=Ot[Ot.length-1],Zt=Kt;Zt<Ct+1;Zt++){this.pdf.setPage(Zt);var It=Zt===1?this.posY+this.margin[0]:this.margin[0],$t=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Yt=this.pdf.internal.pageSize.height-this.margin[2],De=Yt-this.margin[0],ye=this.pdf.internal.pageSize.width-this.margin[1],le=ye-this.margin[3],Se=Zt===1?0:$t+(Zt-2)*De;if(this.ctx.clip_path.length!==0){var xe=this.path;U=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(U,this.posX+this.margin[3],-1*Se+It),V.call(this,"fill",!0),this.path=xe}var qt=E([JSON.parse(JSON.stringify(Vt))],this.posX+this.margin[3],-Se+It+this.ctx.prevPageLastElemOffset)[0];T.scale>=.01&&(X=this.pdf.internal.getFontSize(),this.pdf.setFontSize(X*T.scale),Q=this.lineWidth,this.lineWidth=Q*T.scale);var de=this.autoPaging!=="text";if(de||qt.y+qt.h<=Yt){if(de||qt.y>=It&&qt.x<=ye){var Wt=de?T.text:this.pdf.splitTextToSize(T.text,T.maxWidth||ye-qt.x)[0],hi=E([JSON.parse(JSON.stringify(Pt))],this.posX+this.margin[3],-Se+It+this.ctx.prevPageLastElemOffset)[0],Le=de&&(Zt>Kt||Zt<Ct)&&y.call(this);Le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],le,De,null).clip().discardPath()),this.pdf.text(Wt,hi.x,hi.y,{angle:T.angle,align:q,renderingMode:T.renderingMode}),Le&&this.pdf.restoreGraphicsState()}}else qt.y<Yt&&(this.ctx.prevPageLastElemOffset+=Yt-qt.y);T.scale>=.01&&(this.pdf.setFontSize(X),this.lineWidth=Q)}}else T.scale>=.01&&(X=this.pdf.internal.getFontSize(),this.pdf.setFontSize(X*T.scale),Q=this.lineWidth,this.lineWidth=Q*T.scale),this.pdf.text(T.text,vt.x+this.posX,vt.y+this.posY,{angle:T.angle,align:q,renderingMode:T.renderingMode,maxWidth:T.maxWidth}),T.scale>=.01&&(this.pdf.setFontSize(X),this.lineWidth=Q)},H=function(T,q,U,X){U=U||0,X=X||0,this.pdf.internal.out(e(T+U)+" "+i(q+X)+" l")},z=function(T,q,U){return this.pdf.lines(T,q,U,null,null)},st=function(T,q,U,X,Q,ot,ft,pt){this.pdf.internal.out([t(n(U+T)),t(s(X+q)),t(n(Q+T)),t(s(ot+q)),t(n(ft+T)),t(s(pt+q)),"c"].join(" "))},lt=function(T,q,U,X){for(var Q=2*Math.PI,ot=Math.PI/2;q>U;)q-=Q;var ft=Math.abs(U-q);ft<Q&&X&&(ft=Q-ft);for(var pt=[],vt=X?-1:1,Lt=q;ft>1e-5;){var Nt=Lt+vt*Math.min(ft,ot);pt.push(ht.call(this,T,Lt,Nt)),ft-=Math.abs(Nt-Lt),Lt=Nt}return pt},ht=function(T,q,U){var X=(U-q)/2,Q=T*Math.cos(X),ot=T*Math.sin(X),ft=Q,pt=-ot,vt=ft*ft+pt*pt,Lt=vt+ft*Q+pt*ot,Nt=4/3*(Math.sqrt(2*vt*Lt)-Lt)/(ft*ot-pt*Q),Pt=ft-Nt*pt,Vt=pt+Nt*ft,j=Pt,Ot=-Vt,me=X+q,Kt=Math.cos(me),Ct=Math.sin(me);return{x1:T*Math.cos(q),y1:T*Math.sin(q),x2:Pt*Kt-Vt*Ct,y2:Pt*Ct+Vt*Kt,x3:j*Kt-Ot*Ct,y3:j*Ct+Ot*Kt,x4:T*Math.cos(U),y4:T*Math.sin(U)}},et=function(T){return 180*T/Math.PI},dt=function(T,q,U,X,Q,ot){var ft=T+.5*(U-T),pt=q+.5*(X-q),vt=Q+.5*(U-Q),Lt=ot+.5*(X-ot),Nt=Math.min(T,Q,ft,vt),Pt=Math.max(T,Q,ft,vt),Vt=Math.min(q,ot,pt,Lt),j=Math.max(q,ot,pt,Lt);return new a(Nt,Vt,Pt-Nt,j-Vt)},kt=function(T,q,U,X,Q,ot,ft,pt){var vt,Lt,Nt,Pt,Vt,j,Ot,me,Kt,Ct,Zt,It,$t,Yt,De=U-T,ye=X-q,le=Q-U,Se=ot-X,xe=ft-Q,qt=pt-ot;for(Lt=0;Lt<41;Lt++)Kt=(Ot=(Nt=T+(vt=Lt/40)*De)+vt*((Vt=U+vt*le)-Nt))+vt*(Vt+vt*(Q+vt*xe-Vt)-Ot),Ct=(me=(Pt=q+vt*ye)+vt*((j=X+vt*Se)-Pt))+vt*(j+vt*(ot+vt*qt-j)-me),Lt==0?(Zt=Kt,It=Ct,$t=Kt,Yt=Ct):(Zt=Math.min(Zt,Kt),It=Math.min(It,Ct),$t=Math.max($t,Kt),Yt=Math.max(Yt,Ct));return new a(Math.round(Zt),Math.round(It),Math.round($t-Zt),Math.round(Yt-It))},xt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var T,q,U=(T=this.ctx.lineDash,q=this.ctx.lineDashOffset,JSON.stringify({lineDash:T,lineDashOffset:q}));this.prevLineDash!==U&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=U)}}})(Ut.API),(function(r){var t=function(o){var a,l,c,h,p,m,f,b,y,_;for(l=[],c=0,h=(o+=a="\0\0\0\0".slice(o.length%4||4)).length;h>c;c+=4)(p=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(m=(p=((p=((p=((p=(p-(_=p%85))/85)-(y=p%85))/85)-(b=p%85))/85)-(f=p%85))/85)%85,l.push(m+33,f+33,b+33,y+33,_+33)):l.push(122);return(function(x,E){for(var I=E;I>0;I--)x.pop()})(l,a.length),String.fromCharCode.apply(String,l)+"~>"},e=function(o){var a,l,c,h,p,m=String,f="length",b=255,y="charCodeAt",_="slice",x="replace";for(o[_](-2),o=o[_](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],h=0,p=(o+=a="uuuuu"[_](o[f]%5||5))[f];p>h;h+=5)l=52200625*(o[y](h)-33)+614125*(o[y](h+1)-33)+7225*(o[y](h+2)-33)+85*(o[y](h+3)-33)+(o[y](h+4)-33),c.push(b&l>>24,b&l>>16,b&l>>8,b&l);return(function(E,I){for(var O=I;O>0;O--)E.pop()})(c,a[f]),m.fromCharCode.apply(m,c)},i=function(o){return o.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(o){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),a.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},s=function(o){for(var a=new Uint8Array(o.length),l=o.length;l--;)a[l]=o.charCodeAt(l);return(a=mp(a)).reduce(function(c,h){return c+String.fromCharCode(h)},"")};r.processDataByFilters=function(o,a){var l=0,c=o||"",h=[];for(typeof(a=a||[])=="string"&&(a=[a]),l=0;l<a.length;l+=1)switch(a[l]){case"ASCII85Decode":case"/ASCII85Decode":c=e(c),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=i(c),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[l]+'" is not implemented')}return{data:c,reverseChain:h.reverse().join(" ")}}})(Ut.API),(function(r){r.loadFile=function(t,e,i){return(function(n,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=(function(l,c,h){var p=new XMLHttpRequest,m=0,f=function(b){var y=b.length,_=[],x=String.fromCharCode;for(m=0;m<y;m+=1)_.push(x(255&b.charCodeAt(m)));return _.join("")};if(p.open("GET",l,!c),p.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(p.onload=function(){p.status===200?h(f(this.responseText)):h(void 0)}),p.send(null),c&&p.status===200)return f(p.responseText)})(n,s,o)}catch{}return a})(t,e,i)},r.loadImageFile=r.loadFile})(Ut.API),(function(r){function t(){return(re.html2canvas?Promise.resolve(re.html2canvas):pf(()=>import("./html2canvas.esm-DXEQVQnt.js"),[],import.meta.url)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function e(){return(re.DOMPurify?Promise.resolve(re.DOMPurify):pf(()=>import("./purify.es-Bzr520pe.js"),[],import.meta.url)).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var i=function(a){var l=Re(a);return l==="undefined"?"undefined":l==="string"||a instanceof String?"string":l==="number"||a instanceof Number?"number":l==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":l==="object"?"object":"unknown"},n=function(a,l){var c=document.createElement(a);for(var h in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[h]=l.style[h];return c},s=function a(l,c){for(var h=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),p=l.firstChild;p;p=p.nextSibling)c!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(a(p,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(h.width=l.width,h.height=l.height,h.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(h.value=l.value),h.addEventListener("load",function(){h.scrollTop=l.scrollTop,h.scrollLeft=l.scrollLeft},!0)),h},o=function a(l){var c=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),h=a.convert(Promise.resolve(),c);return(h=h.setProgress(1,a,1,[a])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(a,l){return a.__proto__=l||o.prototype,a},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(a,l){return this.then(function(){switch(l=l||(function(c){switch(i(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),l){case"string":return this.then(e).then(function(c){return this.set({src:n("div",{innerHTML:a,dompurify:c})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},o.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(l){var c=this.opt.jsPDF,h=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=h,h)for(var f=0;f<h.length;++f){var b=h[f],y=b.src.find(function(_){return _.format==="truetype"});y&&c.addFont(y.url,b.ref.name,b.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,c.context2d.save(!0),l(this.prop.container,m)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(a,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(a,l):this.outputPdf(a,l)},o.prototype.outputPdf=function(a,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,l)})},o.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},o.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(a){if(i(a)!=="object")return this;var l=Object.keys(a||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=a[c]};switch(c){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[c]=a[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(a,l){return this.then(function(){var c=a in o.template.prop?this.prop[a]:this.opt[a];return l?l(c):c})},o.prototype.setMargin=function(a){return this.then(function(){switch(i(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},o.prototype.setPageSize=function(a){function l(c,h){return Math.floor(c*h/72*96)}return this.then(function(){(a=a||Ut.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:l(a.inner.width,a.k),height:l(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},o.prototype.setProgress=function(a,l,c,h){return a!=null&&(this.progress.val=a),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(a,l,c,h){return this.setProgress(a?this.progress.val+a:null,l||null,c?this.progress.n+c:null,h?this.progress.stack.concat(h):null)},o.prototype.then=function(a,l){var c=this;return this.thenCore(a,l,function(h,p){return c.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(m){return c.updateProgress(null,h),m}).then(h,p).then(function(m){return c.updateProgress(1),m})})},o.prototype.thenCore=function(a,l,c){c=c||Promise.prototype.then;var h=this;a&&(a=a.bind(h)),l&&(l=l.bind(h));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:o.convert(Object.assign({},h),Promise.prototype),m=c.call(p,a,l);return o.convert(m,h.__proto__)},o.prototype.thenExternal=function(a,l){return Promise.prototype.then.call(this,a,l)},o.prototype.thenList=function(a){var l=this;return a.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(a){a&&(a=a.bind(this));var l=Promise.prototype.catch.call(this,a);return o.convert(l,this)},o.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},o.prototype.error=function(a){return this.then(function(){throw new Error(a)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Ut.getPageSize=function(a,l,c){if(Re(a)==="object"){var h=a;a=h.orientation,l=h.unit||l,c=h.format||c}l=l||"mm",c=c||"a4",a=(""+(a||"P")).toLowerCase();var p,m=(""+c).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+l}var b,y=0,_=0;if(f.hasOwnProperty(m))y=f[m][1]/p,_=f[m][0]/p;else try{y=c[1],_=c[0]}catch{throw new Error("Invalid format: "+c)}if(a==="p"||a==="portrait")a="p",_>y&&(b=_,_=y,y=b);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",y>_&&(b=_,_=y,y=b)}return{width:_,height:y,unit:l,k:p,orientation:a}},r.html=function(a,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Nf):null;var c=new o(l);return l.worker?c:c.from(a).doCallback()}})(Ut.API),Ut.API.addJS=function(r){return v1=r,this.internal.events.subscribe("postPutResources",function(){Yh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Yh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),m1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+v1+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Yh!==void 0&&m1!==void 0&&this.internal.out("/Names <</JavaScript "+Yh+" 0 R>>")}),this},(function(r){var t;r.events.push(["postPutResources",function(){var e=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=e.outline.render().split(/\r\n/),s=0;s<n.length;s++){var o=n[s],a=i.exec(o);if(a!=null){var l=a[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(o)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,h=[];for(s=0;s<c;s++){var p=e.internal.newObject();h.push(p);var m=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var f=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<h.length;s++)e.internal.write("(page_"+(s+1)+")"+h[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+f+" 0 R"),e.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(i,n,s){var o={title:n,options:s,children:[]};return i==null&&(i=this.root),i.children.push(o),o},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(i){i.id=e.internal.newObjectDeferred();for(var n=0;n<i.children.length;n++)this.genIds_r(i.children[n])},e.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},e.outline.renderItems=function(i){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var o=i.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var l=e.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var c=0;c<i.children.length;c++)this.renderItems(i.children[c])},e.outline.line=function(i){this.ctx.val+=i+`\r
`},e.outline.makeRef=function(i){return i.id+" 0 R"},e.outline.makeString=function(i){return"("+e.internal.pdfEscape(i)+")"},e.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(i,n){for(var s=0;s<n.children.length;s++)i.count++,this.count_r(i,n.children[s]);return i.count}}])})(Ut.API),(function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(e,i,n,s,o,a){var l,c=this.decode.DCT_DECODE,h=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=o||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,l=(function(p){for(var m,f=256*p.charCodeAt(4)+p.charCodeAt(5),b=p.length,y={width:0,height:0,numcomponents:1},_=4;_<b;_+=2){if(_+=f,t.indexOf(p.charCodeAt(_+1))!==-1){m=256*p.charCodeAt(_+5)+p.charCodeAt(_+6),y={width:256*p.charCodeAt(_+7)+p.charCodeAt(_+8),height:m,numcomponents:p.charCodeAt(_+9)};break}f=256*p.charCodeAt(_+2)+p.charCodeAt(_+3)}return y})(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),l.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}h={data:e,width:l.width,height:l.height,colorSpace:a,bitsPerComponent:8,filter:c,index:i,alias:n}}return h}})(Ut.API),Ut.API.processPNG=function(r,t,e,i){if(this.__addimage__.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.__addimage__.isArrayBufferView(r)){var n,s=tk(r,{checkCrc:!0}),o=s.width,a=s.height,l=s.channels,c=s.palette,h=s.depth;n=c&&l===1?(function(W){for(var M=W.width,J=W.height,L=W.data,N=W.palette,H=W.depth,z=!1,st=[],lt=[],ht=void 0,et=!1,dt=0,kt=0;kt<N.length;kt++){var xt=xm(N[kt],4),T=xt[0],q=xt[1],U=xt[2],X=xt[3];st.push(T,q,U),X!=null&&(X===0?(dt++,lt.length<1&&lt.push(kt)):X<255&&(et=!0))}if(et||dt>1){z=!0,lt=void 0;var Q=M*J;ht=new Uint8Array(Q);for(var ot=new DataView(L.buffer),ft=0;ft<Q;ft++){var pt=Mf(ot,ft,H),vt=xm(N[pt],4)[3];ht[ft]=vt}}else dt===0&&(lt=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:z?8:void 0,colorBytes:L,alphaBytes:ht,needSMask:z,palette:st,mask:lt}})(s):l===2||l===4?(function(W){for(var M=W.data,J=W.width,L=W.height,N=W.channels,H=W.depth,z=N===2?"DeviceGray":"DeviceRGB",st=N-1,lt=J*L,ht=st,et=lt*ht,dt=1*lt,kt=Math.ceil(et*H/8),xt=Math.ceil(dt*H/8),T=new Uint8Array(kt),q=new Uint8Array(xt),U=new DataView(M.buffer),X=new DataView(T.buffer),Q=new DataView(q.buffer),ot=!1,ft=0;ft<lt;ft++){for(var pt=ft*N,vt=0;vt<ht;vt++)A1(X,Mf(U,pt+vt,H),ft*ht+vt,H);var Lt=Mf(U,pt+ht,H);Lt<(1<<H)-1&&(ot=!0),A1(Q,Lt,1*ft,H)}return{colorSpace:z,colorsPerPixel:st,sMaskBitsPerComponent:ot?H:void 0,colorBytes:T,alphaBytes:q,needSMask:ot}})(s):(function(W){var M=W.data,J=W.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:J,colorsPerPixel:J==="DeviceGray"?1:3,colorBytes:M instanceof Uint16Array?(function(L){for(var N=L.length,H=new Uint8Array(2*N),z=new DataView(H.buffer,H.byteOffset,H.byteLength),st=0;st<N;st++)z.setUint16(2*st,L[st],!1);return H})(M):M,needSMask:!1}})(s);var p,m,f,b=n,y=b.colorSpace,_=b.colorsPerPixel,x=b.sMaskBitsPerComponent,E=b.colorBytes,I=b.alphaBytes,O=b.needSMask,V=b.palette,Z=b.mask,nt=null;return i!==Ut.API.image_compression.NONE&&typeof mp=="function"?(nt=(function(W){var M;switch(W){case Ut.API.image_compression.FAST:M=11;break;case Ut.API.image_compression.MEDIUM:M=13;break;case Ut.API.image_compression.SLOW:M=14;break;default:M=12}return M})(i),p=this.decode.FLATE_DECODE,m="/Predictor ".concat(nt," /Colors ").concat(_," /BitsPerComponent ").concat(h," /Columns ").concat(o),r=x1(E,Math.ceil(o*_*h/8),_,h,i),O&&(f=x1(I,Math.ceil(o*x/8),1,x,i))):(p=void 0,m=void 0,r=E,O&&(f=I)),(this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r))&&(r=this.__addimage__.arrayBufferToBinaryString(r)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:e,data:r,index:t,filter:p,decodeParameters:m,transparency:Z,palette:V,sMask:f,predictor:nt,width:o,height:a,bitsPerComponent:h,sMaskBitsPerComponent:x,colorSpace:y}}},(function(r){r.processGIF89A=function(t,e,i,n){var s=new xk(t),o=s.width,a=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:o,height:a},h=new If(100).encode(c,100);return r.processJPEG.call(this,h,e,i,n)},r.processGIF87A=r.processGIF89A})(Ut.API),yn.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var e=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:i,blue:e,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yn.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(e){He.log("bit decode error:"+e)}},yn.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),e=t%4;for(r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+8*n*4,a=0;a<8&&8*n+a<this.width;a++){var l=this.palette[s>>7-a&1];this.data[o+4*a]=l.blue,this.data[o+4*a+1]=l.green,this.data[o+4*a+2]=l.red,this.data[o+4*a+3]=255}e!==0&&(this.pos+=4-e)}},yn.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,n=0;n<r;n++){var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+2*n*4,a=s>>4,l=15&s,c=this.palette[a];if(this.data[o]=c.blue,this.data[o+1]=c.green,this.data[o+2]=c.red,this.data[o+3]=255,2*n+1>=this.width)break;c=this.palette[l],this.data[o+4]=c.blue,this.data[o+4+1]=c.green,this.data[o+4+2]=c.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},yn.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*i;if(n<this.palette.length){var o=this.palette[n];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},yn.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,a=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,c=s>>15?255:0,h=i*this.width*4+4*n;this.data[h]=l,this.data[h+1]=a,this.data[h+2]=o,this.data[h+3]=c}this.pos+=r}},yn.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&t)/t*255|0,l=(o>>5&e)/e*255|0,c=(o>>11)/t*255|0,h=n*this.width*4+4*s;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=a,this.data[h+3]=255}this.pos+=r}},yn.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=i,this.data[o+3]=255}this.pos+=this.width%4}},yn.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=s,this.data[a+1]=n,this.data[a+2]=i,this.data[a+3]=o}},yn.prototype.getData=function(){return this.data},(function(r){r.processBMP=function(t,e,i,n){var s=new yn(t,!1),o=s.width,a=s.height,l={data:s.getData(),width:o,height:a},c=new If(100).encode(l,100);return r.processJPEG.call(this,c,e,i,n)}})(Ut.API),T1.prototype.getData=function(){return this.data},(function(r){r.processWEBP=function(t,e,i,n){var s=new T1(t),o=s.width,a=s.height,l={data:s.getData(),width:o,height:a},c=new If(100).encode(l,100);return r.processJPEG.call(this,c,e,i,n)}})(Ut.API),Ut.API.processRGBA=function(r,t,e){for(var i=r.data,n=i.length,s=new Uint8Array(n/4*3),o=new Uint8Array(n/4),a=0,l=0,c=0;c<n;c+=4){var h=i[c],p=i[c+1],m=i[c+2],f=i[c+3];s[a++]=h,s[a++]=p,s[a++]=m,o[l++]=f}var b=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},Ut.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Oa=Ut.API,Gh=Oa.getCharWidthsArray=function(r,t){var e,i,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:n.metadata.Unicode.widths,l=a.fof?a.fof:1,c=t.kerning?t.kerning:n.metadata.Unicode.kerning,h=c.fof?c.fof:1,p=t.doKerning!==!1,m=0,f=r.length,b=0,y=a[0]||l,_=[];for(e=0;e<f;e++)i=r.charCodeAt(e),typeof n.metadata.widthOfString=="function"?_.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(i))+o*(1e3/s)||0)/1e3):(m=p&&Re(c[i])==="object"&&!isNaN(parseInt(c[i][b],10))?c[i][b]/h:0,_.push((a[i]||y)/l+m)),b=i;return _},w1=Oa.getStringUnitWidth=function(r,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),i=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Oa.processArabic&&(r=Oa.processArabic(r)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(r,e,n)/e:Gh.apply(this,arguments).reduce(function(s,o){return s+o},0)},b1=function(r,t,e,i){for(var n=[],s=0,o=r.length,a=0;s!==o&&a+t[s]<e;)a+=t[s],s++;n.push(r.slice(0,s));var l=s;for(a=0;s!==o;)a+t[s]>i&&(n.push(r.slice(l,s)),a=0,l=s),a+=t[s],s++;return l!==s&&n.push(r.slice(l,s)),n},y1=function(r,t,e){e||(e={});var i,n,s,o,a,l,c,h=[],p=[h],m=e.textIndent||0,f=0,b=0,y=r.split(" "),_=Gh.apply(this,[" ",e])[0];if(l=e.lineIndent===-1?y[0].length+2:e.lineIndent||0){var x=Array(l).join(" "),E=[];y.map(function(O){(O=O.split(/\s*\n/)).length>1?E=E.concat(O.map(function(V,Z){return(Z&&V.length?`
`:"")+V})):E.push(O[0])}),y=E,l=w1.apply(this,[x,e])}for(s=0,o=y.length;s<o;s++){var I=0;if(i=y[s],l&&i[0]==`
`&&(i=i.substr(1),I=1),m+f+(b=(n=Gh.apply(this,[i,e])).reduce(function(O,V){return O+V},0))>t||I){if(b>t){for(a=b1.apply(this,[i,n,t-(m+f),t]),h.push(a.shift()),h=[a.pop()];a.length;)p.push([a.shift()]);b=n.slice(i.length-(h[0]?h[0].length:0)).reduce(function(O,V){return O+V},0)}else h=[i];p.push(h),m=b+l,f=_}else h.push(i),m+=f+b,f=_}return c=l?function(O,V){return(V?x:"")+O.join(" ")}:function(O){return O.join(" ")},p.map(c)},Oa.splitTextToSize=function(r,t,e){var i,n=(e=e||{}).fontSize||this.internal.getFontSize(),s=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var p=this.internal.getFont(h.fontName,h.fontStyle),m="Unicode";return p.metadata[m]?{widths:p.metadata[m].widths||{0:1},kerning:p.metadata[m].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);i=Array.isArray(r)?r:String(r).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;s.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=e.lineIndent;var a,l,c=[];for(a=0,l=i.length;a<l;a++)c=c.concat(y1.apply(this,[i[a],o,s]));return c},(function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="0123456789abcdef",e="klmnopqrstuvwxyz",i={},n={},s=0;s<16;s++)i[e[s]]=t[s],n[t[s]]=e[s];var o=function(m){return"0x"+parseInt(m,10).toString(16)},a=r.__fontmetrics__.compress=function(m){var f,b,y,_,x=["{"];for(var E in m){if(f=m[E],isNaN(parseInt(E,10))?b="'"+E+"'":(E=parseInt(E,10),b=(b=o(E).slice(2)).slice(0,-1)+n[b.slice(-1)]),typeof f=="number")f<0?(y=o(f).slice(3),_="-"):(y=o(f).slice(2),_=""),y=_+y.slice(0,-1)+n[y.slice(-1)];else{if(Re(f)!=="object")throw new Error("Don't know what to do with value type "+Re(f)+".");y=a(f)}x.push(b+y)}return x.push("}"),x.join("")},l=r.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,b,y,_,x={},E=1,I=x,O=[],V="",Z="",nt=m.length-1,W=1;W<nt;W+=1)(_=m[W])=="'"?f?(y=f.join(""),f=void 0):f=[]:f?f.push(_):_=="{"?(O.push([I,y]),I={},y=void 0):_=="}"?((b=O.pop())[0][b[1]]=I,y=void 0,I=b[0]):_=="-"?E=-1:y===void 0?i.hasOwnProperty(_)?(V+=i[_],y=parseInt(V,16)*E,E=1,V=""):V+=_:i.hasOwnProperty(_)?(Z+=i[_],I[y]=parseInt(Z,16)*E,E=1,y=void 0,Z=""):Z+=_;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},p={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(m){var f=m.font,b=p.Unicode[f.postScriptName];b&&(f.metadata.Unicode={},f.metadata.Unicode.widths=b.widths,f.metadata.Unicode.kerning=b.kerning);var y=h.Unicode[f.postScriptName];y&&(f.metadata.Unicode.encoding=y,f.encoding=y.codePages[0])}])})(Ut.API),(function(r){var t=function(e){for(var i=e.length,n=new Uint8Array(i),s=0;s<i;s++)n[s]=e.charCodeAt(s);return n};r.API.events.push(["addFont",function(e){var i=void 0,n=e.font,s=e.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(i=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(nu(a)),o.metadata=r.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,i)}}])})(Ut),Ut.API.addSvgAsImage=function(r,t,e,i,n,s,o,a){if(isNaN(t)||isNaN(e))throw He.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(n))throw He.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=i,l.height=n;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(re.canvg?Promise.resolve(re.canvg):pf(()=>import("./index.es-Qc4JcOqU.js"),__vite__mapDeps([0,1,2]),import.meta.url)).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(c,r,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){p.addImage(l.toDataURL("image/jpeg",1),t,e,i,n,o,a)})},Ut.API.putTotalPages=function(r){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var n=0;n<this.internal.pages[i].length;n++)this.internal.pages[i][n]=this.internal.pages[i][n].replace(t,e);return this},Ut.API.viewerPreferences=function(r,t){var e;r=r||{},t=t||!1;var i,n,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),l=[],c=0,h=0,p=0;function m(b,y){var _,x=!1;for(_=0;_<b.length;_+=1)b[_]===y&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var f=a.length;for(p=0;p<f;p+=1)e[a[p]].value=e[a[p]].defaultValue,e[a[p]].explicitSet=!1}if(Re(r)==="object"){for(n in r)if(s=r[n],m(a,n)&&s!==void 0){if(e[n].type==="boolean"&&typeof s=="boolean")e[n].value=s;else if(e[n].type==="name"&&m(e[n].valueSet,s))e[n].value=s;else if(e[n].type==="integer"&&Number.isInteger(s))e[n].value=s;else if(e[n].type==="array"){for(c=0;c<s.length;c+=1)if(i=!0,s[c].length===1&&typeof s[c][0]=="number")l.push(String(s[c]-1));else if(s[c].length>1){for(h=0;h<s[c].length;h+=1)typeof s[c][h]!="number"&&(i=!1);i===!0&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}e[n].value="["+l.join(" ")+"]"}else e[n].value=e[n].defaultValue;e[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,y=[];for(b in e)e[b].explicitSet===!0&&(e[b].type==="name"?y.push("/"+b+" /"+e[b].value):y.push("/"+b+" "+e[b].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},(function(r){var t=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(i)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=s.length+o.length+a.length+n.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(n+s+o+a+l),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(i,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}})(Ut.API),(function(r){var t=r.API,e=t.pdfEscape16=function(s,o){for(var a,l=o.metadata.Unicode.widths,c=["","0","00","000","0000"],h=[""],p=0,m=s.length;p<m;++p){if(a=o.metadata.characterToGlyph(s.charCodeAt(p)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=s.charCodeAt(p),l.indexOf(a)==-1&&(l.push(a),l.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return h.join("");a=a.toString(16),h.push(c[4-a.length],a)}return h.join("")},i=function(s){var o,a,l,c,h,p,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],p=0,m=(a=Object.keys(s).sort(function(f,b){return f-b})).length;p<m;p++)o=a[p],l.length>=100&&(h+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(c=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),l.push("<"+o+"><"+c+">"));return l.length&&(h+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var a=o.font,l=o.out,c=o.newObject,h=o.putStream;if(a.metadata instanceof r.API.TTFFont&&a.encoding==="Identity-H"){for(var p=a.metadata.Unicode.widths,m=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),f="",b=0;b<m.length;b++)f+=String.fromCharCode(m[b]);var y=c();h({data:f,addLength1:!0,objectId:y}),l("endobj");var _=c();h({data:i(a.metadata.toUnicode),addLength1:!0,objectId:_}),l("endobj");var x=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ia(a.fontName)),l("/FontFile2 "+y+" 0 R"),l("/FontBBox "+r.API.PDFObject.convert(a.metadata.bbox)),l("/Flags "+a.metadata.flags),l("/StemV "+a.metadata.stemV),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l(">>"),l("endobj");var E=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ia(a.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+r.API.PDFObject.convert(p)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+a.encoding+")"),l(">>"),l(">>"),l("endobj"),a.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+_+" 0 R"),l("/BaseFont /"+Ia(a.fontName)),l("/Encoding /"+a.encoding),l("/DescendantFonts ["+E+" 0 R]"),l(">>"),l("endobj"),a.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var a=o.font,l=o.out,c=o.newObject,h=o.putStream;if(a.metadata instanceof r.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var p=a.metadata.rawData,m="",f=0;f<p.length;f++)m+=String.fromCharCode(p[f]);var b=c();h({data:m,addLength1:!0,objectId:b}),l("endobj");var y=c();h({data:i(a.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var _=c();l("<<"),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l("/StemV "+a.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+b+" 0 R"),l("/Flags 96"),l("/FontBBox "+r.API.PDFObject.convert(a.metadata.bbox)),l("/FontName /"+Ia(a.fontName)),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l(">>"),l("endobj"),a.objectNumber=c();for(var x=0;x<a.metadata.hmtx.widths.length;x++)a.metadata.hmtx.widths[x]=parseInt(a.metadata.hmtx.widths[x]*(1e3/a.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+Ia(a.fontName)+"/FontDescriptor "+_+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),l("endobj"),a.isAlreadyPutted=!0}})(s)}]);var n=function(s){var o,a=s.text||"",l=s.x,c=s.y,h=s.options||{},p=s.mutex||{},m=p.pdfEscape,f=p.activeFontKey,b=p.fonts,y=f,_="",x=0,E="",I=b[y].encoding;if(b[y].encoding!=="Identity-H")return{text:a,x:l,y:c,options:h,mutex:p};for(E=a,y=f,Array.isArray(a)&&(E=a[0]),x=0;x<E.length;x+=1)b[y].metadata.hasOwnProperty("cmap")&&(o=b[y].metadata.cmap.unicode.codeMap[E[x].charCodeAt(0)]),o||E[x].charCodeAt(0)<256&&b[y].metadata.hasOwnProperty("Unicode")?_+=E[x]:_+="";var O="";return parseInt(y.slice(1))<14||I==="WinAnsiEncoding"?O=m(_,y).split("").map(function(V){return V.charCodeAt(0).toString(16)}).join(""):I==="Identity-H"&&(O=e(_,b[y])),p.isHex=!0,{text:O,x:l,y:c,options:h,mutex:p}};t.events.push(["postProcessText",function(s){var o=s.text||"",a=[],l={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var c=0;for(c=0;c<o.length;c+=1)Array.isArray(o[c])&&o[c].length===3?a.push([n(Object.assign({},l,{text:o[c][0]})).text,o[c][1],o[c][2]]):a.push(n(Object.assign({},l,{text:o[c]})).text);s.text=a}else s.text=n(Object.assign({},l,{text:o})).text}])})(Ut),(function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},r.addFileToVFS=function(e,i){return t.call(this),this.internal.vFS[e]=i,this},r.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}})(Ut.API),(function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(i){var n,s,o,a,l,c,h,p=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},_=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,I=0;this.__bidiEngine__={};var O=function(L){var N=L.charCodeAt(),H=N>>8,z=y[H];return z!==void 0?p[256*z+(255&N)]:H===252||H===253?"AL":x.test(H)?"L":H===8?"R":"N"},V=function(L){for(var N,H=0;H<L.length;H++){if((N=O(L.charAt(H)))==="L")return!1;if(N==="R")return!0}return!1},Z=function(L,N,H,z){var st,lt,ht,et,dt=N[z];switch(dt){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"N":case"AN":break;case"EN":E&&(dt="AN");break;case"AL":E=!0,dt="R";break;case"WS":case"BN":dt="N";break;case"CS":z<1||z+1>=N.length||(st=H[z-1])!=="EN"&&st!=="AN"||(lt=N[z+1])!=="EN"&&lt!=="AN"?dt="N":E&&(lt="AN"),dt=lt===st?lt:"N";break;case"ES":dt=(st=z>0?H[z-1]:"B")==="EN"&&z+1<N.length&&N[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&H[z-1]==="EN"){dt="EN";break}if(E){dt="N";break}for(ht=z+1,et=N.length;ht<et&&N[ht]==="ET";)ht++;dt=ht<et&&N[ht]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(et=N.length,ht=z+1;ht<et&&N[ht]==="NSM";)ht++;if(ht<et){var kt=L[z],xt=kt>=1425&&kt<=2303||kt===64286;if(st=N[ht],xt&&(st==="R"||st==="AL")){dt="R";break}}}dt=z<1||(st=N[z-1])==="B"?"N":H[z-1];break;case"B":E=!1,n=!0,dt=I;break;case"S":s=!0,dt="N"}return dt},nt=function(L,N,H){var z=L.split("");return H&&W(z,H,{hiLevel:I}),z.reverse(),N&&N.reverse(),z.join("")},W=function(L,N,H){var z,st,lt,ht,et,dt=-1,kt=L.length,xt=0,T=[],q=I?f:m,U=[];for(E=!1,n=!1,s=!1,st=0;st<kt;st++)U[st]=O(L[st]);for(lt=0;lt<kt;lt++){if(et=xt,T[lt]=Z(L,U,T,lt),z=240&(xt=q[et][b[T[lt]]]),xt&=15,N[lt]=ht=q[xt][5],z>0)if(z===16){for(st=dt;st<lt;st++)N[st]=1;dt=-1}else dt=-1;if(q[xt][6])dt===-1&&(dt=lt);else if(dt>-1){for(st=dt;st<lt;st++)N[st]=ht;dt=-1}U[lt]==="B"&&(N[lt]=0),H.hiLevel|=ht}s&&(function(X,Q,ot){for(var ft=0;ft<ot;ft++)if(X[ft]==="S"){Q[ft]=I;for(var pt=ft-1;pt>=0&&X[pt]==="WS";pt--)Q[pt]=I}})(U,N,kt)},M=function(L,N,H,z,st){if(!(st.hiLevel<L)){if(L===1&&I===1&&!n)return N.reverse(),void(H&&H.reverse());for(var lt,ht,et,dt,kt=N.length,xt=0;xt<kt;){if(z[xt]>=L){for(et=xt+1;et<kt&&z[et]>=L;)et++;for(dt=xt,ht=et-1;dt<ht;dt++,ht--)lt=N[dt],N[dt]=N[ht],N[ht]=lt,H&&(lt=H[dt],H[dt]=H[ht],H[ht]=lt);xt=et}xt++}}},J=function(L,N,H){var z=L.split(""),st={hiLevel:I};return H||(H=[]),W(z,H,st),(function(lt,ht,et){if(et.hiLevel!==0&&h)for(var dt,kt=0;kt<lt.length;kt++)ht[kt]===1&&(dt=_.indexOf(lt[kt]))>=0&&(lt[kt]=_[dt+1])})(z,H,st),M(2,z,N,H,st),M(1,z,N,H,st),z.join("")};return this.__bidiEngine__.doBidiReorder=function(L,N,H){if((function(st,lt){if(lt)for(var ht=0;ht<st.length;ht++)lt[ht]=ht;a===void 0&&(a=V(st)),c===void 0&&(c=V(st))})(L,N),o||!l||c)if(o&&l&&a^c)I=a?1:0,L=nt(L,N,H);else if(!o&&l&&c)I=a?1:0,L=J(L,N,H),L=nt(L,N);else if(!o||a||l||c){if(o&&!l&&a^c)L=nt(L,N),a?(I=0,L=J(L,N,H)):(I=1,L=J(L,N,H),L=nt(L,N));else if(o&&a&&!l&&c)I=1,L=J(L,N,H),L=nt(L,N);else if(!o&&!l&&a^c){var z=h;a?(I=1,L=J(L,N,H),I=0,h=!1,L=J(L,N,H),h=z):(I=0,L=J(L,N,H),L=nt(L,N),I=1,h=!1,L=J(L,N,H),h=z,L=nt(L,N))}}else I=0,L=J(L,N,H);else I=a?1:0,L=J(L,N,H);return L},this.__bidiEngine__.setOptions=function(L){L&&(o=L.isInputVisual,l=L.isOutputVisual,a=L.isInputRtl,c=L.isOutputRtl,h=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(i){var n=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,e.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var a=0;for(o=[],a=0;a<n.length;a+=1)Object.prototype.toString.call(n[a])==="[object Array]"?o.push([e.doBidiReorder(n[a][0]),n[a][1],n[a][2]]):o.push([e.doBidiReorder(n[a])]);i.text=o}else i.text=e.doBidiReorder(n);e.setOptions({isInputVisual:!0})}])})(Ut),Ut.API.TTFFont=(function(){function r(t){var e;if(this.rawData=t,e=this.contents=new yo(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new jk(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new _k(this.contents),this.head=new Ck(this),this.name=new Ek(this),this.cmap=new Z5(this),this.toUnicode={},this.hhea=new kk(this),this.maxp=new Ok(this),this.hmtx=new Pk(this),this.post=new Lk(this),this.os2=new Ak(this),this.loca=new Ik(this),this.glyf=new Nk(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,e,i,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,l,c;for(c=[],o=0,a=(l=this.bbox).length;o<a;o++)t=l[o],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(i=255&(n=this.post.italic_angle),32768&(e=n>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},r.prototype.widthOfString=function(t,e,i){var n,s,o,a;for(o=0,s=0,a=(t=""+t).length;0<=a?s<a:s>a;s=0<=a?++s:--s)n=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(n))+i*(1e3/e)||0;return o*(e/1e3)},r.prototype.lineHeight=function(t,e){var i;return e==null&&(e=!1),i=e?this.lineGap:0,(this.ascender+i-this.decender)/1e3*t},r})();var Nn,yo=(function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)i[e]=String.fromCharCode(this.readByte());return i.join("")},r.prototype.writeString=function(t){var e,i,n;for(n=[],e=0,i=t.length;0<=i?e<i:e>i;e=0<=i?++e:--e)n.push(this.writeByte(t.charCodeAt(e)));return n},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,e,i,n,s,o,a,l;return t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),a=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^i)+4294967296*(255^n)+16777216*(255^s)+65536*(255^o)+256*(255^a)+(255^l)+1):72057594037927940*t+281474976710656*e+1099511627776*i+4294967296*n+16777216*s+65536*o+256*a+l},r.prototype.writeLongLong=function(t){var e,i;return e=Math.floor(t/4294967296),i=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var e,i;for(e=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)e.push(this.readByte());return e},r.prototype.write=function(t){var e,i,n,s;for(s=[],i=0,n=t.length;i<n;i++)e=t[i],s.push(this.writeByte(e));return s},r})(),_k=(function(){var r;function t(e){var i,n,s;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)i={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[i.tag]=i}return t.prototype.encode=function(e){var i,n,s,o,a,l,c,h,p,m,f,b,y;for(y in f=Object.keys(e).length,l=Math.log(2),p=16*Math.floor(Math.log(f)/l),o=Math.floor(p/l),h=16*f-p,(n=new yo).writeInt(this.scalarType),n.writeShort(f),n.writeShort(p),n.writeShort(o),n.writeShort(h),s=16*f,c=n.pos+s,a=null,b=[],e)for(m=e[y],n.writeString(y),n.writeInt(r(m)),n.writeInt(c),n.writeInt(m.length),b=b.concat(m),y==="head"&&(a=c),c+=m.length;c%4;)b.push(0),c++;return n.write(b),i=2981146554-r(n.data),n.pos=a+8,n.writeUInt32(i),n.data},r=function(e){var i,n,s,o;for(e=J5.call(e);e.length%4;)e.push(0);for(s=new yo(e),n=0,i=0,o=e.length;i<o;i=i+=4)n+=s.readUInt32();return 4294967295&n},t})(),Sk={}.hasOwnProperty,ls=function(r,t){for(var e in t)Sk.call(t,e)&&(r[e]=t[e]);function i(){this.constructor=r}return i.prototype=t.prototype,r.prototype=new i,r.__super__=t.prototype,r};Nn=(function(){function r(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r})();var Ck=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="head",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},r.prototype.encode=function(t){var e;return(e=new yo).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},r})(),E1=(function(){function r(t,e){var i,n,s,o,a,l,c,h,p,m,f,b,y,_,x,E,I;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(f=t.readUInt16(),m=f/2,t.pos+=6,s=(function(){var O,V;for(V=[],l=O=0;0<=m?O<m:O>m;l=0<=m?++O:--O)V.push(t.readUInt16());return V})(),t.pos+=2,y=(function(){var O,V;for(V=[],l=O=0;0<=m?O<m:O>m;l=0<=m?++O:--O)V.push(t.readUInt16());return V})(),c=(function(){var O,V;for(V=[],l=O=0;0<=m?O<m:O>m;l=0<=m?++O:--O)V.push(t.readUInt16());return V})(),h=(function(){var O,V;for(V=[],l=O=0;0<=m?O<m:O>m;l=0<=m?++O:--O)V.push(t.readUInt16());return V})(),n=(this.length-t.pos+this.offset)/2,a=(function(){var O,V;for(V=[],l=O=0;0<=n?O<n:O>n;l=0<=n?++O:--O)V.push(t.readUInt16());return V})(),l=x=0,I=s.length;x<I;l=++x)for(_=s[l],i=E=b=y[l];b<=_?E<=_:E>=_;i=b<=_?++E:--E)h[l]===0?o=i+c[l]:(o=a[h[l]/2+(i-b)-(m-l)]||0)!==0&&(o+=c[l]),this.codeMap[i]=65535&o}t.pos=p}return r.encode=function(t,e){var i,n,s,o,a,l,c,h,p,m,f,b,y,_,x,E,I,O,V,Z,nt,W,M,J,L,N,H,z,st,lt,ht,et,dt,kt,xt,T,q,U,X,Q,ot,ft,pt,vt,Lt,Nt;switch(z=new yo,o=Object.keys(t).sort(function(Pt,Vt){return Pt-Vt}),e){case"macroman":for(y=0,_=(function(){var Pt=[];for(b=0;b<256;++b)Pt.push(0);return Pt})(),E={0:0},s={},st=0,dt=o.length;st<dt;st++)E[pt=t[n=o[st]]]==null&&(E[pt]=++y),s[n]={old:t[n],new:E[t[n]]},_[n]=E[t[n]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(_),{charMap:s,subtable:z.data,maxGlyphID:y+1};case"unicode":for(N=[],p=[],I=0,E={},i={},x=c=null,lt=0,kt=o.length;lt<kt;lt++)E[V=t[n=o[lt]]]==null&&(E[V]=++I),i[n]={old:V,new:E[V]},a=E[V]-n,x!=null&&a===c||(x&&p.push(x),N.push(n),c=a),x=n;for(x&&p.push(x),p.push(65535),N.push(65535),J=2*(M=N.length),W=2*Math.pow(Math.log(M)/Math.LN2,2),m=Math.log(W/2)/Math.LN2,nt=2*M-W,l=[],Z=[],f=[],b=ht=0,xt=N.length;ht<xt;b=++ht){if(L=N[b],h=p[b],L===65535){l.push(0),Z.push(0);break}if(L-(H=i[L].new)>=32768)for(l.push(0),Z.push(2*(f.length+M-b)),n=et=L;L<=h?et<=h:et>=h;n=L<=h?++et:--et)f.push(i[n].new);else l.push(H-L),Z.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*M+2*f.length),z.writeUInt16(0),z.writeUInt16(J),z.writeUInt16(W),z.writeUInt16(m),z.writeUInt16(nt),ot=0,T=p.length;ot<T;ot++)n=p[ot],z.writeUInt16(n);for(z.writeUInt16(0),ft=0,q=N.length;ft<q;ft++)n=N[ft],z.writeUInt16(n);for(vt=0,U=l.length;vt<U;vt++)a=l[vt],z.writeUInt16(a);for(Lt=0,X=Z.length;Lt<X;Lt++)O=Z[Lt],z.writeUInt16(O);for(Nt=0,Q=f.length;Nt<Q;Nt++)y=f[Nt],z.writeUInt16(y);return{charMap:i,subtable:z.data,maxGlyphID:I+1}}},r})(),Z5=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="cmap",r.prototype.parse=function(t){var e,i,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)e=new E1(t,this.offset),this.tables.push(e),e.isUnicode&&this.unicode==null&&(this.unicode=e);return!0},r.encode=function(t,e){var i,n;return e==null&&(e="macroman"),i=E1.encode(t,e),(n=new yo).writeUInt16(0),n.writeUInt16(1),i.table=n.data.concat(i.subtable),i},r})(),kk=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="hhea",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},r})(),Ak=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="OS/2",r.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var e,i;for(i=[],e=0;e<10;++e)i.push(t.readByte());return i})(),this.charRange=(function(){var e,i;for(i=[],e=0;e<4;++e)i.push(t.readInt());return i})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var e,i;for(i=[],e=0;e<2;e=++e)i.push(t.readInt());return i})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},r})(),Lk=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="post",r.prototype.parse=function(t){var e,i,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)e=t.readByte(),n.push(this.names.push(t.readString(e)));return n;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 262144:return this.map=(function(){var o,a,l;for(l=[],s=o=0,a=this.file.maxp.numGlyphs;0<=a?o<a:o>a;s=0<=a?++o:--o)l.push(t.readUInt32());return l}).call(this)}},r})(),Tk=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Ek=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="name",r.prototype.parse=function(t){var e,i,n,s,o,a,l,c,h,p,m;for(t.pos=this.offset,t.readShort(),e=t.readShort(),a=t.readShort(),i=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(l={},s=h=0,p=i.length;h<p;s=++h)n=i[s],t.pos=n.offset,c=t.readString(n.length),o=new Tk(c,n),l[m=n.nameID]==null&&(l[m]=[]),l[n.nameID].push(o);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},r})(),Ok=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="maxp",r.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},r})(),Pk=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="hmtx",r.prototype.parse=function(t){var e,i,n,s,o,a,l;for(t.pos=this.offset,this.metrics=[],e=0,a=this.file.hhea.numberOfMetrics;0<=a?e<a:e>a;e=0<=a?++e:--e)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,h;for(h=[],e=c=0;0<=n?c<n:c>n;e=0<=n?++c:--c)h.push(t.readInt16());return h})(),this.widths=(function(){var c,h,p,m;for(m=[],c=0,h=(p=this.metrics).length;c<h;c++)s=p[c],m.push(s.advance);return m}).call(this),i=this.widths[this.widths.length-1],l=[],e=o=0;0<=n?o<n:o>n;e=0<=n?++o:--o)l.push(this.widths.push(i));return l},r.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},r})(),J5=[].slice,Nk=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(t){var e,i,n,s,o,a,l,c,h,p;return t in this.cache?this.cache[t]:(s=this.file.loca,e=this.file.contents,i=s.indexOf(t),(n=s.lengthOf(t))===0?this.cache[t]=null:(e.pos=this.offset+i,o=(a=new yo(e.read(n))).readShort(),c=a.readShort(),p=a.readShort(),l=a.readShort(),h=a.readShort(),this.cache[t]=o===-1?new Mk(a,c,p,l,h):new Dk(a,o,c,p,l,h),this.cache[t]))},r.prototype.encode=function(t,e,i){var n,s,o,a,l;for(o=[],s=[],a=0,l=e.length;a<l;a++)n=t[e[a]],s.push(o.length),n&&(o=o.concat(n.encode(i)));return s.push(o.length),{table:o,offsets:s}},r})(),Dk=(function(){function r(t,e,i,n,s,o){this.raw=t,this.numberOfContours=e,this.xMin=i,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r})(),Mk=(function(){function r(t,e,i,n,s){var o,a;for(this.raw=t,this.xMin=e,this.yMin=i,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return r.prototype.encode=function(){var t,e,i;for(e=new yo(J5.call(this.raw.data)),t=0,i=this.glyphIDs.length;t<i;++t)e.pos=this.glyphOffsets[t];return e.data},r})(),Ik=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ls(r,Nn),r.prototype.tag="loca",r.prototype.parse=function(t){var e,i;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=e===0?(function(){var n,s;for(s=[],i=0,n=this.length;i<n;i+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],i=0,n=this.length;i<n;i+=4)s.push(t.readUInt32());return s}).call(this)},r.prototype.indexOf=function(t){return this.offsets[t]},r.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},r.prototype.encode=function(t,e){for(var i=new Uint32Array(this.offsets.length),n=0,s=0,o=0;o<i.length;++o)if(i[o]=n,s<e.length&&e[s]==o){++s,i[o]=n;var a=this.offsets[o],l=this.offsets[o+1]-a;l>0&&(n+=l)}for(var c=new Array(4*i.length),h=0;h<i.length;++h)c[4*h+3]=255&i[h],c[4*h+2]=(65280&i[h])>>8,c[4*h+1]=(16711680&i[h])>>16,c[4*h]=(4278190080&i[h])>>24;return c},r})(),jk=(function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,e,i,n,s;for(e in n=this.font.cmap.tables[0].codeMap,t={},s=this.subset)i=s[e],t[e]=n[i];return t},r.prototype.glyphsFor=function(t){var e,i,n,s,o,a,l;for(n={},o=0,a=t.length;o<a;o++)n[s=t[o]]=this.font.glyf.glyphFor(s);for(s in e=[],n)(i=n[s])!=null&&i.compound&&e.push.apply(e,i.glyphIDs);if(e.length>0)for(s in l=this.glyphsFor(e))i=l[s],n[s]=i;return n},r.prototype.encode=function(t,e){var i,n,s,o,a,l,c,h,p,m,f,b,y,_,x;for(n in i=Z5.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),f={0:0},x=i.charMap)f[(l=x[n]).old]=l.new;for(b in m=i.maxGlyphID,o)b in f||(f[b]=m++);return h=(function(E){var I,O;for(I in O={},E)O[E[I]]=I;return O})(f),p=Object.keys(h).sort(function(E,I){return E-I}),y=(function(){var E,I,O;for(O=[],E=0,I=p.length;E<I;E++)a=p[E],O.push(h[a]);return O})(),s=this.font.glyf.encode(o,y,f),c=this.font.loca.encode(s.offsets,y),_={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(_["OS/2"]=this.font.os2.raw()),this.font.directory.encode(_)},r})();Ut.API.PDFObject=(function(){var r;function t(){}return r=function(e,i){return(Array(i+1).join("0")+e).slice(-i)},t.convert=function(e){var i,n,s,o;if(Array.isArray(e))return"["+(function(){var a,l,c;for(c=[],a=0,l=e.length;a<l;a++)i=e[a],c.push(t.convert(i));return c})().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e?.isString)return"("+e+")";if(e instanceof Date)return"(D:"+r(e.getUTCFullYear(),4)+r(e.getUTCMonth(),2)+r(e.getUTCDate(),2)+r(e.getUTCHours(),2)+r(e.getUTCMinutes(),2)+r(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(n in s=["<<"],e)o=e[n],s.push("/"+n+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+e},t})();class Fk{constructor(t,e){this.dom=t,this.cm=e}init(){this.setupBindings()}setupBindings(){document.getElementById("btn-save-project").addEventListener("click",()=>{const i=this.cm.saveProject(),n=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(n),o=document.createElement("a");o.href=s,o.download="project.json",o.click(),URL.revokeObjectURL(s),Yi.success("Project saved!")});const t=document.getElementById("load-file-input");document.getElementById("btn-load-project").addEventListener("click",()=>{t.click()}),t.addEventListener("change",i=>{const n=i.target.files[0];if(!n)return;const s=new FileReader;s.onload=o=>{this.cm.loadProject(o.target.result),t.value="",Yi.success("Project loaded!")},s.readAsText(n)});const e=document.getElementById("btn-do-export");e&&e.addEventListener("click",()=>{const i=document.getElementById("export-name"),n=document.getElementById("export-quality"),s=document.querySelector('input[name="export-format"]:checked'),o=i.value||"design",a=parseInt(n.value,10)||1,l=s?s.value:"png";if(l==="png")this.cm.exportToImage(o,a),Yi.success("Exporting PNG...");else if(l==="svg")this.cm.exportToSVG(o),Yi.success("Exporting SVG...");else if(l==="pdf")try{const c=this.cm.originalWidth,h=this.cm.originalHeight,p=this.cm.getCanvasDataURL(a),m=new Ut({orientation:c>h?"l":"p",unit:"px",format:[c,h]});m.addImage(p,"PNG",0,0,c,h),m.save(`${o}.pdf`),Yi.success("Exporting PDF...")}catch(c){Yi.error("PDF export failed."),console.error(c)}})}}function O1(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),e.push.apply(e,i)}return e}function os(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?O1(Object(e),!0).forEach(function(i){Bk(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):O1(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function cu(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cu=function(t){return typeof t}:cu=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(r)}function Bk(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function Bs(){return Bs=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Bs.apply(this,arguments)}function Rk(r,t){if(r==null)return{};var e={},i=Object.keys(r),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(e[n]=r[n]);return e}function qk(r,t){if(r==null)return{};var e=Rk(r,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(e[i]=r[i])}return e}var zk="1.15.6";function Is(r){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(r)}var zs=Is(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Wc=Is(/Edge/i),P1=Is(/firefox/i),_c=Is(/safari/i)&&!Is(/chrome/i)&&!Is(/android/i),xg=Is(/iP(ad|od|hone)/i),Q5=Is(/chrome/i)&&Is(/android/i),tw={capture:!1,passive:!1};function ke(r,t,e){r.addEventListener(t,e,!zs&&tw)}function _e(r,t,e){r.removeEventListener(t,e,!zs&&tw)}function Wu(r,t){if(t){if(t[0]===">"&&(t=t.substring(1)),r)try{if(r.matches)return r.matches(t);if(r.msMatchesSelector)return r.msMatchesSelector(t);if(r.webkitMatchesSelector)return r.webkitMatchesSelector(t)}catch{return!1}return!1}}function ew(r){return r.host&&r!==document&&r.host.nodeType?r.host:r.parentNode}function Cn(r,t,e,i){if(r){e=e||document;do{if(t!=null&&(t[0]===">"?r.parentNode===e&&Wu(r,t):Wu(r,t))||i&&r===e)return r;if(r===e)break}while(r=ew(r))}return null}var N1=/\s+/g;function zr(r,t,e){if(r&&t)if(r.classList)r.classList[e?"add":"remove"](t);else{var i=(" "+r.className+" ").replace(N1," ").replace(" "+t+" "," ");r.className=(i+(e?" "+t:"")).replace(N1," ")}}function ee(r,t,e){var i=r&&r.style;if(i){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(r,""):r.currentStyle&&(e=r.currentStyle),t===void 0?e:e[t];!(t in i)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),i[t]=e+(typeof e=="string"?"":"px")}}function Ja(r,t){var e="";if(typeof r=="string")e=r;else do{var i=ee(r,"transform");i&&i!=="none"&&(e=i+" "+e)}while(!t&&(r=r.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(e)}function iw(r,t,e){if(r){var i=r.getElementsByTagName(t),n=0,s=i.length;if(e)for(;n<s;n++)e(i[n],n);return i}return[]}function es(){var r=document.scrollingElement;return r||document.documentElement}function Ai(r,t,e,i,n){if(!(!r.getBoundingClientRect&&r!==window)){var s,o,a,l,c,h,p;if(r!==window&&r.parentNode&&r!==es()?(s=r.getBoundingClientRect(),o=s.top,a=s.left,l=s.bottom,c=s.right,h=s.height,p=s.width):(o=0,a=0,l=window.innerHeight,c=window.innerWidth,h=window.innerHeight,p=window.innerWidth),(t||e)&&r!==window&&(n=n||r.parentNode,!zs))do if(n&&n.getBoundingClientRect&&(ee(n,"transform")!=="none"||e&&ee(n,"position")!=="static")){var m=n.getBoundingClientRect();o-=m.top+parseInt(ee(n,"border-top-width")),a-=m.left+parseInt(ee(n,"border-left-width")),l=o+s.height,c=a+s.width;break}while(n=n.parentNode);if(i&&r!==window){var f=Ja(n||r),b=f&&f.a,y=f&&f.d;f&&(o/=y,a/=b,p/=b,h/=y,l=o+h,c=a+p)}return{top:o,left:a,bottom:l,right:c,width:p,height:h}}}function D1(r,t,e){for(var i=vo(r,!0),n=Ai(r)[t];i;){var s=Ai(i)[e],o=void 0;if(o=n>=s,!o)return i;if(i===es())break;i=vo(i,!1)}return!1}function nl(r,t,e,i){for(var n=0,s=0,o=r.children;s<o.length;){if(o[s].style.display!=="none"&&o[s]!==ie.ghost&&(i||o[s]!==ie.dragged)&&Cn(o[s],e.draggable,r,!1)){if(n===t)return o[s];n++}s++}return null}function _g(r,t){for(var e=r.lastElementChild;e&&(e===ie.ghost||ee(e,"display")==="none"||t&&!Wu(e,t));)e=e.previousElementSibling;return e||null}function an(r,t){var e=0;if(!r||!r.parentNode)return-1;for(;r=r.previousElementSibling;)r.nodeName.toUpperCase()!=="TEMPLATE"&&r!==ie.clone&&(!t||Wu(r,t))&&e++;return e}function M1(r){var t=0,e=0,i=es();if(r)do{var n=Ja(r),s=n.a,o=n.d;t+=r.scrollLeft*s,e+=r.scrollTop*o}while(r!==i&&(r=r.parentNode));return[t,e]}function Hk(r,t){for(var e in r)if(r.hasOwnProperty(e)){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===r[e][i])return Number(e)}return-1}function vo(r,t){if(!r||!r.getBoundingClientRect)return es();var e=r,i=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var n=ee(e);if(e.clientWidth<e.scrollWidth&&(n.overflowX=="auto"||n.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(n.overflowY=="auto"||n.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return es();if(i||t)return e;i=!0}}while(e=e.parentNode);return es()}function Uk(r,t){if(r&&t)for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r}function jf(r,t){return Math.round(r.top)===Math.round(t.top)&&Math.round(r.left)===Math.round(t.left)&&Math.round(r.height)===Math.round(t.height)&&Math.round(r.width)===Math.round(t.width)}var Sc;function rw(r,t){return function(){if(!Sc){var e=arguments,i=this;e.length===1?r.call(i,e[0]):r.apply(i,e),Sc=setTimeout(function(){Sc=void 0},t)}}}function Wk(){clearTimeout(Sc),Sc=void 0}function nw(r,t,e){r.scrollLeft+=t,r.scrollTop+=e}function sw(r){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(r).cloneNode(!0):e?e(r).clone(!0)[0]:r.cloneNode(!0)}function ow(r,t,e){var i={};return Array.from(r.children).forEach(function(n){var s,o,a,l;if(!(!Cn(n,t.draggable,r,!1)||n.animated||n===e)){var c=Ai(n);i.left=Math.min((s=i.left)!==null&&s!==void 0?s:1/0,c.left),i.top=Math.min((o=i.top)!==null&&o!==void 0?o:1/0,c.top),i.right=Math.max((a=i.right)!==null&&a!==void 0?a:-1/0,c.right),i.bottom=Math.max((l=i.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var kr="Sortable"+new Date().getTime();function Vk(){var r=[],t;return{captureAnimationState:function(){if(r=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(n){if(!(ee(n,"display")==="none"||n===ie.ghost)){r.push({target:n,rect:Ai(n)});var s=os({},r[r.length-1].rect);if(n.thisAnimationDuration){var o=Ja(n,!0);o&&(s.top-=o.f,s.left-=o.e)}n.fromRect=s}})}},addAnimationState:function(i){r.push(i)},removeAnimationState:function(i){r.splice(Hk(r,{target:i}),1)},animateAll:function(i){var n=this;if(!this.options.animation){clearTimeout(t),typeof i=="function"&&i();return}var s=!1,o=0;r.forEach(function(a){var l=0,c=a.target,h=c.fromRect,p=Ai(c),m=c.prevFromRect,f=c.prevToRect,b=a.rect,y=Ja(c,!0);y&&(p.top-=y.f,p.left-=y.e),c.toRect=p,c.thisAnimationDuration&&jf(m,p)&&!jf(h,p)&&(b.top-p.top)/(b.left-p.left)===(h.top-p.top)/(h.left-p.left)&&(l=Gk(b,m,f,n.options)),jf(p,h)||(c.prevFromRect=h,c.prevToRect=p,l||(l=n.options.animation),n.animate(c,b,p,l)),l&&(s=!0,o=Math.max(o,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(t),s?t=setTimeout(function(){typeof i=="function"&&i()},o):typeof i=="function"&&i(),r=[]},animate:function(i,n,s,o){if(o){ee(i,"transition",""),ee(i,"transform","");var a=Ja(this.el),l=a&&a.a,c=a&&a.d,h=(n.left-s.left)/(l||1),p=(n.top-s.top)/(c||1);i.animatingX=!!h,i.animatingY=!!p,ee(i,"transform","translate3d("+h+"px,"+p+"px,0)"),this.forRepaintDummy=Yk(i),ee(i,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),ee(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){ee(i,"transition",""),ee(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},o)}}}}function Yk(r){return r.offsetWidth}function Gk(r,t,e,i){return Math.sqrt(Math.pow(t.top-r.top,2)+Math.pow(t.left-r.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*i.animation}var Pa=[],Ff={initializeByDefault:!0},Vc={mount:function(t){for(var e in Ff)Ff.hasOwnProperty(e)&&!(e in t)&&(t[e]=Ff[e]);Pa.forEach(function(i){if(i.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Pa.push(t)},pluginEvent:function(t,e,i){var n=this;this.eventCanceled=!1,i.cancel=function(){n.eventCanceled=!0};var s=t+"Global";Pa.forEach(function(o){e[o.pluginName]&&(e[o.pluginName][s]&&e[o.pluginName][s](os({sortable:e},i)),e.options[o.pluginName]&&e[o.pluginName][t]&&e[o.pluginName][t](os({sortable:e},i)))})},initializePlugins:function(t,e,i,n){Pa.forEach(function(a){var l=a.pluginName;if(!(!t.options[l]&&!a.initializeByDefault)){var c=new a(t,e,t.options);c.sortable=t,c.options=t.options,t[l]=c,Bs(i,c.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var o=this.modifyOption(t,s,t.options[s]);typeof o<"u"&&(t.options[s]=o)}},getEventProperties:function(t,e){var i={};return Pa.forEach(function(n){typeof n.eventProperties=="function"&&Bs(i,n.eventProperties.call(e[n.pluginName],t))}),i},modifyOption:function(t,e,i){var n;return Pa.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[e]=="function"&&(n=s.optionListeners[e].call(t[s.pluginName],i))}),n}};function Xk(r){var t=r.sortable,e=r.rootEl,i=r.name,n=r.targetEl,s=r.cloneEl,o=r.toEl,a=r.fromEl,l=r.oldIndex,c=r.newIndex,h=r.oldDraggableIndex,p=r.newDraggableIndex,m=r.originalEvent,f=r.putSortable,b=r.extraEventProperties;if(t=t||e&&e[kr],!!t){var y,_=t.options,x="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!zs&&!Wc?y=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(i,!0,!0)),y.to=o||e,y.from=a||e,y.item=n||e,y.clone=s,y.oldIndex=l,y.newIndex=c,y.oldDraggableIndex=h,y.newDraggableIndex=p,y.originalEvent=m,y.pullMode=f?f.lastPutMode:void 0;var E=os(os({},b),Vc.getEventProperties(i,t));for(var I in E)y[I]=E[I];e&&e.dispatchEvent(y),_[x]&&_[x].call(t,y)}}var $k=["evt"],Cr=function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.evt,s=qk(i,$k);Vc.pluginEvent.bind(ie)(t,e,os({dragEl:Tt,parentEl:ai,ghostEl:oe,rootEl:ti,nextEl:Wo,lastDownEl:hu,cloneEl:ii,cloneHidden:co,dragStarted:dc,putSortable:Vi,activeSortable:ie.active,originalEvent:n,oldIndex:za,oldDraggableIndex:Cc,newIndex:Hr,newDraggableIndex:lo,hideGhostForTarget:hw,unhideGhostForTarget:uw,cloneNowHidden:function(){co=!0},cloneNowShown:function(){co=!1},dispatchSortableEvent:function(a){ur({sortable:e,name:a,originalEvent:n})}},s))};function ur(r){Xk(os({putSortable:Vi,cloneEl:ii,targetEl:Tt,rootEl:ti,oldIndex:za,oldDraggableIndex:Cc,newIndex:Hr,newDraggableIndex:lo},r))}var Tt,ai,oe,ti,Wo,hu,ii,co,za,Hr,Cc,lo,Xh,Vi,ja=!1,Vu=!1,Yu=[],zo,xn,Bf,Rf,I1,j1,dc,Na,kc,Ac=!1,$h=!1,uu,tr,qf=[],Cp=!1,Gu=[],gd=typeof document<"u",Kh=xg,F1=Wc||zs?"cssFloat":"float",Kk=gd&&!Q5&&!xg&&"draggable"in document.createElement("div"),aw=(function(){if(gd){if(zs)return!1;var r=document.createElement("x");return r.style.cssText="pointer-events:auto",r.style.pointerEvents==="auto"}})(),lw=function(t,e){var i=ee(t),n=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),s=nl(t,0,e),o=nl(t,1,e),a=s&&ee(s),l=o&&ee(o),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+Ai(s).width,h=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Ai(o).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&a.float&&a.float!=="none"){var p=a.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===p)?"vertical":"horizontal"}return s&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||c>=n&&i[F1]==="none"||o&&i[F1]==="none"&&c+h>n)?"vertical":"horizontal"},Zk=function(t,e,i){var n=i?t.left:t.top,s=i?t.right:t.bottom,o=i?t.width:t.height,a=i?e.left:e.top,l=i?e.right:e.bottom,c=i?e.width:e.height;return n===a||s===l||n+o/2===a+c/2},Jk=function(t,e){var i;return Yu.some(function(n){var s=n[kr].options.emptyInsertThreshold;if(!(!s||_g(n))){var o=Ai(n),a=t>=o.left-s&&t<=o.right+s,l=e>=o.top-s&&e<=o.bottom+s;if(a&&l)return i=n}}),i},cw=function(t){function e(s,o){return function(a,l,c,h){var p=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(s==null&&(o||p))return!0;if(s==null||s===!1)return!1;if(o&&s==="clone")return s;if(typeof s=="function")return e(s(a,l,c,h),o)(a,l,c,h);var m=(o?a:l).options.group.name;return s===!0||typeof s=="string"&&s===m||s.join&&s.indexOf(m)>-1}}var i={},n=t.group;(!n||cu(n)!="object")&&(n={name:n}),i.name=n.name,i.checkPull=e(n.pull,!0),i.checkPut=e(n.put),i.revertClone=n.revertClone,t.group=i},hw=function(){!aw&&oe&&ee(oe,"display","none")},uw=function(){!aw&&oe&&ee(oe,"display","")};gd&&!Q5&&document.addEventListener("click",function(r){if(Vu)return r.preventDefault(),r.stopPropagation&&r.stopPropagation(),r.stopImmediatePropagation&&r.stopImmediatePropagation(),Vu=!1,!1},!0);var Ho=function(t){if(Tt){t=t.touches?t.touches[0]:t;var e=Jk(t.clientX,t.clientY);if(e){var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);i.target=i.rootEl=e,i.preventDefault=void 0,i.stopPropagation=void 0,e[kr]._onDragOver(i)}}},Qk=function(t){Tt&&Tt.parentNode[kr]._isOutsideThisEl(t.target)};function ie(r,t){if(!(r&&r.nodeType&&r.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(r));this.el=r,this.options=t=Bs({},t),r[kr]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(r.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return lw(r,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,a){o.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:ie.supportPointer!==!1&&"PointerEvent"in window&&(!_c||xg),emptyInsertThreshold:5};Vc.initializePlugins(this,r,e);for(var i in e)!(i in t)&&(t[i]=e[i]);cw(t);for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));this.nativeDraggable=t.forceFallback?!1:Kk,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?ke(r,"pointerdown",this._onTapStart):(ke(r,"mousedown",this._onTapStart),ke(r,"touchstart",this._onTapStart)),this.nativeDraggable&&(ke(r,"dragover",this),ke(r,"dragenter",this)),Yu.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Bs(this,Vk())}ie.prototype={constructor:ie,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Na=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,Tt):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,i=this.el,n=this.options,s=n.preventOnFilter,o=t.type,a=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(a||t).target,c=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,h=n.filter;if(aA(i),!Tt&&!(/mousedown|pointerdown/.test(o)&&t.button!==0||n.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&_c&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Cn(l,n.draggable,i,!1),!(l&&l.animated)&&hu!==l)){if(za=an(l),Cc=an(l,n.draggable),typeof h=="function"){if(h.call(this,t,l,this)){ur({sortable:e,rootEl:c,name:"filter",targetEl:l,toEl:i,fromEl:i}),Cr("filter",e,{evt:t}),s&&t.preventDefault();return}}else if(h&&(h=h.split(",").some(function(p){if(p=Cn(c,p.trim(),i,!1),p)return ur({sortable:e,rootEl:p,name:"filter",targetEl:l,fromEl:i,toEl:i}),Cr("filter",e,{evt:t}),!0}),h)){s&&t.preventDefault();return}n.handle&&!Cn(c,n.handle,i,!1)||this._prepareDragStart(t,a,l)}}},_prepareDragStart:function(t,e,i){var n=this,s=n.el,o=n.options,a=s.ownerDocument,l;if(i&&!Tt&&i.parentNode===s){var c=Ai(i);if(ti=s,Tt=i,ai=Tt.parentNode,Wo=Tt.nextSibling,hu=i,Xh=o.group,ie.dragged=Tt,zo={target:Tt,clientX:(e||t).clientX,clientY:(e||t).clientY},I1=zo.clientX-c.left,j1=zo.clientY-c.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,Tt.style["will-change"]="all",l=function(){if(Cr("delayEnded",n,{evt:t}),ie.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!P1&&n.nativeDraggable&&(Tt.draggable=!0),n._triggerDragStart(t,e),ur({sortable:n,name:"choose",originalEvent:t}),zr(Tt,o.chosenClass,!0)},o.ignore.split(",").forEach(function(h){iw(Tt,h.trim(),zf)}),ke(a,"dragover",Ho),ke(a,"mousemove",Ho),ke(a,"touchmove",Ho),o.supportPointer?(ke(a,"pointerup",n._onDrop),!this.nativeDraggable&&ke(a,"pointercancel",n._onDrop)):(ke(a,"mouseup",n._onDrop),ke(a,"touchend",n._onDrop),ke(a,"touchcancel",n._onDrop)),P1&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Tt.draggable=!0),Cr("delayStart",this,{evt:t}),o.delay&&(!o.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Wc||zs))){if(ie.eventCanceled){this._onDrop();return}o.supportPointer?(ke(a,"pointerup",n._disableDelayedDrag),ke(a,"pointercancel",n._disableDelayedDrag)):(ke(a,"mouseup",n._disableDelayedDrag),ke(a,"touchend",n._disableDelayedDrag),ke(a,"touchcancel",n._disableDelayedDrag)),ke(a,"mousemove",n._delayedDragTouchMoveHandler),ke(a,"touchmove",n._delayedDragTouchMoveHandler),o.supportPointer&&ke(a,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Tt&&zf(Tt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;_e(t,"mouseup",this._disableDelayedDrag),_e(t,"touchend",this._disableDelayedDrag),_e(t,"touchcancel",this._disableDelayedDrag),_e(t,"pointerup",this._disableDelayedDrag),_e(t,"pointercancel",this._disableDelayedDrag),_e(t,"mousemove",this._delayedDragTouchMoveHandler),_e(t,"touchmove",this._delayedDragTouchMoveHandler),_e(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?ke(document,"pointermove",this._onTouchMove):e?ke(document,"touchmove",this._onTouchMove):ke(document,"mousemove",this._onTouchMove):(ke(Tt,"dragend",this),ke(ti,"dragstart",this._onDragStart));try{document.selection?du(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(ja=!1,ti&&Tt){Cr("dragStarted",this,{evt:e}),this.nativeDraggable&&ke(document,"dragover",Qk);var i=this.options;!t&&zr(Tt,i.dragClass,!1),zr(Tt,i.ghostClass,!0),ie.active=this,t&&this._appendGhost(),ur({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(xn){this._lastX=xn.clientX,this._lastY=xn.clientY,hw();for(var t=document.elementFromPoint(xn.clientX,xn.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(xn.clientX,xn.clientY),t!==e);)e=t;if(Tt.parentNode[kr]._isOutsideThisEl(t),e)do{if(e[kr]){var i=void 0;if(i=e[kr]._onDragOver({clientX:xn.clientX,clientY:xn.clientY,target:t,rootEl:e}),i&&!this.options.dragoverBubble)break}t=e}while(e=ew(e));uw()}},_onTouchMove:function(t){if(zo){var e=this.options,i=e.fallbackTolerance,n=e.fallbackOffset,s=t.touches?t.touches[0]:t,o=oe&&Ja(oe,!0),a=oe&&o&&o.a,l=oe&&o&&o.d,c=Kh&&tr&&M1(tr),h=(s.clientX-zo.clientX+n.x)/(a||1)+(c?c[0]-qf[0]:0)/(a||1),p=(s.clientY-zo.clientY+n.y)/(l||1)+(c?c[1]-qf[1]:0)/(l||1);if(!ie.active&&!ja){if(i&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<i)return;this._onDragStart(t,!0)}if(oe){o?(o.e+=h-(Bf||0),o.f+=p-(Rf||0)):o={a:1,b:0,c:0,d:1,e:h,f:p};var m="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");ee(oe,"webkitTransform",m),ee(oe,"mozTransform",m),ee(oe,"msTransform",m),ee(oe,"transform",m),Bf=h,Rf=p,xn=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!oe){var t=this.options.fallbackOnBody?document.body:ti,e=Ai(Tt,!0,Kh,!0,t),i=this.options;if(Kh){for(tr=t;ee(tr,"position")==="static"&&ee(tr,"transform")==="none"&&tr!==document;)tr=tr.parentNode;tr!==document.body&&tr!==document.documentElement?(tr===document&&(tr=es()),e.top+=tr.scrollTop,e.left+=tr.scrollLeft):tr=es(),qf=M1(tr)}oe=Tt.cloneNode(!0),zr(oe,i.ghostClass,!1),zr(oe,i.fallbackClass,!0),zr(oe,i.dragClass,!0),ee(oe,"transition",""),ee(oe,"transform",""),ee(oe,"box-sizing","border-box"),ee(oe,"margin",0),ee(oe,"top",e.top),ee(oe,"left",e.left),ee(oe,"width",e.width),ee(oe,"height",e.height),ee(oe,"opacity","0.8"),ee(oe,"position",Kh?"absolute":"fixed"),ee(oe,"zIndex","100000"),ee(oe,"pointerEvents","none"),ie.ghost=oe,t.appendChild(oe),ee(oe,"transform-origin",I1/parseInt(oe.style.width)*100+"% "+j1/parseInt(oe.style.height)*100+"%")}},_onDragStart:function(t,e){var i=this,n=t.dataTransfer,s=i.options;if(Cr("dragStart",this,{evt:t}),ie.eventCanceled){this._onDrop();return}Cr("setupClone",this),ie.eventCanceled||(ii=sw(Tt),ii.removeAttribute("id"),ii.draggable=!1,ii.style["will-change"]="",this._hideClone(),zr(ii,this.options.chosenClass,!1),ie.clone=ii),i.cloneId=du(function(){Cr("clone",i),!ie.eventCanceled&&(i.options.removeCloneOnHide||ti.insertBefore(ii,Tt),i._hideClone(),ur({sortable:i,name:"clone"}))}),!e&&zr(Tt,s.dragClass,!0),e?(Vu=!0,i._loopId=setInterval(i._emulateDragOver,50)):(_e(document,"mouseup",i._onDrop),_e(document,"touchend",i._onDrop),_e(document,"touchcancel",i._onDrop),n&&(n.effectAllowed="move",s.setData&&s.setData.call(i,n,Tt)),ke(document,"drop",i),ee(Tt,"transform","translateZ(0)")),ja=!0,i._dragStartId=du(i._dragStarted.bind(i,e,t)),ke(document,"selectstart",i),dc=!0,window.getSelection().removeAllRanges(),_c&&ee(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,i=t.target,n,s,o,a=this.options,l=a.group,c=ie.active,h=Xh===l,p=a.sort,m=Vi||c,f,b=this,y=!1;if(Cp)return;function _(et,dt){Cr(et,b,os({evt:t,isOwner:h,axis:f?"vertical":"horizontal",revert:o,dragRect:n,targetRect:s,canSort:p,fromSortable:m,target:i,completed:E,onMove:function(xt,T){return Zh(ti,e,Tt,n,xt,Ai(xt),t,T)},changed:I},dt))}function x(){_("dragOverAnimationCapture"),b.captureAnimationState(),b!==m&&m.captureAnimationState()}function E(et){return _("dragOverCompleted",{insertion:et}),et&&(h?c._hideClone():c._showClone(b),b!==m&&(zr(Tt,Vi?Vi.options.ghostClass:c.options.ghostClass,!1),zr(Tt,a.ghostClass,!0)),Vi!==b&&b!==ie.active?Vi=b:b===ie.active&&Vi&&(Vi=null),m===b&&(b._ignoreWhileAnimating=i),b.animateAll(function(){_("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(i===Tt&&!Tt.animated||i===e&&!i.animated)&&(Na=null),!a.dragoverBubble&&!t.rootEl&&i!==document&&(Tt.parentNode[kr]._isOutsideThisEl(t.target),!et&&Ho(t)),!a.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),y=!0}function I(){Hr=an(Tt),lo=an(Tt,a.draggable),ur({sortable:b,name:"change",toEl:e,newIndex:Hr,newDraggableIndex:lo,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),i=Cn(i,a.draggable,e,!0),_("dragOver"),ie.eventCanceled)return y;if(Tt.contains(t.target)||i.animated&&i.animatingX&&i.animatingY||b._ignoreWhileAnimating===i)return E(!1);if(Vu=!1,c&&!a.disabled&&(h?p||(o=ai!==ti):Vi===this||(this.lastPutMode=Xh.checkPull(this,c,Tt,t))&&l.checkPut(this,c,Tt,t))){if(f=this._getDirection(t,i)==="vertical",n=Ai(Tt),_("dragOverValid"),ie.eventCanceled)return y;if(o)return ai=ti,x(),this._hideClone(),_("revert"),ie.eventCanceled||(Wo?ti.insertBefore(Tt,Wo):ti.appendChild(Tt)),E(!0);var O=_g(e,a.draggable);if(!O||rA(t,f,this)&&!O.animated){if(O===Tt)return E(!1);if(O&&e===t.target&&(i=O),i&&(s=Ai(i)),Zh(ti,e,Tt,n,i,s,t,!!i)!==!1)return x(),O&&O.nextSibling?e.insertBefore(Tt,O.nextSibling):e.appendChild(Tt),ai=e,I(),E(!0)}else if(O&&iA(t,f,this)){var V=nl(e,0,a,!0);if(V===Tt)return E(!1);if(i=V,s=Ai(i),Zh(ti,e,Tt,n,i,s,t,!1)!==!1)return x(),e.insertBefore(Tt,V),ai=e,I(),E(!0)}else if(i.parentNode===e){s=Ai(i);var Z=0,nt,W=Tt.parentNode!==e,M=!Zk(Tt.animated&&Tt.toRect||n,i.animated&&i.toRect||s,f),J=f?"top":"left",L=D1(i,"top","top")||D1(Tt,"top","top"),N=L?L.scrollTop:void 0;Na!==i&&(nt=s[J],Ac=!1,$h=!M&&a.invertSwap||W),Z=nA(t,i,s,f,M?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,$h,Na===i);var H;if(Z!==0){var z=an(Tt);do z-=Z,H=ai.children[z];while(H&&(ee(H,"display")==="none"||H===oe))}if(Z===0||H===i)return E(!1);Na=i,kc=Z;var st=i.nextElementSibling,lt=!1;lt=Z===1;var ht=Zh(ti,e,Tt,n,i,s,t,lt);if(ht!==!1)return(ht===1||ht===-1)&&(lt=ht===1),Cp=!0,setTimeout(eA,30),x(),lt&&!st?e.appendChild(Tt):i.parentNode.insertBefore(Tt,lt?st:i),L&&nw(L,0,N-L.scrollTop),ai=Tt.parentNode,nt!==void 0&&!$h&&(uu=Math.abs(nt-Ai(i)[J])),I(),E(!0)}if(e.contains(Tt))return E(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){_e(document,"mousemove",this._onTouchMove),_e(document,"touchmove",this._onTouchMove),_e(document,"pointermove",this._onTouchMove),_e(document,"dragover",Ho),_e(document,"mousemove",Ho),_e(document,"touchmove",Ho)},_offUpEvents:function(){var t=this.el.ownerDocument;_e(t,"mouseup",this._onDrop),_e(t,"touchend",this._onDrop),_e(t,"pointerup",this._onDrop),_e(t,"pointercancel",this._onDrop),_e(t,"touchcancel",this._onDrop),_e(document,"selectstart",this)},_onDrop:function(t){var e=this.el,i=this.options;if(Hr=an(Tt),lo=an(Tt,i.draggable),Cr("drop",this,{evt:t}),ai=Tt&&Tt.parentNode,Hr=an(Tt),lo=an(Tt,i.draggable),ie.eventCanceled){this._nulling();return}ja=!1,$h=!1,Ac=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),kp(this.cloneId),kp(this._dragStartId),this.nativeDraggable&&(_e(document,"drop",this),_e(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),_c&&ee(document.body,"user-select",""),ee(Tt,"transform",""),t&&(dc&&(t.cancelable&&t.preventDefault(),!i.dropBubble&&t.stopPropagation()),oe&&oe.parentNode&&oe.parentNode.removeChild(oe),(ti===ai||Vi&&Vi.lastPutMode!=="clone")&&ii&&ii.parentNode&&ii.parentNode.removeChild(ii),Tt&&(this.nativeDraggable&&_e(Tt,"dragend",this),zf(Tt),Tt.style["will-change"]="",dc&&!ja&&zr(Tt,Vi?Vi.options.ghostClass:this.options.ghostClass,!1),zr(Tt,this.options.chosenClass,!1),ur({sortable:this,name:"unchoose",toEl:ai,newIndex:null,newDraggableIndex:null,originalEvent:t}),ti!==ai?(Hr>=0&&(ur({rootEl:ai,name:"add",toEl:ai,fromEl:ti,originalEvent:t}),ur({sortable:this,name:"remove",toEl:ai,originalEvent:t}),ur({rootEl:ai,name:"sort",toEl:ai,fromEl:ti,originalEvent:t}),ur({sortable:this,name:"sort",toEl:ai,originalEvent:t})),Vi&&Vi.save()):Hr!==za&&Hr>=0&&(ur({sortable:this,name:"update",toEl:ai,originalEvent:t}),ur({sortable:this,name:"sort",toEl:ai,originalEvent:t})),ie.active&&((Hr==null||Hr===-1)&&(Hr=za,lo=Cc),ur({sortable:this,name:"end",toEl:ai,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Cr("nulling",this),ti=Tt=ai=oe=Wo=ii=hu=co=zo=xn=dc=Hr=lo=za=Cc=Na=kc=Vi=Xh=ie.dragged=ie.ghost=ie.clone=ie.active=null,Gu.forEach(function(t){t.checked=!0}),Gu.length=Bf=Rf=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":Tt&&(this._onDragOver(t),tA(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,i=this.el.children,n=0,s=i.length,o=this.options;n<s;n++)e=i[n],Cn(e,o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||oA(e));return t},sort:function(t,e){var i={},n=this.el;this.toArray().forEach(function(s,o){var a=n.children[o];Cn(a,this.options.draggable,n,!1)&&(i[s]=a)},this),e&&this.captureAnimationState(),t.forEach(function(s){i[s]&&(n.removeChild(i[s]),n.appendChild(i[s]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return Cn(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var i=this.options;if(e===void 0)return i[t];var n=Vc.modifyOption(this,t,e);typeof n<"u"?i[t]=n:i[t]=e,t==="group"&&cw(i)},destroy:function(){Cr("destroy",this);var t=this.el;t[kr]=null,_e(t,"mousedown",this._onTapStart),_e(t,"touchstart",this._onTapStart),_e(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(_e(t,"dragover",this),_e(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Yu.splice(Yu.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!co){if(Cr("hideClone",this),ie.eventCanceled)return;ee(ii,"display","none"),this.options.removeCloneOnHide&&ii.parentNode&&ii.parentNode.removeChild(ii),co=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(co){if(Cr("showClone",this),ie.eventCanceled)return;Tt.parentNode==ti&&!this.options.group.revertClone?ti.insertBefore(ii,Tt):Wo?ti.insertBefore(ii,Wo):ti.appendChild(ii),this.options.group.revertClone&&this.animate(Tt,ii),ee(ii,"display",""),co=!1}}};function tA(r){r.dataTransfer&&(r.dataTransfer.dropEffect="move"),r.cancelable&&r.preventDefault()}function Zh(r,t,e,i,n,s,o,a){var l,c=r[kr],h=c.options.onMove,p;return window.CustomEvent&&!zs&&!Wc?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=r,l.dragged=e,l.draggedRect=i,l.related=n||t,l.relatedRect=s||Ai(t),l.willInsertAfter=a,l.originalEvent=o,r.dispatchEvent(l),h&&(p=h.call(c,l,o)),p}function zf(r){r.draggable=!1}function eA(){Cp=!1}function iA(r,t,e){var i=Ai(nl(e.el,0,e.options,!0)),n=ow(e.el,e.options,oe),s=10;return t?r.clientX<n.left-s||r.clientY<i.top&&r.clientX<i.right:r.clientY<n.top-s||r.clientY<i.bottom&&r.clientX<i.left}function rA(r,t,e){var i=Ai(_g(e.el,e.options.draggable)),n=ow(e.el,e.options,oe),s=10;return t?r.clientX>n.right+s||r.clientY>i.bottom&&r.clientX>i.left:r.clientY>n.bottom+s||r.clientX>i.right&&r.clientY>i.top}function nA(r,t,e,i,n,s,o,a){var l=i?r.clientY:r.clientX,c=i?e.height:e.width,h=i?e.top:e.left,p=i?e.bottom:e.right,m=!1;if(!o){if(a&&uu<c*n){if(!Ac&&(kc===1?l>h+c*s/2:l<p-c*s/2)&&(Ac=!0),Ac)m=!0;else if(kc===1?l<h+uu:l>p-uu)return-kc}else if(l>h+c*(1-n)/2&&l<p-c*(1-n)/2)return sA(t)}return m=m||o,m&&(l<h+c*s/2||l>p-c*s/2)?l>h+c/2?1:-1:0}function sA(r){return an(Tt)<an(r)?1:-1}function oA(r){for(var t=r.tagName+r.className+r.src+r.href+r.textContent,e=t.length,i=0;e--;)i+=t.charCodeAt(e);return i.toString(36)}function aA(r){Gu.length=0;for(var t=r.getElementsByTagName("input"),e=t.length;e--;){var i=t[e];i.checked&&Gu.push(i)}}function du(r){return setTimeout(r,0)}function kp(r){return clearTimeout(r)}gd&&ke(document,"touchmove",function(r){(ie.active||ja)&&r.cancelable&&r.preventDefault()});ie.utils={on:ke,off:_e,css:ee,find:iw,is:function(t,e){return!!Cn(t,e,t,!1)},extend:Uk,throttle:rw,closest:Cn,toggleClass:zr,clone:sw,index:an,nextTick:du,cancelNextTick:kp,detectDirection:lw,getChild:nl,expando:kr};ie.get=function(r){return r[kr]};ie.mount=function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(ie.utils=os(os({},ie.utils),i.utils)),Vc.mount(i)})};ie.create=function(r,t){return new ie(r,t)};ie.version=zk;var ki=[],fc,Ap,Lp=!1,Hf,Uf,Xu,pc;function lA(){function r(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return r.prototype={dragStarted:function(e){var i=e.originalEvent;this.sortable.nativeDraggable?ke(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ke(document,"pointermove",this._handleFallbackAutoScroll):i.touches?ke(document,"touchmove",this._handleFallbackAutoScroll):ke(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var i=e.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?_e(document,"dragover",this._handleAutoScroll):(_e(document,"pointermove",this._handleFallbackAutoScroll),_e(document,"touchmove",this._handleFallbackAutoScroll),_e(document,"mousemove",this._handleFallbackAutoScroll)),B1(),fu(),Wk()},nulling:function(){Xu=Ap=fc=Lp=pc=Hf=Uf=null,ki.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,i){var n=this,s=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(s,o);if(Xu=e,i||this.options.forceAutoScrollFallback||Wc||zs||_c){Wf(e,this.options,a,i);var l=vo(a,!0);Lp&&(!pc||s!==Hf||o!==Uf)&&(pc&&B1(),pc=setInterval(function(){var c=vo(document.elementFromPoint(s,o),!0);c!==l&&(l=c,fu()),Wf(e,n.options,c,i)},10),Hf=s,Uf=o)}else{if(!this.options.bubbleScroll||vo(a,!0)===es()){fu();return}Wf(e,this.options,vo(a,!1),!1)}}},Bs(r,{pluginName:"scroll",initializeByDefault:!0})}function fu(){ki.forEach(function(r){clearInterval(r.pid)}),ki=[]}function B1(){clearInterval(pc)}var Wf=rw(function(r,t,e,i){if(t.scroll){var n=(r.touches?r.touches[0]:r).clientX,s=(r.touches?r.touches[0]:r).clientY,o=t.scrollSensitivity,a=t.scrollSpeed,l=es(),c=!1,h;Ap!==e&&(Ap=e,fu(),fc=t.scroll,h=t.scrollFn,fc===!0&&(fc=vo(e,!0)));var p=0,m=fc;do{var f=m,b=Ai(f),y=b.top,_=b.bottom,x=b.left,E=b.right,I=b.width,O=b.height,V=void 0,Z=void 0,nt=f.scrollWidth,W=f.scrollHeight,M=ee(f),J=f.scrollLeft,L=f.scrollTop;f===l?(V=I<nt&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),Z=O<W&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(V=I<nt&&(M.overflowX==="auto"||M.overflowX==="scroll"),Z=O<W&&(M.overflowY==="auto"||M.overflowY==="scroll"));var N=V&&(Math.abs(E-n)<=o&&J+I<nt)-(Math.abs(x-n)<=o&&!!J),H=Z&&(Math.abs(_-s)<=o&&L+O<W)-(Math.abs(y-s)<=o&&!!L);if(!ki[p])for(var z=0;z<=p;z++)ki[z]||(ki[z]={});(ki[p].vx!=N||ki[p].vy!=H||ki[p].el!==f)&&(ki[p].el=f,ki[p].vx=N,ki[p].vy=H,clearInterval(ki[p].pid),(N!=0||H!=0)&&(c=!0,ki[p].pid=setInterval((function(){i&&this.layer===0&&ie.active._onTouchMove(Xu);var st=ki[this.layer].vy?ki[this.layer].vy*a:0,lt=ki[this.layer].vx?ki[this.layer].vx*a:0;typeof h=="function"&&h.call(ie.dragged.parentNode[kr],lt,st,r,Xu,ki[this.layer].el)!=="continue"||nw(ki[this.layer].el,lt,st)}).bind({layer:p}),24))),p++}while(t.bubbleScroll&&m!==l&&(m=vo(m,!1)));Lp=c}},30),dw=function(t){var e=t.originalEvent,i=t.putSortable,n=t.dragEl,s=t.activeSortable,o=t.dispatchSortableEvent,a=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(e){var c=i||s;a();var h=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,p=document.elementFromPoint(h.clientX,h.clientY);l(),c&&!c.el.contains(p)&&(o("spill"),this.onSpill({dragEl:n,putSortable:i}))}};function Sg(){}Sg.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,i=t.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var n=nl(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(e,n):this.sortable.el.appendChild(e),this.sortable.animateAll(),i&&i.animateAll()},drop:dw};Bs(Sg,{pluginName:"revertOnSpill"});function Cg(){}Cg.prototype={onSpill:function(t){var e=t.dragEl,i=t.putSortable,n=i||this.sortable;n.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),n.animateAll()},drop:dw};Bs(Cg,{pluginName:"removeOnSpill"});ie.mount(new lA);ie.mount(Cg,Sg);class cA{constructor(t,e){this.dom=t,this.cm=e,this.container=document.getElementById("layers-list"),this.sortables=[]}init(){this.container&&(this.cm.canvas.on("object:added",()=>this.render()),this.cm.canvas.on("object:removed",()=>this.render()),this.cm.canvas.on("object:modified",()=>this.render()),this.cm.canvas.on("selection:created",()=>this.updateSelection()),this.cm.canvas.on("selection:updated",()=>this.updateSelection()),this.cm.canvas.on("selection:cleared",()=>this.updateSelection()),this.render())}render(){if(!this.container)return;this.sortables.forEach(e=>e.destroy()),this.sortables=[],this.container.innerHTML="";const t=this.cm.canvas.getObjects();this.renderList(this.container,t,null),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{width:14,height:14}}),this.updateSelection()}renderList(t,e,i){const n=e.slice().reverse();t.dataset.isRoot=i?"false":"true",t._fabricParent=i,n.forEach((o,a)=>{const l=document.createElement("div");l.className="layer-wrapper";const c=document.createElement("div");c.className="layer-item";let h="box";o.type==="i-text"?h="type":o.type==="image"?h="image":o.type==="rect"?h="square":o.type==="circle"?h="circle":o.type==="group"&&(h="folder");const p=o.name||`${o.type}`;if(c.innerHTML=`
                <div class="layer-handle"><i data-lucide="grip-vertical"></i></div>
                <div class="layer-icon"><i data-lucide="${h}"></i></div>
                <div class="layer-name-wrap" style="flex:1; overflow:hidden;">
                    <span class="layer-name">${p}</span>
                    <input type="text" class="layer-rename-input hidden" value="${p}">
                </div>
                <div class="layer-actions">
                    <button class="icon-btn btn-xs btn-lock ${o.lockMovementX?"active":""}" title="Lock">
                        <i data-lucide="${o.lockMovementX?"lock":"unlock"}"></i>
                    </button>
                    <button class="icon-btn btn-xs btn-visible ${o.visible?"":"active"}" title="Toggle Visibility">
                        <i data-lucide="${o.visible?"eye":"eye-off"}"></i>
                    </button>
                </div>
            `,c._fabricObject=o,this.setupLayerEvents(c,o),l.appendChild(c),o.type==="group"&&o.getObjects){const m=document.createElement("div");m.className="layer-children",m.style.paddingLeft="20px",this.renderList(m,o.getObjects(),o),l.appendChild(m)}t.appendChild(l)});const s=new ie(t,{group:"layers",group:i?`group-${i.uid||Math.random()}`:"root",animation:150,handle:".layer-handle",ghostClass:"layer-item-ghost",onEnd:o=>{this.handleReorder(o,t)}});this.sortables.push(s)}setupLayerEvents(t,e){t.addEventListener("click",l=>{if(l.target.closest(".layer-actions")||l.target.closest(".layer-rename-input"))return;l.stopPropagation();const c=this.cm.canvas;if(l.shiftKey||l.ctrlKey||l.metaKey){const h=c.getActiveObject();let p=[];h&&(h.type==="activeSelection"||h.type==="activeselection"?p=[...h.getObjects()]:p=[h]);const m=p.indexOf(e);if(m>-1?(l.ctrlKey||l.metaKey)&&p.splice(m,1):p.push(e),p.length===0)c.discardActiveObject();else if(p.length===1)c.setActiveObject(p[0]);else{const f=new fabric.ActiveSelection(p,{canvas:c});c.setActiveObject(f)}}else c.discardActiveObject(),c.setActiveObject(e);c.requestRenderAll()});const i=t.querySelector(".layer-name"),n=t.querySelector(".layer-rename-input");t.addEventListener("dblclick",l=>{l.target.closest(".layer-actions")||(l.stopPropagation(),i.classList.add("hidden"),n.classList.remove("hidden"),n.focus(),n.select())});const s=()=>{const l=n.value.trim();l&&(e.set("name",l),i.textContent=l,this.cm.canvas.requestRenderAll()),i.classList.remove("hidden"),n.classList.add("hidden")};n.addEventListener("blur",s),n.addEventListener("keydown",l=>{l.key==="Enter"&&s()});const o=t.querySelector(".btn-lock");o.addEventListener("click",l=>{l.stopPropagation();const c=!e.lockMovementX;e.set({lockMovementX:c,lockMovementY:c,lockRotation:c,lockScalingX:c,lockScalingY:c}),this.cm.canvas.requestRenderAll(),o.querySelector("i").setAttribute("data-lucide",c?"lock":"unlock"),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{width:14,height:14}},o.parentElement),c?o.classList.add("active"):o.classList.remove("active")});const a=t.querySelector(".btn-visible");a.addEventListener("click",l=>{l.stopPropagation(),e.set("visible",!e.visible),this.cm.canvas.requestRenderAll(),a.querySelector("i").setAttribute("data-lucide",e.visible?"eye":"eye-off"),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{width:14,height:14}},a.parentElement),e.visible?a.classList.remove("active"):a.classList.add("active")})}updateSelection(){const t=this.container.querySelectorAll(".layer-item");t.forEach(i=>i.classList.remove("selected"));const e=this.cm.canvas.getActiveObject();if(e){const i=e.type==="activeSelection"?e.getObjects():[e];t.forEach(n=>{i.includes(n._fabricObject)&&n.classList.add("selected")})}}handleReorder(t,e){const i=e._fabricParent;let n;i?n=i.getObjects():n=this.cm.canvas.getObjects();const s=n.length,o=s-1-t.oldIndex,a=s-1-t.newIndex;if(o===a)return;const l=n[o];i?(i.remove(l),i.insertAt(a,l),i._calcBounds(),i.setCoords(),this.cm.canvas.requestRenderAll()):(this.cm.canvas.moveObjectTo(l,a),this.cm.canvas.requestRenderAll()),this.render()}}class hA{constructor(t){this.cm=t,this.canvas=t.canvas,this.toolbar=null}init(){this.createToolbar(),this.bindEvents()}createToolbar(){this.toolbar=document.createElement("div"),this.toolbar.id="floating-toolbar",this.toolbar.className="floating-toolbar",this.toolbar.style.display="none",this.toolbar.innerHTML=`
            <div id="ft-text-controls" style="display:none; align-items:center; gap:4px;">
                <button class="ft-btn" id="ft-bold" title="Bold"><i data-lucide="bold"></i></button>
                <button class="ft-btn" id="ft-italic" title="Italic"><i data-lucide="italic"></i></button>
                <button class="ft-btn" id="ft-underline" title="Underline"><i data-lucide="underline"></i></button>
                <div class="ft-sep"></div>
            </div>
            
            <button class="ft-btn" id="ft-duplicate" title="Duplicate"><i data-lucide="copy"></i></button>
            <button class="ft-btn" id="ft-delete" title="Delete"><i data-lucide="trash-2"></i></button>
            <div class="ft-sep"></div>
            <button class="ft-btn" id="ft-layer-up" title="Bring Forward"><i data-lucide="arrow-up"></i></button>
            <button class="ft-btn" id="ft-layer-down" title="Send Backward"><i data-lucide="arrow-down"></i></button>
            <div class="ft-sep"></div>

            <!-- Crop Controls -->
            <div id="ft-crop-controls" style="display:none; align-items:center; gap:4px;">
                 <button class="ft-btn" id="ft-crop-apply" title="Apply Crop" style="color:#4ade80;"><i data-lucide="check"></i></button>
                 <button class="ft-btn" id="ft-crop-cancel" title="Cancel Crop" style="color:#f87171;"><i data-lucide="x"></i></button>
                 <div class="ft-sep"></div>
            </div>

            <div class="ft-sep"></div>
            <button class="ft-btn" id="ft-mask" title="Mask Image" style="display:none"><i data-lucide="scissors"></i></button>
            <button class="ft-btn" id="ft-group" title="Group" style="display:none"><i data-lucide="layers"></i></button>
            <button class="ft-btn" id="ft-ungroup" title="Ungroup" style="display:none"><i data-lucide="layout-grid"></i></button>
            
            <div id="ft-color-wrap" style="position:relative; display:flex;">
                 <div id="ft-color-swatch" class="ft-color-swatch"></div>
                 <div id="ft-color-picker-wrap" class="color-picker-popup"></div>
            </div>
        `,document.getElementById("canvas-wrapper").appendChild(this.toolbar),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{class:"lucide"}})}bindEvents(){this.toolbar.querySelector("#ft-duplicate").addEventListener("click",()=>this.cm.duplicateActiveObject()),this.toolbar.querySelector("#ft-delete").addEventListener("click",()=>this.cm.removeActiveObject()),this.toolbar.querySelector("#ft-layer-up").addEventListener("click",()=>this.cm.layerActiveObject("up")),this.toolbar.querySelector("#ft-layer-down").addEventListener("click",()=>this.cm.layerActiveObject("down")),this.toolbar.querySelector("#ft-mask").addEventListener("click",()=>this.cm.maskObject()),this.toolbar.querySelector("#ft-crop-apply").addEventListener("click",()=>this.cm.applyCrop()),this.toolbar.querySelector("#ft-crop-cancel").addEventListener("click",()=>this.cm.cancelCrop()),this.toolbar.querySelector("#ft-group").addEventListener("click",()=>this.cm.group()),this.toolbar.querySelector("#ft-ungroup").addEventListener("click",()=>this.cm.ungroup()),this.toolbar.querySelector("#ft-bold").addEventListener("click",()=>{this.cm.toggleTextDecoration("fontWeight"),this.updateState()}),this.toolbar.querySelector("#ft-italic").addEventListener("click",()=>{this.cm.toggleTextDecoration("fontStyle"),this.updateState()}),this.toolbar.querySelector("#ft-underline").addEventListener("click",()=>{this.cm.toggleTextDecoration("underline"),this.updateState()});const t=this.toolbar.querySelector("#ft-color-swatch"),e=this.toolbar.querySelector("#ft-color-picker-wrap"),i=this.cm.getActiveObject(),n=i&&i.fill&&typeof i.fill=="string"?i.fill:"#000000";if(this.advancedPicker=new a5({color:n,onChange:o=>{t.style.backgroundColor=o,this.cm.updateActiveObject("fill",o)}}),this.advancedPicker.mount(e),t.addEventListener("click",o=>{o.stopPropagation();const a=e.style.display==="block";if(document.querySelectorAll(".color-picker-popup").forEach(l=>l.style.display="none"),a)e.style.display="none";else{e.style.display="block",e.style.position="fixed",e.style.zIndex="9999";const l=t.getBoundingClientRect(),c=240;let h=l.left+l.width/2-c/2;h<10&&(h=10),h+c>window.innerWidth-10&&(h=window.innerWidth-c-10),e.style.left=h+"px",e.style.right="auto",l.bottom+310<window.innerHeight-10?(e.style.top=l.bottom+8+"px",e.style.bottom="auto"):(e.style.top="auto",e.style.bottom=window.innerHeight-l.top+8+"px")}}),document.addEventListener("click",o=>{!this.toolbar.contains(o.target)&&!e.contains(o.target)&&(e.style.display="none")}),!window._colorPickerGlobalEvents){window._colorPickerGlobalEvents=!0;const o=()=>{document.querySelectorAll(".color-picker-popup").forEach(a=>a.style.display="none")};window.addEventListener("scroll",o,!0),window.addEventListener("resize",o)}const s=()=>this.updatePosition();this.canvas.on("selection:created",s),this.canvas.on("selection:updated",s),this.canvas.on("object:moving",s),this.canvas.on("object:scaling",s),this.canvas.on("object:rotating",s),this.canvas.on("object:modified",s),this.canvas.on("selection:cleared",()=>{this.toolbar.style.display="none",e&&(e.style.display="none")}),this.canvas.on("after:render",s)}updatePosition(){const t=this.cm.getActiveObject();if(!t){this.toolbar.style.display="none";return}const e=this.toolbar.querySelector("#ft-text-controls");t.type==="i-text"?(e.style.display="flex",this.updateState()):e.style.display="none",this.toolbar.style.display="flex";const i=t.getBoundingRect(!0),n=this.cm.canvas.wrapperEl.getBoundingClientRect(),o=document.getElementById("canvas-wrapper").getBoundingClientRect(),a=n.left-o.left,l=n.top-o.top,c=a+i.left+i.width/2-this.toolbar.offsetWidth/2;let h=l+i.top-this.toolbar.offsetHeight-10;h<10&&(h=l+i.top+i.height+20),this.toolbar.style.left=c+"px",this.toolbar.style.top=h+"px";const p=this.toolbar.querySelector("#ft-crop-controls"),m=["#ft-duplicate","#ft-delete","#ft-layer-up","#ft-layer-down","#ft-color-wrap"];t.id==="crop-ui"?(p.style.display="flex",m.forEach(x=>{const E=this.toolbar.querySelector(x);E&&(E.style.display="none")}),this.toolbar.querySelector("#ft-color-wrap").style.display="none"):(p.style.display="none",m.forEach(x=>{const E=this.toolbar.querySelector(x);x==="#ft-color-wrap"?E&&(E.style.display="flex"):E&&(E.style.display="")}));const f=this.toolbar.querySelector("#ft-group"),b=this.toolbar.querySelector("#ft-ungroup"),y=this.toolbar.querySelector("#ft-mask");if(f&&(f.style.display="none"),b&&(b.style.display="none"),y&&(y.style.display="none"),t.type==="activeSelection"){f&&(f.style.display="flex");const x=t.getObjects();if(x.length===2){const E=x.some(O=>O.type==="image"),I=x.some(O=>["rect","circle","triangle","polygon","path","ellipse"].includes(O.type));E&&I&&y&&(y.style.display="flex")}}else t.type==="group"&&b&&(b.style.display="flex");const _=this.toolbar.querySelector("#ft-color-swatch");t.fill&&typeof t.fill=="string"?(_.style.backgroundColor=t.fill,this.advancedPicker&&(this.advancedPicker.color=t.fill)):_.style.backgroundColor="transparent"}updateState(){const t=this.cm.getActiveObject();if(!t||t.type!=="i-text")return;const e=this.toolbar.querySelector("#ft-bold"),i=this.toolbar.querySelector("#ft-italic"),n=this.toolbar.querySelector("#ft-underline");t.fontWeight==="bold"?e.style.backgroundColor="rgba(99, 102, 241, 0.2)":e.style.backgroundColor="transparent",t.fontStyle==="italic"?i.style.backgroundColor="rgba(99, 102, 241, 0.2)":i.style.backgroundColor="transparent",t.underline?n.style.backgroundColor="rgba(99, 102, 241, 0.2)":n.style.backgroundColor="transparent"}}class uA{constructor(t,e){this.dom=t,this.cm=e,this.templates=[]}init(){this.injectControls(),this.loadTemplates()}injectControls(){const t=document.getElementById("templates-wrapper");if(!t)return;const e=t.querySelector(".section-title");if(e){const i=document.createElement("button");i.className="btn btn-sm btn-primary",i.style.marginTop="8px",i.style.width="100%",i.innerHTML='<i data-lucide="save"></i> Save Current as Template',i.addEventListener("click",()=>this.saveAsTemplate()),e.parentNode.insertBefore(i,e.nextSibling)}}async loadTemplates(){try{const t=await fetch("/data/templates.json");t.ok&&(this.templates=await t.json()),this.render()}catch(t){console.error("Failed to load templates:",t),this.templates=[],this.render()}}render(){const t=document.getElementById("templates-grid");if(!t)return;t.innerHTML="";const e=document.createElement("div");e.className="template-card",e.innerHTML=`
            <div class="template-thumb" style="background: #ffffff; display:flex; align-items:center; justify-content:center;">
                <span style="color:#ccc; font-size: 3rem;">+</span>
            </div>
            <div class="template-info">
                <h4>Blank Canvas</h4>
                <span class="template-cat">New</span>
            </div>
        `,e.addEventListener("click",()=>{confirm("Start fresh? Unsaved changes will be lost.")&&this.cm.loadTemplate(null)}),t.appendChild(e),this.templates.forEach(i=>{const n=document.createElement("div");n.className="template-card";let s=i.thumbnail;s&&!s.startsWith("data:")&&!s.startsWith("http")&&s.startsWith("template/"),n.innerHTML=`
                <div class="template-thumb">
                    <img src="${s}" alt="${i.title}" onerror="this.src='https://placehold.co/300x200?text=No+Image'">
                </div>
                <div class="template-info">
                    <h4>${i.title}</h4>
                    <span class="template-cat">${i.category||"Custom"}</span>
                </div>
            `,n.addEventListener("click",async()=>{confirm(`Load template "${i.title}"? Unsaved changes will be lost.`)&&await this.loadTemplate(i)}),t.appendChild(n)}),window.lucide&&window.lucide.createIcons()}async loadTemplate(t){try{if(t.file){let e;if(typeof t.file=="string"){const i=await fetch(`/data/${t.file}`);if(!i.ok)throw new Error("Failed to load template file");e=await i.json()}else typeof t.file=="object"&&(e=t.file);e&&this.cm.loadTemplate(e)}else this.cm.loadTemplate(null)}catch(e){console.error("Error loading template:",e),Yi.error("Failed to load template")}}saveAsTemplate(){const t=prompt("Enter Template Name:","My New Template");if(!t)return;const e=this.cm.getCanvasDataURL(.2),i=this.cm.saveProject(),n={id:"tpl_"+Date.now(),title:t,category:"Custom",thumbnail:e,file:i,createdAt:new Date().toISOString()};this.templates.unshift(n),this.render(),Yi.success("Template saved to list!");const s=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),o=URL.createObjectURL(s),a=document.createElement("a");a.download=`template_${t.replace(/\s+/g,"_")}.json`,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}}class dA{constructor(t){this.cm=t,this.canvas=t.canvas,this.rulerH=document.getElementById("ruler-h"),this.rulerV=document.getElementById("ruler-v"),this.wrapper=document.getElementById("canvas-wrapper"),this.ctxH=this.rulerH?this.rulerH.getContext("2d"):null,this.ctxV=this.rulerV?this.rulerV.getContext("2d"):null,this.size=20,this.isActive=!0,this.lastTransform=null,this.init()}init(){if(!this.rulerH||!this.rulerV)return;this.resize(),window.addEventListener("resize",()=>this.resize()),this.canvas.on("after:render",()=>this.draw()),this.canvas.on("mouse:wheel",()=>this.draw()),new ResizeObserver(()=>this.resize()).observe(this.wrapper),this.setupInteractions()}setupInteractions(){this.rulerH.addEventListener("mousedown",t=>{t.preventDefault(),this.isDraggingGuide=!0,this.activeGuide=this.cm.addGuide("horizontal",0),this.dragAxis="horizontal",this.startDrag()}),this.rulerV.addEventListener("mousedown",t=>{t.preventDefault(),this.isDraggingGuide=!0,this.activeGuide=this.cm.addGuide("vertical",0),this.dragAxis="vertical",this.startDrag()})}startDrag(){const t=i=>{if(!this.activeGuide)return;const n=this.canvas.viewportTransform,s=n[0],o=n[4],a=n[5],l=this.wrapper.getBoundingClientRect(),c=i.clientX-l.left,h=i.clientY-l.top,p=(c-o)/s,m=(h-a)/s;this.dragAxis==="horizontal"?(this.activeGuide.set("top",m),this.activeGuide.set("left",0)):(this.activeGuide.set("left",p),this.activeGuide.set("top",0)),this.activeGuide.setCoords(),this.canvas.requestRenderAll()},e=()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",e),this.isDraggingGuide=!1,this.activeGuide=null};window.addEventListener("mousemove",t),window.addEventListener("mouseup",e)}toggle(){this.isActive=!this.isActive;const t=document.getElementById("ruler-wrapper");if(t){const e=t.children[0],i=t.children[1].children[0];e.style.display=this.isActive?"flex":"none",i.style.display=this.isActive?"block":"none",this.cm.viewport&&this.cm.viewport.resizeCanvasElement(this.wrapper.clientWidth,this.wrapper.clientHeight)}}resize(){if(!this.rulerH||!this.rulerV||!this.wrapper)return;const t=this.wrapper.clientWidth,e=this.wrapper.clientHeight;this.rulerH.width=t,this.rulerH.height=this.size,this.rulerV.width=this.size,this.rulerV.height=e,this.draw()}draw(){if(!this.isActive||!this.ctxH||!this.ctxV||!this.canvas)return;const t=this.canvas.viewportTransform,e=t[0],i=t[4],n=t[5];this.ctxH.clearRect(0,0,this.rulerH.width,this.rulerH.height),this.ctxV.clearRect(0,0,this.rulerV.width,this.rulerV.height),this.ctxH.fillStyle="#1e1e1e",this.ctxH.fillRect(0,0,this.rulerH.width,this.rulerH.height),this.ctxV.fillStyle="#1e1e1e",this.ctxV.fillRect(0,0,this.rulerV.width,this.rulerV.height),this.ctxH.fillStyle="#a1a1aa",this.ctxH.strokeStyle="#3f3f46",this.ctxH.font="10px Inter",this.ctxV.fillStyle="#a1a1aa",this.ctxV.strokeStyle="#3f3f46",this.ctxV.font="10px Inter",this.drawHRuler(e,i),this.drawVRuler(e,n)}drawHRuler(t,e){const i=this.ctxH,n=this.rulerH.width;let o=50;t>=2?o=10:t>=1?o=25:t>=.5?o=50:t>=.25?o=100:o=250;const a=(0-e)/t,l=(n-e)/t,c=Math.floor(a/o)*o;i.beginPath();for(let h=c;h<=l;h+=o){const p=h*t+e;if(p<0||p>n)continue;const m=h%(o*2)===0,f=m?12:6;i.moveTo(p+.5,0),i.lineTo(p+.5,f),m&&i.fillText(Math.round(h),p+4,10)}i.stroke()}drawVRuler(t,e){const i=this.ctxV,n=this.rulerV.height;let s=50;t>=2?s=10:t>=1?s=25:t>=.5?s=50:t>=.25?s=100:s=250;const o=(0-e)/t,a=(n-e)/t,l=Math.floor(o/s)*s;i.beginPath();for(let c=l;c<=a;c+=s){const h=c*t+e;if(h<0||h>n)continue;const p=c%(s*2)===0,m=p?12:6;i.moveTo(0,h+.5),i.lineTo(m,h+.5),p&&(i.save(),i.translate(2,h+12),i.rotate(-Math.PI/2),i.fillText(Math.round(c),0,0),i.restore())}i.stroke()}}class fA{constructor(t){this.cm=t,this.menu=null,this.activeTarget=null}init(){this.menu=document.createElement("div"),this.menu.className="context-menu",this.menu.style.display="none",this.menu.style.position="fixed",this.menu.style.zIndex="10000",this.menu.style.background="#2a2b2e",this.menu.style.border="1px solid #3f4045",this.menu.style.borderRadius="6px",this.menu.style.boxShadow="0 4px 12px rgba(0,0,0,0.3)",this.menu.style.padding="4px 0",this.menu.style.minWidth="180px",document.body.appendChild(this.menu),document.addEventListener("click",()=>this.hide()),document.addEventListener("contextmenu",t=>{t.target.closest(".canvas-container")&&(t.preventDefault(),this.show(t))}),this.menu.addEventListener("click",t=>t.stopPropagation())}show(t){const e=this.cm.getActiveObject();this.activeTarget=e,console.log("ContextMenu: Active Object",e,"Type:",e?e.type:"None");const i=this.getMenuItems(e);if(i.length===0)return;this.renderItems(i),this.menu.style.display="block";const{clientX:n,clientY:s}=t,o=this.menu.getBoundingClientRect();let a=n,l=s;a+o.width>window.innerWidth&&(a-=o.width),l+o.height>window.innerHeight&&(l-=o.height),this.menu.style.left=`${a}px`,this.menu.style.top=`${l}px`}hide(){this.menu&&(this.menu.style.display="none")}getMenuItems(t){const e=[],i=!!t,n=t&&(t.type==="activeSelection"||t.type==="activeselection"||t.type==="group");if(e.push({label:"Copy",icon:"copy",action:()=>this.cm.duplicateActiveObject(),disabled:!i}),this.cm.clipboard?e.push({label:"Paste",icon:"clipboard",action:()=>this.cm.paste()}):e.push({label:"Paste",icon:"clipboard",action:()=>this.cm.paste(),disabled:!0}),e.push({separator:!0}),e.push({label:"Bring Forward",icon:"arrow-up",action:()=>this.cm.layerActiveObject("up"),disabled:!i}),e.push({label:"Send Backward",icon:"arrow-down",action:()=>this.cm.layerActiveObject("down"),disabled:!i}),e.push({separator:!0}),n&&(t.type==="activeSelection"||t.type==="activeselection"?e.push({label:"Group",icon:"folder-plus",action:()=>this.cm.group()}):e.push({label:"Ungroup",icon:"folder-minus",action:()=>this.cm.ungroup()})),i){const s=t.lockMovementX;e.push({label:s?"Unlock":"Lock",icon:s?"unlock":"lock",action:()=>this.cm.toggleLockActiveObject()})}return e.push({separator:!0}),e.push({label:"Delete",icon:"trash-2",action:()=>this.cm.removeActiveObject(),disabled:!i,danger:!0}),e}renderItems(t){this.menu.innerHTML="",t.forEach(e=>{if(e.separator){const n=document.createElement("div");n.style.height="1px",n.style.background="#3f4045",n.style.margin="4px 0",this.menu.appendChild(n);return}const i=document.createElement("div");i.className="context-item",i.style.display="flex",i.style.alignItems="center",i.style.padding="8px 12px",i.style.cursor=e.disabled?"default":"pointer",i.style.color=e.disabled?"#555":"#eee",i.style.fontSize="0.9rem",i.style.gap="8px",e.danger&&(i.style.color="#ff6b6b"),e.disabled||(i.addEventListener("mouseenter",()=>i.style.background="#3f4045"),i.addEventListener("mouseleave",()=>i.style.background="transparent"),i.addEventListener("click",()=>{e.action(),this.hide()})),i.innerHTML=`
                <i data-lucide="${e.icon}" style="width:16px; height:16px"></i>
                <span>${e.label}</span>
            `,this.menu.appendChild(i)}),Ds({icons:Jn,nameAttr:"data-lucide",attrs:{width:16,height:16}},this.menu)}}class pA{constructor(t){this.cm=t,this.dom={},this.elementsPanel=null,this.propertyPanel=null,this.exportPanel=null,this.layersPanel=null,this.floatingToolbar=null,this.templatesPanel=null,this.rulerManager=null,this.contextMenu=null}init(){this.cacheDOM(),this.elementsPanel=new L3(this.dom,this.cm),this.propertyPanel=new Y3(this.dom,this.cm),this.exportPanel=new Fk(this.dom,this.cm),this.layersPanel=new cA(this.dom,this.cm),this.floatingToolbar=new hA(this.cm),this.templatesPanel=new uA(this.dom,this.cm),this.rulerManager=new dA(this.cm),this.contextMenu=new fA(this.cm),this.elementsPanel.init(),this.propertyPanel.init(),this.exportPanel.init(),this.layersPanel.init(),this.floatingToolbar.init(),this.templatesPanel.init(),this.contextMenu.init(),this.bindGlobalEvents(),this.bindSidebarTabs()}cacheDOM(){this.dom.widthInput=document.getElementById("c-width"),this.dom.heightInput=document.getElementById("c-height"),this.dom.bgType=document.getElementById("bg-type"),this.dom.bgColor=document.getElementById("bg-color"),this.dom.fileInput=document.getElementById("file-input"),this.dom.posControls=document.getElementById("pos-controls"),this.dom.alignPage=document.getElementById("align-page-controls"),this.dom.alignElem=document.getElementById("align-elem-controls"),this.dom.textControls=document.getElementById("text-controls"),this.dom.propX=document.getElementById("prop-x"),this.dom.propY=document.getElementById("prop-y"),this.dom.propW=document.getElementById("prop-w"),this.dom.propH=document.getElementById("prop-h"),this.dom.propAngle=document.getElementById("prop-angle"),this.dom.btnLock=document.getElementById("btn-lock"),this.dom.fontFamily=document.getElementById("font-family"),this.dom.textColor=document.getElementById("text-color"),this.dom.textSize=document.getElementById("text-size"),this.dom.btnBold=document.getElementById("btn-bold"),this.dom.btnItalic=document.getElementById("btn-italic"),this.dom.btnUnderline=document.getElementById("btn-underline")}bindGlobalEvents(){document.addEventListener("keydown",i=>{if(i.key==="Delete"||i.key==="Backspace"){if(i.target.tagName==="INPUT"||i.target.tagName==="TEXTAREA")return;this.cm.removeActiveObject()}});const t=document.getElementById("btn-undo"),e=document.getElementById("btn-redo");t&&t.addEventListener("click",()=>this.cm.history.undo()),e&&e.addEventListener("click",()=>this.cm.history.redo()),document.addEventListener("keydown",i=>{if(i.target.tagName==="INPUT"||i.target.tagName==="TEXTAREA")return;const n=i.ctrlKey||i.metaKey;if(i.key==="Delete"||i.key==="Backspace"){this.cm.removeActiveObject();return}if(n&&!i.shiftKey&&i.code==="KeyZ"){i.preventDefault(),this.cm.history.undo();return}if(n&&i.code==="KeyY"||n&&i.shiftKey&&i.code==="KeyZ"){i.preventDefault(),this.cm.history.redo();return}if(n&&!i.shiftKey&&i.code==="KeyG"){i.preventDefault(),this.cm.group();return}if(n&&i.shiftKey&&i.code==="KeyG"){i.preventDefault(),this.cm.ungroup();return}}),this.bindNavbarEvents()}bindSidebarTabs(){const t=document.querySelectorAll(".tab-btn");t.forEach(e=>{e.addEventListener("click",()=>{t.forEach(s=>s.classList.remove("active")),e.classList.add("active"),document.getElementById("elements-wrapper").style.display="none",document.getElementById("templates-wrapper").style.display="none";const i=e.dataset.target,n=document.getElementById(i);n&&(n.style.display="block")})})}bindNavbarEvents(){const t=(l,c)=>{const h=document.getElementById(l);h&&h.addEventListener("click",c)};t("btn-zoom-in",()=>this.cm.zoomIn()),t("btn-zoom-out",()=>this.cm.zoomOut()),t("btn-zoom-reset",()=>this.cm.resetZoom());const e=document.getElementById("btn-toggle-rulers");e&&e.addEventListener("click",()=>{this.rulerManager.toggle(),e.classList.toggle("active")});const i=document.getElementById("btn-toggle-grid");i&&i.addEventListener("click",()=>{this.cm.toggleGrid()?i.classList.add("active"):i.classList.remove("active")}),this.cm.onZoomChange&&this.cm.onZoomChange(l=>{const c=Math.round(l*100)+"%",h=document.getElementById("zoom-level");h&&(h.textContent=c)}),t("btn-hand-tool",()=>{const l=this.cm.toggleHandMode(),c=document.getElementById("btn-hand-tool");c&&(l?c.classList.add("active"):c.classList.remove("active"));const h=document.getElementById("btn-draw-mode");l&&h&&h.classList.contains("active")&&h.click()}),t("btn-draw-mode",()=>{const l=document.getElementById("btn-draw-mode");if(l.classList.contains("active"))this.cm.disableDrawingMode(),l.classList.remove("active");else{this.cm.enableDrawingMode(),l.classList.add("active");const h=document.getElementById("btn-hand-tool");h&&h.classList.contains("active")&&(this.cm.toggleHandMode(),h.classList.remove("active"))}this.propertyPanel.render()});const n=document.getElementById("btn-open-resize"),s=document.getElementById("resize-dialog"),o=document.getElementById("btn-close-resize"),a=document.getElementById("btn-apply-resize");n&&s&&(n.addEventListener("click",()=>{this.dom.widthInput&&(document.getElementById("resize-w").value=this.cm.canvas.width),this.dom.heightInput&&(document.getElementById("resize-h").value=this.cm.canvas.height),s.showModal()}),o&&o.addEventListener("click",()=>s.close()),a&&a.addEventListener("click",()=>{const l=parseInt(document.getElementById("resize-w").value,10),c=parseInt(document.getElementById("resize-h").value,10);l>0&&c>0&&(this.cm.resize(l,c),s.close())}),s.addEventListener("click",l=>{const c=s.getBoundingClientRect();(l.clientX<c.left||l.clientX>c.right||l.clientY<c.top||l.clientY>c.bottom)&&s.close()}))}}const fw=new A3("c",{width:800,height:600,backgroundColor:"#ffffff"}),R1=document.getElementById("btn-navbar-export"),Da=document.getElementById("export-dialog"),q1=document.getElementById("btn-close-export");R1&&Da&&q1&&(R1.addEventListener("click",()=>{Da.showModal()}),q1.addEventListener("click",()=>{Da.close()}),Da.addEventListener("click",r=>{const t=Da.getBoundingClientRect();(r.clientX<t.left||r.clientX>t.right||r.clientY<t.top||r.clientY>t.bottom)&&Da.close()}));const gA=new pA(fw);gA.init();Ds({icons:Jn});const mA=new URLSearchParams(window.location.search),Vf=mA.get("template");Vf&&(async()=>{try{const r=await fetch(Vf);if(!r.ok)throw new Error("Failed to load template");const t=await r.json();await fw.loadProject(t),console.log("Template loaded:",Vf)}catch(r){console.error("Template loading failed:",r),alert("Failed to load template.")}})();document.querySelector(".nav-left");export{Re as _};
